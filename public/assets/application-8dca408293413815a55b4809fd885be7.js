/*!
 * jQuery JavaScript Library v1.10.1
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2013-05-30T21:49Z
 */
function BestInPlaceEditor(e){this.element=e,this.initOptions(),this.bindForm(),this.initNil(),jQuery(this.activator).bind("click",{editor:this},this.clickHandler)}function phi4z(e,t,i,s,n,r,a,o,l){var h,u,c,d,p,f,l=r;for(f=1;15>=f;f++)if(h=Math.sin(l),c=Math.tan(l),o=c*Math.sqrt(1-e*h*h),u=Math.sin(2*l),d=t*l-i*u+s*Math.sin(4*l)-n*Math.sin(6*l),p=t-2*i*Math.cos(2*l)+4*s*Math.cos(4*l)-6*n*Math.cos(6*l),h=2*d+o*(d*d+a)-2*r*(o*d+1),c=e*u*(d*d+a-2*r*d)/(2*o),o=2*(r-d)*(o*p-2/u)-2*p,h/=c+o,l+=h,1e-10>=Math.abs(h))return l;return Proj4js.reportError("phi4z: No convergence"),null}function e4fn(e){var t;return t=1+e,e=1-e,Math.sqrt(Math.pow(t,t)*Math.pow(e,e))}function setConformingHeight(e,t){e.data("originalHeight",void 0==e.data("originalHeight")?e.height():e.data("originalHeight")),e.height(t)}function getOriginalHeight(e){return void 0==e.data("originalHeight")?e.height():e.data("originalHeight")}function columnConform(){$("#layer-table > li").each(function(){var e=$(this),t=e.position().top;if(currentRowStart!=t){for(currentDiv=0;currentDiv<rowDivs.length;currentDiv++)setConformingHeight(rowDivs[currentDiv],currentTallest);rowDivs.length=0,currentRowStart=t,currentTallest=getOriginalHeight(e),rowDivs.push(e)}else rowDivs.push(e),currentTallest=currentTallest<getOriginalHeight(e)?getOriginalHeight(e):currentTallest;for(currentDiv=0;currentDiv<rowDivs.length;currentDiv++)setConformingHeight(rowDivs[currentDiv],currentTallest)})}!function(e,t){function i(e){var t=e.length,i=ut.type(e);return ut.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===i||"function"!==i&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function s(e){var t=wt[e]={};return ut.each(e.match(dt)||[],function(e,i){t[i]=!0}),t}function n(e,i,s,n){if(ut.acceptData(e)){var r,a,o=ut.expando,l=e.nodeType,h=l?ut.cache:e,u=l?e[o]:e[o]&&o;if(u&&h[u]&&(n||h[u].data)||s!==t||"string"!=typeof i)return u||(u=l?e[o]=tt.pop()||ut.guid++:o),h[u]||(h[u]=l?{}:{toJSON:ut.noop}),("object"==typeof i||"function"==typeof i)&&(n?h[u]=ut.extend(h[u],i):h[u].data=ut.extend(h[u].data,i)),a=h[u],n||(a.data||(a.data={}),a=a.data),s!==t&&(a[ut.camelCase(i)]=s),"string"==typeof i?(r=a[i],null==r&&(r=a[ut.camelCase(i)])):r=a,r}}function r(e,t,i){if(ut.acceptData(e)){var s,n,r=e.nodeType,a=r?ut.cache:e,l=r?e[ut.expando]:ut.expando;if(a[l]){if(t&&(s=i?a[l]:a[l].data)){ut.isArray(t)?t=t.concat(ut.map(t,ut.camelCase)):t in s?t=[t]:(t=ut.camelCase(t),t=t in s?[t]:t.split(" ")),n=t.length;for(;n--;)delete s[t[n]];if(i?!o(s):!ut.isEmptyObject(s))return}(i||(delete a[l].data,o(a[l])))&&(r?ut.cleanData([e],!0):ut.support.deleteExpando||a!=a.window?delete a[l]:a[l]=null)}}}function a(e,i,s){if(s===t&&1===e.nodeType){var n="data-"+i.replace(Tt,"-$1").toLowerCase();if(s=e.getAttribute(n),"string"==typeof s){try{s="true"===s?!0:"false"===s?!1:"null"===s?null:+s+""===s?+s:Ot.test(s)?ut.parseJSON(s):s}catch(r){}ut.data(e,i,s)}else s=t}return s}function o(e){var t;for(t in e)if(("data"!==t||!ut.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function l(){return!0}function h(){return!1}function u(){try{return K.activeElement}catch(e){}}function c(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function d(e,t,i){if(ut.isFunction(t))return ut.grep(e,function(e,s){return!!t.call(e,s,e)!==i});if(t.nodeType)return ut.grep(e,function(e){return e===t!==i});if("string"==typeof t){if(Wt.test(t))return ut.filter(t,e,i);t=ut.filter(t,e)}return ut.grep(e,function(e){return ut.inArray(e,t)>=0!==i})}function p(e){var t=Xt.split("|"),i=e.createDocumentFragment();if(i.createElement)for(;t.length;)i.createElement(t.pop());return i}function f(e,t){return ut.nodeName(e,"table")&&ut.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function m(e){return e.type=(null!==ut.find.attr(e,"type"))+"/"+e.type,e}function y(e){var t=ni.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function g(e,t){for(var i,s=0;null!=(i=e[s]);s++)ut._data(i,"globalEval",!t||ut._data(t[s],"globalEval"))}function v(e,t){if(1===t.nodeType&&ut.hasData(e)){var i,s,n,r=ut._data(e),a=ut._data(t,r),o=r.events;if(o){delete a.handle,a.events={};for(i in o)for(s=0,n=o[i].length;n>s;s++)ut.event.add(t,i,o[i][s])}a.data&&(a.data=ut.extend({},a.data))}}function x(e,t){var i,s,n;if(1===t.nodeType){if(i=t.nodeName.toLowerCase(),!ut.support.noCloneEvent&&t[ut.expando]){n=ut._data(t);for(s in n.events)ut.removeEvent(t,s,n.handle);t.removeAttribute(ut.expando)}"script"===i&&t.text!==e.text?(m(t).text=e.text,y(t)):"object"===i?(t.parentNode&&(t.outerHTML=e.outerHTML),ut.support.html5Clone&&e.innerHTML&&!ut.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===i&&ti.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===i?t.defaultSelected=t.selected=e.defaultSelected:("input"===i||"textarea"===i)&&(t.defaultValue=e.defaultValue)}}function E(e,i){var s,n,r=0,a=typeof e.getElementsByTagName!==Y?e.getElementsByTagName(i||"*"):typeof e.querySelectorAll!==Y?e.querySelectorAll(i||"*"):t;if(!a)for(a=[],s=e.childNodes||e;null!=(n=s[r]);r++)!i||ut.nodeName(n,i)?a.push(n):ut.merge(a,E(n,i));return i===t||i&&ut.nodeName(e,i)?ut.merge([e],a):a}function b(e){ti.test(e.type)&&(e.defaultChecked=e.checked)}function L(e,t){if(t in e)return t;for(var i=t.charAt(0).toUpperCase()+t.slice(1),s=t,n=Ci.length;n--;)if(t=Ci[n]+i,t in e)return t;return s}function S(e,t){return e=t||e,"none"===ut.css(e,"display")||!ut.contains(e.ownerDocument,e)}function C(e,t){for(var i,s,n,r=[],a=0,o=e.length;o>a;a++)s=e[a],s.style&&(r[a]=ut._data(s,"olddisplay"),i=s.style.display,t?(r[a]||"none"!==i||(s.style.display=""),""===s.style.display&&S(s)&&(r[a]=ut._data(s,"olddisplay",M(s.nodeName)))):r[a]||(n=S(s),(i&&"none"!==i||!n)&&ut._data(s,"olddisplay",n?i:ut.css(s,"display"))));for(a=0;o>a;a++)s=e[a],s.style&&(t&&"none"!==s.style.display&&""!==s.style.display||(s.style.display=t?r[a]||"":"none"));return e}function w(e,t,i){var s=gi.exec(t);return s?Math.max(0,s[1]-(i||0))+(s[2]||"px"):t}function O(e,t,i,s,n){for(var r=i===(s?"border":"content")?4:"width"===t?1:0,a=0;4>r;r+=2)"margin"===i&&(a+=ut.css(e,i+Si[r],!0,n)),s?("content"===i&&(a-=ut.css(e,"padding"+Si[r],!0,n)),"margin"!==i&&(a-=ut.css(e,"border"+Si[r]+"Width",!0,n))):(a+=ut.css(e,"padding"+Si[r],!0,n),"padding"!==i&&(a+=ut.css(e,"border"+Si[r]+"Width",!0,n)));return a}function T(e,t,i){var s=!0,n="width"===t?e.offsetWidth:e.offsetHeight,r=ui(e),a=ut.support.boxSizing&&"border-box"===ut.css(e,"boxSizing",!1,r);if(0>=n||null==n){if(n=ci(e,t,r),(0>n||null==n)&&(n=e.style[t]),vi.test(n))return n;s=a&&(ut.support.boxSizingReliable||n===e.style[t]),n=parseFloat(n)||0}return n+O(e,t,i||(a?"border":"content"),s,r)+"px"}function M(e){var t=K,i=Ei[e];return i||(i=P(e,t),"none"!==i&&i||(hi=(hi||ut("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(hi[0].contentWindow||hi[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),i=P(e,t),hi.detach()),Ei[e]=i),i}function P(e,t){var i=ut(t.createElement(e)).appendTo(t.body),s=ut.css(i[0],"display");return i.remove(),s}function N(e,t,i,s){var n;if(ut.isArray(t))ut.each(t,function(t,n){i||Oi.test(e)?s(e,n):N(e+"["+("object"==typeof n?t:"")+"]",n,i,s)});else if(i||"object"!==ut.type(t))s(e,t);else for(n in t)N(e+"["+n+"]",t[n],i,s)}function D(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var s,n=0,r=t.toLowerCase().match(dt)||[];if(ut.isFunction(i))for(;s=r[n++];)"+"===s[0]?(s=s.slice(1)||"*",(e[s]=e[s]||[]).unshift(i)):(e[s]=e[s]||[]).push(i)}}function A(e,t,i,s){function n(o){var l;return r[o]=!0,ut.each(e[o]||[],function(e,o){var h=o(t,i,s);return"string"!=typeof h||a||r[h]?a?!(l=h):void 0:(t.dataTypes.unshift(h),n(h),!1)}),l}var r={},a=e===Hi;return n(t.dataTypes[0])||!r["*"]&&n("*")}function I(e,i){var s,n,r=ut.ajaxSettings.flatOptions||{};for(n in i)i[n]!==t&&((r[n]?e:s||(s={}))[n]=i[n]);return s&&ut.extend(!0,e,s),e}function F(e,i,s){for(var n,r,a,o,l=e.contents,h=e.dataTypes;"*"===h[0];)h.shift(),r===t&&(r=e.mimeType||i.getResponseHeader("Content-Type"));if(r)for(o in l)if(l[o]&&l[o].test(r)){h.unshift(o);break}if(h[0]in s)a=h[0];else{for(o in s){if(!h[0]||e.converters[o+" "+h[0]]){a=o;break}n||(n=o)}a=a||n}return a?(a!==h[0]&&h.unshift(a),s[a]):void 0}function R(e,t,i,s){var n,r,a,o,l,h={},u=e.dataTypes.slice();if(u[1])for(a in e.converters)h[a.toLowerCase()]=e.converters[a];for(r=u.shift();r;)if(e.responseFields[r]&&(i[e.responseFields[r]]=t),!l&&s&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=r,r=u.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(a=h[l+" "+r]||h["* "+r],!a)for(n in h)if(o=n.split(" "),o[1]===r&&(a=h[l+" "+o[0]]||h["* "+o[0]])){a===!0?a=h[n]:h[n]!==!0&&(r=o[0],u.unshift(o[1]));break}if(a!==!0)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(c){return{state:"parsererror",error:a?c:"No conversion from "+l+" to "+r}}}return{state:"success",data:t}}function k(){try{return new e.XMLHttpRequest}catch(t){}}function _(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function j(){return setTimeout(function(){Qi=t}),Qi=ut.now()}function G(e,t,i){for(var s,n=(ns[t]||[]).concat(ns["*"]),r=0,a=n.length;a>r;r++)if(s=n[r].call(i,t,e))return s}function B(e,t,i){var s,n,r=0,a=ss.length,o=ut.Deferred().always(function(){delete l.elem}),l=function(){if(n)return!1;for(var t=Qi||j(),i=Math.max(0,h.startTime+h.duration-t),s=i/h.duration||0,r=1-s,a=0,l=h.tweens.length;l>a;a++)h.tweens[a].run(r);return o.notifyWith(e,[h,r,i]),1>r&&l?i:(o.resolveWith(e,[h]),!1)},h=o.promise({elem:e,props:ut.extend({},t),opts:ut.extend(!0,{specialEasing:{}},i),originalProperties:t,originalOptions:i,startTime:Qi||j(),duration:i.duration,tweens:[],createTween:function(t,i){var s=ut.Tween(e,h.opts,t,i,h.opts.specialEasing[t]||h.opts.easing);return h.tweens.push(s),s},stop:function(t){var i=0,s=t?h.tweens.length:0;if(n)return this;for(n=!0;s>i;i++)h.tweens[i].run(1);return t?o.resolveWith(e,[h,t]):o.rejectWith(e,[h,t]),this}}),u=h.props;for(z(u,h.opts.specialEasing);a>r;r++)if(s=ss[r].call(h,e,u,h.opts))return s;return ut.map(u,G,h),ut.isFunction(h.opts.start)&&h.opts.start.call(e,h),ut.fx.timer(ut.extend(l,{elem:e,anim:h,queue:h.opts.queue})),h.progress(h.opts.progress).done(h.opts.done,h.opts.complete).fail(h.opts.fail).always(h.opts.always)}function z(e,t){var i,s,n,r,a;for(i in e)if(s=ut.camelCase(i),n=t[s],r=e[i],ut.isArray(r)&&(n=r[1],r=e[i]=r[0]),i!==s&&(e[s]=r,delete e[i]),a=ut.cssHooks[s],a&&"expand"in a){r=a.expand(r),delete e[s];for(i in r)i in e||(e[i]=r[i],t[i]=n)}else t[s]=n}function W(e,t,i){var s,n,r,a,o,l,h=this,u={},c=e.style,d=e.nodeType&&S(e),p=ut._data(e,"fxshow");i.queue||(o=ut._queueHooks(e,"fx"),null==o.unqueued&&(o.unqueued=0,l=o.empty.fire,o.empty.fire=function(){o.unqueued||l()}),o.unqueued++,h.always(function(){h.always(function(){o.unqueued--,ut.queue(e,"fx").length||o.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[c.overflow,c.overflowX,c.overflowY],"inline"===ut.css(e,"display")&&"none"===ut.css(e,"float")&&(ut.support.inlineBlockNeedsLayout&&"inline"!==M(e.nodeName)?c.zoom=1:c.display="inline-block")),i.overflow&&(c.overflow="hidden",ut.support.shrinkWrapBlocks||h.always(function(){c.overflow=i.overflow[0],c.overflowX=i.overflow[1],c.overflowY=i.overflow[2]}));for(s in t)if(n=t[s],es.exec(n)){if(delete t[s],r=r||"toggle"===n,n===(d?"hide":"show"))continue;u[s]=p&&p[s]||ut.style(e,s)}if(!ut.isEmptyObject(u)){p?"hidden"in p&&(d=p.hidden):p=ut._data(e,"fxshow",{}),r&&(p.hidden=!d),d?ut(e).show():h.done(function(){ut(e).hide()}),h.done(function(){var t;ut._removeData(e,"fxshow");for(t in u)ut.style(e,t,u[t])});for(s in u)a=G(d?p[s]:0,s,h),s in p||(p[s]=a.start,d&&(a.end=a.start,a.start="width"===s||"height"===s?1:0))}}function H(e,t,i,s,n){return new H.prototype.init(e,t,i,s,n)}function V(e,t){var i,s={height:e},n=0;for(t=t?1:0;4>n;n+=2-t)i=Si[n],s["margin"+i]=s["padding"+i]=e;return t&&(s.opacity=s.width=e),s}function U(e){return ut.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var X,q,Y=typeof t,Z=e.location,K=e.document,$=K.documentElement,Q=e.jQuery,J=e.$,et={},tt=[],it="1.10.1",st=tt.concat,nt=tt.push,rt=tt.slice,at=tt.indexOf,ot=et.toString,lt=et.hasOwnProperty,ht=it.trim,ut=function(e,t){return new ut.fn.init(e,t,q)},ct=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,dt=/\S+/g,pt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ft=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,mt=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,yt=/^[\],:{}\s]*$/,gt=/(?:^|:|,)(?:\s*\[)+/g,vt=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,xt=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,Et=/^-ms-/,bt=/-([\da-z])/gi,Lt=function(e,t){return t.toUpperCase()},St=function(e){(K.addEventListener||"load"===e.type||"complete"===K.readyState)&&(Ct(),ut.ready())},Ct=function(){K.addEventListener?(K.removeEventListener("DOMContentLoaded",St,!1),e.removeEventListener("load",St,!1)):(K.detachEvent("onreadystatechange",St),e.detachEvent("onload",St))};ut.fn=ut.prototype={jquery:it,constructor:ut,init:function(e,i,s){var n,r;if(!e)return this;if("string"==typeof e){if(n="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:ft.exec(e),!n||!n[1]&&i)return!i||i.jquery?(i||s).find(e):this.constructor(i).find(e);if(n[1]){if(i=i instanceof ut?i[0]:i,ut.merge(this,ut.parseHTML(n[1],i&&i.nodeType?i.ownerDocument||i:K,!0)),mt.test(n[1])&&ut.isPlainObject(i))for(n in i)ut.isFunction(this[n])?this[n](i[n]):this.attr(n,i[n]);return this}if(r=K.getElementById(n[2]),r&&r.parentNode){if(r.id!==n[2])return s.find(e);this.length=1,this[0]=r}return this.context=K,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):ut.isFunction(e)?s.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),ut.makeArray(e,this))},selector:"",length:0,toArray:function(){return rt.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=ut.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return ut.each(this,e,t)},ready:function(e){return ut.ready.promise().done(e),this},slice:function(){return this.pushStack(rt.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(0>e?t:0);return this.pushStack(i>=0&&t>i?[this[i]]:[])},map:function(e){return this.pushStack(ut.map(this,function(t,i){return e.call(t,i,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:nt,sort:[].sort,splice:[].splice},ut.fn.init.prototype=ut.fn,ut.extend=ut.fn.extend=function(){var e,i,s,n,r,a,o=arguments[0]||{},l=1,h=arguments.length,u=!1;for("boolean"==typeof o&&(u=o,o=arguments[1]||{},l=2),"object"==typeof o||ut.isFunction(o)||(o={}),h===l&&(o=this,--l);h>l;l++)if(null!=(r=arguments[l]))for(n in r)e=o[n],s=r[n],o!==s&&(u&&s&&(ut.isPlainObject(s)||(i=ut.isArray(s)))?(i?(i=!1,a=e&&ut.isArray(e)?e:[]):a=e&&ut.isPlainObject(e)?e:{},o[n]=ut.extend(u,a,s)):s!==t&&(o[n]=s));return o},ut.extend({expando:"jQuery"+(it+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===ut&&(e.$=J),t&&e.jQuery===ut&&(e.jQuery=Q),ut},isReady:!1,readyWait:1,holdReady:function(e){e?ut.readyWait++:ut.ready(!0)},ready:function(e){if(e===!0?!--ut.readyWait:!ut.isReady){if(!K.body)return setTimeout(ut.ready);ut.isReady=!0,e!==!0&&--ut.readyWait>0||(X.resolveWith(K,[ut]),ut.fn.trigger&&ut(K).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===ut.type(e)},isArray:Array.isArray||function(e){return"array"===ut.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?et[ot.call(e)]||"object":typeof e},isPlainObject:function(e){var i;if(!e||"object"!==ut.type(e)||e.nodeType||ut.isWindow(e))return!1;try{if(e.constructor&&!lt.call(e,"constructor")&&!lt.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(s){return!1}if(ut.support.ownLast)for(i in e)return lt.call(e,i);for(i in e);return i===t||lt.call(e,i)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||K;var s=mt.exec(e),n=!i&&[];return s?[t.createElement(s[1])]:(s=ut.buildFragment([e],t,n),n&&ut(n).remove(),ut.merge([],s.childNodes))},parseJSON:function(t){return e.JSON&&e.JSON.parse?e.JSON.parse(t):null===t?t:"string"==typeof t&&(t=ut.trim(t),t&&yt.test(t.replace(vt,"@").replace(xt,"]").replace(gt,"")))?new Function("return "+t)():(ut.error("Invalid JSON: "+t),void 0)},parseXML:function(i){var s,n;if(!i||"string"!=typeof i)return null;try{e.DOMParser?(n=new DOMParser,s=n.parseFromString(i,"text/xml")):(s=new ActiveXObject("Microsoft.XMLDOM"),s.async="false",s.loadXML(i))}catch(r){s=t}return s&&s.documentElement&&!s.getElementsByTagName("parsererror").length||ut.error("Invalid XML: "+i),s},noop:function(){},globalEval:function(t){t&&ut.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(Et,"ms-").replace(bt,Lt)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,s){var n,r=0,a=e.length,o=i(e);if(s){if(o)for(;a>r&&(n=t.apply(e[r],s),n!==!1);r++);else for(r in e)if(n=t.apply(e[r],s),n===!1)break}else if(o)for(;a>r&&(n=t.call(e[r],r,e[r]),n!==!1);r++);else for(r in e)if(n=t.call(e[r],r,e[r]),n===!1)break;return e},trim:ht&&!ht.call("﻿ ")?function(e){return null==e?"":ht.call(e)}:function(e){return null==e?"":(e+"").replace(pt,"")},makeArray:function(e,t){var s=t||[];return null!=e&&(i(Object(e))?ut.merge(s,"string"==typeof e?[e]:e):nt.call(s,e)),s},inArray:function(e,t,i){var s;if(t){if(at)return at.call(t,e,i);for(s=t.length,i=i?0>i?Math.max(0,s+i):i:0;s>i;i++)if(i in t&&t[i]===e)return i}return-1},merge:function(e,i){var s=i.length,n=e.length,r=0;if("number"==typeof s)for(;s>r;r++)e[n++]=i[r];else for(;i[r]!==t;)e[n++]=i[r++];return e.length=n,e},grep:function(e,t,i){var s,n=[],r=0,a=e.length;for(i=!!i;a>r;r++)s=!!t(e[r],r),i!==s&&n.push(e[r]);return n},map:function(e,t,s){var n,r=0,a=e.length,o=i(e),l=[];if(o)for(;a>r;r++)n=t(e[r],r,s),null!=n&&(l[l.length]=n);else for(r in e)n=t(e[r],r,s),null!=n&&(l[l.length]=n);return st.apply([],l)},guid:1,proxy:function(e,i){var s,n,r;return"string"==typeof i&&(r=e[i],i=e,e=r),ut.isFunction(e)?(s=rt.call(arguments,2),n=function(){return e.apply(i||this,s.concat(rt.call(arguments)))},n.guid=e.guid=e.guid||ut.guid++,n):t},access:function(e,i,s,n,r,a,o){var l=0,h=e.length,u=null==s;if("object"===ut.type(s)){r=!0;for(l in s)ut.access(e,i,l,s[l],!0,a,o)}else if(n!==t&&(r=!0,ut.isFunction(n)||(o=!0),u&&(o?(i.call(e,n),i=null):(u=i,i=function(e,t,i){return u.call(ut(e),i)})),i))for(;h>l;l++)i(e[l],s,o?n:n.call(e[l],l,i(e[l],s)));return r?e:u?i.call(e):h?i(e[0],s):a},now:function(){return(new Date).getTime()},swap:function(e,t,i,s){var n,r,a={};for(r in t)a[r]=e.style[r],e.style[r]=t[r];n=i.apply(e,s||[]);for(r in t)e.style[r]=a[r];return n}}),ut.ready.promise=function(t){if(!X)if(X=ut.Deferred(),"complete"===K.readyState)setTimeout(ut.ready);else if(K.addEventListener)K.addEventListener("DOMContentLoaded",St,!1),e.addEventListener("load",St,!1);else{K.attachEvent("onreadystatechange",St),e.attachEvent("onload",St);var i=!1;try{i=null==e.frameElement&&K.documentElement}catch(s){}i&&i.doScroll&&function n(){if(!ut.isReady){try{i.doScroll("left")}catch(e){return setTimeout(n,50)}Ct(),ut.ready()}}()}return X.promise(t)},ut.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){et["[object "+t+"]"]=t.toLowerCase()}),q=ut(K),/*!
 * Sizzle CSS Selector Engine v1.9.4-pre
 * http://sizzlejs.com/
 *
 * Copyright 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2013-05-27
 */
function(e,t){function i(e,t,i,s){var n,r,a,o,l,h,u,c,d,p;if((t?t.ownerDocument||t:V)!==k&&R(t),t=t||k,i=i||[],!e||"string"!=typeof e)return i;if(1!==(o=t.nodeType)&&9!==o)return[];if(j&&!s){if(n=St.exec(e))if(a=n[1]){if(9===o){if(r=t.getElementById(a),!r||!r.parentNode)return i;if(r.id===a)return i.push(r),i}else if(t.ownerDocument&&(r=t.ownerDocument.getElementById(a))&&W(t,r)&&r.id===a)return i.push(r),i}else{if(n[2])return nt.apply(i,t.getElementsByTagName(e)),i;if((a=n[3])&&T.getElementsByClassName&&t.getElementsByClassName)return nt.apply(i,t.getElementsByClassName(a)),i}if(T.qsa&&(!G||!G.test(e))){if(c=u=H,d=t,p=9===o&&e,1===o&&"object"!==t.nodeName.toLowerCase()){for(h=m(e),(u=t.getAttribute("id"))?c=u.replace(Ot,"\\$&"):t.setAttribute("id",c),c="[id='"+c+"'] ",l=h.length;l--;)h[l]=c+y(h[l]);d=gt.test(e)&&t.parentNode||t,p=h.join(",")}if(p)try{return nt.apply(i,d.querySelectorAll(p)),i}catch(f){}finally{u||t.removeAttribute("id")}}}return C(e.replace(ft,"$1"),t,i,s)}function s(e){return Lt.test(e+"")}function n(){function e(i,s){return t.push(i+=" ")>P.cacheLength&&delete e[t.shift()],e[i]=s}var t=[];return e}function r(e){return e[H]=!0,e}function a(e){var t=k.createElement("div");try{return!!e(t)}catch(i){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function o(e,t,i){e=e.split("|");for(var s,n=e.length,r=i?null:t;n--;)(s=P.attrHandle[e[n]])&&s!==t||(P.attrHandle[e[n]]=r)}function l(e,t){var i=e.getAttributeNode(t);return i&&i.specified?i.value:e[t]===!0?t.toLowerCase():null}function h(e,t){return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}function u(e){return"input"===e.nodeName.toLowerCase()?e.defaultValue:void 0}function c(e,t){var i=t&&e,s=i&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||J)-(~e.sourceIndex||J);if(s)return s;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function d(e){return function(t){var i=t.nodeName.toLowerCase();return"input"===i&&t.type===e}}function p(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function f(e){return r(function(t){return t=+t,r(function(i,s){for(var n,r=e([],i.length,t),a=r.length;a--;)i[n=r[a]]&&(i[n]=!(s[n]=i[n]))})})}function m(e,t){var s,n,r,a,o,l,h,u=Y[e+" "];if(u)return t?0:u.slice(0);for(o=e,l=[],h=P.preFilter;o;){(!s||(n=mt.exec(o)))&&(n&&(o=o.slice(n[0].length)||o),l.push(r=[])),s=!1,(n=yt.exec(o))&&(s=n.shift(),r.push({value:s,type:n[0].replace(ft," ")}),o=o.slice(s.length));for(a in P.filter)!(n=bt[a].exec(o))||h[a]&&!(n=h[a](n))||(s=n.shift(),r.push({value:s,type:a,matches:n}),o=o.slice(s.length));if(!s)break}return t?o.length:o?i.error(e):Y(e,l).slice(0)}function y(e){for(var t=0,i=e.length,s="";i>t;t++)s+=e[t].value;return s}function g(e,t,i){var s=t.dir,n=i&&"parentNode"===s,r=X++;return t.first?function(t,i,r){for(;t=t[s];)if(1===t.nodeType||n)return e(t,i,r)}:function(t,i,a){var o,l,h,u=U+" "+r;if(a){for(;t=t[s];)if((1===t.nodeType||n)&&e(t,i,a))return!0}else for(;t=t[s];)if(1===t.nodeType||n)if(h=t[H]||(t[H]={}),(l=h[s])&&l[0]===u){if((o=l[1])===!0||o===M)return o===!0}else if(l=h[s]=[u],l[1]=e(t,i,a)||M,l[1]===!0)return!0}}function v(e){return e.length>1?function(t,i,s){for(var n=e.length;n--;)if(!e[n](t,i,s))return!1;return!0}:e[0]}function x(e,t,i,s,n){for(var r,a=[],o=0,l=e.length,h=null!=t;l>o;o++)(r=e[o])&&(!i||i(r,s,n))&&(a.push(r),h&&t.push(o));return a}function E(e,t,i,s,n,a){return s&&!s[H]&&(s=E(s)),n&&!n[H]&&(n=E(n,a)),r(function(r,a,o,l){var h,u,c,d=[],p=[],f=a.length,m=r||S(t||"*",o.nodeType?[o]:o,[]),y=!e||!r&&t?m:x(m,d,e,o,l),g=i?n||(r?e:f||s)?[]:a:y;if(i&&i(y,g,o,l),s)for(h=x(g,p),s(h,[],o,l),u=h.length;u--;)(c=h[u])&&(g[p[u]]=!(y[p[u]]=c));if(r){if(n||e){if(n){for(h=[],u=g.length;u--;)(c=g[u])&&h.push(y[u]=c);n(null,g=[],h,l)}for(u=g.length;u--;)(c=g[u])&&(h=n?at.call(r,c):d[u])>-1&&(r[h]=!(a[h]=c))}}else g=x(g===a?g.splice(f,g.length):g),n?n(null,a,g,l):nt.apply(a,g)})}function b(e){for(var t,i,s,n=e.length,r=P.relative[e[0].type],a=r||P.relative[" "],o=r?1:0,l=g(function(e){return e===t},a,!0),h=g(function(e){return at.call(t,e)>-1},a,!0),u=[function(e,i,s){return!r&&(s||i!==I)||((t=i).nodeType?l(e,i,s):h(e,i,s))}];n>o;o++)if(i=P.relative[e[o].type])u=[g(v(u),i)];else{if(i=P.filter[e[o].type].apply(null,e[o].matches),i[H]){for(s=++o;n>s&&!P.relative[e[s].type];s++);return E(o>1&&v(u),o>1&&y(e.slice(0,o-1).concat({value:" "===e[o-2].type?"*":""})).replace(ft,"$1"),i,s>o&&b(e.slice(o,s)),n>s&&b(e=e.slice(s)),n>s&&y(e))}u.push(i)}return v(u)}function L(e,t){var s=0,n=t.length>0,a=e.length>0,o=function(r,o,l,h,u){var c,d,p,f=[],m=0,y="0",g=r&&[],v=null!=u,E=I,b=r||a&&P.find.TAG("*",u&&o.parentNode||o),L=U+=null==E?1:Math.random()||.1;for(v&&(I=o!==k&&o,M=s);null!=(c=b[y]);y++){if(a&&c){for(d=0;p=e[d++];)if(p(c,o,l)){h.push(c);break}v&&(U=L,M=++s)}n&&((c=!p&&c)&&m--,r&&g.push(c))}if(m+=y,n&&y!==m){for(d=0;p=t[d++];)p(g,f,o,l);if(r){if(m>0)for(;y--;)g[y]||f[y]||(f[y]=it.call(h));f=x(f)}nt.apply(h,f),v&&!r&&f.length>0&&m+t.length>1&&i.uniqueSort(h)}return v&&(U=L,I=E),g};return n?r(o):o}function S(e,t,s){for(var n=0,r=t.length;r>n;n++)i(e,t[n],s);return s}function C(e,t,i,s){var n,r,a,o,l,h=m(e);if(!s&&1===h.length){if(r=h[0]=h[0].slice(0),r.length>2&&"ID"===(a=r[0]).type&&T.getById&&9===t.nodeType&&j&&P.relative[r[1].type]){if(t=(P.find.ID(a.matches[0].replace(Tt,Mt),t)||[])[0],!t)return i;e=e.slice(r.shift().value.length)}for(n=bt.needsContext.test(e)?0:r.length;n--&&(a=r[n],!P.relative[o=a.type]);)if((l=P.find[o])&&(s=l(a.matches[0].replace(Tt,Mt),gt.test(r[0].type)&&t.parentNode||t))){if(r.splice(n,1),e=s.length&&y(r),!e)return nt.apply(i,s),i;break}}return A(e,h)(s,t,!j,i,gt.test(e)),i}function w(){}var O,T,M,P,N,D,A,I,F,R,k,_,j,G,B,z,W,H="sizzle"+-new Date,V=e.document,U=0,X=0,q=n(),Y=n(),Z=n(),K=!1,$=function(){return 0},Q=typeof t,J=1<<31,et={}.hasOwnProperty,tt=[],it=tt.pop,st=tt.push,nt=tt.push,rt=tt.slice,at=tt.indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(this[t]===e)return t;return-1},ot="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",lt="[\\x20\\t\\r\\n\\f]",ht="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ct=ht.replace("w","w#"),dt="\\["+lt+"*("+ht+")"+lt+"*(?:([*^$|!~]?=)"+lt+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+ct+")|)|)"+lt+"*\\]",pt=":("+ht+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+dt.replace(3,8)+")*)|.*)\\)|)",ft=new RegExp("^"+lt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+lt+"+$","g"),mt=new RegExp("^"+lt+"*,"+lt+"*"),yt=new RegExp("^"+lt+"*([>+~]|"+lt+")"+lt+"*"),gt=new RegExp(lt+"*[+~]"),vt=new RegExp("="+lt+"*([^\\]'\"]*)"+lt+"*\\]","g"),xt=new RegExp(pt),Et=new RegExp("^"+ct+"$"),bt={ID:new RegExp("^#("+ht+")"),CLASS:new RegExp("^\\.("+ht+")"),TAG:new RegExp("^("+ht.replace("w","w*")+")"),ATTR:new RegExp("^"+dt),PSEUDO:new RegExp("^"+pt),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+lt+"*(even|odd|(([+-]|)(\\d*)n|)"+lt+"*(?:([+-]|)"+lt+"*(\\d+)|))"+lt+"*\\)|)","i"),bool:new RegExp("^(?:"+ot+")$","i"),needsContext:new RegExp("^"+lt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+lt+"*((?:-\\d)?\\d*)"+lt+"*\\)|)(?=[^-]|$)","i")},Lt=/^[^{]+\{\s*\[native \w/,St=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Ct=/^(?:input|select|textarea|button)$/i,wt=/^h\d$/i,Ot=/'|\\/g,Tt=new RegExp("\\\\([\\da-f]{1,6}"+lt+"?|("+lt+")|.)","ig"),Mt=function(e,t,i){var s="0x"+t-65536;return s!==s||i?t:0>s?String.fromCharCode(s+65536):String.fromCharCode(55296|s>>10,56320|1023&s)};try{nt.apply(tt=rt.call(V.childNodes),V.childNodes),tt[V.childNodes.length].nodeType}catch(Pt){nt={apply:tt.length?function(e,t){st.apply(e,rt.call(t))}:function(e,t){for(var i=e.length,s=0;e[i++]=t[s++];);e.length=i-1}}}D=i.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},T=i.support={},R=i.setDocument=function(e){var t=e?e.ownerDocument||e:V,i=t.parentWindow;return t!==k&&9===t.nodeType&&t.documentElement?(k=t,_=t.documentElement,j=!D(t),i&&i.frameElement&&i.attachEvent("onbeforeunload",function(){R()}),T.attributes=a(function(e){return e.innerHTML="<a href='#'></a>",o("type|href|height|width",h,"#"===e.firstChild.getAttribute("href")),o(ot,l,null==e.getAttribute("disabled")),e.className="i",!e.getAttribute("className")}),T.input=a(function(e){return e.innerHTML="<input>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")}),o("value",u,T.attributes&&T.input),T.getElementsByTagName=a(function(e){return e.appendChild(t.createComment("")),!e.getElementsByTagName("*").length}),T.getElementsByClassName=a(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),T.getById=a(function(e){return _.appendChild(e).id=H,!t.getElementsByName||!t.getElementsByName(H).length}),T.getById?(P.find.ID=function(e,t){if(typeof t.getElementById!==Q&&j){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}},P.filter.ID=function(e){var t=e.replace(Tt,Mt);return function(e){return e.getAttribute("id")===t}}):(delete P.find.ID,P.filter.ID=function(e){var t=e.replace(Tt,Mt);return function(e){var i=typeof e.getAttributeNode!==Q&&e.getAttributeNode("id");return i&&i.value===t}}),P.find.TAG=T.getElementsByTagName?function(e,t){return typeof t.getElementsByTagName!==Q?t.getElementsByTagName(e):void 0}:function(e,t){var i,s=[],n=0,r=t.getElementsByTagName(e);if("*"===e){for(;i=r[n++];)1===i.nodeType&&s.push(i);return s}return r},P.find.CLASS=T.getElementsByClassName&&function(e,t){return typeof t.getElementsByClassName!==Q&&j?t.getElementsByClassName(e):void 0},B=[],G=[],(T.qsa=s(t.querySelectorAll))&&(a(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||G.push("\\["+lt+"*(?:value|"+ot+")"),e.querySelectorAll(":checked").length||G.push(":checked")}),a(function(e){var i=t.createElement("input");i.setAttribute("type","hidden"),e.appendChild(i).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&G.push("[*^$]="+lt+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||G.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),G.push(",.*:")})),(T.matchesSelector=s(z=_.webkitMatchesSelector||_.mozMatchesSelector||_.oMatchesSelector||_.msMatchesSelector))&&a(function(e){T.disconnectedMatch=z.call(e,"div"),z.call(e,"[s!='']:x"),B.push("!=",pt)}),G=G.length&&new RegExp(G.join("|")),B=B.length&&new RegExp(B.join("|")),W=s(_.contains)||_.compareDocumentPosition?function(e,t){var i=9===e.nodeType?e.documentElement:e,s=t&&t.parentNode;return e===s||!(!s||1!==s.nodeType||!(i.contains?i.contains(s):e.compareDocumentPosition&&16&e.compareDocumentPosition(s)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},T.sortDetached=a(function(e){return 1&e.compareDocumentPosition(t.createElement("div"))}),$=_.compareDocumentPosition?function(e,i){if(e===i)return K=!0,0;var s=i.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(i);return s?1&s||!T.sortDetached&&i.compareDocumentPosition(e)===s?e===t||W(V,e)?-1:i===t||W(V,i)?1:F?at.call(F,e)-at.call(F,i):0:4&s?-1:1:e.compareDocumentPosition?-1:1}:function(e,i){var s,n=0,r=e.parentNode,a=i.parentNode,o=[e],l=[i];if(e===i)return K=!0,0;if(!r||!a)return e===t?-1:i===t?1:r?-1:a?1:F?at.call(F,e)-at.call(F,i):0;if(r===a)return c(e,i);for(s=e;s=s.parentNode;)o.unshift(s);for(s=i;s=s.parentNode;)l.unshift(s);for(;o[n]===l[n];)n++;return n?c(o[n],l[n]):o[n]===V?-1:l[n]===V?1:0},t):k},i.matches=function(e,t){return i(e,null,null,t)},i.matchesSelector=function(e,t){if((e.ownerDocument||e)!==k&&R(e),t=t.replace(vt,"='$1']"),!(!T.matchesSelector||!j||B&&B.test(t)||G&&G.test(t)))try{var s=z.call(e,t);if(s||T.disconnectedMatch||e.document&&11!==e.document.nodeType)return s}catch(n){}return i(t,k,null,[e]).length>0},i.contains=function(e,t){return(e.ownerDocument||e)!==k&&R(e),W(e,t)},i.attr=function(e,i){(e.ownerDocument||e)!==k&&R(e);var s=P.attrHandle[i.toLowerCase()],n=s&&et.call(P.attrHandle,i.toLowerCase())?s(e,i,!j):t;return n===t?T.attributes||!j?e.getAttribute(i):(n=e.getAttributeNode(i))&&n.specified?n.value:null:n},i.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},i.uniqueSort=function(e){var t,i=[],s=0,n=0;if(K=!T.detectDuplicates,F=!T.sortStable&&e.slice(0),e.sort($),K){for(;t=e[n++];)t===e[n]&&(s=i.push(n));for(;s--;)e.splice(i[s],1)}return e},N=i.getText=function(e){var t,i="",s=0,n=e.nodeType;if(n){if(1===n||9===n||11===n){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=N(e)}else if(3===n||4===n)return e.nodeValue}else for(;t=e[s];s++)i+=N(t);return i},P=i.selectors={cacheLength:50,createPseudo:r,match:bt,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Tt,Mt),e[3]=(e[4]||e[5]||"").replace(Tt,Mt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||i.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&i.error(e[0]),e},PSEUDO:function(e){var i,s=!e[5]&&e[2];return bt.CHILD.test(e[0])?null:(e[3]&&e[4]!==t?e[2]=e[4]:s&&xt.test(s)&&(i=m(s,!0))&&(i=s.indexOf(")",s.length-i)-s.length)&&(e[0]=e[0].slice(0,i),e[2]=s.slice(0,i)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(Tt,Mt).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=q[e+" "];return t||(t=new RegExp("(^|"+lt+")"+e+"("+lt+"|$)"))&&q(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==Q&&e.getAttribute("class")||"")})},ATTR:function(e,t,s){return function(n){var r=i.attr(n,e);return null==r?"!="===t:t?(r+="","="===t?r===s:"!="===t?r!==s:"^="===t?s&&0===r.indexOf(s):"*="===t?s&&r.indexOf(s)>-1:"$="===t?s&&r.slice(-s.length)===s:"~="===t?(" "+r+" ").indexOf(s)>-1:"|="===t?r===s||r.slice(0,s.length+1)===s+"-":!1):!0}},CHILD:function(e,t,i,s,n){var r="nth"!==e.slice(0,3),a="last"!==e.slice(-4),o="of-type"===t;return 1===s&&0===n?function(e){return!!e.parentNode}:function(t,i,l){var h,u,c,d,p,f,m=r!==a?"nextSibling":"previousSibling",y=t.parentNode,g=o&&t.nodeName.toLowerCase(),v=!l&&!o;if(y){if(r){for(;m;){for(c=t;c=c[m];)if(o?c.nodeName.toLowerCase()===g:1===c.nodeType)return!1;f=m="only"===e&&!f&&"nextSibling"}return!0}if(f=[a?y.firstChild:y.lastChild],a&&v){for(u=y[H]||(y[H]={}),h=u[e]||[],p=h[0]===U&&h[1],d=h[0]===U&&h[2],c=p&&y.childNodes[p];c=++p&&c&&c[m]||(d=p=0)||f.pop();)if(1===c.nodeType&&++d&&c===t){u[e]=[U,p,d];break}}else if(v&&(h=(t[H]||(t[H]={}))[e])&&h[0]===U)d=h[1];else for(;(c=++p&&c&&c[m]||(d=p=0)||f.pop())&&((o?c.nodeName.toLowerCase()!==g:1!==c.nodeType)||!++d||(v&&((c[H]||(c[H]={}))[e]=[U,d]),c!==t)););return d-=n,d===s||0===d%s&&d/s>=0}}},PSEUDO:function(e,t){var s,n=P.pseudos[e]||P.setFilters[e.toLowerCase()]||i.error("unsupported pseudo: "+e);return n[H]?n(t):n.length>1?(s=[e,e,"",t],P.setFilters.hasOwnProperty(e.toLowerCase())?r(function(e,i){for(var s,r=n(e,t),a=r.length;a--;)s=at.call(e,r[a]),e[s]=!(i[s]=r[a])}):function(e){return n(e,0,s)}):n}},pseudos:{not:r(function(e){var t=[],i=[],s=A(e.replace(ft,"$1"));return s[H]?r(function(e,t,i,n){for(var r,a=s(e,null,n,[]),o=e.length;o--;)(r=a[o])&&(e[o]=!(t[o]=r))}):function(e,n,r){return t[0]=e,s(t,null,r,i),!i.pop()}}),has:r(function(e){return function(t){return i(e,t).length>0}}),contains:r(function(e){return function(t){return(t.textContent||t.innerText||N(t)).indexOf(e)>-1}}),lang:r(function(e){return Et.test(e||"")||i.error("unsupported lang: "+e),e=e.replace(Tt,Mt).toLowerCase(),function(t){var i;do if(i=j?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return i=i.toLowerCase(),i===e||0===i.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===_},focus:function(e){return e===k.activeElement&&(!k.hasFocus||k.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!P.pseudos.empty(e)},header:function(e){return wt.test(e.nodeName)},input:function(e){return Ct.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:f(function(){return[0]}),last:f(function(e,t){return[t-1]}),eq:f(function(e,t,i){return[0>i?i+t:i]}),even:f(function(e,t){for(var i=0;t>i;i+=2)e.push(i);return e}),odd:f(function(e,t){for(var i=1;t>i;i+=2)e.push(i);return e}),lt:f(function(e,t,i){for(var s=0>i?i+t:i;--s>=0;)e.push(s);return e}),gt:f(function(e,t,i){for(var s=0>i?i+t:i;++s<t;)e.push(s);return e})}};for(O in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})P.pseudos[O]=d(O);for(O in{submit:!0,reset:!0})P.pseudos[O]=p(O);A=i.compile=function(e,t){var i,s=[],n=[],r=Z[e+" "];if(!r){for(t||(t=m(e)),i=t.length;i--;)r=b(t[i]),r[H]?s.push(r):n.push(r);r=Z(e,L(n,s))}return r},P.pseudos.nth=P.pseudos.eq,w.prototype=P.filters=P.pseudos,P.setFilters=new w,T.sortStable=H.split("").sort($).join("")===H,R(),[0,0].sort($),T.detectDuplicates=K,ut.find=i,ut.expr=i.selectors,ut.expr[":"]=ut.expr.pseudos,ut.unique=i.uniqueSort,ut.text=i.getText,ut.isXMLDoc=i.isXML,ut.contains=i.contains}(e);var wt={};ut.Callbacks=function(e){e="string"==typeof e?wt[e]||s(e):ut.extend({},e);var i,n,r,a,o,l,h=[],u=!e.once&&[],c=function(t){for(n=e.memory&&t,r=!0,o=l||0,l=0,a=h.length,i=!0;h&&a>o;o++)if(h[o].apply(t[0],t[1])===!1&&e.stopOnFalse){n=!1;break}i=!1,h&&(u?u.length&&c(u.shift()):n?h=[]:d.disable())},d={add:function(){if(h){var t=h.length;!function s(t){ut.each(t,function(t,i){var n=ut.type(i);"function"===n?e.unique&&d.has(i)||h.push(i):i&&i.length&&"string"!==n&&s(i)})}(arguments),i?a=h.length:n&&(l=t,c(n))}return this},remove:function(){return h&&ut.each(arguments,function(e,t){for(var s;(s=ut.inArray(t,h,s))>-1;)h.splice(s,1),i&&(a>=s&&a--,o>=s&&o--)}),this},has:function(e){return e?ut.inArray(e,h)>-1:!(!h||!h.length)},empty:function(){return h=[],a=0,this},disable:function(){return h=u=n=t,this},disabled:function(){return!h},lock:function(){return u=t,n||d.disable(),this},locked:function(){return!u},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],!h||r&&!u||(i?u.push(t):c(t)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!r}};return d},ut.extend({Deferred:function(e){var t=[["resolve","done",ut.Callbacks("once memory"),"resolved"],["reject","fail",ut.Callbacks("once memory"),"rejected"],["notify","progress",ut.Callbacks("memory")]],i="pending",s={state:function(){return i},always:function(){return n.done(arguments).fail(arguments),this},then:function(){var e=arguments;return ut.Deferred(function(i){ut.each(t,function(t,r){var a=r[0],o=ut.isFunction(e[t])&&e[t];n[r[1]](function(){var e=o&&o.apply(this,arguments);e&&ut.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[a+"With"](this===s?i.promise():this,o?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?ut.extend(e,s):s}},n={};return s.pipe=s.then,ut.each(t,function(e,r){var a=r[2],o=r[3];s[r[1]]=a.add,o&&a.add(function(){i=o},t[1^e][2].disable,t[2][2].lock),n[r[0]]=function(){return n[r[0]+"With"](this===n?s:this,arguments),this},n[r[0]+"With"]=a.fireWith}),s.promise(n),e&&e.call(n,n),n},when:function(e){var t,i,s,n=0,r=rt.call(arguments),a=r.length,o=1!==a||e&&ut.isFunction(e.promise)?a:0,l=1===o?e:ut.Deferred(),h=function(e,i,s){return function(n){i[e]=this,s[e]=arguments.length>1?rt.call(arguments):n,s===t?l.notifyWith(i,s):--o||l.resolveWith(i,s)}};if(a>1)for(t=new Array(a),i=new Array(a),s=new Array(a);a>n;n++)r[n]&&ut.isFunction(r[n].promise)?r[n].promise().done(h(n,s,r)).fail(l.reject).progress(h(n,i,t)):--o;return o||l.resolveWith(s,r),l.promise()}}),ut.support=function(t){var i,s,n,r,a,o,l,h,u,c=K.createElement("div");if(c.setAttribute("className","t"),c.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",i=c.getElementsByTagName("*")||[],s=c.getElementsByTagName("a")[0],!s||!s.style||!i.length)return t;r=K.createElement("select"),o=r.appendChild(K.createElement("option")),n=c.getElementsByTagName("input")[0],s.style.cssText="top:1px;float:left;opacity:.5",t.getSetAttribute="t"!==c.className,t.leadingWhitespace=3===c.firstChild.nodeType,t.tbody=!c.getElementsByTagName("tbody").length,t.htmlSerialize=!!c.getElementsByTagName("link").length,t.style=/top/.test(s.getAttribute("style")),t.hrefNormalized="/a"===s.getAttribute("href"),t.opacity=/^0.5/.test(s.style.opacity),t.cssFloat=!!s.style.cssFloat,t.checkOn=!!n.value,t.optSelected=o.selected,t.enctype=!!K.createElement("form").enctype,t.html5Clone="<:nav></:nav>"!==K.createElement("nav").cloneNode(!0).outerHTML,t.inlineBlockNeedsLayout=!1,t.shrinkWrapBlocks=!1,t.pixelPosition=!1,t.deleteExpando=!0,t.noCloneEvent=!0,t.reliableMarginRight=!0,t.boxSizingReliable=!0,n.checked=!0,t.noCloneChecked=n.cloneNode(!0).checked,r.disabled=!0,t.optDisabled=!o.disabled;try{delete c.test}catch(d){t.deleteExpando=!1}n=K.createElement("input"),n.setAttribute("value",""),t.input=""===n.getAttribute("value"),n.value="t",n.setAttribute("type","radio"),t.radioValue="t"===n.value,n.setAttribute("checked","t"),n.setAttribute("name","t"),a=K.createDocumentFragment(),a.appendChild(n),t.appendChecked=n.checked,t.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,c.attachEvent&&(c.attachEvent("onclick",function(){t.noCloneEvent=!1}),c.cloneNode(!0).click());for(u in{submit:!0,change:!0,focusin:!0})c.setAttribute(l="on"+u,"t"),t[u+"Bubbles"]=l in e||c.attributes[l].expando===!1;c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===c.style.backgroundClip;for(u in ut(t))break;return t.ownLast="0"!==u,ut(function(){var i,s,n,r="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",a=K.getElementsByTagName("body")[0];a&&(i=K.createElement("div"),i.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",a.appendChild(i).appendChild(c),c.innerHTML="<table><tr><td></td><td>t</td></tr></table>",n=c.getElementsByTagName("td"),n[0].style.cssText="padding:0;margin:0;border:0;display:none",h=0===n[0].offsetHeight,n[0].style.display="",n[1].style.display="none",t.reliableHiddenOffsets=h&&0===n[0].offsetHeight,c.innerHTML="",c.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",ut.swap(a,null!=a.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===c.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(c,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(c,null)||{width:"4px"}).width,s=c.appendChild(K.createElement("div")),s.style.cssText=c.style.cssText=r,s.style.marginRight=s.style.width="0",c.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(s,null)||{}).marginRight)),typeof c.style.zoom!==Y&&(c.innerHTML="",c.style.cssText=r+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===c.offsetWidth,c.style.display="block",c.innerHTML="<div></div>",c.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==c.offsetWidth,t.inlineBlockNeedsLayout&&(a.style.zoom=1)),a.removeChild(i),i=c=n=s=null)}),i=r=a=o=s=n=null,t}({});var Ot=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,Tt=/([A-Z])/g;ut.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?ut.cache[e[ut.expando]]:e[ut.expando],!!e&&!o(e)},data:function(e,t,i){return n(e,t,i)},removeData:function(e,t){return r(e,t)},_data:function(e,t,i){return n(e,t,i,!0)},_removeData:function(e,t){return r(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&ut.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),ut.fn.extend({data:function(e,i){var s,n,r=null,o=0,l=this[0];if(e===t){if(this.length&&(r=ut.data(l),1===l.nodeType&&!ut._data(l,"parsedAttrs"))){for(s=l.attributes;o<s.length;o++)n=s[o].name,0===n.indexOf("data-")&&(n=ut.camelCase(n.slice(5)),a(l,n,r[n]));ut._data(l,"parsedAttrs",!0)}return r}return"object"==typeof e?this.each(function(){ut.data(this,e)}):arguments.length>1?this.each(function(){ut.data(this,e,i)}):l?a(l,e,ut.data(l,e)):null},removeData:function(e){return this.each(function(){ut.removeData(this,e)})}}),ut.extend({queue:function(e,t,i){var s;return e?(t=(t||"fx")+"queue",s=ut._data(e,t),i&&(!s||ut.isArray(i)?s=ut._data(e,t,ut.makeArray(i)):s.push(i)),s||[]):void 0},dequeue:function(e,t){t=t||"fx";var i=ut.queue(e,t),s=i.length,n=i.shift(),r=ut._queueHooks(e,t),a=function(){ut.dequeue(e,t)};"inprogress"===n&&(n=i.shift(),s--),n&&("fx"===t&&i.unshift("inprogress"),delete r.stop,n.call(e,a,r)),!s&&r&&r.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return ut._data(e,i)||ut._data(e,i,{empty:ut.Callbacks("once memory").add(function(){ut._removeData(e,t+"queue"),ut._removeData(e,i)})})}}),ut.fn.extend({queue:function(e,i){var s=2;return"string"!=typeof e&&(i=e,e="fx",s--),arguments.length<s?ut.queue(this[0],e):i===t?this:this.each(function(){var t=ut.queue(this,e,i);ut._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&ut.dequeue(this,e)})},dequeue:function(e){return this.each(function(){ut.dequeue(this,e)})},delay:function(e,t){return e=ut.fx?ut.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,i){var s=setTimeout(t,e);i.stop=function(){clearTimeout(s)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,i){var s,n=1,r=ut.Deferred(),a=this,o=this.length,l=function(){--n||r.resolveWith(a,[a])};for("string"!=typeof e&&(i=e,e=t),e=e||"fx";o--;)s=ut._data(a[o],e+"queueHooks"),s&&s.empty&&(n++,s.empty.add(l));return l(),r.promise(i)}});var Mt,Pt,Nt=/[\t\r\n\f]/g,Dt=/\r/g,At=/^(?:input|select|textarea|button|object)$/i,It=/^(?:a|area)$/i,Ft=/^(?:checked|selected)$/i,Rt=ut.support.getSetAttribute,kt=ut.support.input;ut.fn.extend({attr:function(e,t){return ut.access(this,ut.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){ut.removeAttr(this,e)})},prop:function(e,t){return ut.access(this,ut.prop,e,t,arguments.length>1)},removeProp:function(e){return e=ut.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(i){}})},addClass:function(e){var t,i,s,n,r,a=0,o=this.length,l="string"==typeof e&&e;if(ut.isFunction(e))return this.each(function(t){ut(this).addClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(dt)||[];o>a;a++)if(i=this[a],s=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Nt," "):" ")){for(r=0;n=t[r++];)s.indexOf(" "+n+" ")<0&&(s+=n+" ");i.className=ut.trim(s)}return this},removeClass:function(e){var t,i,s,n,r,a=0,o=this.length,l=0===arguments.length||"string"==typeof e&&e;if(ut.isFunction(e))return this.each(function(t){ut(this).removeClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(dt)||[];o>a;a++)if(i=this[a],s=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Nt," "):"")){for(r=0;n=t[r++];)for(;s.indexOf(" "+n+" ")>=0;)s=s.replace(" "+n+" "," ");i.className=e?ut.trim(s):""}return this},toggleClass:function(e,t){var i=typeof e,s="boolean"==typeof t;return ut.isFunction(e)?this.each(function(i){ut(this).toggleClass(e.call(this,i,this.className,t),t)}):this.each(function(){if("string"===i)for(var n,r=0,a=ut(this),o=t,l=e.match(dt)||[];n=l[r++];)o=s?o:!a.hasClass(n),a[o?"addClass":"removeClass"](n);else(i===Y||"boolean"===i)&&(this.className&&ut._data(this,"__className__",this.className),this.className=this.className||e===!1?"":ut._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",i=0,s=this.length;s>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(Nt," ").indexOf(t)>=0)return!0;return!1},val:function(e){var i,s,n,r=this[0];{if(arguments.length)return n=ut.isFunction(e),this.each(function(i){var r;1===this.nodeType&&(r=n?e.call(this,i,ut(this).val()):e,null==r?r="":"number"==typeof r?r+="":ut.isArray(r)&&(r=ut.map(r,function(e){return null==e?"":e+""})),s=ut.valHooks[this.type]||ut.valHooks[this.nodeName.toLowerCase()],s&&"set"in s&&s.set(this,r,"value")!==t||(this.value=r))});if(r)return s=ut.valHooks[r.type]||ut.valHooks[r.nodeName.toLowerCase()],s&&"get"in s&&(i=s.get(r,"value"))!==t?i:(i=r.value,"string"==typeof i?i.replace(Dt,""):null==i?"":i)}}}),ut.extend({valHooks:{option:{get:function(e){var t=ut.find.attr(e,"value");return null!=t?t:e.text}},select:{get:function(e){for(var t,i,s=e.options,n=e.selectedIndex,r="select-one"===e.type||0>n,a=r?null:[],o=r?n+1:s.length,l=0>n?o:r?n:0;o>l;l++)if(i=s[l],!(!i.selected&&l!==n||(ut.support.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&ut.nodeName(i.parentNode,"optgroup"))){if(t=ut(i).val(),r)return t;a.push(t)}return a},set:function(e,t){for(var i,s,n=e.options,r=ut.makeArray(t),a=n.length;a--;)s=n[a],(s.selected=ut.inArray(ut(s).val(),r)>=0)&&(i=!0);return i||(e.selectedIndex=-1),r}}},attr:function(e,i,s){var n,r,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a)return typeof e.getAttribute===Y?ut.prop(e,i,s):(1===a&&ut.isXMLDoc(e)||(i=i.toLowerCase(),n=ut.attrHooks[i]||(ut.expr.match.bool.test(i)?Pt:Mt)),s===t?n&&"get"in n&&null!==(r=n.get(e,i))?r:(r=ut.find.attr(e,i),null==r?t:r):null!==s?n&&"set"in n&&(r=n.set(e,s,i))!==t?r:(e.setAttribute(i,s+""),s):(ut.removeAttr(e,i),void 0))},removeAttr:function(e,t){var i,s,n=0,r=t&&t.match(dt);if(r&&1===e.nodeType)for(;i=r[n++];)s=ut.propFix[i]||i,ut.expr.match.bool.test(i)?kt&&Rt||!Ft.test(i)?e[s]=!1:e[ut.camelCase("default-"+i)]=e[s]=!1:ut.attr(e,i,""),e.removeAttribute(Rt?i:s)},attrHooks:{type:{set:function(e,t){if(!ut.support.radioValue&&"radio"===t&&ut.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,i,s){var n,r,a,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return a=1!==o||!ut.isXMLDoc(e),a&&(i=ut.propFix[i]||i,r=ut.propHooks[i]),s!==t?r&&"set"in r&&(n=r.set(e,s,i))!==t?n:e[i]=s:r&&"get"in r&&null!==(n=r.get(e,i))?n:e[i]},propHooks:{tabIndex:{get:function(e){var t=ut.find.attr(e,"tabindex");return t?parseInt(t,10):At.test(e.nodeName)||It.test(e.nodeName)&&e.href?0:-1}}}}),Pt={set:function(e,t,i){return t===!1?ut.removeAttr(e,i):kt&&Rt||!Ft.test(i)?e.setAttribute(!Rt&&ut.propFix[i]||i,i):e[ut.camelCase("default-"+i)]=e[i]=!0,i}},ut.each(ut.expr.match.bool.source.match(/\w+/g),function(e,i){var s=ut.expr.attrHandle[i]||ut.find.attr;ut.expr.attrHandle[i]=kt&&Rt||!Ft.test(i)?function(e,i,n){var r=ut.expr.attrHandle[i],a=n?t:(ut.expr.attrHandle[i]=t)!=s(e,i,n)?i.toLowerCase():null;return ut.expr.attrHandle[i]=r,a}:function(e,i,s){return s?t:e[ut.camelCase("default-"+i)]?i.toLowerCase():null}}),kt&&Rt||(ut.attrHooks.value={set:function(e,t,i){return ut.nodeName(e,"input")?(e.defaultValue=t,void 0):Mt&&Mt.set(e,t,i)}}),Rt||(Mt={set:function(e,i,s){var n=e.getAttributeNode(s);return n||e.setAttributeNode(n=e.ownerDocument.createAttribute(s)),n.value=i+="","value"===s||i===e.getAttribute(s)?i:t}},ut.expr.attrHandle.id=ut.expr.attrHandle.name=ut.expr.attrHandle.coords=function(e,i,s){var n;return s?t:(n=e.getAttributeNode(i))&&""!==n.value?n.value:null},ut.valHooks.button={get:function(e,i){var s=e.getAttributeNode(i);return s&&s.specified?s.value:t},set:Mt.set},ut.attrHooks.contenteditable={set:function(e,t,i){Mt.set(e,""===t?!1:t,i)}},ut.each(["width","height"],function(e,t){ut.attrHooks[t]={set:function(e,i){return""===i?(e.setAttribute(t,"auto"),i):void 0}}})),ut.support.hrefNormalized||ut.each(["href","src"],function(e,t){ut.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),ut.support.style||(ut.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""
}}),ut.support.optSelected||(ut.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}),ut.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ut.propFix[this.toLowerCase()]=this}),ut.support.enctype||(ut.propFix.enctype="encoding"),ut.each(["radio","checkbox"],function(){ut.valHooks[this]={set:function(e,t){return ut.isArray(t)?e.checked=ut.inArray(ut(e).val(),t)>=0:void 0}},ut.support.checkOn||(ut.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var _t=/^(?:input|select|textarea)$/i,jt=/^key/,Gt=/^(?:mouse|contextmenu)|click/,Bt=/^(?:focusinfocus|focusoutblur)$/,zt=/^([^.]*)(?:\.(.+)|)$/;ut.event={global:{},add:function(e,i,s,n,r){var a,o,l,h,u,c,d,p,f,m,y,g=ut._data(e);if(g){for(s.handler&&(h=s,s=h.handler,r=h.selector),s.guid||(s.guid=ut.guid++),(o=g.events)||(o=g.events={}),(c=g.handle)||(c=g.handle=function(e){return typeof ut===Y||e&&ut.event.triggered===e.type?t:ut.event.dispatch.apply(c.elem,arguments)},c.elem=e),i=(i||"").match(dt)||[""],l=i.length;l--;)a=zt.exec(i[l])||[],f=y=a[1],m=(a[2]||"").split(".").sort(),f&&(u=ut.event.special[f]||{},f=(r?u.delegateType:u.bindType)||f,u=ut.event.special[f]||{},d=ut.extend({type:f,origType:y,data:n,handler:s,guid:s.guid,selector:r,needsContext:r&&ut.expr.match.needsContext.test(r),namespace:m.join(".")},h),(p=o[f])||(p=o[f]=[],p.delegateCount=0,u.setup&&u.setup.call(e,n,m,c)!==!1||(e.addEventListener?e.addEventListener(f,c,!1):e.attachEvent&&e.attachEvent("on"+f,c))),u.add&&(u.add.call(e,d),d.handler.guid||(d.handler.guid=s.guid)),r?p.splice(p.delegateCount++,0,d):p.push(d),ut.event.global[f]=!0);e=null}},remove:function(e,t,i,s,n){var r,a,o,l,h,u,c,d,p,f,m,y=ut.hasData(e)&&ut._data(e);if(y&&(u=y.events)){for(t=(t||"").match(dt)||[""],h=t.length;h--;)if(o=zt.exec(t[h])||[],p=m=o[1],f=(o[2]||"").split(".").sort(),p){for(c=ut.event.special[p]||{},p=(s?c.delegateType:c.bindType)||p,d=u[p]||[],o=o[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=r=d.length;r--;)a=d[r],!n&&m!==a.origType||i&&i.guid!==a.guid||o&&!o.test(a.namespace)||s&&s!==a.selector&&("**"!==s||!a.selector)||(d.splice(r,1),a.selector&&d.delegateCount--,c.remove&&c.remove.call(e,a));l&&!d.length&&(c.teardown&&c.teardown.call(e,f,y.handle)!==!1||ut.removeEvent(e,p,y.handle),delete u[p])}else for(p in u)ut.event.remove(e,p+t[h],i,s,!0);ut.isEmptyObject(u)&&(delete y.handle,ut._removeData(e,"events"))}},trigger:function(i,s,n,r){var a,o,l,h,u,c,d,p=[n||K],f=lt.call(i,"type")?i.type:i,m=lt.call(i,"namespace")?i.namespace.split("."):[];if(l=c=n=n||K,3!==n.nodeType&&8!==n.nodeType&&!Bt.test(f+ut.event.triggered)&&(f.indexOf(".")>=0&&(m=f.split("."),f=m.shift(),m.sort()),o=f.indexOf(":")<0&&"on"+f,i=i[ut.expando]?i:new ut.Event(f,"object"==typeof i&&i),i.isTrigger=r?2:3,i.namespace=m.join("."),i.namespace_re=i.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,i.result=t,i.target||(i.target=n),s=null==s?[i]:ut.makeArray(s,[i]),u=ut.event.special[f]||{},r||!u.trigger||u.trigger.apply(n,s)!==!1)){if(!r&&!u.noBubble&&!ut.isWindow(n)){for(h=u.delegateType||f,Bt.test(h+f)||(l=l.parentNode);l;l=l.parentNode)p.push(l),c=l;c===(n.ownerDocument||K)&&p.push(c.defaultView||c.parentWindow||e)}for(d=0;(l=p[d++])&&!i.isPropagationStopped();)i.type=d>1?h:u.bindType||f,a=(ut._data(l,"events")||{})[i.type]&&ut._data(l,"handle"),a&&a.apply(l,s),a=o&&l[o],a&&ut.acceptData(l)&&a.apply&&a.apply(l,s)===!1&&i.preventDefault();if(i.type=f,!r&&!i.isDefaultPrevented()&&(!u._default||u._default.apply(p.pop(),s)===!1)&&ut.acceptData(n)&&o&&n[f]&&!ut.isWindow(n)){c=n[o],c&&(n[o]=null),ut.event.triggered=f;try{n[f]()}catch(y){}ut.event.triggered=t,c&&(n[o]=c)}return i.result}},dispatch:function(e){e=ut.event.fix(e);var i,s,n,r,a,o=[],l=rt.call(arguments),h=(ut._data(this,"events")||{})[e.type]||[],u=ut.event.special[e.type]||{};if(l[0]=e,e.delegateTarget=this,!u.preDispatch||u.preDispatch.call(this,e)!==!1){for(o=ut.event.handlers.call(this,e,h),i=0;(r=o[i++])&&!e.isPropagationStopped();)for(e.currentTarget=r.elem,a=0;(n=r.handlers[a++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(n.namespace))&&(e.handleObj=n,e.data=n.data,s=((ut.event.special[n.origType]||{}).handle||n.handler).apply(r.elem,l),s!==t&&(e.result=s)===!1&&(e.preventDefault(),e.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,e),e.result}},handlers:function(e,i){var s,n,r,a,o=[],l=i.delegateCount,h=e.target;if(l&&h.nodeType&&(!e.button||"click"!==e.type))for(;h!=this;h=h.parentNode||this)if(1===h.nodeType&&(h.disabled!==!0||"click"!==e.type)){for(r=[],a=0;l>a;a++)n=i[a],s=n.selector+" ",r[s]===t&&(r[s]=n.needsContext?ut(s,this).index(h)>=0:ut.find(s,this,null,[h]).length),r[s]&&r.push(n);r.length&&o.push({elem:h,handlers:r})}return l<i.length&&o.push({elem:this,handlers:i.slice(l)}),o},fix:function(e){if(e[ut.expando])return e;var t,i,s,n=e.type,r=e,a=this.fixHooks[n];for(a||(this.fixHooks[n]=a=Gt.test(n)?this.mouseHooks:jt.test(n)?this.keyHooks:{}),s=a.props?this.props.concat(a.props):this.props,e=new ut.Event(r),t=s.length;t--;)i=s[t],e[i]=r[i];return e.target||(e.target=r.srcElement||K),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,a.filter?a.filter(e,r):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,i){var s,n,r,a=i.button,o=i.fromElement;return null==e.pageX&&null!=i.clientX&&(n=e.target.ownerDocument||K,r=n.documentElement,s=n.body,e.pageX=i.clientX+(r&&r.scrollLeft||s&&s.scrollLeft||0)-(r&&r.clientLeft||s&&s.clientLeft||0),e.pageY=i.clientY+(r&&r.scrollTop||s&&s.scrollTop||0)-(r&&r.clientTop||s&&s.clientTop||0)),!e.relatedTarget&&o&&(e.relatedTarget=o===e.target?i.toElement:o),e.which||a===t||(e.which=1&a?1:2&a?3:4&a?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==u()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===u()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return ut.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(e){return ut.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,i,s){var n=ut.extend(new ut.Event,i,{type:e,isSimulated:!0,originalEvent:{}});s?ut.event.trigger(n,null,t):ut.event.dispatch.call(t,n),n.isDefaultPrevented()&&i.preventDefault()}},ut.removeEvent=K.removeEventListener?function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)}:function(e,t,i){var s="on"+t;e.detachEvent&&(typeof e[s]===Y&&(e[s]=null),e.detachEvent(s,i))},ut.Event=function(e,t){return this instanceof ut.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?l:h):this.type=e,t&&ut.extend(this,t),this.timeStamp=e&&e.timeStamp||ut.now(),this[ut.expando]=!0,void 0):new ut.Event(e,t)},ut.Event.prototype={isDefaultPrevented:h,isPropagationStopped:h,isImmediatePropagationStopped:h,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=l,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=l,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=l,this.stopPropagation()}},ut.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){ut.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,s=this,n=e.relatedTarget,r=e.handleObj;return(!n||n!==s&&!ut.contains(s,n))&&(e.type=r.origType,i=r.handler.apply(this,arguments),e.type=t),i}}}),ut.support.submitBubbles||(ut.event.special.submit={setup:function(){return ut.nodeName(this,"form")?!1:(ut.event.add(this,"click._submit keypress._submit",function(e){var i=e.target,s=ut.nodeName(i,"input")||ut.nodeName(i,"button")?i.form:t;s&&!ut._data(s,"submitBubbles")&&(ut.event.add(s,"submit._submit",function(e){e._submit_bubble=!0}),ut._data(s,"submitBubbles",!0))}),void 0)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&ut.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return ut.nodeName(this,"form")?!1:(ut.event.remove(this,"._submit"),void 0)}}),ut.support.changeBubbles||(ut.event.special.change={setup:function(){return _t.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(ut.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),ut.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),ut.event.simulate("change",this,e,!0)})),!1):(ut.event.add(this,"beforeactivate._change",function(e){var t=e.target;_t.test(t.nodeName)&&!ut._data(t,"changeBubbles")&&(ut.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||ut.event.simulate("change",this.parentNode,e,!0)}),ut._data(t,"changeBubbles",!0))}),void 0)},handle:function(e){var t=e.target;return this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type?e.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return ut.event.remove(this,"._change"),!_t.test(this.nodeName)}}),ut.support.focusinBubbles||ut.each({focus:"focusin",blur:"focusout"},function(e,t){var i=0,s=function(e){ut.event.simulate(t,e.target,ut.event.fix(e),!0)};ut.event.special[t]={setup:function(){0===i++&&K.addEventListener(e,s,!0)},teardown:function(){0===--i&&K.removeEventListener(e,s,!0)}}}),ut.fn.extend({on:function(e,i,s,n,r){var a,o;if("object"==typeof e){"string"!=typeof i&&(s=s||i,i=t);for(a in e)this.on(a,i,s,e[a],r);return this}if(null==s&&null==n?(n=i,s=i=t):null==n&&("string"==typeof i?(n=s,s=t):(n=s,s=i,i=t)),n===!1)n=h;else if(!n)return this;return 1===r&&(o=n,n=function(e){return ut().off(e),o.apply(this,arguments)},n.guid=o.guid||(o.guid=ut.guid++)),this.each(function(){ut.event.add(this,e,n,s,i)})},one:function(e,t,i,s){return this.on(e,t,i,s,1)},off:function(e,i,s){var n,r;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,ut(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(r in e)this.off(r,i,e[r]);return this}return(i===!1||"function"==typeof i)&&(s=i,i=t),s===!1&&(s=h),this.each(function(){ut.event.remove(this,e,s,i)})},trigger:function(e,t){return this.each(function(){ut.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];return i?ut.event.trigger(e,t,i,!0):void 0}});var Wt=/^.[^:#\[\.,]*$/,Ht=/^(?:parents|prev(?:Until|All))/,Vt=ut.expr.match.needsContext,Ut={children:!0,contents:!0,next:!0,prev:!0};ut.fn.extend({find:function(e){var t,i=[],s=this,n=s.length;if("string"!=typeof e)return this.pushStack(ut(e).filter(function(){for(t=0;n>t;t++)if(ut.contains(s[t],this))return!0}));for(t=0;n>t;t++)ut.find(e,s[t],i);return i=this.pushStack(n>1?ut.unique(i):i),i.selector=this.selector?this.selector+" "+e:e,i},has:function(e){var t,i=ut(e,this),s=i.length;return this.filter(function(){for(t=0;s>t;t++)if(ut.contains(this,i[t]))return!0})},not:function(e){return this.pushStack(d(this,e||[],!0))},filter:function(e){return this.pushStack(d(this,e||[],!1))},is:function(e){return!!d(this,"string"==typeof e&&Vt.test(e)?ut(e):e||[],!1).length},closest:function(e,t){for(var i,s=0,n=this.length,r=[],a=Vt.test(e)||"string"!=typeof e?ut(e,t||this.context):0;n>s;s++)for(i=this[s];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(a?a.index(i)>-1:1===i.nodeType&&ut.find.matchesSelector(i,e))){i=r.push(i);break}return this.pushStack(r.length>1?ut.unique(r):r)},index:function(e){return e?"string"==typeof e?ut.inArray(this[0],ut(e)):ut.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var i="string"==typeof e?ut(e,t):ut.makeArray(e&&e.nodeType?[e]:e),s=ut.merge(this.get(),i);return this.pushStack(ut.unique(s))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),ut.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return ut.dir(e,"parentNode")},parentsUntil:function(e,t,i){return ut.dir(e,"parentNode",i)},next:function(e){return c(e,"nextSibling")},prev:function(e){return c(e,"previousSibling")},nextAll:function(e){return ut.dir(e,"nextSibling")},prevAll:function(e){return ut.dir(e,"previousSibling")},nextUntil:function(e,t,i){return ut.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return ut.dir(e,"previousSibling",i)},siblings:function(e){return ut.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return ut.sibling(e.firstChild)},contents:function(e){return ut.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:ut.merge([],e.childNodes)}},function(e,t){ut.fn[e]=function(i,s){var n=ut.map(this,t,i);return"Until"!==e.slice(-5)&&(s=i),s&&"string"==typeof s&&(n=ut.filter(s,n)),this.length>1&&(Ut[e]||(n=ut.unique(n)),Ht.test(e)&&(n=n.reverse())),this.pushStack(n)}}),ut.extend({filter:function(e,t,i){var s=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===s.nodeType?ut.find.matchesSelector(s,e)?[s]:[]:ut.find.matches(e,ut.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,i,s){for(var n=[],r=e[i];r&&9!==r.nodeType&&(s===t||1!==r.nodeType||!ut(r).is(s));)1===r.nodeType&&n.push(r),r=r[i];return n},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}});var Xt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",qt=/ jQuery\d+="(?:null|\d+)"/g,Yt=new RegExp("<(?:"+Xt+")[\\s/>]","i"),Zt=/^\s+/,Kt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,$t=/<([\w:]+)/,Qt=/<tbody/i,Jt=/<|&#?\w+;/,ei=/<(?:script|style|link)/i,ti=/^(?:checkbox|radio)$/i,ii=/checked\s*(?:[^=]|=\s*.checked.)/i,si=/^$|\/(?:java|ecma)script/i,ni=/^true\/(.*)/,ri=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ai={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:ut.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},oi=p(K),li=oi.appendChild(K.createElement("div"));ai.optgroup=ai.option,ai.tbody=ai.tfoot=ai.colgroup=ai.caption=ai.thead,ai.th=ai.td,ut.fn.extend({text:function(e){return ut.access(this,function(e){return e===t?ut.text(this):this.empty().append((this[0]&&this[0].ownerDocument||K).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=f(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=f(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var i,s=e?ut.filter(e,this):this,n=0;null!=(i=s[n]);n++)t||1!==i.nodeType||ut.cleanData(E(i)),i.parentNode&&(t&&ut.contains(i.ownerDocument,i)&&g(E(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&ut.cleanData(E(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&ut.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return ut.clone(this,e,t)})},html:function(e){return ut.access(this,function(e){var i=this[0]||{},s=0,n=this.length;if(e===t)return 1===i.nodeType?i.innerHTML.replace(qt,""):t;if(!("string"!=typeof e||ei.test(e)||!ut.support.htmlSerialize&&Yt.test(e)||!ut.support.leadingWhitespace&&Zt.test(e)||ai[($t.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(Kt,"<$1></$2>");try{for(;n>s;s++)i=this[s]||{},1===i.nodeType&&(ut.cleanData(E(i,!1)),i.innerHTML=e);i=0}catch(r){}}i&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=ut.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(i){var s=e[t++],n=e[t++];n&&(s&&s.parentNode!==n&&(s=this.nextSibling),ut(this).remove(),n.insertBefore(i,s))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,i){e=st.apply([],e);var s,n,r,a,o,l,h=0,u=this.length,c=this,d=u-1,p=e[0],f=ut.isFunction(p);if(f||!(1>=u||"string"!=typeof p||ut.support.checkClone)&&ii.test(p))return this.each(function(s){var n=c.eq(s);f&&(e[0]=p.call(this,s,n.html())),n.domManip(e,t,i)});if(u&&(l=ut.buildFragment(e,this[0].ownerDocument,!1,!i&&this),s=l.firstChild,1===l.childNodes.length&&(l=s),s)){for(a=ut.map(E(l,"script"),m),r=a.length;u>h;h++)n=l,h!==d&&(n=ut.clone(n,!0,!0),r&&ut.merge(a,E(n,"script"))),t.call(this[h],n,h);if(r)for(o=a[a.length-1].ownerDocument,ut.map(a,y),h=0;r>h;h++)n=a[h],si.test(n.type||"")&&!ut._data(n,"globalEval")&&ut.contains(o,n)&&(n.src?ut._evalUrl(n.src):ut.globalEval((n.text||n.textContent||n.innerHTML||"").replace(ri,"")));l=s=null}return this}}),ut.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){ut.fn[e]=function(e){for(var i,s=0,n=[],r=ut(e),a=r.length-1;a>=s;s++)i=s===a?this:this.clone(!0),ut(r[s])[t](i),nt.apply(n,i.get());return this.pushStack(n)}}),ut.extend({clone:function(e,t,i){var s,n,r,a,o,l=ut.contains(e.ownerDocument,e);if(ut.support.html5Clone||ut.isXMLDoc(e)||!Yt.test("<"+e.nodeName+">")?r=e.cloneNode(!0):(li.innerHTML=e.outerHTML,li.removeChild(r=li.firstChild)),!(ut.support.noCloneEvent&&ut.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||ut.isXMLDoc(e)))for(s=E(r),o=E(e),a=0;null!=(n=o[a]);++a)s[a]&&x(n,s[a]);if(t)if(i)for(o=o||E(e),s=s||E(r),a=0;null!=(n=o[a]);a++)v(n,s[a]);else v(e,r);return s=E(r,"script"),s.length>0&&g(s,!l&&E(e,"script")),s=o=n=null,r},buildFragment:function(e,t,i,s){for(var n,r,a,o,l,h,u,c=e.length,d=p(t),f=[],m=0;c>m;m++)if(r=e[m],r||0===r)if("object"===ut.type(r))ut.merge(f,r.nodeType?[r]:r);else if(Jt.test(r)){for(o=o||d.appendChild(t.createElement("div")),l=($t.exec(r)||["",""])[1].toLowerCase(),u=ai[l]||ai._default,o.innerHTML=u[1]+r.replace(Kt,"<$1></$2>")+u[2],n=u[0];n--;)o=o.lastChild;if(!ut.support.leadingWhitespace&&Zt.test(r)&&f.push(t.createTextNode(Zt.exec(r)[0])),!ut.support.tbody)for(r="table"!==l||Qt.test(r)?"<table>"!==u[1]||Qt.test(r)?0:o:o.firstChild,n=r&&r.childNodes.length;n--;)ut.nodeName(h=r.childNodes[n],"tbody")&&!h.childNodes.length&&r.removeChild(h);for(ut.merge(f,o.childNodes),o.textContent="";o.firstChild;)o.removeChild(o.firstChild);o=d.lastChild}else f.push(t.createTextNode(r));for(o&&d.removeChild(o),ut.support.appendChecked||ut.grep(E(f,"input"),b),m=0;r=f[m++];)if((!s||-1===ut.inArray(r,s))&&(a=ut.contains(r.ownerDocument,r),o=E(d.appendChild(r),"script"),a&&g(o),i))for(n=0;r=o[n++];)si.test(r.type||"")&&i.push(r);return o=null,d},cleanData:function(e,t){for(var i,s,n,r,a=0,o=ut.expando,l=ut.cache,h=ut.support.deleteExpando,u=ut.event.special;null!=(i=e[a]);a++)if((t||ut.acceptData(i))&&(n=i[o],r=n&&l[n])){if(r.events)for(s in r.events)u[s]?ut.event.remove(i,s):ut.removeEvent(i,s,r.handle);l[n]&&(delete l[n],h?delete i[o]:typeof i.removeAttribute!==Y?i.removeAttribute(o):i[o]=null,tt.push(n))}},_evalUrl:function(e){return ut.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),ut.fn.extend({wrapAll:function(e){if(ut.isFunction(e))return this.each(function(t){ut(this).wrapAll(e.call(this,t))});if(this[0]){var t=ut(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return ut.isFunction(e)?this.each(function(t){ut(this).wrapInner(e.call(this,t))}):this.each(function(){var t=ut(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=ut.isFunction(e);return this.each(function(i){ut(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){ut.nodeName(this,"body")||ut(this).replaceWith(this.childNodes)}).end()}});var hi,ui,ci,di=/alpha\([^)]*\)/i,pi=/opacity\s*=\s*([^)]*)/,fi=/^(top|right|bottom|left)$/,mi=/^(none|table(?!-c[ea]).+)/,yi=/^margin/,gi=new RegExp("^("+ct+")(.*)$","i"),vi=new RegExp("^("+ct+")(?!px)[a-z%]+$","i"),xi=new RegExp("^([+-])=("+ct+")","i"),Ei={BODY:"block"},bi={position:"absolute",visibility:"hidden",display:"block"},Li={letterSpacing:0,fontWeight:400},Si=["Top","Right","Bottom","Left"],Ci=["Webkit","O","Moz","ms"];ut.fn.extend({css:function(e,i){return ut.access(this,function(e,i,s){var n,r,a={},o=0;if(ut.isArray(i)){for(r=ui(e),n=i.length;n>o;o++)a[i[o]]=ut.css(e,i[o],!1,r);return a}return s!==t?ut.style(e,i,s):ut.css(e,i)},e,i,arguments.length>1)},show:function(){return C(this,!0)},hide:function(){return C(this)},toggle:function(e){var t="boolean"==typeof e;return this.each(function(){(t?e:S(this))?ut(this).show():ut(this).hide()})}}),ut.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=ci(e,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":ut.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,i,s,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,a,o,l=ut.camelCase(i),h=e.style;if(i=ut.cssProps[l]||(ut.cssProps[l]=L(h,l)),o=ut.cssHooks[i]||ut.cssHooks[l],s===t)return o&&"get"in o&&(r=o.get(e,!1,n))!==t?r:h[i];if(a=typeof s,"string"===a&&(r=xi.exec(s))&&(s=(r[1]+1)*r[2]+parseFloat(ut.css(e,i)),a="number"),!(null==s||"number"===a&&isNaN(s)||("number"!==a||ut.cssNumber[l]||(s+="px"),ut.support.clearCloneStyle||""!==s||0!==i.indexOf("background")||(h[i]="inherit"),o&&"set"in o&&(s=o.set(e,s,n))===t)))try{h[i]=s}catch(u){}}},css:function(e,i,s,n){var r,a,o,l=ut.camelCase(i);return i=ut.cssProps[l]||(ut.cssProps[l]=L(e.style,l)),o=ut.cssHooks[i]||ut.cssHooks[l],o&&"get"in o&&(a=o.get(e,!0,s)),a===t&&(a=ci(e,i,n)),"normal"===a&&i in Li&&(a=Li[i]),""===s||s?(r=parseFloat(a),s===!0||ut.isNumeric(r)?r||0:a):a}}),e.getComputedStyle?(ui=function(t){return e.getComputedStyle(t,null)},ci=function(e,i,s){var n,r,a,o=s||ui(e),l=o?o.getPropertyValue(i)||o[i]:t,h=e.style;return o&&(""!==l||ut.contains(e.ownerDocument,e)||(l=ut.style(e,i)),vi.test(l)&&yi.test(i)&&(n=h.width,r=h.minWidth,a=h.maxWidth,h.minWidth=h.maxWidth=h.width=l,l=o.width,h.width=n,h.minWidth=r,h.maxWidth=a)),l}):K.documentElement.currentStyle&&(ui=function(e){return e.currentStyle},ci=function(e,i,s){var n,r,a,o=s||ui(e),l=o?o[i]:t,h=e.style;return null==l&&h&&h[i]&&(l=h[i]),vi.test(l)&&!fi.test(i)&&(n=h.left,r=e.runtimeStyle,a=r&&r.left,a&&(r.left=e.currentStyle.left),h.left="fontSize"===i?"1em":l,l=h.pixelLeft+"px",h.left=n,a&&(r.left=a)),""===l?"auto":l}),ut.each(["height","width"],function(e,t){ut.cssHooks[t]={get:function(e,i,s){return i?0===e.offsetWidth&&mi.test(ut.css(e,"display"))?ut.swap(e,bi,function(){return T(e,t,s)}):T(e,t,s):void 0},set:function(e,i,s){var n=s&&ui(e);return w(e,i,s?O(e,t,s,ut.support.boxSizing&&"border-box"===ut.css(e,"boxSizing",!1,n),n):0)}}}),ut.support.opacity||(ut.cssHooks.opacity={get:function(e,t){return pi.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var i=e.style,s=e.currentStyle,n=ut.isNumeric(t)?"alpha(opacity="+100*t+")":"",r=s&&s.filter||i.filter||"";i.zoom=1,(t>=1||""===t)&&""===ut.trim(r.replace(di,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===t||s&&!s.filter)||(i.filter=di.test(r)?r.replace(di,n):r+" "+n)}}),ut(function(){ut.support.reliableMarginRight||(ut.cssHooks.marginRight={get:function(e,t){return t?ut.swap(e,{display:"inline-block"},ci,[e,"marginRight"]):void 0}}),!ut.support.pixelPosition&&ut.fn.position&&ut.each(["top","left"],function(e,t){ut.cssHooks[t]={get:function(e,i){return i?(i=ci(e,t),vi.test(i)?ut(e).position()[t]+"px":i):void 0}}})}),ut.expr&&ut.expr.filters&&(ut.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!ut.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||ut.css(e,"display"))},ut.expr.filters.visible=function(e){return!ut.expr.filters.hidden(e)}),ut.each({margin:"",padding:"",border:"Width"},function(e,t){ut.cssHooks[e+t]={expand:function(i){for(var s=0,n={},r="string"==typeof i?i.split(" "):[i];4>s;s++)n[e+Si[s]+t]=r[s]||r[s-2]||r[0];return n}},yi.test(e)||(ut.cssHooks[e+t].set=w)});var wi=/%20/g,Oi=/\[\]$/,Ti=/\r?\n/g,Mi=/^(?:submit|button|image|reset|file)$/i,Pi=/^(?:input|select|textarea|keygen)/i;ut.fn.extend({serialize:function(){return ut.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=ut.prop(this,"elements");return e?ut.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!ut(this).is(":disabled")&&Pi.test(this.nodeName)&&!Mi.test(e)&&(this.checked||!ti.test(e))}).map(function(e,t){var i=ut(this).val();return null==i?null:ut.isArray(i)?ut.map(i,function(e){return{name:t.name,value:e.replace(Ti,"\r\n")}}):{name:t.name,value:i.replace(Ti,"\r\n")}}).get()}}),ut.param=function(e,i){var s,n=[],r=function(e,t){t=ut.isFunction(t)?t():null==t?"":t,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(i===t&&(i=ut.ajaxSettings&&ut.ajaxSettings.traditional),ut.isArray(e)||e.jquery&&!ut.isPlainObject(e))ut.each(e,function(){r(this.name,this.value)});else for(s in e)N(s,e[s],i,r);return n.join("&").replace(wi,"+")},ut.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){ut.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}),ut.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,s){return this.on(t,e,i,s)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)}});var Ni,Di,Ai=ut.now(),Ii=/\?/,Fi=/#.*$/,Ri=/([?&])_=[^&]*/,ki=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,_i=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,ji=/^(?:GET|HEAD)$/,Gi=/^\/\//,Bi=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,zi=ut.fn.load,Wi={},Hi={},Vi="*/".concat("*");try{Di=Z.href}catch(Ui){Di=K.createElement("a"),Di.href="",Di=Di.href}Ni=Bi.exec(Di.toLowerCase())||[],ut.fn.load=function(e,i,s){if("string"!=typeof e&&zi)return zi.apply(this,arguments);var n,r,a,o=this,l=e.indexOf(" ");return l>=0&&(n=e.slice(l,e.length),e=e.slice(0,l)),ut.isFunction(i)?(s=i,i=t):i&&"object"==typeof i&&(a="POST"),o.length>0&&ut.ajax({url:e,type:a,dataType:"html",data:i}).done(function(e){r=arguments,o.html(n?ut("<div>").append(ut.parseHTML(e)).find(n):e)}).complete(s&&function(e,t){o.each(s,r||[e.responseText,t,e])}),this},ut.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){ut.fn[t]=function(e){return this.on(t,e)}}),ut.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Di,type:"GET",isLocal:_i.test(Ni[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Vi,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":ut.parseJSON,"text xml":ut.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?I(I(e,ut.ajaxSettings),t):I(ut.ajaxSettings,e)},ajaxPrefilter:D(Wi),ajaxTransport:D(Hi),ajax:function(e,i){function s(e,i,s,n){var r,c,v,x,b,S=i;2!==E&&(E=2,l&&clearTimeout(l),u=t,o=n||"",L.readyState=e>0?4:0,r=e>=200&&300>e||304===e,s&&(x=F(d,L,s)),x=R(d,x,L,r),r?(d.ifModified&&(b=L.getResponseHeader("Last-Modified"),b&&(ut.lastModified[a]=b),b=L.getResponseHeader("etag"),b&&(ut.etag[a]=b)),204===e||"HEAD"===d.type?S="nocontent":304===e?S="notmodified":(S=x.state,c=x.data,v=x.error,r=!v)):(v=S,(e||!S)&&(S="error",0>e&&(e=0))),L.status=e,L.statusText=(i||S)+"",r?m.resolveWith(p,[c,S,L]):m.rejectWith(p,[L,S,v]),L.statusCode(g),g=t,h&&f.trigger(r?"ajaxSuccess":"ajaxError",[L,d,r?c:v]),y.fireWith(p,[L,S]),h&&(f.trigger("ajaxComplete",[L,d]),--ut.active||ut.event.trigger("ajaxStop")))}"object"==typeof e&&(i=e,e=t),i=i||{};var n,r,a,o,l,h,u,c,d=ut.ajaxSetup({},i),p=d.context||d,f=d.context&&(p.nodeType||p.jquery)?ut(p):ut.event,m=ut.Deferred(),y=ut.Callbacks("once memory"),g=d.statusCode||{},v={},x={},E=0,b="canceled",L={readyState:0,getResponseHeader:function(e){var t;if(2===E){if(!c)for(c={};t=ki.exec(o);)c[t[1].toLowerCase()]=t[2];t=c[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===E?o:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return E||(e=x[i]=x[i]||e,v[e]=t),this},overrideMimeType:function(e){return E||(d.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>E)for(t in e)g[t]=[g[t],e[t]];else L.always(e[L.status]);return this},abort:function(e){var t=e||b;return u&&u.abort(t),s(0,t),this}};if(m.promise(L).complete=y.add,L.success=L.done,L.error=L.fail,d.url=((e||d.url||Di)+"").replace(Fi,"").replace(Gi,Ni[1]+"//"),d.type=i.method||i.type||d.method||d.type,d.dataTypes=ut.trim(d.dataType||"*").toLowerCase().match(dt)||[""],null==d.crossDomain&&(n=Bi.exec(d.url.toLowerCase()),d.crossDomain=!(!n||n[1]===Ni[1]&&n[2]===Ni[2]&&(n[3]||("http:"===n[1]?"80":"443"))===(Ni[3]||("http:"===Ni[1]?"80":"443")))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=ut.param(d.data,d.traditional)),A(Wi,d,i,L),2===E)return L;h=d.global,h&&0===ut.active++&&ut.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!ji.test(d.type),a=d.url,d.hasContent||(d.data&&(a=d.url+=(Ii.test(a)?"&":"?")+d.data,delete d.data),d.cache===!1&&(d.url=Ri.test(a)?a.replace(Ri,"$1_="+Ai++):a+(Ii.test(a)?"&":"?")+"_="+Ai++)),d.ifModified&&(ut.lastModified[a]&&L.setRequestHeader("If-Modified-Since",ut.lastModified[a]),ut.etag[a]&&L.setRequestHeader("If-None-Match",ut.etag[a])),(d.data&&d.hasContent&&d.contentType!==!1||i.contentType)&&L.setRequestHeader("Content-Type",d.contentType),L.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+Vi+"; q=0.01":""):d.accepts["*"]);for(r in d.headers)L.setRequestHeader(r,d.headers[r]);if(d.beforeSend&&(d.beforeSend.call(p,L,d)===!1||2===E))return L.abort();b="abort";for(r in{success:1,error:1,complete:1})L[r](d[r]);if(u=A(Hi,d,i,L)){L.readyState=1,h&&f.trigger("ajaxSend",[L,d]),d.async&&d.timeout>0&&(l=setTimeout(function(){L.abort("timeout")},d.timeout));try{E=1,u.send(v,s)}catch(S){if(!(2>E))throw S;s(-1,S)}}else s(-1,"No Transport");return L},getJSON:function(e,t,i){return ut.get(e,t,i,"json")},getScript:function(e,i){return ut.get(e,t,i,"script")}}),ut.each(["get","post"],function(e,i){ut[i]=function(e,s,n,r){return ut.isFunction(s)&&(r=r||n,n=s,s=t),ut.ajax({url:e,type:i,dataType:r,data:s,success:n})}}),ut.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return ut.globalEval(e),e}}}),ut.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)
}),ut.ajaxTransport("script",function(e){if(e.crossDomain){var i,s=K.head||ut("head")[0]||K.documentElement;return{send:function(t,n){i=K.createElement("script"),i.async=!0,e.scriptCharset&&(i.charset=e.scriptCharset),i.src=e.url,i.onload=i.onreadystatechange=function(e,t){(t||!i.readyState||/loaded|complete/.test(i.readyState))&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),i=null,t||n(200,"success"))},s.insertBefore(i,s.firstChild)},abort:function(){i&&i.onload(t,!0)}}}});var Xi=[],qi=/(=)\?(?=&|$)|\?\?/;ut.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Xi.pop()||ut.expando+"_"+Ai++;return this[e]=!0,e}}),ut.ajaxPrefilter("json jsonp",function(i,s,n){var r,a,o,l=i.jsonp!==!1&&(qi.test(i.url)?"url":"string"==typeof i.data&&!(i.contentType||"").indexOf("application/x-www-form-urlencoded")&&qi.test(i.data)&&"data");return l||"jsonp"===i.dataTypes[0]?(r=i.jsonpCallback=ut.isFunction(i.jsonpCallback)?i.jsonpCallback():i.jsonpCallback,l?i[l]=i[l].replace(qi,"$1"+r):i.jsonp!==!1&&(i.url+=(Ii.test(i.url)?"&":"?")+i.jsonp+"="+r),i.converters["script json"]=function(){return o||ut.error(r+" was not called"),o[0]},i.dataTypes[0]="json",a=e[r],e[r]=function(){o=arguments},n.always(function(){e[r]=a,i[r]&&(i.jsonpCallback=s.jsonpCallback,Xi.push(r)),o&&ut.isFunction(a)&&a(o[0]),o=a=t}),"script"):void 0});var Yi,Zi,Ki=0,$i=e.ActiveXObject&&function(){var e;for(e in Yi)Yi[e](t,!0)};ut.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&k()||_()}:k,Zi=ut.ajaxSettings.xhr(),ut.support.cors=!!Zi&&"withCredentials"in Zi,Zi=ut.support.ajax=!!Zi,Zi&&ut.ajaxTransport(function(i){if(!i.crossDomain||ut.support.cors){var s;return{send:function(n,r){var a,o,l=i.xhr();if(i.username?l.open(i.type,i.url,i.async,i.username,i.password):l.open(i.type,i.url,i.async),i.xhrFields)for(o in i.xhrFields)l[o]=i.xhrFields[o];i.mimeType&&l.overrideMimeType&&l.overrideMimeType(i.mimeType),i.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");try{for(o in n)l.setRequestHeader(o,n[o])}catch(h){}l.send(i.hasContent&&i.data||null),s=function(e,n){var o,h,u,c;try{if(s&&(n||4===l.readyState))if(s=t,a&&(l.onreadystatechange=ut.noop,$i&&delete Yi[a]),n)4!==l.readyState&&l.abort();else{c={},o=l.status,h=l.getAllResponseHeaders(),"string"==typeof l.responseText&&(c.text=l.responseText);try{u=l.statusText}catch(d){u=""}o||!i.isLocal||i.crossDomain?1223===o&&(o=204):o=c.text?200:404}}catch(p){n||r(-1,p)}c&&r(o,u,c,h)},i.async?4===l.readyState?setTimeout(s):(a=++Ki,$i&&(Yi||(Yi={},ut(e).unload($i)),Yi[a]=s),l.onreadystatechange=s):s()},abort:function(){s&&s(t,!0)}}}});var Qi,Ji,es=/^(?:toggle|show|hide)$/,ts=new RegExp("^(?:([+-])=|)("+ct+")([a-z%]*)$","i"),is=/queueHooks$/,ss=[W],ns={"*":[function(e,t){var i=this.createTween(e,t),s=i.cur(),n=ts.exec(t),r=n&&n[3]||(ut.cssNumber[e]?"":"px"),a=(ut.cssNumber[e]||"px"!==r&&+s)&&ts.exec(ut.css(i.elem,e)),o=1,l=20;if(a&&a[3]!==r){r=r||a[3],n=n||[],a=+s||1;do o=o||".5",a/=o,ut.style(i.elem,e,a+r);while(o!==(o=i.cur()/s)&&1!==o&&--l)}return n&&(a=i.start=+a||+s||0,i.unit=r,i.end=n[1]?a+(n[1]+1)*n[2]:+n[2]),i}]};ut.Animation=ut.extend(B,{tweener:function(e,t){ut.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var i,s=0,n=e.length;n>s;s++)i=e[s],ns[i]=ns[i]||[],ns[i].unshift(t)},prefilter:function(e,t){t?ss.unshift(e):ss.push(e)}}),ut.Tween=H,H.prototype={constructor:H,init:function(e,t,i,s,n,r){this.elem=e,this.prop=i,this.easing=n||"swing",this.options=t,this.start=this.now=this.cur(),this.end=s,this.unit=r||(ut.cssNumber[i]?"":"px")},cur:function(){var e=H.propHooks[this.prop];return e&&e.get?e.get(this):H.propHooks._default.get(this)},run:function(e){var t,i=H.propHooks[this.prop];return this.pos=t=this.options.duration?ut.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):H.propHooks._default.set(this),this}},H.prototype.init.prototype=H.prototype,H.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=ut.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){ut.fx.step[e.prop]?ut.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[ut.cssProps[e.prop]]||ut.cssHooks[e.prop])?ut.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},H.propHooks.scrollTop=H.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ut.each(["toggle","show","hide"],function(e,t){var i=ut.fn[t];ut.fn[t]=function(e,s,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(V(t,!0),e,s,n)}}),ut.fn.extend({fadeTo:function(e,t,i,s){return this.filter(S).css("opacity",0).show().end().animate({opacity:t},e,i,s)},animate:function(e,t,i,s){var n=ut.isEmptyObject(e),r=ut.speed(t,i,s),a=function(){var t=B(this,ut.extend({},e),r);(n||ut._data(this,"finish"))&&t.stop(!0)};return a.finish=a,n||r.queue===!1?this.each(a):this.queue(r.queue,a)},stop:function(e,i,s){var n=function(e){var t=e.stop;delete e.stop,t(s)};return"string"!=typeof e&&(s=i,i=e,e=t),i&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",r=ut.timers,a=ut._data(this);if(i)a[i]&&a[i].stop&&n(a[i]);else for(i in a)a[i]&&a[i].stop&&is.test(i)&&n(a[i]);for(i=r.length;i--;)r[i].elem!==this||null!=e&&r[i].queue!==e||(r[i].anim.stop(s),t=!1,r.splice(i,1));(t||!s)&&ut.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,i=ut._data(this),s=i[e+"queue"],n=i[e+"queueHooks"],r=ut.timers,a=s?s.length:0;for(i.finish=!0,ut.queue(this,e,[]),n&&n.stop&&n.stop.call(this,!0),t=r.length;t--;)r[t].elem===this&&r[t].queue===e&&(r[t].anim.stop(!0),r.splice(t,1));for(t=0;a>t;t++)s[t]&&s[t].finish&&s[t].finish.call(this);delete i.finish})}}),ut.each({slideDown:V("show"),slideUp:V("hide"),slideToggle:V("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){ut.fn[e]=function(e,i,s){return this.animate(t,e,i,s)}}),ut.speed=function(e,t,i){var s=e&&"object"==typeof e?ut.extend({},e):{complete:i||!i&&t||ut.isFunction(e)&&e,duration:e,easing:i&&t||t&&!ut.isFunction(t)&&t};return s.duration=ut.fx.off?0:"number"==typeof s.duration?s.duration:s.duration in ut.fx.speeds?ut.fx.speeds[s.duration]:ut.fx.speeds._default,(null==s.queue||s.queue===!0)&&(s.queue="fx"),s.old=s.complete,s.complete=function(){ut.isFunction(s.old)&&s.old.call(this),s.queue&&ut.dequeue(this,s.queue)},s},ut.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},ut.timers=[],ut.fx=H.prototype.init,ut.fx.tick=function(){var e,i=ut.timers,s=0;for(Qi=ut.now();s<i.length;s++)e=i[s],e()||i[s]!==e||i.splice(s--,1);i.length||ut.fx.stop(),Qi=t},ut.fx.timer=function(e){e()&&ut.timers.push(e)&&ut.fx.start()},ut.fx.interval=13,ut.fx.start=function(){Ji||(Ji=setInterval(ut.fx.tick,ut.fx.interval))},ut.fx.stop=function(){clearInterval(Ji),Ji=null},ut.fx.speeds={slow:600,fast:200,_default:400},ut.fx.step={},ut.expr&&ut.expr.filters&&(ut.expr.filters.animated=function(e){return ut.grep(ut.timers,function(t){return e===t.elem}).length}),ut.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){ut.offset.setOffset(this,e,t)});var i,s,n={top:0,left:0},r=this[0],a=r&&r.ownerDocument;if(a)return i=a.documentElement,ut.contains(i,r)?(typeof r.getBoundingClientRect!==Y&&(n=r.getBoundingClientRect()),s=U(a),{top:n.top+(s.pageYOffset||i.scrollTop)-(i.clientTop||0),left:n.left+(s.pageXOffset||i.scrollLeft)-(i.clientLeft||0)}):n},ut.offset={setOffset:function(e,t,i){var s=ut.css(e,"position");"static"===s&&(e.style.position="relative");var n,r,a=ut(e),o=a.offset(),l=ut.css(e,"top"),h=ut.css(e,"left"),u=("absolute"===s||"fixed"===s)&&ut.inArray("auto",[l,h])>-1,c={},d={};u?(d=a.position(),n=d.top,r=d.left):(n=parseFloat(l)||0,r=parseFloat(h)||0),ut.isFunction(t)&&(t=t.call(e,i,o)),null!=t.top&&(c.top=t.top-o.top+n),null!=t.left&&(c.left=t.left-o.left+r),"using"in t?t.using.call(e,c):a.css(c)}},ut.fn.extend({position:function(){if(this[0]){var e,t,i={top:0,left:0},s=this[0];return"fixed"===ut.css(s,"position")?t=s.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),ut.nodeName(e[0],"html")||(i=e.offset()),i.top+=ut.css(e[0],"borderTopWidth",!0),i.left+=ut.css(e[0],"borderLeftWidth",!0)),{top:t.top-i.top-ut.css(s,"marginTop",!0),left:t.left-i.left-ut.css(s,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||$;e&&!ut.nodeName(e,"html")&&"static"===ut.css(e,"position");)e=e.offsetParent;return e||$})}}),ut.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,i){var s=/Y/.test(i);ut.fn[e]=function(n){return ut.access(this,function(e,n,r){var a=U(e);return r===t?a?i in a?a[i]:a.document.documentElement[n]:e[n]:(a?a.scrollTo(s?ut(a).scrollLeft():r,s?r:ut(a).scrollTop()):e[n]=r,void 0)},e,n,arguments.length,null)}}),ut.each({Height:"height",Width:"width"},function(e,i){ut.each({padding:"inner"+e,content:i,"":"outer"+e},function(s,n){ut.fn[n]=function(n,r){var a=arguments.length&&(s||"boolean"!=typeof n),o=s||(n===!0||r===!0?"margin":"border");return ut.access(this,function(i,s,n){var r;return ut.isWindow(i)?i.document.documentElement["client"+e]:9===i.nodeType?(r=i.documentElement,Math.max(i.body["scroll"+e],r["scroll"+e],i.body["offset"+e],r["offset"+e],r["client"+e])):n===t?ut.css(i,s,o):ut.style(i,s,n,o)},i,a?n:t,a,null)}})}),ut.fn.size=function(){return this.length},ut.fn.andSelf=ut.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=ut:(e.jQuery=e.$=ut,"function"==typeof define&&define.amd&&define("jquery",[],function(){return ut}))}(window),function(e,t){e.rails!==t&&e.error("jquery-ujs has already been loaded!");var i;e.rails=i={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",buttonClickSelector:"button[data-remote]",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type])",disableSelector:"input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input[type=file]",linkDisableSelector:"a[data-disable-with]",CSRFProtection:function(t){var i=e('meta[name="csrf-token"]').attr("content");i&&t.setRequestHeader("X-CSRF-Token",i)},fire:function(t,i,s){var n=e.Event(i);return t.trigger(n,s),n.result!==!1},confirm:function(e){return confirm(e)},ajax:function(t){return e.ajax(t)},href:function(e){return e.attr("href")},handleRemote:function(s){var n,r,a,o,l,h,u,c;if(i.fire(s,"ajax:before")){if(o=s.data("cross-domain"),l=o===t?null:o,h=s.data("with-credentials")||null,u=s.data("type")||e.ajaxSettings&&e.ajaxSettings.dataType,s.is("form")){n=s.attr("method"),r=s.attr("action"),a=s.serializeArray();var d=s.data("ujs:submit-button");d&&(a.push(d),s.data("ujs:submit-button",null))}else s.is(i.inputChangeSelector)?(n=s.data("method"),r=s.data("url"),a=s.serialize(),s.data("params")&&(a=a+"&"+s.data("params"))):s.is(i.buttonClickSelector)?(n=s.data("method")||"get",r=s.data("url"),a=s.serialize(),s.data("params")&&(a=a+"&"+s.data("params"))):(n=s.data("method"),r=i.href(s),a=s.data("params")||null);c={type:n||"GET",data:a,dataType:u,beforeSend:function(e,n){return n.dataType===t&&e.setRequestHeader("accept","*/*;q=0.5, "+n.accepts.script),i.fire(s,"ajax:beforeSend",[e,n])},success:function(e,t,i){s.trigger("ajax:success",[e,t,i])},complete:function(e,t){s.trigger("ajax:complete",[e,t])},error:function(e,t,i){s.trigger("ajax:error",[e,t,i])},crossDomain:l},h&&(c.xhrFields={withCredentials:h}),r&&(c.url=r);var p=i.ajax(c);return s.trigger("ajax:send",p),p}return!1},handleMethod:function(s){var n=i.href(s),r=s.data("method"),a=s.attr("target"),o=e("meta[name=csrf-token]").attr("content"),l=e("meta[name=csrf-param]").attr("content"),h=e('<form method="post" action="'+n+'"></form>'),u='<input name="_method" value="'+r+'" type="hidden" />';l!==t&&o!==t&&(u+='<input name="'+l+'" value="'+o+'" type="hidden" />'),a&&h.attr("target",a),h.hide().append(u).appendTo("body"),h.submit()},disableFormElements:function(t){t.find(i.disableSelector).each(function(){var t=e(this),i=t.is("button")?"html":"val";t.data("ujs:enable-with",t[i]()),t[i](t.data("disable-with")),t.prop("disabled",!0)})},enableFormElements:function(t){t.find(i.enableSelector).each(function(){var t=e(this),i=t.is("button")?"html":"val";t.data("ujs:enable-with")&&t[i](t.data("ujs:enable-with")),t.prop("disabled",!1)})},allowAction:function(e){var t,s=e.data("confirm"),n=!1;return s?(i.fire(e,"confirm")&&(n=i.confirm(s),t=i.fire(e,"confirm:complete",[n])),n&&t):!0},blankInputs:function(t,i,s){var n,r,a=e(),o=i||"input,textarea",l=t.find(o);return l.each(function(){if(n=e(this),r=n.is("input[type=checkbox],input[type=radio]")?n.is(":checked"):n.val(),!r==!s){if(n.is("input[type=radio]")&&l.filter('input[type=radio]:checked[name="'+n.attr("name")+'"]').length)return!0;a=a.add(n)}}),a.length?a:!1},nonBlankInputs:function(e,t){return i.blankInputs(e,t,!0)},stopEverything:function(t){return e(t.target).trigger("ujs:everythingStopped"),t.stopImmediatePropagation(),!1},disableElement:function(e){e.data("ujs:enable-with",e.html()),e.html(e.data("disable-with")),e.bind("click.railsDisable",function(e){return i.stopEverything(e)})},enableElement:function(e){e.data("ujs:enable-with")!==t&&(e.html(e.data("ujs:enable-with")),e.removeData("ujs:enable-with")),e.unbind("click.railsDisable")}},i.fire(e(document),"rails:attachBindings")&&(e.ajaxPrefilter(function(e,t,s){e.crossDomain||i.CSRFProtection(s)}),e(document).delegate(i.linkDisableSelector,"ajax:complete",function(){i.enableElement(e(this))}),e(document).delegate(i.linkClickSelector,"click.rails",function(s){var n=e(this),r=n.data("method"),a=n.data("params");if(!i.allowAction(n))return i.stopEverything(s);if(n.is(i.linkDisableSelector)&&i.disableElement(n),n.data("remote")!==t){if(!(!s.metaKey&&!s.ctrlKey||r&&"GET"!==r||a))return!0;var o=i.handleRemote(n);return o===!1?i.enableElement(n):o.error(function(){i.enableElement(n)}),!1}return n.data("method")?(i.handleMethod(n),!1):void 0}),e(document).delegate(i.buttonClickSelector,"click.rails",function(t){var s=e(this);return i.allowAction(s)?(i.handleRemote(s),!1):i.stopEverything(t)}),e(document).delegate(i.inputChangeSelector,"change.rails",function(t){var s=e(this);return i.allowAction(s)?(i.handleRemote(s),!1):i.stopEverything(t)}),e(document).delegate(i.formSubmitSelector,"submit.rails",function(s){var n=e(this),r=n.data("remote")!==t,a=i.blankInputs(n,i.requiredInputSelector),o=i.nonBlankInputs(n,i.fileInputSelector);if(!i.allowAction(n))return i.stopEverything(s);if(a&&n.attr("novalidate")==t&&i.fire(n,"ajax:aborted:required",[a]))return i.stopEverything(s);if(r){if(o){setTimeout(function(){i.disableFormElements(n)},13);var l=i.fire(n,"ajax:aborted:file",[o]);return l||setTimeout(function(){i.enableFormElements(n)},13),l}return i.handleRemote(n),!1}setTimeout(function(){i.disableFormElements(n)},13)}),e(document).delegate(i.formInputClickSelector,"click.rails",function(t){var s=e(this);if(!i.allowAction(s))return i.stopEverything(t);var n=s.attr("name"),r=n?{name:n,value:s.val()}:null;s.closest("form").data("ujs:submit-button",r)}),e(document).delegate(i.formSubmitSelector,"ajax:beforeSend.rails",function(t){this==t.target&&i.disableFormElements(e(this))}),e(document).delegate(i.formSubmitSelector,"ajax:complete.rails",function(t){this==t.target&&i.enableFormElements(e(this))}),e(function(){var t=e("meta[name=csrf-token]").attr("content"),i=e("meta[name=csrf-param]").attr("content");e('form input[name="'+i+'"]').val(t)}))}(jQuery),/*!
 * jQuery Cookie Plugin v1.2
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2011, Klaus Hartl
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/GPL-2.0
 */
function(e,t,i){function s(e){return e}function n(e){return decodeURIComponent(e.replace(r," "))}var r=/\+/g;e.cookie=function(r,a,o){if(a!==i&&!/Object/.test(Object.prototype.toString.call(a))){if(o=e.extend({},e.cookie.defaults,o),null===a&&(o.expires=-1),"number"==typeof o.expires){var l=o.expires,h=o.expires=new Date;h.setDate(h.getDate()+l)}return a=String(a),t.cookie=[encodeURIComponent(r),"=",o.raw?a:encodeURIComponent(a),o.expires?"; expires="+o.expires.toUTCString():"",o.path?"; path="+o.path:"",o.domain?"; domain="+o.domain:"",o.secure?"; secure":""].join("")}o=a||e.cookie.defaults||{};for(var u,c=o.raw?s:n,d=t.cookie.split("; "),p=0;u=d[p]&&d[p].split("=");p++)if(c(u.shift())===r)return c(u.join("="));return null},e.cookie.defaults={},e.removeCookie=function(t,i){return null!==e.cookie(t,i)?(e.cookie(t,null,i),!0):!1}}(jQuery,document),/*!
 * jQuery Tools v1.2.7 - The missing UI library for the Web
 * 
 * overlay/overlay.js
 * scrollable/scrollable.js
 * tabs/tabs.js
 * tooltip/tooltip.js
 * 
 * NO COPYRIGHTS OR LICENSES. DO WHAT YOU LIKE.
 * 
 * http://flowplayer.org/tools/
 * 
 */
jQuery.browser={},function(){jQuery.browser.msie=!1,jQuery.browser.version=0,navigator.userAgent.match(/MSIE ([0-9]+)\./)&&(jQuery.browser.msie=!0,jQuery.browser.version=RegExp.$1)}(),function(e){function t(t,n){var r,a,o,l=this,h=t.add(l),u=e(window),c=e.tools.expose&&(n.mask||n.expose),d=Math.random().toString().slice(10);c&&("string"==typeof c&&(c={color:c}),c.closeOnClick=c.closeOnEsc=!1);var p=n.target||t.attr("rel");if(a=p?e(p):null||t,!a.length)throw"Could not find Overlay: "+p;t&&-1==t.index(a)&&t.click(function(e){return l.load(e),e.preventDefault()}),e.extend(l,{load:function(t){if(l.isOpened())return l;var r=s[n.effect];if(!r)throw'Overlay: cannot find effect : "'+n.effect+'"';if(n.oneInstance&&e.each(i,function(){this.close(t)}),t=t||e.Event(),t.type="onBeforeLoad",h.trigger(t),t.isDefaultPrevented())return l;o=!0,c&&e(a).expose(c);var p=n.top,f=n.left,m=a.outerWidth({margin:!0}),y=a.outerHeight({margin:!0});return"string"==typeof p&&(p="center"==p?Math.max((u.height()-y)/2,0):parseInt(p,10)/100*u.height()),"center"==f&&(f=Math.max((u.width()-m)/2,0)),r[0].call(l,{top:p,left:f},function(){o&&(t.type="onLoad",h.trigger(t))}),c&&n.closeOnClick&&e.mask.getMask().one("click",l.close),n.closeOnClick&&e(document).on("click."+d,function(t){e(t.target).parents(a).length||l.close(t)}),n.closeOnEsc&&e(document).on("keydown."+d,function(e){27==e.keyCode&&l.close(e)}),l},close:function(t){return l.isOpened()?(t=t||e.Event(),t.type="onBeforeClose",h.trigger(t),t.isDefaultPrevented()?void 0:(o=!1,s[n.effect][1].call(l,function(){t.type="onClose",h.trigger(t)}),e(document).off("click."+d+" keydown."+d),c&&e.mask.close(),l)):l},getOverlay:function(){return a},getTrigger:function(){return t},getClosers:function(){return r},isOpened:function(){return o},getConf:function(){return n}}),e.each("onBeforeLoad,onStart,onLoad,onBeforeClose,onClose".split(","),function(t,i){e.isFunction(n[i])&&e(l).on(i,n[i]),l[i]=function(t){return t&&e(l).on(i,t),l}}),r=a.find(n.close||".close"),!r.length&&!n.close&&(r=e('<a class="close"></a>'),a.prepend(r)),r.click(function(e){l.close(e)}),n.load&&l.load()}e.tools=e.tools||{version:"v1.2.7"},e.tools.overlay={addEffect:function(e,t,i){s[e]=[t,i]},conf:{close:null,closeOnClick:!0,closeOnEsc:!0,closeSpeed:"fast",effect:"default",fixed:!e.browser.msie||e.browser.version>6,left:"center",load:!1,mask:null,oneInstance:!0,speed:"normal",target:null,top:"10%"}};var i=[],s={};e.tools.overlay.addEffect("default",function(t,i){var s=this.getConf(),n=e(window);s.fixed||(t.top+=n.scrollTop(),t.left+=n.scrollLeft()),t.position=s.fixed?"fixed":"absolute",this.getOverlay().css(t).fadeIn(s.speed,i)},function(e){this.getOverlay().fadeOut(this.getConf().closeSpeed,e)}),e.fn.overlay=function(s){var n=this.data("overlay");return n?n:(e.isFunction(s)&&(s={onBeforeLoad:s}),s=e.extend(!0,{},e.tools.overlay.conf,s),this.each(function(){n=new t(e(this),s),i.push(n),e(this).data("overlay",n)}),s.api?n:this)}}(jQuery),function(e){function t(t,i){var s=e(i);return s.length<2?s:t.parent().find(i)}function i(i,n){var r=this,a=i.add(r),o=i.children(),l=0,h=n.vertical;if(s||(s=r),o.length>1&&(o=e(n.items,i)),n.size>1&&(n.circular=!1),e.extend(r,{getConf:function(){return n},getIndex:function(){return l},getSize:function(){return r.getItems().size()},getNaviButtons:function(){return p.add(f)},getRoot:function(){return i},getItemWrap:function(){return o},getItems:function(){return o.find(n.item).not("."+n.clonedClass)},move:function(e,t){return r.seekTo(l+e,t)},next:function(e){return r.move(n.size,e)},prev:function(e){return r.move(-n.size,e)},begin:function(e){return r.seekTo(0,e)},end:function(e){return r.seekTo(r.getSize()-1,e)},focus:function(){return s=r,r},addItem:function(t){return t=e(t),n.circular?(o.children().last().before(t),o.children().first().replaceWith(t.clone().addClass(n.clonedClass))):(o.append(t),f.removeClass("disabled")),a.trigger("onAddItem",[t]),r},seekTo:function(t,i,u){if(t.jquery||(t*=1),n.circular&&0===t&&-1==l&&0!==i)return r;if(!n.circular&&0>t||t>r.getSize()||-1>t)return r;var c=t;t.jquery?t=r.getItems().index(t):c=r.getItems().eq(t);var d=e.Event("onBeforeSeek");if(!u&&(a.trigger(d,[t,i]),d.isDefaultPrevented()||!c.length))return r;var p=h?{top:-c.position().top}:{left:-c.position().left};return l=t,s=r,void 0===i&&(i=n.speed),o.animate(p,i,n.easing,u||function(){a.trigger("onSeek",[t])}),r}}),e.each(["onBeforeSeek","onSeek","onAddItem"],function(t,i){e.isFunction(n[i])&&e(r).on(i,n[i]),r[i]=function(t){return t&&e(r).on(i,t),r}}),n.circular){var u=r.getItems().slice(-1).clone().prependTo(o),c=r.getItems().eq(1).clone().appendTo(o);u.add(c).addClass(n.clonedClass),r.onBeforeSeek(function(e,t,i){if(!e.isDefaultPrevented()){if(-1==t)return r.seekTo(u,i,function(){r.end(0)}),e.preventDefault();t==r.getSize()&&r.seekTo(c,i,function(){r.begin(0)})}});var d=i.parents().add(i).filter(function(){return"none"===e(this).css("display")?!0:void 0});d.length?(d.show(),r.seekTo(0,0,function(){}),d.hide()):r.seekTo(0,0,function(){})}var p=t(i,n.prev).click(function(e){e.stopPropagation(),r.prev()}),f=t(i,n.next).click(function(e){e.stopPropagation(),r.next()});if(n.circular||(r.onBeforeSeek(function(e,t){setTimeout(function(){e.isDefaultPrevented()||(p.toggleClass(n.disabledClass,0>=t),f.toggleClass(n.disabledClass,t>=r.getSize()-1))},1)}),n.initialIndex||p.addClass(n.disabledClass)),r.getSize()<2&&p.add(f).addClass(n.disabledClass),n.mousewheel&&e.fn.mousewheel&&i.mousewheel(function(e,t){return n.mousewheel?(r.move(0>t?1:-1,n.wheelSpeed||50),!1):void 0}),n.touch){var m={};o[0].ontouchstart=function(e){var t=e.touches[0];m.x=t.clientX,m.y=t.clientY},o[0].ontouchmove=function(e){if(1==e.touches.length&&!o.is(":animated")){var t=e.touches[0],i=m.x-t.clientX,s=m.y-t.clientY;r[h&&s>0||!h&&i>0?"next":"prev"](),e.preventDefault()}}}n.keyboard&&e(document).on("keydown.scrollable",function(t){if(!(!n.keyboard||t.altKey||t.ctrlKey||t.metaKey||e(t.target).is(":input"))){if("static"!=n.keyboard&&s!=r)return;var i=t.keyCode;if(h&&(38==i||40==i))return r.move(38==i?-1:1),t.preventDefault();if(!h&&(37==i||39==i))return r.move(37==i?-1:1),t.preventDefault()}}),n.initialIndex&&r.seekTo(n.initialIndex,0,function(){})}e.tools=e.tools||{version:"v1.2.7"},e.tools.scrollable={conf:{activeClass:"active",circular:!1,clonedClass:"cloned",disabledClass:"disabled",easing:"swing",initialIndex:0,item:"> *",items:".items",keyboard:!0,mousewheel:!1,next:".next",prev:".prev",size:1,speed:400,vertical:!1,touch:!0,wheelSpeed:0}};var s;e.fn.scrollable=function(t){var s=this.data("scrollable");return s?s:(t=e.extend({},e.tools.scrollable.conf,t),this.each(function(){s=new i(e(this),t),e(this).data("scrollable",s)}),t.api?s:this)}}(jQuery),function(e){function t(t,i,s){var r,a=this,o=t.add(this),l=t.find(s.tabs),h=i.jquery?i:t.children(i);l.length||(l=t.children()),h.length||(h=t.parent().find(i)),h.length||(h=e(i)),e.extend(this,{click:function(i,h){var u=l.eq(i),c=!t.data("tabs");if("string"==typeof i&&i.replace("#","")&&(u=l.filter('[href*="'+i.replace("#","")+'"]'),i=Math.max(l.index(u),0)),s.rotate){var d=l.length-1;if(0>i)return a.click(d,h);if(i>d)return a.click(0,h)}if(!u.length){if(r>=0)return a;i=s.initialIndex,u=l.eq(i)}if(i===r)return a;if(h=h||e.Event(),h.type="onBeforeClick",o.trigger(h,[i]),!h.isDefaultPrevented()){var p=c?s.initialEffect&&s.effect||"default":s.effect;return n[p].call(a,i,function(){r=i,h.type="onClick",o.trigger(h,[i])}),l.removeClass(s.current),u.addClass(s.current),a}},getConf:function(){return s},getTabs:function(){return l},getPanes:function(){return h},getCurrentPane:function(){return h.eq(r)},getCurrentTab:function(){return l.eq(r)},getIndex:function(){return r},next:function(){return a.click(r+1)},prev:function(){return a.click(r-1)},destroy:function(){return l.off(s.event).removeClass(s.current),h.find('a[href^="#"]').off("click.T"),a}}),e.each("onBeforeClick,onClick".split(","),function(t,i){e.isFunction(s[i])&&e(a).on(i,s[i]),a[i]=function(t){return t&&e(a).on(i,t),a}}),s.history&&e.fn.history&&(e.tools.history.init(l),s.event="history"),l.each(function(t){e(this).on(s.event,function(e){return a.click(t,e),e.preventDefault()})}),h.find('a[href^="#"]').on("click.T",function(t){a.click(e(this).attr("href"),t)}),location.hash&&"a"==s.tabs&&t.find('[href="'+location.hash+'"]').length?a.click(location.hash):(0===s.initialIndex||s.initialIndex>0)&&a.click(s.initialIndex)}e.tools=e.tools||{version:"v1.2.7"},e.tools.tabs={conf:{tabs:"a",current:"current",onBeforeClick:null,onClick:null,effect:"default",initialEffect:!1,initialIndex:0,event:"click",rotate:!1,slideUpSpeed:400,slideDownSpeed:400,history:!1},addEffect:function(e,t){n[e]=t}};var i,s,n={"default":function(e,t){this.getPanes().hide().eq(e).show(),t.call()},fade:function(e,t){var i=this.getConf(),s=i.fadeOutSpeed,n=this.getPanes();s?n.fadeOut(s):n.hide(),n.eq(e).fadeIn(i.fadeInSpeed,t)},slide:function(e,t){var i=this.getConf();this.getPanes().slideUp(i.slideUpSpeed),this.getPanes().eq(e).slideDown(i.slideDownSpeed,t)},ajax:function(e,t){this.getPanes().eq(0).load(this.getTabs().eq(e).attr("href"),t)}};e.tools.tabs.addEffect("horizontal",function(t,n){if(!i){var r=this.getPanes().eq(t),a=this.getCurrentPane();s||(s=this.getPanes().eq(0).width()),i=!0,r.show(),a.animate({width:0},{step:function(e){r.css("width",s-e)},complete:function(){e(this).hide(),n.call(),i=!1}}),a.length||(n.call(),i=!1)}}),e.fn.tabs=function(i,s){var n=this.data("tabs");return n&&(n.destroy(),this.removeData("tabs")),e.isFunction(s)&&(s={onBeforeClick:s}),s=e.extend({},e.tools.tabs.conf,s),this.each(function(){n=new t(e(this),i,s),e(this).data("tabs",n)}),s.api?n:this}}(jQuery),function(e){function t(t,i,s){var n=s.relative?t.position().top:t.offset().top,r=s.relative?t.position().left:t.offset().left,a=s.position[0];n-=i.outerHeight()-s.offset[0],r+=t.outerWidth()+s.offset[1],/iPad/i.test(navigator.userAgent)&&(n-=e(window).scrollTop());var o=i.outerHeight()+t.outerHeight();"center"==a&&(n+=o/2),"bottom"==a&&(n+=o),a=s.position[1];var l=i.outerWidth()+t.outerWidth();return"center"==a&&(r-=l/2),"left"==a&&(r-=l),{top:n,left:r}}function i(i,n){var r,a,o=this,l=i.add(o),h=0,u=0,c=i.attr("title"),d=i.attr("data-tooltip"),p=s[n.effect],f=i.is(":input"),m=f&&i.is(":checkbox, :radio, select, :button, :submit"),y=i.attr("type"),g=n.events[y]||n.events[f?m?"widget":"input":"def"];if(!p)throw'Nonexistent effect "'+n.effect+'"';if(g=g.split(/,\s*/),2!=g.length)throw"Tooltip: bad events configuration for "+y;i.on(g[0],function(e){clearTimeout(h),n.predelay?u=setTimeout(function(){o.show(e)},n.predelay):o.show(e)}).on(g[1],function(e){clearTimeout(u),n.delay?h=setTimeout(function(){o.hide(e)},n.delay):o.hide(e)}),c&&n.cancelDefault&&(i.removeAttr("title"),i.data("title",c)),e.extend(o,{show:function(s){if(!r&&(d?r=e(d):n.tip?r=e(n.tip).eq(0):c?r=e(n.layout).addClass(n.tipClass).appendTo(document.body).hide().append(c):(r=i.next(),r.length||(r=i.parent().next())),!r.length))throw"Cannot find tooltip for "+i;if(o.isShown())return o;r.stop(!0,!0);var f=t(i,r,n);if(n.tip&&r.html(i.data("title")),s=e.Event(),s.type="onBeforeShow",l.trigger(s,[f]),s.isDefaultPrevented())return o;f=t(i,r,n),r.css({position:"absolute",top:f.top,left:f.left}),a=!0,p[0].call(o,function(){s.type="onShow",a="full",l.trigger(s)});var m=n.events.tooltip.split(/,\s*/);return r.data("__set")||(r.off(m[0]).on(m[0],function(){clearTimeout(h),clearTimeout(u)}),m[1]&&!i.is("input:not(:checkbox, :radio), textarea")&&r.off(m[1]).on(m[1],function(e){e.relatedTarget!=i[0]&&i.trigger(g[1].split(" ")[0])}),n.tip||r.data("__set",!0)),o},hide:function(t){return r&&o.isShown()?(t=e.Event(),t.type="onBeforeHide",l.trigger(t),t.isDefaultPrevented()?void 0:(a=!1,s[n.effect][1].call(o,function(){t.type="onHide",l.trigger(t)}),o)):o},isShown:function(e){return e?"full"==a:a},getConf:function(){return n},getTip:function(){return r},getTrigger:function(){return i}}),e.each("onHide,onBeforeShow,onShow,onBeforeHide".split(","),function(t,i){e.isFunction(n[i])&&e(o).on(i,n[i]),o[i]=function(t){return t&&e(o).on(i,t),o}})}e.tools=e.tools||{version:"v1.2.7"},e.tools.tooltip={conf:{effect:"toggle",fadeOutSpeed:"fast",predelay:0,delay:30,opacity:1,tip:0,fadeIE:!1,position:["top","center"],offset:[0,0],relative:!1,cancelDefault:!0,events:{def:"mouseenter,mouseleave",input:"focus,blur",widget:"focus mouseenter,blur mouseleave",tooltip:"mouseenter,mouseleave"},layout:"<div/>",tipClass:"tooltip"},addEffect:function(e,t,i){s[e]=[t,i]}};var s={toggle:[function(e){var t=this.getConf(),i=this.getTip(),s=t.opacity;1>s&&i.css({opacity:s}),i.show(),e.call()},function(e){this.getTip().hide(),e.call()}],fade:[function(t){var i=this.getConf();!e.browser.msie||i.fadeIE?this.getTip().fadeTo(i.fadeInSpeed,i.opacity,t):(this.getTip().show(),t())},function(t){var i=this.getConf();!e.browser.msie||i.fadeIE?this.getTip().fadeOut(i.fadeOutSpeed,t):(this.getTip().hide(),t())}]};e.fn.tooltip=function(t){var s=this.data("tooltip");return s?s:(t=e.extend(!0,{},e.tools.tooltip.conf,t),"string"==typeof t.position&&(t.position=t.position.split(/,?\s/)),this.each(function(){s=new i(e(this),t),e(this).data("tooltip",s)}),t.api?s:this)}}(jQuery),BestInPlaceEditor.prototype={activate:function(){var e="";e=this.isNil?"":this.original_content?this.original_content:this.sanitize?this.element.text():this.element.html();var t=this.isNil?"-":this.sanitize?this.element.text():this.element.html();this.oldValue=t,this.display_value=e,jQuery(this.activator).unbind("click",this.clickHandler),this.activateForm(),this.element.trigger(jQuery.Event("best_in_place:activate"))},abort:function(){this.isNil?this.element.text(this.nil):this.element.text(this.oldValue),jQuery(this.activator).bind("click",{editor:this},this.clickHandler),this.element.trigger(jQuery.Event("best_in_place:abort")),this.element.trigger(jQuery.Event("best_in_place:deactivate"))},abortIfConfirm:function(){return this.useConfirm?(confirm("Are you sure you want to discard your changes?")&&this.abort(),void 0):(this.abort(),void 0)},update:function(){var e=this;if(this.formType in{input:1,textarea:1}&&this.getValue()==this.oldValue)return this.abort(),!0;if(this.isNil=!1,e.ajax({type:"post",dataType:"text",data:e.requestData(),success:function(t){e.loadSuccessCallback(t)},error:function(t,i){e.loadErrorCallback(t,i)}}),"select"==this.formType){var t=this.getValue();this.previousCollectionValue=t,jQuery.each(this.values,function(i,s){t==s[0]&&e.element.html(s[1])})}else"checkbox"==this.formType?e.element.html(this.getValue()?this.values[1]:this.values[0]):e.element.text(""!==this.getValue()?this.getValue():this.nil);e.element.trigger(jQuery.Event("best_in_place:update"))},activateForm:function(){alert("The form was not properly initialized. activateForm is unbound")},initOptions:function(){var e=this;e.element.parents().each(function(){$parent=jQuery(this),e.url=e.url||$parent.attr("data-url"),e.collection=e.collection||$parent.attr("data-collection"),e.formType=e.formType||$parent.attr("data-type"),e.objectName=e.objectName||$parent.attr("data-object"),e.attributeName=e.attributeName||$parent.attr("data-attribute"),e.activator=e.activator||$parent.attr("data-activator"),e.okButton=e.okButton||$parent.attr("data-ok-button"),e.cancelButton=e.cancelButton||$parent.attr("data-cancel-button"),e.nil=e.nil||$parent.attr("data-nil"),e.inner_class=e.inner_class||$parent.attr("data-inner-class"),e.html_attrs=e.html_attrs||$parent.attr("data-html-attrs"),e.original_content=e.original_content||$parent.attr("data-original-content"),e.collectionValue=e.collectionValue||$parent.attr("data-value")}),e.element.parents().each(function(){var t=this.id.match(/^(\w+)_(\d+)$/i);t&&(e.objectName=e.objectName||t[1])}),e.url=e.element.attr("data-url")||e.url||document.location.pathname,e.collection=e.element.attr("data-collection")||e.collection,e.formType=e.element.attr("data-type")||e.formtype||"input",e.objectName=e.element.attr("data-object")||e.objectName,e.attributeName=e.element.attr("data-attribute")||e.attributeName,e.activator=e.element.attr("data-activator")||e.element,e.okButton=e.element.attr("data-ok-button")||e.okButton,e.cancelButton=e.element.attr("data-cancel-button")||e.cancelButton,e.nil=e.element.attr("data-nil")||e.nil||"-",e.inner_class=e.element.attr("data-inner-class")||e.inner_class||null,e.html_attrs=e.element.attr("data-html-attrs")||e.html_attrs,e.original_content=e.element.attr("data-original-content")||e.original_content,e.collectionValue=e.element.attr("data-value")||e.collectionValue,e.sanitize=e.element.attr("data-sanitize")?"true"==e.element.attr("data-sanitize"):!0,e.useConfirm=e.element.attr("data-use-confirm")?"false"!=e.element.attr("data-use-confirm"):!0,"select"!=e.formType&&"checkbox"!=e.formType||null===e.collection||(e.values=jQuery.parseJSON(e.collection))},bindForm:function(){this.activateForm=BestInPlaceEditor.forms[this.formType].activateForm,this.getValue=BestInPlaceEditor.forms[this.formType].getValue},initNil:function(){""===this.element.text()&&(this.isNil=!0,this.element.text(this.nil))},getValue:function(){alert("The form was not properly initialized. getValue is unbound")},sanitizeValue:function(e){return jQuery.trim(e)},requestData:function(){csrf_token=jQuery("meta[name=csrf-token]").attr("content"),csrf_param=jQuery("meta[name=csrf-param]").attr("content");var e="_method=put";return e+="&"+this.objectName+"["+this.attributeName+"]="+encodeURIComponent(this.getValue()),void 0!==csrf_param&&void 0!==csrf_token&&(e+="&"+csrf_param+"="+encodeURIComponent(csrf_token)),e},ajax:function(e){return e.url=this.url,e.beforeSend=function(e){e.setRequestHeader("Accept","application/json")},jQuery.ajax(e)},loadSuccessCallback:function(e){var t=jQuery.parseJSON(jQuery.trim(e));null!==t&&t.hasOwnProperty("display_as")&&(this.element.attr("data-original-content",this.element.text()),this.original_content=this.element.text(),this.element.text(t.display_as)),this.element.trigger(jQuery.Event("ajax:success"),e),jQuery(this.activator).bind("click",{editor:this},this.clickHandler),this.element.trigger(jQuery.Event("best_in_place:deactivate")),null!==this.collectionValue&&(this.collectionValue=this.previousCollectionValue,this.previousCollectionValue=null)},loadErrorCallback:function(e,t){this.element.text(this.oldValue),this.element.trigger(jQuery.Event("best_in_place:error"),[e,t]),this.element.trigger(jQuery.Event("ajax:error")),jQuery(this.activator).bind("click",{editor:this},this.clickHandler),this.element.trigger(jQuery.Event("best_in_place:deactivate"))},clickHandler:function(e){e.preventDefault(),e.data.editor.activate()},setHtmlAttributes:function(){var e=this.element.find(this.formType),t=jQuery.parseJSON(this.html_attrs);for(var i in t)e.attr(i,t[i])}},BestInPlaceEditor.forms={input:{activateForm:function(){var e=$(document.createElement("form")).addClass("form_in_place").attr("action","javascript:void(0);").attr("style","display:inline"),t=$(document.createElement("input")).attr("type","text").attr("name",this.attributeName).val(this.display_value);null!==this.inner_class&&t.addClass(this.inner_class),e.append(t),this.okButton&&e.append($(document.createElement("input")).attr("type","submit").attr("value",this.okButton)),this.cancelButton&&e.append($(document.createElement("input")).attr("type","button").attr("value",this.cancelButton)),this.element.html(e),this.setHtmlAttributes(),this.element.find("input[type='text']")[0].select(),this.element.find("form").bind("submit",{editor:this},BestInPlaceEditor.forms.input.submitHandler),this.cancelButton&&this.element.find("input[type='button']").bind("click",{editor:this},BestInPlaceEditor.forms.input.cancelButtonHandler),this.element.find("input[type='text']").bind("blur",{editor:this},BestInPlaceEditor.forms.input.inputBlurHandler),this.element.find("input[type='text']").bind("keyup",{editor:this},BestInPlaceEditor.forms.input.keyupHandler),this.blurTimer=null,this.userClicked=!1},getValue:function(){return this.sanitizeValue(this.element.find("input").val())},inputBlurHandler:function(e){e.data.editor.okButton?e.data.editor.blurTimer=setTimeout(function(){e.data.editor.userClicked||e.data.editor.abort()},500):e.data.editor.cancelButton?e.data.editor.blurTimer=setTimeout(function(){e.data.editor.userClicked||e.data.editor.update()},500):e.data.editor.update()},submitHandler:function(e){e.data.editor.userClicked=!0,clearTimeout(e.data.editor.blurTimer),e.data.editor.update()},cancelButtonHandler:function(e){e.data.editor.userClicked=!0,clearTimeout(e.data.editor.blurTimer),e.data.editor.abort(),e.stopPropagation()},keyupHandler:function(e){27==e.keyCode&&e.data.editor.abort()}},date:{activateForm:function(){var e=this,t=$(document.createElement("form")).addClass("form_in_place").attr("action","javascript:void(0);").attr("style","display:inline"),i=$(document.createElement("input")).attr("type","text").attr("name",this.attributeName).attr("value",this.sanitizeValue(this.display_value));null!==this.inner_class&&i.addClass(this.inner_class),t.append(i),this.element.html(t),this.setHtmlAttributes(),this.element.find("input")[0].select(),this.element.find("form").bind("submit",{editor:this},BestInPlaceEditor.forms.input.submitHandler),this.element.find("input").bind("keyup",{editor:this},BestInPlaceEditor.forms.input.keyupHandler),this.element.find("input").datepicker({onClose:function(){e.update()}}).datepicker("show")},getValue:function(){return this.sanitizeValue(this.element.find("input").val())},submitHandler:function(e){e.data.editor.update()},keyupHandler:function(e){27==e.keyCode&&e.data.editor.abort()}},select:{activateForm:function(){var e=$(document.createElement("form")).attr("action","javascript:void(0)").attr("style","display:inline");selected="",oldValue=this.oldValue,select_elt=$(document.createElement("select")),currentCollectionValue=this.collectionValue,jQuery.each(this.values,function(e,t){var i=$(document.createElement("option")).val(t[0]).html(t[1]);t[0]==currentCollectionValue&&i.attr("selected","selected"),select_elt.append(i)}),e.append(select_elt),this.element.html(e),this.setHtmlAttributes(),this.element.find("select").bind("change",{editor:this},BestInPlaceEditor.forms.select.blurHandler),this.element.find("select").bind("blur",{editor:this},BestInPlaceEditor.forms.select.blurHandler),this.element.find("select").bind("keyup",{editor:this},BestInPlaceEditor.forms.select.keyupHandler),this.element.find("select")[0].focus()},getValue:function(){return this.sanitizeValue(this.element.find("select").val())},blurHandler:function(e){e.data.editor.update()},keyupHandler:function(e){27==e.keyCode&&e.data.editor.abort()}},checkbox:{activateForm:function(){var e=Boolean(this.oldValue.toLowerCase()!=this.values[1].toLowerCase()),t=e?this.values[1]:this.values[0];this.element.html(t),this.setHtmlAttributes(),this.update()},getValue:function(){return Boolean(this.element.html().toLowerCase()==this.values[1].toLowerCase())}},textarea:{activateForm:function(){width=this.element.css("width"),height=this.element.css("height");var e=$(document.createElement("form")).attr("action","javascript:void(0)").attr("style","display:inline").append($(document.createElement("textarea")).val(this.sanitizeValue(this.display_value)));this.okButton&&e.append($(document.createElement("input")).attr("type","submit").attr("value",this.okButton)),this.cancelButton&&e.append($(document.createElement("input")).attr("type","button").attr("value",this.cancelButton)),this.element.html(e),this.setHtmlAttributes(),jQuery(this.element.find("textarea")[0]).css({"min-width":width,"min-height":height}),jQuery(this.element.find("textarea")[0]).elastic(),this.element.find("textarea")[0].focus(),this.element.find("form").bind("submit",{editor:this},BestInPlaceEditor.forms.textarea.submitHandler),this.cancelButton&&this.element.find("input[type='button']").bind("click",{editor:this},BestInPlaceEditor.forms.textarea.cancelButtonHandler),this.element.find("textarea").bind("blur",{editor:this},BestInPlaceEditor.forms.textarea.blurHandler),this.element.find("textarea").bind("keyup",{editor:this},BestInPlaceEditor.forms.textarea.keyupHandler),this.blurTimer=null,this.userClicked=!1},getValue:function(){return this.sanitizeValue(this.element.find("textarea").val())},blurHandler:function(e){e.data.editor.okButton?e.data.editor.blurTimer=setTimeout(function(){e.data.editor.userClicked||e.data.editor.abortIfConfirm()},500):e.data.editor.cancelButton?e.data.editor.blurTimer=setTimeout(function(){e.data.editor.userClicked||e.data.editor.update()},500):e.data.editor.update()},submitHandler:function(e){e.data.editor.userClicked=!0,clearTimeout(e.data.editor.blurTimer),e.data.editor.update()},cancelButtonHandler:function(e){e.data.editor.userClicked=!0,clearTimeout(e.data.editor.blurTimer),e.data.editor.abortIfConfirm(),e.stopPropagation()},keyupHandler:function(e){27==e.keyCode&&e.data.editor.abortIfConfirm()}}},jQuery.fn.best_in_place=function(){function e(e){return e.data("bestInPlaceEditor")?void 0:(e.data("bestInPlaceEditor",new BestInPlaceEditor(e)),!0)}return jQuery(this.context).delegate(this.selector,"click",function(){var t=jQuery(this);e(t)&&t.click()}),this.each(function(){e(jQuery(this))}),this},function(e){e.fn.extend({elastic:function(){var t=["paddingTop","paddingRight","paddingBottom","paddingLeft","fontSize","lineHeight","fontFamily","width","fontWeight"];return this.each(function(){function i(e,t){curratedHeight=Math.floor(parseInt(e,10)),n.height()!=curratedHeight&&n.css({height:curratedHeight+"px",overflow:t})}function s(){var e=n.val().replace(/&/g,"&amp;").replace(/  /g,"&nbsp;").replace(/<|>/g,"&gt;").replace(/\n/g,"<br />"),t=r.html().replace(/<br>/gi,"<br />");if(e+"&nbsp;"!=t&&(r.html(e+"&nbsp;"),Math.abs(r.height()+a-n.height())>3)){var s=r.height()+a;s>=l?i(l,"auto"):o>=s?i(o,"hidden"):i(s,"hidden")}}if("textarea"!=this.type)return!1;var n=e(this),r=e("<div />").css({position:"absolute",display:"none","word-wrap":"break-word"}),a=parseInt(n.css("line-height"),10)||parseInt(n.css("font-size"),"10"),o=parseInt(n.css("height"),10)||3*a,l=parseInt(n.css("max-height"),10)||Number.MAX_VALUE,h=0;for(0>l&&(l=Number.MAX_VALUE),r.appendTo(n.parent()),h=t.length;h--;)r.css(t[h].toString(),n.css(t[h].toString()));n.css({overflow:"hidden"}),n.bind("keyup change cut paste",function(){s()}),n.bind("blur",function(){r.height()<l&&(r.height()>o?n.height(r.height()):n.height(o))}),$(document).on("input paste",n,function(){setTimeout(s,250)}),s()})}})}(jQuery),/*
 * Ext JS Library 3.4.0
 * Copyright(c) 2006-2011 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 */
window.undefined=window.undefined,Ext={version:"3.4.0",versionDetail:{major:3,minor:4,patch:0}},Ext.apply=function(e,t,i){if(i&&Ext.apply(e,i),e&&t&&"object"==typeof t)for(var s in t)e[s]=t[s];return e},function(){var e=0,t=Object.prototype.toString,i=navigator.userAgent.toLowerCase(),s=function(e){return e.test(i)},n=document,r=n.documentMode,a="CSS1Compat"==n.compatMode,o=s(/opera/),l=s(/\bchrome\b/),h=s(/webkit/),u=!l&&s(/safari/),c=u&&s(/applewebkit\/4/),d=u&&s(/version\/3/),p=u&&s(/version\/4/),f=!o&&s(/msie/),m=f&&(s(/msie 7/)||7==r),y=f&&s(/msie 8/)&&7!=r,g=f&&s(/msie 9/),v=f&&!m&&!y&&!g,x=!h&&s(/gecko/),E=x&&s(/rv:1\.8/),b=x&&s(/rv:1\.9/),L=f&&!a,S=s(/windows|win32/),C=s(/macintosh|mac os x/),w=s(/adobeair/),O=s(/linux/),T=/^https/i.test(window.location.protocol);if(v)try{n.execCommand("BackgroundImageCache",!1,!0)}catch(M){}Ext.apply(Ext,{SSL_SECURE_URL:T&&f?'javascript:""':"about:blank",isStrict:a,isSecure:T,isReady:!1,enableForcedBoxModel:!1,enableGarbageCollector:!0,enableListenerCollection:!1,enableNestedListenerRemoval:!1,USE_NATIVE_JSON:!1,applyIf:function(e,t){if(e)for(var i in t)Ext.isDefined(e[i])||(e[i]=t[i]);return e},id:function(t,i){return t=Ext.getDom(t,!0)||{},t.id||(t.id=(i||"ext-gen")+ ++e),t.id},extend:function(){var e=function(e){for(var t in e)this[t]=e[t]},t=Object.prototype.constructor;return function(i,s,n){"object"==typeof s&&(n=s,s=i,i=n.constructor!=t?n.constructor:function(){s.apply(this,arguments)});var r,a=function(){},o=s.prototype;return a.prototype=o,r=i.prototype=new a,r.constructor=i,i.superclass=o,o.constructor==t&&(o.constructor=s),i.override=function(e){Ext.override(i,e)},r.superclass=r.supr=function(){return o},r.override=e,Ext.override(i,n),i.extend=function(e){return Ext.extend(i,e)},i}}(),override:function(e,t){if(t){var i=e.prototype;Ext.apply(i,t),Ext.isIE&&t.hasOwnProperty("toString")&&(i.toString=t.toString)}},namespace:function(){for(var e,t,i,s,n,r,a=arguments.length,o=0;a>o;++o)for(i=arguments[o],s=arguments[o].split("."),r=window[s[0]],void 0===r&&(r=window[s[0]]={}),n=s.slice(1),e=n.length,t=0;e>t;++t)r=r[n[t]]=r[n[t]]||{};return r},urlEncode:function(e,t){var i,s=[],n=encodeURIComponent;return Ext.iterate(e,function(e,t){i=Ext.isEmpty(t),Ext.each(i?e:t,function(t){s.push("&",n(e),"=",Ext.isEmpty(t)||t==e&&i?"":Ext.isDate(t)?Ext.encode(t).replace(/"/g,""):n(t))})}),t||(s.shift(),t=""),t+s.join("")},urlDecode:function(e,t){if(Ext.isEmpty(e))return{};var i,s,n={},r=e.split("&"),a=decodeURIComponent;return Ext.each(r,function(e){e=e.split("="),i=a(e[0]),s=a(e[1]),n[i]=t||!n[i]?s:[].concat(n[i]).concat(s)}),n},urlAppend:function(e,t){return Ext.isEmpty(t)?e:e+(-1===e.indexOf("?")?"?":"&")+t},toArray:function(){return f?function(e,t,i,s){s=[];for(var n=0,r=e.length;r>n;n++)s.push(e[n]);return s.slice(t||0,i||s.length)}:function(e,t,i){return Array.prototype.slice.call(e,t||0,i||e.length)}}(),isIterable:function(e){return Ext.isArray(e)||e.callee?!0:/NodeList|HTMLCollection/.test(t.call(e))?!0:("undefined"!=typeof e.nextNode||e.item)&&Ext.isNumber(e.length)},each:function(e,t,i){if(!Ext.isEmpty(e,!0)){(!Ext.isIterable(e)||Ext.isPrimitive(e))&&(e=[e]);for(var s=0,n=e.length;n>s;s++)if(t.call(i||e[s],e[s],s,e)===!1)return s}},iterate:function(e,t,i){if(!Ext.isEmpty(e)){if(Ext.isIterable(e))return Ext.each(e,t,i),void 0;if("object"==typeof e)for(var s in e)if(e.hasOwnProperty(s)&&t.call(i||e,s,e[s],e)===!1)return}},getDom:function(e,t){if(!e||!n)return null;if(e.dom)return e.dom;if("string"==typeof e){var i=n.getElementById(e);return i&&f&&t?e==i.getAttribute("id")?i:null:i}return e},getBody:function(){return Ext.get(n.body||n.documentElement)},getHead:function(){var e;return function(){return void 0==e&&(e=Ext.get(n.getElementsByTagName("head")[0])),e}}(),removeNode:f&&!y?function(){var e;return function(t){t&&"BODY"!=t.tagName&&(Ext.enableNestedListenerRemoval?Ext.EventManager.purgeElement(t,!0):Ext.EventManager.removeAll(t),e=e||n.createElement("div"),e.appendChild(t),e.innerHTML="",delete Ext.elCache[t.id])}}():function(e){e&&e.parentNode&&"BODY"!=e.tagName&&(Ext.enableNestedListenerRemoval?Ext.EventManager.purgeElement(e,!0):Ext.EventManager.removeAll(e),e.parentNode.removeChild(e),delete Ext.elCache[e.id])},isEmpty:function(e,t){return null===e||void 0===e||Ext.isArray(e)&&!e.length||(t?!1:""===e)},isArray:function(e){return"[object Array]"===t.apply(e)},isDate:function(e){return"[object Date]"===t.apply(e)},isObject:function(e){return!!e&&"[object Object]"===Object.prototype.toString.call(e)},isPrimitive:function(e){return Ext.isString(e)||Ext.isNumber(e)||Ext.isBoolean(e)},isFunction:function(e){return"[object Function]"===t.apply(e)},isNumber:function(e){return"number"==typeof e&&isFinite(e)},isString:function(e){return"string"==typeof e},isBoolean:function(e){return"boolean"==typeof e},isElement:function(e){return e?!!e.tagName:!1},isDefined:function(e){return"undefined"!=typeof e},isOpera:o,isWebKit:h,isChrome:l,isSafari:u,isSafari3:d,isSafari4:p,isSafari2:c,isIE:f,isIE6:v,isIE7:m,isIE8:y,isIE9:g,isGecko:x,isGecko2:E,isGecko3:b,isBorderBox:L,isLinux:O,isWindows:S,isMac:C,isAir:w}),Ext.ns=Ext.namespace}(),Ext.ns("Ext.util","Ext.lib","Ext.data","Ext.supports"),Ext.elCache={},Ext.apply(Function.prototype,{createInterceptor:function(e,t){var i=this;return Ext.isFunction(e)?function(){var s=this,n=arguments;return e.target=s,e.method=i,e.apply(t||s||window,n)!==!1?i.apply(s||window,n):null}:this},createCallback:function(){var e=arguments,t=this;return function(){return t.apply(window,e)}},createDelegate:function(e,t,i){var s=this;return function(){var n=t||arguments;if(i===!0)n=Array.prototype.slice.call(arguments,0),n=n.concat(t);else if(Ext.isNumber(i)){n=Array.prototype.slice.call(arguments,0);var r=[i,0].concat(t);Array.prototype.splice.apply(n,r)}return s.apply(e||window,n)}},defer:function(e,t,i,s){var n=this.createDelegate(t,i,s);return e>0?setTimeout(n,e):(n(),0)}}),Ext.applyIf(String,{format:function(e){var t=Ext.toArray(arguments,1);return e.replace(/\{(\d+)\}/g,function(e,i){return t[i]})}}),Ext.applyIf(Array.prototype,{indexOf:function(e,t){var i=this.length;for(t=t||0,t+=0>t?i:0;i>t;++t)if(this[t]===e)return t;return-1},remove:function(e){var t=this.indexOf(e);return-1!=t&&this.splice(t,1),this}}),Ext.util.TaskRunner=function(e){e=e||10;var t=[],i=[],s=0,n=!1,r=function(){n=!1,clearInterval(s),s=0},a=function(){n||(n=!0,s=setInterval(l,e))},o=function(e){i.push(e),e.onStop&&e.onStop.apply(e.scope||e)},l=function(){var e=i.length,s=(new Date).getTime();if(e>0){for(var n=0;e>n;n++)t.remove(i[n]);if(i=[],t.length<1)return r(),void 0}for(var a,l,h,n=0,u=t.length;u>n;++n){if(a=t[n],l=s-a.taskRunTime,a.interval<=l&&(h=a.run.apply(a.scope||a,a.args||[++a.taskRunCount]),a.taskRunTime=s,h===!1||a.taskRunCount===a.repeat))return o(a),void 0;a.duration&&a.duration<=s-a.taskStartTime&&o(a)}};this.start=function(e){return t.push(e),e.taskStartTime=(new Date).getTime(),e.taskRunTime=0,e.taskRunCount=0,a(),e},this.stop=function(e){return o(e),e},this.stopAll=function(){r();for(var e=0,s=t.length;s>e;e++)t[e].onStop&&t[e].onStop();t=[],i=[]}},Ext.TaskMgr=new Ext.util.TaskRunner,function(){function e(e){return i||(i=new Ext.Element.Flyweight),i.dom=e,i}function t(){var e=Function.prototype;delete e.createSequence,delete e.defer,delete e.createDelegate,delete e.createCallback,delete e.createInterceptor,window.detachEvent("onunload",t)}var i;!function(){var t=document,i="CSS1Compat"==t.compatMode,s=Math.max,n=Math.round,r=parseInt;Ext.lib.Dom={isAncestor:function(e,t){var i=!1;if(e=Ext.getDom(e),t=Ext.getDom(t),e&&t){if(e.contains)return e.contains(t);if(e.compareDocumentPosition)return!!(16&e.compareDocumentPosition(t));for(;t=t.parentNode;)i=t==e||i}return i},getViewWidth:function(e){return e?this.getDocumentWidth():this.getViewportWidth()},getViewHeight:function(e){return e?this.getDocumentHeight():this.getViewportHeight()},getDocumentHeight:function(){return s(i?t.documentElement.scrollHeight:t.body.scrollHeight,this.getViewportHeight())},getDocumentWidth:function(){return s(i?t.documentElement.scrollWidth:t.body.scrollWidth,this.getViewportWidth())},getViewportHeight:function(){return Ext.isIE?Ext.isStrict?t.documentElement.clientHeight:t.body.clientHeight:self.innerHeight},getViewportWidth:function(){return Ext.isStrict||Ext.isOpera?Ext.isIE?t.documentElement.clientWidth:self.innerWidth:t.body.clientWidth},getY:function(e){return this.getXY(e)[1]},getX:function(e){return this.getXY(e)[0]},getXY:function(i){var s,a,o,l,h,u,c,d,p=0,f=0,m=t.body||t.documentElement,y=[0,0];if(i=Ext.getDom(i),i!=m)if(i.getBoundingClientRect)o=i.getBoundingClientRect(),c=e(document).getScroll(),y=[n(o.left+c.left),n(o.top+c.top)];else{for(s=i,d=e(i).isStyle("position","absolute");s;)a=e(s),p+=s.offsetLeft,f+=s.offsetTop,d=d||a.isStyle("position","absolute"),Ext.isGecko&&(f+=l=r(a.getStyle("borderTopWidth"),10)||0,p+=h=r(a.getStyle("borderLeftWidth"),10)||0,s==i||a.isStyle("overflow","visible")||(p+=h,f+=l)),s=s.offsetParent;for(Ext.isSafari&&d&&(p-=m.offsetLeft,f-=m.offsetTop),Ext.isGecko&&!d&&(u=e(m),p+=r(u.getStyle("borderLeftWidth"),10)||0,f+=r(u.getStyle("borderTopWidth"),10)||0),s=i.parentNode;s&&s!=m;)(!Ext.isOpera||"TR"!=s.tagName&&!e(s).isStyle("display","inline"))&&(p-=s.scrollLeft,f-=s.scrollTop),s=s.parentNode;y=[p,f]}return y},setXY:function(e,t){(e=Ext.fly(e,"_setXY")).position();var i,s=e.translatePoints(t),n=e.dom.style;for(i in s)isNaN(s[i])||(n[i]=s[i]+"px")},setX:function(e,t){this.setXY(e,[t,!1])},setY:function(e,t){this.setXY(e,[!1,t])}}}(),Ext.lib.Event=function(){function e(e){return!t(e.currentTarget,T.getRelatedTarget(e))}function t(e,t){if(e&&e.firstChild)for(;t;){if(t===e)return!0;t=t.parentNode,t&&1!=t.nodeType&&(t=null)}return!1}function i(){var e,t,i,n,r=!1,l=[],d=!o||h>0;if(!c){for(c=!0,t=0;t<u.length;++t)i=u[t],i&&(e=p.getElementById(i.id))&&(!i.checkReady||o||e.nextSibling||p&&p.body?(n=i.override,e=n?n===!0?i.obj:n:e,i.fn.call(e,i.obj),u.remove(i),--t):l.push(i));h=0===l.length?0:h-1,d?s():(clearInterval(a),a=null),r=!(c=!1)}return r}function s(){if(!a){var e=function(){i()};a=setInterval(e,m)}}function n(){var e=p.documentElement,t=p.body;return e&&(e[b]||e[E])?[e[E],e[b]]:t?[t[E],t[b]]:[0,0]}function r(e,t){e=e.browserEvent||e;var i=e["page"+t];return i||0===i||(i=e["client"+t]||0,Ext.isIE&&(i+=n()["X"==t?0:1])),i}var a,o=!1,l={},h=0,u=[],c=!1,d=window,p=document,f=200,m=20,y=0,g=1,v=2,x=3,E="scrollLeft",b="scrollTop",L="unload",S="mouseover",C="mouseout",w=function(){var t;return t=d.addEventListener?function(t,i,s,n){return"mouseenter"==i?(s=s.createInterceptor(e),t.addEventListener(S,s,n)):"mouseleave"==i?(s=s.createInterceptor(e),t.addEventListener(C,s,n)):t.addEventListener(i,s,n),s}:d.attachEvent?function(e,t,i){return e.attachEvent("on"+t,i),i}:function(){}}(),O=function(){var e;return e=d.removeEventListener?function(e,t,i,s){"mouseenter"==t?t=S:"mouseleave"==t&&(t=C),e.removeEventListener(t,i,s)}:d.detachEvent?function(e,t,i){e.detachEvent("on"+t,i)}:function(){}}(),T={extAdapter:!0,onAvailable:function(e,t,i,n){u.push({id:e,fn:t,obj:i,override:n,checkReady:!1}),h=f,s()},addListener:function(e,t,i){return e=Ext.getDom(e),e&&i?t==L?(void 0===l[e.id]&&(l[e.id]=[]),l[e.id].push([t,i]),i):w(e,t,i,!1):!1},removeListener:function(e,t,i){e=Ext.getDom(e);var s,n,r,a;if(e&&i){if(t==L){if(void 0!==(a=l[e.id]))for(s=0,n=a.length;n>s;s++)(r=a[s])&&r[y]==t&&r[g]==i&&l[e.id].splice(s,1);return}O(e,t,i,!1)}},getTarget:function(e){return e=e.browserEvent||e,this.resolveTextNode(e.target||e.srcElement)},resolveTextNode:Ext.isGecko?function(e){if(e){var t=HTMLElement.prototype.toString.call(e);if("[xpconnect wrapped native prototype]"!=t&&"[object XULElement]"!=t)return 3==e.nodeType?e.parentNode:e}}:function(e){return e&&3==e.nodeType?e.parentNode:e},getRelatedTarget:function(e){return e=e.browserEvent||e,this.resolveTextNode(e.relatedTarget||(/(mouseout|mouseleave)/.test(e.type)?e.toElement:/(mouseover|mouseenter)/.test(e.type)?e.fromElement:null))},getPageX:function(e){return r(e,"X")},getPageY:function(e){return r(e,"Y")},getXY:function(e){return[this.getPageX(e),this.getPageY(e)]},stopEvent:function(e){this.stopPropagation(e),this.preventDefault(e)},stopPropagation:function(e){e=e.browserEvent||e,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},preventDefault:function(e){e=e.browserEvent||e,e.preventDefault?e.preventDefault():(e.keyCode&&(e.keyCode=0),e.returnValue=!1)},getEvent:function(e){if(e=e||d.event,!e)for(var t=this.getEvent.caller;t&&(e=t.arguments[0],!e||Event!=e.constructor);)t=t.caller;return e},getCharCode:function(e){return e=e.browserEvent||e,e.charCode||e.keyCode||0},getListeners:function(e,t){Ext.EventManager.getListeners(e,t)},purgeElement:function(e,t,i){Ext.EventManager.purgeElement(e,t,i)},_load:function(e){o=!0,Ext.isIE&&e!==!0&&O(d,"load",arguments.callee)},_unload:function(e){var t,i,s,n,r,a,o=Ext.lib.Event;for(n in l)for(s=l[n],t=0,r=s.length;r>t;t++)if(i=s[t])try{a=i[x]?i[x]===!0?i[v]:i[x]:d,i[g].call(a,o.getEvent(e),i[v])}catch(h){}Ext.EventManager._unload(),O(d,L,o._unload)}};return T.on=T.addListener,T.un=T.removeListener,p&&p.body?T._load(!0):w(d,"load",T._load),w(d,L,T._unload),i(),T}(),Ext.lib.Ajax=function(){function e(e){function t(e,t){for(i in t)t.hasOwnProperty(i)&&e.setRequestHeader(i,t[i])}var i,s=e.conn,n={};Ext.apply(n,f.headers,f.defaultHeaders),t(s,n),delete f.headers}function t(e,t,i,s){return{tId:e,status:i?-1:0,statusText:i?"transaction aborted":"communication failure",isAbort:i,isTimeout:s,argument:t}}function i(e,t){(f.headers=f.headers||{})[e]=t}function s(e,t){var i,s,n,r={},a=e.conn,o=1223==a.status;try{i=e.conn.getAllResponseHeaders(),Ext.each(i.replace(/\r\n/g,"\n").split("\n"),function(e){s=e.indexOf(":"),s>=0&&(n=e.substr(0,s).toLowerCase()," "==e.charAt(s+1)&&++s,r[n]=e.substr(s+1))})}catch(l){}return{tId:e.tId,status:o?204:a.status,statusText:o?"No Content":a.statusText,getResponseHeader:function(e){return r[e.toLowerCase()]},getAllResponseHeaders:function(){return i},responseText:a.responseText,responseXML:a.responseXML,argument:t}}function n(e){e.tId&&(f.conn[e.tId]=null),e.conn=null,e=null}function r(e,i,r,a){if(!i)return n(e),void 0;var o,l;try{o=void 0!==e.conn.status&&0!=e.conn.status?e.conn.status:13030}catch(h){o=13030}if(o>=200&&300>o||Ext.isIE&&1223==o)l=s(e,i.argument),i.success&&(i.scope?i.success.apply(i.scope,[l]):i.success(l));else switch(o){case 12002:case 12029:case 12030:case 12031:case 12152:case 13030:l=t(e.tId,i.argument,r?r:!1,a),i.failure&&(i.scope?i.failure.apply(i.scope,[l]):i.failure(l));break;default:l=s(e,i.argument),i.failure&&(i.scope?i.failure.apply(i.scope,[l]):i.failure(l))}n(e),l=null}function a(e,t,i,s,n,a){i&&4==i.readyState&&(clearInterval(n[s]),n[s]=null,a&&(clearTimeout(f.timeout[s]),f.timeout[s]=null),r(e,t))}function o(e,t){f.abort(e,t,!0)}function l(e,t){t=t||{};var i=e.conn,s=e.tId,n=f.poll,r=t.timeout||null;r&&(f.conn[s]=i,f.timeout[s]=setTimeout(o.createCallback(e,t),r)),n[s]=setInterval(a.createCallback(e,t,i,s,n,r),f.pollInterval)}function h(t,s,n,r){var a=u()||null;return a&&(a.conn.open(t,s,!0),f.useDefaultXhrHeader&&i("X-Requested-With",f.defaultXhrHeader),!r||!f.useDefaultHeader||f.headers&&f.headers[p]||i(p,f.defaultPostHeader),(f.defaultHeaders||f.headers)&&e(a),l(a,n),a.conn.send(r||null)),a}function u(){var e;try{(e=c(f.transactionId))&&f.transactionId++}catch(t){}finally{return e}}function c(e){var t;try{t=new XMLHttpRequest}catch(i){for(var s=Ext.isIE6?1:0;s<d.length;++s)try{t=new ActiveXObject(d[s]);break}catch(i){}}finally{return{conn:t,tId:e}}}var d=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP"],p="Content-Type",f={request:function(e,t,s,n,r){if(r){var a,o=this,l=r.xmlData,u=r.jsonData;Ext.applyIf(o,r),(l||u)&&(a=o.headers,a&&a[p]||i(p,l?"text/xml":"application/json"),n=l||(Ext.isPrimitive(u)?u:Ext.encode(u)))}return h(e||r.method||"POST",t,s,n)},serializeForm:function(e){var t,i,s,n=e.elements||(document.forms[e]||Ext.getDom(e)).elements,r=!1,a=encodeURIComponent,o="";return Ext.each(n,function(e){t=e.name,i=e.type,!e.disabled&&t&&(/select-(one|multiple)/i.test(i)?Ext.each(e.options,function(e){e.selected&&(s=e.hasAttribute?e.hasAttribute("value"):e.getAttributeNode("value").specified,o+=String.format("{0}={1}&",a(t),a(s?e.value:e.text)))}):/file|undefined|reset|button/i.test(i)||/radio|checkbox/i.test(i)&&!e.checked||"submit"==i&&r||(o+=a(t)+"="+a(e.value)+"&",r=/submit/i.test(i)))}),o.substr(0,o.length-1)},useDefaultHeader:!0,defaultPostHeader:"application/x-www-form-urlencoded; charset=UTF-8",useDefaultXhrHeader:!0,defaultXhrHeader:"XMLHttpRequest",poll:{},timeout:{},conn:{},pollInterval:50,transactionId:0,abort:function(e,t,i){var s=this,n=e.tId,a=!1;return s.isCallInProgress(e)&&(e.conn.abort(),clearInterval(s.poll[n]),s.poll[n]=null,clearTimeout(f.timeout[n]),s.timeout[n]=null,r(e,t,a=!0,i)),a},isCallInProgress:function(e){return e.conn&&!{0:!0,4:!0}[e.conn.readyState]}};return f}(),function(){var e=Ext.lib,t=/width|height|opacity|padding/i,i=/^((width|height)|(top|left))$/,s=/width|height|top$|bottom$|left$|right$/i,n=/\d+(em|%|en|ex|pt|in|cm|mm|pc)$/i,r=function(e){return"undefined"!=typeof e},a=function(){return new Date};e.Anim={motion:function(e,t,i,s,n,r){return this.run(e,t,i,s,n,r,Ext.lib.Motion)},run:function(e,t,i,s,n,r,a){a=a||Ext.lib.AnimBase,"string"==typeof s&&(s=Ext.lib.Easing[s]);var o=new a(e,t,i,s);return o.animateX(function(){Ext.isFunction(n)&&n.call(r)}),o}},e.AnimBase=function(e,t,i,s){e&&this.init(e,t,i,s)},e.AnimBase.prototype={doMethod:function(e,t,i){var s=this;return s.method(s.curFrame,t,i-t,s.totalFrames)},setAttr:function(e,i,s){t.test(e)&&0>i&&(i=0),Ext.fly(this.el,"_anim").setStyle(e,i+s)},getAttr:function(e){var t=Ext.fly(this.el),s=t.getStyle(e),r=i.exec(e)||[];return"auto"===s||n.test(s)?r[2]||"absolute"==t.getStyle("position")&&r[3]?t.dom["offset"+r[0].charAt(0).toUpperCase()+r[0].substr(1)]:0:parseFloat(s)},getDefaultUnit:function(e){return s.test(e)?"px":""},animateX:function(e,t){var i=this,s=function(){i.onComplete.removeListener(s),Ext.isFunction(e)&&e.call(t||i,i)};i.onComplete.addListener(s,i),i.animate()},setRunAttr:function(e){var t,i=this,s=this.attributes[e],n=s.to,a=s.by,o=s.from,l=s.unit,h=this.runAttrs[e]={};if(!r(n)&&!r(a))return!1;var u=r(o)?o:i.getAttr(e);if(r(n))t=n;else if(r(a))if(Ext.isArray(u)){t=[];for(var c=0,d=u.length;d>c;c++)t[c]=u[c]+a[c]}else t=u+a;Ext.apply(h,{start:u,end:t,unit:r(l)?l:i.getDefaultUnit(e)})},init:function(t,i,s,n){var r=this,o=0,l=e.AnimMgr;Ext.apply(r,{isAnimated:!1,startTime:null,el:Ext.getDom(t),attributes:i||{},duration:s||1,method:n||e.Easing.easeNone,useSec:!0,curFrame:0,totalFrames:l.fps,runAttrs:{},animate:function(){var e=this,t=e.duration;return e.isAnimated?!1:(e.curFrame=0,e.totalFrames=e.useSec?Math.ceil(l.fps*t):t,l.registerElement(e),void 0)},stop:function(e){var t=this;e&&(t.curFrame=t.totalFrames,t._onTween.fire()),l.stop(t)}});var h=function(){var e,t=this;t.onStart.fire(),t.runAttrs={};for(e in this.attributes)this.setRunAttr(e);t.isAnimated=!0,t.startTime=a(),o=0},u=function(){var e=this;e.onTween.fire({duration:a()-e.startTime,curFrame:e.curFrame});var t=e.runAttrs;for(var i in t)this.setAttr(i,e.doMethod(i,t[i].start,t[i].end),t[i].unit);++o},c=function(){var e=this,t=(a()-e.startTime)/1e3,i={duration:t,frames:o,fps:o/t};e.isAnimated=!1,o=0,e.onComplete.fire(i)};r.onStart=new Ext.util.Event(r),r.onTween=new Ext.util.Event(r),r.onComplete=new Ext.util.Event(r),(r._onStart=new Ext.util.Event(r)).addListener(h),(r._onTween=new Ext.util.Event(r)).addListener(u),(r._onComplete=new Ext.util.Event(r)).addListener(c)}},Ext.lib.AnimMgr=new function(){var e=this,t=null,i=[],s=0;Ext.apply(e,{fps:1e3,delay:1,registerElement:function(t){i.push(t),++s,t._onStart.fire(),e.start()},unRegister:function(t,r){t._onComplete.fire(),r=r||n(t),-1!=r&&i.splice(r,1),--s<=0&&e.stop()},start:function(){null===t&&(t=setInterval(e.run,e.delay))},stop:function(n){if(n)e.unRegister(n);else{clearInterval(t);for(var r=0,a=i.length;a>r;++r)i[0].isAnimated&&e.unRegister(i[0],0);i=[],t=null,s=0}},run:function(){var t,s,n,a;for(s=0,n=i.length;n>s;s++)a=i[s],a&&a.isAnimated&&(t=a.totalFrames,a.curFrame<t||null===t?(++a.curFrame,a.useSec&&r(a),a._onTween.fire()):e.stop(a))}});var n=function(e){var t,s;for(t=0,s=i.length;s>t;t++)if(i[t]===e)return t;return-1},r=function(e){var t=e.totalFrames,i=e.curFrame,s=e.duration,n=1e3*i*s/t,r=a()-e.startTime,o=0;o=1e3*s>r?Math.round((r/n-1)*i):t-(i+1),o>0&&isFinite(o)&&(e.curFrame+o>=t&&(o=t-(i+1)),e.curFrame+=o)}},e.Bezier=new function(){this.getPosition=function(e,t){var i,s,n=e.length,r=[],a=1-t;for(i=0;n>i;++i)r[i]=[e[i][0],e[i][1]];for(s=1;n>s;++s)for(i=0;n-s>i;++i)r[i][0]=a*r[i][0]+t*r[parseInt(i+1,10)][0],r[i][1]=a*r[i][1]+t*r[parseInt(i+1,10)][1];return[r[0][0],r[0][1]]}},e.Easing={easeNone:function(e,t,i,s){return i*e/s+t},easeIn:function(e,t,i,s){return i*(e/=s)*e+t},easeOut:function(e,t,i,s){return-i*(e/=s)*(e-2)+t}},function(){e.Motion=function(t,i,s,n){t&&e.Motion.superclass.constructor.call(this,t,i,s,n)},Ext.extend(e.Motion,Ext.lib.AnimBase);var t=e.Motion.superclass,i=/^points$/i;Ext.apply(e.Motion.prototype,{setAttr:function(e,s,n){var r=this,a=t.setAttr;i.test(e)?(n=n||"px",a.call(r,"left",s[0],n),a.call(r,"top",s[1],n)):a.call(r,e,s,n)},getAttr:function(e){var s=this,n=t.getAttr;return i.test(e)?[n.call(s,"left"),n.call(s,"top")]:n.call(s,e)},doMethod:function(s,n,r){var a=this;return i.test(s)?e.Bezier.getPosition(a.runAttrs[s],a.method(a.curFrame,0,100,a.totalFrames)/100):t.doMethod.call(a,s,n,r)},setRunAttr:function(n){if(i.test(n)){var a,o,l,h,u,c=this,d=this.el,p=this.attributes.points,f=p.control||[],m=p.from,y=p.to,g=p.by,v=e.Dom;if(f.length>0&&!Ext.isArray(f[0])&&(f=[f]),Ext.fly(d,"_anim").position(),v.setXY(d,r(m)?m:v.getXY(d)),a=c.getAttr("points"),r(y))for(l=s.call(c,y,a),o=0,h=f.length;h>o;++o)f[o]=s.call(c,f[o],a);else if(r(g))for(l=[a[0]+g[0],a[1]+g[1]],o=0,h=f.length;h>o;++o)f[o]=[a[0]+f[o][0],a[1]+f[o][1]];u=this.runAttrs[n]=[a],f.length>0&&(u=u.concat(f)),u[u.length]=l}else t.setRunAttr.call(this,n)}});var s=function(t,i){var s=e.Dom.getXY(this.el);return[t[0]-s[0]+i[0],t[1]-s[1]+i[1]]}}()}(),function(){var e=Math.abs,t=Math.PI,i=Math.asin,s=Math.pow,n=Math.sin,r=Ext.lib;Ext.apply(r.Easing,{easeBoth:function(e,t,i,s){return(e/=s/2)<1?i/2*e*e+t:-i/2*(--e*(e-2)-1)+t},easeInStrong:function(e,t,i,s){return i*(e/=s)*e*e*e+t},easeOutStrong:function(e,t,i,s){return-i*((e=e/s-1)*e*e*e-1)+t},easeBothStrong:function(e,t,i,s){return(e/=s/2)<1?i/2*e*e*e*e+t:-i/2*((e-=2)*e*e*e-2)+t},elasticIn:function(r,a,o,l,h,u){if(0==r||1==(r/=l))return 0==r?a:a+o;u=u||.3*l;var c;return h>=e(o)?c=u/(2*t)*i(o/h):(h=o,c=u/4),-(h*s(2,10*(r-=1))*n((r*l-c)*2*t/u))+a},elasticOut:function(r,a,o,l,h,u){if(0==r||1==(r/=l))return 0==r?a:a+o;u=u||.3*l;var c;return h>=e(o)?c=u/(2*t)*i(o/h):(h=o,c=u/4),h*s(2,-10*r)*n((r*l-c)*2*t/u)+o+a},elasticBoth:function(r,a,o,l,h,u){if(0==r||2==(r/=l/2))return 0==r?a:a+o;u=u||l*.3*1.5;var c;return h>=e(o)?c=u/(2*t)*i(o/h):(h=o,c=u/4),1>r?-.5*h*s(2,10*(r-=1))*n((r*l-c)*2*t/u)+a:.5*h*s(2,-10*(r-=1))*n((r*l-c)*2*t/u)+o+a},backIn:function(e,t,i,s,n){return n=n||1.70158,i*(e/=s)*e*((n+1)*e-n)+t},backOut:function(e,t,i,s,n){return n||(n=1.70158),i*((e=e/s-1)*e*((n+1)*e+n)+1)+t},backBoth:function(e,t,i,s,n){return n=n||1.70158,(e/=s/2)<1?i/2*e*e*(((n*=1.525)+1)*e-n)+t:i/2*((e-=2)*e*(((n*=1.525)+1)*e+n)+2)+t},bounceIn:function(e,t,i,s){return i-r.Easing.bounceOut(s-e,0,i,s)+t},bounceOut:function(e,t,i,s){return(e/=s)<1/2.75?i*7.5625*e*e+t:2/2.75>e?i*(7.5625*(e-=1.5/2.75)*e+.75)+t:2.5/2.75>e?i*(7.5625*(e-=2.25/2.75)*e+.9375)+t:i*(7.5625*(e-=2.625/2.75)*e+.984375)+t},bounceBoth:function(e,t,i,s){return s/2>e?.5*r.Easing.bounceIn(2*e,0,i,s)+t:.5*r.Easing.bounceOut(2*e-s,0,i,s)+.5*i+t}})}(),function(){function e(e){var t,i,s=parseInt,n=null;return 3==e.length?e:(Ext.each([a,r,o],function(r,a){return t=0==a%2?16:10,i=r.exec(e),i&&4==i.length?(n=[s(i[1],t),s(i[2],t),s(i[3],t)],!1):void 0}),n)}var t=Ext.lib;t.Anim.color=function(e,i,s,n,r,a){return t.Anim.run(e,i,s,n,r,a,t.ColorAnim)},t.ColorAnim=function(e,i,s,n){t.ColorAnim.superclass.constructor.call(this,e,i,s,n)},Ext.extend(t.ColorAnim,t.AnimBase);var i=t.ColorAnim.superclass,s=/color$/i,n=/^transparent|rgba\(0, 0, 0, 0\)$/,r=/^rgb\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\)$/i,a=/^#?([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})$/i,o=/^#?([0-9A-F]{1})([0-9A-F]{1})([0-9A-F]{1})$/i,l=function(e){return"undefined"!=typeof e};Ext.apply(t.ColorAnim.prototype,{getAttr:function(e){var t,r=this,a=r.el;if(s.test(e))for(;a&&n.test(t=Ext.fly(a).getStyle(e));)a=a.parentNode,t="fff";else t=i.getAttr.call(r,e);return t},doMethod:function(e,t,n){var r,a,o,l,h=this,u=Math.floor;if(s.test(e)){for(r=[],n=n||[],a=0,o=t.length;o>a;a++)l=t[a],r[a]=i.doMethod.call(h,e,l,n[a]);r="rgb("+u(r[0])+","+u(r[1])+","+u(r[2])+")"}else r=i.doMethod.call(h,e,t,n);return r},setRunAttr:function(t){var n,r=this,a=r.attributes[t],o=a.to,h=a.by;if(i.setRunAttr.call(r,t),n=r.runAttrs[t],s.test(t)){var u=e(n.start),c=e(n.end);if(!l(o)&&l(h)){c=e(h);for(var d=0,p=u.length;p>d;d++)c[d]=u[d]+c[d]}n.start=u,n.end=c}}})}(),function(){var e=Ext.lib;e.Anim.scroll=function(t,i,s,n,r,a){return e.Anim.run(t,i,s,n,r,a,e.Scroll)},e.Scroll=function(t,i,s,n){t&&e.Scroll.superclass.constructor.call(this,t,i,s,n)},Ext.extend(e.Scroll,e.ColorAnim);var t=e.Scroll.superclass,i="scroll";Ext.apply(e.Scroll.prototype,{doMethod:function(e,s,n){var r,a=this,o=a.curFrame,l=a.totalFrames;return r=e==i?[a.method(o,s[0],n[0]-s[0],l),a.method(o,s[1],n[1]-s[1],l)]:t.doMethod.call(a,e,s,n)},getAttr:function(e){var s=this;return e==i?[s.el.scrollLeft,s.el.scrollTop]:t.getAttr.call(s,e)},setAttr:function(e,s,n){var r=this;e==i?(r.el.scrollLeft=s[0],r.el.scrollTop=s[1]):t.setAttr.call(r,e,s,n)}})}(),Ext.isIE&&window.attachEvent("onunload",t)}(),function(){function e(e,t,i){return function(){t.target==arguments[0]&&e.apply(i,Array.prototype.slice.call(arguments,0))}}function t(e,t,i,s){return i.task=new n.DelayedTask,function(){i.task.delay(t.buffer,e,s,Array.prototype.slice.call(arguments,0))}}function i(e,t,i,s){return function(){return t.removeListener(i,s),e.apply(s,arguments)}}function s(e,t,i,s){return function(){var r=new n.DelayedTask,a=Array.prototype.slice.call(arguments,0);i.tasks||(i.tasks=[]),i.tasks.push(r),r.delay(t.delay||10,function(){i.tasks.remove(r),e.apply(s,a)},s)}}var n=Ext.util,r=Ext.each,a=!0,o=!1;n.Observable=function(){var e=this,t=e.events;e.listeners&&(e.on(e.listeners),delete e.listeners),e.events=t||{}},n.Observable.prototype={filterOptRe:/^(?:scope|delay|buffer|single)$/,fireEvent:function(){var e,t,i,s=Array.prototype.slice.call(arguments,0),n=s[0].toLowerCase(),r=this,l=a,h=r.events[n];if(r.eventsSuspended===a)(t=r.eventQueue)&&t.push(s);else if("object"==typeof h)if(h.bubble){if(h.fire.apply(h,s.slice(1))===o)return o;if(i=r.getBubbleTarget&&r.getBubbleTarget(),i&&i.enableBubble)return e=i.events[n],e&&"object"==typeof e&&e.bubble||i.enableBubble(n),i.fireEvent.apply(i,s)}else s.shift(),l=h.fire.apply(h,s);return l},addListener:function(e,t,i,s){var r,o,l,h=this;if("object"==typeof e){s=e;for(r in s)o=s[r],h.filterOptRe.test(r)||h.addListener(r,o.fn||o,o.scope||s.scope,o.fn?o:s)}else e=e.toLowerCase(),l=h.events[e]||a,"boolean"==typeof l&&(h.events[e]=l=new n.Event(h,e)),l.addListener(t,i,"object"==typeof s?s:{})},removeListener:function(e,t,i){var s=this.events[e.toLowerCase()];"object"==typeof s&&s.removeListener(t,i)},purgeListeners:function(){var e,t,i=this.events;for(t in i)e=i[t],"object"==typeof e&&e.clearListeners()},addEvents:function(e){var t=this;if(t.events=t.events||{},"string"==typeof e)for(var i=arguments,s=i.length;s--;)t.events[i[s]]=t.events[i[s]]||a;else Ext.applyIf(t.events,e)},hasListener:function(e){var t=this.events[e.toLowerCase()];return"object"==typeof t&&t.listeners.length>0},suspendEvents:function(e){this.eventsSuspended=a,e&&!this.eventQueue&&(this.eventQueue=[])},resumeEvents:function(){var e=this,t=e.eventQueue||[];e.eventsSuspended=o,delete e.eventQueue,r(t,function(t){e.fireEvent.apply(e,t)})}};var l=n.Observable.prototype;l.on=l.addListener,l.un=l.removeListener,n.Observable.releaseCapture=function(e){e.fireEvent=l.fireEvent},n.Event=function(e,t){this.name=t,this.obj=e,this.listeners=[]},n.Event.prototype={addListener:function(e,t,i){var s,n=this;t=t||n.obj,n.isListening(e,t)||(s=n.createListener(e,t,i),n.firing&&(n.listeners=n.listeners.slice(0)),n.listeners.push(s))},createListener:function(n,r,a){a=a||{},r=r||this.obj;var o={fn:n,scope:r,options:a},l=n;return a.target&&(l=e(l,a,r)),a.delay&&(l=s(l,a,o,r)),a.single&&(l=i(l,this,n,r)),a.buffer&&(l=t(l,a,o,r)),o.fireFn=l,o},findListener:function(e,t){var i,s=this.listeners,n=s.length;for(t=t||this.obj;n--;)if(i=s[n],i&&i.fn==e&&i.scope==t)return n;return-1},isListening:function(e,t){return-1!=this.findListener(e,t)},removeListener:function(e,t){var i,s,n,r=this,l=o;if(-1!=(i=r.findListener(e,t))){if(r.firing&&(r.listeners=r.listeners.slice(0)),s=r.listeners[i],s.task&&(s.task.cancel(),delete s.task),n=s.tasks&&s.tasks.length){for(;n--;)s.tasks[n].cancel();delete s.tasks}r.listeners.splice(i,1),l=a}return l},clearListeners:function(){for(var e=this,t=e.listeners,i=t.length;i--;)e.removeListener(t[i].fn,t[i].scope)},fire:function(){var e,t=this,i=t.listeners,s=i.length,n=0;if(s>0){t.firing=a;for(var r=Array.prototype.slice.call(arguments,0);s>n;n++)if(e=i[n],e&&e.fireFn.apply(e.scope||t.obj||window,r)===o)return t.firing=o}return t.firing=o,a}}}(),Ext.DomHelper=function(){function e(e,i,s,n){var a=r.insertHtml(n,Ext.getDom(e),t(i));return s?Ext.get(a,!0):a}function t(e){var i,s,n,r,a="";if("string"==typeof e)a=e;else if(Ext.isArray(e))for(var l=0;l<e.length;l++)e[l]&&(a+=t(e[l]));else{a+="<"+(e.tag=e.tag||"div");for(i in e)if(s=e[i],!h.test(i))if("object"==typeof s){a+=" "+i+'="';for(n in s)a+=n+":"+s[n]+";";a+='"'}else a+=" "+({cls:"class",htmlFor:"for"}[i]||i)+'="'+s+'"';o.test(e.tag)?a+="/>":(a+=">",(r=e.children||e.cn)?a+=t(r):e.html&&(a+=e.html),a+="</"+e.tag+">")}return a}function i(e,t,i,s){a.innerHTML=[t,i,s].join("");for(var n,r=-1,o=a;++r<e;)o=o.firstChild;if(n=o.nextSibling){for(var l=document.createDocumentFragment();o;)n=o.nextSibling,l.appendChild(o),o=n;o=l}return o}function s(e,t,s,n){var r,o;return a=a||document.createElement("div"),("td"!=e||t!=p&&t!=y)&&(u.test(e)||t!=m&&t!=f)?(o=t==m?s:t==f?s.nextSibling:t==p?s.firstChild:null,(t==m||t==f)&&(s=s.parentNode),r="td"==e||"tr"==e&&(t==y||t==p)?i(4,b,n,L):"tbody"==e&&(t==y||t==p)||"tr"==e&&(t==m||t==f)?i(3,x,n,E):i(2,g,n,v),s.insertBefore(r,o),r):void 0}function n(e){var t,i,s=document.createElement("div"),n=document.createDocumentFragment(),r=0;for(s.innerHTML=e,i=s.childNodes,t=i.length;t>r;r++)n.appendChild(i[r].cloneNode(!0));return n}var r,a=null,o=/^(?:br|frame|hr|img|input|link|meta|range|spacer|wbr|area|param|col)$/i,l=/^table|tbody|tr|td$/i,h=/tag|children|cn|html$/i,u=/td|tr|tbody/i,c=/([a-z0-9-]+)\s*:\s*([^;\s]+(?:\s*[^;\s]+)*);?/gi,d=/end/i,p="afterbegin",f="afterend",m="beforebegin",y="beforeend",g="<table>",v="</table>",x=g+"<tbody>",E="</tbody>"+v,b=x+"<tr>",L="</tr>"+E;return r={markup:function(e){return t(e)},applyStyles:function(e,t){if(t){var i;if(e=Ext.fly(e),"function"==typeof t&&(t=t.call()),"string"==typeof t)for(c.lastIndex=0;i=c.exec(t);)e.setStyle(i[1],i[2]);else"object"==typeof t&&e.setStyle(t)}},insertHtml:function(e,t,i){var r,a,o,h,u,c,g={};if(e=e.toLowerCase(),g[m]=["BeforeBegin","previousSibling"],g[f]=["AfterEnd","nextSibling"],!t.insertAdjacentHTML)return a=t.ownerDocument.createRange(),h="setStart"+(d.test(e)?"After":"Before"),g[e]?(a[h](t),u=a.createContextualFragment?a.createContextualFragment(i):n(i),t.parentNode.insertBefore(u,e==m?t:t.nextSibling),t[(e==m?"previous":"next")+"Sibling"]):(o=(e==p?"first":"last")+"Child",t.firstChild?(a[h](t[o]),u=a.createContextualFragment?a.createContextualFragment(i):n(i),e==p?t.insertBefore(u,t.firstChild):t.appendChild(u)):t.innerHTML=i,t[o]);if(l.test(t.tagName)&&(c=s(t.tagName.toLowerCase(),e,t,i)))return c;if(g[p]=["AfterBegin","firstChild"],g[y]=["BeforeEnd","lastChild"],r=g[e])return t.insertAdjacentHTML(r[0],i),t[r[1]];throw'Illegal insertion point -> "'+e+'"'},insertBefore:function(t,i,s){return e(t,i,s,m)},insertAfter:function(t,i,s){return e(t,i,s,f,"nextSibling")},insertFirst:function(t,i,s){return e(t,i,s,p,"firstChild")},append:function(t,i,s){return e(t,i,s,y,"",!0)},overwrite:function(e,i,s){return e=Ext.getDom(e),e.innerHTML=t(i),s?Ext.get(e.firstChild):e.firstChild},createHtml:t}}(),Ext.Template=function(e){var t,i=this,s=arguments,n=[];if(Ext.isArray(e))e=e.join("");
else if(s.length>1){for(var r=0,a=s.length;a>r;r++)t=s[r],"object"==typeof t?Ext.apply(i,t):n.push(t);e=n.join("")}i.html=e,i.compiled&&i.compile()},Ext.Template.prototype={re:/\{([\w\-]+)\}/g,applyTemplate:function(e){var t=this;return t.compiled?t.compiled(e):t.html.replace(t.re,function(t,i){return void 0!==e[i]?e[i]:""})},set:function(e,t){var i=this;return i.html=e,i.compiled=null,t?i.compile():i},compile:function(){function fn(e,t){return t="values['"+t+"']","'"+sep+"("+t+" == undefined ? '' : "+t+")"+sep+"'"}var me=this,sep=Ext.isGecko?"+":",";return eval("this.compiled = function(values){ return "+(Ext.isGecko?"'":"['")+me.html.replace(/\\/g,"\\\\").replace(/(\r\n|\n)/g,"\\n").replace(/'/g,"\\'").replace(this.re,fn)+(Ext.isGecko?"';};":"'].join('');};")),me},insertFirst:function(e,t,i){return this.doInsert("afterBegin",e,t,i)},insertBefore:function(e,t,i){return this.doInsert("beforeBegin",e,t,i)},insertAfter:function(e,t,i){return this.doInsert("afterEnd",e,t,i)},append:function(e,t,i){return this.doInsert("beforeEnd",e,t,i)},doInsert:function(e,t,i,s){t=Ext.getDom(t);var n=Ext.DomHelper.insertHtml(e,t,this.applyTemplate(i));return s?Ext.get(n,!0):n},overwrite:function(e,t,i){return e=Ext.getDom(e),e.innerHTML=this.applyTemplate(t),i?Ext.get(e.firstChild,!0):e.firstChild}},Ext.Template.prototype.apply=Ext.Template.prototype.applyTemplate,Ext.Template.from=function(e,t){return e=Ext.getDom(e),new Ext.Template(e.value||e.innerHTML,t||"")},Ext.DomQuery=function(){function child(e,t){for(var i=0,s=e.firstChild;s;){if(1==s.nodeType&&++i==t)return s;s=s.nextSibling}return null}function next(e){for(;(e=e.nextSibling)&&1!=e.nodeType;);return e}function prev(e){for(;(e=e.previousSibling)&&1!=e.nodeType;);return e}function children(e){for(var t,i=e.firstChild,s=-1;i;)t=i.nextSibling,3!=i.nodeType||nonSpace.test(i.nodeValue)?i.nodeIndex=++s:e.removeChild(i),i=t;return this}function byClassName(e,t){if(!t)return e;for(var i,s=[],n=-1,r=0;i=e[r];r++)-1!=(" "+i.className+" ").indexOf(t)&&(s[++n]=i);return s}function attrValue(e,t){return e.tagName||"undefined"==typeof e.length||(e=e[0]),e?"for"==t?e.htmlFor:"class"==t||"className"==t?e.className:e.getAttribute(t)||e[t]:null}function getNodes(e,t,i){var s,n=[],r=-1;if(!e)return n;if(i=i||"*","undefined"!=typeof e.getElementsByTagName&&(e=[e]),t){if("/"==t||">"==t)for(var a,o,l=i.toUpperCase(),h=0;a=e[h];h++){o=a.childNodes;for(var u,c=0;u=o[c];c++)(u.nodeName==l||u.nodeName==i||"*"==i)&&(n[++r]=u)}else if("+"==t)for(var d,l=i.toUpperCase(),h=0;d=e[h];h++){for(;(d=d.nextSibling)&&1!=d.nodeType;);!d||d.nodeName!=l&&d.nodeName!=i&&"*"!=i||(n[++r]=d)}else if("~"==t)for(var d,l=i.toUpperCase(),h=0;d=e[h];h++)for(;d=d.nextSibling;)(d.nodeName==l||d.nodeName==i||"*"==i)&&(n[++r]=d)}else for(var a,h=0;a=e[h];h++){s=a.getElementsByTagName(i);for(var p,c=0;p=s[c];c++)n[++r]=p}return n}function concat(e,t){if(t.slice)return e.concat(t);for(var i=0,s=t.length;s>i;i++)e[e.length]=t[i];return e}function byTag(e,t){if((e.tagName||e==document)&&(e=[e]),!t)return e;var i=[],s=-1;t=t.toLowerCase();for(var n,r=0;n=e[r];r++)1==n.nodeType&&n.tagName.toLowerCase()==t&&(i[++s]=n);return i}function byId(e,t){if((e.tagName||e==document)&&(e=[e]),!t)return e;for(var i,s=[],n=-1,r=0;i=e[r];r++)if(i&&i.id==t)return s[++n]=i,s;return s}function byAttribute(e,t,i,s,n){for(var r,a,o,l,h=[],u=-1,c="{"==n,d=Ext.DomQuery.operators[s],p=0;l=e[p];p++)1==l.nodeType&&(o||(a=Ext.DomQuery.isXml(l),o=!0),r=a?l.getAttribute(t):c?Ext.DomQuery.getStyle(l,t):"class"==t||"className"==t?l.className:"for"==t?l.htmlFor:"href"==t?l.getAttribute("href",2):l.getAttribute(t),(d&&d(r,i)||!d&&r)&&(h[++u]=l));return h}function byPseudo(e,t,i){return Ext.DomQuery.pseudos[t](e,i)}function nodupIEXml(e){var t,i=++key;e[0].setAttribute("_nodup",i),t=[e[0]];for(var s=1,n=e.length;n>s;s++){var r=e[s];!r.getAttribute("_nodup")!=i&&(r.setAttribute("_nodup",i),t[t.length]=r)}for(var s=0,n=e.length;n>s;s++)e[s].removeAttribute("_nodup");return t}function nodup(e){if(!e)return[];var t,i,s,n=e.length,r=e,a=-1;if(!n||"undefined"!=typeof e.nodeType||1==n)return e;if(isIE&&"undefined"!=typeof e[0].selectSingleNode)return nodupIEXml(e);var o=++key;for(e[0]._nodup=o,i=1;t=e[i];i++){if(t._nodup==o){r=[];for(var l=0;i>l;l++)r[++a]=e[l];for(l=i+1;s=e[l];l++)s._nodup!=o&&(s._nodup=o,r[++a]=s);return r}t._nodup=o}return r}function quickDiffIEXml(e,t){for(var i=++key,s=[],n=0,r=e.length;r>n;n++)e[n].setAttribute("_qdiff",i);for(var n=0,r=t.length;r>n;n++)t[n].getAttribute("_qdiff")!=i&&(s[s.length]=t[n]);for(var n=0,r=e.length;r>n;n++)e[n].removeAttribute("_qdiff");return s}function quickDiff(e,t){var i=e.length,s=++key,n=[];if(!i)return t;if(isIE&&"undefined"!=typeof e[0].selectSingleNode)return quickDiffIEXml(e,t);for(var r=0;i>r;r++)e[r]._qdiff=s;for(var r=0,a=t.length;a>r;r++)t[r]._qdiff!=s&&(n[n.length]=t[r]);return n}function quickId(e,t,i,s){if(e==i){var n=i.ownerDocument||i;return n.getElementById(s)}return e=getNodes(e,t,"*"),byId(e,s)}var cache={},simpleCache={},valueCache={},nonSpace=/\S/,trimRe=/^\s+|\s+$/g,tplRe=/\{(\d+)\}/g,modeRe=/^(\s?[\/>+~]\s?|\s|$)/,tagTokenRe=/^(#)?([\w\-\*]+)/,nthRe=/(\d*)n\+?(\d*)/,nthRe2=/\D/,isIE=window.ActiveXObject?!0:!1,key=30803;return eval("var batch = 30803;"),{getStyle:function(e,t){return Ext.fly(e).getStyle(t)},compile:function(path,type){type=type||"select";var fn=["var f = function(root){\n var mode; ++batch; var n = root || document;\n"],mode,lastPath,matchers=Ext.DomQuery.matchers,matchersLn=matchers.length,modeMatch,lmode=path.match(modeRe);for(lmode&&lmode[1]&&(fn[fn.length]='mode="'+lmode[1].replace(trimRe,"")+'";',path=path.replace(lmode[1],""));"/"==path.substr(0,1);)path=path.substr(1);for(;path&&lastPath!=path;){lastPath=path;var tokenMatch=path.match(tagTokenRe);for("select"==type?tokenMatch?(fn[fn.length]="#"==tokenMatch[1]?'n = quickId(n, mode, root, "'+tokenMatch[2]+'");':'n = getNodes(n, mode, "'+tokenMatch[2]+'");',path=path.replace(tokenMatch[0],"")):"@"!=path.substr(0,1)&&(fn[fn.length]='n = getNodes(n, mode, "*");'):tokenMatch&&(fn[fn.length]="#"==tokenMatch[1]?'n = byId(n, "'+tokenMatch[2]+'");':'n = byTag(n, "'+tokenMatch[2]+'");',path=path.replace(tokenMatch[0],""));!(modeMatch=path.match(modeRe));){for(var matched=!1,j=0;matchersLn>j;j++){var t=matchers[j],m=path.match(t.re);if(m){fn[fn.length]=t.select.replace(tplRe,function(e,t){return m[t]}),path=path.replace(m[0],""),matched=!0;break}}if(!matched)throw'Error parsing selector, parsing failed at "'+path+'"'}modeMatch[1]&&(fn[fn.length]='mode="'+modeMatch[1].replace(trimRe,"")+'";',path=path.replace(modeMatch[1],""))}return fn[fn.length]="return nodup(n);\n}",eval(fn.join("")),f},jsSelect:function(e,t){t=t||document,"string"==typeof t&&(t=document.getElementById(t));for(var i=e.split(","),s=[],n=0,r=i.length;r>n;n++){var a=i[n].replace(trimRe,"");if(!cache[a]&&(cache[a]=Ext.DomQuery.compile(a),!cache[a]))throw a+" is not a valid selector";var o=cache[a](t);o&&o!=document&&(s=s.concat(o))}return i.length>1?nodup(s):s},isXml:function(e){var t=(e?e.ownerDocument||e:0).documentElement;return t?"HTML"!==t.nodeName:!1},select:document.querySelectorAll?function(e,t,i){if(t=t||document,!Ext.DomQuery.isXml(t))try{var s=t.querySelectorAll(e);return Ext.toArray(s)}catch(n){}return Ext.DomQuery.jsSelect.call(this,e,t,i)}:function(e,t,i){return Ext.DomQuery.jsSelect.call(this,e,t,i)},selectNode:function(e,t){return Ext.DomQuery.select(e,t)[0]},selectValue:function(e,t,i){e=e.replace(trimRe,""),valueCache[e]||(valueCache[e]=Ext.DomQuery.compile(e,"select"));var s,n=valueCache[e](t);return n=n[0]?n[0]:n,"function"==typeof n.normalize&&n.normalize(),s=n&&n.firstChild?n.firstChild.nodeValue:null,null===s||void 0===s||""===s?i:s},selectNumber:function(e,t,i){var s=Ext.DomQuery.selectValue(e,t,i||0);return parseFloat(s)},is:function(e,t){"string"==typeof e&&(e=document.getElementById(e));var i=Ext.isArray(e),s=Ext.DomQuery.filter(i?e:[e],t);return i?s.length==e.length:s.length>0},filter:function(e,t,i){t=t.replace(trimRe,""),simpleCache[t]||(simpleCache[t]=Ext.DomQuery.compile(t,"simple"));var s=simpleCache[t](e);return i?quickDiff(s,e):s},matchers:[{re:/^\.([\w\-]+)/,select:'n = byClassName(n, " {1} ");'},{re:/^\:([\w\-]+)(?:\(((?:[^\s>\/]*|.*?))\))?/,select:'n = byPseudo(n, "{1}", "{2}");'},{re:/^(?:([\[\{])(?:@)?([\w\-]+)\s?(?:(=|.=)\s?(["']?)(.*?)\4)?[\]\}])/,select:'n = byAttribute(n, "{2}", "{5}", "{3}", "{1}");'},{re:/^#([\w\-]+)/,select:'n = byId(n, "{1}");'},{re:/^@([\w\-]+)/,select:'return {firstChild:{nodeValue:attrValue(n, "{1}")}};'}],operators:{"=":function(e,t){return e==t},"!=":function(e,t){return e!=t},"^=":function(e,t){return e&&e.substr(0,t.length)==t},"$=":function(e,t){return e&&e.substr(e.length-t.length)==t},"*=":function(e,t){return e&&-1!==e.indexOf(t)},"%=":function(e,t){return 0==e%t},"|=":function(e,t){return e&&(e==t||e.substr(0,t.length+1)==t+"-")},"~=":function(e,t){return e&&-1!=(" "+e+" ").indexOf(" "+t+" ")}},pseudos:{"first-child":function(e){for(var t,i,s=[],n=-1,r=0;i=t=e[r];r++){for(;(t=t.previousSibling)&&1!=t.nodeType;);t||(s[++n]=i)}return s},"last-child":function(e){for(var t,i,s=[],n=-1,r=0;i=t=e[r];r++){for(;(t=t.nextSibling)&&1!=t.nodeType;);t||(s[++n]=i)}return s},"nth-child":function(e,t){for(var i,s=[],n=-1,r=nthRe.exec("even"==t&&"2n"||"odd"==t&&"2n+1"||!nthRe2.test(t)&&"n+"+t||t),a=(r[1]||1)-0,o=r[2]-0,l=0;i=e[l];l++){var h=i.parentNode;if(batch!=h._batch){for(var u=0,c=h.firstChild;c;c=c.nextSibling)1==c.nodeType&&(c.nodeIndex=++u);h._batch=batch}1==a?(0==o||i.nodeIndex==o)&&(s[++n]=i):0==(i.nodeIndex+o)%a&&(s[++n]=i)}return s},"only-child":function(e){for(var t,i=[],s=-1,n=0;t=e[n];n++)prev(t)||next(t)||(i[++s]=t);return i},empty:function(e){for(var t,i=[],s=-1,n=0;t=e[n];n++){for(var r,a=t.childNodes,o=0,l=!0;r=a[o];)if(++o,1==r.nodeType||3==r.nodeType){l=!1;break}l&&(i[++s]=t)}return i},contains:function(e,t){for(var i,s=[],n=-1,r=0;i=e[r];r++)-1!=(i.textContent||i.innerText||"").indexOf(t)&&(s[++n]=i);return s},nodeValue:function(e,t){for(var i,s=[],n=-1,r=0;i=e[r];r++)i.firstChild&&i.firstChild.nodeValue==t&&(s[++n]=i);return s},checked:function(e){for(var t,i=[],s=-1,n=0;t=e[n];n++)1==t.checked&&(i[++s]=t);return i},not:function(e,t){return Ext.DomQuery.filter(e,t,!0)},any:function(e,t){for(var i,s,n=t.split("|"),r=[],a=-1,o=0;s=e[o];o++)for(var l=0;i=n[l];l++)if(Ext.DomQuery.is(s,i)){r[++a]=s;break}return r},odd:function(e){return this["nth-child"](e,"odd")},even:function(e){return this["nth-child"](e,"even")},nth:function(e,t){return e[t-1]||[]},first:function(e){return e[0]||[]},last:function(e){return e[e.length-1]||[]},has:function(e,t){for(var i,s=Ext.DomQuery.select,n=[],r=-1,a=0;i=e[a];a++)s(t,i).length>0&&(n[++r]=i);return n},next:function(e,t){for(var i,s=Ext.DomQuery.is,n=[],r=-1,a=0;i=e[a];a++){var o=next(i);o&&s(o,t)&&(n[++r]=i)}return n},prev:function(e,t){for(var i,s=Ext.DomQuery.is,n=[],r=-1,a=0;i=e[a];a++){var o=prev(i);o&&s(o,t)&&(n[++r]=i)}return n}}}}(),Ext.query=Ext.DomQuery.select,Ext.util.DelayedTask=function(e,t,i){var s,n=this,r=function(){clearInterval(s),s=null,e.apply(t,i||[])};n.delay=function(a,o,l,h){n.cancel(),e=o||e,t=l||t,i=h||i,s=setInterval(r,a)},n.cancel=function(){s&&(clearInterval(s),s=null)}},function(){function e(){if(Ext.enableGarbageCollector){var e,i,r,a;for(e in n)a=n[e],a.skipGC||(i=a.el,r=i.dom,r&&r.parentNode&&(r.offsetParent||t.getElementById(e))||(Ext.enableListenerCollection&&Ext.EventManager.removeAll(r),delete n[e]));if(Ext.isIE){var o={};for(e in n)o[e]=n[e];n=Ext.elCache=o}}else clearInterval(s.collectorThreadId)}var t=document;Ext.Element=function(e,i){var s,n="string"==typeof e?t.getElementById(e):e;return n?(s=n.id,!i&&s&&Ext.elCache[s]?Ext.elCache[s].el:(this.dom=n,this.id=s||Ext.id(n),void 0)):null};var i=Ext.DomHelper,s=Ext.Element,n=Ext.elCache;s.prototype={set:function(e,t){var s,n,r=this.dom,t=t!==!1&&!!r.setAttribute;for(s in e)e.hasOwnProperty(s)&&(n=e[s],"style"==s?i.applyStyles(r,n):"cls"==s?r.className=n:t?r.setAttribute(s,n):r[s]=n);return this},defaultUnit:"px",is:function(e){return Ext.DomQuery.is(this.dom,e)},focus:function(e,t){var i=this,t=t||i.dom;try{Number(e)?i.focus.defer(e,null,[null,t]):t.focus()}catch(s){}return i},blur:function(){try{this.dom.blur()}catch(e){}return this},getValue:function(e){var t=this.dom.value;return e?parseInt(t,10):t},addListener:function(e,t,i,s){return Ext.EventManager.on(this.dom,e,t,i||this,s),this},removeListener:function(e,t,i){return Ext.EventManager.removeListener(this.dom,e,t,i||this),this},removeAllListeners:function(){return Ext.EventManager.removeAll(this.dom),this},purgeAllListeners:function(){return Ext.EventManager.purgeElement(this,!0),this},addUnits:function(e){return""===e||"auto"==e||void 0===e?e=e||"":isNaN(e)&&o.test(e)||(e+=this.defaultUnit||"px"),e},load:function(e,t,i){return Ext.Ajax.request(Ext.apply({params:t,url:e.url||e,callback:i,el:this.dom,indicatorText:e.indicatorText||""},Ext.isObject(e)?e:{})),this},isBorderBox:function(){return Ext.isBorderBox||Ext.isForcedBorderBox||h[(this.dom.tagName||"").toLowerCase()]},remove:function(){var e=this,t=e.dom;t&&(delete e.dom,Ext.removeNode(t))},hover:function(e,t,i,s){var n=this;return n.on("mouseenter",e,i||n.dom,s),n.on("mouseleave",t,i||n.dom,s),n},contains:function(e){return e?Ext.lib.Dom.isAncestor(this.dom,e.dom?e.dom:e):!1},getAttributeNS:function(e,t){return this.getAttribute(t,e)},getAttribute:function(){var e=document.createElement("table"),t=!1,i="getAttribute"in e,s=/undefined|unknown/;if(i){try{e.getAttribute("ext:qtip")}catch(n){t=!0}return function(e,i){var s,n=this.dom;if(n.getAttributeNS&&(s=n.getAttributeNS(i,e)||null),null==s)if(i)if(t&&"TABLE"==n.tagName.toUpperCase())try{s=n.getAttribute(i+":"+e)}catch(r){s=""}else s=n.getAttribute(i+":"+e);else s=n.getAttribute(e)||n[e];return s||""}}return function(e,t){var i,n,r=this.om;return t?(n=r[t+":"+e],i=s.test(typeof n)?void 0:n):i=r[e],i||""}}(),update:function(e){return this.dom&&(this.dom.innerHTML=e),this}};var r=s.prototype;s.addMethods=function(e){Ext.apply(r,e)},r.on=r.addListener,r.un=r.removeListener,r.autoBoxAdjust=!0;var a,o=/\d+(px|em|%|en|ex|pt|in|cm|mm|pc)$/i;s.get=function(e){var i,r,o;if(!e)return null;if("string"==typeof e)return(r=t.getElementById(e))?(n[e]&&n[e].el?(i=n[e].el,i.dom=r):i=s.addToCache(new s(r)),i):null;if(e.tagName)return(o=e.id)||(o=Ext.id(e)),n[o]&&n[o].el?(i=n[o].el,i.dom=e):i=s.addToCache(new s(e)),i;if(e instanceof s)return e!=a&&(e.dom=!Ext.isIE||void 0!=e.id&&""!=e.id?t.getElementById(e.id)||e.dom:e.dom),e;if(e.isComposite)return e;if(Ext.isArray(e))return s.select(e);if(e==t){if(!a){var l=function(){};l.prototype=s.prototype,a=new l,a.dom=t}return a}return null},s.addToCache=function(e,t){return t=t||e.id,n[t]={el:e,data:{},events:{}},e},s.data=function(e,t,i){if(e=s.get(e),!e)return null;var r=n[e.id].data;return 2==arguments.length?r[t]:r[t]=i},s.collectorThreadId=setInterval(e,3e4);var l=function(){};l.prototype=s.prototype,s.Flyweight=function(e){this.dom=e},s.Flyweight.prototype=new l,s.Flyweight.prototype.isFlyweight=!0,s._flyweights={},s.fly=function(e,t){var i=null;return t=t||"_global",(e=Ext.getDom(e))&&((s._flyweights[t]=s._flyweights[t]||new s.Flyweight).dom=e,i=s._flyweights[t]),i},Ext.get=s.get,Ext.fly=s.fly;var h=Ext.isStrict?{select:1}:{input:1,select:1,textarea:1};(Ext.isIE||Ext.isGecko)&&(h.button=1)}(),Ext.Element.addMethods(function(){var e="parentNode",t="nextSibling",i="previousSibling",s=Ext.DomQuery,n=Ext.get;return{findParent:function(e,t,i){var r,a=this.dom,o=document.body,l=0;if(Ext.isGecko&&"[object XULElement]"==Object.prototype.toString.call(a))return null;for(t=t||50,isNaN(t)&&(r=Ext.getDom(t),t=Number.MAX_VALUE);a&&1==a.nodeType&&t>l&&a!=o&&a!=r;){if(s.is(a,e))return i?n(a):a;l++,a=a.parentNode}return null},findParentNode:function(e,t,i){var s=Ext.fly(this.dom.parentNode,"_internal");return s?s.findParent(e,t,i):null},up:function(e,t){return this.findParentNode(e,t,!0)},select:function(e){return Ext.Element.select(e,this.dom)},query:function(e){return s.select(e,this.dom)},child:function(e,t){var i=s.selectNode(e,this.dom);return t?i:n(i)},down:function(e,t){var i=s.selectNode(" > "+e,this.dom);return t?i:n(i)},parent:function(t,i){return this.matchNode(e,e,t,i)},next:function(e,i){return this.matchNode(t,t,e,i)},prev:function(e,t){return this.matchNode(i,i,e,t)},first:function(e,i){return this.matchNode(t,"firstChild",e,i)},last:function(e,t){return this.matchNode(i,"lastChild",e,t)},matchNode:function(e,t,i,r){for(var a=this.dom[t];a;){if(1==a.nodeType&&(!i||s.is(a,i)))return r?a:n(a);a=a[e]}return null}}}()),Ext.Element.addMethods(function(){var e=Ext.getDom,t=Ext.get,i=Ext.DomHelper;return{appendChild:function(e){return t(e).appendTo(this)},appendTo:function(t){return e(t).appendChild(this.dom),this},insertBefore:function(t){return(t=e(t)).parentNode.insertBefore(this.dom,t),this},insertAfter:function(t){return(t=e(t)).parentNode.insertBefore(this.dom,t.nextSibling),this},insertFirst:function(i,s){return i=i||{},i.nodeType||i.dom||"string"==typeof i?(i=e(i),this.dom.insertBefore(i,this.dom.firstChild),s?i:t(i)):this.createChild(i,this.dom.firstChild,s)},replace:function(e){return e=t(e),this.insertBefore(e),e.remove(),this},replaceWith:function(t){var s=this;return t.nodeType||t.dom||"string"==typeof t?(t=e(t),s.dom.parentNode.insertBefore(t,s.dom)):t=i.insertBefore(s.dom,t),delete Ext.elCache[s.id],Ext.removeNode(s.dom),s.id=Ext.id(s.dom=t),Ext.Element.addToCache(s.isFlyweight?new Ext.Element(s.dom):s),s},createChild:function(e,t,s){return e=e||{tag:"div"},t?i.insertBefore(t,e,s!==!0):i[this.dom.firstChild?"append":"overwrite"](this.dom,e,s!==!0)},wrap:function(e,t){var s=i.insertBefore(this.dom,e||{tag:"div"},!t);return s.dom?s.dom.appendChild(this.dom):s.appendChild(this.dom),s},insertHtml:function(e,t,s){var n=i.insertHtml(e,this.dom,t);return s?Ext.get(n):n}}}()),Ext.Element.addMethods(function(){function e(e,t){return t.charAt(1).toUpperCase()}function t(t){return s[t]||(s[t]="float"==t?i.cssFloat?"cssFloat":"styleFloat":t.replace(n,e))}var i=Ext.supports,s={},n=/(-[a-z])/gi,r=document.defaultView,a=/alpha\(opacity=(.*)\)/i,o=/^\s+|\s+$/g,l=(Ext.Element,/\s+/),h=/\w/g,u="padding",c="margin",d="border",p="-left",f="-right",m="-top",y="-bottom",g="-width",v=Math,x="hidden",E="isClipped",b="overflow",L="overflow-x",S="overflow-y",C="originalClip",w={l:d+p+g,r:d+f+g,t:d+m+g,b:d+y+g},O={l:u+p,r:u+f,t:u+m,b:u+y},T={l:c+p,r:c+f,t:c+m,b:c+y},M=Ext.Element.data;return{adjustWidth:function(e){var t=this,i="number"==typeof e;return i&&t.autoBoxAdjust&&!t.isBorderBox()&&(e-=t.getBorderWidth("lr")+t.getPadding("lr")),i&&0>e?0:e},adjustHeight:function(e){var t=this,i="number"==typeof e;return i&&t.autoBoxAdjust&&!t.isBorderBox()&&(e-=t.getBorderWidth("tb")+t.getPadding("tb")),i&&0>e?0:e},addClass:function(e){var t,i,s,n=this,r=[];if(Ext.isArray(e)){for(t=0,i=e.length;i>t;t++)s=e[t],"string"==typeof s&&-1==(" "+n.dom.className+" ").indexOf(" "+s+" ")&&r.push(s);r.length&&(n.dom.className+=" "+r.join(" "))}else"string"!=typeof e||this.hasClass(e)||(n.dom.className+=" "+e);return n},removeClass:function(e){var t,i,s,n,r,a=this;if(Ext.isArray(e)||(e=[e]),a.dom&&a.dom.className){for(r=a.dom.className.replace(o,"").split(l),t=0,s=e.length;s>t;t++)n=e[t],"string"==typeof n&&(n=n.replace(o,""),i=r.indexOf(n),-1!=i&&r.splice(i,1));a.dom.className=r.join(" ")}return a},radioClass:function(e){var t,i,s,n=this.dom.parentNode.childNodes;for(e=Ext.isArray(e)?e:[e],i=0,s=n.length;s>i;i++)t=n[i],t&&1==t.nodeType&&Ext.fly(t,"_internal").removeClass(e);return this.addClass(e)},toggleClass:function(e){return this.hasClass(e)?this.removeClass(e):this.addClass(e)},hasClass:function(e){return e&&-1!=(" "+this.dom.className+" ").indexOf(" "+e+" ")},replaceClass:function(e,t){return this.removeClass(e).addClass(t)},isStyle:function(e,t){return this.getStyle(e)==t},getStyle:function(){return r&&r.getComputedStyle?function(e){var s,n,a,o,l=this.dom;return l==document?null:(e=t(e),a=(s=l.style[e])?s:(n=r.getComputedStyle(l,""))?n[e]:null,"marginRight"!=e||"0px"==a||i.correctRightMargin||(o=l.style.display,l.style.display="inline-block",a=r.getComputedStyle(l,"").marginRight,l.style.display=o),"backgroundColor"!=e||"rgba(0, 0, 0, 0)"!=a||i.correctTransparentColor||(a="transparent"),a)}:function(e){var i,s,n=this.dom;if(n==document)return null;if("opacity"==e){if(n.style.filter.match&&(i=n.style.filter.match(a))){var r=parseFloat(i[1]);if(!isNaN(r))return r?r/100:0}return 1}return e=t(e),n.style[e]||((s=n.currentStyle)?s[e]:null)}}(),getColor:function(e,t,i){var s,n=this.getStyle(e),r="undefined"!=typeof i?i:"#";return!n||/transparent|inherit/.test(n)?t:(/^r/.test(n)?Ext.each(n.slice(4,n.length-1).split(","),function(e){s=parseInt(e,10),r+=(16>s?"0":"")+s.toString(16)}):(n=n.replace("#",""),r+=3==n.length?n.replace(/^(\w)(\w)(\w)$/,"$1$1$2$2$3$3"):n),r.length>5?r.toLowerCase():t)},setStyle:function(e,i){var s,n;"object"!=typeof e&&(s={},s[e]=i,e=s);for(n in e)i=e[n],"opacity"==n?this.setOpacity(i):this.dom.style[t(n)]=i;return this},setOpacity:function(e,t){var i=this,s=i.dom.style;if(t&&i.anim)i.anim({opacity:{to:e}},i.preanim(arguments,1),null,.35,"easeIn");else if(Ext.isIE){var n=1>e?"alpha(opacity="+100*e+")":"",r=s.filter.replace(a,"").replace(o,"");s.zoom=1,s.filter=r+(r.length>0?" ":"")+n}else s.opacity=e;return i},clearOpacity:function(){var e=this.dom.style;return Ext.isIE?Ext.isEmpty(e.filter)||(e.filter=e.filter.replace(a,"").replace(o,"")):e.opacity=e["-moz-opacity"]=e["-khtml-opacity"]="",this},getHeight:function(e){var t=this,i=t.dom,s=Ext.isIE&&t.isStyle("display","none"),n=v.max(i.offsetHeight,s?0:i.clientHeight)||0;return n=e?n-t.getBorderWidth("tb")-t.getPadding("tb"):n,0>n?0:n},getWidth:function(e){var t=this,i=t.dom,s=Ext.isIE&&t.isStyle("display","none"),n=v.max(i.offsetWidth,s?0:i.clientWidth)||0;return n=e?n-t.getBorderWidth("lr")-t.getPadding("lr"):n,0>n?0:n},setWidth:function(e,t){var i=this;return e=i.adjustWidth(e),t&&i.anim?i.anim({width:{to:e}},i.preanim(arguments,1)):i.dom.style.width=i.addUnits(e),i},setHeight:function(e,t){var i=this;return e=i.adjustHeight(e),t&&i.anim?i.anim({height:{to:e}},i.preanim(arguments,1)):i.dom.style.height=i.addUnits(e),i},getBorderWidth:function(e){return this.addStyles(e,w)},getPadding:function(e){return this.addStyles(e,O)},clip:function(){var e=this,t=e.dom;return M(t,E)||(M(t,E,!0),M(t,C,{o:e.getStyle(b),x:e.getStyle(L),y:e.getStyle(S)}),e.setStyle(b,x),e.setStyle(L,x),e.setStyle(S,x)),e},unclip:function(){var e=this,t=e.dom;if(M(t,E)){M(t,E,!1);var i=M(t,C);i.o&&e.setStyle(b,i.o),i.x&&e.setStyle(L,i.x),i.y&&e.setStyle(S,i.y)}return e},addStyles:function(e,t){var i,s,n,r=0,a=e.match(h),o=a.length;for(n=0;o>n;n++)i=a[n],s=i&&parseInt(this.getStyle(t[i]),10),s&&(r+=v.abs(s));return r},margins:T}}()),function(){var e=Ext.lib.Dom,t="left",i="right",s="top",n="bottom",r="position",a="static",o="relative",l="auto",h="z-index";Ext.Element.addMethods({getX:function(){return e.getX(this.dom)},getY:function(){return e.getY(this.dom)},getXY:function(){return e.getXY(this.dom)},getOffsetsTo:function(e){var t=this.getXY(),i=Ext.fly(e,"_internal").getXY();return[t[0]-i[0],t[1]-i[1]]},setX:function(e,t){return this.setXY([e,this.getY()],this.animTest(arguments,t,1))},setY:function(e,t){return this.setXY([this.getX(),e],this.animTest(arguments,t,1))},setLeft:function(e){return this.setStyle(t,this.addUnits(e)),this},setTop:function(e){return this.setStyle(s,this.addUnits(e)),this},setRight:function(e){return this.setStyle(i,this.addUnits(e)),this},setBottom:function(e){return this.setStyle(n,this.addUnits(e)),this},setXY:function(t,i){var s=this;return i&&s.anim?s.anim({points:{to:t}},s.preanim(arguments,1),"motion"):e.setXY(s.dom,t),s},setLocation:function(e,t,i){return this.setXY([e,t],this.animTest(arguments,i,2))},moveTo:function(e,t,i){return this.setXY([e,t],this.animTest(arguments,i,2))},getLeft:function(e){return e?parseInt(this.getStyle(t),10)||0:this.getX()},getRight:function(e){var t=this;return e?t.getLeft(!0)+t.getWidth()||0:t.getX()+t.getWidth()},getTop:function(e){return e?parseInt(this.getStyle(s),10)||0:this.getY()},getBottom:function(e){var t=this;return e?t.getTop(!0)+t.getHeight()||0:t.getY()+t.getHeight()},position:function(e,t,i,s){var n=this;!e&&n.isStyle(r,a)?n.setStyle(r,o):e&&n.setStyle(r,e),t&&n.setStyle(h,t),(i||s)&&n.setXY([i||!1,s||!1])},clearPositioning:function(e){return e=e||"",this.setStyle({left:e,right:e,top:e,bottom:e,"z-index":"",position:a}),this},getPositioning:function(){var e=this.getStyle(t),a=this.getStyle(s);return{position:this.getStyle(r),left:e,right:e?"":this.getStyle(i),top:a,bottom:a?"":this.getStyle(n),"z-index":this.getStyle(h)}},setPositioning:function(e){var t=this,i=t.dom.style;return t.setStyle(e),e.right==l&&(i.right=""),e.bottom==l&&(i.bottom=""),t},translatePoints:function(e,i){i=isNaN(e[1])?i:e[1],e=isNaN(e[0])?e:e[0];var n=this,a=n.isStyle(r,o),l=n.getXY(),h=parseInt(n.getStyle(t),10),u=parseInt(n.getStyle(s),10);return h=isNaN(h)?a?0:n.dom.offsetLeft:h,u=isNaN(u)?a?0:n.dom.offsetTop:u,{left:e-l[0]+h,top:i-l[1]+u}},animTest:function(e,t,i){return t&&this.preanim?this.preanim(e,i):!1}})}(),Ext.Element.addMethods({isScrollable:function(){var e=this.dom;return e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth},scrollTo:function(e,t){return this.dom["scroll"+(/top/i.test(e)?"Top":"Left")]=t,this},getScroll:function(){var e,t,i,s=this.dom,n=document,r=n.body,a=n.documentElement;return s==n||s==r?(Ext.isIE&&Ext.isStrict?(e=a.scrollLeft,t=a.scrollTop):(e=window.pageXOffset,t=window.pageYOffset),i={left:e||(r?r.scrollLeft:0),top:t||(r?r.scrollTop:0)}):i={left:s.scrollLeft,top:s.scrollTop},i}}),Ext.Element.VISIBILITY=1,Ext.Element.DISPLAY=2,Ext.Element.OFFSETS=3,Ext.Element.ASCLASS=4,Ext.Element.visibilityCls="x-hide-nosize",Ext.Element.addMethods(function(){var e=Ext.Element,t="visibility",i="display",s="hidden",n="offsets",r="asclass",a="none",o="nosize",l="originalDisplay",h="visibilityMode",u="isVisible",c=e.data,d=function(e){var t=c(e,l);return void 0===t&&c(e,l,t=""),t},p=function(e){var t=c(e,h);return void 0===t&&c(e,h,t=1),t};return{originalDisplay:"",visibilityMode:1,setVisibilityMode:function(e){return c(this.dom,h,e),this},animate:function(e,t,i,s,n){return this.anim(e,{duration:t,callback:i,easing:s},n),this},anim:function(e,t,i,s,n,r){i=i||"run",t=t||{};var a=this,o=Ext.lib.Anim[i](a.dom,e,t.duration||s||.35,t.easing||n||"easeOut",function(){r&&r.call(a),t.callback&&t.callback.call(t.scope||a,a,t)},a);return t.anim=o,o},preanim:function(e,t){return e[t]?"object"==typeof e[t]?e[t]:{duration:e[t+1],callback:e[t+2],easing:e[t+3]}:!1},isVisible:function(){var n=this,r=n.dom,o=c(r,u);return"boolean"==typeof o?o:(o=!(n.isStyle(t,s)||n.isStyle(i,a)||p(r)==e.ASCLASS&&n.hasClass(n.visibilityCls||e.visibilityCls)),c(r,u,o),o)},setVisible:function(a,l){var h=this,d=h.dom,f=p(d);if("string"==typeof l){switch(l){case i:f=e.DISPLAY;break;case t:f=e.VISIBILITY;break;case n:f=e.OFFSETS;break;case o:case r:f=e.ASCLASS}h.setVisibilityMode(f),l=!1}if(l&&h.anim)a&&(h.setOpacity(.01),h.setVisible(!0)),h.anim({opacity:{to:a?1:0}},h.preanim(arguments,1),null,.35,"easeIn",function(){a||h.setVisible(!1).setOpacity(1)});else if(f==e.ASCLASS)h[a?"removeClass":"addClass"](h.visibilityCls||e.visibilityCls);else{if(f==e.DISPLAY)return h.setDisplayed(a);f==e.OFFSETS?a?(h.applyStyles(h.hideModeStyles||{position:"",top:"",left:""}),delete h.hideModeStyles):(h.hideModeStyles={position:h.getStyle("position"),top:h.getStyle("top"),left:h.getStyle("left")},h.applyStyles({position:"absolute",top:"-10000px",left:"-10000px"})):(h.fixDisplay(),d.style.visibility=a?"visible":s)}return c(d,u,a),h},hasMetrics:function(){var t=this.dom;return this.isVisible()||p(t)==e.VISIBILITY},toggle:function(){var e=this;return e.setVisible(!e.isVisible(),e.preanim(arguments,0)),e},setDisplayed:function(e){return"boolean"==typeof e&&(e=e?d(this.dom):a),this.setStyle(i,e),this},fixDisplay:function(){var e=this;e.isStyle(i,a)&&(e.setStyle(t,s),e.setStyle(i,d(this.dom)),e.isStyle(i,a)&&e.setStyle(i,"block"))},hide:function(e){return"string"==typeof e?(this.setVisible(!1,e),this):(this.setVisible(!1,this.preanim(arguments,0)),this)},show:function(e){return"string"==typeof e?(this.setVisible(!0,e),this):(this.setVisible(!0,this.preanim(arguments,0)),this)}}}()),function(){var e=null,t=void 0,i=!0,s=!1,n="setX",r="setY",a="setXY",o="left",l="bottom",h="top",u="right",c="height",d="width",p="points",f="hidden",m="absolute",y="visible",g="motion",v="position",x="easeOut",E=new Ext.Element.Flyweight,b={},L=function(e){return e||{}},S=function(e){return E.dom=e,E.id=Ext.id(e),E},C=function(e){return b[e]||(b[e]=[]),b[e]},w=function(e,t){b[e]=t};Ext.enableFx=i,Ext.Fx={switchStatements:function(e,t,i){return t.apply(this,i[e])},slideIn:function(t,i){i=L(i);var s,c,d,p,v,E,b,C,w,O=this,T=O.dom,v=T.style;return t=t||"t",O.queueFx(i,function(){function L(){S(T).fxUnwrap(p,c.pos,i),v.width=c.width,v.height=c.height,S(T).afterFx(i)}function O(e,t,i,s,n,r,a,o,l,h,u){var c={};return S(e).setWidth(i).setHeight(s),S(e)[n]&&S(e)[n](r),t[a]=t[o]="0",l&&(c.width=l),h&&(c.height=h),u&&(c.points=u),c}s=S(T).getXY(),S(T).fixDisplay(),c=S(T).getFxRestore(),d={x:s[0],y:s[1],0:s[0],1:s[1],width:T.offsetWidth,height:T.offsetHeight},d.right=d.x+d.width,d.bottom=d.y+d.height,S(T).setWidth(d.width).setHeight(d.height),p=S(T).fxWrap(c.pos,i,f),v.visibility=y,v.position=m,b={to:[d.x,d.y]},C={to:d.width},w={to:d.height},E=S(T).switchStatements(t.toLowerCase(),O,{t:[p,v,d.width,0,e,e,o,l,e,w,e],l:[p,v,0,d.height,e,e,u,h,C,e,e],r:[p,v,d.width,d.height,n,d.right,o,h,e,e,b],b:[p,v,d.width,d.height,r,d.bottom,o,h,e,w,b],tl:[p,v,0,0,e,e,u,l,C,w,b],bl:[p,v,0,0,r,d.y+d.height,u,h,C,w,b],br:[p,v,0,0,a,[d.right,d.bottom],o,h,C,w,b],tr:[p,v,0,0,n,d.x+d.width,o,l,C,w,b]}),v.visibility=y,S(p).show(),arguments.callee.anim=S(p).fxanim(E,i,g,.5,x,L)}),O},slideOut:function(e,t){t=L(t);var i,n,r,a,f=this,v=f.dom,E=v.style,b=f.getXY(),C={to:0};return e=e||"t",f.queueFx(t,function(){function f(){t.useDisplay?S(v).setDisplayed(s):S(v).hide(),S(v).fxUnwrap(i,n.pos,t),E.width=n.width,E.height=n.height,S(v).afterFx(t)}function L(e,t,i,s,n,r,a,o,l){var h={};return e[t]=e[i]="0",h[s]=n,r&&(h[r]=a),o&&(h[o]=l),h}n=S(v).getFxRestore(),r={x:b[0],y:b[1],0:b[0],1:b[1],width:v.offsetWidth,height:v.offsetHeight},r.right=r.x+r.width,r.bottom=r.y+r.height,S(v).setWidth(r.width).setHeight(r.height),i=S(v).fxWrap(n.pos,t,y),E.visibility=y,E.position=m,S(i).setWidth(r.width).setHeight(r.height),a=S(v).switchStatements(e.toLowerCase(),L,{t:[E,o,l,c,C],l:[E,u,h,d,C],r:[E,o,h,d,C,p,{to:[r.right,r.y]}],b:[E,o,h,c,C,p,{to:[r.x,r.bottom]}],tl:[E,u,l,d,C,c,C],bl:[E,u,h,d,C,c,C,p,{to:[r.x,r.bottom]}],br:[E,o,h,d,C,c,C,p,{to:[r.x+r.width,r.bottom]}],tr:[E,o,l,d,C,c,C,p,{to:[r.right,r.y]}]}),arguments.callee.anim=S(i).fxanim(a,t,g,.5,x,f)}),f},puff:function(e){e=L(e);var t,i,n,r=this,a=r.dom,o=a.style;return r.queueFx(e,function(){function r(){e.useDisplay?S(a).setDisplayed(s):S(a).hide(),S(a).clearOpacity(),S(a).setPositioning(n.pos),o.width=n.width,o.height=n.height,o.fontSize="",S(a).afterFx(e)}t=S(a).getWidth(),i=S(a).getHeight(),S(a).clearOpacity(),S(a).show(),n=S(a).getFxRestore(),arguments.callee.anim=S(a).fxanim({width:{to:S(a).adjustWidth(2*t)},height:{to:S(a).adjustHeight(2*i)},points:{by:[.5*-t,.5*-i]},opacity:{to:0},fontSize:{to:200,unit:"%"}},e,g,.5,x,r)}),r},switchOff:function(t){t=L(t);var i,n=this,r=n.dom,a=r.style;return n.queueFx(t,function(){function n(){t.useDisplay?S(r).setDisplayed(s):S(r).hide(),S(r).clearOpacity(),S(r).setPositioning(i.pos),a.width=i.width,a.height=i.height,S(r).afterFx(t)}S(r).clearOpacity(),S(r).clip(),i=S(r).getFxRestore(),S(r).fxanim({opacity:{to:.3}},e,e,.1,e,function(){S(r).clearOpacity(),function(){S(r).fxanim({height:{to:1},points:{by:[0,.5*S(r).getHeight()]}},t,g,.3,"easeIn",n)}.defer(100)})}),n},highlight:function(e,t){t=L(t);var i,s=this,n=s.dom,r=t.attr||"backgroundColor",a={};return s.queueFx(t,function(){function s(){n.style[r]=i,S(n).afterFx(t)}S(n).clearOpacity(),S(n).show(),i=n.style[r],a[r]={from:e||"ffff9c",to:t.endColor||S(n).getColor(r)||"ffffff"},arguments.callee.anim=S(n).fxanim(a,t,"color",1,"easeIn",s)}),s},frame:function(e,t,i){i=L(i);var s,n,r=this,a=r.dom;return r.queueFx(i,function(){function r(){var e=Ext.isBorderBox?2:1;n=s.anim({top:{from:l.y,to:l.y-20},left:{from:l.x,to:l.x-20},borderWidth:{from:0,to:10},opacity:{from:1,to:0},height:{from:l.height,to:l.height+20*e},width:{from:l.width,to:l.width+20*e}},{duration:i.duration||1,callback:function(){s.remove(),--t>0?h():S(a).afterFx(i)
}}),arguments.callee.anim={isAnimated:!0,stop:function(){n.stop()}}}e=e||"#C3DAF9",6==e.length&&(e="#"+e),t=t||1,S(a).show();var o=S(a).getXY(),l={x:o[0],y:o[1],0:o[0],1:o[1],width:a.offsetWidth,height:a.offsetHeight},h=function(){return s=S(document.body||document.documentElement).createChild({style:{position:m,"z-index":35e3,border:"0px solid "+e}}),s.queueFx({},r)};arguments.callee.anim={isAnimated:!0,stop:function(){t=0,s.stopFx()}},h()}),r},pause:function(e){var t,i=this.dom;return this.queueFx({},function(){t=setTimeout(function(){S(i).afterFx({})},1e3*e),arguments.callee.anim={isAnimated:!0,stop:function(){clearTimeout(t),S(i).afterFx({})}}}),this},fadeIn:function(t){t=L(t);var i=this,s=i.dom,n=t.endOpacity||1;return i.queueFx(t,function(){S(s).setOpacity(0),S(s).fixDisplay(),s.style.visibility=y,arguments.callee.anim=S(s).fxanim({opacity:{to:n}},t,e,.5,x,function(){1==n&&S(s).clearOpacity(),S(s).afterFx(t)})}),i},fadeOut:function(t){t=L(t);var i=this,s=i.dom,n=s.style,r=t.endOpacity||0;return i.queueFx(t,function(){arguments.callee.anim=S(s).fxanim({opacity:{to:r}},t,e,.5,x,function(){0==r&&(Ext.Element.data(s,"visibilityMode")==Ext.Element.DISPLAY||t.useDisplay?n.display="none":n.visibility=f,S(s).clearOpacity()),S(s).afterFx(t)})}),i},scale:function(e,t,i){return this.shift(Ext.apply({},i,{width:e,height:t})),this},shift:function(e){e=L(e);var i=this.dom,s={};return this.queueFx(e,function(){for(var n in e)e[n]!=t&&(s[n]={to:e[n]});s.width?s.width.to=S(i).adjustWidth(e.width):s,s.height?s.height.to=S(i).adjustWidth(e.height):s,(s.x||s.y||s.xy)&&(s.points=s.xy||{to:[s.x?s.x.to:S(i).getX(),s.y?s.y.to:S(i).getY()]}),arguments.callee.anim=S(i).fxanim(s,e,g,.35,x,function(){S(i).afterFx(e)})}),this},ghost:function(e,t){t=L(t);var i,n,r,a=this,o=a.dom,l=o.style,h={opacity:{to:0},points:{}},u=h.points;return e=e||"b",a.queueFx(t,function(){function a(){t.useDisplay?S(o).setDisplayed(s):S(o).hide(),S(o).clearOpacity(),S(o).setPositioning(i.pos),l.width=i.width,l.height=i.height,S(o).afterFx(t)}i=S(o).getFxRestore(),n=S(o).getWidth(),r=S(o).getHeight(),u.by=S(o).switchStatements(e.toLowerCase(),function(e,t){return[e,t]},{t:[0,-r],l:[-n,0],r:[n,0],b:[0,r],tl:[-n,-r],bl:[-n,r],br:[n,r],tr:[n,-r]}),arguments.callee.anim=S(o).fxanim(h,t,g,.5,x,a)}),a},syncFx:function(){var e=this;return e.fxDefaults=Ext.apply(e.fxDefaults||{},{block:s,concurrent:i,stopFx:s}),e},sequenceFx:function(){var e=this;return e.fxDefaults=Ext.apply(e.fxDefaults||{},{block:s,concurrent:s,stopFx:s}),e},nextFx:function(){var e=C(this.dom.id)[0];e&&e.call(this)},hasActiveFx:function(){return C(this.dom.id)[0]},stopFx:function(e){var t=this,s=t.dom.id;if(t.hasActiveFx()){var n=C(s)[0];n&&n.anim&&(n.anim.isAnimated?(w(s,[n]),n.anim.stop(void 0!==e?e:i)):w(s,[]))}return t},beforeFx:function(e){return this.hasActiveFx()&&!e.concurrent?e.stopFx?(this.stopFx(),i):s:i},hasFxBlock:function(){var e=C(this.dom.id);return e&&e[0]&&e[0].block},queueFx:function(e,t){var i=S(this.dom);if(!i.hasFxBlock())if(Ext.applyIf(e,i.fxDefaults),e.concurrent)t.call(i);else{var s=i.beforeFx(e);t.block=e.block,C(i.dom.id).push(t),s&&i.nextFx()}return i},fxWrap:function(e,t,i){var s,n,r=this.dom;if(!t.wrap||!(s=Ext.getDom(t.wrap))){t.fixPosition&&(n=S(r).getXY());var a=document.createElement("div");a.style.visibility=i,s=r.parentNode.insertBefore(a,r),S(s).setPositioning(e),S(s).isStyle(v,"static")&&S(s).position("relative"),S(r).clearPositioning("auto"),S(s).clip(),s.appendChild(r),n&&S(s).setXY(n)}return s},fxUnwrap:function(e,t,i){var s=this.dom;if(S(s).clearPositioning(),S(s).setPositioning(t),!i.wrap){var n=S(e).dom.parentNode;n.insertBefore(s,e),S(e).remove()}},getFxRestore:function(){var e=this.dom.style;return{pos:this.getPositioning(),width:e.width,height:e.height}},afterFx:function(e){var t=this.dom,s=t.id;e.afterStyle&&S(t).setStyle(e.afterStyle),e.afterCls&&S(t).addClass(e.afterCls),e.remove==i&&S(t).remove(),e.callback&&e.callback.call(e.scope,S(t)),e.concurrent||(C(s).shift(),S(t).nextFx())},fxanim:function(e,t,i,s,n,r){i=i||"run",t=t||{};var a=Ext.lib.Anim[i](this.dom,e,t.duration||s||.35,t.easing||n||x,r,this);return t.anim=a,a}},Ext.Fx.resize=Ext.Fx.scale,Ext.Element.addMethods(Ext.Fx)}(),Ext.CompositeElementLite=function(e,t){this.elements=[],this.add(e,t),this.el=new Ext.Element.Flyweight},Ext.CompositeElementLite.prototype={isComposite:!0,getElement:function(e){var t=this.el;return t.dom=e,t.id=e.id,t},transformElement:function(e){return Ext.getDom(e)},getCount:function(){return this.elements.length},add:function(e,t){var i=this,s=i.elements;if(!e)return this;"string"==typeof e?e=Ext.Element.selectorFunction(e,t):e.isComposite?e=e.elements:Ext.isIterable(e)||(e=[e]);for(var n=0,r=e.length;r>n;++n)s.push(i.transformElement(e[n]));return i},invoke:function(e,t){var i,s,n=this,r=n.elements,a=r.length;for(s=0;a>s;s++)i=r[s],i&&Ext.Element.prototype[e].apply(n.getElement(i),t);return n},item:function(e){var t=this,i=t.elements[e],s=null;return i&&(s=t.getElement(i)),s},addListener:function(e,t,i,s){var n,r,a=this.elements,o=a.length;for(n=0;o>n;n++)r=a[n],r&&Ext.EventManager.on(r,e,t,i||r,s);return this},each:function(e,t){var i,s,n=this,r=n.elements,a=r.length;for(i=0;a>i&&(s=r[i],!s||(s=this.getElement(s),e.call(t||s,s,n,i)!==!1));i++);return n},fill:function(e){var t=this;return t.elements=[],t.add(e),t},filter:function(e){var t=[],i=this,s=Ext.isFunction(e)?e:function(t){return t.is(e)};return i.each(function(e,n,r){s(e,r)!==!1&&(t[t.length]=i.transformElement(e))}),i.elements=t,i},indexOf:function(e){return this.elements.indexOf(this.transformElement(e))},replaceElement:function(e,t,i){var s,n=isNaN(e)?this.indexOf(e):e;return n>-1&&(t=Ext.getDom(t),i&&(s=this.elements[n],s.parentNode.insertBefore(t,s),Ext.removeNode(s)),this.elements.splice(n,1,t)),this},clear:function(){this.elements=[]}},Ext.CompositeElementLite.prototype.on=Ext.CompositeElementLite.prototype.addListener,Ext.CompositeElementLite.importElementMethods=function(){var e,t=Ext.Element.prototype,i=Ext.CompositeElementLite.prototype;for(e in t)"function"==typeof t[e]&&function(e){i[e]=i[e]||function(){return this.invoke(e,arguments)}}.call(i,e)},Ext.CompositeElementLite.importElementMethods(),Ext.DomQuery&&(Ext.Element.selectorFunction=Ext.DomQuery.select),Ext.Element.select=function(e,t){var i;if("string"==typeof e)i=Ext.Element.selectorFunction(e,t);else{if(void 0===e.length)throw"Invalid selector";i=e}return new Ext.CompositeElementLite(i)},Ext.select=Ext.Element.select,function(){var e="beforerequest",t="requestcomplete",i="requestexception",s=void 0,n="load",r="POST",a="GET",o=window;Ext.data.Connection=function(s){Ext.apply(this,s),this.addEvents(e,t,i),Ext.data.Connection.superclass.constructor.call(this)},Ext.extend(Ext.data.Connection,Ext.util.Observable,{timeout:3e4,autoAbort:!1,disableCaching:!0,disableCachingParam:"_dc",request:function(t){var i=this;if(i.fireEvent(e,i,t)){t.el&&(Ext.isEmpty(t.indicatorText)||(i.indicatorText='<div class="loading-indicator">'+t.indicatorText+"</div>"),i.indicatorText&&(Ext.getDom(t.el).innerHTML=i.indicatorText),t.success=(Ext.isFunction(t.success)?t.success:function(){}).createInterceptor(function(e){Ext.getDom(t.el).innerHTML=e.responseText}));var n,l,h,u=t.params,c=t.url||i.url,d={success:i.handleResponse,failure:i.handleFailure,scope:i,argument:{options:t},timeout:Ext.num(t.timeout,i.timeout)};if(Ext.isFunction(u)&&(u=u.call(t.scope||o,t)),u=Ext.urlEncode(i.extraParams,Ext.isObject(u)?Ext.urlEncode(u):u),Ext.isFunction(c)&&(c=c.call(t.scope||o,t)),l=Ext.getDom(t.form)){if(c=c||l.action,t.isUpload||/multipart\/form-data/i.test(l.getAttribute("enctype")))return i.doFormUpload.call(i,t,u,c);h=Ext.lib.Ajax.serializeForm(l),u=u?u+"&"+h:h}if(n=t.method||i.method||(u||t.xmlData||t.jsonData?r:a),n===a&&i.disableCaching&&t.disableCaching!==!1||t.disableCaching===!0){var p=t.disableCachingParam||i.disableCachingParam;c=Ext.urlAppend(c,p+"="+(new Date).getTime())}return t.headers=Ext.applyIf(t.headers||{},i.defaultHeaders||{}),(t.autoAbort===!0||i.autoAbort)&&i.abort(),(n==a||t.xmlData||t.jsonData)&&u&&(c=Ext.urlAppend(c,u),u=""),i.transId=Ext.lib.Ajax.request(n,c,d,u,t)}return t.callback?t.callback.apply(t.scope,[t,s,s]):null},isLoading:function(e){return e?Ext.lib.Ajax.isCallInProgress(e):!!this.transId},abort:function(e){(e||this.isLoading())&&Ext.lib.Ajax.abort(e||this.transId)},handleResponse:function(e){this.transId=!1;var i=e.argument.options;e.argument=i?i.argument:null,this.fireEvent(t,this,e,i),i.success&&i.success.call(i.scope,e,i),i.callback&&i.callback.call(i.scope,i,!0,e)},handleFailure:function(e,t){this.transId=!1;var s=e.argument.options;e.argument=s?s.argument:null,this.fireEvent(i,this,e,s,t),s.failure&&s.failure.call(s.scope,e,s),s.callback&&s.callback.call(s.scope,s,!1,e)},doFormUpload:function(e,i,s){function a(){function i(e,t,i){Ext.isFunction(e)&&e.apply(t,i)}var s,r,l=this,u={responseText:"",responseXML:null,argument:e.argument};try{s=c.contentWindow.document||c.contentDocument||o.frames[h].document,s&&(s.body&&(u.responseText=/textarea/i.test((r=s.body.firstChild||{}).tagName)?r.value:s.body.innerHTML),u.responseXML=s.XMLDocument||s)}catch(d){}Ext.EventManager.removeListener(c,n,a,l),l.fireEvent(t,l,u,e),i(e.success,e.scope,[u,e]),i(e.callback,e.scope,[e,!0,u]),l.debugUploads||setTimeout(function(){Ext.removeNode(c)},100)}var l,h=Ext.id(),u=document,c=u.createElement("iframe"),d=Ext.getDom(e.form),p=[],f="multipart/form-data",m={target:d.target,method:d.method,encoding:d.encoding,enctype:d.enctype,action:d.action};Ext.fly(c).set({id:h,name:h,cls:"x-hidden",src:Ext.SSL_SECURE_URL}),u.body.appendChild(c),Ext.isIE&&(document.frames[h].name=h),Ext.fly(d).set({target:h,method:r,enctype:f,encoding:f,action:s||m.action}),Ext.iterate(Ext.urlDecode(i,!1),function(e,t){l=u.createElement("input"),Ext.fly(l).set({type:"hidden",value:t,name:e}),d.appendChild(l),p.push(l)}),Ext.EventManager.on(c,n,a,this),d.submit(),Ext.fly(d).set(m),Ext.each(p,function(e){Ext.removeNode(e)})}})}(),Ext.Ajax=new Ext.data.Connection({autoAbort:!1,serializeForm:function(e){return Ext.lib.Ajax.serializeForm(e)}}),Ext.util.JSON=new function(){var useHasOwn=!!{}.hasOwnProperty,isNative=function(){var e=null;return function(){return null===e&&(e=Ext.USE_NATIVE_JSON&&window.JSON&&"[object JSON]"==JSON.toString()),e}}(),pad=function(e){return 10>e?"0"+e:e},doDecode=function(json){return json?eval("("+json+")"):""},doEncode=function(e){if(Ext.isDefined(e)&&null!==e){if(Ext.isArray(e))return encodeArray(e);if(Ext.isDate(e))return Ext.util.JSON.encodeDate(e);if(Ext.isString(e))return encodeString(e);if("number"==typeof e)return isFinite(e)?String(e):"null";if(Ext.isBoolean(e))return String(e);var t,i,s,n=["{"];for(i in e)if(!e.getElementsByTagName&&(!useHasOwn||e.hasOwnProperty(i)))switch(s=e[i],typeof s){case"undefined":case"function":case"unknown":break;default:t&&n.push(","),n.push(doEncode(i),":",null===s?"null":doEncode(s)),t=!0}return n.push("}"),n.join("")}return"null"},m={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},encodeString=function(e){return/["\\\x00-\x1f]/.test(e)?'"'+e.replace(/([\x00-\x1f\\"])/g,function(e,t){var i=m[t];return i?i:(i=t.charCodeAt(),"\\u00"+Math.floor(i/16).toString(16)+(i%16).toString(16))})+'"':'"'+e+'"'},encodeArray=function(e){var t,i,s,n=["["],r=e.length;for(i=0;r>i;i+=1)switch(s=e[i],typeof s){case"undefined":case"function":case"unknown":break;default:t&&n.push(","),n.push(null===s?"null":Ext.util.JSON.encode(s)),t=!0}return n.push("]"),n.join("")};this.encodeDate=function(e){return'"'+e.getFullYear()+"-"+pad(e.getMonth()+1)+"-"+pad(e.getDate())+"T"+pad(e.getHours())+":"+pad(e.getMinutes())+":"+pad(e.getSeconds())+'"'},this.encode=function(){var e;return function(t){return e||(e=isNative()?JSON.stringify:doEncode),e(t)}}(),this.decode=function(){var e;return function(t){return e||(e=isNative()?JSON.parse:doDecode),e(t)}}()},Ext.encode=Ext.util.JSON.encode,Ext.decode=Ext.util.JSON.decode,Ext.EventManager=function(){function e(e){var t,i=!1,s=0,n=C.length,r=!1;if(e){if(e.getElementById||e.navigator){for(;n>s;++s)if(t=C[s],t.el===e){i=t.id;break}i||(i=Ext.id(e),C.push({id:i,el:e}),r=!0)}else i=Ext.id(e);Ext.elCache[i]||(Ext.Element.addToCache(new Ext.Element(e),i),r&&(Ext.elCache[i].skipGC=!0))}return i}function t(t,i,s,n,r,a){t=Ext.getDom(t);var o,l=e(t),h=Ext.elCache[l].events;if(o=v.on(t,i,r),h[i]=h[i]||[],h[i].push([s,r,a,o,n]),t.addEventListener&&"mousewheel"==i){var u=["DOMMouseScroll",r,!1];t.addEventListener.apply(t,u),Ext.EventManager.addListener(E,"unload",function(){t.removeEventListener.apply(t,u)})}t==x&&"mousedown"==i&&Ext.EventManager.stoppedMouseDownEvent.addListener(r)}function i(){if(window!=top)return!1;try{x.documentElement.doScroll("left")}catch(e){return!1}return a(),!0}function s(){return Ext.isIE&&i()?!0:x.readyState==L?(a(),!0):(y||(f=setTimeout(arguments.callee,2)),!1)}function n(){return m||(m=Ext.query("style, link[rel=stylesheet]")),m.length==x.styleSheets.length?(a(),!0):(y||(f=setTimeout(arguments.callee,2)),!1)}function r(){x.removeEventListener(b,arguments.callee,!1),n()}function a(){y||(y=!0,f&&clearTimeout(f),g&&x.removeEventListener(b,a,!1),Ext.isIE&&s.bindIE&&x.detachEvent("onreadystatechange",s),v.un(E,"load",arguments.callee)),p&&!Ext.isReady&&(Ext.isReady=!0,p.fire(),p.listeners=[])}function o(){p||(p=new Ext.util.Event),g&&x.addEventListener(b,a,!1),Ext.isIE?s()||(s.bindIE=!0,x.attachEvent("onreadystatechange",s)):Ext.isOpera?x.readyState==L&&n()||x.addEventListener(b,r,!1):Ext.isWebKit&&s(),v.on(E,"load",a)}function l(e,t){return function(){var i=Ext.toArray(arguments);t.target==Ext.EventObject.setEvent(i[0]).target&&e.apply(this,i)}}function h(e,t,i){return function(s){i.delay(t.buffer,e,null,[new Ext.EventObjectImpl(s)])}}function u(e,t,i,s,n){return function(r){Ext.EventManager.removeListener(t,i,s,n),e(r)}}function c(e,t,i){return function(s){var n=new Ext.util.DelayedTask(e);i.tasks||(i.tasks=[]),i.tasks.push(n),n.delay(t.delay||10,e,null,[new Ext.EventObjectImpl(s)])}}function d(e,i,s,n,r){function a(e){if(Ext){e=Ext.EventObject.setEvent(e);var t;if(d.delegate){if(!(t=e.getTarget(d.delegate,p)))return}else t=e.target;d.stopEvent&&e.stopEvent(),d.preventDefault&&e.preventDefault(),d.stopPropagation&&e.stopPropagation(),d.normalized===!1&&(e=e.browserEvent),n.call(r||p,e,t,d)}}var o,d=s&&"boolean"!=typeof s?s:{},p=Ext.getDom(e);if(n=n||d.fn,r=r||d.scope,!p)throw'Error listening for "'+i+'". Element "'+e+"\" doesn't exist.";return d.target&&(a=l(a,d)),d.delay&&(a=c(a,d,n)),d.single&&(a=u(a,p,i,n,r)),d.buffer&&(o=new Ext.util.DelayedTask(a),a=h(a,d,o)),t(p,i,n,o,a,r),a}var p,f,m,y=!1,g=Ext.isGecko||Ext.isWebKit||Ext.isSafari,v=Ext.lib.Event,x=(Ext.lib.Dom,document),E=window,b="DOMContentLoaded",L="complete",S=/^(?:scope|delay|buffer|single|stopEvent|preventDefault|stopPropagation|normalized|args|delegate)$/,C=[],w={addListener:function(e,t,i,s,n){if("object"==typeof t){var r,a,o=t;for(r in o)a=o[r],S.test(r)||(Ext.isFunction(a)?d(e,r,o,a,o.scope):d(e,r,a))}else d(e,t,n,i,s)},removeListener:function(t,i,s,n){t=Ext.getDom(t);var r,a,o,l,h,u=e(t),c=t&&Ext.elCache[u].events[i]||[];for(a=0,l=c.length;l>a;a++)if(Ext.isArray(h=c[a])&&h[0]==s&&(!n||h[2]==n)){if(h[4]&&h[4].cancel(),o=s.tasks&&s.tasks.length){for(;o--;)s.tasks[o].cancel();delete s.tasks}r=h[1],v.un(t,i,v.extAdapter?h[3]:r),r&&t.addEventListener&&"mousewheel"==i&&t.removeEventListener("DOMMouseScroll",r,!1),r&&t==x&&"mousedown"==i&&Ext.EventManager.stoppedMouseDownEvent.removeListener(r),c.splice(a,1),0===c.length&&delete Ext.elCache[u].events[i];for(o in Ext.elCache[u].events)return!1;return Ext.elCache[u].events={},!1}},removeAll:function(t){t=Ext.getDom(t);var i,s,n,r,a,o,l,h=e(t),u=Ext.elCache[h]||{},c=u.events||{};for(r in c)if(c.hasOwnProperty(r))for(i=c[r],s=0,n=i.length;n>s;s++){if(a=i[s],a[4]&&a[4].cancel(),a[0].tasks&&(o=a[0].tasks.length)){for(;o--;)a[0].tasks[o].cancel();delete a.tasks}l=a[1],v.un(t,r,v.extAdapter?a[3]:l),t.addEventListener&&l&&"mousewheel"==r&&t.removeEventListener("DOMMouseScroll",l,!1),l&&t==x&&"mousedown"==r&&Ext.EventManager.stoppedMouseDownEvent.removeListener(l)}Ext.elCache[h]&&(Ext.elCache[h].events={})},getListeners:function(t,i){t=Ext.getDom(t);var s=e(t),n=Ext.elCache[s]||{},r=n.events||{};return r&&r[i]?r[i]:null},purgeElement:function(t,i,s){t=Ext.getDom(t);var n,r,a,o=e(t),l=Ext.elCache[o]||{},h=l.events||{};if(s){if(h&&h.hasOwnProperty(s))for(r=h[s],n=0,a=r.length;a>n;n++)Ext.EventManager.removeListener(t,s,r[n][0])}else Ext.EventManager.removeAll(t);if(i&&t&&t.childNodes)for(n=0,a=t.childNodes.length;a>n;n++)Ext.EventManager.purgeElement(t.childNodes[n],i,s)},_unload:function(){var e;for(e in Ext.elCache)Ext.EventManager.removeAll(e);delete Ext.elCache,delete Ext.Element._flyweights;var t,i,s,n=Ext.lib.Ajax;i="object"==typeof n.conn?n.conn:{};for(s in i)t=i[s],t&&n.abort({conn:t,tId:s})},onDocumentReady:function(e,t,i){Ext.isReady?(p||(p=new Ext.util.Event),p.addListener(e,t,i),p.fire(),p.listeners=[]):(p||o(),i=i||{},i.delay=i.delay||1,p.addListener(e,t,i))},fireDocReady:a};return w.on=w.addListener,w.un=w.removeListener,w.stoppedMouseDownEvent=new Ext.util.Event,w}(),Ext.onReady=Ext.EventManager.onDocumentReady,function(){var e=function(){var e=document.body||document.getElementsByTagName("body")[0];if(!e)return!1;var t=[" ",Ext.isIE?"ext-ie "+(Ext.isIE6?"ext-ie6":Ext.isIE7?"ext-ie7":Ext.isIE8?"ext-ie8":"ext-ie9"):Ext.isGecko?"ext-gecko "+(Ext.isGecko2?"ext-gecko2":"ext-gecko3"):Ext.isOpera?"ext-opera":Ext.isWebKit?"ext-webkit":""];if(Ext.isSafari?t.push("ext-safari "+(Ext.isSafari2?"ext-safari2":Ext.isSafari3?"ext-safari3":"ext-safari4")):Ext.isChrome&&t.push("ext-chrome"),Ext.isMac&&t.push("ext-mac"),Ext.isLinux&&t.push("ext-linux"),Ext.isStrict||Ext.isBorderBox){var i=e.parentNode;i&&(Ext.isStrict||(Ext.fly(i,"_internal").addClass("x-quirks"),Ext.isIE&&!Ext.isStrict&&(Ext.isIEQuirks=!0)),Ext.fly(i,"_internal").addClass(Ext.isStrict&&Ext.isIE||!Ext.enableForcedBoxModel&&!Ext.isIE?" ext-strict":" ext-border-box"))}return Ext.enableForcedBoxModel&&!Ext.isIE&&(Ext.isForcedBorderBox=!0,t.push("ext-forced-border-box")),Ext.fly(e,"_internal").addClass(t),!0};e()||Ext.onReady(e)}(),function(){var e=Ext.apply(Ext.supports,{correctRightMargin:!0,correctTransparentColor:!0,cssFloat:!0}),t=function(){var t,i,s=document.createElement("div"),n=document;s.innerHTML='<div style="height:30px;width:50px;"><div style="height:20px;width:20px;"></div></div><div style="float:left;background-color:transparent;">',n.body.appendChild(s),i=s.lastChild,(t=n.defaultView)&&("0px"!=t.getComputedStyle(s.firstChild.firstChild,null).marginRight&&(e.correctRightMargin=!1),"transparent"!=t.getComputedStyle(i,null).backgroundColor&&(e.correctTransparentColor=!1)),e.cssFloat=!!i.style.cssFloat,n.body.removeChild(s)};Ext.isReady?t():Ext.onReady(t)}(),Ext.EventObject=function(){var e=Ext.lib.Event,t=/(dbl)?click/,i={3:13,63234:37,63235:39,63232:38,63233:40,63276:33,63277:34,63272:46,63273:36,63275:35},s=Ext.isIE?{1:0,4:1,2:2}:{0:0,1:1,2:2};return Ext.EventObjectImpl=function(e){e&&this.setEvent(e.browserEvent||e)},Ext.EventObjectImpl.prototype={setEvent:function(i){var n=this;return i==n||i&&i.browserEvent?i:(n.browserEvent=i,i?(n.button=i.button?s[i.button]:i.which?i.which-1:-1,t.test(i.type)&&-1==n.button&&(n.button=0),n.type=i.type,n.shiftKey=i.shiftKey,n.ctrlKey=i.ctrlKey||i.metaKey||!1,n.altKey=i.altKey,n.keyCode=i.keyCode,n.charCode=i.charCode,n.target=e.getTarget(i),n.xy=e.getXY(i)):(n.button=-1,n.shiftKey=!1,n.ctrlKey=!1,n.altKey=!1,n.keyCode=0,n.charCode=0,n.target=null,n.xy=[0,0]),n)},stopEvent:function(){var t=this;t.browserEvent&&("mousedown"==t.browserEvent.type&&Ext.EventManager.stoppedMouseDownEvent.fire(t),e.stopEvent(t.browserEvent))},preventDefault:function(){this.browserEvent&&e.preventDefault(this.browserEvent)},stopPropagation:function(){var t=this;t.browserEvent&&("mousedown"==t.browserEvent.type&&Ext.EventManager.stoppedMouseDownEvent.fire(t),e.stopPropagation(t.browserEvent))},getCharCode:function(){return this.charCode||this.keyCode},getKey:function(){return this.normalizeKey(this.keyCode||this.charCode)},normalizeKey:function(e){return Ext.isSafari?i[e]||e:e},getPageX:function(){return this.xy[0]},getPageY:function(){return this.xy[1]},getXY:function(){return this.xy},getTarget:function(e,t,i){return e?Ext.fly(this.target).findParent(e,t,i):i?Ext.get(this.target):this.target},getRelatedTarget:function(){return this.browserEvent?e.getRelatedTarget(this.browserEvent):null},getWheelDelta:function(){var e=this.browserEvent,t=0;return e.wheelDelta?t=e.wheelDelta/120:e.detail&&(t=-e.detail/3),t},within:function(e,t,i){if(e){var s=this[t?"getRelatedTarget":"getTarget"]();return s&&((i?s==Ext.getDom(e):!1)||Ext.fly(e).contains(s))}return!1}},new Ext.EventObjectImpl}(),Ext.Loader=Ext.apply({},{load:function(e,t,i,s){var i=i||this,n=document.getElementsByTagName("head")[0],r=document.createDocumentFragment(),a=e.length,o=0,l=this,h=function(t){n.appendChild(l.buildScriptTag(e[t],u))},u=function(){o++,a==o&&"function"==typeof t?t.call(i):s===!0&&h(o)};s===!0?h.call(this,0):(Ext.each(e,function(e){r.appendChild(this.buildScriptTag(e,u))},this),n.appendChild(r))},buildScriptTag:function(e,t){var i=document.createElement("script");return i.type="text/javascript",i.src=e,i.readyState?i.onreadystatechange=function(){("loaded"==i.readyState||"complete"==i.readyState)&&(i.onreadystatechange=null,t())}:i.onload=t,i}}),Ext.ns("Ext.grid","Ext.list","Ext.dd","Ext.tree","Ext.form","Ext.menu","Ext.state","Ext.layout.boxOverflow","Ext.app","Ext.ux","Ext.chart","Ext.direct","Ext.slider"),Ext.apply(Ext,function(){var e=Ext,t=null;return{emptyFn:function(){},BLANK_IMAGE_URL:Ext.isIE6||Ext.isIE7||Ext.isAir?"http://www.extjs.com/s.gif":"data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",extendX:function(e,t){return Ext.extend(e,t(e.prototype))},getDoc:function(){return Ext.get(document)},num:function(e,t){return e=Number(Ext.isEmpty(e)||Ext.isArray(e)||"boolean"==typeof e||"string"==typeof e&&0==e.trim().length?0/0:e),isNaN(e)?t:e},value:function(e,t,i){return Ext.isEmpty(e,i)?t:e},escapeRe:function(e){return e.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")},sequence:function(e,t,i,s){e[t]=e[t].createSequence(i,s)},addBehaviors:function(e){if(Ext.isReady){var t,i,s,n={};for(i in e)(t=i.split("@"))[1]&&(s=t[0],n[s]||(n[s]=Ext.select(s)),n[s].on(t[1],e[i]));n=null}else Ext.onReady(function(){Ext.addBehaviors(e)})},getScrollBarWidth:function(e){if(!Ext.isReady)return 0;if(e===!0||null===t){var i=Ext.getBody().createChild('<div class="x-hide-offsets" style="width:100px;height:50px;overflow:hidden;"><div style="height:200px;"></div></div>'),s=i.child("div",!0),n=s.offsetWidth;i.setStyle("overflow",Ext.isWebKit||Ext.isGecko?"auto":"scroll");var r=s.offsetWidth;i.remove(),t=n-r+2}return t},combine:function(){for(var e=arguments,t=e.length,i=[],s=0;t>s;s++){var n=e[s];Ext.isArray(n)?i=i.concat(n):void 0===n.length||n.substr?i.push(n):i=i.concat(Array.prototype.slice.call(n,0))}return i},copyTo:function(e,t,i){return"string"==typeof i&&(i=i.split(/[,;\s]/)),Ext.each(i,function(i){t.hasOwnProperty(i)&&(e[i]=t[i])},this),e},destroy:function(){Ext.each(arguments,function(e){e&&(Ext.isArray(e)?this.destroy.apply(this,e):"function"==typeof e.destroy?e.destroy():e.dom&&e.remove())},this)},destroyMembers:function(e){for(var t=1,i=arguments,s=i.length;s>t;t++)Ext.destroy(e[i[t]]),delete e[i[t]]},clean:function(e){var t=[];return Ext.each(e,function(e){e&&t.push(e)}),t},unique:function(e){var t=[],i={};return Ext.each(e,function(e){i[e]||t.push(e),i[e]=!0}),t},flatten:function(e){function t(e){return Ext.each(e,function(e){Ext.isArray(e)?t(e):i.push(e)}),i}var i=[];return t(e)},min:function(e,t){var i=e[0];return t=t||function(e,t){return t>e?-1:1},Ext.each(e,function(e){i=-1==t(i,e)?i:e}),i},max:function(e,t){var i=e[0];return t=t||function(e,t){return e>t?1:-1},Ext.each(e,function(e){i=1==t(i,e)?i:e}),i},mean:function(e){return e.length>0?Ext.sum(e)/e.length:void 0},sum:function(e){var t=0;return Ext.each(e,function(e){t+=e}),t},partition:function(e,t){var i=[[],[]];return Ext.each(e,function(e,s,n){i[t&&t(e,s,n)||!t&&e?0:1].push(e)}),i},invoke:function(e,t){var i=[],s=Array.prototype.slice.call(arguments,2);return Ext.each(e,function(e){e&&"function"==typeof e[t]?i.push(e[t].apply(e,s)):i.push(void 0)}),i},pluck:function(e,t){var i=[];return Ext.each(e,function(e){i.push(e[t])}),i},zip:function(){for(var e=Ext.partition(arguments,function(e){return"function"!=typeof e}),t=e[0],i=e[1][0],s=Ext.max(Ext.pluck(t,"length")),n=[],r=0;s>r;r++)if(n[r]=[],i)n[r]=i.apply(i,Ext.pluck(t,r));else for(var a=0,o=t.length;o>a;a++)n[r].push(t[a][r]);return n},getCmp:function(e){return Ext.ComponentMgr.get(e)},useShims:e.isIE6||e.isMac&&e.isGecko2,type:function(e){if(void 0===e||null===e)return!1;if(e.htmlElement)return"element";var t=typeof e;if("object"==t&&e.nodeName)switch(e.nodeType){case 1:return"element";case 3:return/\S/.test(e.nodeValue)?"textnode":"whitespace"}if("object"==t||"function"==t){switch(e.constructor){case Array:return"array";case RegExp:return"regexp";case Date:return"date"}if("number"==typeof e.length&&"function"==typeof e.item)return"nodelist"}return t},intercept:function(e,t,i,s){e[t]=e[t].createInterceptor(i,s)},callback:function(e,t,i,s){"function"==typeof e&&(s?e.defer(s,t,i||[]):e.apply(t,i||[]))}}}()),Ext.apply(Function.prototype,{createSequence:function(e,t){var i=this;return"function"!=typeof e?this:function(){var s=i.apply(this||window,arguments);return e.apply(t||this||window,arguments),s}}}),Ext.applyIf(String,{escape:function(e){return e.replace(/('|\\)/g,"\\$1")},leftPad:function(e,t,i){var s=String(e);for(i||(i=" ");s.length<t;)s=i+s;return s}}),String.prototype.toggle=function(e,t){return this==e?t:e},String.prototype.trim=function(){var e=/^\s+|\s+$/g;return function(){return this.replace(e,"")}}(),Date.prototype.getElapsed=function(e){return Math.abs((e||new Date).getTime()-this.getTime())},Ext.applyIf(Number.prototype,{constrain:function(e,t){return Math.min(Math.max(this,e),t)}}),Ext.lib.Dom.getRegion=function(e){return Ext.lib.Region.getRegion(e)},Ext.lib.Region=function(e,t,i,s){var n=this;n.top=e,n[1]=e,n.right=t,n.bottom=i,n.left=s,n[0]=s},Ext.lib.Region.prototype={contains:function(e){var t=this;return e.left>=t.left&&e.right<=t.right&&e.top>=t.top&&e.bottom<=t.bottom},getArea:function(){var e=this;return(e.bottom-e.top)*(e.right-e.left)},intersect:function(e){var t=this,i=Math.max(t.top,e.top),s=Math.min(t.right,e.right),n=Math.min(t.bottom,e.bottom),r=Math.max(t.left,e.left);return n>=i&&s>=r?new Ext.lib.Region(i,s,n,r):void 0},union:function(e){var t=this,i=Math.min(t.top,e.top),s=Math.max(t.right,e.right),n=Math.max(t.bottom,e.bottom),r=Math.min(t.left,e.left);return new Ext.lib.Region(i,s,n,r)},constrainTo:function(e){var t=this;return t.top=t.top.constrain(e.top,e.bottom),t.bottom=t.bottom.constrain(e.top,e.bottom),t.left=t.left.constrain(e.left,e.right),t.right=t.right.constrain(e.left,e.right),t},adjust:function(e,t,i,s){var n=this;return n.top+=e,n.left+=t,n.right+=s,n.bottom+=i,n}},Ext.lib.Region.getRegion=function(e){var t=Ext.lib.Dom.getXY(e),i=t[1],s=t[0]+e.offsetWidth,n=t[1]+e.offsetHeight,r=t[0];return new Ext.lib.Region(i,s,n,r)},Ext.lib.Point=function(e,t){Ext.isArray(e)&&(t=e[1],e=e[0]);var i=this;i.x=i.right=i.left=i[0]=e,i.y=i.top=i.bottom=i[1]=t},Ext.lib.Point.prototype=new Ext.lib.Region,Ext.apply(Ext.DomHelper,function(){function e(e,s,n,r,a,o){e=Ext.getDom(e);var l;return i.useDom?(l=t(s,null),o?e.appendChild(l):("firstChild"==a?e:e.parentNode).insertBefore(l,e[a]||e)):l=Ext.DomHelper.insertHtml(r,e,Ext.DomHelper.createHtml(s)),n?Ext.get(l,!0):l}function t(e,i){var s,n,r,a,l,h=document;if(Ext.isArray(e)){s=h.createDocumentFragment();for(var u=0,c=e.length;c>u;u++)t(e[u],s)}else if("string"==typeof e)s=h.createTextNode(e);else{s=h.createElement(e.tag||"div"),n=!!s.setAttribute;for(var r in e)o.test(r)||(a=e[r],"cls"==r?s.className=a:n?s.setAttribute(r,a):s[r]=a);Ext.DomHelper.applyStyles(s,e.style),(l=e.children||e.cn)?t(l,s):e.html&&(s.innerHTML=e.html)}return i&&i.appendChild(s),s}var i,s="afterbegin",n="afterend",r="beforebegin",a="beforeend",o=/tag|children|cn|html$/i;return i={createTemplate:function(e){var t=Ext.DomHelper.createHtml(e);return new Ext.Template(t)},useDom:!1,insertBefore:function(t,i,s){return e(t,i,s,r)},insertAfter:function(t,i,s){return e(t,i,s,n,"nextSibling")},insertFirst:function(t,i,n){return e(t,i,n,s,"firstChild")},append:function(t,i,s){return e(t,i,s,a,"",!0)},createDom:t}}()),Ext.apply(Ext.Template.prototype,{disableFormats:!1,re:/\{([\w\-]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?\}/g,argsRe:/^\s*['"](.*)["']\s*$/,compileARe:/\\/g,compileBRe:/(\r\n|\n)/g,compileCRe:/'/g,applyTemplate:function(e){function t(t,a,o,l){if(o&&s){if("this."==o.substr(0,5))return r.call(o.substr(5),e[a],e);if(l){var h=i.argsRe;l=l.split(",");for(var u=0,c=l.length;c>u;u++)l[u]=l[u].replace(h,"$1");l=[e[a]].concat(l)}else l=[e[a]];return n[o].apply(n,l)}return void 0!==e[a]?e[a]:""}var i=this,s=i.disableFormats!==!0,n=Ext.util.Format,r=i;return i.compiled?i.compiled(e):i.html.replace(i.re,t)},compile:function(){function fn(e,t,i,s){return i&&useF?(s=s?","+s:"","this."!=i.substr(0,5)?i="fm."+i+"(":(i='this.call("'+i.substr(5)+'", ',s=", values")):(s="",i="(values['"+t+"'] == undefined ? '' : "),"'"+sep+i+"values['"+t+"']"+s+")"+sep+"'"}var me=this,fm=Ext.util.Format,useF=me.disableFormats!==!0,sep=Ext.isGecko?"+":",",body;return Ext.isGecko?body="this.compiled = function(values){ return '"+me.html.replace(me.compileARe,"\\\\").replace(me.compileBRe,"\\n").replace(me.compileCRe,"\\'").replace(me.re,fn)+"';};":(body=["this.compiled = function(values){ return ['"],body.push(me.html.replace(me.compileARe,"\\\\").replace(me.compileBRe,"\\n").replace(me.compileCRe,"\\'").replace(me.re,fn)),body.push("'].join('');};"),body=body.join("")),eval(body),me},call:function(e,t,i){return this[e](t,i)}}),Ext.Template.prototype.apply=Ext.Template.prototype.applyTemplate,Ext.util.Functions={createInterceptor:function(e,t,i){return Ext.isFunction(t)?function(){var s=this,n=arguments;return t.target=s,t.method=e,t.apply(i||s||window,n)!==!1?e.apply(s||window,n):null}:e},createDelegate:function(e,t,i,s){return Ext.isFunction(e)?function(){var n=i||arguments;if(s===!0)n=Array.prototype.slice.call(arguments,0),n=n.concat(i);else if(Ext.isNumber(s)){n=Array.prototype.slice.call(arguments,0);var r=[s,0].concat(i);Array.prototype.splice.apply(n,r)}return e.apply(t||window,n)}:e},defer:function(e,t,i,s,n){return e=Ext.util.Functions.createDelegate(e,i,s,n),t>0?setTimeout(e,t):(e(),0)},createSequence:function(e,t,i){return Ext.isFunction(t)?function(){var s=e.apply(this||window,arguments);return t.apply(i||this||window,arguments),s}:e}},Ext.defer=Ext.util.Functions.defer,Ext.createInterceptor=Ext.util.Functions.createInterceptor,Ext.createSequence=Ext.util.Functions.createSequence,Ext.createDelegate=Ext.util.Functions.createDelegate,Ext.apply(Ext.util.Observable.prototype,function(){function e(e){var t,i,s,n=(this.methodEvents=this.methodEvents||{})[e],r=this;if(!n){this.methodEvents[e]=n={},n.originalFn=this[e],n.methodName=e,n.before=[],n.after=[];var a=function(e,n,a){void 0!==(i=e.apply(n||r,a))&&("object"==typeof i?(t=void 0!==i.returnValue?i.returnValue:i,s=!!i.cancel):i===!1?s=!0:t=i)};this[e]=function(){var e,o=Array.prototype.slice.call(arguments,0);t=i=void 0,s=!1;for(var l=0,h=n.before.length;h>l;l++)if(e=n.before[l],a(e.fn,e.scope,o),s)return t;void 0!==(i=n.originalFn.apply(r,o))&&(t=i);for(var l=0,h=n.after.length;h>l;l++)if(e=n.after[l],a(e.fn,e.scope,o),s)return t;return t}}return n}return{beforeMethod:function(t,i,s){e.call(this,t).before.push({fn:i,scope:s})},afterMethod:function(t,i,s){e.call(this,t).after.push({fn:i,scope:s})},removeMethodListener:function(e,t,i){for(var s=this.getMethodEvent(e),n=0,r=s.before.length;r>n;n++)if(s.before[n].fn==t&&s.before[n].scope==i)return s.before.splice(n,1),void 0;for(var n=0,r=s.after.length;r>n;n++)if(s.after[n].fn==t&&s.after[n].scope==i)return s.after.splice(n,1),void 0},relayEvents:function(e,t){function i(e){return function(){return s.fireEvent.apply(s,[e].concat(Array.prototype.slice.call(arguments,0)))}}for(var s=this,n=0,r=t.length;r>n;n++){var a=t[n];s.events[a]=s.events[a]||!0,e.on(a,i(a),s)}},enableBubble:function(e){var t=this;if(!Ext.isEmpty(e)){e=Ext.isArray(e)?e:Array.prototype.slice.call(arguments,0);for(var i=0,s=e.length;s>i;i++){var n=e[i];n=n.toLowerCase();var r=t.events[n]||!0;"boolean"==typeof r&&(r=new Ext.util.Event(t,n),t.events[n]=r),r.bubble=!0
}}}}}()),Ext.util.Observable.capture=function(e,t,i){e.fireEvent=e.fireEvent.createInterceptor(t,i)},Ext.util.Observable.observeClass=function(e,t){return e?(e.fireEvent||(Ext.apply(e,new Ext.util.Observable),Ext.util.Observable.capture(e.prototype,e.fireEvent,e)),"object"==typeof t&&e.on(t),e):void 0},Ext.apply(Ext.EventManager,function(){var e,t,i,s,n=Ext.lib.Dom,r=Ext.EventManager._unload,a=0,o=0,l=Ext.isWebKit?Ext.num(navigator.userAgent.match(/AppleWebKit\/(\d+)/)[1])>=525:!(Ext.isGecko&&!Ext.isWindows||Ext.isOpera);return{_unload:function(){Ext.EventManager.un(window,"resize",this.fireWindowResize,this),r.call(Ext.EventManager)},doResizeEvent:function(){var t=n.getViewHeight(),i=n.getViewWidth();(o!=t||a!=i)&&e.fire(a=i,o=t)},onWindowResize:function(i,s,n){e||(e=new Ext.util.Event,t=new Ext.util.DelayedTask(this.doResizeEvent),Ext.EventManager.on(window,"resize",this.fireWindowResize,this)),e.addListener(i,s,n)},fireWindowResize:function(){e&&t.delay(100)},onTextResize:function(e,t,n){if(!i){i=new Ext.util.Event;var r=new Ext.Element(document.createElement("div"));r.dom.className="x-text-resize",r.dom.innerHTML="X",r.appendTo(document.body),s=r.dom.offsetHeight,setInterval(function(){r.dom.offsetHeight!=s&&i.fire(s,s=r.dom.offsetHeight)},this.textResizeInterval)}i.addListener(e,t,n)},removeResizeListener:function(t,i){e&&e.removeListener(t,i)},fireResize:function(){e&&e.fire(n.getViewWidth(),n.getViewHeight())},textResizeInterval:50,ieDeferSrc:!1,getKeyEvent:function(){return l?"keydown":"keypress"},useKeydown:l}}()),Ext.EventManager.on=Ext.EventManager.addListener,Ext.apply(Ext.EventObjectImpl.prototype,{BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,RETURN:13,SHIFT:16,CTRL:17,CONTROL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGEUP:33,PAGE_DOWN:34,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,isNavKeyPress:function(){var e=this,t=this.normalizeKey(e.keyCode);return t>=33&&40>=t||t==e.RETURN||t==e.TAB||t==e.ESC},isSpecialKey:function(){var e=this.normalizeKey(this.keyCode);return"keypress"==this.type&&this.ctrlKey||this.isNavKeyPress()||e==this.BACKSPACE||e>=16&&20>=e||e>=44&&46>=e},getPoint:function(){return new Ext.lib.Point(this.xy[0],this.xy[1])},hasModifier:function(){return this.ctrlKey||this.altKey||this.shiftKey}}),Ext.Element.addMethods({swallowEvent:function(e,t){function i(e){e.stopPropagation(),t&&e.preventDefault()}var s=this;return Ext.isArray(e)?(Ext.each(e,function(e){s.on(e,i)}),s):(s.on(e,i),s)},relayEvent:function(e,t){this.on(e,function(i){t.fireEvent(e,i)})},clean:function(e){var t=this,i=t.dom,s=i.firstChild,n=-1;if(Ext.Element.data(i,"isCleaned")&&e!==!0)return t;for(;s;){var r=s.nextSibling;3!=s.nodeType||/\S/.test(s.nodeValue)?s.nodeIndex=++n:i.removeChild(s),s=r}return Ext.Element.data(i,"isCleaned",!0),t},load:function(){var e=this.getUpdater();return e.update.apply(e,arguments),this},getUpdater:function(){return this.updateManager||(this.updateManager=new Ext.Updater(this))},update:function(e,t,i){if(!this.dom)return this;if(e=e||"",t!==!0)return this.dom.innerHTML=e,"function"==typeof i&&i(),this;var s=Ext.id(),n=this.dom;return e+='<span id="'+s+'"></span>',Ext.lib.Event.onAvailable(s,function(){for(var t,n,r,a,o,l,h=document,u=h.getElementsByTagName("head")[0],c=/(?:<script([^>]*)?>)((\n|\r|.)*?)(?:<\/script>)/gi,d=/\ssrc=([\'\"])(.*?)\1/i,p=/\stype=([\'\"])(.*?)\1/i;t=c.exec(e);)n=t[1],r=n?n.match(d):!1,r&&r[2]?(l=h.createElement("script"),l.src=r[2],a=n.match(p),a&&a[2]&&(l.type=a[2]),u.appendChild(l)):t[2]&&t[2].length>0&&(window.execScript?window.execScript(t[2]):window.eval(t[2]));o=h.getElementById(s),o&&Ext.removeNode(o),"function"==typeof i&&i()}),n.innerHTML=e.replace(/(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)/gi,""),this},removeAllListeners:function(){return this.removeAnchor(),Ext.EventManager.removeAll(this.dom),this},createProxy:function(e,t,i){e="object"==typeof e?e:{tag:"div",cls:e};var s=this,n=t?Ext.DomHelper.append(t,e,!0):Ext.DomHelper.insertBefore(s.dom,e,!0);return i&&s.setBox&&s.getBox&&n.setBox(s.getBox()),n}}),Ext.Element.prototype.getUpdateManager=Ext.Element.prototype.getUpdater,Ext.Element.addMethods({getAnchorXY:function(e,t,i){e=(e||"tl").toLowerCase(),i=i||{};var s,n=this,r=n.dom==document.body||n.dom==document,a=i.width||r?Ext.lib.Dom.getViewWidth():n.getWidth(),o=i.height||r?Ext.lib.Dom.getViewHeight():n.getHeight(),l=Math.round,h=n.getXY(),u=n.getScroll(),c=r?u.left:t?0:h[0],d=r?u.top:t?0:h[1],p={c:[l(.5*a),l(.5*o)],t:[l(.5*a),0],l:[0,l(.5*o)],r:[a,l(.5*o)],b:[l(.5*a),o],tl:[0,0],bl:[0,o],br:[a,o],tr:[a,0]};return s=p[e],[s[0]+c,s[1]+d]},anchorTo:function(e,t,i,s,n,r){var a=this,o=a.dom,l=!Ext.isEmpty(n),h=function(){Ext.fly(o).alignTo(e,t,i,s),Ext.callback(r,Ext.fly(o))},u=this.getAnchor();return this.removeAnchor(),Ext.apply(u,{fn:h,scroll:l}),Ext.EventManager.onWindowResize(h,null),l&&Ext.EventManager.on(window,"scroll",h,null,{buffer:isNaN(n)?50:n}),h.call(a),a},removeAnchor:function(){var e=this,t=this.getAnchor();return t&&t.fn&&(Ext.EventManager.removeResizeListener(t.fn),t.scroll&&Ext.EventManager.un(window,"scroll",t.fn),delete t.fn),e},getAnchor:function(){var e=Ext.Element.data,t=this.dom;if(t){var i=e(t,"_anchor");return i||(i=e(t,"_anchor",{})),i}},getAlignToXY:function(e,t,i){if(e=Ext.get(e),!e||!e.dom)throw"Element.alignToXY with an element that doesn't exist";i=i||[0,0],t=(t&&"?"!=t?/-/.test(t)||""===t?t||"tl-bl":"tl-"+t:"tl-bl?").toLowerCase();var s,n,r,a,o,l,h,u,c,d,p,f,m,y=this,g=(y.dom,Ext.lib.Dom.getViewWidth()-10),v=Ext.lib.Dom.getViewHeight()-10,x=document,E=x.documentElement,b=x.body,L=(E.scrollLeft||b.scrollLeft||0)+5,S=(E.scrollTop||b.scrollTop||0)+5,C=!1,w="",O="",T=t.match(/^([a-z]+)-([a-z]+)(\?)?$/);if(!T)throw"Element.alignTo with an invalid alignment "+t;return w=T[1],O=T[2],C=!!T[3],s=y.getAnchorXY(w,!0),n=e.getAnchorXY(O,!1),r=n[0]-s[0]+i[0],a=n[1]-s[1]+i[1],C&&(o=y.getWidth(),l=y.getHeight(),h=e.getRegion(),u=w.charAt(0),c=w.charAt(w.length-1),d=O.charAt(0),p=O.charAt(O.length-1),f="t"==u&&"b"==d||"b"==u&&"t"==d,m="r"==c&&"l"==p||"l"==c&&"r"==p,r+o>g+L&&(r=m?h.left-o:g+L-o),L>r&&(r=m?h.right:L),a+l>v+S&&(a=f?h.top-l:v+S-l),S>a&&(a=f?h.bottom:S)),[r,a]},alignTo:function(e,t,i,s){var n=this;return n.setXY(n.getAlignToXY(e,t,i),n.preanim&&s?n.preanim(arguments,3):!1)},adjustForConstraints:function(e,t,i){return this.getConstrainToXY(t||document,!1,i,e)||e},getConstrainToXY:function(){var e={top:0,left:0,bottom:0,right:0};return function(t,i,s,n){t=Ext.get(t),s=s?Ext.applyIf(s,e):e;var r,a,o=0,l=0;if(t.dom==document.body||t.dom==document)r=Ext.lib.Dom.getViewWidth(),a=Ext.lib.Dom.getViewHeight();else if(r=t.dom.clientWidth,a=t.dom.clientHeight,!i){var h=t.getXY();o=h[0],l=h[1]}var u=t.getScroll();o+=s.left+u.left,l+=s.top+u.top,r-=s.right,a-=s.bottom;var c=o+r,d=l+a,p=n||(i?[this.getLeft(!0),this.getTop(!0)]:this.getXY()),f=p[0],m=p[1],y=this.getConstrainOffset(),g=this.dom.offsetWidth+y,v=this.dom.offsetHeight+y,x=!1;return f+g>c&&(f=c-g,x=!0),m+v>d&&(m=d-v,x=!0),o>f&&(f=o,x=!0),l>m&&(m=l,x=!0),x?[f,m]:!1}}(),getConstrainOffset:function(){return 0},getCenterXY:function(){return this.getAlignToXY(document,"c-c")},center:function(e){return this.alignTo(e||document,"c-c")}}),Ext.Element.addMethods({select:function(e,t){return Ext.Element.select(e,t,this.dom)}}),Ext.apply(Ext.Element.prototype,function(){var e=Ext.getDom,t=Ext.get,i=Ext.DomHelper;return{insertSibling:function(s,n,r){var a,o,l=this,h="after"==(n||"before").toLowerCase();return Ext.isArray(s)?(o=l,Ext.each(s,function(e){a=Ext.fly(o,"_internal").insertSibling(e,n,r),h&&(o=a)}),a):(s=s||{},s.nodeType||s.dom?(a=l.dom.parentNode.insertBefore(e(s),h?l.dom.nextSibling:l.dom),r||(a=t(a))):a=h&&!l.dom.nextSibling?i.append(l.dom.parentNode,s,!r):i[h?"insertAfter":"insertBefore"](l.dom,s,!r),a)}}}()),Ext.Element.boxMarkup='<div class="{0}-tl"><div class="{0}-tr"><div class="{0}-tc"></div></div></div><div class="{0}-ml"><div class="{0}-mr"><div class="{0}-mc"></div></div></div><div class="{0}-bl"><div class="{0}-br"><div class="{0}-bc"></div></div></div>',Ext.Element.addMethods(function(){var e="_internal";return{applyStyles:function(e){return Ext.DomHelper.applyStyles(this.dom,e),this},getStyles:function(){var e={};return Ext.each(arguments,function(t){e[t]=this.getStyle(t)},this),e},setOverflow:function(e){var t=this.dom;"auto"==e&&Ext.isMac&&Ext.isGecko2?(t.style.overflow="hidden",function(){t.style.overflow="auto"}.defer(1)):t.style.overflow=e},boxWrap:function(e){e=e||"x-box";var t=Ext.get(this.insertHtml("beforeBegin","<div class='"+e+"'>"+String.format(Ext.Element.boxMarkup,e)+"</div>"));return Ext.DomQuery.selectNode("."+e+"-mc",t.dom).appendChild(this.dom),t},setSize:function(e,t,i){var s=this;return"object"==typeof e&&(t=e.height,e=e.width),e=s.adjustWidth(e),t=s.adjustHeight(t),i&&s.anim?s.anim({width:{to:e},height:{to:t}},s.preanim(arguments,2)):(s.dom.style.width=s.addUnits(e),s.dom.style.height=s.addUnits(t)),s},getComputedHeight:function(){var e=this,t=Math.max(e.dom.offsetHeight,e.dom.clientHeight);return t||(t=parseFloat(e.getStyle("height"))||0,e.isBorderBox()||(t+=e.getFrameWidth("tb"))),t},getComputedWidth:function(){var e=Math.max(this.dom.offsetWidth,this.dom.clientWidth);return e||(e=parseFloat(this.getStyle("width"))||0,this.isBorderBox()||(e+=this.getFrameWidth("lr"))),e},getFrameWidth:function(e,t){return t&&this.isBorderBox()?0:this.getPadding(e)+this.getBorderWidth(e)},addClassOnOver:function(t){return this.hover(function(){Ext.fly(this,e).addClass(t)},function(){Ext.fly(this,e).removeClass(t)}),this},addClassOnFocus:function(t){return this.on("focus",function(){Ext.fly(this,e).addClass(t)},this.dom),this.on("blur",function(){Ext.fly(this,e).removeClass(t)},this.dom),this},addClassOnClick:function(t){var i=this.dom;return this.on("mousedown",function(){Ext.fly(i,e).addClass(t);var s=Ext.getDoc(),n=function(){Ext.fly(i,e).removeClass(t),s.removeListener("mouseup",n)};s.on("mouseup",n)}),this},getViewSize:function(){var e=document,t=this.dom,i=t==e||t==e.body;if(i){var s=Ext.lib.Dom;return{width:s.getViewWidth(),height:s.getViewHeight()}}return{width:t.clientWidth,height:t.clientHeight}},getStyleSize:function(){var e,t,i=this,s=document,n=this.dom,r=n==s||n==s.body,a=n.style;if(r){var o=Ext.lib.Dom;return{width:o.getViewWidth(),height:o.getViewHeight()}}return a.width&&"auto"!=a.width&&(e=parseFloat(a.width),i.isBorderBox()&&(e-=i.getFrameWidth("lr"))),a.height&&"auto"!=a.height&&(t=parseFloat(a.height),i.isBorderBox()&&(t-=i.getFrameWidth("tb"))),{width:e||i.getWidth(!0),height:t||i.getHeight(!0)}},getSize:function(e){return{width:this.getWidth(e),height:this.getHeight(e)}},repaint:function(){var e=this.dom;return this.addClass("x-repaint"),setTimeout(function(){Ext.fly(e).removeClass("x-repaint")},1),this},unselectable:function(){return this.dom.unselectable="on",this.swallowEvent("selectstart",!0).applyStyles("-moz-user-select:none;-khtml-user-select:none;").addClass("x-unselectable")},getMargins:function(e){var t,i=this,s={t:"top",l:"left",r:"right",b:"bottom"},n={};if(e)return i.addStyles.call(i,e,i.margins);for(t in i.margins)n[s[t]]=parseFloat(i.getStyle(i.margins[t]))||0;return n}}}()),Ext.Element.addMethods({setBox:function(e,t,i){var s=this,n=e.width,r=e.height;return!t||s.autoBoxAdjust||s.isBorderBox()||(n-=s.getBorderWidth("lr")+s.getPadding("lr"),r-=s.getBorderWidth("tb")+s.getPadding("tb")),s.setBounds(e.x,e.y,n,r,s.animTest.call(s,arguments,i,2)),s},getBox:function(e,t){var i,s,n,r,a,o,l,h=this,u=h.getBorderWidth,c=h.getPadding;t?(s=parseInt(h.getStyle("left"),10)||0,n=parseInt(h.getStyle("top"),10)||0,i=[s,n]):i=h.getXY();var d,p=h.dom,f=p.offsetWidth,m=p.offsetHeight;return e?(r=u.call(h,"l")+c.call(h,"l"),a=u.call(h,"r")+c.call(h,"r"),o=u.call(h,"t")+c.call(h,"t"),l=u.call(h,"b")+c.call(h,"b"),d={x:i[0]+r,y:i[1]+o,0:i[0]+r,1:i[1]+o,width:f-(r+a),height:m-(o+l)}):d={x:i[0],y:i[1],0:i[0],1:i[1],width:f,height:m},d.right=d.x+d.width,d.bottom=d.y+d.height,d},move:function(e,t,i){var s=this,n=s.getXY(),r=n[0],a=n[1],o=[r-t,a],l=[r+t,a],h=[r,a-t],u=[r,a+t],c={l:o,left:o,r:l,right:l,t:h,top:h,up:h,b:u,bottom:u,down:u};e=e.toLowerCase(),s.moveTo(c[e][0],c[e][1],s.animTest.call(s,arguments,i,2))},setLeftTop:function(e,t){var i=this,s=i.dom.style;return s.left=i.addUnits(e),s.top=i.addUnits(t),i},getRegion:function(){return Ext.lib.Dom.getRegion(this.dom)},setBounds:function(e,t,i,s,n){var r=this;return n&&r.anim?r.anim({points:{to:[e,t]},width:{to:r.adjustWidth(i)},height:{to:r.adjustHeight(s)}},r.preanim(arguments,4),"motion"):(r.setSize(i,s),r.setLocation(e,t)),r},setRegion:function(e,t){return this.setBounds(e.left,e.top,e.right-e.left,e.bottom-e.top,this.animTest.call(this,arguments,t,1))}}),Ext.Element.addMethods({scrollTo:function(e,t,i){var s,n=/top/i.test(e),r=this,a=r.dom;return i&&r.anim?(s="scroll"+(n?"Left":"Top"),r.anim({scroll:{to:n?[a[s],t]:[t,a[s]]}},r.preanim(arguments,2),"scroll")):(s="scroll"+(n?"Top":"Left"),a[s]=t),r},scrollIntoView:function(e,t){var i=Ext.getDom(e)||Ext.getBody().dom,s=this.dom,n=this.getOffsetsTo(i),r=n[0]+i.scrollLeft,a=n[1]+i.scrollTop,o=a+s.offsetHeight,l=r+s.offsetWidth,h=i.clientHeight,u=parseInt(i.scrollTop,10),c=parseInt(i.scrollLeft,10),d=u+h,p=c+i.clientWidth;return s.offsetHeight>h||u>a?i.scrollTop=a:o>d&&(i.scrollTop=o-h),i.scrollTop=i.scrollTop,t!==!1&&(s.offsetWidth>i.clientWidth||c>r?i.scrollLeft=r:l>p&&(i.scrollLeft=l-i.clientWidth),i.scrollLeft=i.scrollLeft),this},scrollChildIntoView:function(e,t){Ext.fly(e,"_scrollChildIntoView").scrollIntoView(this,t)},scroll:function(e,t){if(!this.isScrollable())return!1;var i,s=this.dom,n=s.scrollLeft,r=s.scrollTop,a=s.scrollWidth,o=s.scrollHeight,l=s.clientWidth,h=s.clientHeight,u=!1,c={l:Math.min(n+t,a-l),r:i=Math.max(n-t,0),t:Math.max(r-t,0),b:Math.min(r+t,o-h)};return c.d=c.b,c.u=c.t,e=e.substr(0,1),(i=c[e])>-1&&(u=!0,this.scrollTo("l"==e||"r"==e?"left":"top",i,this.preanim(arguments,2))),u}}),Ext.Element.addMethods(function(){var e="visibility",t="display",i="hidden",s="none",n="x-masked",r="x-masked-relative",a=Ext.Element.data;return{isVisible:function(n){var r=!this.isStyle(e,i)&&!this.isStyle(t,s),a=this.dom.parentNode;if(n!==!0||!r)return r;for(;a&&!/^body/i.test(a.tagName);){if(!Ext.fly(a,"_isVisible").isVisible())return!1;a=a.parentNode}return!0},isDisplayed:function(){return!this.isStyle(t,s)},enableDisplayMode:function(e){return this.setVisibilityMode(Ext.Element.DISPLAY),Ext.isEmpty(e)||a(this.dom,"originalDisplay",e),this},mask:function(e,t){var i,s,o=this,l=o.dom,h=Ext.DomHelper,u="ext-el-mask-msg";if(/^body/i.test(l.tagName)||"static"!=o.getStyle("position")||o.addClass(r),(i=a(l,"maskMsg"))&&i.remove(),(i=a(l,"mask"))&&i.remove(),s=h.append(l,{cls:"ext-el-mask"},!0),a(l,"mask",s),o.addClass(n),s.setDisplayed(!0),"string"==typeof e){var c=h.append(l,{cls:u,cn:{tag:"div"}},!0);a(l,"maskMsg",c),c.dom.className=t?u+" "+t:u,c.dom.firstChild.innerHTML=e,c.setDisplayed(!0),c.center(o)}return!Ext.isIE||Ext.isIE7&&Ext.isStrict||"auto"!=o.getStyle("height")||s.setSize(void 0,o.getHeight()),s},unmask:function(){var e=this,t=e.dom,i=a(t,"mask"),s=a(t,"maskMsg");i&&(s&&(s.remove(),a(t,"maskMsg",void 0)),i.remove(),a(t,"mask",void 0),e.removeClass([n,r]))},isMasked:function(){var e=a(this.dom,"mask");return e&&e.isVisible()},createShim:function(){var e,t=document.createElement("iframe");return t.frameBorder="0",t.className="ext-shim",t.src=Ext.SSL_SECURE_URL,e=Ext.get(this.dom.parentNode.insertBefore(t,this.dom)),e.autoBoxAdjust=!1,e}}}()),Ext.Element.addMethods({addKeyListener:function(e,t,i){var s;return s="object"!=typeof e||Ext.isArray(e)?{key:e,fn:t,scope:i}:{key:e.key,shift:e.shift,ctrl:e.ctrl,alt:e.alt,fn:t,scope:i},new Ext.KeyMap(this,s)},addKeyMap:function(e){return new Ext.KeyMap(this,e)}}),Ext.CompositeElementLite.importElementMethods(),Ext.apply(Ext.CompositeElementLite.prototype,{addElements:function(e,t){if(!e)return this;"string"==typeof e&&(e=Ext.Element.selectorFunction(e,t));var i=this.elements;return Ext.each(e,function(e){i.push(Ext.get(e))}),this},first:function(){return this.item(0)},last:function(){return this.item(this.getCount()-1)},contains:function(e){return-1!=this.indexOf(e)},removeElement:function(e,t){var i,s=this,n=this.elements;return Ext.each(e,function(e){(i=n[e]||n[e=s.indexOf(e)])&&(t&&(i.dom?i.remove():Ext.removeNode(i)),n.splice(e,1))}),this}}),Ext.CompositeElement=Ext.extend(Ext.CompositeElementLite,{constructor:function(e,t){this.elements=[],this.add(e,t)},getElement:function(e){return e},transformElement:function(e){return Ext.get(e)}}),Ext.Element.select=function(e,t,i){var s;if("string"==typeof e)s=Ext.Element.selectorFunction(e,i);else{if(void 0===e.length)throw"Invalid selector";s=e}return t===!0?new Ext.CompositeElement(s):new Ext.CompositeElementLite(s)},Ext.select=Ext.Element.select,Ext.UpdateManager=Ext.Updater=Ext.extend(Ext.util.Observable,function(){function e(e){var i=this;if(i.transaction=null,e.argument.form&&e.argument.reset)try{e.argument.form.reset()}catch(s){}i.loadScripts?i.renderer.render(i.el,e,i,t.createDelegate(i,[e])):(i.renderer.render(i.el,e,i),t.call(i,e))}function t(e,t,i){this.fireEvent(t||n,this.el,e),Ext.isFunction(e.argument.callback)&&e.argument.callback.call(e.argument.scope,this.el,Ext.isEmpty(i)?!0:!1,e,e.argument.options)}function i(e){t.call(this,e,r,!!(this.transaction=null))}var s="beforeupdate",n="update",r="failure";return{constructor:function(e,t){var i=this;return e=Ext.get(e),!t&&e.updateManager?e.updateManager:(i.el=e,i.defaultUrl=null,i.addEvents(s,n,r),Ext.apply(i,Ext.Updater.defaults),i.transaction=null,i.refreshDelegate=i.refresh.createDelegate(i),i.updateDelegate=i.update.createDelegate(i),i.formUpdateDelegate=(i.formUpdate||function(){}).createDelegate(i),i.renderer=i.renderer||i.getDefaultRenderer(),Ext.Updater.superclass.constructor.call(i),void 0)},setRenderer:function(e){this.renderer=e},getRenderer:function(){return this.renderer},getDefaultRenderer:function(){return new Ext.Updater.BasicRenderer},setDefaultUrl:function(e){this.defaultUrl=e},getEl:function(){return this.el},update:function(t,n,r,a){var o,l,h=this;if(h.fireEvent(s,h.el,t,n)!==!1){Ext.isObject(t)&&(o=t,t=o.url,n=n||o.params,r=r||o.callback,a=a||o.discardUrl,l=o.scope,Ext.isEmpty(o.nocache)||(h.disableCaching=o.nocache),Ext.isEmpty(o.text)||(h.indicatorText='<div class="loading-indicator">'+o.text+"</div>"),Ext.isEmpty(o.scripts)||(h.loadScripts=o.scripts),Ext.isEmpty(o.timeout)||(h.timeout=o.timeout)),h.showLoading(),a||(h.defaultUrl=t),Ext.isFunction(t)&&(t=t.call(h));var u=Ext.apply({},{url:t,params:Ext.isFunction(n)&&l?n.createDelegate(l):n,success:e,failure:i,scope:h,callback:void 0,timeout:1e3*h.timeout,disableCaching:h.disableCaching,argument:{options:o,url:t,form:null,callback:r,scope:l||window,params:n}},o);h.transaction=Ext.Ajax.request(u)}},formUpdate:function(t,n,r,a){var o=this;o.fireEvent(s,o.el,t,n)!==!1&&(Ext.isFunction(n)&&(n=n.call(o)),t=Ext.getDom(t),o.transaction=Ext.Ajax.request({form:t,url:n,success:e,failure:i,scope:o,timeout:1e3*o.timeout,argument:{url:n,form:t,callback:a,reset:r}}),o.showLoading.defer(1,o))},startAutoRefresh:function(e,t,i,s,n){var r=this;n&&r.update(t||r.defaultUrl,i,s,!0),r.autoRefreshProcId&&clearInterval(r.autoRefreshProcId),r.autoRefreshProcId=setInterval(r.update.createDelegate(r,[t||r.defaultUrl,i,s,!0]),1e3*e)},stopAutoRefresh:function(){this.autoRefreshProcId&&(clearInterval(this.autoRefreshProcId),delete this.autoRefreshProcId)},isAutoRefreshing:function(){return!!this.autoRefreshProcId},showLoading:function(){this.showLoadIndicator&&(this.el.dom.innerHTML=this.indicatorText)},abort:function(){this.transaction&&Ext.Ajax.abort(this.transaction)},isUpdating:function(){return this.transaction?Ext.Ajax.isLoading(this.transaction):!1},refresh:function(e){this.defaultUrl&&this.update(this.defaultUrl,null,e,!0)}}}()),Ext.Updater.defaults={timeout:30,disableCaching:!1,showLoadIndicator:!0,indicatorText:'<div class="loading-indicator">Loading...</div>',loadScripts:!1,sslBlankUrl:Ext.SSL_SECURE_URL},Ext.Updater.updateElement=function(e,t,i,s){var n=Ext.get(e).getUpdater();Ext.apply(n,s),n.update(t,i,s?s.callback:null)},Ext.Updater.BasicRenderer=function(){},Ext.Updater.BasicRenderer.prototype={render:function(e,t,i,s){e.update(t.responseText,i.loadScripts,s)}},function(){function e(e){var t=Array.prototype.slice.call(arguments,1);return e.replace(/\{(\d+)\}/g,function(e,i){return t[i]})}Date.useStrict=!1,Date.formatCodeToRegex=function(t,i){var s=Date.parseCodes[t];return s&&(s="function"==typeof s?s():s,Date.parseCodes[t]=s),s?Ext.applyIf({c:s.c?e(s.c,i||"{0}"):s.c},s):{g:0,c:null,s:Ext.escapeRe(t)}};var t=Date.formatCodeToRegex;Ext.apply(Date,{parseFunctions:{M$:function(e){var t=new RegExp("\\/Date\\(([-+])?(\\d+)(?:[+-]\\d{4})?\\)\\/"),i=(e||"").match(t);return i?new Date(1*((i[1]||"")+i[2])):null}},parseRegexes:[],formatFunctions:{M$:function(){return"\\/Date("+this.getTime()+")\\/"}},y2kYear:50,MILLI:"ms",SECOND:"s",MINUTE:"mi",HOUR:"h",DAY:"d",MONTH:"mo",YEAR:"y",defaults:{},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNumbers:{Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11},getShortMonthName:function(e){return Date.monthNames[e].substring(0,3)},getShortDayName:function(e){return Date.dayNames[e].substring(0,3)},getMonthNumber:function(e){return Date.monthNumbers[e.substring(0,1).toUpperCase()+e.substring(1,3).toLowerCase()]},formatContainsHourInfo:function(){var e=/(\\.)/g,t=/([gGhHisucUOPZ]|M\$)/;return function(i){return t.test(i.replace(e,""))}}(),formatCodes:{d:"String.leftPad(this.getDate(), 2, '0')",D:"Date.getShortDayName(this.getDay())",j:"this.getDate()",l:"Date.dayNames[this.getDay()]",N:"(this.getDay() ? this.getDay() : 7)",S:"this.getSuffix()",w:"this.getDay()",z:"this.getDayOfYear()",W:"String.leftPad(this.getWeekOfYear(), 2, '0')",F:"Date.monthNames[this.getMonth()]",m:"String.leftPad(this.getMonth() + 1, 2, '0')",M:"Date.getShortMonthName(this.getMonth())",n:"(this.getMonth() + 1)",t:"this.getDaysInMonth()",L:"(this.isLeapYear() ? 1 : 0)",o:"(this.getFullYear() + (this.getWeekOfYear() == 1 && this.getMonth() > 0 ? +1 : (this.getWeekOfYear() >= 52 && this.getMonth() < 11 ? -1 : 0)))",Y:"String.leftPad(this.getFullYear(), 4, '0')",y:"('' + this.getFullYear()).substring(2, 4)",a:"(this.getHours() < 12 ? 'am' : 'pm')",A:"(this.getHours() < 12 ? 'AM' : 'PM')",g:"((this.getHours() % 12) ? this.getHours() % 12 : 12)",G:"this.getHours()",h:"String.leftPad((this.getHours() % 12) ? this.getHours() % 12 : 12, 2, '0')",H:"String.leftPad(this.getHours(), 2, '0')",i:"String.leftPad(this.getMinutes(), 2, '0')",s:"String.leftPad(this.getSeconds(), 2, '0')",u:"String.leftPad(this.getMilliseconds(), 3, '0')",O:"this.getGMTOffset()",P:"this.getGMTOffset(true)",T:"this.getTimezone()",Z:"(this.getTimezoneOffset() * -60)",c:function(){for(var e="Y-m-dTH:i:sP",t=[],i=0,s=e.length;s>i;++i){var n=e.charAt(i);t.push("T"==n?"'T'":Date.getFormatCode(n))}return t.join(" + ")},U:"Math.round(this.getTime() / 1000)"},isValid:function(e,t,i,s,n,r,a){s=s||0,n=n||0,r=r||0,a=a||0;var o=new Date(100>e?100:e,t-1,i,s,n,r,a).add(Date.YEAR,100>e?e-100:0);return e==o.getFullYear()&&t==o.getMonth()+1&&i==o.getDate()&&s==o.getHours()&&n==o.getMinutes()&&r==o.getSeconds()&&a==o.getMilliseconds()},parseDate:function(e,t,i){var s=Date.parseFunctions;return null==s[t]&&Date.createParser(t),s[t](e,Ext.isDefined(i)?i:Date.useStrict)},getFormatCode:function(e){var t=Date.formatCodes[e];return t&&(t="function"==typeof t?t():t,Date.formatCodes[e]=t),t||"'"+String.escape(e)+"'"},createFormat:function(e){for(var t=[],i=!1,s="",n=0;n<e.length;++n)s=e.charAt(n),i||"\\"!=s?i?(i=!1,t.push("'"+String.escape(s)+"'")):t.push(Date.getFormatCode(s)):i=!0;Date.formatFunctions[e]=new Function("return "+t.join("+"))},createParser:function(){var i=["var dt, y, m, d, h, i, s, ms, o, z, zz, u, v,","def = Date.defaults,","results = String(input).match(Date.parseRegexes[{0}]);","if(results){","{1}","if(u != null){","v = new Date(u * 1000);","}else{","dt = (new Date()).clearTime();","y = Ext.num(y, Ext.num(def.y, dt.getFullYear()));","m = Ext.num(m, Ext.num(def.m - 1, dt.getMonth()));","d = Ext.num(d, Ext.num(def.d, dt.getDate()));","h  = Ext.num(h, Ext.num(def.h, dt.getHours()));","i  = Ext.num(i, Ext.num(def.i, dt.getMinutes()));","s  = Ext.num(s, Ext.num(def.s, dt.getSeconds()));","ms = Ext.num(ms, Ext.num(def.ms, dt.getMilliseconds()));","if(z >= 0 && y >= 0){","v = new Date(y < 100 ? 100 : y, 0, 1, h, i, s, ms).add(Date.YEAR, y < 100 ? y - 100 : 0);","v = !strict? v : (strict === true && (z <= 364 || (v.isLeapYear() && z <= 365))? v.add(Date.DAY, z) : null);","}else if(strict === true && !Date.isValid(y, m + 1, d, h, i, s, ms)){","v = null;","}else{","v = new Date(y < 100 ? 100 : y, m, d, h, i, s, ms).add(Date.YEAR, y < 100 ? y - 100 : 0);","}","}","}","if(v){","if(zz != null){","v = v.add(Date.SECOND, -v.getTimezoneOffset() * 60 - zz);","}else if(o){","v = v.add(Date.MINUTE, -v.getTimezoneOffset() + (sn == '+'? -1 : 1) * (hr * 60 + mn));","}","}","return v;"].join("\n");return function(s){for(var n,r,a=Date.parseRegexes.length,o=1,l=[],h=[],u=!1,c="",d=0;d<s.length;++d)c=s.charAt(d),u||"\\"!=c?u?(u=!1,h.push(String.escape(c))):(n=t(c,o),o+=n.g,h.push(n.s),n.g&&n.c&&(n.calcLast?r=n.c:l.push(n.c))):u=!0;r&&l.push(r),Date.parseRegexes[a]=new RegExp("^"+h.join("")+"$","i"),Date.parseFunctions[s]=new Function("input","strict",e(i,a,l.join("")))}}(),parseCodes:{d:{g:1,c:"d = parseInt(results[{0}], 10);\n",s:"(\\d{2})"},j:{g:1,c:"d = parseInt(results[{0}], 10);\n",s:"(\\d{1,2})"},D:function(){for(var e=[],t=0;7>t;e.push(Date.getShortDayName(t)),++t);return{g:0,c:null,s:"(?:"+e.join("|")+")"}},l:function(){return{g:0,c:null,s:"(?:"+Date.dayNames.join("|")+")"}},N:{g:0,c:null,s:"[1-7]"},S:{g:0,c:null,s:"(?:st|nd|rd|th)"},w:{g:0,c:null,s:"[0-6]"},z:{g:1,c:"z = parseInt(results[{0}], 10);\n",s:"(\\d{1,3})"},W:{g:0,c:null,s:"(?:\\d{2})"},F:function(){return{g:1,c:"m = parseInt(Date.getMonthNumber(results[{0}]), 10);\n",s:"("+Date.monthNames.join("|")+")"}},M:function(){for(var e=[],i=0;12>i;e.push(Date.getShortMonthName(i)),++i);return Ext.applyIf({s:"("+e.join("|")+")"},t("F"))},m:{g:1,c:"m = parseInt(results[{0}], 10) - 1;\n",s:"(\\d{2})"},n:{g:1,c:"m = parseInt(results[{0}], 10) - 1;\n",s:"(\\d{1,2})"},t:{g:0,c:null,s:"(?:\\d{2})"},L:{g:0,c:null,s:"(?:1|0)"},o:function(){return t("Y")},Y:{g:1,c:"y = parseInt(results[{0}], 10);\n",s:"(\\d{4})"},y:{g:1,c:"var ty = parseInt(results[{0}], 10);\ny = ty > Date.y2kYear ? 1900 + ty : 2000 + ty;\n",s:"(\\d{1,2})"},a:function(){return t("A")},A:{calcLast:!0,g:1,c:"if (/(am)/i.test(results[{0}])) {\nif (!h || h == 12) { h = 0; }\n} else { if (!h || h < 12) { h = (h || 0) + 12; }}",s:"(AM|PM|am|pm)"},g:function(){return t("G")},G:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(\\d{1,2})"},h:function(){return t("H")},H:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(\\d{2})"},i:{g:1,c:"i = parseInt(results[{0}], 10);\n",s:"(\\d{2})"},s:{g:1,c:"s = parseInt(results[{0}], 10);\n",s:"(\\d{2})"},u:{g:1,c:"ms = results[{0}]; ms = parseInt(ms, 10)/Math.pow(10, ms.length - 3);\n",s:"(\\d+)"},O:{g:1,c:["o = results[{0}];","var sn = o.substring(0,1),","hr = o.substring(1,3)*1 + Math.floor(o.substring(3,5) / 60),","mn = o.substring(3,5) % 60;","o = ((-12 <= (hr*60 + mn)/60) && ((hr*60 + mn)/60 <= 14))? (sn + String.leftPad(hr, 2, '0') + String.leftPad(mn, 2, '0')) : null;\n"].join("\n"),s:"([+-]\\d{4})"},P:{g:1,c:["o = results[{0}];","var sn = o.substring(0,1),","hr = o.substring(1,3)*1 + Math.floor(o.substring(4,6) / 60),","mn = o.substring(4,6) % 60;","o = ((-12 <= (hr*60 + mn)/60) && ((hr*60 + mn)/60 <= 14))? (sn + String.leftPad(hr, 2, '0') + String.leftPad(mn, 2, '0')) : null;\n"].join("\n"),s:"([+-]\\d{2}:\\d{2})"},T:{g:0,c:null,s:"[A-Z]{1,4}"},Z:{g:1,c:"zz = results[{0}] * 1;\nzz = (-43200 <= zz && zz <= 50400)? zz : null;\n",s:"([+-]?\\d{1,5})"},c:function(){for(var e=[],i=[t("Y",1),t("m",2),t("d",3),t("h",4),t("i",5),t("s",6),{c:"ms = results[7] || '0'; ms = parseInt(ms, 10)/Math.pow(10, ms.length - 3);\n"},{c:["if(results[8]) {","if(results[8] == 'Z'){","zz = 0;","}else if (results[8].indexOf(':') > -1){",t("P",8).c,"}else{",t("O",8).c,"}","}"].join("\n")}],s=0,n=i.length;n>s;++s)e.push(i[s].c);return{g:1,c:e.join(""),s:[i[0].s,"(?:","-",i[1].s,"(?:","-",i[2].s,"(?:","(?:T| )?",i[3].s,":",i[4].s,"(?::",i[5].s,")?","(?:(?:\\.|,)(\\d+))?","(Z|(?:[-+]\\d{2}(?::)?\\d{2}))?",")?",")?",")?"].join("")}},U:{g:1,c:"u = parseInt(results[{0}], 10);\n",s:"(-?\\d+)"}}})}(),Ext.apply(Date.prototype,{dateFormat:function(e){return null==Date.formatFunctions[e]&&Date.createFormat(e),Date.formatFunctions[e].call(this)},getTimezone:function(){return this.toString().replace(/^.* (?:\((.*)\)|([A-Z]{1,4})(?:[\-+][0-9]{4})?(?: -?\d+)?)$/,"$1$2").replace(/[^A-Z]/g,"")},getGMTOffset:function(e){return(this.getTimezoneOffset()>0?"-":"+")+String.leftPad(Math.floor(Math.abs(this.getTimezoneOffset())/60),2,"0")+(e?":":"")+String.leftPad(Math.abs(this.getTimezoneOffset()%60),2,"0")},getDayOfYear:function(){var e,t=0,i=this.clone(),s=this.getMonth();for(e=0,i.setDate(1),i.setMonth(0);s>e;i.setMonth(++e))t+=i.getDaysInMonth();return t+this.getDate()-1},getWeekOfYear:function(){var e=864e5,t=7*e;return function(){var i=Date.UTC(this.getFullYear(),this.getMonth(),this.getDate()+3)/e,s=Math.floor(i/7),n=new Date(s*t).getUTCFullYear();return s-Math.floor(Date.UTC(n,0,7)/t)+1}}(),isLeapYear:function(){var e=this.getFullYear();return!(0!=(3&e)||!(e%100||0==e%400&&e))},getFirstDayOfMonth:function(){var e=(this.getDay()-(this.getDate()-1))%7;return 0>e?e+7:e},getLastDayOfMonth:function(){return this.getLastDateOfMonth().getDay()},getFirstDateOfMonth:function(){return new Date(this.getFullYear(),this.getMonth(),1)},getLastDateOfMonth:function(){return new Date(this.getFullYear(),this.getMonth(),this.getDaysInMonth())},getDaysInMonth:function(){var e=[31,28,31,30,31,30,31,31,30,31,30,31];return function(){var t=this.getMonth();return 1==t&&this.isLeapYear()?29:e[t]}}(),getSuffix:function(){switch(this.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}},clone:function(){return new Date(this.getTime())},isDST:function(){return new Date(this.getFullYear(),0,1).getTimezoneOffset()!=this.getTimezoneOffset()},clearTime:function(e){if(e)return this.clone().clearTime();var t=this.getDate();if(this.setHours(0),this.setMinutes(0),this.setSeconds(0),this.setMilliseconds(0),this.getDate()!=t){for(var i=1,s=this.add(Date.HOUR,i);s.getDate()!=t;i++,s=this.add(Date.HOUR,i));this.setDate(t),this.setHours(s.getHours())}return this},add:function(e,t){var i=this.clone();if(!e||0===t)return i;switch(e.toLowerCase()){case Date.MILLI:i.setMilliseconds(this.getMilliseconds()+t);break;case Date.SECOND:i.setSeconds(this.getSeconds()+t);break;case Date.MINUTE:i.setMinutes(this.getMinutes()+t);break;case Date.HOUR:i.setHours(this.getHours()+t);break;case Date.DAY:i.setDate(this.getDate()+t);break;case Date.MONTH:var s=this.getDate();s>28&&(s=Math.min(s,this.getFirstDateOfMonth().add("mo",t).getLastDateOfMonth().getDate())),i.setDate(s),i.setMonth(this.getMonth()+t);break;case Date.YEAR:i.setFullYear(this.getFullYear()+t)}return i},between:function(e,t){var i=this.getTime();return e.getTime()<=i&&i<=t.getTime()}}),Date.prototype.format=Date.prototype.dateFormat,Ext.isSafari&&(navigator.userAgent.match(/WebKit\/(\d+)/)[1]||0/0)<420&&Ext.apply(Date.prototype,{_xMonth:Date.prototype.setMonth,_xDate:Date.prototype.setDate,setMonth:function(e){if(-1>=e){var t=Math.ceil(-e),i=Math.ceil(t/12),s=t%12?12-t%12:0;return this.setFullYear(this.getFullYear()-i),this._xMonth(s)}return this._xMonth(e)},setDate:function(e){return this.setTime(this.getTime()-864e5*(this.getDate()-e))}}),Ext.util.MixedCollection=function(e,t){this.items=[],this.map={},this.keys=[],this.length=0,this.addEvents("clear","add","replace","remove","sort"),this.allowFunctions=e===!0,t&&(this.getKey=t),Ext.util.MixedCollection.superclass.constructor.call(this)
},Ext.extend(Ext.util.MixedCollection,Ext.util.Observable,{allowFunctions:!1,add:function(e,t){if(1==arguments.length&&(t=arguments[0],e=this.getKey(t)),"undefined"!=typeof e&&null!==e){var i=this.map[e];if("undefined"!=typeof i)return this.replace(e,t);this.map[e]=t}return this.length++,this.items.push(t),this.keys.push(e),this.fireEvent("add",this.length-1,t,e),t},getKey:function(e){return e.id},replace:function(e,t){1==arguments.length&&(t=arguments[0],e=this.getKey(t));var i=this.map[e];if("undefined"==typeof e||null===e||"undefined"==typeof i)return this.add(e,t);var s=this.indexOfKey(e);return this.items[s]=t,this.map[e]=t,this.fireEvent("replace",e,i,t),t},addAll:function(e){if(arguments.length>1||Ext.isArray(e))for(var t=arguments.length>1?arguments:e,i=0,s=t.length;s>i;i++)this.add(t[i]);else for(var n in e)(this.allowFunctions||"function"!=typeof e[n])&&this.add(n,e[n])},each:function(e,t){for(var i=[].concat(this.items),s=0,n=i.length;n>s&&e.call(t||i[s],i[s],s,n)!==!1;s++);},eachKey:function(e,t){for(var i=0,s=this.keys.length;s>i;i++)e.call(t||window,this.keys[i],this.items[i],i,s)},find:function(e,t){for(var i=0,s=this.items.length;s>i;i++)if(e.call(t||window,this.items[i],this.keys[i]))return this.items[i];return null},insert:function(e,t,i){return 2==arguments.length&&(i=arguments[1],t=this.getKey(i)),this.containsKey(t)&&(this.suspendEvents(),this.removeKey(t),this.resumeEvents()),e>=this.length?this.add(t,i):(this.length++,this.items.splice(e,0,i),"undefined"!=typeof t&&null!==t&&(this.map[t]=i),this.keys.splice(e,0,t),this.fireEvent("add",e,i,t),i)},remove:function(e){return this.removeAt(this.indexOf(e))},removeAt:function(e){if(e<this.length&&e>=0){this.length--;var t=this.items[e];this.items.splice(e,1);var i=this.keys[e];return"undefined"!=typeof i&&delete this.map[i],this.keys.splice(e,1),this.fireEvent("remove",t,i),t}return!1},removeKey:function(e){return this.removeAt(this.indexOfKey(e))},getCount:function(){return this.length},indexOf:function(e){return this.items.indexOf(e)},indexOfKey:function(e){return this.keys.indexOf(e)},item:function(e){var t=this.map[e],i=void 0!==t?t:"number"==typeof e?this.items[e]:void 0;return"function"!=typeof i||this.allowFunctions?i:null},itemAt:function(e){return this.items[e]},key:function(e){return this.map[e]},contains:function(e){return-1!=this.indexOf(e)},containsKey:function(e){return"undefined"!=typeof this.map[e]},clear:function(){this.length=0,this.items=[],this.keys=[],this.map={},this.fireEvent("clear")},first:function(){return this.items[0]},last:function(){return this.items[this.length-1]},_sort:function(e,t,i){var s,n,r="DESC"==String(t).toUpperCase()?-1:1,a=[],o=this.keys,l=this.items;for(i=i||function(e,t){return e-t},s=0,n=l.length;n>s;s++)a[a.length]={key:o[s],value:l[s],index:s};for(a.sort(function(t,s){var n=i(t[e],s[e])*r;return 0===n&&(n=t.index<s.index?-1:1),n}),s=0,n=a.length;n>s;s++)l[s]=a[s].value,o[s]=a[s].key;this.fireEvent("sort",this)},sort:function(e,t){this._sort("value",e,t)},reorder:function(e){this.suspendEvents();var t,i=this.items,s=0,n=i.length,r=[],a=[];for(t in e)r[e[t]]=i[t];for(s=0;n>s;s++)void 0==e[s]&&a.push(i[s]);for(s=0;n>s;s++)void 0==r[s]&&(r[s]=a.shift());this.clear(),this.addAll(r),this.resumeEvents(),this.fireEvent("sort",this)},keySort:function(e,t){this._sort("key",e,t||function(e,t){var i=String(e).toUpperCase(),s=String(t).toUpperCase();return i>s?1:s>i?-1:0})},getRange:function(e,t){var i=this.items;if(i.length<1)return[];e=e||0,t=Math.min("undefined"==typeof t?this.length-1:t,this.length-1);var s,n=[];if(t>=e)for(s=e;t>=s;s++)n[n.length]=i[s];else for(s=e;s>=t;s--)n[n.length]=i[s];return n},filter:function(e,t,i,s){return Ext.isEmpty(t,!1)?this.clone():(t=this.createValueMatcher(t,i,s),this.filterBy(function(i){return i&&t.test(i[e])}))},filterBy:function(e,t){var i=new Ext.util.MixedCollection;i.getKey=this.getKey;for(var s=this.keys,n=this.items,r=0,a=n.length;a>r;r++)e.call(t||this,n[r],s[r])&&i.add(s[r],n[r]);return i},findIndex:function(e,t,i,s,n){return Ext.isEmpty(t,!1)?-1:(t=this.createValueMatcher(t,s,n),this.findIndexBy(function(i){return i&&t.test(i[e])},null,i))},findIndexBy:function(e,t,i){for(var s=this.keys,n=this.items,r=i||0,a=n.length;a>r;r++)if(e.call(t||this,n[r],s[r]))return r;return-1},createValueMatcher:function(e,t,i,s){if(!e.exec){var n=Ext.escapeRe;e=String(e),t===!0?e=n(e):(e="^"+n(e),s===!0&&(e+="$")),e=new RegExp(e,i?"":"i")}return e},clone:function(){for(var e=new Ext.util.MixedCollection,t=this.keys,i=this.items,s=0,n=i.length;n>s;s++)e.add(t[s],i[s]);return e.getKey=this.getKey,e}}),Ext.util.MixedCollection.prototype.get=Ext.util.MixedCollection.prototype.item,Ext.AbstractManager=Ext.extend(Object,{typeName:"type",constructor:function(e){Ext.apply(this,e||{}),this.all=new Ext.util.MixedCollection,this.types={}},get:function(e){return this.all.get(e)},register:function(e){this.all.add(e)},unregister:function(e){this.all.remove(e)},registerType:function(e,t){this.types[e]=t,t[this.typeName]=e},isRegistered:function(e){return void 0!==this.types[e]},create:function(e,t){var i=e[this.typeName]||e.type||t,s=this.types[i];if(void 0==s)throw new Error(String.format("The '{0}' type has not been registered with this manager",i));return new s(e)},onAvailable:function(e,t,i){var s=this.all;s.on("add",function(n,r){r.id==e&&(t.call(i||r,r),s.un("add",t,i))})}}),Ext.util.Format=function(){var trimRe=/^\s+|\s+$/g,stripTagsRE=/<\/?[^>]+>/gi,stripScriptsRe=/(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)/gi,nl2brRe=/\r?\n/g;return{ellipsis:function(e,t,i){if(e&&e.length>t){if(i){var s=e.substr(0,t-2),n=Math.max(s.lastIndexOf(" "),s.lastIndexOf("."),s.lastIndexOf("!"),s.lastIndexOf("?"));return-1==n||t-15>n?e.substr(0,t-3)+"...":s.substr(0,n)+"..."}return e.substr(0,t-3)+"..."}return e},undef:function(e){return void 0!==e?e:""},defaultValue:function(e,t){return void 0!==e&&""!==e?e:t},htmlEncode:function(e){return e?String(e).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;"):e},htmlDecode:function(e){return e?String(e).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;/g,"&"):e},trim:function(e){return String(e).replace(trimRe,"")},substr:function(e,t,i){return String(e).substr(t,i)},lowercase:function(e){return String(e).toLowerCase()},uppercase:function(e){return String(e).toUpperCase()},capitalize:function(e){return e?e.charAt(0).toUpperCase()+e.substr(1).toLowerCase():e},call:function(value,fn){if(arguments.length>2){var args=Array.prototype.slice.call(arguments,2);return args.unshift(value),eval(fn).apply(window,args)}return eval(fn).call(window,value)},usMoney:function(e){e=Math.round(100*(e-0))/100,e=e==Math.floor(e)?e+".00":10*e==Math.floor(10*e)?e+"0":e,e=String(e);for(var t=e.split("."),i=t[0],s=t[1]?"."+t[1]:".00",n=/(\d+)(\d{3})/;n.test(i);)i=i.replace(n,"$1,$2");return e=i+s,"-"==e.charAt(0)?"-$"+e.substr(1):"$"+e},date:function(e,t){return e?(Ext.isDate(e)||(e=new Date(Date.parse(e))),e.dateFormat(t||"m/d/Y")):""},dateRenderer:function(e){return function(t){return Ext.util.Format.date(t,e)}},stripTags:function(e){return e?String(e).replace(stripTagsRE,""):e},stripScripts:function(e){return e?String(e).replace(stripScriptsRe,""):e},fileSize:function(e){return 1024>e?e+" bytes":1048576>e?Math.round(10*e/1024)/10+" KB":Math.round(10*e/1048576)/10+" MB"},math:function(){var e={};return function(t,i){return e[i]||(e[i]=new Function("v","return v "+i+";")),e[i](t)}}(),round:function(e,t){var i=Number(e);return"number"==typeof t&&(t=Math.pow(10,t),i=Math.round(e*t)/t),i},number:function(e,t){if(!t)return e;if(e=Ext.num(e,0/0),isNaN(e))return"";var i=",",s=".",n=!1,r=0>e;e=Math.abs(e),"/i"==t.substr(t.length-2)&&(t=t.substr(0,t.length-2),n=!0,i=".",s=",");var a=-1!=t.indexOf(i),o=(n?t.replace(/[^\d\,]/g,""):t.replace(/[^\d\.]/g,"")).split(s);if(1<o.length)e=e.toFixed(o[1].length);else{if(2<o.length)throw"NumberFormatException: invalid format, formats should have no more than 1 period: "+t;e=e.toFixed(0)}var l=e.toString();if(o=l.split("."),a){var h,u=o[0],c=[],d=u.length,p=Math.floor(d/3),f=u.length%3||3;for(h=0;d>h;h+=f)0!=h&&(f=3),c[c.length]=u.substr(h,f),p-=1;l=c.join(i),o[1]&&(l+=s+o[1])}else o[1]&&(l=o[0]+s+o[1]);return(r?"-":"")+t.replace(/[\d,?\.?]+/,l)},numberRenderer:function(e){return function(t){return Ext.util.Format.number(t,e)}},plural:function(e,t,i){return e+" "+(1==e?t:i?i:t+"s")},nl2br:function(e){return Ext.isEmpty(e)?"":e.replace(nl2brRe,"<br/>")}}}(),Ext.XTemplate=function(){Ext.XTemplate.superclass.constructor.apply(this,arguments);var e,t=this,i=t.html,s=/<tpl\b[^>]*>((?:(?=([^<]+))\2|<(?!tpl\b[^>]*>))*?)<\/tpl>/,n=/^<tpl\b[^>]*?for="(.*?)"/,r=/^<tpl\b[^>]*?if="(.*?)"/,a=/^<tpl\b[^>]*?exec="(.*?)"/,o=0,l=[],h="values",u="parent",c="xindex",d="xcount",p="return ",f="with(values){ ";for(i=["<tpl>",i,"</tpl>"].join("");e=i.match(s);){var m=e[0].match(n),y=e[0].match(r),g=e[0].match(a),v=null,x=null,E=null,b=m&&m[1]?m[1]:"";if(y&&(v=y&&y[1]?y[1]:null,v&&(x=new Function(h,u,c,d,f+p+Ext.util.Format.htmlDecode(v)+"; }"))),g&&(v=g&&g[1]?g[1]:null,v&&(E=new Function(h,u,c,d,f+Ext.util.Format.htmlDecode(v)+"; }"))),b)switch(b){case".":b=new Function(h,u,f+p+h+"; }");break;case"..":b=new Function(h,u,f+p+u+"; }");break;default:b=new Function(h,u,f+p+b+"; }")}l.push({id:o,target:b,exec:E,test:x,body:e[1]||""}),i=i.replace(e[0],"{xtpl"+o+"}"),++o}for(var L=l.length-1;L>=0;--L)t.compileTpl(l[L]);t.master=l[l.length-1],t.tpls=l},Ext.extend(Ext.XTemplate,Ext.Template,{re:/\{([\w\-\.\#]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?(\s?[\+\-\*\\]\s?[\d\.\+\-\*\\\(\)]+)?\}/g,codeRe:/\{\[((?:\\\]|.|\n)*?)\]\}/g,applySubTemplate:function(e,t,i,s,n){var r,a,o=this,l=o.tpls[e],h=[];if(l.test&&!l.test.call(o,t,i,s,n)||l.exec&&l.exec.call(o,t,i,s,n))return"";if(a=l.target?l.target.call(o,t,i):t,r=a.length,i=l.target?t:i,l.target&&Ext.isArray(a)){for(var u=0,r=a.length;r>u;u++)h[h.length]=l.compiled.call(o,a[u],i,u+1,r);return h.join("")}return l.compiled.call(o,a,i,s,n)},compileTpl:function(tpl){function fn(e,t,i,s,n){if("xtpl"==t.substr(0,4))return"'"+sep+"this.applySubTemplate("+t.substr(4)+", values, parent, xindex, xcount)"+sep+"'";var r;return r="."===t?"values":"#"===t?"xindex":-1!=t.indexOf(".")?t:"values['"+t+"']",n&&(r="("+r+n+")"),i&&useF?(s=s?","+s:"","this."!=i.substr(0,5)?i="fm."+i+"(":(i='this.call("'+i.substr(5)+'", ',s=", values")):(s="",i="("+r+" === undefined ? '' : "),"'"+sep+i+r+s+")"+sep+"'"}function codeFn(e,t){return"'"+sep+"("+t.replace(/\\'/g,"'")+")"+sep+"'"}var fm=Ext.util.Format,useF=this.disableFormats!==!0,sep=Ext.isGecko?"+":",",body;return Ext.isGecko?body="tpl.compiled = function(values, parent, xindex, xcount){ return '"+tpl.body.replace(/(\r\n|\n)/g,"\\n").replace(/'/g,"\\'").replace(this.re,fn).replace(this.codeRe,codeFn)+"';};":(body=["tpl.compiled = function(values, parent, xindex, xcount){ return ['"],body.push(tpl.body.replace(/(\r\n|\n)/g,"\\n").replace(/'/g,"\\'").replace(this.re,fn).replace(this.codeRe,codeFn)),body.push("'].join('');};"),body=body.join("")),eval(body),this},applyTemplate:function(e){return this.master.compiled.call(this,e,{},1,1)},compile:function(){return this}}),Ext.XTemplate.prototype.apply=Ext.XTemplate.prototype.applyTemplate,Ext.XTemplate.from=function(e){return e=Ext.getDom(e),new Ext.XTemplate(e.value||e.innerHTML)},Ext.util.CSS=function(){var e=null,t=document,i=/(-[a-z])/gi,s=function(e,t){return t.charAt(1).toUpperCase()};return{createStyleSheet:function(e,i){var s,n=t.getElementsByTagName("head")[0],r=t.createElement("style");if(r.setAttribute("type","text/css"),i&&r.setAttribute("id",i),Ext.isIE)n.appendChild(r),s=r.styleSheet,s.cssText=e;else{try{r.appendChild(t.createTextNode(e))}catch(a){r.cssText=e}n.appendChild(r),s=r.styleSheet?r.styleSheet:r.sheet||t.styleSheets[t.styleSheets.length-1]}return this.cacheStyleSheet(s),s},removeStyleSheet:function(e){var i=t.getElementById(e);i&&i.parentNode.removeChild(i)},swapStyleSheet:function(e,i){this.removeStyleSheet(e);var s=t.createElement("link");s.setAttribute("rel","stylesheet"),s.setAttribute("type","text/css"),s.setAttribute("id",e),s.setAttribute("href",i),t.getElementsByTagName("head")[0].appendChild(s)},refreshCache:function(){return this.getRules(!0)},cacheStyleSheet:function(t){e||(e={});try{for(var i=t.cssRules||t.rules,s=i.length-1;s>=0;--s)e[i[s].selectorText.toLowerCase()]=i[s]}catch(n){}},getRules:function(i){if(null===e||i){e={};for(var s=t.styleSheets,n=0,r=s.length;r>n;n++)try{this.cacheStyleSheet(s[n])}catch(a){}}return e},getRule:function(e,t){var i=this.getRules(t);if(!Ext.isArray(e))return i[e.toLowerCase()];for(var s=0;s<e.length;s++)if(i[e[s]])return i[e[s].toLowerCase()];return null},updateRule:function(e,t,n){if(Ext.isArray(e)){for(var r=0;r<e.length;r++)if(this.updateRule(e[r],t,n))return!0}else{var a=this.getRule(e);if(a)return a.style[t.replace(i,s)]=n,!0}return!1}}}(),Ext.util.ClickRepeater=Ext.extend(Ext.util.Observable,{constructor:function(e,t){this.el=Ext.get(e),this.el.unselectable(),Ext.apply(this,t),this.addEvents("mousedown","click","mouseup"),this.disabled||(this.disabled=!0,this.enable()),this.handler&&this.on("click",this.handler,this.scope||this),Ext.util.ClickRepeater.superclass.constructor.call(this)},interval:20,delay:250,preventDefault:!0,stopDefault:!1,timer:0,enable:function(){this.disabled&&(this.el.on("mousedown",this.handleMouseDown,this),Ext.isIE&&this.el.on("dblclick",this.handleDblClick,this),(this.preventDefault||this.stopDefault)&&this.el.on("click",this.eventOptions,this)),this.disabled=!1},disable:function(e){(e||!this.disabled)&&(clearTimeout(this.timer),this.pressClass&&this.el.removeClass(this.pressClass),Ext.getDoc().un("mouseup",this.handleMouseUp,this),this.el.removeAllListeners()),this.disabled=!0},setDisabled:function(e){this[e?"disable":"enable"]()},eventOptions:function(e){this.preventDefault&&e.preventDefault(),this.stopDefault&&e.stopEvent()},destroy:function(){this.disable(!0),Ext.destroy(this.el),this.purgeListeners()},handleDblClick:function(e){clearTimeout(this.timer),this.el.blur(),this.fireEvent("mousedown",this,e),this.fireEvent("click",this,e)},handleMouseDown:function(e){clearTimeout(this.timer),this.el.blur(),this.pressClass&&this.el.addClass(this.pressClass),this.mousedownTime=new Date,Ext.getDoc().on("mouseup",this.handleMouseUp,this),this.el.on("mouseout",this.handleMouseOut,this),this.fireEvent("mousedown",this,e),this.fireEvent("click",this,e),this.accelerate&&(this.delay=400),this.timer=this.click.defer(this.delay||this.interval,this,[e])},click:function(e){this.fireEvent("click",this,e),this.timer=this.click.defer(this.accelerate?this.easeOutExpo(this.mousedownTime.getElapsed(),400,-390,12e3):this.interval,this,[e])},easeOutExpo:function(e,t,i,s){return e==s?t+i:i*(-Math.pow(2,-10*e/s)+1)+t},handleMouseOut:function(){clearTimeout(this.timer),this.pressClass&&this.el.removeClass(this.pressClass),this.el.on("mouseover",this.handleMouseReturn,this)},handleMouseReturn:function(){this.el.un("mouseover",this.handleMouseReturn,this),this.pressClass&&this.el.addClass(this.pressClass),this.click()},handleMouseUp:function(e){clearTimeout(this.timer),this.el.un("mouseover",this.handleMouseReturn,this),this.el.un("mouseout",this.handleMouseOut,this),Ext.getDoc().un("mouseup",this.handleMouseUp,this),this.el.removeClass(this.pressClass),this.fireEvent("mouseup",this,e)}}),Ext.KeyNav=function(e,t){this.el=Ext.get(e),Ext.apply(this,t),this.disabled||(this.disabled=!0,this.enable())},Ext.KeyNav.prototype={disabled:!1,defaultEventAction:"stopEvent",forceKeyDown:!1,relay:function(e){var t=e.getKey(),i=this.keyToHandler[t];i&&this[i]&&this.doRelay(e,this[i],i)!==!0&&e[this.defaultEventAction]()},doRelay:function(e,t,i){return t.call(this.scope||this,e,i)},enter:!1,left:!1,right:!1,up:!1,down:!1,tab:!1,esc:!1,pageUp:!1,pageDown:!1,del:!1,home:!1,end:!1,space:!1,keyToHandler:{37:"left",39:"right",38:"up",40:"down",33:"pageUp",34:"pageDown",46:"del",36:"home",35:"end",13:"enter",27:"esc",9:"tab",32:"space"},stopKeyUp:function(e){var t=e.getKey();t>=37&&40>=t&&e.stopEvent()},destroy:function(){this.disable()},enable:function(){this.disabled&&(Ext.isSafari2&&this.el.on("keyup",this.stopKeyUp,this),this.el.on(this.isKeydown()?"keydown":"keypress",this.relay,this),this.disabled=!1)},disable:function(){this.disabled||(Ext.isSafari2&&this.el.un("keyup",this.stopKeyUp,this),this.el.un(this.isKeydown()?"keydown":"keypress",this.relay,this),this.disabled=!0)},setDisabled:function(e){this[e?"disable":"enable"]()},isKeydown:function(){return this.forceKeyDown||Ext.EventManager.useKeydown}},Ext.KeyMap=function(e,t,i){this.el=Ext.get(e),this.eventName=i||"keydown",this.bindings=[],t&&this.addBinding(t),this.enable()},Ext.KeyMap.prototype={stopEvent:!1,addBinding:function(e){if(Ext.isArray(e))return Ext.each(e,function(e){this.addBinding(e)},this),void 0;var t=e.key,i=e.fn||e.handler,s=e.scope;if(e.stopEvent&&(this.stopEvent=e.stopEvent),"string"==typeof t){for(var n=[],r=t.toUpperCase(),a=0,o=r.length;o>a;a++)n.push(r.charCodeAt(a));t=n}var l=Ext.isArray(t),h=function(n){if(this.checkModifiers(e,n)){var r=n.getKey();if(l){for(var a=0,o=t.length;o>a;a++)if(t[a]==r)return this.stopEvent&&n.stopEvent(),i.call(s||window,r,n),void 0}else r==t&&(this.stopEvent&&n.stopEvent(),i.call(s||window,r,n))}};this.bindings.push(h)},checkModifiers:function(e,t){for(var i,s,n=["shift","ctrl","alt"],r=0,a=n.length;a>r;++r)if(s=n[r],i=e[s],void 0!==i&&i!==t[s+"Key"])return!1;return!0},on:function(e,t,i){var s,n,r,a;"object"!=typeof e||Ext.isArray(e)?s=e:(s=e.key,n=e.shift,r=e.ctrl,a=e.alt),this.addBinding({key:s,shift:n,ctrl:r,alt:a,fn:t,scope:i})},handleKeyDown:function(e){if(this.enabled)for(var t=this.bindings,i=0,s=t.length;s>i;i++)t[i].call(this,e)},isEnabled:function(){return this.enabled},enable:function(){this.enabled||(this.el.on(this.eventName,this.handleKeyDown,this),this.enabled=!0)},disable:function(){this.enabled&&(this.el.removeListener(this.eventName,this.handleKeyDown,this),this.enabled=!1)},setDisabled:function(e){this[e?"disable":"enable"]()}},Ext.util.TextMetrics=function(){var e;return{measure:function(t,i,s){return e||(e=Ext.util.TextMetrics.Instance(t,s)),e.bind(t),e.setFixedWidth(s||"auto"),e.getSize(i)},createInstance:function(e,t){return Ext.util.TextMetrics.Instance(e,t)}}}(),Ext.util.TextMetrics.Instance=function(e,t){var i=new Ext.Element(document.createElement("div"));document.body.appendChild(i.dom),i.position("absolute"),i.setLeftTop(-1e3,-1e3),i.hide(),t&&i.setWidth(t);var s={getSize:function(e){i.update(e);var t=i.getSize();return i.update(""),t},bind:function(e){i.setStyle(Ext.fly(e).getStyles("font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"))},setFixedWidth:function(e){i.setWidth(e)},getWidth:function(e){return i.dom.style.width="auto",this.getSize(e).width},getHeight:function(e){return this.getSize(e).height}};return s.bind(e),s},Ext.Element.addMethods({getTextWidth:function(e,t,i){return Ext.util.TextMetrics.measure(this.dom,Ext.value(e,this.dom.innerHTML,!0)).width.constrain(t||0,i||1e6)}}),Ext.util.Cookies={set:function(e,t){var i=arguments,s=arguments.length,n=s>2?i[2]:null,r=s>3?i[3]:"/",a=s>4?i[4]:null,o=s>5?i[5]:!1;document.cookie=e+"="+escape(t)+(null===n?"":"; expires="+n.toGMTString())+(null===r?"":"; path="+r)+(null===a?"":"; domain="+a)+(o===!0?"; secure":"")},get:function(e){for(var t=e+"=",i=t.length,s=document.cookie.length,n=0,r=0;s>n;){if(r=n+i,document.cookie.substring(n,r)==t)return Ext.util.Cookies.getCookieVal(r);if(n=document.cookie.indexOf(" ",n)+1,0===n)break}return null},clear:function(e){Ext.util.Cookies.get(e)&&(document.cookie=e+"="+"; expires=Thu, 01-Jan-70 00:00:01 GMT")},getCookieVal:function(e){var t=document.cookie.indexOf(";",e);return-1==t&&(t=document.cookie.length),unescape(document.cookie.substring(e,t))}},Ext.handleError=function(e){throw e},Ext.Error=function(e){this.message=this.lang[e]?this.lang[e]:e},Ext.Error.prototype=new Error,Ext.apply(Ext.Error.prototype,{lang:{},name:"Ext.Error",getName:function(){return this.name},getMessage:function(){return this.message},toJson:function(){return Ext.encode(this)}}),Ext.ComponentMgr=function(){var e=new Ext.util.MixedCollection,t={},i={};return{register:function(t){e.add(t)},unregister:function(t){e.remove(t)},get:function(t){return e.get(t)},onAvailable:function(t,i,s){e.on("add",function(n,r){r.id==t&&(i.call(s||r,r),e.un("add",i,s))})},all:e,types:t,ptypes:i,isRegistered:function(e){return void 0!==t[e]},isPluginRegistered:function(e){return void 0!==i[e]},registerType:function(e,i){t[e]=i,i.xtype=e},create:function(e,i){return e.render?e:new t[e.xtype||i](e)},registerPlugin:function(e,t){i[e]=t,t.ptype=e},createPlugin:function(e,t){var s=i[e.ptype||t];return s.init?s:new s(e)}}}(),Ext.reg=Ext.ComponentMgr.registerType,Ext.preg=Ext.ComponentMgr.registerPlugin,Ext.create=Ext.ComponentMgr.create,Ext.Component=function(e){if(e=e||{},e.initialConfig?(e.isAction&&(this.baseAction=e),e=e.initialConfig):(e.tagName||e.dom||Ext.isString(e))&&(e={applyTo:e,id:e.id||e}),this.initialConfig=e,Ext.apply(this,e),this.addEvents("added","disable","enable","beforeshow","show","beforehide","hide","removed","beforerender","render","afterrender","beforedestroy","destroy","beforestaterestore","staterestore","beforestatesave","statesave"),this.getId(),Ext.ComponentMgr.register(this),Ext.Component.superclass.constructor.call(this),this.baseAction&&this.baseAction.addComponent(this),this.initComponent(),this.plugins)if(Ext.isArray(this.plugins))for(var t=0,i=this.plugins.length;i>t;t++)this.plugins[t]=this.initPlugin(this.plugins[t]);else this.plugins=this.initPlugin(this.plugins);this.stateful!==!1&&this.initState(),this.applyTo?(this.applyToMarkup(this.applyTo),delete this.applyTo):this.renderTo&&(this.render(this.renderTo),delete this.renderTo)},Ext.Component.AUTO_ID=1e3,Ext.extend(Ext.Component,Ext.util.Observable,{disabled:!1,hidden:!1,autoEl:"div",disabledClass:"x-item-disabled",allowDomMove:!0,autoShow:!1,hideMode:"display",hideParent:!1,rendered:!1,tplWriteMode:"overwrite",bubbleEvents:[],ctype:"Ext.Component",actionMode:"el",getActionEl:function(){return this[this.actionMode]},initPlugin:function(e){return e.ptype&&!Ext.isFunction(e.init)?e=Ext.ComponentMgr.createPlugin(e):Ext.isString(e)&&(e=Ext.ComponentMgr.createPlugin({ptype:e})),e.init(this),e},initComponent:function(){this.listeners&&(this.on(this.listeners),delete this.listeners),this.enableBubble(this.bubbleEvents)},render:function(e,t){if(!this.rendered&&this.fireEvent("beforerender",this)!==!1){!e&&this.el&&(this.el=Ext.get(this.el),e=this.el.dom.parentNode,this.allowDomMove=!1),this.container=Ext.get(e),this.ctCls&&this.container.addClass(this.ctCls),this.rendered=!0,void 0!==t&&(t=Ext.isNumber(t)?this.container.dom.childNodes[t]:Ext.getDom(t)),this.onRender(this.container,t||null),this.autoShow&&this.el.removeClass(["x-hidden","x-hide-"+this.hideMode]),this.cls&&(this.el.addClass(this.cls),delete this.cls),this.style&&(this.el.applyStyles(this.style),delete this.style),this.overCls&&this.el.addClassOnOver(this.overCls),this.fireEvent("render",this);var i=this.getContentTarget();if(this.html&&(i.update(Ext.DomHelper.markup(this.html)),delete this.html),this.contentEl){var s=Ext.getDom(this.contentEl);Ext.fly(s).removeClass(["x-hidden","x-hide-display"]),i.appendChild(s)}this.tpl&&(this.tpl.compile||(this.tpl=new Ext.XTemplate(this.tpl)),this.data&&(this.tpl[this.tplWriteMode](i,this.data),delete this.data)),this.afterRender(this.container),this.hidden&&this.doHide(),this.disabled&&this.disable(!0),this.stateful!==!1&&this.initStateEvents(),this.fireEvent("afterrender",this)}return this},update:function(e,t,i){var s=this.getContentTarget();if(this.tpl&&"string"!=typeof e)this.tpl[this.tplWriteMode](s,e||{});else{var n=Ext.isObject(e)?Ext.DomHelper.markup(e):e;s.update(n,t,i)}},onAdded:function(e,t){this.ownerCt=e,this.initRef(),this.fireEvent("added",this,e,t)},onRemoved:function(){this.removeRef(),this.fireEvent("removed",this,this.ownerCt),delete this.ownerCt},initRef:function(){if(this.ref&&!this.refOwner){for(var e=this.ref.split("/"),t=e.length,i=0,s=this;s&&t>i;)s=s.ownerCt,++i;s&&(s[this.refName=e[--i]]=this,this.refOwner=s)}},removeRef:function(){this.refOwner&&this.refName&&(delete this.refOwner[this.refName],delete this.refOwner)},initState:function(){if(Ext.state.Manager){var e=this.getStateId();if(e){var t=Ext.state.Manager.get(e);t&&this.fireEvent("beforestaterestore",this,t)!==!1&&(this.applyState(Ext.apply({},t)),this.fireEvent("staterestore",this,t))}}},getStateId:function(){return this.stateId||(/^(ext-comp-|ext-gen)/.test(String(this.id))?null:this.id)},initStateEvents:function(){if(this.stateEvents)for(var e,t=0;e=this.stateEvents[t];t++)this.on(e,this.saveState,this,{delay:100})},applyState:function(e){e&&Ext.apply(this,e)},getState:function(){return null},saveState:function(){if(Ext.state.Manager&&this.stateful!==!1){var e=this.getStateId();if(e){var t=this.getState();this.fireEvent("beforestatesave",this,t)!==!1&&(Ext.state.Manager.set(e,t),this.fireEvent("statesave",this,t))}}},applyToMarkup:function(e){this.allowDomMove=!1,this.el=Ext.get(e),this.render(this.el.dom.parentNode)},addClass:function(e){return this.el?this.el.addClass(e):this.cls=this.cls?this.cls+" "+e:e,this},removeClass:function(e){return this.el?this.el.removeClass(e):this.cls&&(this.cls=this.cls.split(" ").remove(e).join(" ")),this},onRender:function(e,t){if(!this.el&&this.autoEl){if(Ext.isString(this.autoEl))this.el=document.createElement(this.autoEl);else{var i=document.createElement("div");Ext.DomHelper.overwrite(i,this.autoEl),this.el=i.firstChild}this.el.id||(this.el.id=this.getId())}this.el&&(this.el=Ext.get(this.el),this.allowDomMove!==!1&&(e.dom.insertBefore(this.el.dom,t),i&&(Ext.removeNode(i),i=null)))},getAutoCreate:function(){var e=Ext.isObject(this.autoCreate)?this.autoCreate:Ext.apply({},this.defaultAutoCreate);return this.id&&!e.id&&(e.id=this.id),e},afterRender:Ext.emptyFn,destroy:function(){this.isDestroyed||this.fireEvent("beforedestroy",this)!==!1&&(this.destroying=!0,this.beforeDestroy(),this.ownerCt&&this.ownerCt.remove&&this.ownerCt.remove(this,!1),this.rendered&&(this.el.remove(),("container"==this.actionMode||"container"==this.removeMode)&&this.container.remove()),this.focusTask&&this.focusTask.cancel&&this.focusTask.cancel(),this.onDestroy(),Ext.ComponentMgr.unregister(this),this.fireEvent("destroy",this),this.purgeListeners(),this.destroying=!1,this.isDestroyed=!0)},deleteMembers:function(){for(var e=arguments,t=0,i=e.length;i>t;++t)delete this[e[t]]},beforeDestroy:Ext.emptyFn,onDestroy:Ext.emptyFn,getEl:function(){return this.el},getContentTarget:function(){return this.el},getId:function(){return this.id||(this.id="ext-comp-"+ ++Ext.Component.AUTO_ID)},getItemId:function(){return this.itemId||this.getId()},focus:function(e,t){return t?(this.focusTask=new Ext.util.DelayedTask(this.focus,this,[e,!1]),this.focusTask.delay(Ext.isNumber(t)?t:10),this):(this.rendered&&!this.isDestroyed&&(this.el.focus(),e===!0&&this.el.dom.select()),this)},blur:function(){return this.rendered&&this.el.blur(),this},disable:function(e){return this.rendered&&this.onDisable(),this.disabled=!0,e!==!0&&this.fireEvent("disable",this),this},onDisable:function(){this.getActionEl().addClass(this.disabledClass),this.el.dom.disabled=!0},enable:function(){return this.rendered&&this.onEnable(),this.disabled=!1,this.fireEvent("enable",this),this},onEnable:function(){this.getActionEl().removeClass(this.disabledClass),this.el.dom.disabled=!1},setDisabled:function(e){return this[e?"disable":"enable"]()},show:function(){return this.fireEvent("beforeshow",this)!==!1&&(this.hidden=!1,this.autoRender&&this.render(Ext.isBoolean(this.autoRender)?Ext.getBody():this.autoRender),this.rendered&&this.onShow(),this.fireEvent("show",this)),this},onShow:function(){this.getVisibilityEl().removeClass("x-hide-"+this.hideMode)},hide:function(){return this.fireEvent("beforehide",this)!==!1&&(this.doHide(),this.fireEvent("hide",this)),this},doHide:function(){this.hidden=!0,this.rendered&&this.onHide()},onHide:function(){this.getVisibilityEl().addClass("x-hide-"+this.hideMode)},getVisibilityEl:function(){return this.hideParent?this.container:this.getActionEl()},setVisible:function(e){return this[e?"show":"hide"]()},isVisible:function(){return this.rendered&&this.getVisibilityEl().isVisible()},cloneConfig:function(e){e=e||{};var t=e.id||Ext.id(),i=Ext.applyIf(e,this.initialConfig);return i.id=t,new this.constructor(i)},getXType:function(){return this.constructor.xtype},isXType:function(e,t){return Ext.isFunction(e)?e=e.xtype:Ext.isObject(e)&&(e=e.constructor.xtype),t?this.constructor.xtype==e:-1!=("/"+this.getXTypes()+"/").indexOf("/"+e+"/")},getXTypes:function(){var e=this.constructor;if(!e.xtypes){for(var t=[],i=this;i&&i.constructor.xtype;)t.unshift(i.constructor.xtype),i=i.constructor.superclass;e.xtypeChain=t,e.xtypes=t.join("/")}return e.xtypes},findParentBy:function(e){for(var t=this.ownerCt;null!=t&&!e(t,this);t=t.ownerCt);return t||null},findParentByType:function(e,t){return this.findParentBy(function(i){return i.isXType(e,t)})},bubble:function(e,t,i){for(var s=this;s&&e.apply(t||s,i||[s])!==!1;)s=s.ownerCt;return this},getPositionEl:function(){return this.positionEl||this.el},purgeListeners:function(){Ext.Component.superclass.purgeListeners.call(this),this.mons&&this.on("beforedestroy",this.clearMons,this,{single:!0})},clearMons:function(){Ext.each(this.mons,function(e){e.item.un(e.ename,e.fn,e.scope)},this),this.mons=[]},createMons:function(){this.mons||(this.mons=[],this.on("beforedestroy",this.clearMons,this,{single:!0}))},mon:function(e,t,i,s,n){if(this.createMons(),Ext.isObject(t)){var r=/^(?:scope|delay|buffer|single|stopEvent|preventDefault|stopPropagation|normalized|args|delegate)$/,a=t;for(var o in a)r.test(o)||(Ext.isFunction(a[o])?(this.mons.push({item:e,ename:o,fn:a[o],scope:a.scope}),e.on(o,a[o],a.scope,a)):(this.mons.push({item:e,ename:o,fn:a[o],scope:a.scope}),e.on(o,a[o])))}else this.mons.push({item:e,ename:t,fn:i,scope:s}),e.on(t,i,s,n)},mun:function(e,t,i,s){var n,r;this.createMons();for(var a=0,o=this.mons.length;o>a;++a)if(r=this.mons[a],e===r.item&&t==r.ename&&i===r.fn&&s===r.scope){this.mons.splice(a,1),e.un(t,i,s),n=!0;break}return n},nextSibling:function(){if(this.ownerCt){var e=this.ownerCt.items.indexOf(this);if(-1!=e&&e+1<this.ownerCt.items.getCount())return this.ownerCt.items.itemAt(e+1)}return null},previousSibling:function(){if(this.ownerCt){var e=this.ownerCt.items.indexOf(this);if(e>0)return this.ownerCt.items.itemAt(e-1)}return null},getBubbleTarget:function(){return this.ownerCt}}),Ext.reg("component",Ext.Component),Ext.Action=Ext.extend(Object,{constructor:function(e){this.initialConfig=e,this.itemId=e.itemId=e.itemId||e.id||Ext.id(),this.items=[]},isAction:!0,setText:function(e){this.initialConfig.text=e,this.callEach("setText",[e])},getText:function(){return this.initialConfig.text},setIconClass:function(e){this.initialConfig.iconCls=e,this.callEach("setIconClass",[e])},getIconClass:function(){return this.initialConfig.iconCls},setDisabled:function(e){this.initialConfig.disabled=e,this.callEach("setDisabled",[e])},enable:function(){this.setDisabled(!1)},disable:function(){this.setDisabled(!0)},isDisabled:function(){return this.initialConfig.disabled},setHidden:function(e){this.initialConfig.hidden=e,this.callEach("setVisible",[!e])},show:function(){this.setHidden(!1)},hide:function(){this.setHidden(!0)},isHidden:function(){return this.initialConfig.hidden},setHandler:function(e,t){this.initialConfig.handler=e,this.initialConfig.scope=t,this.callEach("setHandler",[e,t])},each:function(e,t){Ext.each(this.items,e,t)},callEach:function(e,t){for(var i=this.items,s=0,n=i.length;n>s;s++)i[s][e].apply(i[s],t)},addComponent:function(e){this.items.push(e),e.on("destroy",this.removeComponent,this)},removeComponent:function(e){this.items.remove(e)},execute:function(){this.initialConfig.handler.apply(this.initialConfig.scope||window,arguments)}}),function(){Ext.Layer=function(e,t){e=e||{};var i=Ext.DomHelper,s=e.parentEl,n=s?Ext.getDom(s):document.body;if(t&&(this.dom=Ext.getDom(t)),!this.dom){var r=e.dh||{tag:"div",cls:"x-layer"};this.dom=i.append(n,r)}e.cls&&this.addClass(e.cls),this.constrain=e.constrain!==!1,this.setVisibilityMode(Ext.Element.VISIBILITY),this.id=e.id?this.dom.id=e.id:Ext.id(this.dom),this.zindex=e.zindex||this.getZIndex(),this.position("absolute",this.zindex),e.shadow?(this.shadowOffset=e.shadowOffset||4,this.shadow=new Ext.Shadow({offset:this.shadowOffset,mode:e.shadow})):this.shadowOffset=0,this.useShim=e.shim!==!1&&Ext.useShims,this.useDisplay=e.useDisplay,this.hide()
};var e=Ext.Element.prototype,t=[];Ext.extend(Ext.Layer,Ext.Element,{getZIndex:function(){return this.zindex||parseInt((this.getShim()||this).getStyle("z-index"),10)||11e3},getShim:function(){if(!this.useShim)return null;if(this.shim)return this.shim;var e=t.shift();e||(e=this.createShim(),e.enableDisplayMode("block"),e.dom.style.display="none",e.dom.style.visibility="visible");var i=this.dom.parentNode;return e.dom.parentNode!=i&&i.insertBefore(e.dom,this.dom),e.setStyle("z-index",this.getZIndex()-2),this.shim=e,e},hideShim:function(){this.shim&&(this.shim.setDisplayed(!1),t.push(this.shim),delete this.shim)},disableShadow:function(){this.shadow&&(this.shadowDisabled=!0,this.shadow.hide(),this.lastShadowOffset=this.shadowOffset,this.shadowOffset=0)},enableShadow:function(e){this.shadow&&(this.shadowDisabled=!1,Ext.isDefined(this.lastShadowOffset)&&(this.shadowOffset=this.lastShadowOffset,delete this.lastShadowOffset),e&&this.sync(!0))},sync:function(e){var t=this.shadow;if(!this.updating&&this.isVisible()&&(t||this.useShim)){var i=this.getShim(),s=this.getWidth(),n=this.getHeight(),r=this.getLeft(!0),a=this.getTop(!0);if(t&&!this.shadowDisabled){if(e&&!t.isVisible()?t.show(this):t.realign(r,a,s,n),i){e&&i.show();var o=t.el.getXY(),l=i.dom.style,h=t.el.getSize();l.left=o[0]+"px",l.top=o[1]+"px",l.width=h.width+"px",l.height=h.height+"px"}}else i&&(e&&i.show(),i.setSize(s,n),i.setLeftTop(r,a))}},destroy:function(){this.hideShim(),this.shadow&&this.shadow.hide(),this.removeAllListeners(),Ext.removeNode(this.dom),delete this.dom},remove:function(){this.destroy()},beginUpdate:function(){this.updating=!0},endUpdate:function(){this.updating=!1,this.sync(!0)},hideUnders:function(){this.shadow&&this.shadow.hide(),this.hideShim()},constrainXY:function(){if(this.constrain){var t=Ext.lib.Dom.getViewWidth(),i=Ext.lib.Dom.getViewHeight(),s=Ext.getDoc().getScroll(),n=this.getXY(),r=n[0],a=n[1],o=this.shadowOffset,l=this.dom.offsetWidth+o,h=this.dom.offsetHeight+o,u=!1;if(r+l>t+s.left&&(r=t-l-o,u=!0),a+h>i+s.top&&(a=i-h-o,u=!0),r<s.left&&(r=s.left,u=!0),a<s.top&&(a=s.top,u=!0),u){if(this.avoidY){var c=this.avoidY;c>=a&&a+h>=c&&(a=c-h-5)}n=[r,a],this.storeXY(n),e.setXY.call(this,n),this.sync()}}return this},getConstrainOffset:function(){return this.shadowOffset},isVisible:function(){return this.visible},showAction:function(){this.visible=!0,this.useDisplay===!0?this.setDisplayed(""):this.lastXY?e.setXY.call(this,this.lastXY):this.lastLT&&e.setLeftTop.call(this,this.lastLT[0],this.lastLT[1])},hideAction:function(){this.visible=!1,this.useDisplay===!0?this.setDisplayed(!1):this.setLeftTop(-1e4,-1e4)},setVisible:function(t,i,s,n,r){if(t&&this.showAction(),i&&t){var a=function(){this.sync(!0),n&&n()}.createDelegate(this);e.setVisible.call(this,!0,!0,s,a,r)}else{t||this.hideUnders(!0);var a=n;i&&(a=function(){this.hideAction(),n&&n()}.createDelegate(this)),e.setVisible.call(this,t,i,s,a,r),t?this.sync(!0):i||this.hideAction()}return this},storeXY:function(e){delete this.lastLT,this.lastXY=e},storeLeftTop:function(e,t){delete this.lastXY,this.lastLT=[e,t]},beforeFx:function(){return this.beforeAction(),Ext.Layer.superclass.beforeFx.apply(this,arguments)},afterFx:function(){Ext.Layer.superclass.afterFx.apply(this,arguments),this.sync(this.isVisible())},beforeAction:function(){!this.updating&&this.shadow&&this.shadow.hide()},setLeft:function(t){return this.storeLeftTop(t,this.getTop(!0)),e.setLeft.apply(this,arguments),this.sync(),this},setTop:function(t){return this.storeLeftTop(this.getLeft(!0),t),e.setTop.apply(this,arguments),this.sync(),this},setLeftTop:function(t,i){return this.storeLeftTop(t,i),e.setLeftTop.apply(this,arguments),this.sync(),this},setXY:function(t,i,s,n,r){this.fixDisplay(),this.beforeAction(),this.storeXY(t);var a=this.createCB(n);return e.setXY.call(this,t,i,s,a,r),i||a(),this},createCB:function(e){var t=this;return function(){t.constrainXY(),t.sync(!0),e&&e()}},setX:function(e,t,i,s,n){return this.setXY([e,this.getY()],t,i,s,n),this},setY:function(e,t,i,s,n){return this.setXY([this.getX(),e],t,i,s,n),this},setSize:function(t,i,s,n,r,a){this.beforeAction();var o=this.createCB(r);return e.setSize.call(this,t,i,s,n,o,a),s||o(),this},setWidth:function(t,i,s,n,r){this.beforeAction();var a=this.createCB(n);return e.setWidth.call(this,t,i,s,a,r),i||a(),this},setHeight:function(t,i,s,n,r){this.beforeAction();var a=this.createCB(n);return e.setHeight.call(this,t,i,s,a,r),i||a(),this},setBounds:function(t,i,s,n,r,a,o,l){this.beforeAction();var h=this.createCB(o);return r?e.setBounds.call(this,t,i,s,n,r,a,h,l):(this.storeXY([t,i]),e.setXY.call(this,[t,i]),e.setSize.call(this,s,n,r,a,h,l),h()),this},setZIndex:function(e){return this.zindex=e,this.setStyle("z-index",e+2),this.shadow&&this.shadow.setZIndex(e+1),this.shim&&this.shim.setStyle("z-index",e),this}})}(),Ext.Shadow=function(e){Ext.apply(this,e),"string"!=typeof this.mode&&(this.mode=this.defaultMode);var t=this.offset,i={h:0},s=Math.floor(this.offset/2);switch(this.mode.toLowerCase()){case"drop":i.w=0,i.l=i.t=t,i.t-=1,Ext.isIE&&(i.l-=this.offset+s,i.t-=this.offset+s,i.w-=s,i.h-=s,i.t+=1);break;case"sides":i.w=2*t,i.l=-t,i.t=t-1,Ext.isIE&&(i.l-=this.offset-s,i.t-=this.offset+s,i.l+=1,i.w-=2*(this.offset-s),i.w-=s+1,i.h-=1);break;case"frame":i.w=i.h=2*t,i.l=i.t=-t,i.t+=1,i.h-=2,Ext.isIE&&(i.l-=this.offset-s,i.t-=this.offset-s,i.l+=1,i.w-=this.offset+s+1,i.h-=this.offset+s,i.h+=1)}this.adjusts=i},Ext.Shadow.prototype={offset:4,defaultMode:"drop",show:function(e){e=Ext.get(e),this.el||(this.el=Ext.Shadow.Pool.pull(),this.el.dom.nextSibling!=e.dom&&this.el.insertBefore(e)),this.el.setStyle("z-index",this.zIndex||parseInt(e.getStyle("z-index"),10)-1),Ext.isIE&&(this.el.dom.style.filter="progid:DXImageTransform.Microsoft.alpha(opacity=50) progid:DXImageTransform.Microsoft.Blur(pixelradius="+this.offset+")"),this.realign(e.getLeft(!0),e.getTop(!0),e.getWidth(),e.getHeight()),this.el.dom.style.display="block"},isVisible:function(){return this.el?!0:!1},realign:function(e,t,i,s){if(this.el){var n,r,a=this.adjusts,o=this.el.dom,l=o.style,h=i+a.w,u=s+a.h,c=h+"px",d=u+"px";l.left=e+a.l+"px",l.top=t+a.t+"px",(l.width!=c||l.height!=d)&&(l.width=c,l.height=d,Ext.isIE||(n=o.childNodes,r=Math.max(0,h-12)+"px",n[0].childNodes[1].style.width=r,n[1].childNodes[1].style.width=r,n[2].childNodes[1].style.width=r,n[1].style.height=Math.max(0,u-12)+"px"))}},hide:function(){this.el&&(this.el.dom.style.display="none",Ext.Shadow.Pool.push(this.el),delete this.el)},setZIndex:function(e){this.zIndex=e,this.el&&this.el.setStyle("z-index",e)}},Ext.Shadow.Pool=function(){var e=[],t=Ext.isIE?'<div class="x-ie-shadow"></div>':'<div class="x-shadow"><div class="xst"><div class="xstl"></div><div class="xstc"></div><div class="xstr"></div></div><div class="xsc"><div class="xsml"></div><div class="xsmc"></div><div class="xsmr"></div></div><div class="xsb"><div class="xsbl"></div><div class="xsbc"></div><div class="xsbr"></div></div></div>';return{pull:function(){var i=e.shift();return i||(i=Ext.get(Ext.DomHelper.insertHtml("beforeBegin",document.body.firstChild,t)),i.autoBoxAdjust=!1),i},push:function(t){e.push(t)}}}(),Ext.BoxComponent=Ext.extend(Ext.Component,{initComponent:function(){Ext.BoxComponent.superclass.initComponent.call(this),this.addEvents("resize","move")},boxReady:!1,deferHeight:!1,setSize:function(e,t){if("object"==typeof e&&(t=e.height,e=e.width),Ext.isDefined(e)&&Ext.isDefined(this.boxMinWidth)&&e<this.boxMinWidth&&(e=this.boxMinWidth),Ext.isDefined(t)&&Ext.isDefined(this.boxMinHeight)&&t<this.boxMinHeight&&(t=this.boxMinHeight),Ext.isDefined(e)&&Ext.isDefined(this.boxMaxWidth)&&e>this.boxMaxWidth&&(e=this.boxMaxWidth),Ext.isDefined(t)&&Ext.isDefined(this.boxMaxHeight)&&t>this.boxMaxHeight&&(t=this.boxMaxHeight),!this.boxReady)return this.width=e,this.height=t,this;if(this.cacheSizes!==!1&&this.lastSize&&this.lastSize.width==e&&this.lastSize.height==t)return this;this.lastSize={width:e,height:t};var i,s=this.adjustSize(e,t),n=s.width,r=s.height;return(void 0!==n||void 0!==r)&&(i=this.getResizeEl(),this.deferHeight||void 0===n||void 0===r?this.deferHeight||void 0===r?void 0!==n&&i.setWidth(n):i.setHeight(r):i.setSize(n,r),this.onResize(n,r,e,t),this.fireEvent("resize",this,n,r,e,t)),this},setWidth:function(e){return this.setSize(e)},setHeight:function(e){return this.setSize(void 0,e)},getSize:function(){return this.getResizeEl().getSize()},getWidth:function(){return this.getResizeEl().getWidth()},getHeight:function(){return this.getResizeEl().getHeight()},getOuterSize:function(){var e=this.getResizeEl();return{width:e.getWidth()+e.getMargins("lr"),height:e.getHeight()+e.getMargins("tb")}},getPosition:function(e){var t=this.getPositionEl();return e===!0?[t.getLeft(!0),t.getTop(!0)]:this.xy||t.getXY()},getBox:function(e){var t=this.getPosition(e),i=this.getSize();return i.x=t[0],i.y=t[1],i},updateBox:function(e){return this.setSize(e.width,e.height),this.setPagePosition(e.x,e.y),this},getResizeEl:function(){return this.resizeEl||this.el},setAutoScroll:function(e){return this.rendered&&this.getContentTarget().setOverflow(e?"auto":""),this.autoScroll=e,this},setPosition:function(e,t){if(e&&"number"==typeof e[1]&&(t=e[1],e=e[0]),this.x=e,this.y=t,!this.boxReady)return this;var i=this.adjustPosition(e,t),s=i.x,n=i.y,r=this.getPositionEl();return(void 0!==s||void 0!==n)&&(void 0!==s&&void 0!==n?r.setLeftTop(s,n):void 0!==s?r.setLeft(s):void 0!==n&&r.setTop(n),this.onPosition(s,n),this.fireEvent("move",this,s,n)),this},setPagePosition:function(e,t){if(e&&"number"==typeof e[1]&&(t=e[1],e=e[0]),this.pageX=e,this.pageY=t,this.boxReady&&void 0!==e&&void 0!==t){var i=this.getPositionEl().translatePoints(e,t);return this.setPosition(i.left,i.top),this}},afterRender:function(){Ext.BoxComponent.superclass.afterRender.call(this),this.resizeEl&&(this.resizeEl=Ext.get(this.resizeEl)),this.positionEl&&(this.positionEl=Ext.get(this.positionEl)),this.boxReady=!0,Ext.isDefined(this.autoScroll)&&this.setAutoScroll(this.autoScroll),this.setSize(this.width,this.height),this.x||this.y?this.setPosition(this.x,this.y):(this.pageX||this.pageY)&&this.setPagePosition(this.pageX,this.pageY)},syncSize:function(){return delete this.lastSize,this.setSize(this.autoWidth?void 0:this.getResizeEl().getWidth(),this.autoHeight?void 0:this.getResizeEl().getHeight()),this},onResize:function(){},onPosition:function(){},adjustSize:function(e,t){return this.autoWidth&&(e="auto"),this.autoHeight&&(t="auto"),{width:e,height:t}},adjustPosition:function(e,t){return{x:e,y:t}}}),Ext.reg("box",Ext.BoxComponent),Ext.Spacer=Ext.extend(Ext.BoxComponent,{autoEl:"div"}),Ext.reg("spacer",Ext.Spacer),Ext.SplitBar=function(e,t,i,s,n){this.el=Ext.get(e,!0),this.el.dom.unselectable="on",this.resizingEl=Ext.get(t,!0),this.orientation=i||Ext.SplitBar.HORIZONTAL,this.minSize=0,this.maxSize=2e3,this.animate=!1,this.useShim=!1,this.shim=null,this.proxy=n?Ext.get(n).dom:Ext.SplitBar.createProxy(this.orientation),this.dd=new Ext.dd.DDProxy(this.el.dom.id,"XSplitBars",{dragElId:this.proxy.id}),this.dd.b4StartDrag=this.onStartProxyDrag.createDelegate(this),this.dd.endDrag=this.onEndProxyDrag.createDelegate(this),this.dragSpecs={},this.adapter=new Ext.SplitBar.BasicLayoutAdapter,this.adapter.init(this),this.orientation==Ext.SplitBar.HORIZONTAL?(this.placement=s||(this.el.getX()>this.resizingEl.getX()?Ext.SplitBar.LEFT:Ext.SplitBar.RIGHT),this.el.addClass("x-splitbar-h")):(this.placement=s||(this.el.getY()>this.resizingEl.getY()?Ext.SplitBar.TOP:Ext.SplitBar.BOTTOM),this.el.addClass("x-splitbar-v")),this.addEvents("resize","moved","beforeresize","beforeapply"),Ext.SplitBar.superclass.constructor.call(this)},Ext.extend(Ext.SplitBar,Ext.util.Observable,{onStartProxyDrag:function(e,t){this.fireEvent("beforeresize",this),this.overlay=Ext.DomHelper.append(document.body,{cls:"x-drag-overlay",html:"&#160;"},!0),this.overlay.unselectable(),this.overlay.setSize(Ext.lib.Dom.getViewWidth(!0),Ext.lib.Dom.getViewHeight(!0)),this.overlay.show(),Ext.get(this.proxy).setDisplayed("block");var i=this.adapter.getElementSize(this);this.activeMinSize=this.getMinimumSize(),this.activeMaxSize=this.getMaximumSize();var s=i-this.activeMinSize,n=Math.max(this.activeMaxSize-i,0);this.orientation==Ext.SplitBar.HORIZONTAL?(this.dd.resetConstraints(),this.dd.setXConstraint(this.placement==Ext.SplitBar.LEFT?s:n,this.placement==Ext.SplitBar.LEFT?n:s,this.tickSize),this.dd.setYConstraint(0,0)):(this.dd.resetConstraints(),this.dd.setXConstraint(0,0),this.dd.setYConstraint(this.placement==Ext.SplitBar.TOP?s:n,this.placement==Ext.SplitBar.TOP?n:s,this.tickSize)),this.dragSpecs.startSize=i,this.dragSpecs.startPoint=[e,t],Ext.dd.DDProxy.prototype.b4StartDrag.call(this.dd,e,t)},onEndProxyDrag:function(e){Ext.get(this.proxy).setDisplayed(!1);var t=Ext.lib.Event.getXY(e);this.overlay&&(Ext.destroy(this.overlay),delete this.overlay);var i;i=this.orientation==Ext.SplitBar.HORIZONTAL?this.dragSpecs.startSize+(this.placement==Ext.SplitBar.LEFT?t[0]-this.dragSpecs.startPoint[0]:this.dragSpecs.startPoint[0]-t[0]):this.dragSpecs.startSize+(this.placement==Ext.SplitBar.TOP?t[1]-this.dragSpecs.startPoint[1]:this.dragSpecs.startPoint[1]-t[1]),i=Math.min(Math.max(i,this.activeMinSize),this.activeMaxSize),i!=this.dragSpecs.startSize&&this.fireEvent("beforeapply",this,i)!==!1&&(this.adapter.setElementSize(this,i),this.fireEvent("moved",this,i),this.fireEvent("resize",this,i))},getAdapter:function(){return this.adapter},setAdapter:function(e){this.adapter=e,this.adapter.init(this)},getMinimumSize:function(){return this.minSize},setMinimumSize:function(e){this.minSize=e},getMaximumSize:function(){return this.maxSize},setMaximumSize:function(e){this.maxSize=e},setCurrentSize:function(e){var t=this.animate;this.animate=!1,this.adapter.setElementSize(this,e),this.animate=t},destroy:function(e){Ext.destroy(this.shim,Ext.get(this.proxy)),this.dd.unreg(),e&&this.el.remove(),this.purgeListeners()}}),Ext.SplitBar.createProxy=function(e){var t=new Ext.Element(document.createElement("div"));document.body.appendChild(t.dom),t.unselectable();var i="x-splitbar-proxy";return t.addClass(i+" "+(e==Ext.SplitBar.HORIZONTAL?i+"-h":i+"-v")),t.dom},Ext.SplitBar.BasicLayoutAdapter=function(){},Ext.SplitBar.BasicLayoutAdapter.prototype={init:function(){},getElementSize:function(e){return e.orientation==Ext.SplitBar.HORIZONTAL?e.resizingEl.getWidth():e.resizingEl.getHeight()},setElementSize:function(e,t,i){e.orientation==Ext.SplitBar.HORIZONTAL?e.animate?e.resizingEl.setWidth(t,!0,.1,i,"easeOut"):(e.resizingEl.setWidth(t),i&&i(e,t)):e.animate?e.resizingEl.setHeight(t,!0,.1,i,"easeOut"):(e.resizingEl.setHeight(t),i&&i(e,t))}},Ext.SplitBar.AbsoluteLayoutAdapter=function(e){this.basic=new Ext.SplitBar.BasicLayoutAdapter,this.container=Ext.get(e)},Ext.SplitBar.AbsoluteLayoutAdapter.prototype={init:function(e){this.basic.init(e)},getElementSize:function(e){return this.basic.getElementSize(e)},setElementSize:function(e,t){this.basic.setElementSize(e,t,this.moveSplitter.createDelegate(this,[e]))},moveSplitter:function(e){var t=Ext.SplitBar;switch(e.placement){case t.LEFT:e.el.setX(e.resizingEl.getRight());break;case t.RIGHT:e.el.setStyle("right",this.container.getWidth()-e.resizingEl.getLeft()+"px");break;case t.TOP:e.el.setY(e.resizingEl.getBottom());break;case t.BOTTOM:e.el.setY(e.resizingEl.getTop()-e.el.getHeight())}}},Ext.SplitBar.VERTICAL=1,Ext.SplitBar.HORIZONTAL=2,Ext.SplitBar.LEFT=1,Ext.SplitBar.RIGHT=2,Ext.SplitBar.TOP=3,Ext.SplitBar.BOTTOM=4,Ext.Container=Ext.extend(Ext.BoxComponent,{bufferResize:50,autoDestroy:!0,forceLayout:!1,defaultType:"panel",resizeEvent:"resize",bubbleEvents:["add","remove"],initComponent:function(){Ext.Container.superclass.initComponent.call(this),this.addEvents("afterlayout","beforeadd","beforeremove","add","remove");var e=this.items;e&&(delete this.items,this.add(e))},initItems:function(){this.items||(this.items=new Ext.util.MixedCollection(!1,this.getComponentId),this.getLayout())},setLayout:function(e){this.layout&&this.layout!=e&&this.layout.setContainer(null),this.layout=e,this.initItems(),e.setContainer(this)},afterRender:function(){if(Ext.Container.superclass.afterRender.call(this),this.layout||(this.layout="auto"),Ext.isObject(this.layout)&&!this.layout.layout&&(this.layoutConfig=this.layout,this.layout=this.layoutConfig.type),Ext.isString(this.layout)&&(this.layout=new(Ext.Container.LAYOUTS[this.layout.toLowerCase()])(this.layoutConfig)),this.setLayout(this.layout),void 0!==this.activeItem&&this.layout.setActiveItem){var e=this.activeItem;delete this.activeItem,this.layout.setActiveItem(e)}this.ownerCt||this.doLayout(!1,!0),this.monitorResize===!0&&Ext.EventManager.onWindowResize(this.doLayout,this,[!1])},getLayoutTarget:function(){return this.el},getComponentId:function(e){return e.getItemId()},add:function(e){this.initItems();var t=arguments.length>1;if(t||Ext.isArray(e)){var i=[];return Ext.each(t?arguments:e,function(e){i.push(this.add(e))},this),i}var s=this.lookupComponent(this.applyDefaults(e)),n=this.items.length;return this.fireEvent("beforeadd",this,s,n)!==!1&&this.onBeforeAdd(s)!==!1&&(this.items.add(s),s.onAdded(this,n),this.onAdd(s),this.fireEvent("add",this,s,n)),s},onAdd:function(){},onAdded:function(e,t){this.ownerCt=e,this.initRef(),this.cascade(function(e){e.initRef()}),this.fireEvent("added",this,e,t)},insert:function(e,t){var i,s,n=arguments,r=n.length,a=[];if(this.initItems(),r>2){for(i=r-1;i>=1;--i)a.push(this.insert(e,n[i]));return a}return s=this.lookupComponent(this.applyDefaults(t)),e=Math.min(e,this.items.length),this.fireEvent("beforeadd",this,s,e)!==!1&&this.onBeforeAdd(s)!==!1&&(s.ownerCt==this&&this.items.remove(s),this.items.insert(e,s),s.onAdded(this,e),this.onAdd(s),this.fireEvent("add",this,s,e)),s},applyDefaults:function(e){var t=this.defaults;return t&&(Ext.isFunction(t)&&(t=t.call(this,e)),Ext.isString(e)?(e=Ext.ComponentMgr.get(e),Ext.apply(e,t)):e.events?Ext.apply(e,t):Ext.applyIf(e.isAction?e.initialConfig:e,t)),e},onBeforeAdd:function(e){e.ownerCt&&e.ownerCt.remove(e,!1),this.hideBorders===!0&&(e.border=e.border===!0)},remove:function(e,t){this.initItems();var i=this.getComponent(e);return i&&this.fireEvent("beforeremove",this,i)!==!1&&(this.doRemove(i,t),this.fireEvent("remove",this,i)),i},onRemove:function(){},doRemove:function(e,t){var i=this.layout,s=i&&this.rendered;s&&i.onRemove(e),this.items.remove(e),e.onRemoved(),this.onRemove(e),(t===!0||t!==!1&&this.autoDestroy)&&e.destroy(),s&&i.afterRemove(e)},removeAll:function(e){this.initItems();var t,i=[],s=[];this.items.each(function(e){i.push(e)});for(var n=0,r=i.length;r>n;++n)t=i[n],this.remove(t,e),t.ownerCt!==this&&s.push(t);return s},getComponent:function(e){return Ext.isObject(e)&&(e=e.getItemId()),this.items.get(e)},lookupComponent:function(e){return Ext.isString(e)?Ext.ComponentMgr.get(e):e.events?e:this.createComponent(e)},createComponent:function(e,t){if(e.render)return e;var i=Ext.create(Ext.apply({ownerCt:this},e),t||this.defaultType);return delete i.initialConfig.ownerCt,delete i.ownerCt,i},canLayout:function(){var e=this.getVisibilityEl();return e&&e.dom&&!e.isStyle("display","none")},doLayout:function(e,t){var i=this.rendered,s=t||this.forceLayout;if(this.collapsed||!this.canLayout()){if(this.deferLayout=this.deferLayout||!e,!s)return;e=e&&!this.deferLayout}else delete this.deferLayout;if(i&&this.layout&&this.layout.layout(),e!==!0&&this.items)for(var n=this.items.items,r=0,a=n.length;a>r;r++){var o=n[r];o.doLayout&&o.doLayout(!1,s)}i&&this.onLayout(e,s),this.hasLayout=!0,delete this.forceLayout},onLayout:Ext.emptyFn,shouldBufferLayout:function(){var e=this.hasLayout;return this.ownerCt?e?!this.hasLayoutPending():!1:e},hasLayoutPending:function(){var e=!1;return this.ownerCt.bubble(function(t){return t.layoutPending?(e=!0,!1):void 0}),e},onShow:function(){Ext.Container.superclass.onShow.call(this),Ext.isDefined(this.deferLayout)&&(delete this.deferLayout,this.doLayout(!0))},getLayout:function(){if(!this.layout){var e=new Ext.layout.AutoLayout(this.layoutConfig);this.setLayout(e)}return this.layout},beforeDestroy:function(){var e;if(this.items)for(;e=this.items.first();)this.doRemove(e,!0);this.monitorResize&&Ext.EventManager.removeResizeListener(this.doLayout,this),Ext.destroy(this.layout),Ext.Container.superclass.beforeDestroy.call(this)},cascade:function(e,t,i){if(e.apply(t||this,i||[this])!==!1&&this.items)for(var s=this.items.items,n=0,r=s.length;r>n;n++)s[n].cascade?s[n].cascade(e,t,i):e.apply(t||s[n],i||[s[n]]);return this},findById:function(e){var t=null,i=this;return this.cascade(function(s){return i!=s&&s.id===e?(t=s,!1):void 0}),t},findByType:function(e,t){return this.findBy(function(i){return i.isXType(e,t)})},find:function(e,t){return this.findBy(function(i){return i[e]===t})},findBy:function(e,t){var i=[],s=this;return this.cascade(function(n){s!=n&&e.call(t||n,n,s)===!0&&i.push(n)}),i},get:function(e){return this.getComponent(e)}}),Ext.Container.LAYOUTS={},Ext.reg("container",Ext.Container),Ext.layout.ContainerLayout=Ext.extend(Object,{monitorResize:!1,activeItem:null,constructor:function(e){this.id=Ext.id(null,"ext-layout-"),Ext.apply(this,e)},type:"container",IEMeasureHack:function(e,t){var i,s,n,r,a=e.dom.childNodes,o=a.length,l=[];for(n=0;o>n;n++)i=a[n],s=Ext.get(i),s&&(l[n]=s.getStyle("display"),s.setStyle({display:"none"}));for(r=e?e.getViewSize(t):{},n=0;o>n;n++)i=a[n],s=Ext.get(i),s&&s.setStyle({display:l[n]});return r},getLayoutTargetSize:Ext.EmptyFn,layout:function(){var e=this.container,t=e.getLayoutTarget();this.hasLayout||Ext.isEmpty(this.targetCls)||t.addClass(this.targetCls),this.onLayout(e,t),e.fireEvent("afterlayout",e,this)},onLayout:function(e,t){this.renderAll(e,t)},isValidParent:function(e,t){return t&&e.getPositionEl().dom.parentNode==(t.dom||t)},renderAll:function(e,t){var i,s,n=e.items.items,r=n.length;for(i=0;r>i;i++)s=n[i],!s||s.rendered&&this.isValidParent(s,t)||this.renderItem(s,i,t)},renderItem:function(e,t,i){e&&(e.rendered?this.isValidParent(e,i)||(Ext.isNumber(t)&&(t=i.dom.childNodes[t]),i.dom.insertBefore(e.getPositionEl().dom,t||null),e.container=i,this.configureItem(e)):(e.render(i,t),this.configureItem(e)))},getRenderedItems:function(e){var t,i,s=e.getLayoutTarget(),n=e.items.items,r=n.length,a=[];for(t=0;r>t;t++)(i=n[t]).rendered&&this.isValidParent(i,s)&&i.shouldLayout!==!1&&a.push(i);return a},configureItem:function(e){if(this.extraCls){var t=e.getPositionEl?e.getPositionEl():e;t.addClass(this.extraCls)}e.doLayout&&this.forceLayout&&e.doLayout(),this.renderHidden&&e!=this.activeItem&&e.hide()},onRemove:function(e){if(this.activeItem==e&&delete this.activeItem,e.rendered&&this.extraCls){var t=e.getPositionEl?e.getPositionEl():e;t.removeClass(this.extraCls)}},afterRemove:function(e){e.removeRestore&&(e.removeMode="container",delete e.removeRestore)},onResize:function(){var e,t=this.container;t.collapsed||((e=t.bufferResize&&t.shouldBufferLayout())?(this.resizeTask||(this.resizeTask=new Ext.util.DelayedTask(this.runLayout,this),this.resizeBuffer=Ext.isNumber(e)?e:50),t.layoutPending=!0,this.resizeTask.delay(this.resizeBuffer)):this.runLayout())},runLayout:function(){var e=this.container;this.layout(),e.onLayout(),delete e.layoutPending},setContainer:function(e){if(this.monitorResize&&e!=this.container){var t=this.container;t&&t.un(t.resizeEvent,this.onResize,this),e&&e.on(e.resizeEvent,this.onResize,this)}this.container=e},parseMargins:function(e){Ext.isNumber(e)&&(e=e.toString());var t=e.split(" "),i=t.length;return 1==i?t[1]=t[2]=t[3]=t[0]:2==i?(t[2]=t[0],t[3]=t[1]):3==i&&(t[3]=t[1]),{top:parseInt(t[0],10)||0,right:parseInt(t[1],10)||0,bottom:parseInt(t[2],10)||0,left:parseInt(t[3],10)||0}},fieldTpl:function(){var e=new Ext.Template('<div class="x-form-item {itemCls}" tabIndex="-1">','<label for="{id}" style="{labelStyle}" class="x-form-item-label">{label}{labelSeparator}</label>','<div class="x-form-element" id="x-form-el-{id}" style="{elementStyle}">','</div><div class="{clearCls}"></div>',"</div>");return e.disableFormats=!0,e.compile()}(),destroy:function(){if(this.resizeTask&&this.resizeTask.cancel&&this.resizeTask.cancel(),this.container&&this.container.un(this.container.resizeEvent,this.onResize,this),!Ext.isEmpty(this.targetCls)){var e=this.container.getLayoutTarget();e&&e.removeClass(this.targetCls)}}}),Ext.layout.AutoLayout=Ext.extend(Ext.layout.ContainerLayout,{type:"auto",monitorResize:!0,onLayout:function(e,t){Ext.layout.AutoLayout.superclass.onLayout.call(this,e,t);var i,s,n=this.getRenderedItems(e),r=n.length;for(i=0;r>i;i++)s=n[i],s.doLayout&&s.doLayout(!0)}}),Ext.Container.LAYOUTS.auto=Ext.layout.AutoLayout,Ext.layout.FitLayout=Ext.extend(Ext.layout.ContainerLayout,{monitorResize:!0,type:"fit",getLayoutTargetSize:function(){var e=this.container.getLayoutTarget();return e?e.getStyleSize():{}},onLayout:function(e,t){Ext.layout.FitLayout.superclass.onLayout.call(this,e,t),e.collapsed||this.setItemSize(this.activeItem||e.items.itemAt(0),this.getLayoutTargetSize())},setItemSize:function(e,t){e&&t.height>0&&e.setSize(t)}}),Ext.Container.LAYOUTS.fit=Ext.layout.FitLayout,Ext.layout.CardLayout=Ext.extend(Ext.layout.FitLayout,{deferredRender:!1,layoutOnCardChange:!1,renderHidden:!0,type:"card",setActiveItem:function(e){var t=this.activeItem,i=this.container;if(e=i.getComponent(e),e&&t!=e){if(t){if(t.hide(),t.hidden!==!0)return!1;t.fireEvent("deactivate",t)}var s=e.doLayout&&(this.layoutOnCardChange||!e.rendered);this.activeItem=e,delete e.deferLayout,e.show(),this.layout(),s&&e.doLayout(),e.fireEvent("activate",e)}},renderAll:function(e,t){this.deferredRender?this.renderItem(this.activeItem,void 0,t):Ext.layout.CardLayout.superclass.renderAll.call(this,e,t)}}),Ext.Container.LAYOUTS.card=Ext.layout.CardLayout,Ext.layout.AnchorLayout=Ext.extend(Ext.layout.ContainerLayout,{monitorResize:!0,type:"anchor",defaultAnchor:"100%",parseAnchorRE:/^(r|right|b|bottom)$/i,getLayoutTargetSize:function(){var e=this.container.getLayoutTarget(),t={};return e&&(t=e.getViewSize(),Ext.isIE&&Ext.isStrict&&0==t.width&&(t=e.getStyleSize()),t.width-=e.getPadding("lr"),t.height-=e.getPadding("tb")),t},onLayout:function(e,t){Ext.layout.AnchorLayout.superclass.onLayout.call(this,e,t);var i,s,n,r,a,o,l,h,u,c,d=this.getLayoutTargetSize(),p=d.width,f=d.height,m=t.getStyle("overflow"),y=this.getRenderedItems(e),g=y.length,v=[];if(!(20>p&&20>f)){for(e.anchorSize?"number"==typeof e.anchorSize?s=e.anchorSize:(s=e.anchorSize.width,n=e.anchorSize.height):(s=e.initialConfig.width,n=e.initialConfig.height),u=0;g>u;u++)r=y[u],c=r.getPositionEl(),r.anchor||!r.items||Ext.isNumber(r.width)||Ext.isIE6&&Ext.isStrict||(r.anchor=this.defaultAnchor),r.anchor&&(a=r.anchorSpec,a||(h=r.anchor.split(" "),r.anchorSpec=a={right:this.parseAnchor(h[0],r.initialConfig.width,s),bottom:this.parseAnchor(h[1],r.initialConfig.height,n)}),o=a.right?this.adjustWidthAnchor(a.right(p)-c.getMargins("lr"),r):void 0,l=a.bottom?this.adjustHeightAnchor(a.bottom(f)-c.getMargins("tb"),r):void 0,(o||l)&&v.push({component:r,width:o||void 0,height:l||void 0}));for(u=0,g=v.length;g>u;u++)i=v[u],i.component.setSize(i.width,i.height);if(m&&"hidden"!=m&&!this.adjustmentPass){var x=this.getLayoutTargetSize();(x.width!=d.width||x.height!=d.height)&&(this.adjustmentPass=!0,this.onLayout(e,t))}delete this.adjustmentPass}},parseAnchor:function(e,t,i){if(e&&"none"!=e){var s;if(this.parseAnchorRE.test(e)){var n=i-t;return function(e){return e!==s?(s=e,e-n):void 0}}if(-1!=e.indexOf("%")){var r=.01*parseFloat(e.replace("%",""));return function(e){return e!==s?(s=e,Math.floor(e*r)):void 0}}if(e=parseInt(e,10),!isNaN(e))return function(t){return t!==s?(s=t,t+e):void 0}}return!1},adjustWidthAnchor:function(e){return e},adjustHeightAnchor:function(e){return e}}),Ext.Container.LAYOUTS.anchor=Ext.layout.AnchorLayout,Ext.layout.ColumnLayout=Ext.extend(Ext.layout.ContainerLayout,{monitorResize:!0,type:"column",extraCls:"x-column",scrollOffset:0,targetCls:"x-column-layout-ct",isValidParent:function(e){return this.innerCt&&e.getPositionEl().dom.parentNode==this.innerCt.dom},getLayoutTargetSize:function(){var e,t=this.container.getLayoutTarget();return t&&(e=t.getViewSize(),Ext.isIE&&Ext.isStrict&&0==e.width&&(e=t.getStyleSize()),e.width-=t.getPadding("lr"),e.height-=t.getPadding("tb")),e},renderAll:function(e,t){this.innerCt||(this.innerCt=t.createChild({cls:"x-column-inner"}),this.innerCt.createChild({cls:"x-clear"})),Ext.layout.ColumnLayout.superclass.renderAll.call(this,e,this.innerCt)},onLayout:function(e,t){var i,s,n,r=e.items.items,a=r.length,o=[];this.renderAll(e,t);var l=this.getLayoutTargetSize();if(!(l.width<1&&l.height<1)){var h=l.width-this.scrollOffset,u=(l.height,h);for(this.innerCt.setWidth(h),s=0;a>s;s++)i=r[s],n=i.getPositionEl().getMargins("lr"),o[s]=n,i.columnWidth||(u-=i.getWidth()+n);for(u=0>u?0:u,s=0;a>s;s++)i=r[s],n=o[s],i.columnWidth&&i.setSize(Math.floor(i.columnWidth*u)-n);if(Ext.isIE&&(s=t.getStyle("overflow")&&"hidden"!=s&&!this.adjustmentPass)){var c=this.getLayoutTargetSize();c.width!=l.width&&(this.adjustmentPass=!0,this.onLayout(e,t))}delete this.adjustmentPass}}}),Ext.Container.LAYOUTS.column=Ext.layout.ColumnLayout,Ext.layout.BorderLayout=Ext.extend(Ext.layout.ContainerLayout,{monitorResize:!0,rendered:!1,type:"border",targetCls:"x-border-layout-ct",getLayoutTargetSize:function(){var e=this.container.getLayoutTarget();return e?e.getViewSize():{}},onLayout:function(e,t){var i,s,n,r,a=e.items.items,o=a.length;if(!this.rendered){for(i=[],s=0;o>s;s++)n=a[s],r=n.region,n.collapsed&&i.push(n),n.collapsed=!1,n.rendered||(n.render(t,s),n.getPositionEl().addClass("x-border-panel")),this[r]="center"!=r&&n.split?new Ext.layout.BorderLayout.SplitRegion(this,n.initialConfig,r):new Ext.layout.BorderLayout.Region(this,n.initialConfig,r),this[r].render(t,n);this.rendered=!0}var l=this.getLayoutTargetSize();if(l.width<20||l.height<20)return i&&(this.restoreCollapsed=i),void 0;this.restoreCollapsed&&(i=this.restoreCollapsed,delete this.restoreCollapsed);var h,u,c,d,p=l.width,f=l.height,m=p,y=f,g=0,v=0,x=this.north,E=this.south,b=this.west,L=this.east,n=this.center;if(!n&&Ext.layout.BorderLayout.WARN!==!1)throw"No center region defined in BorderLayout "+e.id;if(x&&x.isVisible()&&(h=x.getSize(),u=x.getMargins(),h.width=p-(u.left+u.right),h.x=u.left,h.y=u.top,g=h.height+h.y+u.bottom,y-=g,x.applyLayout(h)),E&&E.isVisible()&&(h=E.getSize(),u=E.getMargins(),h.width=p-(u.left+u.right),h.x=u.left,d=h.height+u.top+u.bottom,h.y=f-d+u.top,y-=d,E.applyLayout(h)),b&&b.isVisible()&&(h=b.getSize(),u=b.getMargins(),h.height=y-(u.top+u.bottom),h.x=u.left,h.y=g+u.top,c=h.width+u.left+u.right,v+=c,m-=c,b.applyLayout(h)),L&&L.isVisible()&&(h=L.getSize(),u=L.getMargins(),h.height=y-(u.top+u.bottom),c=h.width+u.left+u.right,h.x=p-c+u.left,h.y=g+u.top,m-=c,L.applyLayout(h)),n){u=n.getMargins();var S={x:v+u.left,y:g+u.top,width:m-(u.left+u.right),height:y-(u.top+u.bottom)};n.applyLayout(S)}if(i)for(s=0,o=i.length;o>s;s++)i[s].collapse(!1);if(Ext.isIE&&Ext.isStrict&&t.repaint(),s=t.getStyle("overflow")&&"hidden"!=s&&!this.adjustmentPass){var C=this.getLayoutTargetSize();(C.width!=l.width||C.height!=l.height)&&(this.adjustmentPass=!0,this.onLayout(e,t))}delete this.adjustmentPass},destroy:function(){var e,t,i=["north","south","east","west"];for(e=0;e<i.length;e++)t=this[i[e]],t&&(t.destroy?t.destroy():t.split&&t.split.destroy(!0));Ext.layout.BorderLayout.superclass.destroy.call(this)}}),Ext.layout.BorderLayout.Region=function(e,t,i){Ext.apply(this,t),this.layout=e,this.position=i,this.state={},"string"==typeof this.margins&&(this.margins=this.layout.parseMargins(this.margins)),this.margins=Ext.applyIf(this.margins||{},this.defaultMargins),this.collapsible&&("string"==typeof this.cmargins&&(this.cmargins=this.layout.parseMargins(this.cmargins)),this.cmargins="mini"!=this.collapseMode||this.cmargins?Ext.applyIf(this.cmargins||{},"north"==i||"south"==i?this.defaultNSCMargins:this.defaultEWCMargins):{left:0,top:0,right:0,bottom:0})},Ext.layout.BorderLayout.Region.prototype={collapsible:!1,split:!1,floatable:!0,minWidth:50,minHeight:50,defaultMargins:{left:0,top:0,right:0,bottom:0},defaultNSCMargins:{left:5,top:5,right:5,bottom:5},defaultEWCMargins:{left:5,top:0,right:5,bottom:0},floatingZIndex:100,isCollapsed:!1,render:function(e,t){this.panel=t,t.el.enableDisplayMode(),this.targetEl=e,this.el=t.el;var i=t.getState,s=this.position;t.getState=function(){return Ext.apply(i.call(t)||{},this.state)}.createDelegate(this),"center"!=s&&(t.allowQueuedExpand=!1,t.on({beforecollapse:this.beforeCollapse,collapse:this.onCollapse,beforeexpand:this.beforeExpand,expand:this.onExpand,hide:this.onHide,show:this.onShow,scope:this}),(this.collapsible||this.floatable)&&(t.collapseEl="el",t.slideAnchor=this.getSlideAnchor()),t.tools&&t.tools.toggle&&(t.tools.toggle.addClass("x-tool-collapse-"+s),t.tools.toggle.addClassOnOver("x-tool-collapse-"+s+"-over")))
},getCollapsedEl:function(){if(!this.collapsedEl){if(!this.toolTemplate){var e=new Ext.Template('<div class="x-tool x-tool-{id}">&#160;</div>');e.disableFormats=!0,e.compile(),Ext.layout.BorderLayout.Region.prototype.toolTemplate=e}if(this.collapsedEl=this.targetEl.createChild({cls:"x-layout-collapsed x-layout-collapsed-"+this.position,id:this.panel.id+"-xcollapsed"}),this.collapsedEl.enableDisplayMode("block"),"mini"==this.collapseMode)this.collapsedEl.addClass("x-layout-cmini-"+this.position),this.miniCollapsedEl=this.collapsedEl.createChild({cls:"x-layout-mini x-layout-mini-"+this.position,html:"&#160;"}),this.miniCollapsedEl.addClassOnOver("x-layout-mini-over"),this.collapsedEl.addClassOnOver("x-layout-collapsed-over"),this.collapsedEl.on("click",this.onExpandClick,this,{stopEvent:!0});else{if(this.collapsible!==!1&&!this.hideCollapseTool){var t=this.expandToolEl=this.toolTemplate.append(this.collapsedEl.dom,{id:"expand-"+this.position},!0);t.addClassOnOver("x-tool-expand-"+this.position+"-over"),t.on("click",this.onExpandClick,this,{stopEvent:!0})}(this.floatable!==!1||this.titleCollapse)&&(this.collapsedEl.addClassOnOver("x-layout-collapsed-over"),this.collapsedEl.on("click",this[this.floatable?"collapseClick":"onExpandClick"],this))}}return this.collapsedEl},onExpandClick:function(){this.isSlid?this.panel.expand(!1):this.panel.expand()},onCollapseClick:function(){this.panel.collapse()},beforeCollapse:function(e,t){this.lastAnim=t,this.splitEl&&this.splitEl.hide(),this.getCollapsedEl().show();var i=this.panel.getEl();this.originalZIndex=i.getStyle("z-index"),i.setStyle("z-index",100),this.isCollapsed=!0,this.layout.layout()},onCollapse:function(){this.panel.el.setStyle("z-index",1),this.lastAnim===!1||this.panel.animCollapse===!1?this.getCollapsedEl().dom.style.visibility="visible":this.getCollapsedEl().slideIn(this.panel.slideAnchor,{duration:.2}),this.state.collapsed=!0,this.panel.saveState()},beforeExpand:function(){this.isSlid&&this.afterSlideIn();var e=this.getCollapsedEl();this.el.show(),"east"==this.position||"west"==this.position?this.panel.setSize(void 0,e.getHeight()):this.panel.setSize(e.getWidth(),void 0),e.hide(),e.dom.style.visibility="hidden",this.panel.el.setStyle("z-index",this.floatingZIndex)},onExpand:function(){this.isCollapsed=!1,this.splitEl&&this.splitEl.show(),this.layout.layout(),this.panel.el.setStyle("z-index",this.originalZIndex),this.state.collapsed=!1,this.panel.saveState()},collapseClick:function(e){this.isSlid?(e.stopPropagation(),this.slideIn()):(e.stopPropagation(),this.slideOut())},onHide:function(){this.isCollapsed?this.getCollapsedEl().hide():this.splitEl&&this.splitEl.hide()},onShow:function(){this.isCollapsed?this.getCollapsedEl().show():this.splitEl&&this.splitEl.show()},isVisible:function(){return!this.panel.hidden},getMargins:function(){return this.isCollapsed&&this.cmargins?this.cmargins:this.margins},getSize:function(){return this.isCollapsed?this.getCollapsedEl().getSize():this.panel.getSize()},setPanel:function(e){this.panel=e},getMinWidth:function(){return this.minWidth},getMinHeight:function(){return this.minHeight},applyLayoutCollapsed:function(e){var t=this.getCollapsedEl();t.setLeftTop(e.x,e.y),t.setSize(e.width,e.height)},applyLayout:function(e){this.isCollapsed?this.applyLayoutCollapsed(e):(this.panel.setPosition(e.x,e.y),this.panel.setSize(e.width,e.height))},beforeSlide:function(){this.panel.beforeEffect()},afterSlide:function(){this.panel.afterEffect()},initAutoHide:function(){this.autoHide!==!1&&(this.autoHideHd||(this.autoHideSlideTask=new Ext.util.DelayedTask(this.slideIn,this),this.autoHideHd={mouseout:function(e){e.within(this.el,!0)||this.autoHideSlideTask.delay(500)},mouseover:function(){this.autoHideSlideTask.cancel()},scope:this}),this.el.on(this.autoHideHd),this.collapsedEl.on(this.autoHideHd))},clearAutoHide:function(){this.autoHide!==!1&&(this.el.un("mouseout",this.autoHideHd.mouseout),this.el.un("mouseover",this.autoHideHd.mouseover),this.collapsedEl.un("mouseout",this.autoHideHd.mouseout),this.collapsedEl.un("mouseover",this.autoHideHd.mouseover))},clearMonitor:function(){Ext.getDoc().un("click",this.slideInIf,this)},slideOut:function(){if(!this.isSlid&&!this.el.hasActiveFx()){this.isSlid=!0;var e,t,i=this.panel.tools;i&&i.toggle&&i.toggle.hide(),this.el.show(),t=this.panel.collapsed,this.panel.collapsed=!1,"east"==this.position||"west"==this.position?(e=this.panel.deferHeight,this.panel.deferHeight=!1,this.panel.setSize(void 0,this.collapsedEl.getHeight()),this.panel.deferHeight=e):this.panel.setSize(this.collapsedEl.getWidth(),void 0),this.panel.collapsed=t,this.restoreLT=[this.el.dom.style.left,this.el.dom.style.top],this.el.alignTo(this.collapsedEl,this.getCollapseAnchor()),this.el.setStyle("z-index",this.floatingZIndex+2),this.panel.el.replaceClass("x-panel-collapsed","x-panel-floating"),this.animFloat!==!1?(this.beforeSlide(),this.el.slideIn(this.getSlideAnchor(),{callback:function(){this.afterSlide(),this.initAutoHide(),Ext.getDoc().on("click",this.slideInIf,this)},scope:this,block:!0})):(this.initAutoHide(),Ext.getDoc().on("click",this.slideInIf,this))}},afterSlideIn:function(){this.clearAutoHide(),this.isSlid=!1,this.clearMonitor(),this.el.setStyle("z-index",""),this.panel.el.replaceClass("x-panel-floating","x-panel-collapsed"),this.el.dom.style.left=this.restoreLT[0],this.el.dom.style.top=this.restoreLT[1];var e=this.panel.tools;e&&e.toggle&&e.toggle.show()},slideIn:function(e){return!this.isSlid||this.el.hasActiveFx()?(Ext.callback(e),void 0):(this.isSlid=!1,this.animFloat!==!1?(this.beforeSlide(),this.el.slideOut(this.getSlideAnchor(),{callback:function(){this.el.hide(),this.afterSlide(),this.afterSlideIn(),Ext.callback(e)},scope:this,block:!0})):(this.el.hide(),this.afterSlideIn()),void 0)},slideInIf:function(e){e.within(this.el)||this.slideIn()},anchors:{west:"left",east:"right",north:"top",south:"bottom"},sanchors:{west:"l",east:"r",north:"t",south:"b"},canchors:{west:"tl-tr",east:"tr-tl",north:"tl-bl",south:"bl-tl"},getAnchor:function(){return this.anchors[this.position]},getCollapseAnchor:function(){return this.canchors[this.position]},getSlideAnchor:function(){return this.sanchors[this.position]},getAlignAdj:function(){switch(this.cmargins,this.position){case"west":return[0,0];case"east":return[0,0];case"north":return[0,0];case"south":return[0,0]}},getExpandAdj:function(){var e=this.collapsedEl,t=this.cmargins;switch(this.position){case"west":return[-(t.right+e.getWidth()+t.left),0];case"east":return[t.right+e.getWidth()+t.left,0];case"north":return[0,-(t.top+t.bottom+e.getHeight())];case"south":return[0,t.top+t.bottom+e.getHeight()]}},destroy:function(){this.autoHideSlideTask&&this.autoHideSlideTask.cancel&&this.autoHideSlideTask.cancel(),Ext.destroyMembers(this,"miniCollapsedEl","collapsedEl","expandToolEl")}},Ext.layout.BorderLayout.SplitRegion=function(e,t,i){Ext.layout.BorderLayout.SplitRegion.superclass.constructor.call(this,e,t,i),this.applyLayout=this.applyFns[i]},Ext.extend(Ext.layout.BorderLayout.SplitRegion,Ext.layout.BorderLayout.Region,{splitTip:"Drag to resize.",collapsibleSplitTip:"Drag to resize. Double click to hide.",useSplitTips:!1,splitSettings:{north:{orientation:Ext.SplitBar.VERTICAL,placement:Ext.SplitBar.TOP,maxFn:"getVMaxSize",minProp:"minHeight",maxProp:"maxHeight"},south:{orientation:Ext.SplitBar.VERTICAL,placement:Ext.SplitBar.BOTTOM,maxFn:"getVMaxSize",minProp:"minHeight",maxProp:"maxHeight"},east:{orientation:Ext.SplitBar.HORIZONTAL,placement:Ext.SplitBar.RIGHT,maxFn:"getHMaxSize",minProp:"minWidth",maxProp:"maxWidth"},west:{orientation:Ext.SplitBar.HORIZONTAL,placement:Ext.SplitBar.LEFT,maxFn:"getHMaxSize",minProp:"minWidth",maxProp:"maxWidth"}},applyFns:{west:function(e){if(this.isCollapsed)return this.applyLayoutCollapsed(e);var t=this.splitEl.dom,i=t.style;this.panel.setPosition(e.x,e.y);var s=t.offsetWidth;i.left=e.x+e.width-s+"px",i.top=e.y+"px",i.height=Math.max(0,e.height)+"px",this.panel.setSize(e.width-s,e.height)},east:function(e){if(this.isCollapsed)return this.applyLayoutCollapsed(e);var t=this.splitEl.dom,i=t.style,s=t.offsetWidth;this.panel.setPosition(e.x+s,e.y),i.left=e.x+"px",i.top=e.y+"px",i.height=Math.max(0,e.height)+"px",this.panel.setSize(e.width-s,e.height)},north:function(e){if(this.isCollapsed)return this.applyLayoutCollapsed(e);var t=this.splitEl.dom,i=t.style,s=t.offsetHeight;this.panel.setPosition(e.x,e.y),i.left=e.x+"px",i.top=e.y+e.height-s+"px",i.width=Math.max(0,e.width)+"px",this.panel.setSize(e.width,e.height-s)},south:function(e){if(this.isCollapsed)return this.applyLayoutCollapsed(e);var t=this.splitEl.dom,i=t.style,s=t.offsetHeight;this.panel.setPosition(e.x,e.y+s),i.left=e.x+"px",i.top=e.y+"px",i.width=Math.max(0,e.width)+"px",this.panel.setSize(e.width,e.height-s)}},render:function(e,t){Ext.layout.BorderLayout.SplitRegion.superclass.render.call(this,e,t);var i=this.position;this.splitEl=e.createChild({cls:"x-layout-split x-layout-split-"+i,html:"&#160;",id:this.panel.id+"-xsplit"}),"mini"==this.collapseMode&&(this.miniSplitEl=this.splitEl.createChild({cls:"x-layout-mini x-layout-mini-"+i,html:"&#160;"}),this.miniSplitEl.addClassOnOver("x-layout-mini-over"),this.miniSplitEl.on("click",this.onCollapseClick,this,{stopEvent:!0}));var s=this.splitSettings[i];this.split=new Ext.SplitBar(this.splitEl.dom,t.el,s.orientation),this.split.tickSize=this.tickSize,this.split.placement=s.placement,this.split.getMaximumSize=this[s.maxFn].createDelegate(this),this.split.minSize=this.minSize||this[s.minProp],this.split.on("beforeapply",this.onSplitMove,this),this.split.useShim=this.useShim===!0,this.maxSize=this.maxSize||this[s.maxProp],t.hidden&&this.splitEl.hide(),this.useSplitTips&&(this.splitEl.dom.title=this.collapsible?this.collapsibleSplitTip:this.splitTip),this.collapsible&&this.splitEl.on("dblclick",this.onCollapseClick,this)},getSize:function(){if(this.isCollapsed)return this.collapsedEl.getSize();var e=this.panel.getSize();return"north"==this.position||"south"==this.position?e.height+=this.splitEl.dom.offsetHeight:e.width+=this.splitEl.dom.offsetWidth,e},getHMaxSize:function(){var e=this.maxSize||1e4,t=this.layout.center;return Math.min(e,this.el.getWidth()+t.el.getWidth()-t.getMinWidth())},getVMaxSize:function(){var e=this.maxSize||1e4,t=this.layout.center;return Math.min(e,this.el.getHeight()+t.el.getHeight()-t.getMinHeight())},onSplitMove:function(e,t){var i=this.panel.getSize();return this.lastSplitSize=t,"north"==this.position||"south"==this.position?(this.panel.setSize(i.width,t),this.state.height=t):(this.panel.setSize(t,i.height),this.state.width=t),this.layout.layout(),this.panel.saveState(),!1},getSplitBar:function(){return this.split},destroy:function(){Ext.destroy(this.miniSplitEl,this.split,this.splitEl),Ext.layout.BorderLayout.SplitRegion.superclass.destroy.call(this)}}),Ext.Container.LAYOUTS.border=Ext.layout.BorderLayout,Ext.layout.FormLayout=Ext.extend(Ext.layout.AnchorLayout,{labelSeparator:":",trackLabels:!0,type:"form",onRemove:function(e){Ext.layout.FormLayout.superclass.onRemove.call(this,e),this.trackLabels&&(e.un("show",this.onFieldShow,this),e.un("hide",this.onFieldHide,this));var t=e.getPositionEl(),i=e.getItemCt&&e.getItemCt();e.rendered&&i&&(t&&t.dom&&t.insertAfter(i),Ext.destroy(i),Ext.destroyMembers(e,"label","itemCt"),e.customItemCt&&Ext.destroyMembers(e,"getItemCt","customItemCt"))},setContainer:function(e){if(Ext.layout.FormLayout.superclass.setContainer.call(this,e),e.labelAlign&&e.addClass("x-form-label-"+e.labelAlign),e.hideLabels)Ext.apply(this,{labelStyle:"display:none",elementStyle:"padding-left:0;",labelAdjust:0});else{if(this.labelSeparator=Ext.isDefined(e.labelSeparator)?e.labelSeparator:this.labelSeparator,e.labelWidth=e.labelWidth||100,Ext.isNumber(e.labelWidth)){var t=Ext.isNumber(e.labelPad)?e.labelPad:5;Ext.apply(this,{labelAdjust:e.labelWidth+t,labelStyle:"width:"+e.labelWidth+"px;",elementStyle:"padding-left:"+(e.labelWidth+t)+"px"})}"top"==e.labelAlign&&Ext.apply(this,{labelStyle:"width:auto;",labelAdjust:0,elementStyle:"padding-left:0;"})}},isHide:function(e){return e.hideLabel||this.container.hideLabels},onFieldShow:function(e){e.getItemCt().removeClass("x-hide-"+e.hideMode),e.isComposite&&e.doLayout()},onFieldHide:function(e){e.getItemCt().addClass("x-hide-"+e.hideMode)},getLabelStyle:function(e){for(var t="",i=[this.labelStyle,e],s=0,n=i.length;n>s;++s)i[s]&&(t+=i[s],";"!=t.substr(-1,1)&&(t+=";"));return t},renderItem:function(e,t,i){if(e&&(e.isFormField||e.fieldLabel)&&"hidden"!=e.inputType){var s=this.getTemplateArgs(e);Ext.isNumber(t)&&(t=i.dom.childNodes[t]||null),e.itemCt=t?this.fieldTpl.insertBefore(t,s,!0):this.fieldTpl.append(i,s,!0),e.getItemCt||Ext.apply(e,{getItemCt:function(){return e.itemCt},customItemCt:!0}),e.label=e.getItemCt().child("label.x-form-item-label"),e.rendered?this.isValidParent(e,i)||Ext.fly("x-form-el-"+e.id).appendChild(e.getPositionEl()):e.render("x-form-el-"+e.id),this.trackLabels&&(e.hidden&&this.onFieldHide(e),e.on({scope:this,show:this.onFieldShow,hide:this.onFieldHide})),this.configureItem(e)}else Ext.layout.FormLayout.superclass.renderItem.apply(this,arguments)},getTemplateArgs:function(e){var t=!e.fieldLabel||e.hideLabel,i=(e.itemCls||this.container.itemCls||"")+(e.hideLabel?" x-hide-label":"");return Ext.isIE9&&Ext.isIEQuirks&&e instanceof Ext.form.TextField&&(i+=" x-input-wrapper"),{id:e.id,label:e.fieldLabel,itemCls:i,clearCls:e.clearCls||"x-form-clear-left",labelStyle:this.getLabelStyle(e.labelStyle),elementStyle:this.elementStyle||"",labelSeparator:t?"":Ext.isDefined(e.labelSeparator)?e.labelSeparator:this.labelSeparator}},adjustWidthAnchor:function(e,t){if(t.label&&!this.isHide(t)&&"top"!=this.container.labelAlign){var i=Ext.isIE6||Ext.isIE&&!Ext.isStrict;return e-this.labelAdjust+(i?-3:0)}return e},adjustHeightAnchor:function(e,t){return t.label&&!this.isHide(t)&&"top"==this.container.labelAlign?e-t.label.getHeight():e},isValidParent:function(e,t){return t&&this.container.getEl().contains(e.getPositionEl())}}),Ext.Container.LAYOUTS.form=Ext.layout.FormLayout,Ext.layout.AccordionLayout=Ext.extend(Ext.layout.FitLayout,{fill:!0,autoWidth:!0,titleCollapse:!0,hideCollapseTool:!1,collapseFirst:!1,animate:!1,sequence:!1,activeOnTop:!1,type:"accordion",renderItem:function(e){this.animate===!1&&(e.animCollapse=!1),e.collapsible=!0,this.autoWidth&&(e.autoWidth=!0),this.titleCollapse&&(e.titleCollapse=!0),this.hideCollapseTool&&(e.hideCollapseTool=!0),void 0!==this.collapseFirst&&(e.collapseFirst=this.collapseFirst),this.activeItem||e.collapsed?this.activeItem&&this.activeItem!=e&&(e.collapsed=!0):this.setActiveItem(e,!0),Ext.layout.AccordionLayout.superclass.renderItem.apply(this,arguments),e.header.addClass("x-accordion-hd"),e.on("beforeexpand",this.beforeExpand,this)},onRemove:function(e){Ext.layout.AccordionLayout.superclass.onRemove.call(this,e),e.rendered&&e.header.removeClass("x-accordion-hd"),e.un("beforeexpand",this.beforeExpand,this)},beforeExpand:function(e,t){var i=this.activeItem;if(i)if(this.sequence){if(delete this.activeItem,!i.collapsed)return i.collapse({callback:function(){e.expand(t||!0)},scope:this}),!1}else i.collapse(this.animate);this.setActive(e),this.activeOnTop&&e.el.dom.parentNode.insertBefore(e.el.dom,e.el.dom.parentNode.firstChild),this.layout()},setItemSize:function(e,t){if(this.fill&&e){var i,s,n=0,r=this.getRenderedItems(this.container),a=r.length;for(i=0;a>i;i++)(s=r[i])==e||s.hidden||(n+=s.header.getHeight());t.height-=n,e.setSize(t)}},setActiveItem:function(e){this.setActive(e,!0)},setActive:function(e,t){var i=this.activeItem;e=this.container.getComponent(e),i!=e&&(e.rendered&&e.collapsed&&t?e.expand():(i&&i.fireEvent("deactivate",i),this.activeItem=e,e.fireEvent("activate",e)))}}),Ext.Container.LAYOUTS.accordion=Ext.layout.AccordionLayout,Ext.layout.Accordion=Ext.layout.AccordionLayout,Ext.layout.TableLayout=Ext.extend(Ext.layout.ContainerLayout,{monitorResize:!1,type:"table",targetCls:"x-table-layout-ct",tableAttrs:null,setContainer:function(e){Ext.layout.TableLayout.superclass.setContainer.call(this,e),this.currentRow=0,this.currentColumn=0,this.cells=[]},onLayout:function(e,t){var i=e.items.items;i.length,this.table||(t.addClass("x-table-layout-ct"),this.table=t.createChild(Ext.apply({tag:"table",cls:"x-table-layout",cellspacing:0,cn:{tag:"tbody"}},this.tableAttrs),null,!0)),this.renderAll(e,t)},getRow:function(e){var t=this.table.tBodies[0].childNodes[e];return t||(t=document.createElement("tr"),this.table.tBodies[0].appendChild(t)),t},getNextCell:function(e){for(var t=this.getNextNonSpan(this.currentColumn,this.currentRow),i=this.currentColumn=t[0],s=this.currentRow=t[1],n=s;n<s+(e.rowspan||1);n++){this.cells[n]||(this.cells[n]=[]);for(var r=i;r<i+(e.colspan||1);r++)this.cells[n][r]=!0}var a=document.createElement("td");e.cellId&&(a.id=e.cellId);var o="x-table-layout-cell";return e.cellCls&&(o+=" "+e.cellCls),a.className=o,e.colspan&&(a.colSpan=e.colspan),e.rowspan&&(a.rowSpan=e.rowspan),this.getRow(s).appendChild(a),a},getNextNonSpan:function(e,t){for(var i=this.columns;i&&e>=i||this.cells[t]&&this.cells[t][e];)i&&e>=i?(t++,e=0):e++;return[e,t]},renderItem:function(e,t,i){if(this.table||(this.table=i.createChild(Ext.apply({tag:"table",cls:"x-table-layout",cellspacing:0,cn:{tag:"tbody"}},this.tableAttrs),null,!0)),e&&!e.rendered)e.render(this.getNextCell(e)),this.configureItem(e);else if(e&&!this.isValidParent(e,i)){var s=this.getNextCell(e);s.insertBefore(e.getPositionEl().dom,null),e.container=Ext.get(s),this.configureItem(e)}},isValidParent:function(e,t){return e.getPositionEl().up("table",5).dom.parentNode===(t.dom||t)},destroy:function(){delete this.table,Ext.layout.TableLayout.superclass.destroy.call(this)}}),Ext.Container.LAYOUTS.table=Ext.layout.TableLayout,Ext.layout.AbsoluteLayout=Ext.extend(Ext.layout.AnchorLayout,{extraCls:"x-abs-layout-item",type:"absolute",onLayout:function(e,t){t.position(),this.paddingLeft=t.getPadding("l"),this.paddingTop=t.getPadding("t"),Ext.layout.AbsoluteLayout.superclass.onLayout.call(this,e,t)},adjustWidthAnchor:function(e,t){return e?e-t.getPosition(!0)[0]+this.paddingLeft:e},adjustHeightAnchor:function(e,t){return e?e-t.getPosition(!0)[1]+this.paddingTop:e}}),Ext.Container.LAYOUTS.absolute=Ext.layout.AbsoluteLayout,Ext.layout.BoxLayout=Ext.extend(Ext.layout.ContainerLayout,{defaultMargins:{left:0,top:0,right:0,bottom:0},padding:"0",pack:"start",monitorResize:!0,type:"box",scrollOffset:0,extraCls:"x-box-item",targetCls:"x-box-layout-ct",innerCls:"x-box-inner",constructor:function(e){Ext.layout.BoxLayout.superclass.constructor.call(this,e),Ext.isString(this.defaultMargins)&&(this.defaultMargins=this.parseMargins(this.defaultMargins));var t=this.overflowHandler;"string"==typeof t&&(t={type:t});var i="none";t&&void 0!=t.type&&(i=t.type);var s=Ext.layout.boxOverflow[i];s[this.type]&&(s=s[this.type]),this.overflowHandler=new s(this,t)},onLayout:function(e,t){Ext.layout.BoxLayout.superclass.onLayout.call(this,e,t);var i=this.getLayoutTargetSize(),s=this.getVisibleItems(e),n=this.calculateChildBoxes(s,i),r=n.boxes,a=n.meta;if(i.width>0){var o=this.overflowHandler,l=a.tooNarrow?"handleOverflow":"clearOverflow",h=o[l](n,i);h&&(h.targetSize&&(i=h.targetSize),h.recalculate&&(s=this.getVisibleItems(e),n=this.calculateChildBoxes(s,i),r=n.boxes))}this.layoutTargetLastSize=i,this.childBoxCache=n,this.updateInnerCtSize(i,n),this.updateChildBoxes(r),this.handleTargetOverflow(i,e,t)},updateChildBoxes:function(e){for(var t=0,i=e.length;i>t;t++){var s=e[t],n=s.component;s.dirtySize&&n.setSize(s.width,s.height),isNaN(s.left)||isNaN(s.top)||n.setPosition(s.left,s.top)}},updateInnerCtSize:function(e,t){var i=this.align,s=this.padding,n=e.width,r=e.height;if("hbox"==this.type){var a=n,o=t.meta.maxHeight+s.top+s.bottom;"stretch"==i?o=r:"middle"==i&&(o=Math.max(r,o))}else{var o=r,a=t.meta.maxWidth+s.left+s.right;"stretch"==i?a=n:"center"==i&&(a=Math.max(n,a))}this.innerCt.setSize(a||void 0,o||void 0)},handleTargetOverflow:function(e,t,i){var s=i.getStyle("overflow");if(s&&"hidden"!=s&&!this.adjustmentPass){var n=this.getLayoutTargetSize();(n.width!=e.width||n.height!=e.height)&&(this.adjustmentPass=!0,this.onLayout(t,i))}delete this.adjustmentPass},isValidParent:function(e){return this.innerCt&&e.getPositionEl().dom.parentNode==this.innerCt.dom},getVisibleItems:function(e){var t,i,e=e||this.container,s=e.getLayoutTarget(),n=e.items.items,r=n.length,a=[];for(t=0;r>t;t++)(i=n[t]).rendered&&this.isValidParent(i,s)&&i.hidden!==!0&&i.collapsed!==!0&&i.shouldLayout!==!1&&a.push(i);return a},renderAll:function(e,t){this.innerCt||(this.innerCt=t.createChild({cls:this.innerCls}),this.padding=this.parseMargins(this.padding)),Ext.layout.BoxLayout.superclass.renderAll.call(this,e,this.innerCt)},getLayoutTargetSize:function(){var e,t=this.container.getLayoutTarget();return t&&(e=t.getViewSize(),Ext.isIE&&Ext.isStrict&&0==e.width&&(e=t.getStyleSize()),e.width-=t.getPadding("lr"),e.height-=t.getPadding("tb")),e},renderItem:function(e){Ext.isString(e.margins)?e.margins=this.parseMargins(e.margins):e.margins||(e.margins=this.defaultMargins),Ext.layout.BoxLayout.superclass.renderItem.apply(this,arguments)},destroy:function(){Ext.destroy(this.overflowHandler),Ext.layout.BoxLayout.superclass.destroy.apply(this,arguments)}}),Ext.layout.boxOverflow.None=Ext.extend(Object,{constructor:function(e,t){this.layout=e,Ext.apply(this,t||{})},handleOverflow:Ext.emptyFn,clearOverflow:Ext.emptyFn}),Ext.layout.boxOverflow.none=Ext.layout.boxOverflow.None,Ext.layout.boxOverflow.Menu=Ext.extend(Ext.layout.boxOverflow.None,{afterCls:"x-strip-right",noItemsMenuText:'<div class="x-toolbar-no-items">(None)</div>',constructor:function(){Ext.layout.boxOverflow.Menu.superclass.constructor.apply(this,arguments),this.menuItems=[]},createInnerElements:function(){this.afterCt||(this.afterCt=this.layout.innerCt.insertSibling({cls:this.afterCls},"before"))},clearOverflow:function(e,t){var i=t.width+(this.afterCt?this.afterCt.getWidth():0),s=this.menuItems;this.hideTrigger();for(var n=0,r=s.length;r>n;n++)s.pop().component.show();return{targetSize:{height:t.height,width:i}}},showTrigger:function(){this.createMenu(),this.menuTrigger.show()},hideTrigger:function(){void 0!=this.menuTrigger&&this.menuTrigger.hide()},beforeMenuShow:function(e){var t,i,s=this.menuItems,n=s.length,r=function(e,t){return e.isXType("buttongroup")&&!(t instanceof Ext.Toolbar.Separator)};this.clearMenu(),e.removeAll();for(var a=0;n>a;a++)t=s[a].component,i&&(r(t,i)||r(i,t))&&e.add("-"),this.addComponentToMenu(e,t),i=t;e.items.length<1&&e.add(this.noItemsMenuText)},createMenuConfig:function(e,t){var i=Ext.apply({},e.initialConfig),s=e.toggleGroup;return Ext.copyTo(i,e,["iconCls","icon","itemId","disabled","handler","scope","menu"]),Ext.apply(i,{text:e.overflowText||e.text,hideOnClick:t}),(s||e.enableToggle)&&Ext.apply(i,{group:s,checked:e.pressed,listeners:{checkchange:function(t,i){e.toggle(i)}}}),delete i.ownerCt,delete i.xtype,delete i.id,i},addComponentToMenu:function(e,t){t instanceof Ext.Toolbar.Separator?e.add("-"):Ext.isFunction(t.isXType)&&(t.isXType("splitbutton")?e.add(this.createMenuConfig(t,!0)):t.isXType("button")?e.add(this.createMenuConfig(t,!t.menu)):t.isXType("buttongroup")&&t.items.each(function(t){this.addComponentToMenu(e,t)},this))},clearMenu:function(){var e=this.moreMenu;e&&e.items&&e.items.each(function(e){delete e.menu})},createMenu:function(){this.menuTrigger||(this.createInnerElements(),this.menu=new Ext.menu.Menu({ownerCt:this.layout.container,listeners:{scope:this,beforeshow:this.beforeMenuShow}}),this.menuTrigger=new Ext.Button({iconCls:"x-toolbar-more-icon",cls:"x-toolbar-more",menu:this.menu,renderTo:this.afterCt}))},destroy:function(){Ext.destroy(this.menu,this.menuTrigger)}}),Ext.layout.boxOverflow.menu=Ext.layout.boxOverflow.Menu,Ext.layout.boxOverflow.HorizontalMenu=Ext.extend(Ext.layout.boxOverflow.Menu,{constructor:function(){Ext.layout.boxOverflow.HorizontalMenu.superclass.constructor.apply(this,arguments);var e=this,t=e.layout,i=t.calculateChildBoxes;t.calculateChildBoxes=function(s,n){for(var r=i.apply(t,arguments),a=r.meta,o=e.menuItems,l=0,h=0,u=o.length;u>h;h++)l+=o[h].width;return a.minimumWidth+=l,a.tooNarrow=a.minimumWidth>n.width,r}},handleOverflow:function(e,t){this.showTrigger();for(var i=t.width-this.afterCt.getWidth(),s=e.boxes,n=0,r=!1,a=0,o=s.length;o>a;a++)n+=s[a].width;for(var l=i-n,h=0,a=0,o=this.menuItems.length;o>a;a++){var u=this.menuItems[a],c=u.component,d=u.width;if(!(l>d))break;c.show(),l-=d,h++,r=!0}if(r)this.menuItems=this.menuItems.slice(h);else for(var p=s.length-1;p>=0;p--){var f=s[p].component,m=s[p].left+s[p].width;if(!(m>=i))break;this.menuItems.unshift({component:f,width:s[p].width}),f.hide()}return 0==this.menuItems.length&&this.hideTrigger(),{targetSize:{height:t.height,width:i},recalculate:r}}}),Ext.layout.boxOverflow.menu.hbox=Ext.layout.boxOverflow.HorizontalMenu,Ext.layout.boxOverflow.Scroller=Ext.extend(Ext.layout.boxOverflow.None,{animateScroll:!0,scrollIncrement:100,wheelIncrement:3,scrollRepeatInterval:400,scrollDuration:.4,beforeCls:"x-strip-left",afterCls:"x-strip-right",scrollerCls:"x-strip-scroller",beforeScrollerCls:"x-strip-scroller-left",afterScrollerCls:"x-strip-scroller-right",createWheelListener:function(){this.layout.innerCt.on({scope:this,mousewheel:function(e){e.stopEvent(),this.scrollBy(-1*e.getWheelDelta()*this.wheelIncrement,!1)}})},handleOverflow:function(){this.createInnerElements(),this.showScrollers()},clearOverflow:function(){this.hideScrollers()},showScrollers:function(){this.createScrollers(),this.beforeScroller.show(),this.afterScroller.show(),this.updateScrollButtons()},hideScrollers:function(){void 0!=this.beforeScroller&&(this.beforeScroller.hide(),this.afterScroller.hide())},createScrollers:function(){if(!this.beforeScroller&&!this.afterScroller){var e=this.beforeCt.createChild({cls:String.format("{0} {1} ",this.scrollerCls,this.beforeScrollerCls)}),t=this.afterCt.createChild({cls:String.format("{0} {1}",this.scrollerCls,this.afterScrollerCls)});e.addClassOnOver(this.beforeScrollerCls+"-hover"),t.addClassOnOver(this.afterScrollerCls+"-hover"),e.setVisibilityMode(Ext.Element.DISPLAY),t.setVisibilityMode(Ext.Element.DISPLAY),this.beforeRepeater=new Ext.util.ClickRepeater(e,{interval:this.scrollRepeatInterval,handler:this.scrollLeft,scope:this}),this.afterRepeater=new Ext.util.ClickRepeater(t,{interval:this.scrollRepeatInterval,handler:this.scrollRight,scope:this}),this.beforeScroller=e,this.afterScroller=t}},destroy:function(){Ext.destroy(this.beforeScroller,this.afterScroller,this.beforeRepeater,this.afterRepeater,this.beforeCt,this.afterCt)},scrollBy:function(e,t){this.scrollTo(this.getScrollPosition()+e,t)},getItem:function(e){return Ext.isString(e)?e=Ext.getCmp(e):Ext.isNumber(e)&&(e=this.items[e]),e},getScrollAnim:function(){return{duration:this.scrollDuration,callback:this.updateScrollButtons,scope:this}},updateScrollButtons:function(){if(void 0!=this.beforeScroller&&void 0!=this.afterScroller){var e=this.atExtremeBefore()?"addClass":"removeClass",t=this.atExtremeAfter()?"addClass":"removeClass",i=this.beforeScrollerCls+"-disabled",s=this.afterScrollerCls+"-disabled";this.beforeScroller[e](i),this.afterScroller[t](s),this.scrolling=!1}},atExtremeBefore:function(){return 0===this.getScrollPosition()},scrollLeft:function(e){this.scrollBy(-this.scrollIncrement,e)},scrollRight:function(e){this.scrollBy(this.scrollIncrement,e)},scrollToItem:function(e,t){if(e=this.getItem(e),void 0!=e){var i=this.getItemVisibility(e);if(!i.fullyVisible){var s=e.getBox(!0,!0),n=s.x;i.hiddenRight&&(n-=this.layout.innerCt.getWidth()-s.width),this.scrollTo(n,t)}}},getItemVisibility:function(e){var t=this.getItem(e).getBox(!0,!0),i=t.x,s=t.x+t.width,n=this.getScrollPosition(),r=this.layout.innerCt.getWidth()+n;return{hiddenLeft:n>i,hiddenRight:s>r,fullyVisible:i>n&&r>s}}}),Ext.layout.boxOverflow.scroller=Ext.layout.boxOverflow.Scroller,Ext.layout.boxOverflow.VerticalScroller=Ext.extend(Ext.layout.boxOverflow.Scroller,{scrollIncrement:75,wheelIncrement:2,handleOverflow:function(e,t){return Ext.layout.boxOverflow.VerticalScroller.superclass.handleOverflow.apply(this,arguments),{targetSize:{height:t.height-(this.beforeCt.getHeight()+this.afterCt.getHeight()),width:t.width}}},createInnerElements:function(){var e=this.layout.innerCt;this.beforeCt||(this.beforeCt=e.insertSibling({cls:this.beforeCls},"before"),this.afterCt=e.insertSibling({cls:this.afterCls},"after"),this.createWheelListener())},scrollTo:function(e,t){var i=this.getScrollPosition(),s=e.constrain(0,this.getMaxScrollBottom());s==i||this.scrolling||(void 0==t&&(t=this.animateScroll),this.layout.innerCt.scrollTo("top",s,t?this.getScrollAnim():!1),t?this.scrolling=!0:(this.scrolling=!1,this.updateScrollButtons()))},getScrollPosition:function(){return parseInt(this.layout.innerCt.dom.scrollTop,10)||0},getMaxScrollBottom:function(){return this.layout.innerCt.dom.scrollHeight-this.layout.innerCt.getHeight()},atExtremeAfter:function(){return this.getScrollPosition()>=this.getMaxScrollBottom()}}),Ext.layout.boxOverflow.scroller.vbox=Ext.layout.boxOverflow.VerticalScroller,Ext.layout.boxOverflow.HorizontalScroller=Ext.extend(Ext.layout.boxOverflow.Scroller,{handleOverflow:function(e,t){return Ext.layout.boxOverflow.HorizontalScroller.superclass.handleOverflow.apply(this,arguments),{targetSize:{height:t.height,width:t.width-(this.beforeCt.getWidth()+this.afterCt.getWidth())}}},createInnerElements:function(){var e=this.layout.innerCt;this.beforeCt||(this.afterCt=e.insertSibling({cls:this.afterCls},"before"),this.beforeCt=e.insertSibling({cls:this.beforeCls},"before"),this.createWheelListener())},scrollTo:function(e,t){var i=this.getScrollPosition(),s=e.constrain(0,this.getMaxScrollRight());s==i||this.scrolling||(void 0==t&&(t=this.animateScroll),this.layout.innerCt.scrollTo("left",s,t?this.getScrollAnim():!1),t?this.scrolling=!0:(this.scrolling=!1,this.updateScrollButtons()))},getScrollPosition:function(){return parseInt(this.layout.innerCt.dom.scrollLeft,10)||0},getMaxScrollRight:function(){return this.layout.innerCt.dom.scrollWidth-this.layout.innerCt.getWidth()},atExtremeAfter:function(){return this.getScrollPosition()>=this.getMaxScrollRight()}}),Ext.layout.boxOverflow.scroller.hbox=Ext.layout.boxOverflow.HorizontalScroller,Ext.layout.HBoxLayout=Ext.extend(Ext.layout.BoxLayout,{align:"top",type:"hbox",calculateChildBoxes:function(e,t){var i,s,n,r,a,o,l,h,u,c,d,p,f=e.length,m=this.padding,y=m.top,g=m.left,v=y+m.bottom,x=g+m.right,E=t.width-this.scrollOffset,b=t.height,L=Math.max(0,b-v),S="start"==this.pack,C="center"==this.pack,w="end"==this.pack,O=0,T=0,M=0,P=0,N=0,D=[];for(l=0;f>l;l++)i=e[l],n=i.height,s=i.width,o=!i.hasLayout&&"function"==typeof i.doLayout,"number"!=typeof s&&(i.flex&&!s?M+=i.flex:(!s&&o&&i.doLayout(),r=i.getSize(),s=r.width,n=r.height)),a=i.margins,c=a.left+a.right,O+=c+(s||0),P+=c+(i.flex?i.minWidth||0:s),N+=c+(i.minWidth||s||0),"number"!=typeof n&&(o&&i.doLayout(),n=i.getHeight()),T=Math.max(T,n+a.top+a.bottom),D.push({component:i,height:n||void 0,width:s||void 0});var A=P-E,I=N>E,F=Math.max(0,E-O-x);if(I)for(l=0;f>l;l++)D[l].width=e[l].minWidth||e[l].width||D[l].width;else if(A>0){for(var R=[],k=0,_=f;_>k;k++){var j=e[k],G=j.minWidth||0;j.flex?D[k].width=G:R.push({minWidth:G,available:D[k].width-G,index:k})}R.sort(function(e,t){return e.available>t.available?1:-1});for(var l=0,_=R.length;_>l;l++){var B=R[l].index;if(void 0!=B){var j=e[B],z=D[B],W=z.width,G=j.minWidth,H=Math.max(G,W-Math.ceil(A/(_-l))),V=W-H;D[B].width=H,A-=V}}}else{var U=F,X=M;for(l=0;f>l;l++)i=e[l],h=D[l],a=i.margins,d=a.top+a.bottom,S&&i.flex&&!i.width&&(u=Math.ceil(i.flex/X*U),U-=u,X-=i.flex,h.width=u,h.dirtySize=!0)}for(C?g+=F/2:w&&(g+=F),l=0;f>l;l++){switch(i=e[l],h=D[l],a=i.margins,g+=a.left,d=a.top+a.bottom,h.left=g,h.top=y+a.top,this.align){case"stretch":p=L-d,h.height=p.constrain(i.minHeight||0,i.maxHeight||1e6),h.dirtySize=!0;break;case"stretchmax":p=T-d,h.height=p.constrain(i.minHeight||0,i.maxHeight||1e6),h.dirtySize=!0;break;case"middle":var q=L-h.height-d;q>0&&(h.top=y+d+q/2)}g+=h.width+a.right}return{boxes:D,meta:{maxHeight:T,nonFlexWidth:O,desiredWidth:P,minimumWidth:N,shortfall:P-E,tooNarrow:I}}}}),Ext.Container.LAYOUTS.hbox=Ext.layout.HBoxLayout,Ext.layout.VBoxLayout=Ext.extend(Ext.layout.BoxLayout,{align:"left",type:"vbox",calculateChildBoxes:function(e,t){var i,s,n,r,a,o,l,h,u,c,d,p,f,m=e.length,y=this.padding,g=y.top,v=y.left,x=g+y.bottom,E=v+y.right,b=t.width-this.scrollOffset,L=t.height,S=Math.max(0,b-E),C="start"==this.pack,w="center"==this.pack,O="end"==this.pack,T=0,M=0,P=0,N=0,D=0,A=[];for(l=0;m>l;l++)i=e[l],n=i.height,s=i.width,o=!i.hasLayout&&"function"==typeof i.doLayout,"number"!=typeof n&&(i.flex&&!n?P+=i.flex:(!n&&o&&i.doLayout(),r=i.getSize(),s=r.width,n=r.height)),a=i.margins,d=a.top+a.bottom,T+=d+(n||0),N+=d+(i.flex?i.minHeight||0:n),D+=d+(i.minHeight||n||0),"number"!=typeof s&&(o&&i.doLayout(),s=i.getWidth()),M=Math.max(M,s+a.left+a.right),A.push({component:i,height:n||void 0,width:s||void 0});
var I=N-L,F=D>L,R=Math.max(0,L-T-x);if(F)for(l=0,f=m;f>l;l++)A[l].height=e[l].minHeight||e[l].height||A[l].height;else if(I>0){for(var k=[],_=0,f=m;f>_;_++){var j=e[_],G=j.minHeight||0;j.flex?A[_].height=G:k.push({minHeight:G,available:A[_].height-G,index:_})}k.sort(function(e,t){return e.available>t.available?1:-1});for(var l=0,f=k.length;f>l;l++){var B=k[l].index;if(void 0!=B){var j=e[B],z=A[B],W=z.height,G=j.minHeight,H=Math.max(G,W-Math.ceil(I/(f-l))),V=W-H;A[B].height=H,I-=V}}}else{var U=R,X=P;for(l=0;m>l;l++)i=e[l],h=A[l],a=i.margins,c=a.left+a.right,C&&i.flex&&!i.height&&(u=Math.ceil(i.flex/X*U),U-=u,X-=i.flex,h.height=u,h.dirtySize=!0)}for(w?g+=R/2:O&&(g+=R),l=0;m>l;l++){switch(i=e[l],h=A[l],a=i.margins,g+=a.top,c=a.left+a.right,h.left=v+a.left,h.top=g,this.align){case"stretch":p=S-c,h.width=p.constrain(i.minWidth||0,i.maxWidth||1e6),h.dirtySize=!0;break;case"stretchmax":p=M-c,h.width=p.constrain(i.minWidth||0,i.maxWidth||1e6),h.dirtySize=!0;break;case"center":var q=S-h.width-c;q>0&&(h.left=v+c+q/2)}g+=h.height+a.bottom}return{boxes:A,meta:{maxWidth:M,nonFlexHeight:T,desiredHeight:N,minimumHeight:D,shortfall:N-L,tooNarrow:F}}}}),Ext.Container.LAYOUTS.vbox=Ext.layout.VBoxLayout,Ext.layout.ToolbarLayout=Ext.extend(Ext.layout.ContainerLayout,{monitorResize:!0,type:"toolbar",triggerWidth:18,noItemsMenuText:'<div class="x-toolbar-no-items">(None)</div>',lastOverflow:!1,tableHTML:['<table cellspacing="0" class="x-toolbar-ct">',"<tbody>","<tr>",'<td class="x-toolbar-left" align="{0}">','<table cellspacing="0">',"<tbody>",'<tr class="x-toolbar-left-row"></tr>',"</tbody>","</table>","</td>",'<td class="x-toolbar-right" align="right">','<table cellspacing="0" class="x-toolbar-right-ct">',"<tbody>","<tr>","<td>",'<table cellspacing="0">',"<tbody>",'<tr class="x-toolbar-right-row"></tr>',"</tbody>","</table>","</td>","<td>",'<table cellspacing="0">',"<tbody>",'<tr class="x-toolbar-extras-row"></tr>',"</tbody>","</table>","</td>","</tr>","</tbody>","</table>","</td>","</tr>","</tbody>","</table>"].join(""),onLayout:function(e,t){if(!this.leftTr){var i="center"==e.buttonAlign?"center":"left";t.addClass("x-toolbar-layout-ct"),t.insertHtml("beforeEnd",String.format(this.tableHTML,i)),this.leftTr=t.child("tr.x-toolbar-left-row",!0),this.rightTr=t.child("tr.x-toolbar-right-row",!0),this.extrasTr=t.child("tr.x-toolbar-extras-row",!0),void 0==this.hiddenItem&&(this.hiddenItems=[])}for(var s,n="right"==e.buttonAlign?this.rightTr:this.leftTr,r=e.items.items,a=0,o=0,l=r.length;l>o;o++,a++)if(s=r[o],s.isFill)n=this.rightTr,a=-1;else if(s.rendered){if(!s.xtbHidden&&!this.isValidParent(s,n.childNodes[a])){var h=this.insertCell(s,n,a);h.appendChild(s.getPositionEl().dom),s.container=Ext.get(h)}}else s.render(this.insertCell(s,n,a)),this.configureItem(s);this.cleanup(this.leftTr),this.cleanup(this.rightTr),this.cleanup(this.extrasTr),this.fitToSize(t)},cleanup:function(e){var t,i,s=e.childNodes;for(t=s.length-1;t>=0&&(i=s[t]);t--)i.firstChild||e.removeChild(i)},insertCell:function(e,t,i){var s=document.createElement("td");return s.className="x-toolbar-cell",t.insertBefore(s,t.childNodes[i]||null),s},hideItem:function(e){this.hiddenItems.push(e),e.xtbHidden=!0,e.xtbWidth=e.getPositionEl().dom.parentNode.offsetWidth,e.hide()},unhideItem:function(e){e.show(),e.xtbHidden=!1,this.hiddenItems.remove(e)},getItemWidth:function(e){return e.hidden?e.xtbWidth||0:e.getPositionEl().dom.parentNode.offsetWidth},fitToSize:function(e){if(this.container.enableOverflow!==!1){var t=e.dom.clientWidth,i=e.dom.firstChild.offsetWidth,s=t-this.triggerWidth,n=this.lastWidth||0,r=this.hiddenItems,a=0!=r.length,o=t>=n;if(this.lastWidth=t,i>t||a&&o)for(var l,h=this.container.items.items,u=h.length,c=0,d=0;u>d;d++)l=h[d],l.isFill||(c+=this.getItemWidth(l),c>s?l.hidden||l.xtbHidden||this.hideItem(l):l.xtbHidden&&this.unhideItem(l));a=0!=r.length,a?(this.initMore(),this.lastOverflow||(this.container.fireEvent("overflowchange",this.container,!0),this.lastOverflow=!0)):this.more&&(this.clearMenu(),this.more.destroy(),delete this.more,this.lastOverflow&&(this.container.fireEvent("overflowchange",this.container,!1),this.lastOverflow=!1))}},createMenuConfig:function(e,t){var i=Ext.apply({},e.initialConfig),s=e.toggleGroup;return Ext.copyTo(i,e,["iconCls","icon","itemId","disabled","handler","scope","menu"]),Ext.apply(i,{text:e.overflowText||e.text,hideOnClick:t}),(s||e.enableToggle)&&Ext.apply(i,{group:s,checked:e.pressed,listeners:{checkchange:function(t,i){e.toggle(i)}}}),delete i.ownerCt,delete i.xtype,delete i.id,i},addComponentToMenu:function(e,t){t instanceof Ext.Toolbar.Separator?e.add("-"):Ext.isFunction(t.isXType)&&(t.isXType("splitbutton")?e.add(this.createMenuConfig(t,!0)):t.isXType("button")?e.add(this.createMenuConfig(t,!t.menu)):t.isXType("buttongroup")&&t.items.each(function(t){this.addComponentToMenu(e,t)},this))},clearMenu:function(){var e=this.moreMenu;e&&e.items&&e.items.each(function(e){delete e.menu})},beforeMoreShow:function(e){var t,i,s=this.container.items.items,n=s.length,r=function(e,t){return e.isXType("buttongroup")&&!(t instanceof Ext.Toolbar.Separator)};this.clearMenu(),e.removeAll();for(var a=0;n>a;a++)t=s[a],t.xtbHidden&&(i&&(r(t,i)||r(i,t))&&e.add("-"),this.addComponentToMenu(e,t),i=t);e.items.length<1&&e.add(this.noItemsMenuText)},initMore:function(){if(!this.more){this.moreMenu=new Ext.menu.Menu({ownerCt:this.container,listeners:{beforeshow:this.beforeMoreShow,scope:this}}),this.more=new Ext.Button({iconCls:"x-toolbar-more-icon",cls:"x-toolbar-more",menu:this.moreMenu,ownerCt:this.container});var e=this.insertCell(this.more,this.extrasTr,100);this.more.render(e)}},destroy:function(){Ext.destroy(this.more,this.moreMenu),delete this.leftTr,delete this.rightTr,delete this.extrasTr,Ext.layout.ToolbarLayout.superclass.destroy.call(this)}}),Ext.Container.LAYOUTS.toolbar=Ext.layout.ToolbarLayout,Ext.layout.MenuLayout=Ext.extend(Ext.layout.ContainerLayout,{monitorResize:!0,type:"menu",setContainer:function(e){this.monitorResize=!e.floating,e.on("autosize",this.doAutoSize,this),Ext.layout.MenuLayout.superclass.setContainer.call(this,e)},renderItem:function(e,t,i){if(this.itemTpl||(this.itemTpl=Ext.layout.MenuLayout.prototype.itemTpl=new Ext.XTemplate('<li id="{itemId}" class="{itemCls}">','<tpl if="needsIcon">','<img alt="{altText}" src="{icon}" class="{iconCls}"/>',"</tpl>","</li>")),e&&!e.rendered){Ext.isNumber(t)&&(t=i.dom.childNodes[t]);var s=this.getItemArgs(e);e.render(e.positionEl=t?this.itemTpl.insertBefore(t,s,!0):this.itemTpl.append(i,s,!0)),e.positionEl.menuItemId=e.getItemId(),!s.isMenuItem&&s.needsIcon&&e.positionEl.addClass("x-menu-list-item-indent"),this.configureItem(e)}else e&&!this.isValidParent(e,i)&&(Ext.isNumber(t)&&(t=i.dom.childNodes[t]),i.dom.insertBefore(e.getActionEl().dom,t||null))},getItemArgs:function(e){var t=e instanceof Ext.menu.Item,i=!(t||e instanceof Ext.menu.Separator);return{isMenuItem:t,needsIcon:i&&(e.icon||e.iconCls),icon:e.icon||Ext.BLANK_IMAGE_URL,iconCls:"x-menu-item-icon "+(e.iconCls||""),itemId:"x-menu-el-"+e.id,itemCls:"x-menu-list-item ",altText:e.altText||""}},isValidParent:function(e,t){return e.el.up("li.x-menu-list-item",5).dom.parentNode===(t.dom||t)},onLayout:function(e,t){Ext.layout.MenuLayout.superclass.onLayout.call(this,e,t),this.doAutoSize()},doAutoSize:function(){var e=this.container,t=e.width;if(e.floating)if(t)e.setWidth(t);else if(Ext.isIE){e.setWidth(Ext.isStrict&&(Ext.isIE7||Ext.isIE8||Ext.isIE9)?"auto":e.minWidth);var i=e.getEl();i.dom.offsetWidth,e.setWidth(e.getLayoutTarget().getWidth()+i.getFrameWidth("lr"))}}}),Ext.Container.LAYOUTS.menu=Ext.layout.MenuLayout,Ext.Viewport=Ext.extend(Ext.Container,{initComponent:function(){Ext.Viewport.superclass.initComponent.call(this),document.getElementsByTagName("html")[0].className+=" x-viewport",this.el=Ext.getBody(),this.el.setHeight=Ext.emptyFn,this.el.setWidth=Ext.emptyFn,this.el.setSize=Ext.emptyFn,this.el.dom.scroll="no",this.allowDomMove=!1,this.autoWidth=!0,this.autoHeight=!0,Ext.EventManager.onWindowResize(this.fireResize,this),this.renderTo=this.el},fireResize:function(e,t){this.fireEvent("resize",this,e,t,e,t)}}),Ext.reg("viewport",Ext.Viewport),Ext.Panel=Ext.extend(Ext.Container,{baseCls:"x-panel",collapsedCls:"x-panel-collapsed",maskDisabled:!0,animCollapse:Ext.enableFx,headerAsText:!0,buttonAlign:"right",collapsed:!1,collapseFirst:!0,minButtonWidth:75,elements:"body",preventBodyReset:!1,padding:void 0,resizeEvent:"bodyresize",toolTarget:"header",collapseEl:"bwrap",slideAnchor:"t",disabledClass:"",deferHeight:!0,expandDefaults:{duration:.25},collapseDefaults:{duration:.25},initComponent:function(){Ext.Panel.superclass.initComponent.call(this),this.addEvents("bodyresize","titlechange","iconchange","collapse","expand","beforecollapse","beforeexpand","beforeclose","close","activate","deactivate"),this.unstyled&&(this.baseCls="x-plain"),this.toolbars=[],this.tbar&&(this.elements+=",tbar",this.topToolbar=this.createToolbar(this.tbar),this.tbar=null),this.bbar&&(this.elements+=",bbar",this.bottomToolbar=this.createToolbar(this.bbar),this.bbar=null),this.header===!0?(this.elements+=",header",this.header=null):(this.headerCfg||this.title&&this.header!==!1)&&(this.elements+=",header"),(this.footerCfg||this.footer===!0)&&(this.elements+=",footer",this.footer=null),this.buttons&&(this.fbar=this.buttons,this.buttons=null),this.fbar&&this.createFbar(this.fbar),this.autoLoad&&this.on("render",this.doAutoLoad,this,{delay:10})},createFbar:function(e){var t=this.minButtonWidth;this.elements+=",footer",this.fbar=this.createToolbar(e,{buttonAlign:this.buttonAlign,toolbarCls:"x-panel-fbar",enableOverflow:!1,defaults:function(e){return{minWidth:e.minWidth||t}}}),this.fbar.items.each(function(e){e.minWidth=e.minWidth||this.minButtonWidth},this),this.buttons=this.fbar.items.items},createToolbar:function(e,t){var i;return Ext.isArray(e)&&(e={items:e}),i=e.events?Ext.apply(e,t):this.createComponent(Ext.apply({},e,t),"toolbar"),this.toolbars.push(i),i},createElement:function(e,t){if(this[e])return t.appendChild(this[e].dom),void 0;if("bwrap"===e||-1!=this.elements.indexOf(e)){if(this[e+"Cfg"])this[e]=Ext.fly(t).createChild(this[e+"Cfg"]);else{var i=document.createElement("div");i.className=this[e+"Cls"],this[e]=Ext.get(t.appendChild(i))}this[e+"CssClass"]&&this[e].addClass(this[e+"CssClass"]),this[e+"Style"]&&this[e].applyStyles(this[e+"Style"])}},onRender:function(e,t){Ext.Panel.superclass.onRender.call(this,e,t),this.createClasses();var i,s,n=this.el,r=n.dom;if(this.collapsible&&!this.hideCollapseTool&&(this.tools=this.tools?this.tools.slice(0):[],this.tools[this.collapseFirst?"unshift":"push"]({id:"toggle",handler:this.toggleCollapse,scope:this})),this.tools&&(s=this.tools,this.elements+=this.header!==!1?",header":""),this.tools={},n.addClass(this.baseCls),r.firstChild){this.header=n.down("."+this.headerCls),this.bwrap=n.down("."+this.bwrapCls);var a=this.bwrap?this.bwrap:n;this.tbar=a.down("."+this.tbarCls),this.body=a.down("."+this.bodyCls),this.bbar=a.down("."+this.bbarCls),this.footer=a.down("."+this.footerCls),this.fromMarkup=!0}if(this.preventBodyReset===!0&&n.addClass("x-panel-reset"),this.cls&&n.addClass(this.cls),this.buttons&&(this.elements+=",footer"),this.frame){n.insertHtml("afterBegin",String.format(Ext.Element.boxMarkup,this.baseCls)),this.createElement("header",r.firstChild.firstChild.firstChild),this.createElement("bwrap",r),i=this.bwrap.dom;var o=r.childNodes[1],l=r.childNodes[2];i.appendChild(o),i.appendChild(l);var h=i.firstChild.firstChild.firstChild;this.createElement("tbar",h),this.createElement("body",h),this.createElement("bbar",h),this.createElement("footer",i.lastChild.firstChild.firstChild),this.footer||(this.bwrap.dom.lastChild.className+=" x-panel-nofooter"),this.ft=Ext.get(this.bwrap.dom.lastChild),this.mc=Ext.get(h)}else this.createElement("header",r),this.createElement("bwrap",r),i=this.bwrap.dom,this.createElement("tbar",i),this.createElement("body",i),this.createElement("bbar",i),this.createElement("footer",i),this.header||(this.body.addClass(this.bodyCls+"-noheader"),this.tbar&&this.tbar.addClass(this.tbarCls+"-noheader"));Ext.isDefined(this.padding)&&this.body.setStyle("padding",this.body.addUnits(this.padding)),this.border===!1&&(this.el.addClass(this.baseCls+"-noborder"),this.body.addClass(this.bodyCls+"-noborder"),this.header&&this.header.addClass(this.headerCls+"-noborder"),this.footer&&this.footer.addClass(this.footerCls+"-noborder"),this.tbar&&this.tbar.addClass(this.tbarCls+"-noborder"),this.bbar&&this.bbar.addClass(this.bbarCls+"-noborder")),this.bodyBorder===!1&&this.body.addClass(this.bodyCls+"-noborder"),this.bwrap.enableDisplayMode("block"),this.header&&(this.header.unselectable(),this.headerAsText&&(this.header.dom.innerHTML='<span class="'+this.headerTextCls+'">'+this.header.dom.innerHTML+"</span>",this.iconCls&&this.setIconClass(this.iconCls))),this.floating&&this.makeFloating(this.floating),this.collapsible&&this.titleCollapse&&this.header&&(this.mon(this.header,"click",this.toggleCollapse,this),this.header.setStyle("cursor","pointer")),s&&this.addTool.apply(this,s),this.fbar&&(this.footer.addClass("x-panel-btns"),this.fbar.ownerCt=this,this.fbar.render(this.footer),this.footer.createChild({cls:"x-clear"})),this.tbar&&this.topToolbar&&(this.topToolbar.ownerCt=this,this.topToolbar.render(this.tbar)),this.bbar&&this.bottomToolbar&&(this.bottomToolbar.ownerCt=this,this.bottomToolbar.render(this.bbar))},setIconClass:function(e){var t=this.iconCls;if(this.iconCls=e,this.rendered&&this.header)if(this.frame)this.header.addClass("x-panel-icon"),this.header.replaceClass(t,this.iconCls);else{var i=this.header,s=i.child("img.x-panel-inline-icon");if(s)Ext.fly(s).replaceClass(t,this.iconCls);else{var n=i.child("span."+this.headerTextCls);n&&Ext.DomHelper.insertBefore(n.dom,{tag:"img",alt:"",src:Ext.BLANK_IMAGE_URL,cls:"x-panel-inline-icon "+this.iconCls})}}this.fireEvent("iconchange",this,e,t)},makeFloating:function(e){this.floating=!0,this.el=new Ext.Layer(Ext.apply({},e,{shadow:Ext.isDefined(this.shadow)?this.shadow:"sides",shadowOffset:this.shadowOffset,constrain:!1,shim:this.shim===!1?!1:void 0}),this.el)},getTopToolbar:function(){return this.topToolbar},getBottomToolbar:function(){return this.bottomToolbar},getFooterToolbar:function(){return this.fbar},addButton:function(e,t,i){return this.fbar||this.createFbar([]),t&&(Ext.isString(e)&&(e={text:e}),e=Ext.apply({handler:t,scope:i},e)),this.fbar.add(e)},addTool:function(){if(!this.rendered)return this.tools||(this.tools=[]),Ext.each(arguments,function(e){this.tools.push(e)},this),void 0;if(this[this.toolTarget]){if(!this.toolTemplate){var e=new Ext.Template('<div class="x-tool x-tool-{id}">&#160;</div>');e.disableFormats=!0,e.compile(),Ext.Panel.prototype.toolTemplate=e}for(var t=0,i=arguments,s=i.length;s>t;t++){var n=i[t];if(!this.tools[n.id]){var r="x-tool-"+n.id+"-over",a=this.toolTemplate.insertFirst(this[this.toolTarget],n,!0);this.tools[n.id]=a,a.enableDisplayMode("block"),this.mon(a,"click",this.createToolHandler(a,n,r,this)),n.on&&this.mon(a,n.on),n.hidden&&a.hide(),n.qtip&&(Ext.isObject(n.qtip)?Ext.QuickTips.register(Ext.apply({target:a.id},n.qtip)):a.dom.qtip=n.qtip),a.addClassOnOver(r)}}}},onLayout:function(e,t){Ext.Panel.superclass.onLayout.apply(this,arguments),this.hasLayout&&this.toolbars.length>0&&(Ext.each(this.toolbars,function(e){e.doLayout(void 0,t)}),this.syncHeight())},syncHeight:function(){var e,t=this.toolbarHeight,i=this.body,s=this.lastSize.height;!this.autoHeight&&Ext.isDefined(s)&&"auto"!=s&&t!=this.getToolbarHeight()&&(t=Math.max(0,s-this.getFrameHeight()),i.setHeight(t),e=i.getSize(),this.toolbarHeight=this.getToolbarHeight(),this.onBodyResize(e.width,e.height))},onShow:function(){return this.floating?this.el.show():(Ext.Panel.superclass.onShow.call(this),void 0)},onHide:function(){return this.floating?this.el.hide():(Ext.Panel.superclass.onHide.call(this),void 0)},createToolHandler:function(e,t,i,s){return function(n){e.removeClass(i),t.stopEvent!==!1&&n.stopEvent(),t.handler&&t.handler.call(t.scope||e,n,e,s,t)}},afterRender:function(){this.floating&&!this.hidden&&this.el.show(),this.title&&this.setTitle(this.title),Ext.Panel.superclass.afterRender.call(this),this.collapsed&&(this.collapsed=!1,this.collapse(!1)),this.initEvents()},getKeyMap:function(){return this.keyMap||(this.keyMap=new Ext.KeyMap(this.el,this.keys)),this.keyMap},initEvents:function(){this.keys&&this.getKeyMap(),this.draggable&&this.initDraggable(),this.toolbars.length>0&&(Ext.each(this.toolbars,function(e){e.doLayout(),e.on({scope:this,afterlayout:this.syncHeight,remove:this.syncHeight})},this),this.syncHeight())},initDraggable:function(){this.dd=new Ext.Panel.DD(this,Ext.isBoolean(this.draggable)?null:this.draggable)},beforeEffect:function(e){this.floating&&this.el.beforeAction(),e!==!1&&this.el.addClass("x-panel-animated")},afterEffect:function(){this.syncShadow(),this.el.removeClass("x-panel-animated")},createEffect:function(e,t,i){var s={scope:i,block:!0};return e===!0?(s.callback=t,s):(s.callback=e.callback?function(){t.call(i),Ext.callback(e.callback,e.scope)}:t,Ext.applyIf(s,e))},collapse:function(e){if(!this.collapsed&&!this.el.hasFxBlock()&&this.fireEvent("beforecollapse",this,e)!==!1){var t=e===!0||e!==!1&&this.animCollapse;return this.beforeEffect(t),this.onCollapse(t,e),this}},onCollapse:function(e,t){e?this[this.collapseEl].slideOut(this.slideAnchor,Ext.apply(this.createEffect(t||!0,this.afterCollapse,this),this.collapseDefaults)):(this[this.collapseEl].hide(this.hideMode),this.afterCollapse(!1))},afterCollapse:function(e){this.collapsed=!0,this.el.addClass(this.collapsedCls),e!==!1&&this[this.collapseEl].hide(this.hideMode),this.afterEffect(e),this.cascade(function(e){e.lastSize&&(e.lastSize={width:void 0,height:void 0})}),this.fireEvent("collapse",this)},expand:function(e){if(this.collapsed&&!this.el.hasFxBlock()&&this.fireEvent("beforeexpand",this,e)!==!1){var t=e===!0||e!==!1&&this.animCollapse;return this.el.removeClass(this.collapsedCls),this.beforeEffect(t),this.onExpand(t,e),this}},onExpand:function(e,t){e?this[this.collapseEl].slideIn(this.slideAnchor,Ext.apply(this.createEffect(t||!0,this.afterExpand,this),this.expandDefaults)):(this[this.collapseEl].show(this.hideMode),this.afterExpand(!1))},afterExpand:function(e){this.collapsed=!1,e!==!1&&this[this.collapseEl].show(this.hideMode),this.afterEffect(e),this.deferLayout&&(delete this.deferLayout,this.doLayout(!0)),this.fireEvent("expand",this)},toggleCollapse:function(e){return this[this.collapsed?"expand":"collapse"](e),this},onDisable:function(){this.rendered&&this.maskDisabled&&this.el.mask(),Ext.Panel.superclass.onDisable.call(this)},onEnable:function(){this.rendered&&this.maskDisabled&&this.el.unmask(),Ext.Panel.superclass.onEnable.call(this)},onResize:function(e,t,i,s){var n=e,r=t;(Ext.isDefined(n)||Ext.isDefined(r))&&(this.collapsed?(this.queuedBodySize={width:n,height:r},this.queuedExpand||this.allowQueuedExpand===!1||(this.queuedExpand=!0,this.on("expand",function(){delete this.queuedExpand,this.onResize(this.queuedBodySize.width,this.queuedBodySize.height)},this,{single:!0}))):(Ext.isNumber(n)?this.body.setWidth(n=this.adjustBodyWidth(n-this.getFrameWidth())):n="auto"==n?this.body.setWidth("auto").dom.offsetWidth:this.body.dom.offsetWidth,this.tbar&&(this.tbar.setWidth(n),this.topToolbar&&this.topToolbar.setSize(n)),this.bbar&&(this.bbar.setWidth(n),this.bottomToolbar&&(this.bottomToolbar.setSize(n),Ext.isIE&&(this.bbar.setStyle("position","static"),this.bbar.setStyle("position","")))),this.footer&&(this.footer.setWidth(n),this.fbar&&this.fbar.setSize(Ext.isIE?n-this.footer.getFrameWidth("lr"):"auto")),Ext.isNumber(r)?(r=Math.max(0,r-this.getFrameHeight()),this.body.setHeight(r)):"auto"==r&&this.body.setHeight(r),this.disabled&&this.el._mask&&this.el._mask.setSize(this.el.dom.clientWidth,this.el.getHeight())),this.onBodyResize(n,r)),this.syncShadow(),Ext.Panel.superclass.onResize.call(this,e,t,i,s)},onBodyResize:function(e,t){this.fireEvent("bodyresize",this,e,t)},getToolbarHeight:function(){var e=0;return this.rendered&&Ext.each(this.toolbars,function(t){e+=t.getHeight()},this),e},adjustBodyHeight:function(e){return e},adjustBodyWidth:function(e){return e},onPosition:function(){this.syncShadow()},getFrameWidth:function(){var e=this.el.getFrameWidth("lr")+this.bwrap.getFrameWidth("lr");if(this.frame){var t=this.bwrap.dom.firstChild;e+=Ext.fly(t).getFrameWidth("l")+Ext.fly(t.firstChild).getFrameWidth("r"),e+=this.mc.getFrameWidth("lr")}return e},getFrameHeight:function(){var e=this.el.getFrameWidth("tb")+this.bwrap.getFrameWidth("tb");return e+=(this.tbar?this.tbar.getHeight():0)+(this.bbar?this.bbar.getHeight():0),e+=this.frame?this.el.dom.firstChild.offsetHeight+this.ft.dom.offsetHeight+this.mc.getFrameWidth("tb"):(this.header?this.header.getHeight():0)+(this.footer?this.footer.getHeight():0)},getInnerWidth:function(){return this.getSize().width-this.getFrameWidth()},getInnerHeight:function(){return this.body.getHeight()},syncShadow:function(){this.floating&&this.el.sync(!0)},getLayoutTarget:function(){return this.body},getContentTarget:function(){return this.body},setTitle:function(e,t){return this.title=e,this.header&&this.headerAsText&&this.header.child("span").update(e),t&&this.setIconClass(t),this.fireEvent("titlechange",this,e),this},getUpdater:function(){return this.body.getUpdater()},load:function(){var e=this.body.getUpdater();return e.update.apply(e,arguments),this},beforeDestroy:function(){if(Ext.Panel.superclass.beforeDestroy.call(this),this.header&&this.header.removeAllListeners(),this.tools)for(var e in this.tools)Ext.destroy(this.tools[e]);if(this.toolbars.length>0&&Ext.each(this.toolbars,function(e){e.un("afterlayout",this.syncHeight,this),e.un("remove",this.syncHeight,this)},this),Ext.isArray(this.buttons))for(;this.buttons.length;)Ext.destroy(this.buttons[0]);this.rendered&&(Ext.destroy(this.ft,this.header,this.footer,this.tbar,this.bbar,this.body,this.mc,this.bwrap,this.dd),this.fbar&&Ext.destroy(this.fbar,this.fbar.el)),Ext.destroy(this.toolbars)},createClasses:function(){this.headerCls=this.baseCls+"-header",this.headerTextCls=this.baseCls+"-header-text",this.bwrapCls=this.baseCls+"-bwrap",this.tbarCls=this.baseCls+"-tbar",this.bodyCls=this.baseCls+"-body",this.bbarCls=this.baseCls+"-bbar",this.footerCls=this.baseCls+"-footer"},createGhost:function(e,t,i){var s=document.createElement("div");if(s.className="x-panel-ghost "+(e?e:""),this.header&&s.appendChild(this.el.dom.firstChild.cloneNode(!0)),Ext.fly(s.appendChild(document.createElement("ul"))).setHeight(this.bwrap.getHeight()),s.style.width=this.el.dom.offsetWidth+"px",i?Ext.getDom(i).appendChild(s):this.container.dom.appendChild(s),t!==!1&&this.el.useShim!==!1){var n=new Ext.Layer({shadow:!1,useDisplay:!0,constrain:!1},s);return n.show(),n}return new Ext.Element(s)},doAutoLoad:function(){var e=this.body.getUpdater();this.renderer&&e.setRenderer(this.renderer),e.update(Ext.isObject(this.autoLoad)?this.autoLoad:{url:this.autoLoad})},getTool:function(e){return this.tools[e]}}),Ext.reg("panel",Ext.Panel),Ext.Editor=function(e,t){e.field?(this.field=Ext.create(e.field,"textfield"),t=Ext.apply({},e),delete t.field):this.field=e,Ext.Editor.superclass.constructor.call(this,t)},Ext.extend(Ext.Editor,Ext.Component,{allowBlur:!0,value:"",alignment:"c-c?",offsets:[0,0],shadow:"frame",constrain:!1,swallowKeys:!0,completeOnEnter:!0,cancelOnEsc:!0,updateEl:!1,initComponent:function(){Ext.Editor.superclass.initComponent.call(this),this.addEvents("beforestartedit","startedit","beforecomplete","complete","canceledit","specialkey")},onRender:function(e){this.el=new Ext.Layer({shadow:this.shadow,cls:"x-editor",parentEl:e,shim:this.shim,shadowOffset:this.shadowOffset||4,id:this.id,constrain:this.constrain}),this.zIndex&&this.el.setZIndex(this.zIndex),this.el.setStyle("overflow",Ext.isGecko?"auto":"hidden"),"title"!=this.field.msgTarget&&(this.field.msgTarget="qtip"),this.field.inEditor=!0,this.mon(this.field,{scope:this,blur:this.onBlur,specialkey:this.onSpecialKey}),this.field.grow&&this.mon(this.field,"autosize",this.el.sync,this.el,{delay:1}),this.field.render(this.el).show(),this.field.getEl().dom.name="",this.swallowKeys&&this.field.el.swallowEvent(["keypress","keydown"])},onSpecialKey:function(e,t){var i=t.getKey(),s=this.completeOnEnter&&i==t.ENTER,n=this.cancelOnEsc&&i==t.ESC;(s||n)&&(t.stopEvent(),s?this.completeEdit():this.cancelEdit(),e.triggerBlur&&e.triggerBlur()),this.fireEvent("specialkey",e,t)},startEdit:function(e,t){this.editing&&this.completeEdit(),this.boundEl=Ext.get(e);var i=void 0!==t?t:this.boundEl.dom.innerHTML;this.rendered||this.render(this.parentEl||document.body),this.fireEvent("beforestartedit",this,this.boundEl,i)!==!1&&(this.startValue=i,this.field.reset(),this.field.setValue(i),this.realign(!0),this.editing=!0,this.show())},doAutoSize:function(){if(this.autoSize){var e=this.boundEl.getSize(),t=this.field.getSize();switch(this.autoSize){case"width":this.setSize(e.width,t.height);break;case"height":this.setSize(t.width,e.height);break;case"none":this.setSize(t.width,t.height);break;default:this.setSize(e.width,e.height)}}},setSize:function(e,t){delete this.field.lastSize,this.field.setSize(e,t),this.el&&((Ext.isGecko2||Ext.isOpera||Ext.isIE7&&Ext.isStrict)&&this.el.setSize(e,t),this.el.sync())},realign:function(e){e===!0&&this.doAutoSize(),this.el.alignTo(this.boundEl,this.alignment,this.offsets)},completeEdit:function(e){if(this.editing){this.field.assertValue&&this.field.assertValue();var t=this.getValue();return this.field.isValid()?String(t)===String(this.startValue)&&this.ignoreNoChange?(this.hideEdit(e),void 0):(this.fireEvent("beforecomplete",this,t,this.startValue)!==!1&&(t=this.getValue(),this.updateEl&&this.boundEl&&this.boundEl.update(t),this.hideEdit(e),this.fireEvent("complete",this,t,this.startValue)),void 0):(this.revertInvalid!==!1&&this.cancelEdit(e),void 0)}},onShow:function(){this.el.show(),this.hideEl!==!1&&this.boundEl.hide(),this.field.show().focus(!1,!0),this.fireEvent("startedit",this.boundEl,this.startValue)},cancelEdit:function(e){if(this.editing){var t=this.getValue();this.setValue(this.startValue),this.hideEdit(e),this.fireEvent("canceledit",this,t,this.startValue)}},hideEdit:function(e){e!==!0&&(this.editing=!1,this.hide())},onBlur:function(){this.allowBlur===!0&&this.editing&&this.selectSameEditor!==!0&&this.completeEdit()},onHide:function(){return this.editing?(this.completeEdit(),void 0):(this.field.blur(),this.field.collapse&&this.field.collapse(),this.el.hide(),this.hideEl!==!1&&this.boundEl.show(),void 0)},setValue:function(e){this.field.setValue(e)},getValue:function(){return this.field.getValue()},beforeDestroy:function(){Ext.destroyMembers(this,"field"),delete this.parentEl,delete this.boundEl}}),Ext.reg("editor",Ext.Editor),Ext.ColorPalette=Ext.extend(Ext.Component,{itemCls:"x-color-palette",value:null,clickEvent:"click",ctype:"Ext.ColorPalette",allowReselect:!1,colors:["000000","993300","333300","003300","003366","000080","333399","333333","800000","FF6600","808000","008000","008080","0000FF","666699","808080","FF0000","FF9900","99CC00","339966","33CCCC","3366FF","800080","969696","FF00FF","FFCC00","FFFF00","00FF00","00FFFF","00CCFF","993366","C0C0C0","FF99CC","FFCC99","FFFF99","CCFFCC","CCFFFF","99CCFF","CC99FF","FFFFFF"],initComponent:function(){Ext.ColorPalette.superclass.initComponent.call(this),this.addEvents("select"),this.handler&&this.on("select",this.handler,this.scope,!0)},onRender:function(e,t){this.autoEl={tag:"div",cls:this.itemCls},Ext.ColorPalette.superclass.onRender.call(this,e,t);var i=this.tpl||new Ext.XTemplate('<tpl for="."><a href="#" class="color-{.}" hidefocus="on"><em><span style="background:#{.}" unselectable="on">&#160;</span></em></a></tpl>');i.overwrite(this.el,this.colors),this.mon(this.el,this.clickEvent,this.handleClick,this,{delegate:"a"}),"click"!=this.clickEvent&&this.mon(this.el,"click",Ext.emptyFn,this,{delegate:"a",preventDefault:!0})},afterRender:function(){if(Ext.ColorPalette.superclass.afterRender.call(this),this.value){var e=this.value;this.value=null,this.select(e,!0)}},handleClick:function(e,t){if(e.preventDefault(),!this.disabled){var i=t.className.match(/(?:^|\s)color-(.{6})(?:\s|$)/)[1];this.select(i.toUpperCase())}},select:function(e,t){if(e=e.replace("#",""),e!=this.value||this.allowReselect){var i=this.el;this.value&&i.child("a.color-"+this.value).removeClass("x-color-palette-sel"),i.child("a.color-"+e).addClass("x-color-palette-sel"),this.value=e,t!==!0&&this.fireEvent("select",this,e)}}}),Ext.reg("colorpalette",Ext.ColorPalette),Ext.DatePicker=Ext.extend(Ext.BoxComponent,{todayText:"Today",okText:"&#160;OK&#160;",cancelText:"Cancel",todayTip:"{0} (Spacebar)",minText:"This date is before the minimum date",maxText:"This date is after the maximum date",format:"m/d/y",disabledDaysText:"Disabled",disabledDatesText:"Disabled",monthNames:Date.monthNames,dayNames:Date.dayNames,nextText:"Next Month (Control+Right)",prevText:"Previous Month (Control+Left)",monthYearText:"Choose a month (Control+Up/Down to move years)",startDay:0,showToday:!0,focusOnSelect:!0,initHour:12,initComponent:function(){Ext.DatePicker.superclass.initComponent.call(this),this.value=this.value?this.value.clearTime(!0):(new Date).clearTime(),this.addEvents("select"),this.handler&&this.on("select",this.handler,this.scope||this),this.initDisabledDays()},initDisabledDays:function(){if(!this.disabledDatesRE&&this.disabledDates){var e=this.disabledDates,t=e.length-1,i="(?:";Ext.each(e,function(s,n){i+=Ext.isDate(s)?"^"+Ext.escapeRe(s.dateFormat(this.format))+"$":e[n],n!=t&&(i+="|")},this),this.disabledDatesRE=new RegExp(i+")")}},setDisabledDates:function(e){Ext.isArray(e)?(this.disabledDates=e,this.disabledDatesRE=null):this.disabledDatesRE=e,this.initDisabledDays(),this.update(this.value,!0)},setDisabledDays:function(e){this.disabledDays=e,this.update(this.value,!0)},setMinDate:function(e){this.minDate=e,this.update(this.value,!0)},setMaxDate:function(e){this.maxDate=e,this.update(this.value,!0)},setValue:function(e){this.value=e.clearTime(!0),this.update(this.value)},getValue:function(){return this.value},focus:function(){this.update(this.activeDate)},onEnable:function(e){Ext.DatePicker.superclass.onEnable.call(this),this.doDisabled(!1),this.update(e?this.value:this.activeDate),Ext.isIE&&this.el.repaint()},onDisable:function(){Ext.DatePicker.superclass.onDisable.call(this),this.doDisabled(!0),Ext.isIE&&!Ext.isIE8&&Ext.each([].concat(this.textNodes,this.el.query("th span")),function(e){Ext.fly(e).repaint()})},doDisabled:function(e){this.keyNav.setDisabled(e),this.prevRepeater.setDisabled(e),this.nextRepeater.setDisabled(e),this.showToday&&(this.todayKeyListener.setDisabled(e),this.todayBtn.setDisabled(e))},onRender:function(e,t){var i,s=['<table cellspacing="0">','<tr><td class="x-date-left"><a href="#" title="',this.prevText,'">&#160;</a></td><td class="x-date-middle" align="center"></td><td class="x-date-right"><a href="#" title="',this.nextText,'">&#160;</a></td></tr>','<tr><td colspan="3"><table class="x-date-inner" cellspacing="0"><thead><tr>'],n=this.dayNames;for(i=0;7>i;i++){var r=this.startDay+i;r>6&&(r-=7),s.push("<th><span>",n[r].substr(0,1),"</span></th>")}for(s[s.length]="</tr></thead><tbody><tr>",i=0;42>i;i++)0===i%7&&0!==i&&(s[s.length]="</tr><tr>"),s[s.length]='<td><a href="#" hidefocus="on" class="x-date-date" tabIndex="1"><em><span></span></em></a></td>';s.push("</tr></tbody></table></td></tr>",this.showToday?'<tr><td colspan="3" class="x-date-bottom" align="center"></td></tr>':"",'</table><div class="x-date-mp"></div>');var a=document.createElement("div");if(a.className="x-date-picker",a.innerHTML=s.join(""),e.dom.insertBefore(a,t),this.el=Ext.get(a),this.eventEl=Ext.get(a.firstChild),this.prevRepeater=new Ext.util.ClickRepeater(this.el.child("td.x-date-left a"),{handler:this.showPrevMonth,scope:this,preventDefault:!0,stopDefault:!0}),this.nextRepeater=new Ext.util.ClickRepeater(this.el.child("td.x-date-right a"),{handler:this.showNextMonth,scope:this,preventDefault:!0,stopDefault:!0}),this.monthPicker=this.el.down("div.x-date-mp"),this.monthPicker.enableDisplayMode("block"),this.keyNav=new Ext.KeyNav(this.eventEl,{left:function(e){e.ctrlKey?this.showPrevMonth():this.update(this.activeDate.add("d",-1))},right:function(e){e.ctrlKey?this.showNextMonth():this.update(this.activeDate.add("d",1))},up:function(e){e.ctrlKey?this.showNextYear():this.update(this.activeDate.add("d",-7))},down:function(e){e.ctrlKey?this.showPrevYear():this.update(this.activeDate.add("d",7))},pageUp:function(){this.showNextMonth()},pageDown:function(){this.showPrevMonth()
},enter:function(e){return e.stopPropagation(),!0},scope:this}),this.el.unselectable(),this.cells=this.el.select("table.x-date-inner tbody td"),this.textNodes=this.el.query("table.x-date-inner tbody span"),this.mbtn=new Ext.Button({text:"&#160;",tooltip:this.monthYearText,renderTo:this.el.child("td.x-date-middle",!0)}),this.mbtn.el.child("em").addClass("x-btn-arrow"),this.showToday){this.todayKeyListener=this.eventEl.addKeyListener(Ext.EventObject.SPACE,this.selectToday,this);var o=(new Date).dateFormat(this.format);this.todayBtn=new Ext.Button({renderTo:this.el.child("td.x-date-bottom",!0),text:String.format(this.todayText,o),tooltip:String.format(this.todayTip,o),handler:this.selectToday,scope:this})}this.mon(this.eventEl,"mousewheel",this.handleMouseWheel,this),this.mon(this.eventEl,"click",this.handleDateClick,this,{delegate:"a.x-date-date"}),this.mon(this.mbtn,"click",this.showMonthPicker,this),this.onEnable(!0)},createMonthPicker:function(){if(!this.monthPicker.dom.firstChild){for(var e=['<table border="0" cellspacing="0">'],t=0;6>t;t++)e.push('<tr><td class="x-date-mp-month"><a href="#">',Date.getShortMonthName(t),"</a></td>",'<td class="x-date-mp-month x-date-mp-sep"><a href="#">',Date.getShortMonthName(t+6),"</a></td>",0===t?'<td class="x-date-mp-ybtn" align="center"><a class="x-date-mp-prev"></a></td><td class="x-date-mp-ybtn" align="center"><a class="x-date-mp-next"></a></td></tr>':'<td class="x-date-mp-year"><a href="#"></a></td><td class="x-date-mp-year"><a href="#"></a></td></tr>');e.push('<tr class="x-date-mp-btns"><td colspan="4"><button type="button" class="x-date-mp-ok">',this.okText,'</button><button type="button" class="x-date-mp-cancel">',this.cancelText,"</button></td></tr>","</table>"),this.monthPicker.update(e.join("")),this.mon(this.monthPicker,"click",this.onMonthClick,this),this.mon(this.monthPicker,"dblclick",this.onMonthDblClick,this),this.mpMonths=this.monthPicker.select("td.x-date-mp-month"),this.mpYears=this.monthPicker.select("td.x-date-mp-year"),this.mpMonths.each(function(e,t,i){i+=1,e.dom.xmonth=0===i%2?5+Math.round(.5*i):Math.round(.5*(i-1))})}},showMonthPicker:function(){if(!this.disabled){this.createMonthPicker();var e=this.el.getSize();this.monthPicker.setSize(e),this.monthPicker.child("table").setSize(e),this.mpSelMonth=(this.activeDate||this.value).getMonth(),this.updateMPMonth(this.mpSelMonth),this.mpSelYear=(this.activeDate||this.value).getFullYear(),this.updateMPYear(this.mpSelYear),this.monthPicker.slideIn("t",{duration:.2})}},updateMPYear:function(e){this.mpyear=e;for(var t=this.mpYears.elements,i=1;10>=i;i++){var s,n=t[i-1];0===i%2?(s=e+Math.round(.5*i),n.firstChild.innerHTML=s,n.xyear=s):(s=e-(5-Math.round(.5*i)),n.firstChild.innerHTML=s,n.xyear=s),this.mpYears.item(i-1)[s==this.mpSelYear?"addClass":"removeClass"]("x-date-mp-sel")}},updateMPMonth:function(e){this.mpMonths.each(function(t){t[t.dom.xmonth==e?"addClass":"removeClass"]("x-date-mp-sel")})},selectMPMonth:function(){},onMonthClick:function(e,t){e.stopEvent();var i,s=new Ext.Element(t);if(s.is("button.x-date-mp-cancel"))this.hideMonthPicker();else if(s.is("button.x-date-mp-ok")){var n=new Date(this.mpSelYear,this.mpSelMonth,(this.activeDate||this.value).getDate());n.getMonth()!=this.mpSelMonth&&(n=new Date(this.mpSelYear,this.mpSelMonth,1).getLastDateOfMonth()),this.update(n),this.hideMonthPicker()}else(i=s.up("td.x-date-mp-month",2))?(this.mpMonths.removeClass("x-date-mp-sel"),i.addClass("x-date-mp-sel"),this.mpSelMonth=i.dom.xmonth):(i=s.up("td.x-date-mp-year",2))?(this.mpYears.removeClass("x-date-mp-sel"),i.addClass("x-date-mp-sel"),this.mpSelYear=i.dom.xyear):s.is("a.x-date-mp-prev")?this.updateMPYear(this.mpyear-10):s.is("a.x-date-mp-next")&&this.updateMPYear(this.mpyear+10)},onMonthDblClick:function(e,t){e.stopEvent();var i,s=new Ext.Element(t);(i=s.up("td.x-date-mp-month",2))?(this.update(new Date(this.mpSelYear,i.dom.xmonth,(this.activeDate||this.value).getDate())),this.hideMonthPicker()):(i=s.up("td.x-date-mp-year",2))&&(this.update(new Date(i.dom.xyear,this.mpSelMonth,(this.activeDate||this.value).getDate())),this.hideMonthPicker())},hideMonthPicker:function(e){this.monthPicker&&(e===!0?this.monthPicker.hide():this.monthPicker.slideOut("t",{duration:.2}))},showPrevMonth:function(){this.update(this.activeDate.add("mo",-1))},showNextMonth:function(){this.update(this.activeDate.add("mo",1))},showPrevYear:function(){this.update(this.activeDate.add("y",-1))},showNextYear:function(){this.update(this.activeDate.add("y",1))},handleMouseWheel:function(e){if(e.stopEvent(),!this.disabled){var t=e.getWheelDelta();t>0?this.showPrevMonth():0>t&&this.showNextMonth()}},handleDateClick:function(e,t){e.stopEvent(),this.disabled||!t.dateValue||Ext.fly(t.parentNode).hasClass("x-date-disabled")||(this.cancelFocus=this.focusOnSelect===!1,this.setValue(new Date(t.dateValue)),delete this.cancelFocus,this.fireEvent("select",this,this.value))},selectToday:function(){this.todayBtn&&!this.todayBtn.disabled&&(this.setValue((new Date).clearTime()),this.fireEvent("select",this,this.value))},update:function(e,t){if(this.rendered){var i=this.activeDate,s=this.isVisible();if(this.activeDate=e,!t&&i&&this.el){var n=e.getTime();if(i.getMonth()==e.getMonth()&&i.getFullYear()==e.getFullYear())return this.cells.removeClass("x-date-selected"),this.cells.each(function(e){return e.dom.firstChild.dateValue==n?(e.addClass("x-date-selected"),s&&!this.cancelFocus&&Ext.fly(e.dom.firstChild).focus(50),!1):void 0},this),void 0}var r=e.getDaysInMonth(),a=e.getFirstDateOfMonth(),o=a.getDay()-this.startDay;0>o&&(o+=7),r+=o;var l=e.add("mo",-1),h=l.getDaysInMonth()-o,u=this.cells.elements,c=this.textNodes,d=new Date(l.getFullYear(),l.getMonth(),h,this.initHour),p=(new Date).clearTime().getTime(),f=e.clearTime(!0).getTime(),m=this.minDate?this.minDate.clearTime(!0):Number.NEGATIVE_INFINITY,y=this.maxDate?this.maxDate.clearTime(!0):Number.POSITIVE_INFINITY,g=this.disabledDatesRE,v=this.disabledDatesText,x=this.disabledDays?this.disabledDays.join(""):!1,E=this.disabledDaysText,b=this.format;if(this.showToday){var L=(new Date).clearTime(),S=m>L||L>y||g&&b&&g.test(L.dateFormat(b))||x&&-1!=x.indexOf(L.getDay());this.disabled||(this.todayBtn.setDisabled(S),this.todayKeyListener[S?"disable":"enable"]())}for(var C=function(e,t){t.title="";var i=d.clearTime(!0).getTime();if(t.firstChild.dateValue=i,i==p&&(t.className+=" x-date-today",t.title=e.todayText),i==f&&(t.className+=" x-date-selected",s&&Ext.fly(t.firstChild).focus(50)),m>i)return t.className=" x-date-disabled",t.title=e.minText,void 0;if(i>y)return t.className=" x-date-disabled",t.title=e.maxText,void 0;if(x&&-1!=x.indexOf(d.getDay())&&(t.title=E,t.className=" x-date-disabled"),g&&b){var n=d.dateFormat(b);g.test(n)&&(t.title=v.replace("%0",n),t.className=" x-date-disabled")}},w=0;o>w;w++)c[w].innerHTML=++h,d.setDate(d.getDate()+1),u[w].className="x-date-prevday",C(this,u[w]);for(;r>w;w++){var O=w-o+1;c[w].innerHTML=O,d.setDate(d.getDate()+1),u[w].className="x-date-active",C(this,u[w])}for(var T=0;42>w;w++)c[w].innerHTML=++T,d.setDate(d.getDate()+1),u[w].className="x-date-nextday",C(this,u[w]);if(this.mbtn.setText(this.monthNames[e.getMonth()]+" "+e.getFullYear()),!this.internalRender){var M=this.el.dom.firstChild,P=M.offsetWidth;this.el.setWidth(P+this.el.getBorderWidth("lr")),Ext.fly(M).setWidth(P),this.internalRender=!0,Ext.isOpera&&!this.secondPass&&(M.rows[0].cells[1].style.width=P-(M.rows[0].cells[0].offsetWidth+M.rows[0].cells[2].offsetWidth)+"px",this.secondPass=!0,this.update.defer(10,this,[e]))}}},beforeDestroy:function(){this.rendered&&(Ext.destroy(this.keyNav,this.monthPicker,this.eventEl,this.mbtn,this.nextRepeater,this.prevRepeater,this.cells.el,this.todayBtn),delete this.textNodes,delete this.cells.elements)}}),Ext.reg("datepicker",Ext.DatePicker),Ext.LoadMask=function(e,t){if(this.el=Ext.get(e),Ext.apply(this,t),this.store)this.store.on({scope:this,beforeload:this.onBeforeLoad,load:this.onLoad,exception:this.onLoad}),this.removeMask=Ext.value(this.removeMask,!1);else{var i=this.el.getUpdater();i.showLoadIndicator=!1,i.on({scope:this,beforeupdate:this.onBeforeLoad,update:this.onLoad,failure:this.onLoad}),this.removeMask=Ext.value(this.removeMask,!0)}},Ext.LoadMask.prototype={msg:"Loading...",msgCls:"x-mask-loading",disabled:!1,disable:function(){this.disabled=!0},enable:function(){this.disabled=!1},onLoad:function(){this.el.unmask(this.removeMask)},onBeforeLoad:function(){this.disabled||this.el.mask(this.msg,this.msgCls)},show:function(){this.onBeforeLoad()},hide:function(){this.onLoad()},destroy:function(){if(this.store)this.store.un("beforeload",this.onBeforeLoad,this),this.store.un("load",this.onLoad,this),this.store.un("exception",this.onLoad,this);else{var e=this.el.getUpdater();e.un("beforeupdate",this.onBeforeLoad,this),e.un("update",this.onLoad,this),e.un("failure",this.onLoad,this)}}},Ext.slider.Thumb=Ext.extend(Object,{dragging:!1,constructor:function(e){Ext.apply(this,e||{},{cls:"x-slider-thumb",constrain:!1}),Ext.slider.Thumb.superclass.constructor.call(this,e),this.slider.vertical&&Ext.apply(this,Ext.slider.Thumb.Vertical)},render:function(){this.el=this.slider.innerEl.insertFirst({cls:this.cls}),this.initEvents()},enable:function(){this.disabled=!1,this.el.removeClass(this.slider.disabledClass)},disable:function(){this.disabled=!0,this.el.addClass(this.slider.disabledClass)},initEvents:function(){var e=this.el;e.addClassOnOver("x-slider-thumb-over"),this.tracker=new Ext.dd.DragTracker({onBeforeStart:this.onBeforeDragStart.createDelegate(this),onStart:this.onDragStart.createDelegate(this),onDrag:this.onDrag.createDelegate(this),onEnd:this.onDragEnd.createDelegate(this),tolerance:3,autoStart:300}),this.tracker.initEl(e)},onBeforeDragStart:function(){return this.disabled?!1:(this.slider.promoteThumb(this),!0)},onDragStart:function(e){this.el.addClass("x-slider-thumb-drag"),this.dragging=!0,this.dragStartValue=this.value,this.slider.fireEvent("dragstart",this.slider,e,this)},onDrag:function(e){var t=this.slider,i=this.index,s=this.getNewValue();if(this.constrain){var n=t.thumbs[i+1],r=t.thumbs[i-1];void 0!=r&&s<=r.value&&(s=r.value),void 0!=n&&s>=n.value&&(s=n.value)}t.setValue(i,s,!1),t.fireEvent("drag",t,e,this)},getNewValue:function(){var e=this.slider,t=e.innerEl.translatePoints(this.tracker.getXY());return Ext.util.Format.round(e.reverseValue(t.left),e.decimalPrecision)},onDragEnd:function(e){var t=this.slider,i=this.value;this.el.removeClass("x-slider-thumb-drag"),this.dragging=!1,t.fireEvent("dragend",t,e),this.dragStartValue!=i&&t.fireEvent("changecomplete",t,i,this)},destroy:function(){Ext.destroyMembers(this,"tracker","el")}}),Ext.slider.MultiSlider=Ext.extend(Ext.BoxComponent,{vertical:!1,minValue:0,maxValue:100,decimalPrecision:0,keyIncrement:1,increment:0,clickRange:[5,15],clickToChange:!0,animate:!0,constrainThumbs:!0,topThumbZIndex:1e4,initComponent:function(){Ext.isDefined(this.value)||(this.value=this.minValue),this.thumbs=[],Ext.slider.MultiSlider.superclass.initComponent.call(this),this.keyIncrement=Math.max(this.increment,this.keyIncrement),this.addEvents("beforechange","change","changecomplete","dragstart","drag","dragend"),(void 0==this.values||Ext.isEmpty(this.values))&&(this.values=[0]);for(var e=this.values,t=0;t<e.length;t++)this.addThumb(e[t]);this.vertical&&Ext.apply(this,Ext.slider.Vertical)},addThumb:function(e){var t=new Ext.slider.Thumb({value:e,slider:this,index:this.thumbs.length,constrain:this.constrainThumbs});this.thumbs.push(t),this.rendered&&t.render()},promoteThumb:function(e){for(var t,i,s=this.thumbs,n=0,r=s.length;r>n;n++)i=s[n],t=i==e?this.topThumbZIndex:"",i.el.setStyle("zIndex",t)},onRender:function(){this.autoEl={cls:"x-slider "+(this.vertical?"x-slider-vert":"x-slider-horz"),cn:{cls:"x-slider-end",cn:{cls:"x-slider-inner",cn:[{tag:"a",cls:"x-slider-focus",href:"#",tabIndex:"-1",hidefocus:"on"}]}}},Ext.slider.MultiSlider.superclass.onRender.apply(this,arguments),this.endEl=this.el.first(),this.innerEl=this.endEl.first(),this.focusEl=this.innerEl.child(".x-slider-focus");for(var e=0;e<this.thumbs.length;e++)this.thumbs[e].render();var t=this.innerEl.child(".x-slider-thumb");this.halfThumb=(this.vertical?t.getHeight():t.getWidth())/2,this.initEvents()},initEvents:function(){this.mon(this.el,{scope:this,mousedown:this.onMouseDown,keydown:this.onKeyDown}),this.focusEl.swallowEvent("click",!0)},onMouseDown:function(e){if(!this.disabled){for(var t=!1,i=0;i<this.thumbs.length;i++)t=t||e.target==this.thumbs[i].el.dom;if(this.clickToChange&&!t){var s=this.innerEl.translatePoints(e.getXY());this.onClickChange(s)}this.focus()}},onClickChange:function(e){if(e.top>this.clickRange[0]&&e.top<this.clickRange[1]){var t=this.getNearest(e,"left"),i=t.index;this.setValue(i,Ext.util.Format.round(this.reverseValue(e.left),this.decimalPrecision),void 0,!0)}},getNearest:function(e,t){for(var i="top"==t?this.innerEl.getHeight()-e[t]:e[t],s=this.reverseValue(i),n=this.maxValue-this.minValue+5,r=0,a=null,o=0;o<this.thumbs.length;o++){var l=this.thumbs[o],h=l.value,u=Math.abs(h-s);Math.abs(n>=u)&&(a=l,r=o,n=u)}return a},onKeyDown:function(e){if(this.disabled||1!==this.thumbs.length)return e.preventDefault(),void 0;var t,i=e.getKey();switch(i){case e.UP:case e.RIGHT:e.stopEvent(),t=e.ctrlKey?this.maxValue:this.getValue(0)+this.keyIncrement,this.setValue(0,t,void 0,!0);break;case e.DOWN:case e.LEFT:e.stopEvent(),t=e.ctrlKey?this.minValue:this.getValue(0)-this.keyIncrement,this.setValue(0,t,void 0,!0);break;default:e.preventDefault()}},doSnap:function(e){if(!this.increment||!e)return e;var t=e,i=this.increment,s=e%i;return 0!=s&&(t-=s,2*s>=i?t+=i:-i>2*s&&(t-=i)),t.constrain(this.minValue,this.maxValue)},afterRender:function(){Ext.slider.MultiSlider.superclass.afterRender.apply(this,arguments);for(var e=0;e<this.thumbs.length;e++){var t=this.thumbs[e];if(void 0!==t.value){var i=this.normalizeValue(t.value);i!==t.value?this.setValue(e,i,!1):this.moveThumb(e,this.translateValue(i),!1)}}},getRatio:function(){var e=this.innerEl.getWidth(),t=this.maxValue-this.minValue;return 0==t?e:e/t},normalizeValue:function(e){return e=this.doSnap(e),e=Ext.util.Format.round(e,this.decimalPrecision),e=e.constrain(this.minValue,this.maxValue)},setMinValue:function(e){this.minValue=e;for(var t,i=0,s=this.thumbs,n=s.length;n>i;++i)t=s[i],t.value=t.value<e?e:t.value;this.syncThumb()},setMaxValue:function(e){this.maxValue=e;for(var t,i=0,s=this.thumbs,n=s.length;n>i;++i)t=s[i],t.value=t.value>e?e:t.value;this.syncThumb()},setValue:function(e,t,i,s){var n=this.thumbs[e];n.el,t=this.normalizeValue(t),t!==n.value&&this.fireEvent("beforechange",this,t,n.value,n)!==!1&&(n.value=t,this.rendered&&(this.moveThumb(e,this.translateValue(t),i!==!1),this.fireEvent("change",this,t,n),s&&this.fireEvent("changecomplete",this,t,n)))},translateValue:function(e){var t=this.getRatio();return e*t-this.minValue*t-this.halfThumb},reverseValue:function(e){var t=this.getRatio();return(e+this.minValue*t)/t},moveThumb:function(e,t,i){var s=this.thumbs[e].el;i&&this.animate!==!1?s.shift({left:t,stopFx:!0,duration:.35}):s.setLeft(t)},focus:function(){this.focusEl.focus(10)},onResize:function(e){for(var t=this.thumbs,i=t.length,s=0;i>s;++s)t[s].el.stopFx();Ext.isNumber(e)&&this.innerEl.setWidth(e-(this.el.getPadding("l")+this.endEl.getPadding("r"))),this.syncThumb(),Ext.slider.MultiSlider.superclass.onResize.apply(this,arguments)},onDisable:function(){Ext.slider.MultiSlider.superclass.onDisable.call(this);for(var e=0;e<this.thumbs.length;e++){var t=this.thumbs[e],i=t.el;if(t.disable(),Ext.isIE){var s=i.getXY();i.hide(),this.innerEl.addClass(this.disabledClass).dom.disabled=!0,this.thumbHolder||(this.thumbHolder=this.endEl.createChild({cls:"x-slider-thumb "+this.disabledClass})),this.thumbHolder.show().setXY(s)}}},onEnable:function(){Ext.slider.MultiSlider.superclass.onEnable.call(this);for(var e=0;e<this.thumbs.length;e++){var t=this.thumbs[e],i=t.el;t.enable(),Ext.isIE&&(this.innerEl.removeClass(this.disabledClass).dom.disabled=!1,this.thumbHolder&&this.thumbHolder.hide(),i.show(),this.syncThumb())}},syncThumb:function(){if(this.rendered)for(var e=0;e<this.thumbs.length;e++)this.moveThumb(e,this.translateValue(this.thumbs[e].value))},getValue:function(e){return this.thumbs[e].value},getValues:function(){for(var e=[],t=0;t<this.thumbs.length;t++)e.push(this.thumbs[t].value);return e},beforeDestroy:function(){for(var e=this.thumbs,t=0,i=e.length;i>t;++t)e[t].destroy(),e[t]=null;Ext.destroyMembers(this,"endEl","innerEl","focusEl","thumbHolder"),Ext.slider.MultiSlider.superclass.beforeDestroy.call(this)}}),Ext.reg("multislider",Ext.slider.MultiSlider),Ext.slider.SingleSlider=Ext.extend(Ext.slider.MultiSlider,{constructor:function(e){e=e||{},Ext.applyIf(e,{values:[e.value||0]}),Ext.slider.SingleSlider.superclass.constructor.call(this,e)},getValue:function(){return Ext.slider.SingleSlider.superclass.getValue.call(this,0)},setValue:function(){var e=Ext.toArray(arguments),t=e.length;return(1==t||3>=t&&"number"!=typeof arguments[1])&&e.unshift(0),Ext.slider.SingleSlider.superclass.setValue.apply(this,e)},syncThumb:function(){return Ext.slider.SingleSlider.superclass.syncThumb.apply(this,[0].concat(arguments))},getNearest:function(){return this.thumbs[0]}}),Ext.Slider=Ext.slider.SingleSlider,Ext.reg("slider",Ext.slider.SingleSlider),Ext.slider.Vertical={onResize:function(e,t){this.innerEl.setHeight(t-(this.el.getPadding("t")+this.endEl.getPadding("b"))),this.syncThumb()},getRatio:function(){var e=this.innerEl.getHeight(),t=this.maxValue-this.minValue;return e/t},moveThumb:function(e,t,i){var s=this.thumbs[e],n=s.el;i&&this.animate!==!1?n.shift({bottom:t,stopFx:!0,duration:.35}):n.setBottom(t)},onClickChange:function(e){if(e.left>this.clickRange[0]&&e.left<this.clickRange[1]){var t=this.getNearest(e,"top"),i=t.index,s=this.minValue+this.reverseValue(this.innerEl.getHeight()-e.top);this.setValue(i,Ext.util.Format.round(s,this.decimalPrecision),void 0,!0)}}},Ext.slider.Thumb.Vertical={getNewValue:function(){var e=this.slider,t=e.innerEl,i=t.translatePoints(this.tracker.getXY()),s=t.getHeight()-i.top;return e.minValue+Ext.util.Format.round(s/e.getRatio(),e.decimalPrecision)}},Ext.ProgressBar=Ext.extend(Ext.BoxComponent,{baseCls:"x-progress",animate:!1,waitTimer:null,initComponent:function(){Ext.ProgressBar.superclass.initComponent.call(this),this.addEvents("update")},onRender:function(e,t){var i=new Ext.Template('<div class="{cls}-wrap">','<div class="{cls}-inner">','<div class="{cls}-bar">','<div class="{cls}-text">',"<div>&#160;</div>","</div>","</div>",'<div class="{cls}-text {cls}-text-back">',"<div>&#160;</div>","</div>","</div>","</div>");this.el=t?i.insertBefore(t,{cls:this.baseCls},!0):i.append(e,{cls:this.baseCls},!0),this.id&&(this.el.dom.id=this.id);var s=this.el.dom.firstChild;if(this.progressBar=Ext.get(s.firstChild),this.textEl)this.textEl=Ext.get(this.textEl),delete this.textTopEl;else{this.textTopEl=Ext.get(this.progressBar.dom.firstChild);var n=Ext.get(s.childNodes[1]);this.textTopEl.setStyle("z-index",99).addClass("x-hidden"),this.textEl=new Ext.CompositeElement([this.textTopEl.dom.firstChild,n.dom.firstChild]),this.textEl.setWidth(s.offsetWidth)}this.progressBar.setHeight(s.offsetHeight)},afterRender:function(){Ext.ProgressBar.superclass.afterRender.call(this),this.value?this.updateProgress(this.value,this.text):this.updateText(this.text)},updateProgress:function(e,t,i){if(this.value=e||0,t&&this.updateText(t),this.rendered&&!this.isDestroyed){var s=Math.floor(e*this.el.dom.firstChild.offsetWidth);this.progressBar.setWidth(s,i===!0||i!==!1&&this.animate),this.textTopEl&&this.textTopEl.removeClass("x-hidden").setWidth(s)}return this.fireEvent("update",this,e,t),this},wait:function(e){if(!this.waitTimer){var t=this;e=e||{},this.updateText(e.text),this.waitTimer=Ext.TaskMgr.start({run:function(t){var i=e.increment||10;t-=1,this.updateProgress(.01*((t+i)%i+1)*(100/i),null,e.animate)},interval:e.interval||1e3,duration:e.duration,onStop:function(){e.fn&&e.fn.apply(e.scope||this),this.reset()},scope:t})}return this},isWaiting:function(){return null!==this.waitTimer},updateText:function(e){return this.text=e||"&#160;",this.rendered&&this.textEl.update(this.text),this},syncProgressBar:function(){return this.value&&this.updateProgress(this.value,this.text),this},setSize:function(e,t){if(Ext.ProgressBar.superclass.setSize.call(this,e,t),this.textTopEl){var i=this.el.dom.firstChild;this.textEl.setSize(i.offsetWidth,i.offsetHeight)}return this.syncProgressBar(),this},reset:function(e){return this.updateProgress(0),this.textTopEl&&this.textTopEl.addClass("x-hidden"),this.clearTimer(),e===!0&&this.hide(),this},clearTimer:function(){this.waitTimer&&(this.waitTimer.onStop=null,Ext.TaskMgr.stop(this.waitTimer),this.waitTimer=null)},onDestroy:function(){this.clearTimer(),this.rendered&&(this.textEl.isComposite&&this.textEl.clear(),Ext.destroyMembers(this,"textEl","progressBar","textTopEl")),Ext.ProgressBar.superclass.onDestroy.call(this)}}),Ext.reg("progress",Ext.ProgressBar),function(){var e=Ext.EventManager,t=Ext.lib.Dom;Ext.dd.DragDrop=function(e,t,i){e&&this.init(e,t,i)},Ext.dd.DragDrop.prototype={id:null,config:null,dragElId:null,handleElId:null,invalidHandleTypes:null,invalidHandleIds:null,invalidHandleClasses:null,startPageX:0,startPageY:0,groups:null,locked:!1,lock:function(){this.locked=!0},moveOnly:!1,unlock:function(){this.locked=!1},isTarget:!0,padding:null,_domRef:null,__ygDragDrop:!0,constrainX:!1,constrainY:!1,minX:0,maxX:0,minY:0,maxY:0,maintainOffset:!1,xTicks:null,yTicks:null,primaryButtonOnly:!0,available:!1,hasOuterHandles:!1,b4StartDrag:function(){},startDrag:function(){},b4Drag:function(){},onDrag:function(){},onDragEnter:function(){},b4DragOver:function(){},onDragOver:function(){},b4DragOut:function(){},onDragOut:function(){},b4DragDrop:function(){},onDragDrop:function(){},onInvalidDrop:function(){},b4EndDrag:function(){},endDrag:function(){},b4MouseDown:function(){},onMouseDown:function(){},onMouseUp:function(){},onAvailable:function(){},defaultPadding:{left:0,right:0,top:0,bottom:0},constrainTo:function(e,t){Ext.isNumber(t)&&(t={left:t,right:t,top:t,bottom:t}),t=t||this.defaultPadding;var i,s=Ext.get(this.getEl()).getBox(),n=Ext.get(e),r=n.getScroll(),a=n.dom;if(a==document.body)i={x:r.left,y:r.top,width:Ext.lib.Dom.getViewWidth(),height:Ext.lib.Dom.getViewHeight()};else{var o=n.getXY();i={x:o[0],y:o[1],width:a.clientWidth,height:a.clientHeight}}var l=s.y-i.y,h=s.x-i.x;this.resetConstraints(),this.setXConstraint(h-(t.left||0),i.width-h-s.width-(t.right||0),this.xTickSize),this.setYConstraint(l-(t.top||0),i.height-l-s.height-(t.bottom||0),this.yTickSize)},getEl:function(){return this._domRef||(this._domRef=Ext.getDom(this.id)),this._domRef},getDragEl:function(){return Ext.getDom(this.dragElId)},init:function(t,i,s){this.initTarget(t,i,s),e.on(this.id,"mousedown",this.handleMouseDown,this)},initTarget:function(e,t,i){this.config=i||{},this.DDM=Ext.dd.DDM,this.groups={},"string"!=typeof e&&(e=Ext.id(e)),this.id=e,this.addToGroup(t?t:"default"),this.handleElId=e,this.setDragElId(e),this.invalidHandleTypes={A:"A"},this.invalidHandleIds={},this.invalidHandleClasses=[],this.applyConfig(),this.handleOnAvailable()},applyConfig:function(){this.padding=this.config.padding||[0,0,0,0],this.isTarget=this.config.isTarget!==!1,this.maintainOffset=this.config.maintainOffset,this.primaryButtonOnly=this.config.primaryButtonOnly!==!1},handleOnAvailable:function(){this.available=!0,this.resetConstraints(),this.onAvailable()},setPadding:function(e,t,i,s){this.padding=t||0===t?i||0===i?[e,t,i,s]:[e,t,e,t]:[e,e,e,e]},setInitPosition:function(e,i){var s=this.getEl();if(this.DDM.verifyEl(s)){var n=e||0,r=i||0,a=t.getXY(s);this.initPageX=a[0]-n,this.initPageY=a[1]-r,this.lastPageX=a[0],this.lastPageY=a[1],this.setStartPosition(a)}},setStartPosition:function(e){var i=e||t.getXY(this.getEl());this.deltaSetXY=null,this.startPageX=i[0],this.startPageY=i[1]},addToGroup:function(e){this.groups[e]=!0,this.DDM.regDragDrop(this,e)},removeFromGroup:function(e){this.groups[e]&&delete this.groups[e],this.DDM.removeDDFromGroup(this,e)},setDragElId:function(e){this.dragElId=e},setHandleElId:function(e){"string"!=typeof e&&(e=Ext.id(e)),this.handleElId=e,this.DDM.regHandle(this.id,e)},setOuterHandleElId:function(t){"string"!=typeof t&&(t=Ext.id(t)),e.on(t,"mousedown",this.handleMouseDown,this),this.setHandleElId(t),this.hasOuterHandles=!0},unreg:function(){e.un(this.id,"mousedown",this.handleMouseDown),this._domRef=null,this.DDM._remove(this)},destroy:function(){this.unreg()},isLocked:function(){return this.DDM.isLocked()||this.locked},handleMouseDown:function(e){if(!(this.primaryButtonOnly&&0!=e.button||this.isLocked())){this.DDM.refreshCache(this.groups);var t=new Ext.lib.Point(Ext.lib.Event.getPageX(e),Ext.lib.Event.getPageY(e));(this.hasOuterHandles||this.DDM.isOverTarget(t,this))&&this.clickValidator(e)&&(this.setStartPosition(),this.b4MouseDown(e),this.onMouseDown(e),this.DDM.handleMouseDown(e,this),this.DDM.stopEvent(e))}},clickValidator:function(e){var t=e.getTarget();return this.isValidHandleChild(t)&&(this.id==this.handleElId||this.DDM.handleWasClicked(t,this.id))},addInvalidHandleType:function(e){var t=e.toUpperCase();this.invalidHandleTypes[t]=t},addInvalidHandleId:function(e){"string"!=typeof e&&(e=Ext.id(e)),this.invalidHandleIds[e]=e},addInvalidHandleClass:function(e){this.invalidHandleClasses.push(e)},removeInvalidHandleType:function(e){var t=e.toUpperCase();delete this.invalidHandleTypes[t]},removeInvalidHandleId:function(e){"string"!=typeof e&&(e=Ext.id(e)),delete this.invalidHandleIds[e]},removeInvalidHandleClass:function(e){for(var t=0,i=this.invalidHandleClasses.length;i>t;++t)this.invalidHandleClasses[t]==e&&delete this.invalidHandleClasses[t]},isValidHandleChild:function(e){var t,i=!0;try{t=e.nodeName.toUpperCase()}catch(s){t=e.nodeName}i=i&&!this.invalidHandleTypes[t],i=i&&!this.invalidHandleIds[e.id];for(var n=0,r=this.invalidHandleClasses.length;i&&r>n;++n)i=!Ext.fly(e).hasClass(this.invalidHandleClasses[n]);return i},setXTicks:function(e,t){this.xTicks=[],this.xTickSize=t;for(var i={},s=this.initPageX;s>=this.minX;s-=t)i[s]||(this.xTicks[this.xTicks.length]=s,i[s]=!0);for(s=this.initPageX;s<=this.maxX;s+=t)i[s]||(this.xTicks[this.xTicks.length]=s,i[s]=!0);this.xTicks.sort(this.DDM.numericSort)},setYTicks:function(e,t){this.yTicks=[],this.yTickSize=t;for(var i={},s=this.initPageY;s>=this.minY;s-=t)i[s]||(this.yTicks[this.yTicks.length]=s,i[s]=!0);for(s=this.initPageY;s<=this.maxY;s+=t)i[s]||(this.yTicks[this.yTicks.length]=s,i[s]=!0);this.yTicks.sort(this.DDM.numericSort)},setXConstraint:function(e,t,i){this.leftConstraint=e,this.rightConstraint=t,this.minX=this.initPageX-e,this.maxX=this.initPageX+t,i&&this.setXTicks(this.initPageX,i),this.constrainX=!0},clearConstraints:function(){this.constrainX=!1,this.constrainY=!1,this.clearTicks()},clearTicks:function(){this.xTicks=null,this.yTicks=null,this.xTickSize=0,this.yTickSize=0},setYConstraint:function(e,t,i){this.topConstraint=e,this.bottomConstraint=t,this.minY=this.initPageY-e,this.maxY=this.initPageY+t,i&&this.setYTicks(this.initPageY,i),this.constrainY=!0},resetConstraints:function(){if(this.initPageX||0===this.initPageX){var e=this.maintainOffset?this.lastPageX-this.initPageX:0,t=this.maintainOffset?this.lastPageY-this.initPageY:0;this.setInitPosition(e,t)}else this.setInitPosition();this.constrainX&&this.setXConstraint(this.leftConstraint,this.rightConstraint,this.xTickSize),this.constrainY&&this.setYConstraint(this.topConstraint,this.bottomConstraint,this.yTickSize)},getTick:function(e,t){if(t){if(t[0]>=e)return t[0];for(var i=0,s=t.length;s>i;++i){var n=i+1;if(t[n]&&t[n]>=e){var r=e-t[i],a=t[n]-e;return a>r?t[i]:t[n]}}return t[t.length-1]}return e},toString:function(){return"DragDrop "+this.id}}}(),Ext.dd.DragDropMgr||(Ext.dd.DragDropMgr=function(){var e=Ext.EventManager;return{ids:{},handleIds:{},dragCurrent:null,dragOvers:{},deltaX:0,deltaY:0,preventDefault:!0,stopPropagation:!0,initialized:!1,locked:!1,init:function(){this.initialized=!0},POINT:0,INTERSECT:1,mode:0,_execOnAll:function(e,t){for(var i in this.ids)for(var s in this.ids[i]){var n=this.ids[i][s];this.isTypeOfDD(n)&&n[e].apply(n,t)}},_onLoad:function(){this.init(),e.on(document,"mouseup",this.handleMouseUp,this,!0),e.on(document,"mousemove",this.handleMouseMove,this,!0),e.on(window,"unload",this._onUnload,this,!0),e.on(window,"resize",this._onResize,this,!0)},_onResize:function(){this._execOnAll("resetConstraints",[])},lock:function(){this.locked=!0},unlock:function(){this.locked=!1},isLocked:function(){return this.locked},locationCache:{},useCache:!0,clickPixelThresh:3,clickTimeThresh:350,dragThreshMet:!1,clickTimeout:null,startX:0,startY:0,regDragDrop:function(e,t){this.initialized||this.init(),this.ids[t]||(this.ids[t]={}),this.ids[t][e.id]=e},removeDDFromGroup:function(e,t){this.ids[t]||(this.ids[t]={});var i=this.ids[t];i&&i[e.id]&&delete i[e.id]},_remove:function(e){for(var t in e.groups)t&&this.ids[t]&&this.ids[t][e.id]&&delete this.ids[t][e.id];delete this.handleIds[e.id]},regHandle:function(e,t){this.handleIds[e]||(this.handleIds[e]={}),this.handleIds[e][t]=t},isDragDrop:function(e){return this.getDDById(e)?!0:!1},getRelated:function(e,t){var i=[];for(var s in e.groups)for(var n in this.ids[s]){var r=this.ids[s][n];this.isTypeOfDD(r)&&(!t||r.isTarget)&&(i[i.length]=r)}return i},isLegalTarget:function(e,t){for(var i=this.getRelated(e,!0),s=0,n=i.length;n>s;++s)if(i[s].id==t.id)return!0;return!1},isTypeOfDD:function(e){return e&&e.__ygDragDrop},isHandle:function(e,t){return this.handleIds[e]&&this.handleIds[e][t]},getDDById:function(e){for(var t in this.ids)if(this.ids[t][e])return this.ids[t][e];return null},handleMouseDown:function(e,t){Ext.QuickTips&&Ext.QuickTips.ddDisable(),this.dragCurrent&&this.handleMouseUp(e),this.currentTarget=e.getTarget(),this.dragCurrent=t;var i=t.getEl();this.startX=e.getPageX(),this.startY=e.getPageY(),this.deltaX=this.startX-i.offsetLeft,this.deltaY=this.startY-i.offsetTop,this.dragThreshMet=!1,this.clickTimeout=setTimeout(function(){var e=Ext.dd.DDM;e.startDrag(e.startX,e.startY)},this.clickTimeThresh)},startDrag:function(e,t){clearTimeout(this.clickTimeout),this.dragCurrent&&(this.dragCurrent.b4StartDrag(e,t),this.dragCurrent.startDrag(e,t)),this.dragThreshMet=!0},handleMouseUp:function(e){Ext.QuickTips&&Ext.QuickTips.ddEnable(),this.dragCurrent&&(clearTimeout(this.clickTimeout),this.dragThreshMet&&this.fireEvents(e,!0),this.stopDrag(e),this.stopEvent(e))},stopEvent:function(e){this.stopPropagation&&e.stopPropagation(),this.preventDefault&&e.preventDefault()},stopDrag:function(e){this.dragCurrent&&(this.dragThreshMet&&(this.dragCurrent.b4EndDrag(e),this.dragCurrent.endDrag(e)),this.dragCurrent.onMouseUp(e)),this.dragCurrent=null,this.dragOvers={}},handleMouseMove:function(e){if(!this.dragCurrent)return!0;if(Ext.isIE&&0!==e.button&&1!==e.button&&2!==e.button)return this.stopEvent(e),this.handleMouseUp(e);if(!this.dragThreshMet){var t=Math.abs(this.startX-e.getPageX()),i=Math.abs(this.startY-e.getPageY());(t>this.clickPixelThresh||i>this.clickPixelThresh)&&this.startDrag(this.startX,this.startY)}return this.dragThreshMet&&(this.dragCurrent.b4Drag(e),this.dragCurrent.onDrag(e),this.dragCurrent.moveOnly||this.fireEvents(e,!1)),this.stopEvent(e),!0},fireEvents:function(e,t){var i=this.dragCurrent;if(i&&!i.isLocked()){var s=e.getPoint(),n=[],r=[],a=[],o=[],l=[];for(var h in this.dragOvers){var u=this.dragOvers[h];this.isTypeOfDD(u)&&(this.isOverTarget(s,u,this.mode)||r.push(u),n[h]=!0,delete this.dragOvers[h])}for(var c in i.groups)if("string"==typeof c)for(h in this.ids[c]){var d=this.ids[c][h];this.isTypeOfDD(d)&&(!d.isTarget||d.isLocked()||d==i&&i.ignoreSelf!==!1||this.isOverTarget(s,d,this.mode)&&(t?o.push(d):(n[d.id]?a.push(d):l.push(d),this.dragOvers[d.id]=d)))}if(this.mode)r.length&&(i.b4DragOut(e,r),i.onDragOut(e,r)),l.length&&i.onDragEnter(e,l),a.length&&(i.b4DragOver(e,a),i.onDragOver(e,a)),o.length&&(i.b4DragDrop(e,o),i.onDragDrop(e,o));else{var p=0;for(h=0,p=r.length;p>h;++h)i.b4DragOut(e,r[h].id),i.onDragOut(e,r[h].id);for(h=0,p=l.length;p>h;++h)i.onDragEnter(e,l[h].id);for(h=0,p=a.length;p>h;++h)i.b4DragOver(e,a[h].id),i.onDragOver(e,a[h].id);for(h=0,p=o.length;p>h;++h)i.b4DragDrop(e,o[h].id),i.onDragDrop(e,o[h].id)}t&&!o.length&&i.onInvalidDrop(e)}},getBestMatch:function(e){var t=null,i=e.length;if(1==i)t=e[0];else for(var s=0;i>s;++s){var n=e[s];if(n.cursorIsOver){t=n;break}(!t||t.overlap.getArea()<n.overlap.getArea())&&(t=n)}return t},refreshCache:function(e){for(var t in e)if("string"==typeof t)for(var i in this.ids[t]){var s=this.ids[t][i];if(this.isTypeOfDD(s)){var n=this.getLocation(s);
n?this.locationCache[s.id]=n:delete this.locationCache[s.id]}}},verifyEl:function(e){if(e){var t;if(Ext.isIE)try{t=e.offsetParent}catch(i){}else t=e.offsetParent;if(t)return!0}return!1},getLocation:function(e){if(!this.isTypeOfDD(e))return null;var t,i,s,n,r,a,o,l,h,u,c=e.getEl();try{t=Ext.lib.Dom.getXY(c)}catch(d){}if(!t)return null;for(i=t[0],s=i+c.offsetWidth,n=t[1],r=n+c.offsetHeight,a=n-e.padding[0],o=s+e.padding[1],l=r+e.padding[2],h=i-e.padding[3],u=new Ext.lib.Region(a,o,l,h),c=Ext.get(c.parentNode);c&&u;)c.isScrollable()&&(u=u.intersect(c.getRegion())),c=c.parent();return u},isOverTarget:function(e,t,i){var s=this.locationCache[t.id];if(s&&this.useCache||(s=this.getLocation(t),this.locationCache[t.id]=s),!s)return!1;t.cursorIsOver=s.contains(e);var n=this.dragCurrent;if(!n||!n.getTargetCoord||!i&&!n.constrainX&&!n.constrainY)return t.cursorIsOver;t.overlap=null;var r=n.getTargetCoord(e.x,e.y),a=n.getDragEl(),o=new Ext.lib.Region(r.y,r.x+a.offsetWidth,r.y+a.offsetHeight,r.x),l=o.intersect(s);return l?(t.overlap=l,i?!0:t.cursorIsOver):!1},_onUnload:function(){e.removeListener(document,"mouseup",this.handleMouseUp,this),e.removeListener(document,"mousemove",this.handleMouseMove,this),e.removeListener(window,"resize",this._onResize,this),Ext.dd.DragDropMgr.unregAll()},unregAll:function(){this.dragCurrent&&(this.stopDrag(),this.dragCurrent=null),this._execOnAll("unreg",[]);for(var e in this.elementCache)delete this.elementCache[e];this.elementCache={},this.ids={}},elementCache:{},getElWrapper:function(e){var t=this.elementCache[e];return t&&t.el||(t=this.elementCache[e]=new this.ElementWrapper(Ext.getDom(e))),t},getElement:function(e){return Ext.getDom(e)},getCss:function(e){var t=Ext.getDom(e);return t?t.style:null},ElementWrapper:function(e){this.el=e||null,this.id=this.el&&e.id,this.css=this.el&&e.style},getPosX:function(e){return Ext.lib.Dom.getX(e)},getPosY:function(e){return Ext.lib.Dom.getY(e)},swapNode:function(e,t){if(e.swapNode)e.swapNode(t);else{var i=t.parentNode,s=t.nextSibling;s==e?i.insertBefore(e,t):t==e.nextSibling?i.insertBefore(t,e):(e.parentNode.replaceChild(t,e),i.insertBefore(e,s))}},getScroll:function(){var e,t,i=document.documentElement,s=document.body;return i&&(i.scrollTop||i.scrollLeft)?(e=i.scrollTop,t=i.scrollLeft):s&&(e=s.scrollTop,t=s.scrollLeft),{top:e,left:t}},getStyle:function(e,t){return Ext.fly(e).getStyle(t)},getScrollTop:function(){return this.getScroll().top},getScrollLeft:function(){return this.getScroll().left},moveToEl:function(e,t){var i=Ext.lib.Dom.getXY(t);Ext.lib.Dom.setXY(e,i)},numericSort:function(e,t){return e-t},_timeoutCount:0,_addListeners:function(){var e=Ext.dd.DDM;Ext.lib.Event&&document?e._onLoad():e._timeoutCount>2e3||(setTimeout(e._addListeners,10),document&&document.body&&(e._timeoutCount+=1))},handleWasClicked:function(e,t){if(this.isHandle(t,e.id))return!0;for(var i=e.parentNode;i;){if(this.isHandle(t,i.id))return!0;i=i.parentNode}return!1}}}(),Ext.dd.DDM=Ext.dd.DragDropMgr,Ext.dd.DDM._addListeners()),Ext.dd.DD=function(e,t,i){e&&this.init(e,t,i)},Ext.extend(Ext.dd.DD,Ext.dd.DragDrop,{scroll:!0,autoOffset:function(e,t){var i=e-this.startPageX,s=t-this.startPageY;this.setDelta(i,s)},setDelta:function(e,t){this.deltaX=e,this.deltaY=t},setDragElPos:function(e,t){var i=this.getDragEl();this.alignElWithMouse(i,e,t)},alignElWithMouse:function(e,t,i){var s=this.getTargetCoord(t,i),n=e.dom?e:Ext.fly(e,"_dd");if(this.deltaSetXY)n.setLeftTop(s.x+this.deltaSetXY[0],s.y+this.deltaSetXY[1]);else{var r=[s.x,s.y];n.setXY(r);var a=n.getLeft(!0),o=n.getTop(!0);this.deltaSetXY=[a-s.x,o-s.y]}return this.cachePosition(s.x,s.y),this.autoScroll(s.x,s.y,e.offsetHeight,e.offsetWidth),s},cachePosition:function(e,t){if(e)this.lastPageX=e,this.lastPageY=t;else{var i=Ext.lib.Dom.getXY(this.getEl());this.lastPageX=i[0],this.lastPageY=i[1]}},autoScroll:function(e,t,i,s){if(this.scroll){var n=Ext.lib.Dom.getViewHeight(),r=Ext.lib.Dom.getViewWidth(),a=this.DDM.getScrollTop(),o=this.DDM.getScrollLeft(),l=i+t,h=s+e,u=n+a-t-this.deltaY,c=r+o-e-this.deltaX,d=40,p=document.all?80:30;l>n&&d>u&&window.scrollTo(o,a+p),a>t&&a>0&&d>t-a&&window.scrollTo(o,a-p),h>r&&d>c&&window.scrollTo(o+p,a),o>e&&o>0&&d>e-o&&window.scrollTo(o-p,a)}},getTargetCoord:function(e,t){var i=e-this.deltaX,s=t-this.deltaY;return this.constrainX&&(i<this.minX&&(i=this.minX),i>this.maxX&&(i=this.maxX)),this.constrainY&&(s<this.minY&&(s=this.minY),s>this.maxY&&(s=this.maxY)),i=this.getTick(i,this.xTicks),s=this.getTick(s,this.yTicks),{x:i,y:s}},applyConfig:function(){Ext.dd.DD.superclass.applyConfig.call(this),this.scroll=this.config.scroll!==!1},b4MouseDown:function(e){this.autoOffset(e.getPageX(),e.getPageY())},b4Drag:function(e){this.setDragElPos(e.getPageX(),e.getPageY())},toString:function(){return"DD "+this.id}}),Ext.dd.DDProxy=function(e,t,i){e&&(this.init(e,t,i),this.initFrame())},Ext.dd.DDProxy.dragElId="ygddfdiv",Ext.extend(Ext.dd.DDProxy,Ext.dd.DD,{resizeFrame:!0,centerFrame:!1,createFrame:function(){var e=this,t=document.body;if(!t||!t.firstChild)return setTimeout(function(){e.createFrame()},50),void 0;var i=this.getDragEl();if(!i){i=document.createElement("div"),i.id=this.dragElId;var s=i.style;s.position="absolute",s.visibility="hidden",s.cursor="move",s.border="2px solid #aaa",s.zIndex=999,t.insertBefore(i,t.firstChild)}},initFrame:function(){this.createFrame()},applyConfig:function(){Ext.dd.DDProxy.superclass.applyConfig.call(this),this.resizeFrame=this.config.resizeFrame!==!1,this.centerFrame=this.config.centerFrame,this.setDragElId(this.config.dragElId||Ext.dd.DDProxy.dragElId)},showFrame:function(e,t){this.getEl();var i=this.getDragEl(),s=i.style;this._resizeProxy(),this.centerFrame&&this.setDelta(Math.round(parseInt(s.width,10)/2),Math.round(parseInt(s.height,10)/2)),this.setDragElPos(e,t),Ext.fly(i).show()},_resizeProxy:function(){if(this.resizeFrame){var e=this.getEl();Ext.fly(this.getDragEl()).setSize(e.offsetWidth,e.offsetHeight)}},b4MouseDown:function(e){var t=e.getPageX(),i=e.getPageY();this.autoOffset(t,i),this.setDragElPos(t,i)},b4StartDrag:function(e,t){this.showFrame(e,t)},b4EndDrag:function(){Ext.fly(this.getDragEl()).hide()},endDrag:function(){var e=this.getEl(),t=this.getDragEl();t.style.visibility="",this.beforeMove(),e.style.visibility="hidden",Ext.dd.DDM.moveToEl(e,t),t.style.visibility="hidden",e.style.visibility="",this.afterDrag()},beforeMove:function(){},afterDrag:function(){},toString:function(){return"DDProxy "+this.id}}),Ext.dd.DDTarget=function(e,t,i){e&&this.initTarget(e,t,i)},Ext.extend(Ext.dd.DDTarget,Ext.dd.DragDrop,{getDragEl:Ext.emptyFn,isValidHandleChild:Ext.emptyFn,startDrag:Ext.emptyFn,endDrag:Ext.emptyFn,onDrag:Ext.emptyFn,onDragDrop:Ext.emptyFn,onDragEnter:Ext.emptyFn,onDragOut:Ext.emptyFn,onDragOver:Ext.emptyFn,onInvalidDrop:Ext.emptyFn,onMouseDown:Ext.emptyFn,onMouseUp:Ext.emptyFn,setXConstraint:Ext.emptyFn,setYConstraint:Ext.emptyFn,resetConstraints:Ext.emptyFn,clearConstraints:Ext.emptyFn,clearTicks:Ext.emptyFn,setInitPosition:Ext.emptyFn,setDragElId:Ext.emptyFn,setHandleElId:Ext.emptyFn,setOuterHandleElId:Ext.emptyFn,addInvalidHandleClass:Ext.emptyFn,addInvalidHandleId:Ext.emptyFn,addInvalidHandleType:Ext.emptyFn,removeInvalidHandleClass:Ext.emptyFn,removeInvalidHandleId:Ext.emptyFn,removeInvalidHandleType:Ext.emptyFn,toString:function(){return"DDTarget "+this.id}}),Ext.dd.DragTracker=Ext.extend(Ext.util.Observable,{active:!1,tolerance:5,autoStart:!1,constructor:function(e){Ext.apply(this,e),this.addEvents("mousedown","mouseup","mousemove","dragstart","dragend","drag"),this.dragRegion=new Ext.lib.Region(0,0,0,0),this.el&&this.initEl(this.el),Ext.dd.DragTracker.superclass.constructor.call(this,e)},initEl:function(e){this.el=Ext.get(e),e.on("mousedown",this.onMouseDown,this,this.delegate?{delegate:this.delegate}:void 0)},destroy:function(){this.el.un("mousedown",this.onMouseDown,this),delete this.el},onMouseDown:function(e,t){this.fireEvent("mousedown",this,e)!==!1&&this.onBeforeStart(e)!==!1&&(this.startXY=this.lastXY=e.getXY(),this.dragTarget=this.delegate?t:this.el.dom,this.preventDefault!==!1&&e.preventDefault(),Ext.getDoc().on({scope:this,mouseup:this.onMouseUp,mousemove:this.onMouseMove,selectstart:this.stopSelect}),this.autoStart&&(this.timer=this.triggerStart.defer(this.autoStart===!0?1e3:this.autoStart,this,[e])))},onMouseMove:function(e){if(this.active&&Ext.isIE&&!e.browserEvent.button)return e.preventDefault(),this.onMouseUp(e),void 0;e.preventDefault();var t=e.getXY(),i=this.startXY;if(this.lastXY=t,!this.active){if(!(Math.abs(i[0]-t[0])>this.tolerance||Math.abs(i[1]-t[1])>this.tolerance))return;this.triggerStart(e)}this.fireEvent("mousemove",this,e),this.onDrag(e),this.fireEvent("drag",this,e)},onMouseUp:function(e){var t=Ext.getDoc(),i=this.active;t.un("mousemove",this.onMouseMove,this),t.un("mouseup",this.onMouseUp,this),t.un("selectstart",this.stopSelect,this),e.preventDefault(),this.clearStart(),this.active=!1,delete this.elRegion,this.fireEvent("mouseup",this,e),i&&(this.onEnd(e),this.fireEvent("dragend",this,e))},triggerStart:function(e){this.clearStart(),this.active=!0,this.onStart(e),this.fireEvent("dragstart",this,e)},clearStart:function(){this.timer&&(clearTimeout(this.timer),delete this.timer)},stopSelect:function(e){return e.stopEvent(),!1},onBeforeStart:function(){},onStart:function(){},onDrag:function(){},onEnd:function(){},getDragTarget:function(){return this.dragTarget},getDragCt:function(){return this.el},getXY:function(e){return e?this.constrainModes[e].call(this,this.lastXY):this.lastXY},getOffset:function(e){var t=this.getXY(e),i=this.startXY;return[i[0]-t[0],i[1]-t[1]]},constrainModes:{point:function(e){this.elRegion||(this.elRegion=this.getDragCt().getRegion());var t=this.dragRegion;return t.left=e[0],t.top=e[1],t.right=e[0],t.bottom=e[1],t.constrainTo(this.elRegion),[t.left,t.top]}}}),Ext.dd.ScrollManager=function(){var e=Ext.dd.DragDropMgr,t={},i=null,s={},n=function(){i=null,o()},r=function(){e.dragCurrent&&e.refreshCache(e.dragCurrent.groups)},a=function(){if(e.dragCurrent){var t=Ext.dd.ScrollManager,i=s.el.ddScrollConfig?s.el.ddScrollConfig.increment:t.increment;t.animate?s.el.scroll(s.dir,i,!0,t.animDuration,r):s.el.scroll(s.dir,i)&&r()}},o=function(){s.id&&clearInterval(s.id),s.id=0,s.el=null,s.dir=""},l=function(t,i){o(),s.el=t,s.dir=i;var n=t.ddScrollConfig?t.ddScrollConfig.ddGroup:void 0,r=t.ddScrollConfig&&t.ddScrollConfig.frequency?t.ddScrollConfig.frequency:Ext.dd.ScrollManager.frequency;(void 0===n||e.dragCurrent.ddGroup==n)&&(s.id=setInterval(a,r))},h=function(n,r){if(!r&&e.dragCurrent){var a=Ext.dd.ScrollManager;i&&i==e.dragCurrent||(i=e.dragCurrent,a.refreshCache());var h=Ext.lib.Event.getXY(n),u=new Ext.lib.Point(h[0],h[1]);for(var c in t){var d=t[c],p=d._region,f=d.ddScrollConfig?d.ddScrollConfig:a;if(p&&p.contains(u)&&d.isScrollable()){if(p.bottom-u.y<=f.vthresh)return s.el!=d&&l(d,"down"),void 0;if(p.right-u.x<=f.hthresh)return s.el!=d&&l(d,"left"),void 0;if(u.y-p.top<=f.vthresh)return s.el!=d&&l(d,"up"),void 0;if(u.x-p.left<=f.hthresh)return s.el!=d&&l(d,"right"),void 0}}o()}};return e.fireEvents=e.fireEvents.createSequence(h,e),e.stopDrag=e.stopDrag.createSequence(n,e),{register:function(e){if(Ext.isArray(e))for(var i=0,s=e.length;s>i;i++)this.register(e[i]);else e=Ext.get(e),t[e.id]=e},unregister:function(e){if(Ext.isArray(e))for(var i=0,s=e.length;s>i;i++)this.unregister(e[i]);else e=Ext.get(e),delete t[e.id]},vthresh:25,hthresh:25,increment:100,frequency:500,animate:!0,animDuration:.4,ddGroup:void 0,refreshCache:function(){for(var e in t)"object"==typeof t[e]&&(t[e]._region=t[e].getRegion())}}}(),Ext.dd.Registry=function(){var e={},t={},i=0,s=function(e,t){if("string"==typeof e)return e;var s=e.id;return s||t===!1||(s="extdd-"+ ++i,e.id=s),s};return{register:function(i,n){if(n=n||{},"string"==typeof i&&(i=document.getElementById(i)),n.ddel=i,e[s(i)]=n,n.isHandle!==!1&&(t[n.ddel.id]=n),n.handles)for(var r=n.handles,a=0,o=r.length;o>a;a++)t[s(r[a])]=n},unregister:function(i){var n=s(i,!1),r=e[n];if(r&&(delete e[n],r.handles))for(var a=r.handles,o=0,l=a.length;l>o;o++)delete t[s(a[o],!1)]},getHandle:function(e){return"string"!=typeof e&&(e=e.id),t[e]},getHandleFromEvent:function(e){var i=Ext.lib.Event.getTarget(e);return i?t[i.id]:null},getTarget:function(t){return"string"!=typeof t&&(t=t.id),e[t]},getTargetFromEvent:function(i){var s=Ext.lib.Event.getTarget(i);return s?e[s.id]||t[s.id]:null}}}(),Ext.dd.StatusProxy=function(e){Ext.apply(this,e),this.id=this.id||Ext.id(),this.el=new Ext.Layer({dh:{id:this.id,tag:"div",cls:"x-dd-drag-proxy "+this.dropNotAllowed,children:[{tag:"div",cls:"x-dd-drop-icon"},{tag:"div",cls:"x-dd-drag-ghost"}]},shadow:!e||e.shadow!==!1}),this.ghost=Ext.get(this.el.dom.childNodes[1]),this.dropStatus=this.dropNotAllowed},Ext.dd.StatusProxy.prototype={dropAllowed:"x-dd-drop-ok",dropNotAllowed:"x-dd-drop-nodrop",setStatus:function(e){e=e||this.dropNotAllowed,this.dropStatus!=e&&(this.el.replaceClass(this.dropStatus,e),this.dropStatus=e)},reset:function(e){this.el.dom.className="x-dd-drag-proxy "+this.dropNotAllowed,this.dropStatus=this.dropNotAllowed,e&&this.ghost.update("")},update:function(e){"string"==typeof e?this.ghost.update(e):(this.ghost.update(""),e.style.margin="0",this.ghost.dom.appendChild(e));var t=this.ghost.dom.firstChild;t&&Ext.fly(t).setStyle("float","none")},getEl:function(){return this.el},getGhost:function(){return this.ghost},hide:function(e){this.el.hide(),e&&this.reset(!0)},stop:function(){this.anim&&this.anim.isAnimated&&this.anim.isAnimated()&&this.anim.stop()},show:function(){this.el.show()},sync:function(){this.el.sync()},repair:function(e,t,i){this.callback=t,this.scope=i,e&&this.animRepair!==!1?(this.el.addClass("x-dd-drag-repair"),this.el.hideUnders(!0),this.anim=this.el.shift({duration:this.repairDuration||.5,easing:"easeOut",xy:e,stopFx:!0,callback:this.afterRepair,scope:this})):this.afterRepair()},afterRepair:function(){this.hide(!0),"function"==typeof this.callback&&this.callback.call(this.scope||this),this.callback=null,this.scope=null},destroy:function(){Ext.destroy(this.ghost,this.el)}},Ext.dd.DragSource=function(e,t){this.el=Ext.get(e),this.dragData||(this.dragData={}),Ext.apply(this,t),this.proxy||(this.proxy=new Ext.dd.StatusProxy),Ext.dd.DragSource.superclass.constructor.call(this,this.el.dom,this.ddGroup||this.group,{dragElId:this.proxy.id,resizeFrame:!1,isTarget:!1,scroll:this.scroll===!0}),this.dragging=!1},Ext.extend(Ext.dd.DragSource,Ext.dd.DDProxy,{dropAllowed:"x-dd-drop-ok",dropNotAllowed:"x-dd-drop-nodrop",getDragData:function(){return this.dragData},onDragEnter:function(e,t){var i=Ext.dd.DragDropMgr.getDDById(t);if(this.cachedTarget=i,this.beforeDragEnter(i,e,t)!==!1){if(i.isNotifyTarget){var s=i.notifyEnter(this,e,this.dragData);this.proxy.setStatus(s)}else this.proxy.setStatus(this.dropAllowed);this.afterDragEnter&&this.afterDragEnter(i,e,t)}},beforeDragEnter:function(){return!0},alignElWithMouse:function(){Ext.dd.DragSource.superclass.alignElWithMouse.apply(this,arguments),this.proxy.sync()},onDragOver:function(e,t){var i=this.cachedTarget||Ext.dd.DragDropMgr.getDDById(t);if(this.beforeDragOver(i,e,t)!==!1){if(i.isNotifyTarget){var s=i.notifyOver(this,e,this.dragData);this.proxy.setStatus(s)}this.afterDragOver&&this.afterDragOver(i,e,t)}},beforeDragOver:function(){return!0},onDragOut:function(e,t){var i=this.cachedTarget||Ext.dd.DragDropMgr.getDDById(t);this.beforeDragOut(i,e,t)!==!1&&(i.isNotifyTarget&&i.notifyOut(this,e,this.dragData),this.proxy.reset(),this.afterDragOut&&this.afterDragOut(i,e,t)),this.cachedTarget=null},beforeDragOut:function(){return!0},onDragDrop:function(e,t){var i=this.cachedTarget||Ext.dd.DragDropMgr.getDDById(t);this.beforeDragDrop(i,e,t)!==!1&&(i.isNotifyTarget?i.notifyDrop(this,e,this.dragData)?this.onValidDrop(i,e,t):this.onInvalidDrop(i,e,t):this.onValidDrop(i,e,t),this.afterDragDrop&&this.afterDragDrop(i,e,t)),delete this.cachedTarget},beforeDragDrop:function(){return!0},onValidDrop:function(e,t,i){this.hideProxy(),this.afterValidDrop&&this.afterValidDrop(e,t,i)},getRepairXY:function(){return this.el.getXY()},onInvalidDrop:function(e,t,i){this.beforeInvalidDrop(e,t,i),this.cachedTarget&&(this.cachedTarget.isNotifyTarget&&this.cachedTarget.notifyOut(this,t,this.dragData),this.cacheTarget=null),this.proxy.repair(this.getRepairXY(t,this.dragData),this.afterRepair,this),this.afterInvalidDrop&&this.afterInvalidDrop(t,i)},afterRepair:function(){Ext.enableFx&&this.el.highlight(this.hlColor||"c3daf9"),this.dragging=!1},beforeInvalidDrop:function(){return!0},handleMouseDown:function(e){if(!this.dragging){var t=this.getDragData(e);t&&this.onBeforeDrag(t,e)!==!1&&(this.dragData=t,this.proxy.stop(),Ext.dd.DragSource.superclass.handleMouseDown.apply(this,arguments))}},onBeforeDrag:function(){return!0},onStartDrag:Ext.emptyFn,startDrag:function(e,t){this.proxy.reset(),this.dragging=!0,this.proxy.update(""),this.onInitDrag(e,t),this.proxy.show()},onInitDrag:function(e,t){var i=this.el.dom.cloneNode(!0);return i.id=Ext.id(),this.proxy.update(i),this.onStartDrag(e,t),!0},getProxy:function(){return this.proxy},hideProxy:function(){this.proxy.hide(),this.proxy.reset(!0),this.dragging=!1},triggerCacheRefresh:function(){Ext.dd.DDM.refreshCache(this.groups)},b4EndDrag:function(){},endDrag:function(e){this.onEndDrag(this.dragData,e)},onEndDrag:function(){},autoOffset:function(){this.setDelta(-12,-20)},destroy:function(){Ext.dd.DragSource.superclass.destroy.call(this),Ext.destroy(this.proxy)}}),Ext.dd.DropTarget=Ext.extend(Ext.dd.DDTarget,{constructor:function(e,t){this.el=Ext.get(e),Ext.apply(this,t),this.containerScroll&&Ext.dd.ScrollManager.register(this.el),Ext.dd.DropTarget.superclass.constructor.call(this,this.el.dom,this.ddGroup||this.group,{isTarget:!0})},dropAllowed:"x-dd-drop-ok",dropNotAllowed:"x-dd-drop-nodrop",isTarget:!0,isNotifyTarget:!0,notifyEnter:function(){return this.overClass&&this.el.addClass(this.overClass),this.dropAllowed},notifyOver:function(){return this.dropAllowed},notifyOut:function(){this.overClass&&this.el.removeClass(this.overClass)},notifyDrop:function(){return!1},destroy:function(){Ext.dd.DropTarget.superclass.destroy.call(this),this.containerScroll&&Ext.dd.ScrollManager.unregister(this.el)}}),Ext.dd.DragZone=Ext.extend(Ext.dd.DragSource,{constructor:function(e,t){Ext.dd.DragZone.superclass.constructor.call(this,e,t),this.containerScroll&&Ext.dd.ScrollManager.register(this.el)},getDragData:function(e){return Ext.dd.Registry.getHandleFromEvent(e)},onInitDrag:function(e,t){return this.proxy.update(this.dragData.ddel.cloneNode(!0)),this.onStartDrag(e,t),!0},afterRepair:function(){Ext.enableFx&&Ext.Element.fly(this.dragData.ddel).highlight(this.hlColor||"c3daf9"),this.dragging=!1},getRepairXY:function(){return Ext.Element.fly(this.dragData.ddel).getXY()},destroy:function(){Ext.dd.DragZone.superclass.destroy.call(this),this.containerScroll&&Ext.dd.ScrollManager.unregister(this.el)}}),Ext.dd.DropZone=function(e,t){Ext.dd.DropZone.superclass.constructor.call(this,e,t)},Ext.extend(Ext.dd.DropZone,Ext.dd.DropTarget,{getTargetFromEvent:function(e){return Ext.dd.Registry.getTargetFromEvent(e)},onNodeEnter:function(){},onNodeOver:function(){return this.dropAllowed},onNodeOut:function(){},onNodeDrop:function(){return!1},onContainerOver:function(){return this.dropNotAllowed},onContainerDrop:function(){return!1},notifyEnter:function(){return this.dropNotAllowed},notifyOver:function(e,t,i){var s=this.getTargetFromEvent(t);return s?(this.lastOverNode!=s&&(this.lastOverNode&&this.onNodeOut(this.lastOverNode,e,t,i),this.onNodeEnter(s,e,t,i),this.lastOverNode=s),this.onNodeOver(s,e,t,i)):(this.lastOverNode&&(this.onNodeOut(this.lastOverNode,e,t,i),this.lastOverNode=null),this.onContainerOver(e,t,i))},notifyOut:function(e,t,i){this.lastOverNode&&(this.onNodeOut(this.lastOverNode,e,t,i),this.lastOverNode=null)},notifyDrop:function(e,t,i){this.lastOverNode&&(this.onNodeOut(this.lastOverNode,e,t,i),this.lastOverNode=null);var s=this.getTargetFromEvent(t);return s?this.onNodeDrop(s,e,t,i):this.onContainerDrop(e,t,i)},triggerCacheRefresh:function(){Ext.dd.DDM.refreshCache(this.groups)}}),Ext.Element.addMethods({initDD:function(e,t,i){var s=new Ext.dd.DD(Ext.id(this.dom),e,t);return Ext.apply(s,i)},initDDProxy:function(e,t,i){var s=new Ext.dd.DDProxy(Ext.id(this.dom),e,t);return Ext.apply(s,i)},initDDTarget:function(e,t,i){var s=new Ext.dd.DDTarget(Ext.id(this.dom),e,t);return Ext.apply(s,i)}}),Ext.data.Api=function(){var e={};return{actions:{create:"create",read:"read",update:"update",destroy:"destroy"},restActions:{create:"POST",read:"GET",update:"PUT",destroy:"DELETE"},isAction:function(e){return Ext.data.Api.actions[e]?!0:!1},getVerb:function(t){if(e[t])return e[t];for(var i in this.actions)if(this.actions[i]===t){e[t]=i;break}return void 0!==e[t]?e[t]:null},isValid:function(e){var t=[],i=this.actions;for(var s in e)s in i||t.push(s);return t.length?t:!0},hasUniqueUrl:function(e,t){var i=e.api[t]?e.api[t].url:null,s=!0;for(var n in e.api)if((s=n===t?!0:e.api[n].url!=i?!0:!1)==!1)break;return s},prepare:function(e){e.api||(e.api={});for(var t in this.actions){var i=this.actions[t];e.api[i]=e.api[i]||e.url||e.directFn,"string"==typeof e.api[i]&&(e.api[i]={url:e.api[i],method:e.restful===!0?Ext.data.Api.restActions[i]:void 0})}},restify:function(e){e.restful=!0;for(var t in this.restActions)e.api[this.actions[t]].method||(e.api[this.actions[t]].method=this.restActions[t]);e.onWrite=e.onWrite.createInterceptor(function(e,t,i,s){t.reader;var n=new Ext.data.Response({action:e,raw:i});switch(i.status){case 200:return!0;case 201:if(!Ext.isEmpty(n.raw.responseText))return!0;n.success=!0;break;case 204:n.success=!0,n.data=null;break;default:return!0}return n.success===!0?this.fireEvent("write",this,e,n.data,n,s,t.request.arg):this.fireEvent("exception",this,"remote",e,t,n,s),t.request.callback.call(t.request.scope,n.data,n,n.success),!1},e)}}}(),Ext.data.Response=function(e,t){Ext.apply(this,e,{raw:t})},Ext.data.Response.prototype={message:null,success:!1,status:null,root:null,raw:null,getMessage:function(){return this.message},getSuccess:function(){return this.success},getStatus:function(){return this.status},getRoot:function(){return this.root},getRawResponse:function(){return this.raw}},Ext.data.Api.Error=Ext.extend(Ext.Error,{constructor:function(e,t){this.arg=t,Ext.Error.call(this,e)},name:"Ext.data.Api"}),Ext.apply(Ext.data.Api.Error.prototype,{lang:{"action-url-undefined":"No fallback url defined for this action.  When defining a DataProxy api, please be sure to define an url for each CRUD action in Ext.data.Api.actions or define a default url in addition to your api-configuration.",invalid:"received an invalid API-configuration.  Please ensure your proxy API-configuration contains only the actions defined in Ext.data.Api.actions","invalid-url":"Invalid url.  Please review your proxy configuration.",execute:'Attempted to execute an unknown action.  Valid API actions are defined in Ext.data.Api.actions"'}}),Ext.data.SortTypes={none:function(e){return e},stripTagsRE:/<\/?[^>]+>/gi,asText:function(e){return String(e).replace(this.stripTagsRE,"")},asUCText:function(e){return String(e).toUpperCase().replace(this.stripTagsRE,"")},asUCString:function(e){return String(e).toUpperCase()},asDate:function(e){return e?Ext.isDate(e)?e.getTime():Date.parse(String(e)):0},asFloat:function(e){var t=parseFloat(String(e).replace(/,/g,""));return isNaN(t)?0:t},asInt:function(e){var t=parseInt(String(e).replace(/,/g,""),10);return isNaN(t)?0:t}},Ext.data.Record=function(e,t){this.id=t||0===t?t:Ext.data.Record.id(this),this.data=e||{}},Ext.data.Record.create=function(e){var t=Ext.extend(Ext.data.Record,{}),i=t.prototype;i.fields=new Ext.util.MixedCollection(!1,function(e){return e.name});for(var s=0,n=e.length;n>s;s++)i.fields.add(new Ext.data.Field(e[s]));return t.getField=function(e){return i.fields.get(e)},t},Ext.data.Record.PREFIX="ext-record",Ext.data.Record.AUTO_ID=1,Ext.data.Record.EDIT="edit",Ext.data.Record.REJECT="reject",Ext.data.Record.COMMIT="commit",Ext.data.Record.id=function(e){return e.phantom=!0,[Ext.data.Record.PREFIX,"-",Ext.data.Record.AUTO_ID++].join("")},Ext.data.Record.prototype={dirty:!1,editing:!1,error:null,modified:null,phantom:!1,join:function(e){this.store=e},set:function(e,t){var i=Ext.isPrimitive(t)?String:Ext.encode;i(this.data[e])!=i(t)&&(this.dirty=!0,this.modified||(this.modified={}),void 0===this.modified[e]&&(this.modified[e]=this.data[e]),this.data[e]=t,this.editing||this.afterEdit())},afterEdit:function(){void 0!=this.store&&"function"==typeof this.store.afterEdit&&this.store.afterEdit(this)},afterReject:function(){this.store&&this.store.afterReject(this)},afterCommit:function(){this.store&&this.store.afterCommit(this)},get:function(e){return this.data[e]},beginEdit:function(){this.editing=!0,this.modified=this.modified||{}},cancelEdit:function(){this.editing=!1,delete this.modified},endEdit:function(){this.editing=!1,this.dirty&&this.afterEdit()},reject:function(e){var t=this.modified;for(var i in t)"function"!=typeof t[i]&&(this.data[i]=t[i]);this.dirty=!1,delete this.modified,this.editing=!1,e!==!0&&this.afterReject()},commit:function(e){this.dirty=!1,delete this.modified,this.editing=!1,e!==!0&&this.afterCommit()},getChanges:function(){var e=this.modified,t={};for(var i in e)e.hasOwnProperty(i)&&(t[i]=this.data[i]);return t},hasError:function(){return null!==this.error},clearError:function(){this.error=null},copy:function(e){return new this.constructor(Ext.apply({},this.data),e||this.id)},isModified:function(e){return!(!this.modified||!this.modified.hasOwnProperty(e))},isValid:function(){return this.fields.find(function(e){return e.allowBlank===!1&&Ext.isEmpty(this.data[e.name])?!0:!1},this)?!1:!0},markDirty:function(){this.dirty=!0,this.modified||(this.modified={}),this.fields.each(function(e){this.modified[e.name]=this.data[e.name]},this)}},Ext.StoreMgr=Ext.apply(new Ext.util.MixedCollection,{register:function(){for(var e,t=0;e=arguments[t];t++)this.add(e)},unregister:function(){for(var e,t=0;e=arguments[t];t++)this.remove(this.lookup(e))},lookup:function(e){if(Ext.isArray(e)){var t=["field1"],i=!Ext.isArray(e[0]);if(!i)for(var s=2,n=e[0].length;n>=s;++s)t.push("field"+s);return new Ext.data.ArrayStore({fields:t,data:e,expandData:i,autoDestroy:!0,autoCreated:!0})}return Ext.isObject(e)?e.events?e:Ext.create(e,"store"):this.get(e)},getKey:function(e){return e.storeId}}),Ext.data.Store=Ext.extend(Ext.util.Observable,{writer:void 0,remoteSort:!1,autoDestroy:!1,pruneModifiedRecords:!1,lastOptions:null,autoSave:!0,batch:!0,restful:!1,paramNames:void 0,defaultParamNames:{start:"start",limit:"limit",sort:"sort",dir:"dir"},isDestroyed:!1,hasMultiSort:!1,batchKey:"_ext_batch_",constructor:function(e){this.data=new Ext.util.MixedCollection(!1),this.data.getKey=function(e){return e.id},this.removed=[],e&&e.data&&(this.inlineData=e.data,delete e.data),Ext.apply(this,e),this.baseParams=Ext.isObject(this.baseParams)?this.baseParams:{},this.paramNames=Ext.applyIf(this.paramNames||{},this.defaultParamNames),!this.url&&!this.api||this.proxy||(this.proxy=new Ext.data.HttpProxy({url:this.url,api:this.api})),this.restful===!0&&this.proxy&&(this.batch=!1,Ext.data.Api.restify(this.proxy)),this.reader&&(this.recordType||(this.recordType=this.reader.recordType),this.reader.onMetaChange&&(this.reader.onMetaChange=this.reader.onMetaChange.createSequence(this.onMetaChange,this)),this.writer&&(this.writer instanceof Ext.data.DataWriter==!1&&(this.writer=this.buildWriter(this.writer)),this.writer.meta=this.reader.meta,this.pruneModifiedRecords=!0)),this.recordType&&(this.fields=this.recordType.prototype.fields),this.modified=[],this.addEvents("datachanged","metachange","add","remove","update","clear","exception","beforeload","load","loadexception","beforewrite","write","beforesave","save"),this.proxy&&this.relayEvents(this.proxy,["loadexception","exception"]),this.writer&&this.on({scope:this,add:this.createRecords,remove:this.destroyRecord,update:this.updateRecord,clear:this.onClear}),this.sortToggle={},this.sortField?this.setDefaultSort(this.sortField,this.sortDir):this.sortInfo&&this.setDefaultSort(this.sortInfo.field,this.sortInfo.direction),Ext.data.Store.superclass.constructor.call(this),this.id&&(this.storeId=this.id,delete this.id),this.storeId&&Ext.StoreMgr.register(this),this.inlineData?(this.loadData(this.inlineData),delete this.inlineData):this.autoLoad&&this.load.defer(10,this,["object"==typeof this.autoLoad?this.autoLoad:void 0]),this.batchCounter=0,this.batches={}},buildWriter:function(e){var t=void 0,i=(e.format||"json").toLowerCase();switch(i){case"json":t=Ext.data.JsonWriter;break;case"xml":t=Ext.data.XmlWriter;break;default:t=Ext.data.JsonWriter}return new t(e)},destroy:function(){this.isDestroyed||(this.storeId&&Ext.StoreMgr.unregister(this),this.clearData(),this.data=null,Ext.destroy(this.proxy),this.reader=this.writer=null,this.purgeListeners(),this.isDestroyed=!0)},add:function(e){var t,i,s,n;if(e=[].concat(e),!(e.length<1)){for(t=0,i=e.length;i>t;t++)s=e[t],s.join(this),(s.dirty||s.phantom)&&this.modified.push(s);n=this.data.length,this.data.addAll(e),this.snapshot&&this.snapshot.addAll(e),this.fireEvent("add",this,e,n)}},addSorted:function(e){var t=this.findInsertIndex(e);this.insert(t,e)},doUpdate:function(e){var t=e.id;this.getById(t).join(null),this.data.replace(t,e),this.snapshot&&this.snapshot.replace(t,e),e.join(this),this.fireEvent("update",this,e,Ext.data.Record.COMMIT)},remove:function(e){if(Ext.isArray(e))return Ext.each(e,function(e){this.remove(e)},this),void 0;var t=this.data.indexOf(e);t>-1&&(e.join(null),this.data.removeAt(t)),this.pruneModifiedRecords&&this.modified.remove(e),this.snapshot&&this.snapshot.remove(e),t>-1&&this.fireEvent("remove",this,e,t)},removeAt:function(e){this.remove(this.getAt(e))},removeAll:function(e){var t=[];this.each(function(e){t.push(e)}),this.clearData(),this.snapshot&&this.snapshot.clear(),this.pruneModifiedRecords&&(this.modified=[]),e!==!0&&this.fireEvent("clear",this,t)},onClear:function(e,t){Ext.each(t,function(e,t){this.destroyRecord(this,e,t)},this)},insert:function(e,t){var i,s,n;for(t=[].concat(t),i=0,s=t.length;s>i;i++)n=t[i],this.data.insert(e+i,n),n.join(this),(n.dirty||n.phantom)&&this.modified.push(n);this.snapshot&&this.snapshot.addAll(t),this.fireEvent("add",this,t,e)},indexOf:function(e){return this.data.indexOf(e)},indexOfId:function(e){return this.data.indexOfKey(e)},getById:function(e){return(this.snapshot||this.data).key(e)},getAt:function(e){return this.data.itemAt(e)},getRange:function(e,t){return this.data.getRange(e,t)},storeOptions:function(e){e=Ext.apply({},e),delete e.callback,delete e.scope,this.lastOptions=e},clearData:function(){this.data.each(function(e){e.join(null)}),this.data.clear()},load:function(e){if(e=Ext.apply({},e),this.storeOptions(e),this.sortInfo&&this.remoteSort){var t=this.paramNames;e.params=Ext.apply({},e.params),e.params[t.sort]=this.sortInfo.field,e.params[t.dir]=this.sortInfo.direction}try{return this.execute("read",null,e)}catch(i){return this.handleException(i),!1}},updateRecord:function(e,t,i){i==Ext.data.Record.EDIT&&this.autoSave===!0&&(!t.phantom||t.phantom&&t.isValid())&&this.save()},createRecords:function(e,t){var i,s,n=this.modified,r=t.length;for(s=0;r>s;s++)i=t[s],i.phantom&&i.isValid()&&(i.markDirty(),-1==n.indexOf(i)&&n.push(i));this.autoSave===!0&&this.save()},destroyRecord:function(e,t,i){-1!=this.modified.indexOf(t)&&this.modified.remove(t),t.phantom||(this.removed.push(t),t.lastIndex=i,this.autoSave===!0&&this.save())},execute:function(e,t,i,s){if(!Ext.data.Api.isAction(e))throw new Ext.data.Api.Error("execute",e);i=Ext.applyIf(i||{},{params:{}}),void 0!==s&&this.addToBatch(s);var n=!0;return"read"===e?(n=this.fireEvent("beforeload",this,i),Ext.applyIf(i.params,this.baseParams)):(this.writer.listful===!0&&this.restful!==!0?t=Ext.isArray(t)?t:[t]:Ext.isArray(t)&&1==t.length&&(t=t.shift()),(n=this.fireEvent("beforewrite",this,e,t,i))!==!1&&this.writer.apply(i.params,this.baseParams,e,t)),n!==!1&&(this.writer&&this.proxy.url&&!this.proxy.restful&&!Ext.data.Api.hasUniqueUrl(this.proxy,e)&&(i.params.xaction=e),this.proxy.request(Ext.data.Api.actions[e],t,i.params,this.reader,this.createCallback(e,t,s),this,i)),n},save:function(){if(!this.writer)throw new Ext.data.Store.Error("writer-undefined");var e,t,i,s,n=[],r={};this.removed.length&&n.push(["destroy",this.removed]);var a=[].concat(this.getModifiedRecords());if(a.length){var o=[];for(s=a.length-1;s>=0;s--)if(a[s].phantom===!0){var l=a.splice(s,1).shift();l.isValid()&&o.push(l)}else a[s].isValid()||a.splice(s,1);o.length&&n.push(["create",o]),a.length&&n.push(["update",a])
}if(e=n.length){for(i=++this.batchCounter,s=0;e>s;++s)t=n[s],r[t[0]]=t[1];if(this.fireEvent("beforesave",this,r)!==!1){for(s=0;e>s;++s)t=n[s],this.doTransaction(t[0],t[1],i);return i}}return-1},doTransaction:function(e,t,i){function s(t){try{this.execute(e,t,void 0,i)}catch(s){this.handleException(s)}}if(this.batch===!1)for(var n=0,r=t.length;r>n;n++)s.call(this,t[n]);else s.call(this,t)},addToBatch:function(e){var t=this.batches,i=this.batchKey+e,s=t[i];s||(t[i]=s={id:e,count:0,data:{}}),++s.count},removeFromBatch:function(e,t,i){var s,n=this.batches,r=this.batchKey+e,a=n[r];a&&(s=a.data[t]||[],a.data[t]=s.concat(i),1===a.count?(i=a.data,delete n[r],this.fireEvent("save",this,e,i)):--a.count)},createCallback:function(e,t,i){return Ext.data.Api.actions,"read"==e?this.loadRecords:function(s,n,r){this["on"+Ext.util.Format.capitalize(e)+"Records"](r,t,[].concat(s)),r===!0&&this.fireEvent("write",this,e,s,n,t),this.removeFromBatch(i,e,s)}},clearModified:function(e){if(Ext.isArray(e))for(var t=e.length-1;t>=0;t--)this.modified.splice(this.modified.indexOf(e[t]),1);else this.modified.splice(this.modified.indexOf(e),1)},reMap:function(e){if(Ext.isArray(e))for(var t=0,i=e.length;i>t;t++)this.reMap(e[t]);else{delete this.data.map[e._phid],this.data.map[e.id]=e;var s=this.data.keys.indexOf(e._phid);this.data.keys.splice(s,1,e.id),delete e._phid}},onCreateRecords:function(e,t,i){if(e===!0)try{this.reader.realize(t,i)}catch(s){this.handleException(s),Ext.isArray(t)&&this.onCreateRecords(e,t,i)}},onUpdateRecords:function(e,t,i){if(e===!0)try{this.reader.update(t,i)}catch(s){this.handleException(s),Ext.isArray(t)&&this.onUpdateRecords(e,t,i)}},onDestroyRecords:function(e,t){t=t instanceof Ext.data.Record?[t]:[].concat(t);for(var i=0,s=t.length;s>i;i++)this.removed.splice(this.removed.indexOf(t[i]),1);if(e===!1)for(i=t.length-1;i>=0;i--)this.insert(t[i].lastIndex,t[i])},handleException:function(e){Ext.handleError(e)},reload:function(e){this.load(Ext.applyIf(e||{},this.lastOptions))},loadRecords:function(e,t,i){var s,n;if(this.isDestroyed!==!0){if(!e||i===!1)return i!==!1&&this.fireEvent("load",this,[],t),t.callback&&t.callback.call(t.scope||this,[],t,!1,e),void 0;var r=e.records,a=e.totalRecords||r.length;if(t&&t.add===!0){var o,l=[],h=0;for(s=0,n=r.length;n>s;++s)o=r[s],this.indexOfId(o.id)>-1?this.doUpdate(o):(l.push(o),++h);this.totalLength=Math.max(a,this.data.length+h),this.add(l)}else{for(this.pruneModifiedRecords&&(this.modified=[]),s=0,n=r.length;n>s;s++)r[s].join(this);this.snapshot&&(this.data=this.snapshot,delete this.snapshot),this.clearData(),this.data.addAll(r),this.totalLength=a,this.applySort(),this.fireEvent("datachanged",this)}this.fireEvent("load",this,r,t),t.callback&&t.callback.call(t.scope||this,r,t,!0)}},loadData:function(e,t){var i=this.reader.readRecords(e);this.loadRecords(i,{add:t},!0)},getCount:function(){return this.data.length||0},getTotalCount:function(){return this.totalLength||0},getSortState:function(){return this.sortInfo},applySort:function(){!this.sortInfo&&!this.multiSortInfo||this.remoteSort||this.sortData()},sortData:function(){var e=this.hasMultiSort?this.multiSortInfo:this.sortInfo,t=e.direction||"ASC",i=e.sorters,s=[];this.hasMultiSort||(i=[{direction:t,field:e.field}]);for(var n=0,r=i.length;r>n;n++)s.push(this.createSortFunction(i[n].field,i[n].direction));if(0!=s.length){var a="DESC"==t.toUpperCase()?-1:1,o=function(e,t){var i=s[0].call(this,e,t);if(s.length>1)for(var n=1,r=s.length;r>n;n++)i=i||s[n].call(this,e,t);return a*i};this.data.sort(t,o),this.snapshot&&this.snapshot!=this.data&&this.snapshot.sort(t,o)}},createSortFunction:function(e,t){t=t||"ASC";var i="DESC"==t.toUpperCase()?-1:1,s=this.fields.get(e).sortType;return function(t,n){var r=s(t.data[e]),a=s(n.data[e]);return i*(r>a?1:a>r?-1:0)}},setDefaultSort:function(e,t){t=t?t.toUpperCase():"ASC",this.sortInfo={field:e,direction:t},this.sortToggle[e]=t},sort:function(e,t){return Ext.isArray(arguments[0])?this.multiSort.call(this,e,t):this.singleSort(e,t)},singleSort:function(e,t){var i=this.fields.get(e);if(!i)return!1;var s=i.name,n=this.sortInfo||null,r=this.sortToggle?this.sortToggle[s]:null;return t||(t=n&&n.field==s?(this.sortToggle[s]||"ASC").toggle("ASC","DESC"):i.sortDir),this.sortToggle[s]=t,this.sortInfo={field:s,direction:t},this.hasMultiSort=!1,this.remoteSort?this.load(this.lastOptions)||(r&&(this.sortToggle[s]=r),n&&(this.sortInfo=n)):(this.applySort(),this.fireEvent("datachanged",this)),!0},multiSort:function(e,t){this.hasMultiSort=!0,t=t||"ASC",this.multiSortInfo&&t==this.multiSortInfo.direction&&(t=t.toggle("ASC","DESC")),this.multiSortInfo={sorters:e,direction:t},this.remoteSort?this.singleSort(e[0].field,e[0].direction):(this.applySort(),this.fireEvent("datachanged",this))},each:function(e,t){this.data.each(e,t)},getModifiedRecords:function(){return this.modified},sum:function(e,t,i){var s=this.data.items,n=0;t=t||0,i=i||0===i?i:s.length-1;for(var r=t;i>=r;r++)n+=s[r].data[e]||0;return n},createFilterFn:function(e,t,i,s,n){return Ext.isEmpty(t,!1)?!1:(t=this.data.createValueMatcher(t,i,s,n),function(i){return t.test(i.data[e])})},createMultipleFilterFn:function(e){return function(t){for(var i=!0,s=0,n=e.length;n>s;s++){var r=e[s],a=r.fn,o=r.scope;i=i&&a.call(o,t)}return i}},filter:function(e,t,i,s,n){var r;if(Ext.isObject(e)&&(e=[e]),Ext.isArray(e)){for(var a=[],o=0,l=e.length;l>o;o++){var h=e[o],u=h.fn,c=h.scope||this;Ext.isFunction(u)||(u=this.createFilterFn(h.property,h.value,h.anyMatch,h.caseSensitive,h.exactMatch)),a.push({fn:u,scope:c})}r=this.createMultipleFilterFn(a)}else r=this.createFilterFn(e,t,i,s,n);return r?this.filterBy(r):this.clearFilter()},filterBy:function(e,t){this.snapshot=this.snapshot||this.data,this.data=this.queryBy(e,t||this),this.fireEvent("datachanged",this)},clearFilter:function(e){this.isFiltered()&&(this.data=this.snapshot,delete this.snapshot,e!==!0&&this.fireEvent("datachanged",this))},isFiltered:function(){return!!this.snapshot&&this.snapshot!=this.data},query:function(e,t,i,s){var n=this.createFilterFn(e,t,i,s);return n?this.queryBy(n):this.data.clone()},queryBy:function(e,t){var i=this.snapshot||this.data;return i.filterBy(e,t||this)},find:function(e,t,i,s,n){var r=this.createFilterFn(e,t,s,n);return r?this.data.findIndexBy(r,null,i):-1},findExact:function(e,t,i){return this.data.findIndexBy(function(i){return i.get(e)===t},this,i)},findBy:function(e,t,i){return this.data.findIndexBy(e,t,i)},collect:function(e,t,i){for(var s,n,r=i===!0&&this.snapshot?this.snapshot.items:this.data.items,a=[],o={},l=0,h=r.length;h>l;l++)s=r[l].data[e],n=String(s),!t&&Ext.isEmpty(s)||o[n]||(o[n]=!0,a[a.length]=s);return a},afterEdit:function(e){-1==this.modified.indexOf(e)&&this.modified.push(e),this.fireEvent("update",this,e,Ext.data.Record.EDIT)},afterReject:function(e){this.modified.remove(e),this.fireEvent("update",this,e,Ext.data.Record.REJECT)},afterCommit:function(e){this.modified.remove(e),this.fireEvent("update",this,e,Ext.data.Record.COMMIT)},commitChanges:function(){var e,t=this.modified.slice(0),i=t.length;for(e=0;i>e;e++)t[e].commit();this.modified=[],this.removed=[]},rejectChanges:function(){var e,t=this.modified.slice(0),i=this.removed.slice(0).reverse(),s=t.length,n=i.length;for(e=0;s>e;e++)t[e].reject();for(e=0;n>e;e++)this.insert(i[e].lastIndex||0,i[e]),i[e].reject();this.modified=[],this.removed=[]},onMetaChange:function(){this.recordType=this.reader.recordType,this.fields=this.recordType.prototype.fields,delete this.snapshot,this.reader.meta.sortInfo?this.sortInfo=this.reader.meta.sortInfo:this.sortInfo&&!this.fields.get(this.sortInfo.field)&&delete this.sortInfo,this.writer&&(this.writer.meta=this.reader.meta),this.modified=[],this.fireEvent("metachange",this,this.reader.meta)},findInsertIndex:function(e){this.suspendEvents();var t=this.data.clone();this.data.add(e),this.applySort();var i=this.data.indexOf(e);return this.data=t,this.resumeEvents(),i},setBaseParam:function(e,t){this.baseParams=this.baseParams||{},this.baseParams[e]=t}}),Ext.reg("store",Ext.data.Store),Ext.data.Store.Error=Ext.extend(Ext.Error,{name:"Ext.data.Store"}),Ext.apply(Ext.data.Store.Error.prototype,{lang:{"writer-undefined":"Attempted to execute a write-action without a DataWriter installed."}}),Ext.data.Field=Ext.extend(Object,{constructor:function(e){Ext.isString(e)&&(e={name:e}),Ext.apply(this,e);var t=Ext.data.Types,i=this.sortType;this.type?Ext.isString(this.type)&&(this.type=Ext.data.Types[this.type.toUpperCase()]||t.AUTO):this.type=t.AUTO,Ext.isString(i)?this.sortType=Ext.data.SortTypes[i]:Ext.isEmpty(i)&&(this.sortType=this.type.sortType),this.convert||(this.convert=this.type.convert)},dateFormat:null,useNull:!1,defaultValue:"",mapping:null,sortType:null,sortDir:"ASC",allowBlank:!0}),Ext.data.DataReader=function(e,t){this.meta=e,this.recordType=Ext.isArray(t)?Ext.data.Record.create(t):t,this.recordType&&this.buildExtractors()},Ext.data.DataReader.prototype={getTotal:Ext.emptyFn,getRoot:Ext.emptyFn,getMessage:Ext.emptyFn,getSuccess:Ext.emptyFn,getId:Ext.emptyFn,buildExtractors:Ext.emptyFn,extractValues:Ext.emptyFn,realize:function(e,t){if(Ext.isArray(e))for(var i=e.length-1;i>=0;i--)Ext.isArray(t)?this.realize(e.splice(i,1).shift(),t.splice(i,1).shift()):this.realize(e.splice(i,1).shift(),t);else{if(Ext.isArray(t)&&1==t.length&&(t=t.shift()),!this.isData(t))throw new Ext.data.DataReader.Error("realize",e);e.phantom=!1,e._phid=e.id,e.id=this.getId(t),e.data=t,e.commit(),e.store.reMap(e)}},update:function(e,t){if(Ext.isArray(e))for(var i=e.length-1;i>=0;i--)Ext.isArray(t)?this.update(e.splice(i,1).shift(),t.splice(i,1).shift()):this.update(e.splice(i,1).shift(),t);else Ext.isArray(t)&&1==t.length&&(t=t.shift()),this.isData(t)&&(e.data=Ext.apply(e.data,t)),e.commit()},extractData:function(e,t){var i=this instanceof Ext.data.JsonReader?"json":"node",s=[];!this.isData(e)||this instanceof Ext.data.XmlReader||(e=[e]);var n=this.recordType.prototype.fields,r=n.items,a=n.length,s=[];if(t===!0)for(var o=this.recordType,l=0;l<e.length;l++){var h=e[l],u=new o(this.extractValues(h,r,a),this.getId(h));u[i]=h,s.push(u)}else for(var l=0;l<e.length;l++){var c=this.extractValues(e[l],r,a);c[this.meta.idProperty]=this.getId(e[l]),s.push(c)}return s},isData:function(e){return e&&Ext.isObject(e)&&!Ext.isEmpty(this.getId(e))?!0:!1},onMetaChange:function(e){delete this.ef,this.meta=e,this.recordType=Ext.data.Record.create(e.fields),this.buildExtractors()}},Ext.data.DataReader.Error=Ext.extend(Ext.Error,{constructor:function(e,t){this.arg=t,Ext.Error.call(this,e)},name:"Ext.data.DataReader"}),Ext.apply(Ext.data.DataReader.Error.prototype,{lang:{update:"#update received invalid data from server.  Please see docs for DataReader#update and review your DataReader configuration.",realize:"#realize was called with invalid remote-data.  Please see the docs for DataReader#realize and review your DataReader configuration.","invalid-response":"#readResponse received an invalid response from the server."}}),Ext.data.DataWriter=function(e){Ext.apply(this,e)},Ext.data.DataWriter.prototype={writeAllFields:!1,listful:!1,apply:function(e,t,i,s){var n=[],r=i+"Record";Ext.isArray(s)?Ext.each(s,function(e){n.push(this[r](e))},this):s instanceof Ext.data.Record&&(n=this[r](s)),this.render(e,t,n)},render:Ext.emptyFn,updateRecord:Ext.emptyFn,createRecord:Ext.emptyFn,destroyRecord:Ext.emptyFn,toHash:function(e){var t,i=e.fields.map,s={},n=this.writeAllFields===!1&&e.phantom===!1?e.getChanges():e.data;return Ext.iterate(n,function(e,n){(t=i[e])&&(s[t.mapping?t.mapping:t.name]=n)}),e.phantom?e.fields.containsKey(this.meta.idProperty)&&Ext.isEmpty(e.data[this.meta.idProperty])&&delete s[this.meta.idProperty]:s[this.meta.idProperty]=e.id,s},toArray:function(e){var t=[];return Ext.iterate(e,function(e,i){t.push({name:e,value:i})},this),t}},Ext.data.DataProxy=function(e){e=e||{},this.api=e.api,this.url=e.url,this.restful=e.restful,this.listeners=e.listeners,this.prettyUrls=e.prettyUrls,this.addEvents("exception","beforeload","load","loadexception","beforewrite","write"),Ext.data.DataProxy.superclass.constructor.call(this);try{Ext.data.Api.prepare(this)}catch(t){t instanceof Ext.data.Api.Error&&t.toConsole()}Ext.data.DataProxy.relayEvents(this,["beforewrite","write","exception"])},Ext.extend(Ext.data.DataProxy,Ext.util.Observable,{restful:!1,setApi:function(){if(1==arguments.length){var e=Ext.data.Api.isValid(arguments[0]);if(e!==!0)throw new Ext.data.Api.Error("invalid",e);this.api=arguments[0]}else if(2==arguments.length){if(!Ext.data.Api.isAction(arguments[0]))throw new Ext.data.Api.Error("invalid",arguments[0]);this.api[arguments[0]]=arguments[1]}Ext.data.Api.prepare(this)},isApiAction:function(e){return this.api[e]?!0:!1},request:function(e,t,i,s,n,r,a){if(!this.api[e]&&!this.load)throw new Ext.data.DataProxy.Error("action-undefined",e);i=i||{},(e===Ext.data.Api.actions.read?this.fireEvent("beforeload",this,i):this.fireEvent("beforewrite",this,e,t,i)!==!1)?this.doRequest.apply(this,arguments):n.call(r||this,null,a,!1)},load:null,doRequest:function(e,t,i,s,n,r,a){this.load(i,s,n,r,a)},onRead:Ext.emptyFn,onWrite:Ext.emptyFn,buildUrl:function(e,t){t=t||null;var i=this.conn&&this.conn.url?this.conn.url:this.api[e]?this.api[e].url:this.url;if(!i)throw new Ext.data.Api.Error("invalid-url",e);var s=null,n=i.match(/(.*)(\.json|\.xml|\.html)$/);return n&&(s=n[2],i=n[1]),(this.restful===!0||this.prettyUrls===!0)&&t instanceof Ext.data.Record&&!t.phantom&&(i+="/"+t.id),null===s?i:i+s},destroy:function(){this.purgeListeners()}}),Ext.apply(Ext.data.DataProxy,Ext.util.Observable.prototype),Ext.util.Observable.call(Ext.data.DataProxy),Ext.data.DataProxy.Error=Ext.extend(Ext.Error,{constructor:function(e,t){this.arg=t,Ext.Error.call(this,e)},name:"Ext.data.DataProxy"}),Ext.apply(Ext.data.DataProxy.Error.prototype,{lang:{"action-undefined":"DataProxy attempted to execute an API-action but found an undefined url / function.  Please review your Proxy url/api-configuration.","api-invalid":"Recieved an invalid API-configuration.  Please ensure your proxy API-configuration contains only the actions from Ext.data.Api.actions."}}),Ext.data.Request=function(e){Ext.apply(this,e)},Ext.data.Request.prototype={action:void 0,rs:void 0,params:void 0,callback:Ext.emptyFn,scope:void 0,reader:void 0},Ext.data.Response=function(e){Ext.apply(this,e)},Ext.data.Response.prototype={action:void 0,success:void 0,message:void 0,data:void 0,raw:void 0,records:void 0},Ext.data.ScriptTagProxy=function(e){Ext.apply(this,e),Ext.data.ScriptTagProxy.superclass.constructor.call(this,e),this.head=document.getElementsByTagName("head")[0]},Ext.data.ScriptTagProxy.TRANS_ID=1e3,Ext.extend(Ext.data.ScriptTagProxy,Ext.data.DataProxy,{timeout:3e4,callbackParam:"callback",nocache:!0,doRequest:function(e,t,i,s,n,r,a){var o=Ext.urlEncode(Ext.apply(i,this.extraParams)),l=this.buildUrl(e,t);if(!l)throw new Ext.data.Api.Error("invalid-url",l);l=Ext.urlAppend(l,o),this.nocache&&(l=Ext.urlAppend(l,"_dc="+(new Date).getTime()));var h=++Ext.data.ScriptTagProxy.TRANS_ID,u={id:h,action:e,cb:"stcCallback"+h,scriptId:"stcScript"+h,params:i,arg:a,url:l,callback:n,scope:r,reader:s};window[u.cb]=this.createCallback(e,t,u),l+=String.format("&{0}={1}",this.callbackParam,u.cb),this.autoAbort!==!1&&this.abort(),u.timeoutId=this.handleFailure.defer(this.timeout,this,[u]);var c=document.createElement("script");c.setAttribute("src",l),c.setAttribute("type","text/javascript"),c.setAttribute("id",u.scriptId),this.head.appendChild(c),this.trans=u},createCallback:function(e,t,i){var s=this;return function(n){s.trans=!1,s.destroyTrans(i,!0),e===Ext.data.Api.actions.read?s.onRead.call(s,e,i,n):s.onWrite.call(s,e,i,n,t)}},onRead:function(e,t,i){var s;try{s=t.reader.readRecords(i)}catch(n){return this.fireEvent("loadexception",this,t,i,n),this.fireEvent("exception",this,"response",e,t,i,n),t.callback.call(t.scope||window,null,t.arg,!1),void 0}s.success===!1?(this.fireEvent("loadexception",this,t,i),this.fireEvent("exception",this,"remote",e,t,i,null)):this.fireEvent("load",this,i,t.arg),t.callback.call(t.scope||window,s,t.arg,s.success)},onWrite:function(e,t,i,s){var n=t.reader;try{var r=n.readResponse(e,i)}catch(a){return this.fireEvent("exception",this,"response",e,t,r,a),t.callback.call(t.scope||window,null,r,!1),void 0}return!r.success==!0?(this.fireEvent("exception",this,"remote",e,t,r,s),t.callback.call(t.scope||window,null,r,!1),void 0):(this.fireEvent("write",this,e,r.data,r,s,t.arg),t.callback.call(t.scope||window,r.data,r,!0),void 0)},isLoading:function(){return this.trans?!0:!1},abort:function(){this.isLoading()&&this.destroyTrans(this.trans)},destroyTrans:function(e,t){if(this.head.removeChild(document.getElementById(e.scriptId)),clearTimeout(e.timeoutId),t){window[e.cb]=void 0;try{delete window[e.cb]}catch(i){}}else window[e.cb]=function(){window[e.cb]=void 0;try{delete window[e.cb]}catch(t){}}},handleFailure:function(e){this.trans=!1,this.destroyTrans(e,!1),e.action===Ext.data.Api.actions.read&&this.fireEvent("loadexception",this,null,e.arg),this.fireEvent("exception",this,"response",e.action,{response:null,options:e.arg}),e.callback.call(e.scope||window,null,e.arg,!1)},destroy:function(){this.abort(),Ext.data.ScriptTagProxy.superclass.destroy.call(this)}}),Ext.data.HttpProxy=function(e){Ext.data.HttpProxy.superclass.constructor.call(this,e),this.conn=e,this.conn.url=null,this.useAjax=!e||!e.events;var t=Ext.data.Api.actions;this.activeRequest={};for(var i in t)this.activeRequest[t[i]]=void 0},Ext.extend(Ext.data.HttpProxy,Ext.data.DataProxy,{getConnection:function(){return this.useAjax?Ext.Ajax:this.conn},setUrl:function(e,t){this.conn.url=e,t===!0&&(this.url=e,this.api=null,Ext.data.Api.prepare(this))},doRequest:function(e,t,i,s,n,r,a){var o={method:this.api[e]?this.api[e].method:void 0,request:{callback:n,scope:r,arg:a},reader:s,callback:this.createCallback(e,t),scope:this};i.jsonData?o.jsonData=i.jsonData:i.xmlData?o.xmlData=i.xmlData:o.params=i||{},this.conn.url=this.buildUrl(e,t),this.useAjax?(Ext.applyIf(o,this.conn),this.activeRequest[e],this.activeRequest[e]=Ext.Ajax.request(o)):this.conn.request(o),this.conn.url=null},createCallback:function(e,t){return function(i,s,n){return this.activeRequest[e]=void 0,s?(e===Ext.data.Api.actions.read?this.onRead(e,i,n):this.onWrite(e,i,n,t),void 0):(e===Ext.data.Api.actions.read&&this.fireEvent("loadexception",this,i,n),this.fireEvent("exception",this,"response",e,i,n),i.request.callback.call(i.request.scope,null,i.request.arg,!1),void 0)}},onRead:function(e,t,i){var s;try{s=t.reader.read(i)}catch(n){return this.fireEvent("loadexception",this,t,i,n),this.fireEvent("exception",this,"response",e,t,i,n),t.request.callback.call(t.request.scope,null,t.request.arg,!1),void 0}if(s.success===!1){this.fireEvent("loadexception",this,t,i);var r=t.reader.readResponse(e,i);this.fireEvent("exception",this,"remote",e,t,r,null)}else this.fireEvent("load",this,t,t.request.arg);t.request.callback.call(t.request.scope,s,t.request.arg,s.success)},onWrite:function(e,t,i,s){var n,r=t.reader;try{n=r.readResponse(e,i)}catch(a){return this.fireEvent("exception",this,"response",e,t,i,a),t.request.callback.call(t.request.scope,null,t.request.arg,!1),void 0}n.success===!0?this.fireEvent("write",this,e,n.data,n,s,t.request.arg):this.fireEvent("exception",this,"remote",e,t,n,s),t.request.callback.call(t.request.scope,n.data,n,n.success)},destroy:function(){if(this.useAjax){if(this.activeRequest){var e=Ext.data.Api.actions;for(var t in e)this.activeRequest[e[t]]&&Ext.Ajax.abort(this.activeRequest[e[t]])}}else this.conn.abort();Ext.data.HttpProxy.superclass.destroy.call(this)}}),Ext.data.MemoryProxy=function(e){var t={};t[Ext.data.Api.actions.read]=!0,Ext.data.MemoryProxy.superclass.constructor.call(this,{api:t}),this.data=e},Ext.extend(Ext.data.MemoryProxy,Ext.data.DataProxy,{doRequest:function(e,t,i,s,n,r,a){i=i||{};var o;try{o=s.readRecords(this.data)}catch(l){return this.fireEvent("loadexception",this,null,a,l),this.fireEvent("exception",this,"response",e,a,null,l),n.call(r,null,a,!1),void 0}n.call(r,o,a,!0)}}),Ext.data.Types=new function(){var e=Ext.data.SortTypes;Ext.apply(this,{stripRe:/[\$,%]/g,AUTO:{convert:function(e){return e},sortType:e.none,type:"auto"},STRING:{convert:function(e){return void 0===e||null===e?"":String(e)},sortType:e.asUCString,type:"string"},INT:{convert:function(e){return void 0!==e&&null!==e&&""!==e?parseInt(String(e).replace(Ext.data.Types.stripRe,""),10):this.useNull?null:0},sortType:e.none,type:"int"},FLOAT:{convert:function(e){return void 0!==e&&null!==e&&""!==e?parseFloat(String(e).replace(Ext.data.Types.stripRe,""),10):this.useNull?null:0},sortType:e.none,type:"float"},BOOL:{convert:function(e){return e===!0||"true"===e||1==e},sortType:e.none,type:"bool"},DATE:{convert:function(e){var t=this.dateFormat;if(!e)return null;if(Ext.isDate(e))return e;if(t)return"timestamp"==t?new Date(1e3*e):"time"==t?new Date(parseInt(e,10)):Date.parseDate(e,t);var i=Date.parse(e);return i?new Date(i):null},sortType:e.asDate,type:"date"}}),Ext.apply(this,{BOOLEAN:this.BOOL,INTEGER:this.INT,NUMBER:this.FLOAT})},Ext.data.JsonWriter=Ext.extend(Ext.data.DataWriter,{encode:!0,encodeDelete:!1,constructor:function(e){Ext.data.JsonWriter.superclass.constructor.call(this,e)},render:function(e,t,i){if(this.encode===!0)Ext.apply(e,t),e[this.meta.root]=Ext.encode(i);else{var s=Ext.apply({},t);s[this.meta.root]=i,e.jsonData=s}},createRecord:function(e){return this.toHash(e)},updateRecord:function(e){return this.toHash(e)},destroyRecord:function(e){if(this.encodeDelete){var t={};return t[this.meta.idProperty]=e.id,t}return e.id}}),Ext.data.JsonReader=function(e,t){e=e||{},Ext.applyIf(e,{idProperty:"id",successProperty:"success",totalProperty:"total"}),Ext.data.JsonReader.superclass.constructor.call(this,e,t||e.fields)},Ext.extend(Ext.data.JsonReader,Ext.data.DataReader,{read:function(e){var t=e.responseText,i=Ext.decode(t);if(!i)throw{message:"JsonReader.read: Json object not found"};return this.readRecords(i)},readResponse:function(e,t){var i=void 0!==t.responseText?Ext.decode(t.responseText):t;if(!i)throw new Ext.data.JsonReader.Error("response");var s=this.getRoot(i),n=this.getSuccess(i);if(n&&e===Ext.data.Api.actions.create){var r=Ext.isDefined(s);if(r&&Ext.isEmpty(s))throw new Ext.data.JsonReader.Error("root-empty",this.meta.root);if(!r)throw new Ext.data.JsonReader.Error("root-undefined-response",this.meta.root)}var a=new Ext.data.Response({action:e,success:n,data:s?this.extractData(s,!1):[],message:this.getMessage(i),raw:i});if(Ext.isEmpty(a.success))throw new Ext.data.JsonReader.Error("successProperty-response",this.meta.successProperty);return a},readRecords:function(e){this.jsonData=e,e.metaData&&this.onMetaChange(e.metaData);var t,i=this.meta,s=this.recordType,n=s.prototype.fields;n.items,n.length;var r=this.getRoot(e),a=r.length,o=a,l=!0;return i.totalProperty&&(t=parseInt(this.getTotal(e),10),isNaN(t)||(o=t)),i.successProperty&&(t=this.getSuccess(e),(t===!1||"false"===t)&&(l=!1)),{success:l,records:this.extractData(r,!0),totalRecords:o}},buildExtractors:function(){if(!this.ef){var e=this.meta,t=this.recordType,i=t.prototype.fields,s=i.items,n=i.length;if(e.totalProperty&&(this.getTotal=this.createAccessor(e.totalProperty)),e.successProperty&&(this.getSuccess=this.createAccessor(e.successProperty)),e.messageProperty&&(this.getMessage=this.createAccessor(e.messageProperty)),this.getRoot=e.root?this.createAccessor(e.root):function(e){return e},e.id||e.idProperty){var r=this.createAccessor(e.id||e.idProperty);this.getId=function(e){var t=r(e);return void 0===t||""===t?null:t}}else this.getId=function(){return null};for(var a=[],o=0;n>o;o++){i=s[o];var l=void 0!==i.mapping&&null!==i.mapping?i.mapping:i.name;a.push(this.createAccessor(l))}this.ef=a}},simpleAccess:function(e,t){return e[t]},createAccessor:function(){var e=/[\[\.]/;return function(t){if(Ext.isEmpty(t))return Ext.emptyFn;if(Ext.isFunction(t))return t;var i=String(t).search(e);return i>=0?new Function("obj","return obj"+(i>0?".":"")+t):function(e){return e[t]}}}(),extractValues:function(e,t,i){for(var s,n={},r=0;i>r;r++){s=t[r];var a=this.ef[r](e);n[s.name]=s.convert(void 0!==a?a:s.defaultValue,e)}return n}}),Ext.data.JsonReader.Error=Ext.extend(Ext.Error,{constructor:function(e,t){this.arg=t,Ext.Error.call(this,e)},name:"Ext.data.JsonReader"}),Ext.apply(Ext.data.JsonReader.Error.prototype,{lang:{response:"An error occurred while json-decoding your server response","successProperty-response":'Could not locate your "successProperty" in your server response.  Please review your JsonReader config to ensure the config-property "successProperty" matches the property in your server-response.  See the JsonReader docs.',"root-undefined-config":'Your JsonReader was configured without a "root" property.  Please review your JsonReader config and make sure to define the root property.  See the JsonReader docs.',"idProperty-undefined":'Your JsonReader was configured without an "idProperty"  Please review your JsonReader configuration and ensure the "idProperty" is set (e.g.: "id").  See the JsonReader docs.',"root-empty":'Data was expected to be returned by the server in the "root" property of the response.  Please review your JsonReader configuration to ensure the "root" property matches that returned in the server-response.  See JsonReader docs.'}}),Ext.data.ArrayReader=Ext.extend(Ext.data.JsonReader,{readRecords:function(e){this.arrayData=e;for(var t,i=this.meta,s=i?Ext.num(i.idIndex,i.id):null,n=this.recordType,r=n.prototype.fields,a=[],o=!0,l=this.getRoot(e),h=0,u=l.length;u>h;h++){for(var c=l[h],d={},p=!s&&0!==s||void 0===c[s]||""===c[s]?null:c[s],f=0,m=r.length;m>f;f++){var y=r.items[f],g=void 0!==y.mapping&&null!==y.mapping?y.mapping:f;t=void 0!==c[g]?c[g]:y.defaultValue,t=y.convert(t,c),d[y.name]=t}var v=new n(d,p);v.json=c,a[a.length]=v}var x=a.length;return i.totalProperty&&(t=parseInt(this.getTotal(e),10),isNaN(t)||(x=t)),i.successProperty&&(t=this.getSuccess(e),(t===!1||"false"===t)&&(o=!1)),{success:o,records:a,totalRecords:x}}}),Ext.data.ArrayStore=Ext.extend(Ext.data.Store,{constructor:function(e){Ext.data.ArrayStore.superclass.constructor.call(this,Ext.apply(e,{reader:new Ext.data.ArrayReader(e)}))},loadData:function(e,t){if(this.expandData===!0){for(var i=[],s=0,n=e.length;n>s;s++)i[i.length]=[e[s]];e=i}Ext.data.ArrayStore.superclass.loadData.call(this,e,t)}}),Ext.reg("arraystore",Ext.data.ArrayStore),Ext.data.SimpleStore=Ext.data.ArrayStore,Ext.reg("simplestore",Ext.data.SimpleStore),Ext.data.JsonStore=Ext.extend(Ext.data.Store,{constructor:function(e){Ext.data.JsonStore.superclass.constructor.call(this,Ext.apply(e,{reader:new Ext.data.JsonReader(e)}))}}),Ext.reg("jsonstore",Ext.data.JsonStore),Ext.data.XmlWriter=function(){Ext.data.XmlWriter.superclass.constructor.apply(this,arguments),this.tpl="string"==typeof this.tpl?new Ext.XTemplate(this.tpl).compile():this.tpl.compile()},Ext.extend(Ext.data.XmlWriter,Ext.data.DataWriter,{documentRoot:"xrequest",forceDocumentRoot:!1,root:"records",xmlVersion:"1.0",xmlEncoding:"ISO-8859-15",tpl:'<tpl for="."><?xml version="{version}" encoding="{encoding}"?><tpl if="documentRoot"><{documentRoot}><tpl for="baseParams"><tpl for="."><{name}>{value}</{name}></tpl></tpl></tpl><tpl if="records.length&gt;1"><{root}></tpl><tpl for="records"><{parent.record}><tpl for="."><{name}>{value}</{name}></tpl></{parent.record}></tpl><tpl if="records.length&gt;1"></{root}></tpl><tpl if="documentRoot"></{documentRoot}></tpl></tpl>',render:function(e,t,i){t=this.toArray(t),e.xmlData=this.tpl.applyTemplate({version:this.xmlVersion,encoding:this.xmlEncoding,documentRoot:t.length>0||this.forceDocumentRoot===!0?this.documentRoot:!1,record:this.meta.record,root:this.root,baseParams:t,records:Ext.isArray(i[0])?i:[i]})},createRecord:function(e){return this.toArray(this.toHash(e))},updateRecord:function(e){return this.toArray(this.toHash(e))},destroyRecord:function(e){var t={};return t[this.meta.idProperty]=e.id,this.toArray(t)}}),Ext.data.XmlReader=function(e,t){e=e||{},Ext.applyIf(e,{idProperty:e.idProperty||e.idPath||e.id,successProperty:e.successProperty||e.success}),Ext.data.XmlReader.superclass.constructor.call(this,e,t||e.fields)},Ext.extend(Ext.data.XmlReader,Ext.data.DataReader,{read:function(e){var t=e.responseXML;if(!t)throw{message:"XmlReader.read: XML Document not available"};return this.readRecords(t)},readRecords:function(e){this.xmlData=e;var t=e.documentElement||e,i=Ext.DomQuery,s=0,n=!0;this.meta.totalProperty&&(s=this.getTotal(t,0)),this.meta.successProperty&&(n=this.getSuccess(t));var r=this.extractData(i.select(this.meta.record,t),!0);return{success:n,records:r,totalRecords:s||r.length}},readResponse:function(e,t){var i=Ext.DomQuery,s=t.responseXML,n=s.documentElement||s,r=new Ext.data.Response({action:e,success:this.getSuccess(n),message:this.getMessage(n),data:this.extractData(i.select(this.meta.record,n)||i.select(this.meta.root,n),!1),raw:s});if(Ext.isEmpty(r.success))throw new Ext.data.DataReader.Error("successProperty-response",this.meta.successProperty);if(e===Ext.data.Api.actions.create){var a=Ext.isDefined(r.data);if(a&&Ext.isEmpty(r.data))throw new Ext.data.JsonReader.Error("root-empty",this.meta.root);if(!a)throw new Ext.data.JsonReader.Error("root-undefined-response",this.meta.root)}return r},getSuccess:function(){return!0},buildExtractors:function(){if(!this.ef){var e=this.meta,t=this.recordType,i=t.prototype.fields,s=i.items,n=i.length;if(e.totalProperty&&(this.getTotal=this.createAccessor(e.totalProperty)),e.successProperty&&(this.getSuccess=this.createAccessor(e.successProperty)),e.messageProperty&&(this.getMessage=this.createAccessor(e.messageProperty)),this.getRoot=function(e){return Ext.isEmpty(e[this.meta.record])?e[this.meta.root]:e[this.meta.record]},e.idPath||e.idProperty){var r=this.createAccessor(e.idPath||e.idProperty);this.getId=function(e){var t=r(e)||e.id;return void 0===t||""===t?null:t}}else this.getId=function(){return null};for(var a=[],o=0;n>o;o++){i=s[o];var l=void 0!==i.mapping&&null!==i.mapping?i.mapping:i.name;a.push(this.createAccessor(l))}this.ef=a}},createAccessor:function(){var e=Ext.DomQuery;return function(t){if(Ext.isFunction(t))return t;switch(t){case this.meta.totalProperty:return function(i,s){return e.selectNumber(t,i,s)};case this.meta.successProperty:return function(i){var s=e.selectValue(t,i,!0),n=s!==!1&&"false"!==s;return n};default:return function(i,s){return e.selectValue(t,i,s)}}}}(),extractValues:function(e,t,i){for(var s,n={},r=0;i>r;r++){s=t[r];var a=this.ef[r](e);n[s.name]=s.convert(void 0!==a?a:s.defaultValue,e)}return n}}),Ext.data.XmlStore=Ext.extend(Ext.data.Store,{constructor:function(e){Ext.data.XmlStore.superclass.constructor.call(this,Ext.apply(e,{reader:new Ext.data.XmlReader(e)}))}}),Ext.reg("xmlstore",Ext.data.XmlStore),Ext.data.GroupingStore=Ext.extend(Ext.data.Store,{constructor:function(e){e=e||{},this.hasMultiSort=!0,this.multiSortInfo=this.multiSortInfo||{sorters:[]};var t=this.multiSortInfo.sorters,i=e.groupField||this.groupField,s=e.sortInfo||this.sortInfo,n=e.groupDir||this.groupDir;i&&t.push({field:i,direction:n}),s&&t.push(s),Ext.data.GroupingStore.superclass.constructor.call(this,e),this.addEvents("groupchange"),this.applyGroupField()},remoteGroup:!1,groupOnSort:!1,groupDir:"ASC",clearGrouping:function(){if(this.groupField=!1,this.remoteGroup){this.baseParams&&(delete this.baseParams.groupBy,delete this.baseParams.groupDir);var e=this.lastOptions;e&&e.params&&(delete e.params.groupBy,delete e.params.groupDir),this.reload()}else this.sort(),this.fireEvent("datachanged",this)},groupBy:function(e,t,i){if(i=i?"DESC"==String(i).toUpperCase()?"DESC":"ASC":this.groupDir,this.groupField!=e||this.groupDir!=i||t){var s=this.multiSortInfo.sorters;s.length>0&&s[0].field==this.groupField&&s.shift(),this.groupField=e,this.groupDir=i,this.applyGroupField();var n=function(){this.fireEvent("groupchange",this,this.getGroupState())};return this.groupOnSort?(this.sort(e,i),n.call(this),void 0):(this.remoteGroup?(this.on("load",n,this,{single:!0}),this.reload()):(this.sort(s),n.call(this)),void 0)}},sort:function(e,t){if(this.remoteSort)return Ext.data.GroupingStore.superclass.sort.call(this,e,t);var i=[];if(Ext.isArray(arguments[0]))i=arguments[0];else if(void 0==e)i=this.sortInfo?[this.sortInfo]:[];else{var s=this.fields.get(e);if(!s)return!1;var n=s.name,r=this.sortInfo||null;this.sortToggle?this.sortToggle[n]:null,t||(t=r&&r.field==n?(this.sortToggle[n]||"ASC").toggle("ASC","DESC"):s.sortDir),this.sortToggle[n]=t,this.sortInfo={field:n,direction:t},i=[this.sortInfo]}return this.groupField&&i.unshift({direction:this.groupDir,field:this.groupField}),this.multiSort.call(this,i,t)
},applyGroupField:function(){if(this.remoteGroup){this.baseParams||(this.baseParams={}),Ext.apply(this.baseParams,{groupBy:this.groupField,groupDir:this.groupDir});var e=this.lastOptions;e&&e.params&&(e.params.groupDir=this.groupDir,delete e.params.groupBy)}},applyGrouping:function(e){return this.groupField!==!1?(this.groupBy(this.groupField,!0,this.groupDir),!0):(e===!0&&this.fireEvent("datachanged",this),!1)},getGroupState:function(){return this.groupOnSort&&this.groupField!==!1?this.sortInfo?this.sortInfo.field:void 0:this.groupField}}),Ext.reg("groupingstore",Ext.data.GroupingStore),Ext.data.DirectProxy=function(e){Ext.apply(this,e),"string"==typeof this.paramOrder&&(this.paramOrder=this.paramOrder.split(/[\s,|]/)),Ext.data.DirectProxy.superclass.constructor.call(this,e)},Ext.extend(Ext.data.DirectProxy,Ext.data.DataProxy,{paramOrder:void 0,paramsAsHash:!0,directFn:void 0,doRequest:function(e,t,i,s,n,r,a){var o=[],l=this.api[e]||this.directFn;switch(e){case Ext.data.Api.actions.create:o.push(i.jsonData);break;case Ext.data.Api.actions.read:if(l.directCfg.method.len>0)if(this.paramOrder)for(var h=0,u=this.paramOrder.length;u>h;h++)o.push(i[this.paramOrder[h]]);else this.paramsAsHash&&o.push(i);break;case Ext.data.Api.actions.update:o.push(i.jsonData);break;case Ext.data.Api.actions.destroy:o.push(i.jsonData)}var c={params:i||{},request:{callback:n,scope:r,arg:a},reader:s};o.push(this.createCallback(e,t,c),this),l.apply(window,o)},createCallback:function(e,t,i){var s=this;return function(n,r){return r.status?(e===Ext.data.Api.actions.read?s.onRead(e,i,n,r):s.onWrite(e,i,n,r,t),void 0):(e===Ext.data.Api.actions.read&&s.fireEvent("loadexception",s,i,r,null),s.fireEvent("exception",s,"remote",e,i,r,null),i.request.callback.call(i.request.scope,null,i.request.arg,!1),void 0)}},onRead:function(e,t,i,s){var n;try{n=t.reader.readRecords(i)}catch(r){return this.fireEvent("loadexception",this,t,s,r),this.fireEvent("exception",this,"response",e,t,s,r),t.request.callback.call(t.request.scope,null,t.request.arg,!1),void 0}this.fireEvent("load",this,s,t.request.arg),t.request.callback.call(t.request.scope,n,t.request.arg,!0)},onWrite:function(e,t,i,s,n){var r=t.reader.extractData(t.reader.getRoot(i),!1),a=t.reader.getSuccess(i);a=a!==!1,a?this.fireEvent("write",this,e,r,s,n,t.request.arg):this.fireEvent("exception",this,"remote",e,t,i,n),t.request.callback.call(t.request.scope,r,s,a)}}),Ext.data.DirectStore=Ext.extend(Ext.data.Store,{constructor:function(e){var t=Ext.apply({},{batchTransactions:!1},e);Ext.data.DirectStore.superclass.constructor.call(this,Ext.apply(t,{proxy:Ext.isDefined(t.proxy)?t.proxy:new Ext.data.DirectProxy(Ext.copyTo({},t,"paramOrder,paramsAsHash,directFn,api")),reader:!Ext.isDefined(t.reader)&&t.fields?new Ext.data.JsonReader(Ext.copyTo({},t,"totalProperty,root,idProperty"),t.fields):t.reader}))}}),Ext.reg("directstore",Ext.data.DirectStore),Ext.Direct=Ext.extend(Ext.util.Observable,{exceptions:{TRANSPORT:"xhr",PARSE:"parse",LOGIN:"login",SERVER:"exception"},constructor:function(){this.addEvents("event","exception"),this.transactions={},this.providers={}},addProvider:function(e){var t=arguments;{if(!(t.length>1))return e.events||(e=new Ext.Direct.PROVIDERS[e.type](e)),e.id=e.id||Ext.id(),this.providers[e.id]=e,e.on("data",this.onProviderData,this),e.on("exception",this.onProviderException,this),e.isConnected()||e.connect(),e;for(var i=0,s=t.length;s>i;i++)this.addProvider(t[i])}},getProvider:function(e){return this.providers[e]},removeProvider:function(e){var t=e.id?e:this.providers[e];return t.un("data",this.onProviderData,this),t.un("exception",this.onProviderException,this),delete this.providers[t.id],t},addTransaction:function(e){return this.transactions[e.tid]=e,e},removeTransaction:function(e){return delete this.transactions[e.tid||e],e},getTransaction:function(e){return this.transactions[e.tid||e]},onProviderData:function(e,t){if(Ext.isArray(t))for(var i=0,s=t.length;s>i;i++)this.onProviderData(e,t[i]);else t.name&&"event"!=t.name&&"exception"!=t.name?this.fireEvent(t.name,t):"exception"==t.type&&this.fireEvent("exception",t),this.fireEvent("event",t,e)},createEvent:function(e,t){return new Ext.Direct.eventTypes[e.type](Ext.apply(e,t))}}),Ext.Direct=new Ext.Direct,Ext.Direct.TID=1,Ext.Direct.PROVIDERS={},Ext.Direct.Transaction=function(e){Ext.apply(this,e),this.tid=++Ext.Direct.TID,this.retryCount=0},Ext.Direct.Transaction.prototype={send:function(){this.provider.queueTransaction(this)},retry:function(){this.retryCount++,this.send()},getProvider:function(){return this.provider}},Ext.Direct.Event=function(e){Ext.apply(this,e)},Ext.Direct.Event.prototype={status:!0,getData:function(){return this.data}},Ext.Direct.RemotingEvent=Ext.extend(Ext.Direct.Event,{type:"rpc",getTransaction:function(){return this.transaction||Ext.Direct.getTransaction(this.tid)}}),Ext.Direct.ExceptionEvent=Ext.extend(Ext.Direct.RemotingEvent,{status:!1,type:"exception"}),Ext.Direct.eventTypes={rpc:Ext.Direct.RemotingEvent,event:Ext.Direct.Event,exception:Ext.Direct.ExceptionEvent},Ext.direct.Provider=Ext.extend(Ext.util.Observable,{priority:1,constructor:function(e){Ext.apply(this,e),this.addEvents("connect","disconnect","data","exception"),Ext.direct.Provider.superclass.constructor.call(this,e)},isConnected:function(){return!1},connect:Ext.emptyFn,disconnect:Ext.emptyFn}),Ext.direct.JsonProvider=Ext.extend(Ext.direct.Provider,{parseResponse:function(e){return Ext.isEmpty(e.responseText)?null:"object"==typeof e.responseText?e.responseText:Ext.decode(e.responseText)},getEvents:function(e){var t=null;try{t=this.parseResponse(e)}catch(i){var s=new Ext.Direct.ExceptionEvent({data:i,xhr:e,code:Ext.Direct.exceptions.PARSE,message:"Error parsing json response: \n\n "+t});return[s]}var n=[];if(Ext.isArray(t))for(var r=0,a=t.length;a>r;r++)n.push(Ext.Direct.createEvent(t[r]));else n.push(Ext.Direct.createEvent(t));return n}}),Ext.direct.PollingProvider=Ext.extend(Ext.direct.JsonProvider,{priority:3,interval:3e3,constructor:function(e){Ext.direct.PollingProvider.superclass.constructor.call(this,e),this.addEvents("beforepoll","poll")},isConnected:function(){return!!this.pollTask},connect:function(){if(this.url&&!this.pollTask)this.pollTask=Ext.TaskMgr.start({run:function(){this.fireEvent("beforepoll",this)!==!1&&("function"==typeof this.url?this.url(this.baseParams):Ext.Ajax.request({url:this.url,callback:this.onData,scope:this,params:this.baseParams}))},interval:this.interval,scope:this}),this.fireEvent("connect",this);else if(!this.url)throw"Error initializing PollingProvider, no url configured."},disconnect:function(){this.pollTask&&(Ext.TaskMgr.stop(this.pollTask),delete this.pollTask,this.fireEvent("disconnect",this))},onData:function(e,t,i){if(t)for(var s=this.getEvents(i),n=0,r=s.length;r>n;n++){var a=s[n];this.fireEvent("data",this,a)}else{var a=new Ext.Direct.ExceptionEvent({data:a,code:Ext.Direct.exceptions.TRANSPORT,message:"Unable to connect to the server.",xhr:i});this.fireEvent("data",this,a)}}}),Ext.Direct.PROVIDERS.polling=Ext.direct.PollingProvider,Ext.direct.RemotingProvider=Ext.extend(Ext.direct.JsonProvider,{enableBuffer:10,maxRetries:1,timeout:void 0,constructor:function(e){Ext.direct.RemotingProvider.superclass.constructor.call(this,e),this.addEvents("beforecall","call"),this.namespace=Ext.isString(this.namespace)?Ext.ns(this.namespace):this.namespace||window,this.transactions={},this.callBuffer=[]},initAPI:function(){var e=this.actions;for(var t in e)for(var i=this.namespace[t]||(this.namespace[t]={}),s=e[t],n=0,r=s.length;r>n;n++){var a=s[n];i[a.name]=this.createMethod(t,a)}},isConnected:function(){return!!this.connected},connect:function(){if(this.url)this.initAPI(),this.connected=!0,this.fireEvent("connect",this);else if(!this.url)throw"Error initializing RemotingProvider, no url configured."},disconnect:function(){this.connected&&(this.connected=!1,this.fireEvent("disconnect",this))},onData:function(e,t,i){if(t)for(var s=this.getEvents(i),n=0,r=s.length;r>n;n++){var a=s[n],o=this.getTransaction(a);this.fireEvent("data",this,a),o&&(this.doCallback(o,a,!0),Ext.Direct.removeTransaction(o))}else for(var l=[].concat(e.ts),n=0,r=l.length;r>n;n++){var o=this.getTransaction(l[n]);if(o&&o.retryCount<this.maxRetries)o.retry();else{var a=new Ext.Direct.ExceptionEvent({data:a,transaction:o,code:Ext.Direct.exceptions.TRANSPORT,message:"Unable to connect to the server.",xhr:i});this.fireEvent("data",this,a),o&&(this.doCallback(o,a,!1),Ext.Direct.removeTransaction(o))}}},getCallData:function(e){return{action:e.action,method:e.method,data:e.data,type:"rpc",tid:e.tid}},doSend:function(e){var t,i={url:this.url,callback:this.onData,scope:this,ts:e,timeout:this.timeout};if(Ext.isArray(e)){t=[];for(var s=0,n=e.length;n>s;s++)t.push(this.getCallData(e[s]))}else t=this.getCallData(e);if(this.enableUrlEncode){var r={};r[Ext.isString(this.enableUrlEncode)?this.enableUrlEncode:"data"]=Ext.encode(t),i.params=r}else i.jsonData=t;Ext.Ajax.request(i)},combineAndSend:function(){var e=this.callBuffer.length;e>0&&(this.doSend(1==e?this.callBuffer[0]:this.callBuffer),this.callBuffer=[])},queueTransaction:function(e){return e.form?(this.processForm(e),void 0):(this.callBuffer.push(e),this.enableBuffer?(this.callTask||(this.callTask=new Ext.util.DelayedTask(this.combineAndSend,this)),this.callTask.delay(Ext.isNumber(this.enableBuffer)?this.enableBuffer:10)):this.combineAndSend(),void 0)},doCall:function(e,t,i){var s=null,n=i[t.len],r=i[t.len+1];0!==t.len&&(s=i.slice(0,t.len));var a=new Ext.Direct.Transaction({provider:this,args:i,action:e,method:t.name,data:s,cb:r&&Ext.isFunction(n)?n.createDelegate(r):n});this.fireEvent("beforecall",this,a,t)!==!1&&(Ext.Direct.addTransaction(a),this.queueTransaction(a),this.fireEvent("call",this,a,t))},doForm:function(e,t,i,s,n){var r=new Ext.Direct.Transaction({provider:this,action:e,method:t.name,args:[i,s,n],cb:n&&Ext.isFunction(s)?s.createDelegate(n):s,isForm:!0});if(this.fireEvent("beforecall",this,r,t)!==!1){Ext.Direct.addTransaction(r);var a="multipart/form-data"==String(i.getAttribute("enctype")).toLowerCase(),o={extTID:r.tid,extAction:e,extMethod:t.name,extType:"rpc",extUpload:String(a)};Ext.apply(r,{form:Ext.getDom(i),isUpload:a,params:s&&Ext.isObject(s.params)?Ext.apply(o,s.params):o}),this.fireEvent("call",this,r,t),this.processForm(r)}},processForm:function(e){Ext.Ajax.request({url:this.url,params:e.params,callback:this.onData,scope:this,form:e.form,isUpload:e.isUpload,ts:e})},createMethod:function(e,t){var i;return i=t.formHandler?function(i,s,n){this.doForm(e,t,i,s,n)}.createDelegate(this):function(){this.doCall(e,t,Array.prototype.slice.call(arguments,0))}.createDelegate(this),i.directCfg={action:e,method:t},i},getTransaction:function(e){return e&&e.tid?Ext.Direct.getTransaction(e.tid):null},doCallback:function(e,t){var i=t.status?"success":"failure";if(e&&e.cb){var s=e.cb,n=Ext.isDefined(t.result)?t.result:t.data;Ext.isFunction(s)?s(n,t):(Ext.callback(s[i],s.scope,[n,t]),Ext.callback(s.callback,s.scope,[n,t]))}}}),Ext.Direct.PROVIDERS.remoting=Ext.direct.RemotingProvider,Ext.Resizable=Ext.extend(Ext.util.Observable,{constructor:function(e,t){if(this.el=Ext.get(e),t&&t.wrap){if(t.resizeChild=this.el,this.el=this.el.wrap("object"==typeof t.wrap?t.wrap:{cls:"xresizable-wrap"}),this.el.id=this.el.dom.id=t.resizeChild.id+"-rzwrap",this.el.setStyle("overflow","hidden"),this.el.setPositioning(t.resizeChild.getPositioning()),t.resizeChild.clearPositioning(),!t.width||!t.height){var i=t.resizeChild.getSize();this.el.setSize(i.width,i.height)}t.pinned&&!t.adjustments&&(t.adjustments="auto")}this.proxy=this.el.createProxy({tag:"div",cls:"x-resizable-proxy",id:this.el.id+"-rzproxy"},Ext.getBody()),this.proxy.unselectable(),this.proxy.enableDisplayMode("block"),Ext.apply(this,t),this.pinned&&(this.disableTrackOver=!0,this.el.addClass("x-resizable-pinned"));var s=this.el.getStyle("position");"absolute"!=s&&"fixed"!=s&&this.el.setStyle("position","relative"),this.handles||(this.handles="s,e,se",this.multiDirectional&&(this.handles+=",n,w")),"all"==this.handles&&(this.handles="n s e w ne nw se sw");for(var n=this.handles.split(/\s*?[,;]\s*?| /),r=Ext.Resizable.positions,a=0,o=n.length;o>a;a++)if(n[a]&&r[n[a]]){var l=r[n[a]];this[l]=new Ext.Resizable.Handle(this,l,this.disableTrackOver,this.transparent,this.handleCls)}if(this.corner=this.southeast,(-1!=this.handles.indexOf("n")||-1!=this.handles.indexOf("w"))&&(this.updateBox=!0),this.activeHandle=null,this.resizeChild&&(this.resizeChild="boolean"==typeof this.resizeChild?Ext.get(this.el.dom.firstChild,!0):Ext.get(this.resizeChild,!0)),"auto"==this.adjustments){var h=this.resizeChild,u=this.west,c=this.east,d=this.north,n=this.south;h&&(u||d)&&(h.position("relative"),h.setLeft(u?u.el.getWidth():0),h.setTop(d?d.el.getHeight():0)),this.adjustments=[(c?-c.el.getWidth():0)+(u?-u.el.getWidth():0),(d?-d.el.getHeight():0)+(n?-n.el.getHeight():0)-1]}this.draggable&&(this.dd=this.dynamic?this.el.initDD(null):this.el.initDDProxy(null,{dragElId:this.proxy.id}),this.dd.setHandleElId(this.resizeChild?this.resizeChild.id:this.el.id),this.constrainTo&&this.dd.constrainTo(this.constrainTo)),this.addEvents("beforeresize","resize"),null!==this.width&&null!==this.height?this.resizeTo(this.width,this.height):this.updateChildSize(),Ext.isIE&&(this.el.dom.style.zoom=1),Ext.Resizable.superclass.constructor.call(this)},adjustments:[0,0],animate:!1,disableTrackOver:!1,draggable:!1,duration:.35,dynamic:!1,easing:"easeOutStrong",enabled:!0,handles:!1,multiDirectional:!1,height:null,width:null,heightIncrement:0,widthIncrement:0,minHeight:5,minWidth:5,maxHeight:1e4,maxWidth:1e4,minX:0,minY:0,pinned:!1,preserveRatio:!1,resizeChild:!1,transparent:!1,resizeTo:function(e,t){this.el.setSize(e,t),this.updateChildSize(),this.fireEvent("resize",this,e,t,null)},startSizing:function(e,t){if(this.fireEvent("beforeresize",this,e),this.enabled){if(this.overlay||(this.overlay=this.el.createProxy({tag:"div",cls:"x-resizable-overlay",html:"&#160;"},Ext.getBody()),this.overlay.unselectable(),this.overlay.enableDisplayMode("block"),this.overlay.on({scope:this,mousemove:this.onMouseMove,mouseup:this.onMouseUp})),this.overlay.setStyle("cursor",t.el.getStyle("cursor")),this.resizing=!0,this.startBox=this.el.getBox(),this.startPoint=e.getXY(),this.offsets=[this.startBox.x+this.startBox.width-this.startPoint[0],this.startBox.y+this.startBox.height-this.startPoint[1]],this.overlay.setSize(Ext.lib.Dom.getViewWidth(!0),Ext.lib.Dom.getViewHeight(!0)),this.overlay.show(),this.constrainTo){var i=Ext.get(this.constrainTo);this.resizeRegion=i.getRegion().adjust(i.getFrameWidth("t"),i.getFrameWidth("l"),-i.getFrameWidth("b"),-i.getFrameWidth("r"))}this.proxy.setStyle("visibility","hidden"),this.proxy.show(),this.proxy.setBox(this.startBox),this.dynamic||this.proxy.setStyle("visibility","visible")}},onMouseDown:function(e,t){this.enabled&&(t.stopEvent(),this.activeHandle=e,this.startSizing(t,e))},onMouseUp:function(e){this.activeHandle=null;var t=this.resizeElement();this.resizing=!1,this.handleOut(),this.overlay.hide(),this.proxy.hide(),this.fireEvent("resize",this,t.width,t.height,e)},updateChildSize:function(){if(this.resizeChild){var e=this.el,t=this.resizeChild,i=this.adjustments;if(e.dom.offsetWidth){var s=e.getSize(!0);t.setSize(s.width+i[0],s.height+i[1])}Ext.isIE&&setTimeout(function(){if(e.dom.offsetWidth){var s=e.getSize(!0);t.setSize(s.width+i[0],s.height+i[1])}},10)}},snap:function(e,t,i){if(!t||!e)return e;var s=e,n=e%t;return n>0&&(s=n>t/2?e+(t-n):e-n),Math.max(i,s)},resizeElement:function(){var e=this.proxy.getBox();return this.updateBox?this.el.setBox(e,!1,this.animate,this.duration,null,this.easing):this.el.setSize(e.width,e.height,this.animate,this.duration,null,this.easing),this.updateChildSize(),this.dynamic||this.proxy.hide(),this.draggable&&this.constrainTo&&(this.dd.resetConstraints(),this.dd.constrainTo(this.constrainTo)),e},constrain:function(e,t,i,s){return i>e-t?t=e-i:e-t>s&&(t=e-s),t},onMouseMove:function(e){if(this.enabled&&this.activeHandle)try{if(this.resizeRegion&&!this.resizeRegion.contains(e.getPoint()))return;var t,i,s=this.curSize||this.startBox,n=this.startBox.x,r=this.startBox.y,a=s.width,o=s.height,l=a,h=o,u=this.minWidth,c=this.minHeight,d=this.maxWidth,p=this.maxHeight,f=this.widthIncrement,m=this.heightIncrement,y=e.getXY(),g=-(this.startPoint[0]-Math.max(this.minX,y[0])),v=-(this.startPoint[1]-Math.max(this.minY,y[1])),x=this.activeHandle.position;switch(x){case"east":a+=g,a=Math.min(Math.max(u,a),d);break;case"south":o+=v,o=Math.min(Math.max(c,o),p);break;case"southeast":a+=g,o+=v,a=Math.min(Math.max(u,a),d),o=Math.min(Math.max(c,o),p);break;case"north":v=this.constrain(o,v,c,p),r+=v,o-=v;break;case"west":g=this.constrain(a,g,u,d),n+=g,a-=g;break;case"northeast":a+=g,a=Math.min(Math.max(u,a),d),v=this.constrain(o,v,c,p),r+=v,o-=v;break;case"northwest":g=this.constrain(a,g,u,d),v=this.constrain(o,v,c,p),r+=v,o-=v,n+=g,a-=g;break;case"southwest":g=this.constrain(a,g,u,d),o+=v,o=Math.min(Math.max(c,o),p),n+=g,a-=g}var E=this.snap(a,f,u),b=this.snap(o,m,c);if(E!=a||b!=o){switch(x){case"northeast":r-=b-o;break;case"north":r-=b-o;break;case"southwest":n-=E-a;break;case"west":n-=E-a;break;case"northwest":n-=E-a,r-=b-o}a=E,o=b}if(this.preserveRatio)switch(x){case"southeast":case"east":o=h*(a/l),o=Math.min(Math.max(c,o),p),a=l*(o/h);break;case"south":a=l*(o/h),a=Math.min(Math.max(u,a),d),o=h*(a/l);break;case"northeast":a=l*(o/h),a=Math.min(Math.max(u,a),d),o=h*(a/l);break;case"north":t=a,a=l*(o/h),a=Math.min(Math.max(u,a),d),o=h*(a/l),n+=(t-a)/2;break;case"southwest":o=h*(a/l),o=Math.min(Math.max(c,o),p),t=a,a=l*(o/h),n+=t-a;break;case"west":i=o,o=h*(a/l),o=Math.min(Math.max(c,o),p),r+=(i-o)/2,t=a,a=l*(o/h),n+=t-a;break;case"northwest":t=a,i=o,o=h*(a/l),o=Math.min(Math.max(c,o),p),a=l*(o/h),r+=i-o,n+=t-a}this.proxy.setBounds(n,r,a,o),this.dynamic&&this.resizeElement()}catch(L){}},handleOver:function(){this.enabled&&this.el.addClass("x-resizable-over")},handleOut:function(){this.resizing||this.el.removeClass("x-resizable-over")},getEl:function(){return this.el},getResizeChild:function(){return this.resizeChild},destroy:function(e){Ext.destroy(this.dd,this.overlay,this.proxy),this.overlay=null,this.proxy=null;var t=Ext.Resizable.positions;for(var i in t)"function"!=typeof t[i]&&this[t[i]]&&this[t[i]].destroy();e&&(this.el.update(""),Ext.destroy(this.el),this.el=null),this.purgeListeners()},syncHandleHeight:function(){var e=this.el.getHeight(!0);this.west&&this.west.el.setHeight(e),this.east&&this.east.el.setHeight(e)}}),Ext.Resizable.positions={n:"north",s:"south",e:"east",w:"west",se:"southeast",sw:"southwest",nw:"northwest",ne:"northeast"},Ext.Resizable.Handle=Ext.extend(Object,{constructor:function(e,t,i,s,n){if(!this.tpl){var r=Ext.DomHelper.createTemplate({tag:"div",cls:"x-resizable-handle x-resizable-handle-{0}"});r.compile(),Ext.Resizable.Handle.prototype.tpl=r}this.position=t,this.rz=e,this.el=this.tpl.append(e.el.dom,[this.position],!0),this.el.unselectable(),s&&this.el.setOpacity(0),Ext.isEmpty(n)||this.el.addClass(n),this.el.on("mousedown",this.onMouseDown,this),i||this.el.on({scope:this,mouseover:this.onMouseOver,mouseout:this.onMouseOut})},afterResize:function(){},onMouseDown:function(e){this.rz.onMouseDown(this,e)},onMouseOver:function(e){this.rz.handleOver(this,e)},onMouseOut:function(e){this.rz.handleOut(this,e)},destroy:function(){Ext.destroy(this.el),this.el=null}}),Ext.Window=Ext.extend(Ext.Panel,{baseCls:"x-window",resizable:!0,draggable:!0,closable:!0,closeAction:"close",constrain:!1,constrainHeader:!1,plain:!1,minimizable:!1,maximizable:!1,minHeight:100,minWidth:200,expandOnShow:!0,showAnimDuration:.25,hideAnimDuration:.25,collapsible:!1,initHidden:void 0,hidden:!0,elements:"header,body",frame:!0,floating:!0,initComponent:function(){this.initTools(),Ext.Window.superclass.initComponent.call(this),this.addEvents("resize","maximize","minimize","restore"),Ext.isDefined(this.initHidden)&&(this.hidden=this.initHidden),this.hidden===!1&&(this.hidden=!0,this.show())},getState:function(){return Ext.apply(Ext.Window.superclass.getState.call(this)||{},this.getBox(!0))},onRender:function(e,t){Ext.Window.superclass.onRender.call(this,e,t),this.plain&&this.el.addClass("x-window-plain"),this.focusEl=this.el.createChild({tag:"a",href:"#",cls:"x-dlg-focus",tabIndex:"-1",html:"&#160;"}),this.focusEl.swallowEvent("click",!0),this.proxy=this.el.createProxy("x-window-proxy"),this.proxy.enableDisplayMode("block"),this.modal&&(this.mask=this.container.createChild({cls:"ext-el-mask"},this.el.dom),this.mask.enableDisplayMode("block"),this.mask.hide(),this.mon(this.mask,"click",this.focus,this)),this.maximizable&&this.mon(this.header,"dblclick",this.toggleMaximize,this)},initEvents:function(){if(Ext.Window.superclass.initEvents.call(this),this.animateTarget&&this.setAnimateTarget(this.animateTarget),this.resizable&&(this.resizer=new Ext.Resizable(this.el,{minWidth:this.minWidth,minHeight:this.minHeight,handles:this.resizeHandles||"all",pinned:!0,resizeElement:this.resizerAction,handleCls:"x-window-handle"}),this.resizer.window=this,this.mon(this.resizer,"beforeresize",this.beforeResize,this)),this.draggable&&this.header.addClass("x-window-draggable"),this.mon(this.el,"mousedown",this.toFront,this),this.manager=this.manager||Ext.WindowMgr,this.manager.register(this),this.maximized&&(this.maximized=!1,this.maximize()),this.closable){var e=this.getKeyMap();e.on(27,this.onEsc,this),e.disable()}},initDraggable:function(){this.dd=new Ext.Window.DD(this)},onEsc:function(e,t){this.activeGhost&&this.unghost(),t.stopEvent(),this[this.closeAction]()},beforeDestroy:function(){this.rendered&&(this.hide(),this.clearAnchor(),Ext.destroy(this.focusEl,this.resizer,this.dd,this.proxy,this.mask)),Ext.Window.superclass.beforeDestroy.call(this)},onDestroy:function(){this.manager&&this.manager.unregister(this),Ext.Window.superclass.onDestroy.call(this)},initTools:function(){this.minimizable&&this.addTool({id:"minimize",handler:this.minimize.createDelegate(this,[])}),this.maximizable&&(this.addTool({id:"maximize",handler:this.maximize.createDelegate(this,[])}),this.addTool({id:"restore",handler:this.restore.createDelegate(this,[]),hidden:!0})),this.closable&&this.addTool({id:"close",handler:this[this.closeAction].createDelegate(this,[])})},resizerAction:function(){var e=this.proxy.getBox();return this.proxy.hide(),this.window.handleResize(e),e},beforeResize:function(){this.resizer.minHeight=Math.max(this.minHeight,this.getFrameHeight()+40),this.resizer.minWidth=Math.max(this.minWidth,this.getFrameWidth()+40),this.resizeBox=this.el.getBox()},updateHandles:function(){Ext.isIE&&this.resizer&&(this.resizer.syncHandleHeight(),this.el.repaint())},handleResize:function(e){var t=this.resizeBox;t.x!=e.x||t.y!=e.y?this.updateBox(e):(this.setSize(e),Ext.isIE6&&Ext.isStrict&&this.doLayout()),this.focus(),this.updateHandles(),this.saveState()},focus:function(){var e,t,i=this.focusEl,s=this.defaultButton;Ext.isDefined(s)&&(i=Ext.isNumber(s)&&this.fbar?this.fbar.items.get(s):Ext.isString(s)?Ext.getCmp(s):s,e=i.getEl(),t=Ext.getDom(this.container),e&&t&&t!=document.body&&!Ext.lib.Region.getRegion(t).contains(Ext.lib.Region.getRegion(e.dom)))||(i=i||this.focusEl,i.focus.defer(10,i))},setAnimateTarget:function(e){e=Ext.get(e),this.animateTarget=e},beforeShow:function(){if(delete this.el.lastXY,delete this.el.lastLT,void 0===this.x||void 0===this.y){var e=this.el.getAlignToXY(this.container,"c-c"),t=this.el.translatePoints(e[0],e[1]);this.x=void 0===this.x?t.left:this.x,this.y=void 0===this.y?t.top:this.y}this.el.setLeftTop(this.x,this.y),this.expandOnShow&&this.expand(!1),this.modal&&(Ext.getBody().addClass("x-body-masked"),this.mask.setSize(Ext.lib.Dom.getViewWidth(!0),Ext.lib.Dom.getViewHeight(!0)),this.mask.show())},show:function(e,t,i){return this.rendered||this.render(Ext.getBody()),this.hidden===!1?(this.toFront(),this):this.fireEvent("beforeshow",this)===!1?this:(t&&this.on("show",t,i,{single:!0}),this.hidden=!1,Ext.isDefined(e)&&this.setAnimateTarget(e),this.beforeShow(),this.animateTarget?this.animShow():this.afterShow(),this)},afterShow:function(e){if(this.isDestroyed)return!1;if(this.proxy.hide(),this.el.setStyle("display","block"),this.el.show(),this.maximized&&this.fitContainer(),Ext.isMac&&Ext.isGecko2&&this.cascade(this.setAutoScroll),(this.monitorResize||this.modal||this.constrain||this.constrainHeader)&&Ext.EventManager.onWindowResize(this.onWindowResize,this),this.doConstrain(),this.doLayout(),this.keyMap&&this.keyMap.enable(),this.toFront(),this.updateHandles(),e&&(Ext.isIE||Ext.isWebKit)){var t=this.getSize();this.onResize(t.width,t.height)}this.onShow(),this.fireEvent("show",this)},animShow:function(){this.proxy.show(),this.proxy.setBox(this.animateTarget.getBox()),this.proxy.setOpacity(0);var e=this.getBox();this.el.setStyle("display","none"),this.proxy.shift(Ext.apply(e,{callback:this.afterShow.createDelegate(this,[!0],!1),scope:this,easing:"easeNone",duration:this.showAnimDuration,opacity:.5}))},hide:function(e,t,i){return this.hidden||this.fireEvent("beforehide",this)===!1?this:(t&&this.on("hide",t,i,{single:!0}),this.hidden=!0,void 0!==e&&this.setAnimateTarget(e),this.modal&&(this.mask.hide(),Ext.getBody().removeClass("x-body-masked")),this.animateTarget?this.animHide():(this.el.hide(),this.afterHide()),this)},afterHide:function(){this.proxy.hide(),(this.monitorResize||this.modal||this.constrain||this.constrainHeader)&&Ext.EventManager.removeResizeListener(this.onWindowResize,this),this.keyMap&&this.keyMap.disable(),this.onHide(),this.fireEvent("hide",this)},animHide:function(){this.proxy.setOpacity(.5),this.proxy.show();var e=this.getBox(!1);this.proxy.setBox(e),this.el.hide(),this.proxy.shift(Ext.apply(this.animateTarget.getBox(),{callback:this.afterHide,scope:this,duration:this.hideAnimDuration,easing:"easeNone",opacity:0}))},onShow:Ext.emptyFn,onHide:Ext.emptyFn,onWindowResize:function(){this.maximized&&this.fitContainer(),this.modal&&(this.mask.setSize("100%","100%"),this.mask.dom.offsetHeight,this.mask.setSize(Ext.lib.Dom.getViewWidth(!0),Ext.lib.Dom.getViewHeight(!0))),this.doConstrain()},doConstrain:function(){if(this.constrain||this.constrainHeader){var e;if(this.constrain)e={right:this.el.shadowOffset,left:this.el.shadowOffset,bottom:this.el.shadowOffset};else{var t=this.getSize();e={right:-(t.width-100),bottom:-(t.height-25+this.el.getConstrainOffset())}}var i=this.el.getConstrainToXY(this.container,!0,e);i&&this.setPosition(i[0],i[1])}},ghost:function(e){var t=this.createGhost(e),i=this.getBox(!0);return t.setLeftTop(i.x,i.y),t.setWidth(i.width),this.el.hide(),this.activeGhost=t,t},unghost:function(e,t){this.activeGhost&&(e!==!1&&(this.el.show(),this.focus.defer(10,this),Ext.isMac&&Ext.isGecko2&&this.cascade(this.setAutoScroll)),t!==!1&&this.setPosition(this.activeGhost.getLeft(!0),this.activeGhost.getTop(!0)),this.activeGhost.hide(),this.activeGhost.remove(),delete this.activeGhost)},minimize:function(){return this.fireEvent("minimize",this),this},close:function(){this.fireEvent("beforeclose",this)!==!1&&(this.hidden?this.doClose():this.hide(null,this.doClose,this))},doClose:function(){this.fireEvent("close",this),this.destroy()},maximize:function(){return this.maximized||(this.expand(!1),this.restoreSize=this.getSize(),this.restorePos=this.getPosition(!0),this.maximizable&&(this.tools.maximize.hide(),this.tools.restore.show()),this.maximized=!0,this.el.disableShadow(),this.dd&&this.dd.lock(),this.collapsible&&this.tools.toggle.hide(),this.el.addClass("x-window-maximized"),this.container.addClass("x-window-maximized-ct"),this.setPosition(0,0),this.fitContainer(),this.fireEvent("maximize",this)),this},restore:function(){if(this.maximized){var e=this.tools;this.el.removeClass("x-window-maximized"),e.restore&&e.restore.hide(),e.maximize&&e.maximize.show(),this.setPosition(this.restorePos[0],this.restorePos[1]),this.setSize(this.restoreSize.width,this.restoreSize.height),delete this.restorePos,delete this.restoreSize,this.maximized=!1,this.el.enableShadow(!0),this.dd&&this.dd.unlock(),this.collapsible&&e.toggle&&e.toggle.show(),this.container.removeClass("x-window-maximized-ct"),this.doConstrain(),this.fireEvent("restore",this)}return this},toggleMaximize:function(){return this[this.maximized?"restore":"maximize"]()},fitContainer:function(){var e=this.container.getViewSize(!1);this.setSize(e.width,e.height)},setZIndex:function(e){this.modal&&this.mask.setStyle("z-index",e),this.el.setZIndex(++e),e+=5,this.resizer&&this.resizer.proxy.setStyle("z-index",++e),this.lastZIndex=e},alignTo:function(e,t,i){var s=this.el.getAlignToXY(e,t,i);return this.setPagePosition(s[0],s[1]),this},anchorTo:function(e,t,i,s){this.clearAnchor(),this.anchorTarget={el:e,alignment:t,offsets:i},Ext.EventManager.onWindowResize(this.doAnchor,this);var n=typeof s;return"undefined"!=n&&Ext.EventManager.on(window,"scroll",this.doAnchor,this,{buffer:"number"==n?s:50}),this.doAnchor()},doAnchor:function(){var e=this.anchorTarget;return this.alignTo(e.el,e.alignment,e.offsets),this},clearAnchor:function(){return this.anchorTarget&&(Ext.EventManager.removeResizeListener(this.doAnchor,this),Ext.EventManager.un(window,"scroll",this.doAnchor,this),delete this.anchorTarget),this},toFront:function(e){return this.manager.bringToFront(this)&&(e&&e.getTarget().focus||this.focus()),this},setActive:function(e){e?(this.maximized||this.el.enableShadow(!0),this.fireEvent("activate",this)):(this.el.disableShadow(),this.fireEvent("deactivate",this))},toBack:function(){return this.manager.sendToBack(this),this},center:function(){var e=this.el.getAlignToXY(this.container,"c-c");return this.setPagePosition(e[0],e[1]),this}}),Ext.reg("window",Ext.Window),Ext.Window.DD=Ext.extend(Ext.dd.DD,{constructor:function(e){this.win=e,Ext.Window.DD.superclass.constructor.call(this,e.el.id,"WindowDD-"+e.id),this.setHandleElId(e.header.id),this.scroll=!1},moveOnly:!0,headerOffsets:[100,25],startDrag:function(){var e=this.win;if(this.proxy=e.ghost(e.initialConfig.cls),e.constrain!==!1){var t=e.el.shadowOffset;this.constrainTo(e.container,{right:t,left:t,bottom:t})}else if(e.constrainHeader!==!1){var i=this.proxy.getSize();this.constrainTo(e.container,{right:-(i.width-this.headerOffsets[0]),bottom:-(i.height-this.headerOffsets[1])})}},b4Drag:Ext.emptyFn,onDrag:function(e){this.alignElWithMouse(this.proxy,e.getPageX(),e.getPageY())},endDrag:function(){this.win.unghost(),this.win.saveState()}}),Ext.WindowGroup=function(){var e={},t=[],i=null,s=function(e,t){return!e._lastAccess||e._lastAccess<t._lastAccess?-1:1},n=function(){var e=t,i=e.length;if(i>0){e.sort(s);for(var n=e[0].manager.zseed,r=0;i>r;r++){var o=e[r];o&&!o.hidden&&o.setZIndex(n+10*r)}}a()},r=function(e){e!=i&&(i&&i.setActive(!1),i=e,e&&e.setActive(!0))},a=function(){for(var e=t.length-1;e>=0;--e)if(!t[e].hidden)return r(t[e]),void 0;r(null)};return{zseed:9e3,register:function(i){i.manager&&i.manager.unregister(i),i.manager=this,e[i.id]=i,t.push(i),i.on("hide",a)},unregister:function(i){delete i.manager,delete e[i.id],i.un("hide",a),t.remove(i)},get:function(t){return"object"==typeof t?t:e[t]},bringToFront:function(e){return e=this.get(e),e!=i?(e._lastAccess=(new Date).getTime(),n(),!0):!1},sendToBack:function(e){return e=this.get(e),e._lastAccess=-(new Date).getTime(),n(),e},hideAll:function(){for(var t in e)e[t]&&"function"!=typeof e[t]&&e[t].isVisible()&&e[t].hide()},getActive:function(){return i},getBy:function(e,i){for(var s=[],n=t.length-1;n>=0;--n){var r=t[n];e.call(i||r,r)!==!1&&s.push(r)}return s},each:function(t,i){for(var s in e)if(e[s]&&"function"!=typeof e[s]&&t.call(i||e[s],e[s])===!1)return}}},Ext.WindowMgr=new Ext.WindowGroup,Ext.MessageBox=function(){var e,t,i,s,n,r,a,o,l,h,u,c,d="",p="",f=["ok","yes","no","cancel"],m=function(i){h[i].blur(),e.isVisible()&&(e.hide(),y(),Ext.callback(t.fn,t.scope||window,[i,u.dom.value,t],1))},y=function(){t&&t.cls&&e.el.removeClass(t.cls),o.reset()},g=function(t){var i,s=0;return t?(e.footer.dom.style.display="",Ext.iterate(h,function(e,n){i=t[e],i?(n.show(),n.setText(Ext.isString(i)?i:Ext.MessageBox.buttonText[e]),s+=n.getEl().getWidth()+15):n.hide()}),s):(Ext.each(f,function(e){h[e].hide()}),s)};return{getDialog:function(u){if(!e){var c=[];h={},Ext.each(f,function(e){c.push(h[e]=new Ext.Button({text:this.buttonText[e],handler:m.createCallback(e),hideMode:"offsets"}))},this),e=new Ext.Window({autoCreate:!0,title:u,resizable:!1,constrain:!0,constrainHeader:!0,minimizable:!1,maximizable:!1,stateful:!1,modal:!0,shim:!0,buttonAlign:"center",width:400,height:100,minHeight:80,plain:!0,footer:!0,closable:!0,close:function(){t&&t.buttons&&t.buttons.no&&!t.buttons.cancel?m("no"):m("cancel")
},fbar:new Ext.Toolbar({items:c,enableOverflow:!1})}),e.render(document.body),e.getEl().addClass("x-window-dlg"),i=e.mask,s=e.body.createChild({html:'<div class="ext-mb-icon"></div><div class="ext-mb-content"><span class="ext-mb-text"></span><br /><div class="ext-mb-fix-cursor"><input type="text" class="ext-mb-input" /><textarea class="ext-mb-textarea"></textarea></div></div>'}),l=Ext.get(s.dom.firstChild);var d=s.dom.childNodes[1];n=Ext.get(d.firstChild),r=Ext.get(d.childNodes[2].firstChild),r.enableDisplayMode(),r.addKeyListener([10,13],function(){e.isVisible()&&t&&t.buttons&&(t.buttons.ok?m("ok"):t.buttons.yes&&m("yes"))}),a=Ext.get(d.childNodes[2].childNodes[1]),a.enableDisplayMode(),o=new Ext.ProgressBar({renderTo:s}),s.createChild({cls:"x-clear"})}return e},updateText:function(i){e.isVisible()||t.width||e.setSize(this.maxWidth,100),n.update(i?i+" ":"&#160;");var s,r=""!=p?l.getWidth()+l.getMargins("lr"):0,a=n.getWidth()+n.getMargins("lr"),h=e.getFrameWidth("lr"),d=e.body.getFrameWidth("lr");return s=Math.max(Math.min(t.width||r+a+h+d,t.maxWidth||this.maxWidth),Math.max(t.minWidth||this.minWidth,c||0)),t.prompt===!0&&u.setWidth(s-r-h-d),(t.progress===!0||t.wait===!0)&&o.setSize(s-r-h-d),Ext.isIE&&s==c&&(s+=4),n.update(i||"&#160;"),e.setSize(s,"auto").center(),this},updateProgress:function(e,t,i){return o.updateProgress(e,t),i&&this.updateText(i),this},isVisible:function(){return e&&e.isVisible()},hide:function(){var t=e?e.activeGhost:null;return(this.isVisible()||t)&&(e.hide(),y(),t&&e.unghost(!1,!1)),this},show:function(s){this.isVisible()&&this.hide(),t=s;var n=this.getDialog(t.title||"&#160;");n.setTitle(t.title||"&#160;");var l=t.closable!==!1&&t.progress!==!0&&t.wait!==!0;if(n.tools.close.setDisplayed(l),u=r,t.prompt=t.prompt||(t.multiline?!0:!1),t.prompt?t.multiline?(r.hide(),a.show(),a.setHeight(Ext.isNumber(t.multiline)?t.multiline:this.defaultTextHeight),u=a):(r.show(),a.hide()):(r.hide(),a.hide()),u.dom.value=t.value||"",t.prompt)n.focusEl=u;else{var p=t.buttons,f=null;p&&p.ok?f=h.ok:p&&p.yes&&(f=h.yes),f&&(n.focusEl=f)}return Ext.isDefined(t.iconCls)&&n.setIconClass(t.iconCls),this.setIcon(Ext.isDefined(t.icon)?t.icon:d),c=g(t.buttons),o.setVisible(t.progress===!0||t.wait===!0),this.updateProgress(0,t.progressText),this.updateText(t.msg),t.cls&&n.el.addClass(t.cls),n.proxyDrag=t.proxyDrag===!0,n.modal=t.modal!==!1,n.mask=t.modal!==!1?i:!1,n.isVisible()||(document.body.appendChild(e.el.dom),n.setAnimateTarget(t.animEl),n.on("show",function(){l===!0?n.keyMap.enable():n.keyMap.disable()},this,{single:!0}),n.show(t.animEl)),t.wait===!0&&o.wait(t.waitConfig),this},setIcon:function(t){return e?(d=void 0,t&&""!=t?(l.removeClass("x-hidden"),l.replaceClass(p,t),s.addClass("x-dlg-icon"),p=t):(l.replaceClass(p,"x-hidden"),s.removeClass("x-dlg-icon"),p=""),this):(d=t,void 0)},progress:function(e,t,i){return this.show({title:e,msg:t,buttons:!1,progress:!0,closable:!1,minWidth:this.minProgressWidth,progressText:i}),this},wait:function(e,t,i){return this.show({title:t,msg:e,buttons:!1,closable:!1,wait:!0,modal:!0,minWidth:this.minProgressWidth,waitConfig:i}),this},alert:function(e,t,i,s){return this.show({title:e,msg:t,buttons:this.OK,fn:i,scope:s,minWidth:this.minWidth}),this},confirm:function(e,t,i,s){return this.show({title:e,msg:t,buttons:this.YESNO,fn:i,scope:s,icon:this.QUESTION,minWidth:this.minWidth}),this},prompt:function(e,t,i,s,n,r){return this.show({title:e,msg:t,buttons:this.OKCANCEL,fn:i,minWidth:this.minPromptWidth,scope:s,prompt:!0,multiline:n,value:r}),this},OK:{ok:!0},CANCEL:{cancel:!0},OKCANCEL:{ok:!0,cancel:!0},YESNO:{yes:!0,no:!0},YESNOCANCEL:{yes:!0,no:!0,cancel:!0},INFO:"ext-mb-info",WARNING:"ext-mb-warning",QUESTION:"ext-mb-question",ERROR:"ext-mb-error",defaultTextHeight:75,maxWidth:600,minWidth:100,minProgressWidth:250,minPromptWidth:250,buttonText:{ok:"OK",cancel:"Cancel",yes:"Yes",no:"No"}}}(),Ext.Msg=Ext.MessageBox,Ext.dd.PanelProxy=Ext.extend(Object,{constructor:function(e,t){this.panel=e,this.id=this.panel.id+"-ddproxy",Ext.apply(this,t)},insertProxy:!0,setStatus:Ext.emptyFn,reset:Ext.emptyFn,update:Ext.emptyFn,stop:Ext.emptyFn,sync:Ext.emptyFn,getEl:function(){return this.ghost},getGhost:function(){return this.ghost},getProxy:function(){return this.proxy},hide:function(){this.ghost&&(this.proxy&&(this.proxy.remove(),delete this.proxy),this.panel.el.dom.style.display="",this.ghost.remove(),delete this.ghost)},show:function(){this.ghost||(this.ghost=this.panel.createGhost(this.panel.initialConfig.cls,void 0,Ext.getBody()),this.ghost.setXY(this.panel.el.getXY()),this.insertProxy&&(this.proxy=this.panel.el.insertSibling({cls:"x-panel-dd-spacer"}),this.proxy.setSize(this.panel.getSize())),this.panel.el.dom.style.display="none")},repair:function(e,t,i){this.hide(),"function"==typeof t&&t.call(i||this)},moveProxy:function(e,t){this.proxy&&e.insertBefore(this.proxy.dom,t)}}),Ext.Panel.DD=Ext.extend(Ext.dd.DragSource,{constructor:function(e,t){this.panel=e,this.dragData={panel:e},this.proxy=new Ext.dd.PanelProxy(e,t),Ext.Panel.DD.superclass.constructor.call(this,e.el,t);var i=e.header,s=e.body;i&&(this.setHandleElId(i.id),s=e.header),s.setStyle("cursor","move"),this.scroll=!1},showFrame:Ext.emptyFn,startDrag:Ext.emptyFn,b4StartDrag:function(){this.proxy.show()},b4MouseDown:function(e){var t=e.getPageX(),i=e.getPageY();this.autoOffset(t,i)},onInitDrag:function(e,t){return this.onStartDrag(e,t),!0},createFrame:Ext.emptyFn,getDragEl:function(){return this.proxy.ghost.dom},endDrag:function(){this.proxy.hide(),this.panel.saveState()},autoOffset:function(e,t){e-=this.startPageX,t-=this.startPageY,this.setDelta(e,t)}}),Ext.state.Provider=Ext.extend(Ext.util.Observable,{constructor:function(){this.addEvents("statechange"),this.state={},Ext.state.Provider.superclass.constructor.call(this)},get:function(e,t){return"undefined"==typeof this.state[e]?t:this.state[e]},clear:function(e){delete this.state[e],this.fireEvent("statechange",this,e,null)},set:function(e,t){this.state[e]=t,this.fireEvent("statechange",this,e,t)},decodeValue:function(e){var t,i,s,n,r=/^(a|n|d|b|s|o|e)\:(.*)$/,a=r.exec(unescape(e));if(a&&a[1])switch(i=a[1],s=a[2],i){case"e":return null;case"n":return parseFloat(s);case"d":return new Date(Date.parse(s));case"b":return"1"==s;case"a":return t=[],""!=s&&Ext.each(s.split("^"),function(e){t.push(this.decodeValue(e))},this),t;case"o":return t={},""!=s&&Ext.each(s.split("^"),function(e){n=e.split("="),t[n[0]]=this.decodeValue(n[1])},this),t;default:return s}},encodeValue:function(e){var t,i,s,n="",r=0;if(null==e)return"e:1";if("number"==typeof e)t="n:"+e;else if("boolean"==typeof e)t="b:"+(e?"1":"0");else if(Ext.isDate(e))t="d:"+e.toGMTString();else if(Ext.isArray(e)){for(i=e.length;i>r;r++)n+=this.encodeValue(e[r]),r!=i-1&&(n+="^");t="a:"+n}else if("object"==typeof e){for(s in e)"function"!=typeof e[s]&&void 0!==e[s]&&(n+=s+"="+this.encodeValue(e[s])+"^");t="o:"+n.substring(0,n.length-1)}else t="s:"+e;return escape(t)}}),Ext.state.Manager=function(){var e=new Ext.state.Provider;return{setProvider:function(t){e=t},get:function(t,i){return e.get(t,i)},set:function(t,i){e.set(t,i)},clear:function(t){e.clear(t)},getProvider:function(){return e}}}(),Ext.state.CookieProvider=Ext.extend(Ext.state.Provider,{constructor:function(e){Ext.state.CookieProvider.superclass.constructor.call(this),this.path="/",this.expires=new Date((new Date).getTime()+6048e5),this.domain=null,this.secure=!1,Ext.apply(this,e),this.state=this.readCookies()},set:function(e,t){return"undefined"==typeof t||null===t?(this.clear(e),void 0):(this.setCookie(e,t),Ext.state.CookieProvider.superclass.set.call(this,e,t),void 0)},clear:function(e){this.clearCookie(e),Ext.state.CookieProvider.superclass.clear.call(this,e)},readCookies:function(){for(var e,t,i,s={},n=document.cookie+";",r=/\s?(.*?)=(.*?);/g;null!=(e=r.exec(n));)t=e[1],i=e[2],t&&"ys-"==t.substring(0,3)&&(s[t.substr(3)]=this.decodeValue(i));return s},setCookie:function(e,t){document.cookie="ys-"+e+"="+this.encodeValue(t)+(null==this.expires?"":"; expires="+this.expires.toGMTString())+(null==this.path?"":"; path="+this.path)+(null==this.domain?"":"; domain="+this.domain)+(1==this.secure?"; secure":"")},clearCookie:function(e){document.cookie="ys-"+e+"=null; expires=Thu, 01-Jan-70 00:00:01 GMT"+(null==this.path?"":"; path="+this.path)+(null==this.domain?"":"; domain="+this.domain)+(1==this.secure?"; secure":"")}}),Ext.DataView=Ext.extend(Ext.BoxComponent,{selectedClass:"x-view-selected",emptyText:"",deferEmptyText:!0,trackOver:!1,blockRefresh:!1,last:!1,initComponent:function(){Ext.DataView.superclass.initComponent.call(this),(Ext.isString(this.tpl)||Ext.isArray(this.tpl))&&(this.tpl=new Ext.XTemplate(this.tpl)),this.addEvents("beforeclick","click","mouseenter","mouseleave","containerclick","dblclick","contextmenu","containercontextmenu","selectionchange","beforeselect"),this.store=Ext.StoreMgr.lookup(this.store),this.all=new Ext.CompositeElementLite,this.selected=new Ext.CompositeElementLite},afterRender:function(){Ext.DataView.superclass.afterRender.call(this),this.mon(this.getTemplateTarget(),{click:this.onClick,dblclick:this.onDblClick,contextmenu:this.onContextMenu,scope:this}),(this.overClass||this.trackOver)&&this.mon(this.getTemplateTarget(),{mouseover:this.onMouseOver,mouseout:this.onMouseOut,scope:this}),this.store&&this.bindStore(this.store,!0)},refresh:function(){this.clearSelections(!1,!0);var e=this.getTemplateTarget(),t=this.store.getRange();e.update(""),t.length<1?((!this.deferEmptyText||this.hasSkippedEmptyText)&&e.update(this.emptyText),this.all.clear()):(this.tpl.overwrite(e,this.collectData(t,0)),this.all.fill(Ext.query(this.itemSelector,e.dom)),this.updateIndexes(0)),this.hasSkippedEmptyText=!0},getTemplateTarget:function(){return this.el},prepareData:function(e){return e},collectData:function(e,t){for(var i=[],s=0,n=e.length;n>s;s++)i[i.length]=this.prepareData(e[s].data,t+s,e[s]);return i},bufferRender:function(e,t){var i=document.createElement("div");return this.tpl.overwrite(i,this.collectData(e,t)),Ext.query(this.itemSelector,i)},onUpdate:function(e,t){var i=this.store.indexOf(t);if(i>-1){var s=this.isSelected(i),n=this.all.elements[i],r=this.bufferRender([t],i)[0];this.all.replaceElement(i,r,!0),s&&(this.selected.replaceElement(n,r),this.all.item(i).addClass(this.selectedClass)),this.updateIndexes(i,i)}},onAdd:function(e,t,i){if(0===this.all.getCount())return this.refresh(),void 0;var s,n=this.bufferRender(t,i),r=this.all.elements;i<this.all.getCount()?(s=this.all.item(i).insertSibling(n,"before",!0),r.splice.apply(r,[i,0].concat(n))):(s=this.all.last().insertSibling(n,"after",!0),r.push.apply(r,n)),this.updateIndexes(i)},onRemove:function(e,t,i){this.deselect(i),this.all.removeElement(i,!0),this.updateIndexes(i),0===this.store.getCount()&&this.refresh()},refreshNode:function(e){this.onUpdate(this.store,this.store.getAt(e))},updateIndexes:function(e,t){var i=this.all.elements;e=e||0,t=t||(0===t?0:i.length-1);for(var s=e;t>=s;s++)i[s].viewIndex=s},getStore:function(){return this.store},bindStore:function(e,t){!t&&this.store&&(e!==this.store&&this.store.autoDestroy?this.store.destroy():(this.store.un("beforeload",this.onBeforeLoad,this),this.store.un("datachanged",this.onDataChanged,this),this.store.un("add",this.onAdd,this),this.store.un("remove",this.onRemove,this),this.store.un("update",this.onUpdate,this),this.store.un("clear",this.refresh,this)),e||(this.store=null)),e&&(e=Ext.StoreMgr.lookup(e),e.on({scope:this,beforeload:this.onBeforeLoad,datachanged:this.onDataChanged,add:this.onAdd,remove:this.onRemove,update:this.onUpdate,clear:this.refresh})),this.store=e,e&&this.refresh()},onDataChanged:function(){this.blockRefresh!==!0&&this.refresh.apply(this,arguments)},findItemFromChild:function(e){return Ext.fly(e).findParent(this.itemSelector,this.getTemplateTarget())},onClick:function(e){var t,i=e.getTarget(this.itemSelector,this.getTemplateTarget());i?(t=this.indexOf(i),this.onItemClick(i,t,e)!==!1&&this.fireEvent("click",this,t,i,e)):this.fireEvent("containerclick",this,e)!==!1&&this.onContainerClick(e)},onContainerClick:function(){this.clearSelections()},onContextMenu:function(e){var t=e.getTarget(this.itemSelector,this.getTemplateTarget());t?this.fireEvent("contextmenu",this,this.indexOf(t),t,e):this.fireEvent("containercontextmenu",this,e)},onDblClick:function(e){var t=e.getTarget(this.itemSelector,this.getTemplateTarget());t&&this.fireEvent("dblclick",this,this.indexOf(t),t,e)},onMouseOver:function(e){var t=e.getTarget(this.itemSelector,this.getTemplateTarget());t&&t!==this.lastItem&&(this.lastItem=t,Ext.fly(t).addClass(this.overClass),this.fireEvent("mouseenter",this,this.indexOf(t),t,e))},onMouseOut:function(e){this.lastItem&&(e.within(this.lastItem,!0,!0)||(Ext.fly(this.lastItem).removeClass(this.overClass),this.fireEvent("mouseleave",this,this.indexOf(this.lastItem),this.lastItem,e),delete this.lastItem))},onItemClick:function(e,t,i){return this.fireEvent("beforeclick",this,t,e,i)===!1?!1:(this.multiSelect?(this.doMultiSelection(e,t,i),i.preventDefault()):this.singleSelect&&(this.doSingleSelection(e,t,i),i.preventDefault()),!0)},doSingleSelection:function(e,t,i){i.ctrlKey&&this.isSelected(t)?this.deselect(t):this.select(t,!1)},doMultiSelection:function(e,t,i){if(i.shiftKey&&this.last!==!1){var s=this.last;this.selectRange(s,t,i.ctrlKey),this.last=s}else(i.ctrlKey||this.simpleSelect)&&this.isSelected(t)?this.deselect(t):this.select(t,i.ctrlKey||i.shiftKey||this.simpleSelect)},getSelectionCount:function(){return this.selected.getCount()},getSelectedNodes:function(){return this.selected.elements},getSelectedIndexes:function(){for(var e=[],t=this.selected.elements,i=0,s=t.length;s>i;i++)e.push(t[i].viewIndex);return e},getSelectedRecords:function(){return this.getRecords(this.selected.elements)},getRecords:function(e){for(var t=[],i=0,s=e.length;s>i;i++)t[t.length]=this.store.getAt(e[i].viewIndex);return t},getRecord:function(e){return this.store.getAt(e.viewIndex)},clearSelections:function(e,t){(this.multiSelect||this.singleSelect)&&this.selected.getCount()>0&&(t||this.selected.removeClass(this.selectedClass),this.selected.clear(),this.last=!1,e||this.fireEvent("selectionchange",this,this.selected.elements))},isSelected:function(e){return this.selected.contains(this.getNode(e))},deselect:function(e){this.isSelected(e)&&(e=this.getNode(e),this.selected.removeElement(e),this.last==e.viewIndex&&(this.last=!1),Ext.fly(e).removeClass(this.selectedClass),this.fireEvent("selectionchange",this,this.selected.elements))},select:function(e,t,i){if(Ext.isArray(e)){t||this.clearSelections(!0);for(var s=0,n=e.length;n>s;s++)this.select(e[s],!0,!0);i||this.fireEvent("selectionchange",this,this.selected.elements)}else{var r=this.getNode(e);t||this.clearSelections(!0),r&&!this.isSelected(r)&&this.fireEvent("beforeselect",this,r,this.selected.elements)!==!1&&(Ext.fly(r).addClass(this.selectedClass),this.selected.add(r),this.last=r.viewIndex,i||this.fireEvent("selectionchange",this,this.selected.elements))}},selectRange:function(e,t,i){i||this.clearSelections(!0),this.select(this.getNodes(e,t),!0)},getNode:function(e){if(Ext.isString(e))return document.getElementById(e);if(Ext.isNumber(e))return this.all.elements[e];if(e instanceof Ext.data.Record){var t=this.store.indexOf(e);return this.all.elements[t]}return e},getNodes:function(e,t){var i,s=this.all.elements,n=[];if(e=e||0,t=Ext.isDefined(t)?t:Math.max(s.length-1,0),t>=e)for(i=e;t>=i&&s[i];i++)n.push(s[i]);else for(i=e;i>=t&&s[i];i--)n.push(s[i]);return n},indexOf:function(e){return e=this.getNode(e),Ext.isNumber(e.viewIndex)?e.viewIndex:this.all.indexOf(e)},onBeforeLoad:function(){this.loadingText&&(this.clearSelections(!1,!0),this.getTemplateTarget().update('<div class="loading-indicator">'+this.loadingText+"</div>"),this.all.clear())},onDestroy:function(){this.all.clear(),this.selected.clear(),Ext.DataView.superclass.onDestroy.call(this),this.bindStore(null)}}),Ext.DataView.prototype.setStore=Ext.DataView.prototype.bindStore,Ext.reg("dataview",Ext.DataView),Ext.list.ListView=Ext.extend(Ext.DataView,{itemSelector:"dl",selectedClass:"x-list-selected",overClass:"x-list-over",scrollOffset:void 0,columnResize:!0,columnSort:!0,maxColumnWidth:Ext.isIE?99:100,initComponent:function(){this.columnResize&&(this.colResizer=new Ext.list.ColumnResizer(this.colResizer),this.colResizer.init(this)),this.columnSort&&(this.colSorter=new Ext.list.Sorter(this.columnSort),this.colSorter.init(this)),this.internalTpl||(this.internalTpl=new Ext.XTemplate('<div class="x-list-header"><div class="x-list-header-inner">','<tpl for="columns">','<div style="width:{[values.width*100]}%;text-align:{align};"><em unselectable="on" id="',this.id,'-xlhd-{#}">',"{header}","</em></div>","</tpl>",'<div class="x-clear"></div>',"</div></div>",'<div class="x-list-body"><div class="x-list-body-inner">',"</div></div>")),this.tpl||(this.tpl=new Ext.XTemplate('<tpl for="rows">',"<dl>",'<tpl for="parent.columns">','<dt style="width:{[values.width*100]}%;text-align:{align};">','<em unselectable="on"<tpl if="cls"> class="{cls}</tpl>">',"{[values.tpl.apply(parent)]}","</em></dt>","</tpl>",'<div class="x-clear"></div>',"</dl>","</tpl>"));for(var e=this.columns,t=0,i=0,s=e.length,n=[],r=0;s>r;r++){var a=e[r];a.isColumn||(a.xtype=a.xtype?/^lv/.test(a.xtype)?a.xtype:"lv"+a.xtype:"lvcolumn",a=Ext.create(a)),a.width&&(t+=100*a.width,t>this.maxColumnWidth&&(a.width-=(t-this.maxColumnWidth)/100),i++),n.push(a)}if(e=this.columns=n,s>i){var o=s-i;if(t<this.maxColumnWidth)for(var l=(this.maxColumnWidth-t)/o/100,h=0;s>h;h++){var a=e[h];a.width||(a.width=l)}}Ext.list.ListView.superclass.initComponent.call(this)},onRender:function(){this.autoEl={cls:"x-list-wrap"},Ext.list.ListView.superclass.onRender.apply(this,arguments),this.internalTpl.overwrite(this.el,{columns:this.columns}),this.innerBody=Ext.get(this.el.dom.childNodes[1].firstChild),this.innerHd=Ext.get(this.el.dom.firstChild.firstChild),this.hideHeaders&&(this.el.dom.firstChild.style.display="none")},getTemplateTarget:function(){return this.innerBody},collectData:function(){var e=Ext.list.ListView.superclass.collectData.apply(this,arguments);return{columns:this.columns,rows:e}},verifyInternalSize:function(){this.lastSize&&this.onResize(this.lastSize.width,this.lastSize.height)},onResize:function(e,t){var i,s=this.innerBody.dom,n=this.innerHd.dom,r=e-Ext.num(this.scrollOffset,Ext.getScrollBarWidth())+"px";s&&(i=s.parentNode,Ext.isNumber(e)&&(this.reserveScrollOffset||i.offsetWidth-i.clientWidth>10?(s.style.width=r,n.style.width=r):(s.style.width=e+"px",n.style.width=e+"px",setTimeout(function(){i.offsetWidth-i.clientWidth>10&&(s.style.width=r,n.style.width=r)},10))),Ext.isNumber(t)&&(i.style.height=Math.max(0,t-n.parentNode.offsetHeight)+"px"))},updateIndexes:function(){Ext.list.ListView.superclass.updateIndexes.apply(this,arguments),this.verifyInternalSize()},findHeaderIndex:function(e){e=e.dom||e;for(var t,i=e.parentNode,s=i.parentNode.childNodes,n=0;t=s[n];n++)if(t==i)return n;return-1},setHdWidths:function(){for(var e=this.innerHd.dom.getElementsByTagName("div"),t=0,i=this.columns,s=i.length;s>t;t++)e[t].style.width=100*i[t].width+"%"}}),Ext.reg("listview",Ext.list.ListView),Ext.ListView=Ext.list.ListView,Ext.list.Column=Ext.extend(Object,{isColumn:!0,align:"left",header:"",width:null,cls:"",constructor:function(e){e.tpl?Ext.isString(e.tpl)&&(e.tpl=new Ext.XTemplate(e.tpl)):e.tpl=new Ext.XTemplate("{"+e.dataIndex+"}"),Ext.apply(this,e)}}),Ext.reg("lvcolumn",Ext.list.Column),Ext.list.NumberColumn=Ext.extend(Ext.list.Column,{format:"0,000.00",constructor:function(e){e.tpl=e.tpl||new Ext.XTemplate("{"+e.dataIndex+':number("'+(e.format||this.format)+'")}'),Ext.list.NumberColumn.superclass.constructor.call(this,e)}}),Ext.reg("lvnumbercolumn",Ext.list.NumberColumn),Ext.list.DateColumn=Ext.extend(Ext.list.Column,{format:"m/d/Y",constructor:function(e){e.tpl=e.tpl||new Ext.XTemplate("{"+e.dataIndex+':date("'+(e.format||this.format)+'")}'),Ext.list.DateColumn.superclass.constructor.call(this,e)}}),Ext.reg("lvdatecolumn",Ext.list.DateColumn),Ext.list.BooleanColumn=Ext.extend(Ext.list.Column,{trueText:"true",falseText:"false",undefinedText:"&#160;",constructor:function(e){e.tpl=e.tpl||new Ext.XTemplate("{"+e.dataIndex+":this.format}");var t=this.trueText,i=this.falseText,s=this.undefinedText;e.tpl.format=function(e){return void 0===e?s:e&&"false"!==e?t:i},Ext.list.DateColumn.superclass.constructor.call(this,e)}}),Ext.reg("lvbooleancolumn",Ext.list.BooleanColumn),Ext.list.ColumnResizer=Ext.extend(Ext.util.Observable,{minPct:.05,constructor:function(e){Ext.apply(this,e),Ext.list.ColumnResizer.superclass.constructor.call(this)},init:function(e){this.view=e,e.on("render",this.initEvents,this)},initEvents:function(e){e.mon(e.innerHd,"mousemove",this.handleHdMove,this),this.tracker=new Ext.dd.DragTracker({onBeforeStart:this.onBeforeStart.createDelegate(this),onStart:this.onStart.createDelegate(this),onDrag:this.onDrag.createDelegate(this),onEnd:this.onEnd.createDelegate(this),tolerance:3,autoStart:300}),this.tracker.initEl(e.innerHd),e.on("beforedestroy",this.tracker.destroy,this.tracker)},handleHdMove:function(e){var t=5,i=e.getPageX(),s=e.getTarget("em",3,!0);if(s){var n=s.getRegion(),r=s.dom.style,a=s.dom.parentNode;i-n.left<=t&&a!=a.parentNode.firstChild?(this.activeHd=Ext.get(a.previousSibling.firstChild),r.cursor=Ext.isWebKit?"e-resize":"col-resize"):n.right-i<=t&&a!=a.parentNode.lastChild.previousSibling?(this.activeHd=s,r.cursor=Ext.isWebKit?"w-resize":"col-resize"):(delete this.activeHd,r.cursor="")}},onBeforeStart:function(){return this.dragHd=this.activeHd,!!this.dragHd},onStart:function(){var e=this,t=e.view,i=e.dragHd,s=e.tracker.getXY()[0];e.proxy=t.el.createChild({cls:"x-list-resizer"}),e.dragX=i.getX(),e.headerIndex=t.findHeaderIndex(i),e.headersDisabled=t.disableHeaders,t.disableHeaders=!0,e.proxy.setHeight(t.el.getHeight()),e.proxy.setX(e.dragX),e.proxy.setWidth(s-e.dragX),this.setBoundaries()},setBoundaries:function(e){var t,i=this.view,s=this.headerIndex,n=i.innerHd.getWidth(),e=i.innerHd.getX(),r=Math.ceil(n*this.minPct),a=n-r,o=i.columns.length,l=i.innerHd.select("em",!0),h=r+e,u=a+e;2==o?(this.minX=h,this.maxX=u):(t=l.item(s+2),this.minX=l.item(s).getX()+r,this.maxX=t?t.getX()-r:u,0==s?this.minX=h:s==o-2&&(this.maxX=u))},onDrag:function(){var e=this,t=e.tracker.getXY()[0].constrain(e.minX,e.maxX);e.proxy.setWidth(t-this.dragX)},onEnd:function(){var e=this.proxy.getWidth(),t=this.headerIndex,i=this.view,s=i.columns,n=i.innerHd.getWidth(),r=Math.ceil(e*i.maxColumnWidth/n)/100,a=this.headersDisabled,o=s[t],l=s[t+1],h=o.width+l.width;this.proxy.remove(),o.width=r,l.width=h-r,delete this.dragHd,i.setHdWidths(),i.refresh(),setTimeout(function(){i.disableHeaders=a},100)}}),Ext.ListView.ColumnResizer=Ext.list.ColumnResizer,Ext.list.Sorter=Ext.extend(Ext.util.Observable,{sortClasses:["sort-asc","sort-desc"],constructor:function(e){Ext.apply(this,e),Ext.list.Sorter.superclass.constructor.call(this)},init:function(e){this.view=e,e.on("render",this.initEvents,this)},initEvents:function(e){e.mon(e.innerHd,"click",this.onHdClick,this),e.innerHd.setStyle("cursor","pointer"),e.mon(e.store,"datachanged",this.updateSortState,this),this.updateSortState.defer(10,this,[e.store])},updateSortState:function(e){var t=e.getSortState();if(t){this.sortState=t;for(var i=this.view.columns,s=-1,n=0,r=i.length;r>n;n++)if(i[n].dataIndex==t.field){s=n;break}if(-1!=s){var a=t.direction;this.updateSortIcon(s,a)}}},updateSortIcon:function(e,t){var i=this.sortClasses,s=this.view.innerHd.select("em").removeClass(i);s.item(e).addClass(i["DESC"==t?1:0])},onHdClick:function(e){var t=e.getTarget("em",3);if(t&&!this.view.disableHeaders){var i=this.view.findHeaderIndex(t);this.view.store.sort(this.view.columns[i].dataIndex)}}}),Ext.ListView.Sorter=Ext.list.Sorter,Ext.TabPanel=Ext.extend(Ext.Panel,{deferredRender:!0,tabWidth:120,minTabWidth:30,resizeTabs:!1,enableTabScroll:!1,scrollIncrement:0,scrollRepeatInterval:400,scrollDuration:.35,animScroll:!0,tabPosition:"top",baseCls:"x-tab-panel",autoTabs:!1,autoTabSelector:"div.x-tab",activeTab:void 0,tabMargin:2,plain:!1,wheelIncrement:20,idDelimiter:"__",itemCls:"x-tab-item",elements:"body",headerAsText:!1,frame:!1,hideBorders:!0,initComponent:function(){this.frame=!1,Ext.TabPanel.superclass.initComponent.call(this),this.addEvents("beforetabchange","tabchange","contextmenu"),this.setLayout(new Ext.layout.CardLayout(Ext.apply({layoutOnCardChange:this.layoutOnTabChange,deferredRender:this.deferredRender},this.layoutConfig))),"top"==this.tabPosition?(this.elements+=",header",this.stripTarget="header"):(this.elements+=",footer",this.stripTarget="footer"),this.stack||(this.stack=Ext.TabPanel.AccessStack()),this.initItems()},onRender:function(e,t){if(Ext.TabPanel.superclass.onRender.call(this,e,t),this.plain){var i="top"==this.tabPosition?"header":"footer";this[i].addClass("x-tab-panel-"+i+"-plain")}var s=this[this.stripTarget];this.stripWrap=s.createChild({cls:"x-tab-strip-wrap",cn:{tag:"ul",cls:"x-tab-strip x-tab-strip-"+this.tabPosition}});var n="bottom"==this.tabPosition?this.stripWrap:null;if(s.createChild({cls:"x-tab-strip-spacer"},n),this.strip=new Ext.Element(this.stripWrap.dom.firstChild),this.edge=this.strip.createChild({tag:"li",cls:"x-tab-edge",cn:[{tag:"span",cls:"x-tab-strip-text",cn:"&#160;"}]}),this.strip.createChild({cls:"x-clear"}),this.body.addClass("x-tab-panel-body-"+this.tabPosition),!this.itemTpl){var r=new Ext.Template('<li class="{cls}" id="{id}"><a class="x-tab-strip-close"></a>','<a class="x-tab-right" href="#"><em class="x-tab-left">','<span class="x-tab-strip-inner"><span class="x-tab-strip-text {iconCls}">{text}</span></span>',"</em></a></li>");r.disableFormats=!0,r.compile(),Ext.TabPanel.prototype.itemTpl=r}this.items.each(this.initTab,this)},afterRender:function(){if(Ext.TabPanel.superclass.afterRender.call(this),this.autoTabs&&this.readTabs(!1),void 0!==this.activeTab){var e=Ext.isObject(this.activeTab)?this.activeTab:this.items.get(this.activeTab);delete this.activeTab,this.setActiveTab(e)}},initEvents:function(){Ext.TabPanel.superclass.initEvents.call(this),this.mon(this.strip,{scope:this,mousedown:this.onStripMouseDown,contextmenu:this.onStripContextMenu}),this.enableTabScroll&&this.mon(this.strip,"mousewheel",this.onWheel,this)},findTargets:function(e){var t=null,i=e.getTarget("li:not(.x-tab-edge)",this.strip);return i&&(t=this.getComponent(i.id.split(this.idDelimiter)[1]),t.disabled)?{close:null,item:null,el:null}:{close:e.getTarget(".x-tab-strip-close",this.strip),item:t,el:i}},onStripMouseDown:function(e){if(0===e.button){e.preventDefault();var t=this.findTargets(e);return t.close?(t.item.fireEvent("beforeclose",t.item)!==!1&&(t.item.fireEvent("close",t.item),this.remove(t.item)),void 0):(t.item&&t.item!=this.activeTab&&this.setActiveTab(t.item),void 0)}},onStripContextMenu:function(e){e.preventDefault();var t=this.findTargets(e);t.item&&this.fireEvent("contextmenu",this,t.item,e)},readTabs:function(e){e===!0&&this.items.each(function(e){this.remove(e)},this);for(var t=this.el.query(this.autoTabSelector),i=0,s=t.length;s>i;i++){var n=t[i],r=n.getAttribute("title");n.removeAttribute("title"),this.add({title:r,contentEl:n})}},initTab:function(e,t){var i=this.strip.dom.childNodes[t],s=this.getTemplateArgs(e),n=i?this.itemTpl.insertBefore(i,s):this.itemTpl.append(this.strip,s),r="x-tab-strip-over",a=Ext.get(n);a.hover(function(){e.disabled||a.addClass(r)},function(){a.removeClass(r)}),e.tabTip&&(a.child("span.x-tab-strip-text",!0).qtip=e.tabTip),e.tabEl=n,a.select("a").on("click",function(e){e.getPageX()||this.onStripMouseDown(e)},this,{preventDefault:!0}),e.on({scope:this,disable:this.onItemDisabled,enable:this.onItemEnabled,titlechange:this.onItemTitleChanged,iconchange:this.onItemIconChanged,beforeshow:this.onBeforeShowItem})},getTemplateArgs:function(e){var t=e.closable?"x-tab-strip-closable":"";return e.disabled&&(t+=" x-item-disabled"),e.iconCls&&(t+=" x-tab-with-icon"),e.tabCls&&(t+=" "+e.tabCls),{id:this.id+this.idDelimiter+e.getItemId(),text:e.title,cls:t,iconCls:e.iconCls||""}},onAdd:function(e){if(Ext.TabPanel.superclass.onAdd.call(this,e),this.rendered){var t=this.items;this.initTab(e,t.indexOf(e)),this.delegateUpdates()}},onBeforeAdd:function(e){var t=e.events?this.items.containsKey(e.getItemId())?e:null:this.items.get(e);if(t)return this.setActiveTab(e),!1;Ext.TabPanel.superclass.onBeforeAdd.apply(this,arguments);var i=e.elements;e.elements=i?i.replace(",header",""):i,e.border=e.border===!0},onRemove:function(e){var t=Ext.get(e.tabEl);if(t&&(t.select("a").removeAllListeners(),Ext.destroy(t)),Ext.TabPanel.superclass.onRemove.call(this,e),this.stack.remove(e),delete e.tabEl,e.un("disable",this.onItemDisabled,this),e.un("enable",this.onItemEnabled,this),e.un("titlechange",this.onItemTitleChanged,this),e.un("iconchange",this.onItemIconChanged,this),e.un("beforeshow",this.onBeforeShowItem,this),e==this.activeTab){var i=this.stack.next();i?this.setActiveTab(i):this.items.getCount()>0?this.setActiveTab(0):this.setActiveTab(null)}this.destroying||this.delegateUpdates()},onBeforeShowItem:function(e){return e!=this.activeTab?(this.setActiveTab(e),!1):void 0},onItemDisabled:function(e){var t=this.getTabEl(e);t&&Ext.fly(t).addClass("x-item-disabled"),this.stack.remove(e)},onItemEnabled:function(e){var t=this.getTabEl(e);t&&Ext.fly(t).removeClass("x-item-disabled")},onItemTitleChanged:function(e){var t=this.getTabEl(e);t&&(Ext.fly(t).child("span.x-tab-strip-text",!0).innerHTML=e.title)},onItemIconChanged:function(e,t,i){var s=this.getTabEl(e);s&&(s=Ext.get(s),s.child("span.x-tab-strip-text").replaceClass(i,t),s[Ext.isEmpty(t)?"removeClass":"addClass"]("x-tab-with-icon"))},getTabEl:function(e){var t=this.getComponent(e);return t?t.tabEl:null},onResize:function(){Ext.TabPanel.superclass.onResize.apply(this,arguments),this.delegateUpdates()},beginUpdate:function(){this.suspendUpdates=!0},endUpdate:function(){this.suspendUpdates=!1,this.delegateUpdates()},hideTabStripItem:function(e){e=this.getComponent(e);var t=this.getTabEl(e);t&&(t.style.display="none",this.delegateUpdates()),this.stack.remove(e)},unhideTabStripItem:function(e){e=this.getComponent(e);var t=this.getTabEl(e);t&&(t.style.display="",this.delegateUpdates())},delegateUpdates:function(){var e=this.rendered;this.suspendUpdates||(this.resizeTabs&&e&&this.autoSizeTabs(),this.enableTabScroll&&e&&this.autoScrollTabs())},autoSizeTabs:function(){var e=this.items.length,t="bottom"!=this.tabPosition?"header":"footer",i=(this[t].dom.offsetWidth,this[t].dom.clientWidth);if(this.resizeTabs&&!(1>e)&&i){var s=Math.max(Math.min(Math.floor((i-4)/e)-this.tabMargin,this.tabWidth),this.minTabWidth);this.lastTabWidth=s;for(var n=this.strip.query("li:not(.x-tab-edge)"),r=0,a=n.length;a>r;r++){var o=n[r],l=Ext.fly(o).child(".x-tab-strip-inner",!0),h=o.offsetWidth,u=l.offsetWidth;l.style.width=s-(h-u)+"px"}}},adjustBodyWidth:function(e){return this.header&&this.header.setWidth(e),this.footer&&this.footer.setWidth(e),e},setActiveTab:function(e){if(e=this.getComponent(e),this.fireEvent("beforetabchange",this,e,this.activeTab)!==!1){if(!this.rendered)return this.activeTab=e,void 0;if(this.activeTab!=e){if(this.activeTab){var t=this.getTabEl(this.activeTab);t&&Ext.fly(t).removeClass("x-tab-strip-active")}if(this.activeTab=e,e){var i=this.getTabEl(e);Ext.fly(i).addClass("x-tab-strip-active"),this.stack.add(e),this.layout.setActiveItem(e),this.delegateUpdates(),this.scrolling&&this.scrollToTab(e,this.animScroll)}this.fireEvent("tabchange",this,e)}}},getActiveTab:function(){return this.activeTab||null},getItem:function(e){return this.getComponent(e)},autoScrollTabs:function(){this.pos="bottom"==this.tabPosition?this.footer:this.header;var e=this.items.length,t=(this.pos.dom.offsetWidth,this.pos.dom.clientWidth),i=this.stripWrap,s=i.dom,n=s.offsetWidth,r=this.getScrollPos(),a=this.edge.getOffsetsTo(this.stripWrap)[0]+r;!this.enableTabScroll||20>n||(0==e||t>=a?(s.scrollLeft=0,i.setWidth(t),this.scrolling&&(this.scrolling=!1,this.pos.removeClass("x-tab-scrolling"),this.scrollLeft.hide(),this.scrollRight.hide(),(Ext.isAir||Ext.isWebKit)&&(s.style.marginLeft="",s.style.marginRight=""))):(this.scrolling||(this.pos.addClass("x-tab-scrolling"),(Ext.isAir||Ext.isWebKit)&&(s.style.marginLeft="18px",s.style.marginRight="18px")),t-=i.getMargins("lr"),i.setWidth(t>20?t:20),this.scrolling||(this.scrollLeft?(this.scrollLeft.show(),this.scrollRight.show()):this.createScrollers()),this.scrolling=!0,r>a-t?s.scrollLeft=a-t:this.scrollToTab(this.activeTab,!1),this.updateScrollButtons()))},createScrollers:function(){this.pos.addClass("x-tab-scrolling-"+this.tabPosition);var e=this.stripWrap.dom.offsetHeight,t=this.pos.insertFirst({cls:"x-tab-scroller-left"});
t.setHeight(e),t.addClassOnOver("x-tab-scroller-left-over"),this.leftRepeater=new Ext.util.ClickRepeater(t,{interval:this.scrollRepeatInterval,handler:this.onScrollLeft,scope:this}),this.scrollLeft=t;var i=this.pos.insertFirst({cls:"x-tab-scroller-right"});i.setHeight(e),i.addClassOnOver("x-tab-scroller-right-over"),this.rightRepeater=new Ext.util.ClickRepeater(i,{interval:this.scrollRepeatInterval,handler:this.onScrollRight,scope:this}),this.scrollRight=i},getScrollWidth:function(){return this.edge.getOffsetsTo(this.stripWrap)[0]+this.getScrollPos()},getScrollPos:function(){return parseInt(this.stripWrap.dom.scrollLeft,10)||0},getScrollArea:function(){return parseInt(this.stripWrap.dom.clientWidth,10)||0},getScrollAnim:function(){return{duration:this.scrollDuration,callback:this.updateScrollButtons,scope:this}},getScrollIncrement:function(){return this.scrollIncrement||(this.resizeTabs?this.lastTabWidth+2:100)},scrollToTab:function(e,t){if(e){var i=this.getTabEl(e),s=this.getScrollPos(),n=this.getScrollArea(),r=Ext.fly(i).getOffsetsTo(this.stripWrap)[0]+s,a=r+i.offsetWidth;s>r?this.scrollTo(r,t):a>s+n&&this.scrollTo(a-n,t)}},scrollTo:function(e,t){this.stripWrap.scrollTo("left",e,t?this.getScrollAnim():!1),t||this.updateScrollButtons()},onWheel:function(e){var t=-1*e.getWheelDelta()*this.wheelIncrement;e.stopEvent();var i=this.getScrollPos(),s=i+t,n=this.getScrollWidth()-this.getScrollArea(),r=Math.max(0,Math.min(n,s));r!=i&&this.scrollTo(r,!1)},onScrollRight:function(){var e=this.getScrollWidth()-this.getScrollArea(),t=this.getScrollPos(),i=Math.min(e,t+this.getScrollIncrement());i!=t&&this.scrollTo(i,this.animScroll)},onScrollLeft:function(){var e=this.getScrollPos(),t=Math.max(0,e-this.getScrollIncrement());t!=e&&this.scrollTo(t,this.animScroll)},updateScrollButtons:function(){var e=this.getScrollPos();this.scrollLeft[0===e?"addClass":"removeClass"]("x-tab-scroller-left-disabled"),this.scrollRight[e>=this.getScrollWidth()-this.getScrollArea()?"addClass":"removeClass"]("x-tab-scroller-right-disabled")},beforeDestroy:function(){Ext.destroy(this.leftRepeater,this.rightRepeater),this.deleteMembers("strip","edge","scrollLeft","scrollRight","stripWrap"),this.activeTab=null,Ext.TabPanel.superclass.beforeDestroy.apply(this)}}),Ext.reg("tabpanel",Ext.TabPanel),Ext.TabPanel.prototype.activate=Ext.TabPanel.prototype.setActiveTab,Ext.TabPanel.AccessStack=function(){var e=[];return{add:function(t){e.push(t),e.length>10&&e.shift()},remove:function(t){for(var i=[],s=0,n=e.length;n>s;s++)e[s]!=t&&i.push(e[s]);e=i},next:function(){return e.pop()}}},Ext.Button=Ext.extend(Ext.BoxComponent,{hidden:!1,disabled:!1,pressed:!1,enableToggle:!1,menuAlign:"tl-bl?",type:"button",menuClassTarget:"tr:nth(2)",clickEvent:"click",handleMouseEvents:!0,tooltipType:"qtip",buttonSelector:"button:first-child",scale:"small",iconAlign:"left",arrowAlign:"right",initComponent:function(){this.menu&&(Ext.isArray(this.menu)&&(this.menu={items:this.menu}),Ext.isObject(this.menu)&&(this.menu.ownerCt=this),this.menu=Ext.menu.MenuMgr.get(this.menu),this.menu.ownerCt=void 0),Ext.Button.superclass.initComponent.call(this),this.addEvents("click","toggle","mouseover","mouseout","menushow","menuhide","menutriggerover","menutriggerout"),Ext.isString(this.toggleGroup)&&(this.enableToggle=!0)},getTemplateArgs:function(){return[this.type,"x-btn-"+this.scale+" x-btn-icon-"+this.scale+"-"+this.iconAlign,this.getMenuClass(),this.cls,this.id]},setButtonClass:function(){this.useSetClass&&(Ext.isEmpty(this.oldCls)||this.el.removeClass([this.oldCls,"x-btn-pressed"]),this.oldCls=this.iconCls||this.icon?this.text?"x-btn-text-icon":"x-btn-icon":"x-btn-noicon",this.el.addClass([this.oldCls,this.pressed?"x-btn-pressed":null]))},getMenuClass:function(){return this.menu?"bottom"!=this.arrowAlign?"x-btn-arrow":"x-btn-arrow-bottom":""},onRender:function(e,t){this.template||(Ext.Button.buttonTemplate||(Ext.Button.buttonTemplate=new Ext.Template('<table id="{4}" cellspacing="0" class="x-btn {3}"><tbody class="{1}">','<tr><td class="x-btn-tl"><i>&#160;</i></td><td class="x-btn-tc"></td><td class="x-btn-tr"><i>&#160;</i></td></tr>','<tr><td class="x-btn-ml"><i>&#160;</i></td><td class="x-btn-mc"><em class="{2}" unselectable="on"><button type="{0}"></button></em></td><td class="x-btn-mr"><i>&#160;</i></td></tr>','<tr><td class="x-btn-bl"><i>&#160;</i></td><td class="x-btn-bc"></td><td class="x-btn-br"><i>&#160;</i></td></tr>',"</tbody></table>"),Ext.Button.buttonTemplate.compile()),this.template=Ext.Button.buttonTemplate);var i,s=this.getTemplateArgs();i=t?this.template.insertBefore(t,s,!0):this.template.append(e,s,!0),this.btnEl=i.child(this.buttonSelector),this.mon(this.btnEl,{scope:this,focus:this.onFocus,blur:this.onBlur}),this.initButtonEl(i,this.btnEl),Ext.ButtonToggleMgr.register(this)},initButtonEl:function(e,t){if(this.el=e,this.setIcon(this.icon),this.setText(this.text),this.setIconClass(this.iconCls),Ext.isDefined(this.tabIndex)&&(t.dom.tabIndex=this.tabIndex),this.tooltip&&this.setTooltip(this.tooltip,!0),this.handleMouseEvents&&this.mon(e,{scope:this,mouseover:this.onMouseOver,mousedown:this.onMouseDown}),this.menu&&this.mon(this.menu,{scope:this,show:this.onMenuShow,hide:this.onMenuHide}),this.repeat){var i=new Ext.util.ClickRepeater(e,Ext.isObject(this.repeat)?this.repeat:{});this.mon(i,"click",this.onRepeatClick,this)}else this.mon(e,this.clickEvent,this.onClick,this)},afterRender:function(){Ext.Button.superclass.afterRender.call(this),this.useSetClass=!0,this.setButtonClass(),this.doc=Ext.getDoc(),this.doAutoWidth()},setIconClass:function(e){return this.iconCls=e,this.el&&(this.btnEl.dom.className="",this.btnEl.addClass(["x-btn-text",e||""]),this.setButtonClass()),this},setTooltip:function(e,t){return this.rendered?(t||this.clearTip(),Ext.isObject(e)?(Ext.QuickTips.register(Ext.apply({target:this.btnEl.id},e)),this.tooltip=e):this.btnEl.dom[this.tooltipType]=e):this.tooltip=e,this},clearTip:function(){Ext.isObject(this.tooltip)&&Ext.QuickTips.unregister(this.btnEl)},beforeDestroy:function(){this.rendered&&this.clearTip(),this.menu&&this.destroyMenu!==!1&&Ext.destroy(this.btnEl,this.menu),Ext.destroy(this.repeater)},onDestroy:function(){this.rendered&&(this.doc.un("mouseover",this.monitorMouseOver,this),this.doc.un("mouseup",this.onMouseUp,this),delete this.doc,delete this.btnEl,Ext.ButtonToggleMgr.unregister(this)),Ext.Button.superclass.onDestroy.call(this)},doAutoWidth:function(){if(this.autoWidth!==!1&&this.el&&this.text&&void 0===this.width){if(this.el.setWidth("auto"),Ext.isIE7&&Ext.isStrict){var e=this.btnEl;e&&e.getWidth()>20&&(e.clip(),e.setWidth(Ext.util.TextMetrics.measure(e,this.text).width+e.getFrameWidth("lr")))}this.minWidth&&this.el.getWidth()<this.minWidth&&this.el.setWidth(this.minWidth)}},setHandler:function(e,t){return this.handler=e,this.scope=t,this},setText:function(e){return this.text=e,this.el&&(this.btnEl.update(e||"&#160;"),this.setButtonClass()),this.doAutoWidth(),this},setIcon:function(e){return this.icon=e,this.el&&(this.btnEl.setStyle("background-image",e?"url("+e+")":""),this.setButtonClass()),this},getText:function(){return this.text},toggle:function(e,t){return e=void 0===e?!this.pressed:!!e,e!=this.pressed&&(this.rendered&&this.el[e?"addClass":"removeClass"]("x-btn-pressed"),this.pressed=e,t||(this.fireEvent("toggle",this,e),this.toggleHandler&&this.toggleHandler.call(this.scope||this,this,e))),this},onDisable:function(){this.onDisableChange(!0)},onEnable:function(){this.onDisableChange(!1)},onDisableChange:function(e){this.el&&(Ext.isIE6&&this.text||this.el[e?"addClass":"removeClass"](this.disabledClass),this.el.dom.disabled=e),this.disabled=e},showMenu:function(){return this.rendered&&this.menu&&(this.tooltip&&Ext.QuickTips.getQuickTip().cancelShow(this.btnEl),this.menu.isVisible()&&this.menu.hide(),this.menu.ownerCt=this,this.menu.show(this.el,this.menuAlign)),this},hideMenu:function(){return this.hasVisibleMenu()&&this.menu.hide(),this},hasVisibleMenu:function(){return this.menu&&this.menu.ownerCt==this&&this.menu.isVisible()},onRepeatClick:function(e,t){this.onClick(t)},onClick:function(e){e&&e.preventDefault(),0===e.button&&(this.disabled||(this.doToggle(),!this.menu||this.hasVisibleMenu()||this.ignoreNextClick||this.showMenu(),this.fireEvent("click",this,e),this.handler&&this.handler.call(this.scope||this,this,e)))},doToggle:function(){!this.enableToggle||this.allowDepress===!1&&this.pressed||this.toggle()},isMenuTriggerOver:function(e,t){return this.menu&&!t},isMenuTriggerOut:function(e,t){return this.menu&&!t},onMouseOver:function(e){if(!this.disabled){var t=e.within(this.el,!0);t||(this.el.addClass("x-btn-over"),this.monitoringMouseOver||(this.doc.on("mouseover",this.monitorMouseOver,this),this.monitoringMouseOver=!0),this.fireEvent("mouseover",this,e)),this.isMenuTriggerOver(e,t)&&this.fireEvent("menutriggerover",this,this.menu,e)}},monitorMouseOver:function(e){e.target==this.el.dom||e.within(this.el)||(this.monitoringMouseOver&&(this.doc.un("mouseover",this.monitorMouseOver,this),this.monitoringMouseOver=!1),this.onMouseOut(e))},onMouseOut:function(e){var t=e.within(this.el)&&e.target!=this.el.dom;this.el.removeClass("x-btn-over"),this.fireEvent("mouseout",this,e),this.isMenuTriggerOut(e,t)&&this.fireEvent("menutriggerout",this,this.menu,e)},focus:function(){this.btnEl.focus()},blur:function(){this.btnEl.blur()},onFocus:function(){this.disabled||this.el.addClass("x-btn-focus")},onBlur:function(){this.el.removeClass("x-btn-focus")},getClickEl:function(){return this.el},onMouseDown:function(e){this.disabled||0!==e.button||(this.getClickEl(e).addClass("x-btn-click"),this.doc.on("mouseup",this.onMouseUp,this))},onMouseUp:function(e){0===e.button&&(this.getClickEl(e,!0).removeClass("x-btn-click"),this.doc.un("mouseup",this.onMouseUp,this))},onMenuShow:function(){this.menu.ownerCt==this&&(this.menu.ownerCt=this,this.ignoreNextClick=0,this.el.addClass("x-btn-menu-active"),this.fireEvent("menushow",this,this.menu))},onMenuHide:function(){this.menu.ownerCt==this&&(this.el.removeClass("x-btn-menu-active"),this.ignoreNextClick=this.restoreClick.defer(250,this),this.fireEvent("menuhide",this,this.menu),delete this.menu.ownerCt)},restoreClick:function(){this.ignoreNextClick=0}}),Ext.reg("button",Ext.Button),Ext.ButtonToggleMgr=function(){function e(e,i){if(i)for(var s=t[e.toggleGroup],n=0,r=s.length;r>n;n++)s[n]!=e&&s[n].toggle(!1)}var t={};return{register:function(i){if(i.toggleGroup){var s=t[i.toggleGroup];s||(s=t[i.toggleGroup]=[]),s.push(i),i.on("toggle",e)}},unregister:function(i){if(i.toggleGroup){var s=t[i.toggleGroup];s&&(s.remove(i),i.un("toggle",e))}},getPressed:function(e){var i=t[e];if(i)for(var s=0,n=i.length;n>s;s++)if(i[s].pressed===!0)return i[s];return null}}}(),Ext.SplitButton=Ext.extend(Ext.Button,{arrowSelector:"em",split:!0,initComponent:function(){Ext.SplitButton.superclass.initComponent.call(this),this.addEvents("arrowclick")},onRender:function(){Ext.SplitButton.superclass.onRender.apply(this,arguments),this.arrowTooltip&&(this.el.child(this.arrowSelector).dom[this.tooltipType]=this.arrowTooltip)},setArrowHandler:function(e,t){this.arrowHandler=e,this.scope=t},getMenuClass:function(){return"x-btn-split"+("bottom"==this.arrowAlign?"-bottom":"")},isClickOnArrow:function(e){if("bottom"!=this.arrowAlign){var t=this.el.child("em.x-btn-split"),i=t.getRegion().right-t.getPadding("r");return e.getPageX()>i}return e.getPageY()>this.btnEl.getRegion().bottom},onClick:function(e){e.preventDefault(),this.disabled||(this.isClickOnArrow(e)?(!this.menu||this.menu.isVisible()||this.ignoreNextClick||this.showMenu(),this.fireEvent("arrowclick",this,e),this.arrowHandler&&this.arrowHandler.call(this.scope||this,this,e)):(this.doToggle(),this.fireEvent("click",this,e),this.handler&&this.handler.call(this.scope||this,this,e)))},isMenuTriggerOver:function(e){return this.menu&&e.target.tagName==this.arrowSelector},isMenuTriggerOut:function(e){return this.menu&&e.target.tagName!=this.arrowSelector}}),Ext.reg("splitbutton",Ext.SplitButton),Ext.CycleButton=Ext.extend(Ext.SplitButton,{getItemText:function(e){if(e&&this.showText===!0){var t="";return this.prependText&&(t+=this.prependText),t+=e.text}return void 0},setActiveItem:function(e,t){if(Ext.isObject(e)||(e=this.menu.getComponent(e)),e){if(this.rendered){var i=this.getItemText(e);i&&this.setText(i),this.setIconClass(e.iconCls)}else this.text=this.getItemText(e),this.iconCls=e.iconCls;this.activeItem=e,e.checked||e.setChecked(!0,t),this.forceIcon&&this.setIconClass(this.forceIcon),t||this.fireEvent("change",this,e)}},getActiveItem:function(){return this.activeItem},initComponent:function(){this.addEvents("change"),this.changeHandler&&(this.on("change",this.changeHandler,this.scope||this),delete this.changeHandler),this.itemCount=this.items.length,this.menu={cls:"x-cycle-menu",items:[]};var e=0;Ext.each(this.items,function(t,i){Ext.apply(t,{group:t.group||this.id,itemIndex:i,checkHandler:this.checkHandler,scope:this,checked:t.checked||!1}),this.menu.items.push(t),t.checked&&(e=i)},this),Ext.CycleButton.superclass.initComponent.call(this),this.on("click",this.toggleSelected,this),this.setActiveItem(e,!0)},checkHandler:function(e,t){t&&this.setActiveItem(e)},toggleSelected:function(){var e=this.menu;e.render(),e.hasLayout||e.doLayout();for(var t,i,s=1;s<this.itemCount;s++)if(t=(this.activeItem.itemIndex+s)%this.itemCount,i=e.items.itemAt(t),!i.disabled){i.setChecked(!0);break}}}),Ext.reg("cycle",Ext.CycleButton),Ext.Toolbar=function(e){Ext.isArray(e)?e={items:e,layout:"toolbar"}:(e=Ext.apply({layout:"toolbar"},e),e.buttons&&(e.items=e.buttons)),Ext.Toolbar.superclass.constructor.call(this,e)},function(){var e=Ext.Toolbar;Ext.extend(e,Ext.Container,{defaultType:"button",enableOverflow:!1,trackMenus:!0,internalDefaults:{removeMode:"container",hideParent:!0},toolbarCls:"x-toolbar",initComponent:function(){e.superclass.initComponent.call(this),this.addEvents("overflowchange")},onRender:function(e,t){this.el||(this.autoCreate||(this.autoCreate={cls:this.toolbarCls+" x-small-editor"}),this.el=e.createChild(Ext.apply({id:this.id},this.autoCreate),t),Ext.Toolbar.superclass.onRender.apply(this,arguments))},lookupComponent:function(t){return Ext.isString(t)?(t="-"==t?new e.Separator:" "==t?new e.Spacer:"->"==t?new e.Fill:new e.TextItem(t),this.applyDefaults(t)):t.isFormField||t.render?t=this.createComponent(t):t.tag?t=new e.Item({autoEl:t}):t.tagName?t=new e.Item({el:t}):Ext.isObject(t)&&(t=t.xtype?this.createComponent(t):this.constructButton(t)),t},applyDefaults:function(e){if(!Ext.isString(e)){e=Ext.Toolbar.superclass.applyDefaults.call(this,e);var t=this.internalDefaults;e.events?(Ext.applyIf(e.initialConfig,t),Ext.apply(e,t)):Ext.applyIf(e,t)}return e},addSeparator:function(){return this.add(new e.Separator)},addSpacer:function(){return this.add(new e.Spacer)},addFill:function(){this.add(new e.Fill)},addElement:function(t){return this.addItem(new e.Item({el:t}))},addItem:function(){return this.add.apply(this,arguments)},addButton:function(e){if(Ext.isArray(e)){for(var t=[],i=0,s=e.length;s>i;i++)t.push(this.addButton(e[i]));return t}return this.add(this.constructButton(e))},addText:function(t){return this.addItem(new e.TextItem(t))},addDom:function(t){return this.add(new e.Item({autoEl:t}))},addField:function(e){return this.add(e)},insertButton:function(e,t){if(Ext.isArray(t)){for(var i=[],s=0,n=t.length;n>s;s++)i.push(this.insertButton(e+s,t[s]));return i}return Ext.Toolbar.superclass.insert.call(this,e,t)},trackMenu:function(e,t){if(this.trackMenus&&e.menu){var i=t?"mun":"mon";this[i](e,"menutriggerover",this.onButtonTriggerOver,this),this[i](e,"menushow",this.onButtonMenuShow,this),this[i](e,"menuhide",this.onButtonMenuHide,this)}},constructButton:function(e){var t=e.events?e:this.createComponent(e,e.split?"splitbutton":this.defaultType);return t},onAdd:function(e){Ext.Toolbar.superclass.onAdd.call(this),this.trackMenu(e),this.disabled&&e.disable()},onRemove:function(e){Ext.Toolbar.superclass.onRemove.call(this),e==this.activeMenuBtn&&delete this.activeMenuBtn,this.trackMenu(e,!0)},onDisable:function(){this.items.each(function(e){e.disable&&e.disable()})},onEnable:function(){this.items.each(function(e){e.enable&&e.enable()})},onButtonTriggerOver:function(e){this.activeMenuBtn&&this.activeMenuBtn!=e&&(this.activeMenuBtn.hideMenu(),e.showMenu(),this.activeMenuBtn=e)},onButtonMenuShow:function(e){this.activeMenuBtn=e},onButtonMenuHide:function(){delete this.activeMenuBtn}}),Ext.reg("toolbar",Ext.Toolbar),e.Item=Ext.extend(Ext.BoxComponent,{hideParent:!0,enable:Ext.emptyFn,disable:Ext.emptyFn,focus:Ext.emptyFn}),Ext.reg("tbitem",e.Item),e.Separator=Ext.extend(e.Item,{onRender:function(e,t){this.el=e.createChild({tag:"span",cls:"xtb-sep"},t)}}),Ext.reg("tbseparator",e.Separator),e.Spacer=Ext.extend(e.Item,{onRender:function(e,t){this.el=e.createChild({tag:"div",cls:"xtb-spacer",style:this.width?"width:"+this.width+"px":""},t)}}),Ext.reg("tbspacer",e.Spacer),e.Fill=Ext.extend(e.Item,{render:Ext.emptyFn,isFill:!0}),Ext.reg("tbfill",e.Fill),e.TextItem=Ext.extend(e.Item,{constructor:function(t){e.TextItem.superclass.constructor.call(this,Ext.isString(t)?{text:t}:t)},onRender:function(t,i){this.autoEl={cls:"xtb-text",html:this.text||""},e.TextItem.superclass.onRender.call(this,t,i)},setText:function(e){this.rendered?this.el.update(e):this.text=e}}),Ext.reg("tbtext",e.TextItem),e.Button=Ext.extend(Ext.Button,{}),e.SplitButton=Ext.extend(Ext.SplitButton,{}),Ext.reg("tbbutton",e.Button),Ext.reg("tbsplit",e.SplitButton)}(),Ext.ButtonGroup=Ext.extend(Ext.Panel,{baseCls:"x-btn-group",layout:"table",defaultType:"button",frame:!0,internalDefaults:{removeMode:"container",hideParent:!0},initComponent:function(){this.layoutConfig=this.layoutConfig||{},Ext.applyIf(this.layoutConfig,{columns:this.columns}),this.title||this.addClass("x-btn-group-notitle"),this.on("afterlayout",this.onAfterLayout,this),Ext.ButtonGroup.superclass.initComponent.call(this)},applyDefaults:function(e){e=Ext.ButtonGroup.superclass.applyDefaults.call(this,e);var t=this.internalDefaults;return e.events?(Ext.applyIf(e.initialConfig,t),Ext.apply(e,t)):Ext.applyIf(e,t),e},onAfterLayout:function(){var e=this.body.getFrameWidth("lr")+this.body.dom.firstChild.offsetWidth;this.body.setWidth(e),this.el.setWidth(e+this.getFrameWidth())}}),Ext.reg("buttongroup",Ext.ButtonGroup),function(){var e=Ext.Toolbar;Ext.PagingToolbar=Ext.extend(Ext.Toolbar,{pageSize:20,displayMsg:"Displaying {0} - {1} of {2}",emptyMsg:"No data to display",beforePageText:"Page",afterPageText:"of {0}",firstText:"First Page",prevText:"Previous Page",nextText:"Next Page",lastText:"Last Page",refreshText:"Refresh",initComponent:function(){var t=[this.first=new e.Button({tooltip:this.firstText,overflowText:this.firstText,iconCls:"x-tbar-page-first",disabled:!0,handler:this.moveFirst,scope:this}),this.prev=new e.Button({tooltip:this.prevText,overflowText:this.prevText,iconCls:"x-tbar-page-prev",disabled:!0,handler:this.movePrevious,scope:this}),"-",this.beforePageText,this.inputItem=new Ext.form.NumberField({cls:"x-tbar-page-number",allowDecimals:!1,allowNegative:!1,enableKeyEvents:!0,selectOnFocus:!0,submitValue:!1,listeners:{scope:this,keydown:this.onPagingKeyDown,blur:this.onPagingBlur}}),this.afterTextItem=new e.TextItem({text:String.format(this.afterPageText,1)}),"-",this.next=new e.Button({tooltip:this.nextText,overflowText:this.nextText,iconCls:"x-tbar-page-next",disabled:!0,handler:this.moveNext,scope:this}),this.last=new e.Button({tooltip:this.lastText,overflowText:this.lastText,iconCls:"x-tbar-page-last",disabled:!0,handler:this.moveLast,scope:this}),"-",this.refresh=new e.Button({tooltip:this.refreshText,overflowText:this.refreshText,iconCls:"x-tbar-loading",handler:this.doRefresh,scope:this})],i=this.items||this.buttons||[];this.items=this.prependButtons?i.concat(t):t.concat(i),delete this.buttons,this.displayInfo&&(this.items.push("->"),this.items.push(this.displayItem=new e.TextItem({}))),Ext.PagingToolbar.superclass.initComponent.call(this),this.addEvents("change","beforechange"),this.on("afterlayout",this.onFirstLayout,this,{single:!0}),this.cursor=0,this.bindStore(this.store,!0)},onFirstLayout:function(){this.dsLoaded&&this.onLoad.apply(this,this.dsLoaded)},updateInfo:function(){if(this.displayItem){var e=this.store.getCount(),t=0==e?this.emptyMsg:String.format(this.displayMsg,this.cursor+1,this.cursor+e,this.store.getTotalCount());this.displayItem.setText(t)}},onLoad:function(e,t,i){if(!this.rendered)return this.dsLoaded=[e,t,i],void 0;var s=this.getParams();this.cursor=i.params&&i.params[s.start]?i.params[s.start]:0;var n=this.getPageData(),r=n.activePage,a=n.pages;this.afterTextItem.setText(String.format(this.afterPageText,n.pages)),this.inputItem.setValue(r),this.first.setDisabled(1==r),this.prev.setDisabled(1==r),this.next.setDisabled(r==a),this.last.setDisabled(r==a),this.refresh.enable(),this.updateInfo(),this.fireEvent("change",this,n)},getPageData:function(){var e=this.store.getTotalCount();return{total:e,activePage:Math.ceil((this.cursor+this.pageSize)/this.pageSize),pages:e<this.pageSize?1:Math.ceil(e/this.pageSize)}},changePage:function(e){this.doLoad(((e-1)*this.pageSize).constrain(0,this.store.getTotalCount()))},onLoadError:function(){this.rendered&&this.refresh.enable()},readPage:function(e){var t,i=this.inputItem.getValue();return!i||isNaN(t=parseInt(i,10))?(this.inputItem.setValue(e.activePage),!1):t},onPagingFocus:function(){this.inputItem.select()},onPagingBlur:function(){this.inputItem.setValue(this.getPageData().activePage)},onPagingKeyDown:function(e,t){var i,s=t.getKey(),n=this.getPageData();if(s==t.RETURN)t.stopEvent(),i=this.readPage(n),i!==!1&&(i=Math.min(Math.max(1,i),n.pages)-1,this.doLoad(i*this.pageSize));else if(s==t.HOME||s==t.END)t.stopEvent(),i=s==t.HOME?1:n.pages,e.setValue(i);else if((s==t.UP||s==t.PAGEUP||s==t.DOWN||s==t.PAGEDOWN)&&(t.stopEvent(),i=this.readPage(n))){var r=t.shiftKey?10:1;(s==t.DOWN||s==t.PAGEDOWN)&&(r*=-1),i+=r,i>=1&i<=n.pages&&e.setValue(i)}},getParams:function(){return this.paramNames||this.store.paramNames},beforeLoad:function(){this.rendered&&this.refresh&&this.refresh.disable()},doLoad:function(e){var t={},i=this.getParams();t[i.start]=e,t[i.limit]=this.pageSize,this.fireEvent("beforechange",this,t)!==!1&&this.store.load({params:t})},moveFirst:function(){this.doLoad(0)},movePrevious:function(){this.doLoad(Math.max(0,this.cursor-this.pageSize))},moveNext:function(){this.doLoad(this.cursor+this.pageSize)},moveLast:function(){var e=this.store.getTotalCount(),t=e%this.pageSize;this.doLoad(t?e-t:e-this.pageSize)},doRefresh:function(){this.doLoad(this.cursor)},bindStore:function(e,t){var i;!t&&this.store&&(e!==this.store&&this.store.autoDestroy?this.store.destroy():(this.store.un("beforeload",this.beforeLoad,this),this.store.un("load",this.onLoad,this),this.store.un("exception",this.onLoadError,this)),e||(this.store=null)),e&&(e=Ext.StoreMgr.lookup(e),e.on({scope:this,beforeload:this.beforeLoad,load:this.onLoad,exception:this.onLoadError}),i=!0),this.store=e,i&&this.onLoad(e,null,{})},unbind:function(){this.bindStore(null)},bind:function(e){this.bindStore(e)},onDestroy:function(){this.bindStore(null),Ext.PagingToolbar.superclass.onDestroy.call(this)}})}(),Ext.reg("paging",Ext.PagingToolbar),Ext.History=function(){function e(){var e=location.href,t=e.indexOf("#"),i=t>=0?e.substr(t+1):null;return Ext.isGecko&&(i=decodeURIComponent(i)),i}function t(){o.value=l}function i(e){l=e,Ext.History.fireEvent("change",e)}function s(e){var t=['<html><body><div id="state">',Ext.util.Format.htmlEncode(e),"</div></body></html>"].join("");try{var i=a.contentWindow.document;return i.open(),i.write(t),i.close(),!0}catch(s){return!1}}function n(){if(!a.contentWindow||!a.contentWindow.document)return setTimeout(n,10),void 0;var r=a.contentWindow.document,o=r.getElementById("state"),l=o?o.innerText:null,u=e();setInterval(function(){r=a.contentWindow.document,o=r.getElementById("state");var n=o?o.innerText:null,h=e();n!==l?(l=n,i(l),location.hash=l,u=l,t()):h!==u&&(u=h,s(h))},50),h=!0,Ext.History.fireEvent("ready",Ext.History)}function r(){if(l=o.value?o.value:e(),Ext.isIE)n();else{var s=e();setInterval(function(){var n=e();n!==s&&(s=n,i(s),t())},50),h=!0,Ext.History.fireEvent("ready",Ext.History)}}var a,o,l,h=!1;return{fieldId:"x-history-field",iframeId:"x-history-frame",events:{},init:function(e,t){return h?(Ext.callback(e,t,[this]),void 0):Ext.isReady?(o=Ext.getDom(Ext.History.fieldId),Ext.isIE&&(a=Ext.getDom(Ext.History.iframeId)),this.addEvents("ready","change"),e&&this.on("ready",e,t,{single:!0}),r(),void 0):(Ext.onReady(function(){Ext.History.init(e,t)}),void 0)},add:function(e,t){return t!==!1&&this.getToken()==e?!0:Ext.isIE?s(e):(location.hash=e,!0)},back:function(){history.go(-1)},forward:function(){history.go(1)},getToken:function(){return h?l:e()}}}(),Ext.apply(Ext.History,new Ext.util.Observable),Ext.Tip=Ext.extend(Ext.Panel,{minWidth:40,maxWidth:300,shadow:"sides",defaultAlign:"tl-bl?",autoRender:!0,quickShowInterval:250,frame:!0,hidden:!0,baseCls:"x-tip",floating:{shadow:!0,shim:!0,useDisplay:!0,constrain:!1},autoHeight:!0,closeAction:"hide",initComponent:function(){Ext.Tip.superclass.initComponent.call(this),this.closable&&!this.title&&(this.elements+=",header")},afterRender:function(){Ext.Tip.superclass.afterRender.call(this),this.closable&&this.addTool({id:"close",handler:this[this.closeAction],scope:this})},showAt:function(e){Ext.Tip.superclass.show.call(this),this.measureWidth===!1||this.initialConfig&&"number"==typeof this.initialConfig.width||this.doAutoWidth(),this.constrainPosition&&(e=this.el.adjustForConstraints(e)),this.setPagePosition(e[0],e[1])},doAutoWidth:function(e){e=e||0;var t=this.body.getTextWidth();this.title&&(t=Math.max(t,this.header.child("span").getTextWidth(this.title))),t+=this.getFrameWidth()+(this.closable?20:0)+this.body.getPadding("lr")+e,this.setWidth(t.constrain(this.minWidth,this.maxWidth)),Ext.isIE7&&!this.repainted&&(this.el.repaint(),this.repainted=!0)},showBy:function(e,t){this.rendered||this.render(Ext.getBody()),this.showAt(this.el.getAlignToXY(e,t||this.defaultAlign))},initDraggable:function(){this.dd=new Ext.Tip.DD(this,"boolean"==typeof this.draggable?null:this.draggable),this.header.addClass("x-tip-draggable")}}),Ext.reg("tip",Ext.Tip),Ext.Tip.DD=function(e,t){Ext.apply(this,t),this.tip=e,Ext.Tip.DD.superclass.constructor.call(this,e.el.id,"WindowDD-"+e.id),this.setHandleElId(e.header.id),this.scroll=!1},Ext.extend(Ext.Tip.DD,Ext.dd.DD,{moveOnly:!0,scroll:!1,headerOffsets:[100,25],startDrag:function(){this.tip.el.disableShadow()},endDrag:function(){this.tip.el.enableShadow(!0)}}),Ext.ToolTip=Ext.extend(Ext.Tip,{showDelay:500,hideDelay:200,dismissDelay:5e3,trackMouse:!1,anchorToTarget:!0,anchorOffset:0,targetCounter:0,constrainPosition:!1,initComponent:function(){Ext.ToolTip.superclass.initComponent.call(this),this.lastActive=new Date,this.initTarget(this.target),this.origAnchor=this.anchor},onRender:function(e,t){Ext.ToolTip.superclass.onRender.call(this,e,t),this.anchorCls="x-tip-anchor-"+this.getAnchorPosition(),this.anchorEl=this.el.createChild({cls:"x-tip-anchor "+this.anchorCls})},afterRender:function(){Ext.ToolTip.superclass.afterRender.call(this),this.anchorEl.setStyle("z-index",this.el.getZIndex()+1).setVisibilityMode(Ext.Element.DISPLAY)},initTarget:function(e){var t;if(t=Ext.get(e)){if(this.target){var i=Ext.get(this.target);this.mun(i,"mouseover",this.onTargetOver,this),this.mun(i,"mouseout",this.onTargetOut,this),this.mun(i,"mousemove",this.onMouseMove,this)}this.mon(t,{mouseover:this.onTargetOver,mouseout:this.onTargetOut,mousemove:this.onMouseMove,scope:this}),this.target=t}this.anchor&&(this.anchorTarget=this.target)},onMouseMove:function(e){var t=this.delegate?e.getTarget(this.delegate):this.triggerElement=!0;t?(this.targetXY=e.getXY(),t===this.triggerElement?!this.hidden&&this.trackMouse&&this.setPagePosition(this.getTargetXY()):(this.hide(),this.lastActive=new Date(0),this.onTargetOver(e))):!this.closable&&this.isVisible()&&this.hide()},getTargetXY:function(){if(this.delegate&&(this.anchorTarget=this.triggerElement),this.anchor){this.targetCounter++;var e=this.getOffsets(),t=this.anchorToTarget&&!this.trackMouse?this.el.getAlignToXY(this.anchorTarget,this.getAnchorAlign()):this.targetXY,i=Ext.lib.Dom.getViewWidth()-5,s=Ext.lib.Dom.getViewHeight()-5,n=document.documentElement,r=document.body,a=(n.scrollLeft||r.scrollLeft||0)+5,o=(n.scrollTop||r.scrollTop||0)+5,l=[t[0]+e[0],t[1]+e[1]],h=this.getSize();if(this.anchorEl.removeClass(this.anchorCls),this.targetCounter<2){if(l[0]<a)return this.anchorToTarget&&(this.defaultAlign="l-r",this.mouseOffset&&(this.mouseOffset[0]*=-1)),this.anchor="left",this.getTargetXY();if(l[0]+h.width>i)return this.anchorToTarget&&(this.defaultAlign="r-l",this.mouseOffset&&(this.mouseOffset[0]*=-1)),this.anchor="right",this.getTargetXY();if(l[1]<o)return this.anchorToTarget&&(this.defaultAlign="t-b",this.mouseOffset&&(this.mouseOffset[1]*=-1)),this.anchor="top",this.getTargetXY();if(l[1]+h.height>s)return this.anchorToTarget&&(this.defaultAlign="b-t",this.mouseOffset&&(this.mouseOffset[1]*=-1)),this.anchor="bottom",this.getTargetXY()}return this.anchorCls="x-tip-anchor-"+this.getAnchorPosition(),this.anchorEl.addClass(this.anchorCls),this.targetCounter=0,l}var u=this.getMouseOffset();return[this.targetXY[0]+u[0],this.targetXY[1]+u[1]]},getMouseOffset:function(){var e=this.anchor?[0,0]:[15,18];return this.mouseOffset&&(e[0]+=this.mouseOffset[0],e[1]+=this.mouseOffset[1]),e},getAnchorPosition:function(){if(this.anchor)this.tipAnchor=this.anchor.charAt(0);else{var e=this.defaultAlign.match(/^([a-z]+)-([a-z]+)(\?)?$/);if(!e)throw"AnchorTip.defaultAlign is invalid";this.tipAnchor=e[1].charAt(0)}switch(this.tipAnchor){case"t":return"top";case"b":return"bottom";case"r":return"right"}return"left"},getAnchorAlign:function(){switch(this.anchor){case"top":return"tl-bl";case"left":return"tl-tr";case"right":return"tr-tl";default:return"bl-tl"}},getOffsets:function(){var e,t=this.getAnchorPosition().charAt(0);if(this.anchorToTarget&&!this.trackMouse)switch(t){case"t":e=[0,9];break;case"b":e=[0,-13];break;case"r":e=[-13,0];break;default:e=[9,0]}else switch(t){case"t":e=[-15-this.anchorOffset,30];break;case"b":e=[-19-this.anchorOffset,-13-this.el.dom.offsetHeight];break;case"r":e=[-15-this.el.dom.offsetWidth,-13-this.anchorOffset];break;default:e=[25,-13-this.anchorOffset]}var i=this.getMouseOffset();return e[0]+=i[0],e[1]+=i[1],e},onTargetOver:function(e){if(!this.disabled&&!e.within(this.target.dom,!0)){var t=e.getTarget(this.delegate);t&&(this.triggerElement=t,this.clearTimer("hide"),this.targetXY=e.getXY(),this.delayShow())}},delayShow:function(){this.hidden&&!this.showTimer?this.lastActive.getElapsed()<this.quickShowInterval?this.show():this.showTimer=this.show.defer(this.showDelay,this):this.hidden||this.autoHide===!1||this.show()},onTargetOut:function(e){this.disabled||e.within(this.target.dom,!0)||(this.clearTimer("show"),this.autoHide!==!1&&this.delayHide())},delayHide:function(){this.hidden||this.hideTimer||(this.hideTimer=this.hide.defer(this.hideDelay,this))},hide:function(){this.clearTimer("dismiss"),this.lastActive=new Date,this.anchorEl&&this.anchorEl.hide(),Ext.ToolTip.superclass.hide.call(this),delete this.triggerElement},show:function(){this.anchor&&(this.showAt([-1e3,-1e3]),this.origConstrainPosition=this.constrainPosition,this.constrainPosition=!1,this.anchor=this.origAnchor),this.showAt(this.getTargetXY()),this.anchor?(this.anchorEl.show(),this.syncAnchor(),this.constrainPosition=this.origConstrainPosition):this.anchorEl.hide()},showAt:function(e){this.lastActive=new Date,this.clearTimers(),Ext.ToolTip.superclass.showAt.call(this,e),this.dismissDelay&&this.autoHide!==!1&&(this.dismissTimer=this.hide.defer(this.dismissDelay,this)),this.anchor&&!this.anchorEl.isVisible()?(this.syncAnchor(),this.anchorEl.show()):this.anchorEl.hide()},syncAnchor:function(){var e,t,i;switch(this.tipAnchor.charAt(0)){case"t":e="b",t="tl",i=[20+this.anchorOffset,2];break;case"r":e="l",t="tr",i=[-2,11+this.anchorOffset];break;case"b":e="t",t="bl",i=[20+this.anchorOffset,-2];break;default:e="r",t="tl",i=[2,11+this.anchorOffset]}this.anchorEl.alignTo(this.el,e+"-"+t,i)},setPagePosition:function(e,t){Ext.ToolTip.superclass.setPagePosition.call(this,e,t),this.anchor&&this.syncAnchor()},clearTimer:function(e){e+="Timer",clearTimeout(this[e]),delete this[e]},clearTimers:function(){this.clearTimer("show"),this.clearTimer("dismiss"),this.clearTimer("hide")},onShow:function(){Ext.ToolTip.superclass.onShow.call(this),Ext.getDoc().on("mousedown",this.onDocMouseDown,this)},onHide:function(){Ext.ToolTip.superclass.onHide.call(this),Ext.getDoc().un("mousedown",this.onDocMouseDown,this)
},onDocMouseDown:function(e){this.autoHide===!0||this.closable||e.within(this.el.dom)||(this.disable(),this.doEnable.defer(100,this))},doEnable:function(){this.isDestroyed||this.enable()},onDisable:function(){this.clearTimers(),this.hide()},adjustPosition:function(e,t){if(this.constrainPosition){var i=this.targetXY[1],s=this.getSize().height;i>=t&&t+s>=i&&(t=i-s-5)}return{x:e,y:t}},beforeDestroy:function(){this.clearTimers(),Ext.destroy(this.anchorEl),delete this.anchorEl,delete this.target,delete this.anchorTarget,delete this.triggerElement,Ext.ToolTip.superclass.beforeDestroy.call(this)},onDestroy:function(){Ext.getDoc().un("mousedown",this.onDocMouseDown,this),Ext.ToolTip.superclass.onDestroy.call(this)}}),Ext.reg("tooltip",Ext.ToolTip),Ext.QuickTip=Ext.extend(Ext.ToolTip,{interceptTitles:!1,tagConfig:{namespace:"ext",attribute:"qtip",width:"qwidth",target:"target",title:"qtitle",hide:"hide",cls:"qclass",align:"qalign",anchor:"anchor"},initComponent:function(){this.target=this.target||Ext.getDoc(),this.targets=this.targets||{},Ext.QuickTip.superclass.initComponent.call(this)},register:function(e){for(var t=Ext.isArray(e)?e:arguments,i=0,s=t.length;s>i;i++){var n=t[i],r=n.target;if(r)if(Ext.isArray(r))for(var a=0,o=r.length;o>a;a++)this.targets[Ext.id(r[a])]=n;else this.targets[Ext.id(r)]=n}},unregister:function(e){delete this.targets[Ext.id(e)]},cancelShow:function(e){var t=this.activeTarget;e=Ext.get(e).dom,this.isVisible()?t&&t.el==e&&this.hide():t&&t.el==e&&this.clearTimer("show")},getTipCfg:function(e){var t,i,s=e.getTarget();return this.interceptTitles&&s.title&&Ext.isString(s.title)?(t=s.title,s.qtip=t,s.removeAttribute("title"),e.preventDefault()):(i=this.tagConfig,t=s.qtip||Ext.fly(s).getAttribute(i.attribute,i.namespace)),t},onTargetOver:function(e){if(!this.disabled){this.targetXY=e.getXY();var t=e.getTarget();if(t&&1===t.nodeType&&t!=document&&t!=document.body){if(this.activeTarget&&(t==this.activeTarget.el||Ext.fly(this.activeTarget.el).contains(t)))return this.clearTimer("hide"),this.show(),void 0;if(t&&this.targets[t.id])return this.activeTarget=this.targets[t.id],this.activeTarget.el=t,this.anchor=this.activeTarget.anchor,this.anchor&&(this.anchorTarget=t),this.delayShow(),void 0;var i,s=Ext.fly(t),n=this.tagConfig,r=n.namespace;if(i=this.getTipCfg(e)){var a=s.getAttribute(n.hide,r);this.activeTarget={el:t,text:i,width:s.getAttribute(n.width,r),autoHide:"user"!=a&&"false"!==a,title:s.getAttribute(n.title,r),cls:s.getAttribute(n.cls,r),align:s.getAttribute(n.align,r)},this.anchor=s.getAttribute(n.anchor,r),this.anchor&&(this.anchorTarget=t),this.delayShow()}}}},onTargetOut:function(e){this.activeTarget&&e.within(this.activeTarget.el)&&!this.getTipCfg(e)||(this.clearTimer("show"),this.autoHide!==!1&&this.delayHide())},showAt:function(e){var t=this.activeTarget;t&&(this.rendered||(this.render(Ext.getBody()),this.activeTarget=t),t.width?(this.setWidth(t.width),this.body.setWidth(this.adjustBodyWidth(t.width-this.getFrameWidth())),this.measureWidth=!1):this.measureWidth=!0,this.setTitle(t.title||""),this.body.update(t.text),this.autoHide=t.autoHide,this.dismissDelay=t.dismissDelay||this.dismissDelay,this.lastCls&&(this.el.removeClass(this.lastCls),delete this.lastCls),t.cls&&(this.el.addClass(t.cls),this.lastCls=t.cls),this.anchor?this.constrainPosition=!1:t.align?(e=this.el.getAlignToXY(t.el,t.align),this.constrainPosition=!1):this.constrainPosition=!0),Ext.QuickTip.superclass.showAt.call(this,e)},hide:function(){delete this.activeTarget,Ext.QuickTip.superclass.hide.call(this)}}),Ext.reg("quicktip",Ext.QuickTip),Ext.QuickTips=function(){var e,t=!1;return{init:function(i){if(!e){if(!Ext.isReady)return Ext.onReady(function(){Ext.QuickTips.init(i)}),void 0;e=new Ext.QuickTip({elements:"header,body",disabled:t}),i!==!1&&e.render(Ext.getBody())}},ddDisable:function(){e&&!t&&e.disable()},ddEnable:function(){e&&!t&&e.enable()},enable:function(){e&&e.enable(),t=!1},disable:function(){e&&e.disable(),t=!0},isEnabled:function(){return void 0!==e&&!e.disabled},getQuickTip:function(){return e},register:function(){e.register.apply(e,arguments)},unregister:function(){e.unregister.apply(e,arguments)},tips:function(){e.register.apply(e,arguments)}}}(),Ext.slider.Tip=Ext.extend(Ext.Tip,{minWidth:10,offsets:[0,-10],init:function(e){e.on({scope:this,dragstart:this.onSlide,drag:this.onSlide,dragend:this.hide,destroy:this.destroy})},onSlide:function(e,t,i){this.show(),this.body.update(this.getText(i)),this.doAutoWidth(),this.el.alignTo(i.el,"b-t?",this.offsets)},getText:function(e){return String(e.value)}}),Ext.ux.SliderTip=Ext.slider.Tip,Ext.tree.TreePanel=Ext.extend(Ext.Panel,{rootVisible:!0,animate:Ext.enableFx,lines:!0,enableDD:!1,hlDrop:Ext.enableFx,pathSeparator:"/",bubbleEvents:[],initComponent:function(){Ext.tree.TreePanel.superclass.initComponent.call(this),this.eventModel||(this.eventModel=new Ext.tree.TreeEventModel(this));var e=this.loader;if(e?Ext.isObject(e)&&!e.load&&(e=new Ext.tree.TreeLoader(e)):e=new Ext.tree.TreeLoader({dataUrl:this.dataUrl,requestMethod:this.requestMethod}),this.loader=e,this.nodeHash={},this.root){var t=this.root;delete this.root,this.setRootNode(t)}this.addEvents("append","remove","movenode","insert","beforeappend","beforeremove","beforemovenode","beforeinsert","beforeload","load","textchange","beforeexpandnode","beforecollapsenode","expandnode","disabledchange","collapsenode","beforeclick","click","containerclick","checkchange","beforedblclick","dblclick","containerdblclick","contextmenu","containercontextmenu","beforechildrenrendered","startdrag","enddrag","dragdrop","beforenodedrop","nodedrop","nodedragover"),this.singleExpand&&this.on("beforeexpandnode",this.restrictExpand,this)},proxyNodeEvent:function(e,t,i,s,n,r,a){return("collapse"==e||"expand"==e||"beforecollapse"==e||"beforeexpand"==e||"move"==e||"beforemove"==e)&&(e+="node"),this.fireEvent(e,t,i,s,n,r,a)},getRootNode:function(){return this.root},setRootNode:function(e){if(this.destroyRoot(),e.render||(e=this.loader.createNode(e)),this.root=e,e.ownerTree=this,e.isRoot=!0,this.registerNode(e),!this.rootVisible){var t=e.attributes.uiProvider;e.ui=t?new t(e):new Ext.tree.RootTreeNodeUI(e)}return this.innerCt&&(this.clearInnerCt(),this.renderRoot()),e},clearInnerCt:function(){this.innerCt.update("")},renderRoot:function(){this.root.render(),this.rootVisible||this.root.renderChildren()},getNodeById:function(e){return this.nodeHash[e]},registerNode:function(e){this.nodeHash[e.id]=e},unregisterNode:function(e){delete this.nodeHash[e.id]},toString:function(){return"[Tree"+(this.id?" "+this.id:"")+"]"},restrictExpand:function(e){var t=e.parentNode;t&&(t.expandedChild&&t.expandedChild.parentNode==t&&t.expandedChild.collapse(),t.expandedChild=e)},getChecked:function(e,t){t=t||this.root;var i=[],s=function(){this.attributes.checked&&i.push(e?"id"==e?this.id:this.attributes[e]:this)};return t.cascade(s),i},getLoader:function(){return this.loader},expandAll:function(){this.root.expand(!0)},collapseAll:function(){this.root.collapse(!0)},getSelectionModel:function(){return this.selModel||(this.selModel=new Ext.tree.DefaultSelectionModel),this.selModel},expandPath:function(e,t,i){if(Ext.isEmpty(e))return i&&i(!1,void 0),void 0;t=t||"id";var s=e.split(this.pathSeparator),n=this.root;if(n.attributes[t]!=s[1])return i&&i(!1,null),void 0;var r=1,a=function(){if(++r==s.length)return i&&i(!0,n),void 0;var e=n.findChild(t,s[r]);return e?(n=e,e.expand(!1,!1,a),void 0):(i&&i(!1,n),void 0)};n.expand(!1,!1,a)},selectPath:function(e,t,i){if(Ext.isEmpty(e))return i&&i(!1,void 0),void 0;t=t||"id";var s=e.split(this.pathSeparator),n=s.pop();if(s.length>1){var r=function(e,s){if(e&&s){var r=s.findChild(t,n);r?(r.select(),i&&i(!0,r)):i&&i(!1,r)}else i&&i(!1,r)};this.expandPath(s.join(this.pathSeparator),t,r)}else this.root.select(),i&&i(!0,this.root)},getTreeEl:function(){return this.body},onRender:function(e,t){Ext.tree.TreePanel.superclass.onRender.call(this,e,t),this.el.addClass("x-tree"),this.innerCt=this.body.createChild({tag:"ul",cls:"x-tree-root-ct "+(this.useArrows?"x-tree-arrows":this.lines?"x-tree-lines":"x-tree-no-lines")})},initEvents:function(){Ext.tree.TreePanel.superclass.initEvents.call(this),this.containerScroll&&Ext.dd.ScrollManager.register(this.body),!this.enableDD&&!this.enableDrop||this.dropZone||(this.dropZone=new Ext.tree.TreeDropZone(this,this.dropConfig||{ddGroup:this.ddGroup||"TreeDD",appendOnly:this.ddAppendOnly===!0})),!this.enableDD&&!this.enableDrag||this.dragZone||(this.dragZone=new Ext.tree.TreeDragZone(this,this.dragConfig||{ddGroup:this.ddGroup||"TreeDD",scroll:this.ddScroll})),this.getSelectionModel().init(this)},afterRender:function(){Ext.tree.TreePanel.superclass.afterRender.call(this),this.renderRoot()},beforeDestroy:function(){this.rendered&&(Ext.dd.ScrollManager.unregister(this.body),Ext.destroy(this.dropZone,this.dragZone)),this.destroyRoot(),Ext.destroy(this.loader),this.nodeHash=this.root=this.loader=null,Ext.tree.TreePanel.superclass.beforeDestroy.call(this)},destroyRoot:function(){this.root&&this.root.destroy&&this.root.destroy(!0)}}),Ext.tree.TreePanel.nodeTypes={},Ext.reg("treepanel",Ext.tree.TreePanel),Ext.tree.TreeEventModel=function(e){this.tree=e,this.tree.on("render",this.initEvents,this)},Ext.tree.TreeEventModel.prototype={initEvents:function(){var e=this.tree;e.trackMouseOver!==!1&&e.mon(e.innerCt,{scope:this,mouseover:this.delegateOver,mouseout:this.delegateOut}),e.mon(e.getTreeEl(),{scope:this,click:this.delegateClick,dblclick:this.delegateDblClick,contextmenu:this.delegateContextMenu})},getNode:function(e){var t;if(t=e.getTarget(".x-tree-node-el",10)){var i=Ext.fly(t,"_treeEvents").getAttribute("tree-node-id","ext");if(i)return this.tree.getNodeById(i)}return null},getNodeTarget:function(e){var t=e.getTarget(".x-tree-node-icon",1);return t||(t=e.getTarget(".x-tree-node-el",6)),t},delegateOut:function(e,t){if(this.beforeEvent(e)){if(e.getTarget(".x-tree-ec-icon",1)){var i=this.getNode(e);this.onIconOut(e,i),i==this.lastEcOver&&delete this.lastEcOver}(t=this.getNodeTarget(e))&&!e.within(t,!0)&&this.onNodeOut(e,this.getNode(e))}},delegateOver:function(e,t){this.beforeEvent(e)&&(Ext.isGecko&&!this.trackingDoc&&(Ext.getBody().on("mouseover",this.trackExit,this),this.trackingDoc=!0),this.lastEcOver&&(this.onIconOut(e,this.lastEcOver),delete this.lastEcOver),e.getTarget(".x-tree-ec-icon",1)&&(this.lastEcOver=this.getNode(e),this.onIconOver(e,this.lastEcOver)),(t=this.getNodeTarget(e))&&this.onNodeOver(e,this.getNode(e)))},trackExit:function(e){this.lastOverNode&&(this.lastOverNode.ui&&!e.within(this.lastOverNode.ui.getEl())&&this.onNodeOut(e,this.lastOverNode),delete this.lastOverNode,Ext.getBody().un("mouseover",this.trackExit,this),this.trackingDoc=!1)},delegateClick:function(e){this.beforeEvent(e)?e.getTarget("input[type=checkbox]",1)?this.onCheckboxClick(e,this.getNode(e)):e.getTarget(".x-tree-ec-icon",1)?this.onIconClick(e,this.getNode(e)):this.getNodeTarget(e)&&this.onNodeClick(e,this.getNode(e)):this.checkContainerEvent(e,"click")},delegateDblClick:function(e){this.beforeEvent(e)?this.getNodeTarget(e)&&this.onNodeDblClick(e,this.getNode(e)):this.checkContainerEvent(e,"dblclick")},delegateContextMenu:function(e){this.beforeEvent(e)?this.getNodeTarget(e)&&this.onNodeContextMenu(e,this.getNode(e)):this.checkContainerEvent(e,"contextmenu")},checkContainerEvent:function(e,t){return this.disabled?(e.stopEvent(),!1):(this.onContainerEvent(e,t),void 0)},onContainerEvent:function(e,t){this.tree.fireEvent("container"+t,this.tree,e)},onNodeClick:function(e,t){t.ui.onClick(e)},onNodeOver:function(e,t){this.lastOverNode=t,t.ui.onOver(e)},onNodeOut:function(e,t){t.ui.onOut(e)},onIconOver:function(e,t){t.ui.addClass("x-tree-ec-over")},onIconOut:function(e,t){t.ui.removeClass("x-tree-ec-over")},onIconClick:function(e,t){t.ui.ecClick(e)},onCheckboxClick:function(e,t){t.ui.onCheckChange(e)},onNodeDblClick:function(e,t){t.ui.onDblClick(e)},onNodeContextMenu:function(e,t){t.ui.onContextMenu(e)},beforeEvent:function(e){var t=this.getNode(e);return!this.disabled&&t&&t.ui?!0:(e.stopEvent(),!1)},disable:function(){this.disabled=!0},enable:function(){this.disabled=!1}},Ext.tree.DefaultSelectionModel=Ext.extend(Ext.util.Observable,{constructor:function(e){this.selNode=null,this.addEvents("selectionchange","beforeselect"),Ext.apply(this,e),Ext.tree.DefaultSelectionModel.superclass.constructor.call(this)},init:function(e){this.tree=e,e.mon(e.getTreeEl(),"keydown",this.onKeyDown,this),e.on("click",this.onNodeClick,this)},onNodeClick:function(e){this.select(e)},select:function(e,t){if(!Ext.fly(e.ui.wrap).isVisible()&&t)return t.call(this,e);var i=this.selNode;return e==i?e.ui.onSelectedChange(!0):this.fireEvent("beforeselect",this,e,i)!==!1&&(i&&i.ui&&i.ui.onSelectedChange(!1),this.selNode=e,e.ui.onSelectedChange(!0),this.fireEvent("selectionchange",this,e,i)),e},unselect:function(e,t){this.selNode==e&&this.clearSelections(t)},clearSelections:function(e){var t=this.selNode;return t&&(t.ui.onSelectedChange(!1),this.selNode=null,e!==!0&&this.fireEvent("selectionchange",this,null)),t},getSelectedNode:function(){return this.selNode},isSelected:function(e){return this.selNode==e},selectPrevious:function(e){if(!(e=e||this.selNode||this.lastSelNode))return null;var t=e.previousSibling;if(t){if(!t.isExpanded()||t.childNodes.length<1)return this.select(t,this.selectPrevious);for(var i=t.lastChild;i&&i.isExpanded()&&Ext.fly(i.ui.wrap).isVisible()&&i.childNodes.length>0;)i=i.lastChild;return this.select(i,this.selectPrevious)}return!e.parentNode||!this.tree.rootVisible&&e.parentNode.isRoot?null:this.select(e.parentNode,this.selectPrevious)},selectNext:function(e){if(!(e=e||this.selNode||this.lastSelNode))return null;if(e.firstChild&&e.isExpanded()&&Ext.fly(e.ui.wrap).isVisible())return this.select(e.firstChild,this.selectNext);if(e.nextSibling)return this.select(e.nextSibling,this.selectNext);if(e.parentNode){var t=null;return e.parentNode.bubble(function(){return this.nextSibling?(t=this.getOwnerTree().selModel.select(this.nextSibling,this.selectNext),!1):void 0}),t}return null},onKeyDown:function(e){var t=this.selNode||this.lastSelNode;if(t){var i=e.getKey();switch(i){case e.DOWN:e.stopEvent(),this.selectNext();break;case e.UP:e.stopEvent(),this.selectPrevious();break;case e.RIGHT:e.preventDefault(),t.hasChildNodes()&&(t.isExpanded()?t.firstChild&&this.select(t.firstChild,e):t.expand());break;case e.LEFT:e.preventDefault(),t.hasChildNodes()&&t.isExpanded()?t.collapse():t.parentNode&&(this.tree.rootVisible||t.parentNode!=this.tree.getRootNode())&&this.select(t.parentNode,e)}}}}),Ext.tree.MultiSelectionModel=Ext.extend(Ext.util.Observable,{constructor:function(e){this.selNodes=[],this.selMap={},this.addEvents("selectionchange"),Ext.apply(this,e),Ext.tree.MultiSelectionModel.superclass.constructor.call(this)},init:function(e){this.tree=e,e.mon(e.getTreeEl(),"keydown",this.onKeyDown,this),e.on("click",this.onNodeClick,this)},onNodeClick:function(e,t){t.ctrlKey&&this.isSelected(e)?this.unselect(e):this.select(e,t,t.ctrlKey)},select:function(e,t,i){return i!==!0&&this.clearSelections(!0),this.isSelected(e)?(this.lastSelNode=e,e):(this.selNodes.push(e),this.selMap[e.id]=e,this.lastSelNode=e,e.ui.onSelectedChange(!0),this.fireEvent("selectionchange",this,this.selNodes),e)},unselect:function(e){if(this.selMap[e.id]){e.ui.onSelectedChange(!1);var t=this.selNodes,i=t.indexOf(e);-1!=i&&this.selNodes.splice(i,1),delete this.selMap[e.id],this.fireEvent("selectionchange",this,this.selNodes)}},clearSelections:function(e){var t=this.selNodes;if(t.length>0){for(var i=0,s=t.length;s>i;i++)t[i].ui.onSelectedChange(!1);this.selNodes=[],this.selMap={},e!==!0&&this.fireEvent("selectionchange",this,this.selNodes)}},isSelected:function(e){return this.selMap[e.id]?!0:!1},getSelectedNodes:function(){return this.selNodes.concat([])},onKeyDown:Ext.tree.DefaultSelectionModel.prototype.onKeyDown,selectNext:Ext.tree.DefaultSelectionModel.prototype.selectNext,selectPrevious:Ext.tree.DefaultSelectionModel.prototype.selectPrevious}),Ext.data.Tree=Ext.extend(Ext.util.Observable,{constructor:function(e){this.nodeHash={},this.root=null,e&&this.setRootNode(e),this.addEvents("append","remove","move","insert","beforeappend","beforeremove","beforemove","beforeinsert"),Ext.data.Tree.superclass.constructor.call(this)},pathSeparator:"/",proxyNodeEvent:function(){return this.fireEvent.apply(this,arguments)},getRootNode:function(){return this.root},setRootNode:function(e){return this.root=e,e.ownerTree=this,e.isRoot=!0,this.registerNode(e),e},getNodeById:function(e){return this.nodeHash[e]},registerNode:function(e){this.nodeHash[e.id]=e},unregisterNode:function(e){delete this.nodeHash[e.id]},toString:function(){return"[Tree"+(this.id?" "+this.id:"")+"]"}}),Ext.data.Node=Ext.extend(Ext.util.Observable,{constructor:function(e){this.attributes=e||{},this.leaf=this.attributes.leaf,this.id=this.attributes.id,this.id||(this.id=Ext.id(null,"xnode-"),this.attributes.id=this.id),this.childNodes=[],this.parentNode=null,this.firstChild=null,this.lastChild=null,this.previousSibling=null,this.nextSibling=null,this.addEvents({append:!0,remove:!0,move:!0,insert:!0,beforeappend:!0,beforeremove:!0,beforemove:!0,beforeinsert:!0}),this.listeners=this.attributes.listeners,Ext.data.Node.superclass.constructor.call(this)},fireEvent:function(){if(Ext.data.Node.superclass.fireEvent.apply(this,arguments)===!1)return!1;var e=this.getOwnerTree();return e&&e.proxyNodeEvent.apply(e,arguments)===!1?!1:!0},isLeaf:function(){return this.leaf===!0},setFirstChild:function(e){this.firstChild=e},setLastChild:function(e){this.lastChild=e},isLast:function(){return this.parentNode?this.parentNode.lastChild==this:!0},isFirst:function(){return this.parentNode?this.parentNode.firstChild==this:!0},hasChildNodes:function(){return!this.isLeaf()&&this.childNodes.length>0},isExpandable:function(){return this.attributes.expandable||this.hasChildNodes()},appendChild:function(e){var t=!1;if(Ext.isArray(e)?t=e:arguments.length>1&&(t=arguments),!t){if(this.fireEvent("beforeappend",this.ownerTree,this,e)===!1)return!1;var i=this.childNodes.length,s=e.parentNode;if(s){if(e.fireEvent("beforemove",e.getOwnerTree(),e,s,this,i)===!1)return!1;s.removeChild(e)}i=this.childNodes.length,0===i&&this.setFirstChild(e),this.childNodes.push(e),e.parentNode=this;var n=this.childNodes[i-1];return n?(e.previousSibling=n,n.nextSibling=e):e.previousSibling=null,e.nextSibling=null,this.setLastChild(e),e.setOwnerTree(this.getOwnerTree()),this.fireEvent("append",this.ownerTree,this,e,i),s&&e.fireEvent("move",this.ownerTree,e,s,this,i),e}for(var r=0,a=t.length;a>r;r++)this.appendChild(t[r])},removeChild:function(e,t){var i=this.childNodes.indexOf(e);return-1==i?!1:this.fireEvent("beforeremove",this.ownerTree,this,e)===!1?!1:(this.childNodes.splice(i,1),e.previousSibling&&(e.previousSibling.nextSibling=e.nextSibling),e.nextSibling&&(e.nextSibling.previousSibling=e.previousSibling),this.firstChild==e&&this.setFirstChild(e.nextSibling),this.lastChild==e&&this.setLastChild(e.previousSibling),this.fireEvent("remove",this.ownerTree,this,e),t?e.destroy(!0):e.clear(),e)},clear:function(e){this.setOwnerTree(null,e),this.parentNode=this.previousSibling=this.nextSibling=null,e&&(this.firstChild=this.lastChild=null)},destroy:function(e){e===!0?(this.purgeListeners(),this.clear(!0),Ext.each(this.childNodes,function(e){e.destroy(!0)}),this.childNodes=null):this.remove(!0)},insertBefore:function(e,t){if(!t)return this.appendChild(e);if(e==t)return!1;if(this.fireEvent("beforeinsert",this.ownerTree,this,e,t)===!1)return!1;var i=this.childNodes.indexOf(t),s=e.parentNode,n=i;if(s==this&&this.childNodes.indexOf(e)<i&&n--,s){if(e.fireEvent("beforemove",e.getOwnerTree(),e,s,this,i,t)===!1)return!1;s.removeChild(e)}0===n&&this.setFirstChild(e),this.childNodes.splice(n,0,e),e.parentNode=this;var r=this.childNodes[n-1];return r?(e.previousSibling=r,r.nextSibling=e):e.previousSibling=null,e.nextSibling=t,t.previousSibling=e,e.setOwnerTree(this.getOwnerTree()),this.fireEvent("insert",this.ownerTree,this,e,t),s&&e.fireEvent("move",this.ownerTree,e,s,this,n,t),e},remove:function(e){return this.parentNode&&this.parentNode.removeChild(this,e),this},removeAll:function(e){for(var t,i=this.childNodes;t=i[0];)this.removeChild(t,e);return this},item:function(e){return this.childNodes[e]},replaceChild:function(e,t){var i=t?t.nextSibling:null;return this.removeChild(t),this.insertBefore(e,i),t},indexOf:function(e){return this.childNodes.indexOf(e)},getOwnerTree:function(){if(!this.ownerTree)for(var e=this;e;){if(e.ownerTree){this.ownerTree=e.ownerTree;break}e=e.parentNode}return this.ownerTree},getDepth:function(){for(var e=0,t=this;t.parentNode;)++e,t=t.parentNode;return e},setOwnerTree:function(e,t){e!=this.ownerTree&&(this.ownerTree&&this.ownerTree.unregisterNode(this),this.ownerTree=e,t!==!0&&Ext.each(this.childNodes,function(t){t.setOwnerTree(e)}),e&&e.registerNode(this))},setId:function(e){if(e!==this.id){var t=this.ownerTree;t&&t.unregisterNode(this),this.id=this.attributes.id=e,t&&t.registerNode(this),this.onIdChange(e)}},onIdChange:Ext.emptyFn,getPath:function(e){e=e||"id";for(var t=this.parentNode,i=[this.attributes[e]];t;)i.unshift(t.attributes[e]),t=t.parentNode;var s=this.getOwnerTree().pathSeparator;return s+i.join(s)},bubble:function(e,t,i){for(var s=this;s&&e.apply(t||s,i||[s])!==!1;)s=s.parentNode},cascade:function(e,t,i){if(e.apply(t||this,i||[this])!==!1)for(var s=this.childNodes,n=0,r=s.length;r>n;n++)s[n].cascade(e,t,i)},eachChild:function(e,t,i){for(var s=this.childNodes,n=0,r=s.length;r>n&&e.apply(t||s[n],i||[s[n]])!==!1;n++);},findChild:function(e,t,i){return this.findChildBy(function(){return this.attributes[e]==t},null,i)},findChildBy:function(e,t,i){for(var s,n,r=this.childNodes,a=r.length,o=0;a>o;o++){if(s=r[o],e.call(t||s,s)===!0)return s;if(i&&(n=s.findChildBy(e,t,i),null!=n))return n}return null},sort:function(e,t){var i=this.childNodes,s=i.length;if(s>0){var n=t?function(){e.apply(t,arguments)}:e;i.sort(n);for(var r=0;s>r;r++){var a=i[r];a.previousSibling=i[r-1],a.nextSibling=i[r+1],0===r&&this.setFirstChild(a),r==s-1&&this.setLastChild(a)}}},contains:function(e){return e.isAncestor(this)},isAncestor:function(e){for(var t=this.parentNode;t;){if(t==e)return!0;t=t.parentNode}return!1},toString:function(){return"[Node"+(this.id?" "+this.id:"")+"]"}}),Ext.tree.TreeNode=Ext.extend(Ext.data.Node,{constructor:function(e){e=e||{},Ext.isString(e)&&(e={text:e}),this.childrenRendered=!1,this.rendered=!1,Ext.tree.TreeNode.superclass.constructor.call(this,e),this.expanded=e.expanded===!0,this.isTarget=e.isTarget!==!1,this.draggable=e.draggable!==!1&&e.allowDrag!==!1,this.allowChildren=e.allowChildren!==!1&&e.allowDrop!==!1,this.text=e.text,this.disabled=e.disabled===!0,this.hidden=e.hidden===!0,this.addEvents("textchange","beforeexpand","beforecollapse","expand","disabledchange","collapse","beforeclick","click","checkchange","beforedblclick","dblclick","contextmenu","beforechildrenrendered");var t=this.attributes.uiProvider||this.defaultUI||Ext.tree.TreeNodeUI;this.ui=new t(this)},preventHScroll:!0,isExpanded:function(){return this.expanded},getUI:function(){return this.ui},getLoader:function(){var e;return this.loader||((e=this.getOwnerTree())&&e.loader?e.loader:this.loader=new Ext.tree.TreeLoader)},setFirstChild:function(e){var t=this.firstChild;Ext.tree.TreeNode.superclass.setFirstChild.call(this,e),this.childrenRendered&&t&&e!=t&&t.renderIndent(!0,!0),this.rendered&&this.renderIndent(!0,!0)},setLastChild:function(e){var t=this.lastChild;Ext.tree.TreeNode.superclass.setLastChild.call(this,e),this.childrenRendered&&t&&e!=t&&t.renderIndent(!0,!0),this.rendered&&this.renderIndent(!0,!0)},appendChild:function(e){e.render||Ext.isArray(e)||(e=this.getLoader().createNode(e));var t=Ext.tree.TreeNode.superclass.appendChild.call(this,e);return t&&this.childrenRendered&&t.render(),this.ui.updateExpandIcon(),t},removeChild:function(e,t){if(this.ownerTree.getSelectionModel().unselect(e),Ext.tree.TreeNode.superclass.removeChild.apply(this,arguments),!t){var i=e.ui.rendered;i&&e.ui.remove(),i&&this.childNodes.length<1?this.collapse(!1,!1):this.ui.updateExpandIcon(),this.firstChild||this.isHiddenRoot()||(this.childrenRendered=!1)}return e},insertBefore:function(e,t){e.render||(e=this.getLoader().createNode(e));var i=Ext.tree.TreeNode.superclass.insertBefore.call(this,e,t);return i&&t&&this.childrenRendered&&e.render(),this.ui.updateExpandIcon(),i},setText:function(e){var t=this.text;this.text=this.attributes.text=e,this.rendered&&this.ui.onTextChange(this,e,t),this.fireEvent("textchange",this,e,t)},setIconCls:function(e){var t=this.attributes.iconCls;this.attributes.iconCls=e,this.rendered&&this.ui.onIconClsChange(this,e,t)},setTooltip:function(e,t){this.attributes.qtip=e,this.attributes.qtipTitle=t,this.rendered&&this.ui.onTipChange(this,e,t)},setIcon:function(e){this.attributes.icon=e,this.rendered&&this.ui.onIconChange(this,e)},setHref:function(e,t){this.attributes.href=e,this.attributes.hrefTarget=t,this.rendered&&this.ui.onHrefChange(this,e,t)},setCls:function(e){var t=this.attributes.cls;this.attributes.cls=e,this.rendered&&this.ui.onClsChange(this,e,t)},select:function(){var e=this.getOwnerTree();e&&e.getSelectionModel().select(this)},unselect:function(e){var t=this.getOwnerTree();t&&t.getSelectionModel().unselect(this,e)},isSelected:function(){var e=this.getOwnerTree();return e?e.getSelectionModel().isSelected(this):!1},expand:function(e,t,i,s){if(this.expanded)this.runCallback(i,s||this,[this]);else{if(this.fireEvent("beforeexpand",this,e,t)===!1)return;if(this.childrenRendered||this.renderChildren(),this.expanded=!0,!this.isHiddenRoot()&&this.getOwnerTree().animate&&t!==!1||t)return this.ui.animExpand(function(){this.fireEvent("expand",this),this.runCallback(i,s||this,[this]),e===!0&&this.expandChildNodes(!0,!0)}.createDelegate(this)),void 0;this.ui.expand(),this.fireEvent("expand",this),this.runCallback(i,s||this,[this])}e===!0&&this.expandChildNodes(!0)},runCallback:function(e,t,i){Ext.isFunction(e)&&e.apply(t,i)},isHiddenRoot:function(){return this.isRoot&&!this.getOwnerTree().rootVisible},collapse:function(e,t,i,s){if(this.expanded&&!this.isHiddenRoot()){if(this.fireEvent("beforecollapse",this,e,t)===!1)return;if(this.expanded=!1,this.getOwnerTree().animate&&t!==!1||t)return this.ui.animCollapse(function(){this.fireEvent("collapse",this),this.runCallback(i,s||this,[this]),e===!0&&this.collapseChildNodes(!0)}.createDelegate(this)),void 0;this.ui.collapse(),this.fireEvent("collapse",this),this.runCallback(i,s||this,[this])}else this.expanded||this.runCallback(i,s||this,[this]);if(e===!0)for(var n=this.childNodes,r=0,a=n.length;a>r;r++)n[r].collapse(!0,!1)},delayedExpand:function(e){this.expandProcId||(this.expandProcId=this.expand.defer(e,this))},cancelExpand:function(){this.expandProcId&&clearTimeout(this.expandProcId),this.expandProcId=!1},toggle:function(){this.expanded?this.collapse():this.expand()},ensureVisible:function(e,t){var i=this.getOwnerTree();i.expandPath(this.parentNode?this.parentNode.getPath():this.getPath(),!1,function(){var s=i.getNodeById(this.id);i.getTreeEl().scrollChildIntoView(s.ui.anchor),this.runCallback(e,t||this,[this])}.createDelegate(this))},expandChildNodes:function(e,t){var i,s=this.childNodes,n=s.length;for(i=0;n>i;i++)s[i].expand(e,t)},collapseChildNodes:function(e){for(var t=this.childNodes,i=0,s=t.length;s>i;i++)t[i].collapse(e)},disable:function(){this.disabled=!0,this.unselect(),this.rendered&&this.ui.onDisableChange&&this.ui.onDisableChange(this,!0),this.fireEvent("disabledchange",this,!0)},enable:function(){this.disabled=!1,this.rendered&&this.ui.onDisableChange&&this.ui.onDisableChange(this,!1),this.fireEvent("disabledchange",this,!1)},renderChildren:function(e){e!==!1&&this.fireEvent("beforechildrenrendered",this);for(var t=this.childNodes,i=0,s=t.length;s>i;i++)t[i].render(!0);this.childrenRendered=!0},sort:function(){if(Ext.tree.TreeNode.superclass.sort.apply(this,arguments),this.childrenRendered)for(var e=this.childNodes,t=0,i=e.length;i>t;t++)e[t].render(!0)},render:function(e){this.ui.render(e),this.rendered||(this.getOwnerTree().registerNode(this),this.rendered=!0,this.expanded&&(this.expanded=!1,this.expand(!1,!1)))},renderIndent:function(e,t){if(t&&(this.ui.childIndent=null),this.ui.renderIndent(),e===!0&&this.childrenRendered)for(var i=this.childNodes,s=0,n=i.length;n>s;s++)i[s].renderIndent(!0,t)},beginUpdate:function(){this.childrenRendered=!1},endUpdate:function(){this.expanded&&this.rendered&&this.renderChildren()},destroy:function(e){e===!0&&this.unselect(!0),Ext.tree.TreeNode.superclass.destroy.call(this,e),Ext.destroy(this.ui,this.loader),this.ui=this.loader=null},onIdChange:function(e){this.ui.onIdChange(e)}}),Ext.tree.TreePanel.nodeTypes.node=Ext.tree.TreeNode,Ext.tree.AsyncTreeNode=function(e){this.loaded=e&&e.loaded===!0,this.loading=!1,Ext.tree.AsyncTreeNode.superclass.constructor.apply(this,arguments),this.addEvents("beforeload","load")},Ext.extend(Ext.tree.AsyncTreeNode,Ext.tree.TreeNode,{expand:function(e,t,i,s){if(this.loading){var n,r=function(){this.loading||(clearInterval(n),this.expand(e,t,i,s))}.createDelegate(this);return n=setInterval(r,200),void 0}if(!this.loaded){if(this.fireEvent("beforeload",this)===!1)return;this.loading=!0,this.ui.beforeLoad(this);var a=this.loader||this.attributes.loader||this.getOwnerTree().getLoader();if(a)return a.load(this,this.loadComplete.createDelegate(this,[e,t,i,s]),this),void 0}Ext.tree.AsyncTreeNode.superclass.expand.call(this,e,t,i,s)},isLoading:function(){return this.loading},loadComplete:function(e,t,i,s){this.loading=!1,this.loaded=!0,this.ui.afterLoad(this),this.fireEvent("load",this),this.expand(e,t,i,s)},isLoaded:function(){return this.loaded},hasChildNodes:function(){return this.isLeaf()||this.loaded?Ext.tree.AsyncTreeNode.superclass.hasChildNodes.call(this):!0},reload:function(e,t){for(this.collapse(!1,!1);this.firstChild;)this.removeChild(this.firstChild).destroy();this.childrenRendered=!1,this.loaded=!1,this.isHiddenRoot()&&(this.expanded=!1),this.expand(!1,!1,e,t)}}),Ext.tree.TreePanel.nodeTypes.async=Ext.tree.AsyncTreeNode,Ext.tree.TreeNodeUI=Ext.extend(Object,{constructor:function(e){Ext.apply(this,{node:e,rendered:!1,animating:!1,wasLeaf:!0,ecc:"x-tree-ec-icon x-tree-elbow",emptyIcon:Ext.BLANK_IMAGE_URL})},removeChild:function(e){this.rendered&&this.ctNode.removeChild(e.ui.getEl())},beforeLoad:function(){this.addClass("x-tree-node-loading")},afterLoad:function(){this.removeClass("x-tree-node-loading")},onTextChange:function(e,t){this.rendered&&(this.textNode.innerHTML=t)},onIconClsChange:function(e,t,i){this.rendered&&Ext.fly(this.iconNode).replaceClass(i,t)},onIconChange:function(e,t){if(this.rendered){var i=Ext.isEmpty(t);this.iconNode.src=i?this.emptyIcon:t,Ext.fly(this.iconNode)[i?"removeClass":"addClass"]("x-tree-node-inline-icon")}},onTipChange:function(e,t,i){if(this.rendered){var s=Ext.isDefined(i);this.textNode.setAttributeNS?(this.textNode.setAttributeNS("ext","qtip",t),s&&this.textNode.setAttributeNS("ext","qtitle",i)):(this.textNode.setAttribute("ext:qtip",t),s&&this.textNode.setAttribute("ext:qtitle",i))}},onHrefChange:function(e,t,i){this.rendered&&(this.anchor.href=this.getHref(t),Ext.isDefined(i)&&(this.anchor.target=i))},onClsChange:function(e,t,i){this.rendered&&Ext.fly(this.elNode).replaceClass(i,t)},onDisableChange:function(e,t){this.disabled=t,this.checkbox&&(this.checkbox.disabled=t),this[t?"addClass":"removeClass"]("x-tree-node-disabled")},onSelectedChange:function(e){e?(this.focus(),this.addClass("x-tree-selected")):this.removeClass("x-tree-selected")},onMove:function(e,t,i,s,n,r){if(this.childIndent=null,this.rendered){var a=s.ui.getContainer();if(!a)return this.holder=document.createElement("div"),this.holder.appendChild(this.wrap),void 0;var o=r?r.ui.getEl():null;o?a.insertBefore(this.wrap,o):a.appendChild(this.wrap),this.node.renderIndent(!0,i!=s)}},addClass:function(e){this.elNode&&Ext.fly(this.elNode).addClass(e)},removeClass:function(e){this.elNode&&Ext.fly(this.elNode).removeClass(e)},remove:function(){this.rendered&&(this.holder=document.createElement("div"),this.holder.appendChild(this.wrap))},fireEvent:function(){return this.node.fireEvent.apply(this.node,arguments)},initEvents:function(){this.node.on("move",this.onMove,this),this.node.disabled&&this.onDisableChange(this.node,!0),this.node.hidden&&this.hide();var e=this.node.getOwnerTree(),t=e.enableDD||e.enableDrag||e.enableDrop;!t||this.node.isRoot&&!e.rootVisible||Ext.dd.Registry.register(this.elNode,{node:this.node,handles:this.getDDHandles(),isHandle:!1})},getDDHandles:function(){return[this.iconNode,this.textNode,this.elNode]
},hide:function(){this.node.hidden=!0,this.wrap&&(this.wrap.style.display="none")},show:function(){this.node.hidden=!1,this.wrap&&(this.wrap.style.display="")},onContextMenu:function(e){(this.node.hasListener("contextmenu")||this.node.getOwnerTree().hasListener("contextmenu"))&&(e.preventDefault(),this.focus(),this.fireEvent("contextmenu",this.node,e))},onClick:function(e){if(this.dropping)return e.stopEvent(),void 0;if(this.fireEvent("beforeclick",this.node,e)!==!1){var t=e.getTarget("a");if(!this.disabled&&this.node.attributes.href&&t)return this.fireEvent("click",this.node,e),void 0;if(t&&e.ctrlKey&&e.stopEvent(),e.preventDefault(),this.disabled)return;this.node.attributes.singleClickExpand&&!this.animating&&this.node.isExpandable()&&this.node.toggle(),this.fireEvent("click",this.node,e)}else e.stopEvent()},onDblClick:function(e){e.preventDefault(),this.disabled||this.fireEvent("beforedblclick",this.node,e)!==!1&&(this.checkbox&&this.toggleCheck(),!this.animating&&this.node.isExpandable()&&this.node.toggle(),this.fireEvent("dblclick",this.node,e))},onOver:function(){this.addClass("x-tree-node-over")},onOut:function(){this.removeClass("x-tree-node-over")},onCheckChange:function(){var e=this.checkbox.checked;this.checkbox.defaultChecked=e,this.node.attributes.checked=e,this.fireEvent("checkchange",this.node,e)},ecClick:function(){!this.animating&&this.node.isExpandable()&&this.node.toggle()},startDrop:function(){this.dropping=!0},endDrop:function(){setTimeout(function(){this.dropping=!1}.createDelegate(this),50)},expand:function(){this.updateExpandIcon(),this.ctNode.style.display=""},focus:function(){if(this.node.preventHScroll)try{var e=this.node.getOwnerTree().getTreeEl().dom,t=e.scrollLeft;this.anchor.focus(),e.scrollLeft=t}catch(i){}else try{this.anchor.focus()}catch(i){}},toggleCheck:function(e){var t=this.checkbox;t&&(t.checked=void 0===e?!t.checked:e,this.onCheckChange())},blur:function(){try{this.anchor.blur()}catch(e){}},animExpand:function(e){var t=Ext.get(this.ctNode);return t.stopFx(),this.node.isExpandable()?(this.animating=!0,this.updateExpandIcon(),t.slideIn("t",{callback:function(){this.animating=!1,Ext.callback(e)},scope:this,duration:this.node.ownerTree.duration||.25}),void 0):(this.updateExpandIcon(),this.ctNode.style.display="",Ext.callback(e),void 0)},highlight:function(){var e=this.node.getOwnerTree();Ext.fly(this.wrap).highlight(e.hlColor||"C3DAF9",{endColor:e.hlBaseColor})},collapse:function(){this.updateExpandIcon(),this.ctNode.style.display="none"},animCollapse:function(e){var t=Ext.get(this.ctNode);t.enableDisplayMode("block"),t.stopFx(),this.animating=!0,this.updateExpandIcon(),t.slideOut("t",{callback:function(){this.animating=!1,Ext.callback(e)},scope:this,duration:this.node.ownerTree.duration||.25})},getContainer:function(){return this.ctNode},getEl:function(){return this.wrap},appendDDGhost:function(e){e.appendChild(this.elNode.cloneNode(!0))},getDDRepairXY:function(){return Ext.lib.Dom.getXY(this.iconNode)},onRender:function(){this.render()},render:function(e){var t=this.node,i=t.attributes,s=t.parentNode?t.parentNode.ui.getContainer():t.ownerTree.innerCt.dom;this.rendered?e===!0&&s.appendChild(this.wrap):(this.rendered=!0,this.renderElements(t,i,s,e),i.qtip?this.onTipChange(t,i.qtip,i.qtipTitle):i.qtipCfg&&(i.qtipCfg.target=Ext.id(this.textNode),Ext.QuickTips.register(i.qtipCfg)),this.initEvents(),this.node.expanded||this.updateExpandIcon(!0))},renderElements:function(e,t,i,s){this.indentMarkup=e.parentNode?e.parentNode.ui.getChildIndent():"";var n,r=Ext.isBoolean(t.checked),a=this.getHref(t.href),o=['<li class="x-tree-node"><div ext:tree-node-id="',e.id,'" class="x-tree-node-el x-tree-node-leaf x-unselectable ',t.cls,'" unselectable="on">','<span class="x-tree-node-indent">',this.indentMarkup,"</span>",'<img alt="" src="',this.emptyIcon,'" class="x-tree-ec-icon x-tree-elbow" />','<img alt="" src="',t.icon||this.emptyIcon,'" class="x-tree-node-icon',t.icon?" x-tree-node-inline-icon":"",t.iconCls?" "+t.iconCls:"",'" unselectable="on" />',r?'<input class="x-tree-node-cb" type="checkbox" '+(t.checked?'checked="checked" />':"/>"):"",'<a hidefocus="on" class="x-tree-node-anchor" href="',a,'" tabIndex="1" ',t.hrefTarget?' target="'+t.hrefTarget+'"':"",'><span unselectable="on">',e.text,"</span></a></div>",'<ul class="x-tree-node-ct" style="display:none;"></ul>',"</li>"].join("");this.wrap=s!==!0&&e.nextSibling&&(n=e.nextSibling.ui.getEl())?Ext.DomHelper.insertHtml("beforeBegin",n,o):Ext.DomHelper.insertHtml("beforeEnd",i,o),this.elNode=this.wrap.childNodes[0],this.ctNode=this.wrap.childNodes[1];var l=this.elNode.childNodes;this.indentNode=l[0],this.ecNode=l[1],this.iconNode=l[2];var h=3;r&&(this.checkbox=l[3],this.checkbox.defaultChecked=this.checkbox.checked,h++),this.anchor=l[h],this.textNode=l[h].firstChild},getHref:function(e){return Ext.isEmpty(e)?Ext.isGecko?"":"#":e},getAnchor:function(){return this.anchor},getTextEl:function(){return this.textNode},getIconEl:function(){return this.iconNode},isChecked:function(){return this.checkbox?this.checkbox.checked:!1},updateExpandIcon:function(){if(this.rendered){var e,t,i=this.node,s=i.isLast()?"x-tree-elbow-end":"x-tree-elbow",n=i.hasChildNodes();n||i.attributes.expandable?(i.expanded?(s+="-minus",e="x-tree-node-collapsed",t="x-tree-node-expanded"):(s+="-plus",e="x-tree-node-expanded",t="x-tree-node-collapsed"),this.wasLeaf&&(this.removeClass("x-tree-node-leaf"),this.wasLeaf=!1),(this.c1!=e||this.c2!=t)&&(Ext.fly(this.elNode).replaceClass(e,t),this.c1=e,this.c2=t)):this.wasLeaf||(Ext.fly(this.elNode).replaceClass("x-tree-node-expanded","x-tree-node-collapsed"),delete this.c1,delete this.c2,this.wasLeaf=!0);var r="x-tree-ec-icon "+s;this.ecc!=r&&(this.ecNode.className=r,this.ecc=r)}},onIdChange:function(e){this.rendered&&this.elNode.setAttribute("ext:tree-node-id",e)},getChildIndent:function(){if(!this.childIndent){for(var e=[],t=this.node;t;)(!t.isRoot||t.isRoot&&t.ownerTree.rootVisible)&&(t.isLast()?e.unshift('<img alt="" src="'+this.emptyIcon+'" class="x-tree-icon" />'):e.unshift('<img alt="" src="'+this.emptyIcon+'" class="x-tree-elbow-line" />')),t=t.parentNode;this.childIndent=e.join("")}return this.childIndent},renderIndent:function(){if(this.rendered){var e="",t=this.node.parentNode;t&&(e=t.ui.getChildIndent()),this.indentMarkup!=e&&(this.indentNode.innerHTML=e,this.indentMarkup=e),this.updateExpandIcon()}},destroy:function(){this.elNode&&Ext.dd.Registry.unregister(this.elNode.id),Ext.each(["textnode","anchor","checkbox","indentNode","ecNode","iconNode","elNode","ctNode","wrap","holder"],function(e){this[e]&&(Ext.fly(this[e]).remove(),delete this[e])},this),delete this.node}}),Ext.tree.RootTreeNodeUI=Ext.extend(Ext.tree.TreeNodeUI,{render:function(){if(!this.rendered){var e=this.node.ownerTree.innerCt.dom;this.node.expanded=!0,e.innerHTML='<div class="x-tree-root-node"></div>',this.wrap=this.ctNode=e.firstChild}},collapse:Ext.emptyFn,expand:Ext.emptyFn}),Ext.tree.TreeLoader=function(e){this.baseParams={},Ext.apply(this,e),this.addEvents("beforeload","load","loadexception"),Ext.tree.TreeLoader.superclass.constructor.call(this),Ext.isString(this.paramOrder)&&(this.paramOrder=this.paramOrder.split(/[\s,|]/))},Ext.extend(Ext.tree.TreeLoader,Ext.util.Observable,{uiProviders:{},clearOnLoad:!0,paramOrder:void 0,paramsAsHash:!1,nodeParameter:"node",directFn:void 0,load:function(e,t,i){if(this.clearOnLoad)for(;e.firstChild;)e.removeChild(e.firstChild);this.doPreload(e)?this.runCallback(t,i||e,[e]):(this.directFn||this.dataUrl||this.url)&&this.requestData(e,t,i||e)},doPreload:function(e){if(e.attributes.children){if(e.childNodes.length<1){var t=e.attributes.children;e.beginUpdate();for(var i=0,s=t.length;s>i;i++){var n=e.appendChild(this.createNode(t[i]));this.preloadChildren&&this.doPreload(n)}e.endUpdate()}return!0}return!1},getParams:function(e){var t=Ext.apply({},this.baseParams),i=this.nodeParameter,s=this.paramOrder;if(i&&(t[i]=e.id),this.directFn){var n=[e.id];if(s){i&&s.indexOf(i)>-1&&(n=[]);for(var r=0,a=s.length;a>r;r++)n.push(t[s[r]])}else this.paramsAsHash&&(n=[t]);return n}return t},requestData:function(e,t,i){if(this.fireEvent("beforeload",this,e,t)!==!1)if(this.directFn){var s=this.getParams(e);s.push(this.processDirectResponse.createDelegate(this,[{callback:t,node:e,scope:i}],!0)),this.directFn.apply(window,s)}else this.transId=Ext.Ajax.request({method:this.requestMethod,url:this.dataUrl||this.url,success:this.handleResponse,failure:this.handleFailure,scope:this,argument:{callback:t,node:e,scope:i},params:this.getParams(e)});else this.runCallback(t,i||e,[])},processDirectResponse:function(e,t,i){t.status?this.handleResponse({responseData:Ext.isArray(e)?e:null,responseText:e,argument:i}):this.handleFailure({argument:i})},runCallback:function(e,t,i){Ext.isFunction(e)&&e.apply(t,i)},isLoading:function(){return!!this.transId},abort:function(){this.isLoading()&&Ext.Ajax.abort(this.transId)},createNode:function(attr){return this.baseAttrs&&Ext.applyIf(attr,this.baseAttrs),this.applyLoader===!1||attr.loader||(attr.loader=this),Ext.isString(attr.uiProvider)&&(attr.uiProvider=this.uiProviders[attr.uiProvider]||eval(attr.uiProvider)),attr.nodeType?new Ext.tree.TreePanel.nodeTypes[attr.nodeType](attr):attr.leaf?new Ext.tree.TreeNode(attr):new Ext.tree.AsyncTreeNode(attr)},processResponse:function(e,t,i,s){var n=e.responseText;try{var r=e.responseData||Ext.decode(n);t.beginUpdate();for(var a=0,o=r.length;o>a;a++){var l=this.createNode(r[a]);l&&t.appendChild(l)}t.endUpdate(),this.runCallback(i,s||t,[t])}catch(h){this.handleFailure(e)}},handleResponse:function(e){this.transId=!1;var t=e.argument;this.processResponse(e,t.node,t.callback,t.scope),this.fireEvent("load",this,t.node,e)},handleFailure:function(e){this.transId=!1;var t=e.argument;this.fireEvent("loadexception",this,t.node,e),this.runCallback(t.callback,t.scope||t.node,[t.node])},destroy:function(){this.abort(),this.purgeListeners()}}),Ext.tree.TreeFilter=function(e,t){this.tree=e,this.filtered={},Ext.apply(this,t)},Ext.tree.TreeFilter.prototype={clearBlank:!1,reverse:!1,autoClear:!1,remove:!1,filter:function(e,t,i){t=t||"text";var s;if("string"==typeof e){var n=e.length;if(0==n&&this.clearBlank)return this.clear(),void 0;e=e.toLowerCase(),s=function(i){return i.attributes[t].substr(0,n).toLowerCase()==e}}else{if(!e.exec)throw"Illegal filter type, must be string or regex";s=function(i){return e.test(i.attributes[t])}}this.filterBy(s,null,i)},filterBy:function(e,t,i){i=i||this.tree.root,this.autoClear&&this.clear();var s=this.filtered,n=this.reverse,r=function(r){if(r==i)return!0;if(s[r.id])return!1;var a=e.call(t||r,r);return!a||n?(s[r.id]=r,r.ui.hide(),!1):!0};if(i.cascade(r),this.remove)for(var a in s)if("function"!=typeof a){var o=s[a];o&&o.parentNode&&o.parentNode.removeChild(o)}},clear:function(){this.tree;var e=this.filtered;for(var t in e)if("function"!=typeof t){var i=e[t];i&&i.ui.show()}this.filtered={}}},Ext.tree.TreeSorter=Ext.extend(Object,{constructor:function(e,t){Ext.apply(this,t),e.on({scope:this,beforechildrenrendered:this.doSort,append:this.updateSort,insert:this.updateSort,textchange:this.updateSortParent});var i=this.dir&&"desc"==this.dir.toLowerCase(),s=this.property||"text",n=this.sortType,r=this.folderSort,a=this.caseSensitive===!0,o=this.leafAttr||"leaf";Ext.isString(n)&&(n=Ext.data.SortTypes[n]),this.sortFn=function(e,t){var l=e.attributes,h=t.attributes;if(r){if(l[o]&&!h[o])return 1;if(!l[o]&&h[o])return-1}var u=l[s],c=h[s],d=n?n(u):a?u:u.toUpperCase(),p=n?n(c):a?c:c.toUpperCase();return p>d?i?1:-1:d>p?i?-1:1:0}},doSort:function(e){e.sort(this.sortFn)},updateSort:function(e,t){t.childrenRendered&&this.doSort.defer(1,this,[t])},updateSortParent:function(e){var t=e.parentNode;t&&t.childrenRendered&&this.doSort.defer(1,this,[t])}}),Ext.dd.DropZone&&(Ext.tree.TreeDropZone=function(e,t){this.allowParentInsert=t.allowParentInsert||!1,this.allowContainerDrop=t.allowContainerDrop||!1,this.appendOnly=t.appendOnly||!1,Ext.tree.TreeDropZone.superclass.constructor.call(this,e.getTreeEl(),t),this.tree=e,this.dragOverData={},this.lastInsertClass="x-tree-no-status"},Ext.extend(Ext.tree.TreeDropZone,Ext.dd.DropZone,{ddGroup:"TreeDD",expandDelay:1e3,expandNode:function(e){e.hasChildNodes()&&!e.isExpanded()&&e.expand(!1,null,this.triggerCacheRefresh.createDelegate(this))},queueExpand:function(e){this.expandProcId=this.expandNode.defer(this.expandDelay,this,[e])},cancelExpand:function(){this.expandProcId&&(clearTimeout(this.expandProcId),this.expandProcId=!1)},isValidDropPoint:function(e,t,i,s,n){if(!e||!n)return!1;var r=e.node,a=n.node;if(!(r&&r.isTarget&&t))return!1;if("append"==t&&r.allowChildren===!1)return!1;if(("above"==t||"below"==t)&&r.parentNode&&r.parentNode.allowChildren===!1)return!1;if(a&&(r==a||a.contains(r)))return!1;var o=this.dragOverData;o.tree=this.tree,o.target=r,o.data=n,o.point=t,o.source=i,o.rawEvent=s,o.dropNode=a,o.cancel=!1;var l=this.tree.fireEvent("nodedragover",o);return o.cancel===!1&&l!==!1},getDropPoint:function(e,t){var i=t.node;if(i.isRoot)return i.allowChildren!==!1?"append":!1;var s=t.ddel,n=Ext.lib.Dom.getY(s),r=n+s.offsetHeight,a=Ext.lib.Event.getPageY(e),o=i.allowChildren===!1||i.isLeaf();if(this.appendOnly||i.parentNode.allowChildren===!1)return o?!1:"append";var l=!1;this.allowParentInsert||(l=i.hasChildNodes()&&i.isExpanded());var h=(r-n)/(o?2:3);return a>=n&&n+h>a?"above":!l&&(o||a>=r-h&&r>=a)?"below":"append"},onNodeEnter:function(){this.cancelExpand()},onContainerOver:function(e,t,i){return this.allowContainerDrop&&this.isValidDropPoint({ddel:this.tree.getRootNode().ui.elNode,node:this.tree.getRootNode()},"append",e,t,i)?this.dropAllowed:this.dropNotAllowed},onNodeOver:function(e,t,i,s){var n=this.getDropPoint(i,e,t),r=e.node;this.expandProcId||"append"!=n||!r.hasChildNodes()||e.node.isExpanded()?"append"!=n&&this.cancelExpand():this.queueExpand(r);var a=this.dropNotAllowed;if(this.isValidDropPoint(e,n,t,i,s)&&n){var o,l=e.ddel;"above"==n?(a=e.node.isFirst()?"x-tree-drop-ok-above":"x-tree-drop-ok-between",o="x-tree-drag-insert-above"):"below"==n?(a=e.node.isLast()?"x-tree-drop-ok-below":"x-tree-drop-ok-between",o="x-tree-drag-insert-below"):(a="x-tree-drop-ok-append",o="x-tree-drag-append"),this.lastInsertClass!=o&&(Ext.fly(l).replaceClass(this.lastInsertClass,o),this.lastInsertClass=o)}return a},onNodeOut:function(e){this.cancelExpand(),this.removeDropIndicators(e)},onNodeDrop:function(e,t,i,s){var n=this.getDropPoint(i,e,t),r=e.node;if(r.ui.startDrop(),!this.isValidDropPoint(e,n,t,i,s))return r.ui.endDrop(),!1;var a=s.node||(t.getTreeNode?t.getTreeNode(s,r,n,i):null);return this.processDrop(r,s,n,t,i,a)},onContainerDrop:function(e,t,i){if(this.allowContainerDrop&&this.isValidDropPoint({ddel:this.tree.getRootNode().ui.elNode,node:this.tree.getRootNode()},"append",e,t,i)){var s=this.tree.getRootNode();s.ui.startDrop();var n=i.node||(e.getTreeNode?e.getTreeNode(i,s,"append",t):null);return this.processDrop(s,i,"append",e,t,n)}return!1},processDrop:function(e,t,i,s,n,r){var a={tree:this.tree,target:e,data:t,point:i,source:s,rawEvent:n,dropNode:r,cancel:!r,dropStatus:!1},o=this.tree.fireEvent("beforenodedrop",a);return o!==!1&&a.cancel!==!0&&a.dropNode?(e=a.target,"append"!=i||e.isExpanded()?this.completeDrop(a):e.expand(!1,null,function(){this.completeDrop(a)}.createDelegate(this)),!0):(e.ui.endDrop(),a.dropStatus)},completeDrop:function(e){var t=e.dropNode,i=e.point,s=e.target;Ext.isArray(t)||(t=[t]);for(var n,r=0,a=t.length;a>r;r++)n=t[r],"above"==i?s.parentNode.insertBefore(n,s):"below"==i?s.parentNode.insertBefore(n,s.nextSibling):s.appendChild(n);n.ui.focus(),Ext.enableFx&&this.tree.hlDrop&&n.ui.highlight(),s.ui.endDrop(),this.tree.fireEvent("nodedrop",e)},afterNodeMoved:function(e,t,i,s,n){Ext.enableFx&&this.tree.hlDrop&&(n.ui.focus(),n.ui.highlight()),this.tree.fireEvent("nodedrop",this.tree,s,t,e,i)},getTree:function(){return this.tree},removeDropIndicators:function(e){if(e&&e.ddel){var t=e.ddel;Ext.fly(t).removeClass(["x-tree-drag-insert-above","x-tree-drag-insert-below","x-tree-drag-append"]),this.lastInsertClass="_noclass"}},beforeDragDrop:function(){return this.cancelExpand(),!0},afterRepair:function(e){e&&Ext.enableFx&&e.node.ui.highlight(),this.hideProxy()}})),Ext.dd.DragZone&&(Ext.tree.TreeDragZone=function(e,t){Ext.tree.TreeDragZone.superclass.constructor.call(this,e.innerCt,t),this.tree=e},Ext.extend(Ext.tree.TreeDragZone,Ext.dd.DragZone,{ddGroup:"TreeDD",onBeforeDrag:function(e){var t=e.node;return t&&t.draggable&&!t.disabled},onInitDrag:function(e){var t=this.dragData;this.tree.getSelectionModel().select(t.node),this.tree.eventModel.disable(),this.proxy.update(""),t.node.ui.appendDDGhost(this.proxy.ghost.dom),this.tree.fireEvent("startdrag",this.tree,t.node,e)},getRepairXY:function(e,t){return t.node.ui.getDDRepairXY()},onEndDrag:function(e,t){this.tree.eventModel.enable.defer(100,this.tree.eventModel),this.tree.fireEvent("enddrag",this.tree,e.node,t)},onValidDrop:function(e,t){this.tree.fireEvent("dragdrop",this.tree,this.dragData.node,e,t),this.hideProxy()},beforeInvalidDrop:function(){var e=this.tree.getSelectionModel();e.clearSelections(),e.select(this.dragData.node)},afterRepair:function(){Ext.enableFx&&this.tree.hlDrop&&Ext.Element.fly(this.dragData.ddel).highlight(this.hlColor||"c3daf9"),this.dragging=!1}})),Ext.tree.TreeEditor=function(e,t,i){t=t||{};var s=t.events?t:new Ext.form.TextField(t);Ext.tree.TreeEditor.superclass.constructor.call(this,s,i),this.tree=e,e.rendered?this.initEditor(e):e.on("render",this.initEditor,this)},Ext.extend(Ext.tree.TreeEditor,Ext.Editor,{alignment:"l-l",autoSize:!1,hideEl:!1,cls:"x-small-editor x-tree-editor",shim:!1,shadow:"frame",maxWidth:250,editDelay:350,initEditor:function(e){e.on({scope:this,beforeclick:this.beforeNodeClick,dblclick:this.onNodeDblClick}),this.on({scope:this,complete:this.updateNode,beforestartedit:this.fitToTree,specialkey:this.onSpecialKey}),this.on("startedit",this.bindScroll,this,{delay:10})},fitToTree:function(e,t){var i=this.tree.getTreeEl().dom,s=t.dom;i.scrollLeft>s.offsetLeft&&(i.scrollLeft=s.offsetLeft);var n=Math.min(this.maxWidth,(i.clientWidth>20?i.clientWidth:i.offsetWidth)-Math.max(0,s.offsetLeft-i.scrollLeft)-5);this.setSize(n,"")},triggerEdit:function(e){if(this.completeEdit(),e.attributes.editable!==!1){this.editNode=e,this.tree.autoScroll&&Ext.fly(e.ui.getEl()).scrollIntoView(this.tree.body);var t=e.text||"";return!Ext.isGecko&&Ext.isEmpty(e.text)&&e.setText("&#160;"),this.autoEditTimer=this.startEdit.defer(this.editDelay,this,[e.ui.textNode,t]),!1}},bindScroll:function(){this.tree.getTreeEl().on("scroll",this.cancelEdit,this)},beforeNodeClick:function(e,t){return clearTimeout(this.autoEditTimer),this.tree.getSelectionModel().isSelected(e)?(t.stopEvent(),this.triggerEdit(e)):void 0},onNodeDblClick:function(){clearTimeout(this.autoEditTimer)},updateNode:function(e,t){this.tree.getTreeEl().un("scroll",this.cancelEdit,this),this.editNode.setText(t)},onHide:function(){Ext.tree.TreeEditor.superclass.onHide.call(this),this.editNode&&this.editNode.ui.focus.defer(50,this.editNode.ui)},onSpecialKey:function(e,t){var i=t.getKey();i==t.ESC?(t.stopEvent(),this.cancelEdit()):i!=t.ENTER||t.hasModifier()||(t.stopEvent(),this.completeEdit())},onDestroy:function(){clearTimeout(this.autoEditTimer),Ext.tree.TreeEditor.superclass.onDestroy.call(this);var e=this.tree;e.un("beforeclick",this.beforeNodeClick,this),e.un("dblclick",this.onNodeDblClick,this)}});var swfobject=function(){function e(){if(!H){try{var e=k.getElementsByTagName("body")[0].appendChild(y("span"));e.parentNode.removeChild(e)}catch(t){return}H=!0;for(var i=G.length,s=0;i>s;s++)G[s]()}}function t(e){H?e():G[G.length]=e}function i(e){if(typeof R.addEventListener!=M)R.addEventListener("load",e,!1);else if(typeof k.addEventListener!=M)k.addEventListener("load",e,!1);else if(typeof R.attachEvent!=M)g(R,"onload",e);else if("function"==typeof R.onload){var t=R.onload;R.onload=function(){t(),e()}}else R.onload=e}function s(){j?n():r()}function n(){var e=k.getElementsByTagName("body")[0],t=y(P);t.setAttribute("type",A);var i=e.appendChild(t);if(i){var s=0;!function(){if(typeof i.GetVariable!=M){var n=i.GetVariable("$version");n&&(n=n.split(" ")[1].split(","),X.pv=[parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10)])}else if(10>s)return s++,setTimeout(arguments.callee,10),void 0;e.removeChild(t),i=null,r()}()}else r()}function r(){var e=B.length;if(e>0)for(var t=0;e>t;t++){var i=B[t].id,s=B[t].callbackFn,n={success:!1,id:i};if(X.pv[0]>0){var r=m(i);if(r)if(!v(B[t].swfVersion)||X.wk&&X.wk<312)if(B[t].expressInstall&&o()){var u={};u.data=B[t].expressInstall,u.width=r.getAttribute("width")||"0",u.height=r.getAttribute("height")||"0",r.getAttribute("class")&&(u.styleclass=r.getAttribute("class")),r.getAttribute("align")&&(u.align=r.getAttribute("align"));for(var c={},d=r.getElementsByTagName("param"),p=d.length,f=0;p>f;f++)"movie"!=d[f].getAttribute("name").toLowerCase()&&(c[d[f].getAttribute("name")]=d[f].getAttribute("value"));l(u,c,i,s)}else h(r),s&&s(n);else E(i,!0),s&&(n.success=!0,n.ref=a(i),s(n))}else if(E(i,!0),s){var y=a(i);y&&typeof y.SetVariable!=M&&(n.success=!0,n.ref=y),s(n)}}}function a(e){var t=null,i=m(e);if(i&&"OBJECT"==i.nodeName)if(typeof i.SetVariable!=M)t=i;else{var s=i.getElementsByTagName(P)[0];s&&(t=s)}return t}function o(){return!V&&v("6.0.65")&&(X.win||X.mac)&&!(X.wk&&X.wk<312)}function l(e,t,i,s){V=!0,C=s||null,w={success:!1,id:i};var n=m(i);if(n){"OBJECT"==n.nodeName?(L=u(n),S=null):(L=n,S=i),e.id=I,(typeof e.width==M||!/%$/.test(e.width)&&parseInt(e.width,10)<310)&&(e.width="310"),(typeof e.height==M||!/%$/.test(e.height)&&parseInt(e.height,10)<137)&&(e.height="137"),k.title=k.title.slice(0,47)+" - Flash Player Installation";var r=X.ie&&X.win?"ActiveX":"PlugIn",a="MMredirectURL="+R.location.toString().replace(/&/g,"%26")+"&MMplayerType="+r+"&MMdoctitle="+k.title;if(typeof t.flashvars!=M?t.flashvars+="&"+a:t.flashvars=a,X.ie&&X.win&&4!=n.readyState){var o=y("div");i+="SWFObjectNew",o.setAttribute("id",i),n.parentNode.insertBefore(o,n),n.style.display="none",function(){4==n.readyState?n.parentNode.removeChild(n):setTimeout(arguments.callee,10)}()}c(e,t,i)}}function h(e){if(X.ie&&X.win&&4!=e.readyState){var t=y("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(u(e),t),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}else e.parentNode.replaceChild(u(e),e)}function u(e){var t=y("div");if(X.win&&X.ie)t.innerHTML=e.innerHTML;else{var i=e.getElementsByTagName(P)[0];if(i){var s=i.childNodes;if(s)for(var n=s.length,r=0;n>r;r++)1==s[r].nodeType&&"PARAM"==s[r].nodeName||8==s[r].nodeType||t.appendChild(s[r].cloneNode(!0))}}return t}function c(e,t,i){var s,n=m(i);if(X.wk&&X.wk<312)return s;if(n)if(typeof e.id==M&&(e.id=i),X.ie&&X.win){var r="";for(var a in e)e[a]!=Object.prototype[a]&&("data"==a.toLowerCase()?t.movie=e[a]:"styleclass"==a.toLowerCase()?r+=' class="'+e[a]+'"':"classid"!=a.toLowerCase()&&(r+=" "+a+'="'+e[a]+'"'));var o="";for(var l in t)t[l]!=Object.prototype[l]&&(o+='<param name="'+l+'" value="'+t[l]+'" />');n.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+r+">"+o+"</object>",z[z.length]=e.id,s=m(e.id)}else{var h=y(P);h.setAttribute("type",A);for(var u in e)e[u]!=Object.prototype[u]&&("styleclass"==u.toLowerCase()?h.setAttribute("class",e[u]):"classid"!=u.toLowerCase()&&h.setAttribute(u,e[u]));for(var c in t)t[c]!=Object.prototype[c]&&"movie"!=c.toLowerCase()&&d(h,c,t[c]);n.parentNode.replaceChild(h,n),s=h}return s}function d(e,t,i){var s=y("param");s.setAttribute("name",t),s.setAttribute("value",i),e.appendChild(s)}function p(e){var t=m(e);t&&"OBJECT"==t.nodeName&&(X.ie&&X.win?(t.style.display="none",function(){4==t.readyState?f(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))}function f(e){var t=m(e);if(t){for(var i in t)"function"==typeof t[i]&&(t[i]=null);t.parentNode.removeChild(t)}}function m(e){var t=null;try{t=k.getElementById(e)}catch(i){}return t}function y(e){return k.createElement(e)}function g(e,t,i){e.attachEvent(t,i),W[W.length]=[e,t,i]}function v(e){var t=X.pv,i=e.split(".");return i[0]=parseInt(i[0],10),i[1]=parseInt(i[1],10)||0,i[2]=parseInt(i[2],10)||0,t[0]>i[0]||t[0]==i[0]&&t[1]>i[1]||t[0]==i[0]&&t[1]==i[1]&&t[2]>=i[2]?!0:!1}function x(e,t,i,s){if(!X.ie||!X.mac){var n=k.getElementsByTagName("head")[0];if(n){var r=i&&"string"==typeof i?i:"screen";if(s&&(O=null,T=null),!O||T!=r){var a=y("style");a.setAttribute("type","text/css"),a.setAttribute("media",r),O=n.appendChild(a),X.ie&&X.win&&typeof k.styleSheets!=M&&k.styleSheets.length>0&&(O=k.styleSheets[k.styleSheets.length-1]),T=r}X.ie&&X.win?O&&typeof O.addRule==P&&O.addRule(e,t):O&&typeof k.createTextNode!=M&&O.appendChild(k.createTextNode(e+" {"+t+"}"))}}}function E(e,t){if(U){var i=t?"visible":"hidden";H&&m(e)?m(e).style.visibility=i:x("#"+e,"visibility:"+i)}}function b(e){var t=/[\\\"<>\.;]/,i=null!=t.exec(e);return i&&typeof encodeURIComponent!=M?encodeURIComponent(e):e}var L,S,C,w,O,T,M="undefined",P="object",N="Shockwave Flash",D="ShockwaveFlash.ShockwaveFlash",A="application/x-shockwave-flash",I="SWFObjectExprInst",F="onreadystatechange",R=window,k=document,_=navigator,j=!1,G=[s],B=[],z=[],W=[],H=!1,V=!1,U=!0,X=function(){var e=typeof k.getElementById!=M&&typeof k.getElementsByTagName!=M&&typeof k.createElement!=M,t=_.userAgent.toLowerCase(),i=_.platform.toLowerCase(),s=i?/win/.test(i):/win/.test(t),n=i?/mac/.test(i):/mac/.test(t),r=/webkit/.test(t)?parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,a=!1,o=[0,0,0],l=null;if(typeof _.plugins!=M&&typeof _.plugins[N]==P)l=_.plugins[N].description,!l||typeof _.mimeTypes!=M&&_.mimeTypes[A]&&!_.mimeTypes[A].enabledPlugin||(j=!0,a=!1,l=l.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),o[0]=parseInt(l.replace(/^(.*)\..*$/,"$1"),10),o[1]=parseInt(l.replace(/^.*\.(.*)\s.*$/,"$1"),10),o[2]=/[a-zA-Z]/.test(l)?parseInt(l.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof R.ActiveXObject!=M)try{var h=new ActiveXObject(D);h&&(l=h.GetVariable("$version"),l&&(a=!0,l=l.split(" ")[1].split(","),o=[parseInt(l[0],10),parseInt(l[1],10),parseInt(l[2],10)]))}catch(u){}return{w3:e,pv:o,wk:r,ie:a,win:s,mac:n}}();return function(){X.w3&&((typeof k.readyState!=M&&"complete"==k.readyState||typeof k.readyState==M&&(k.getElementsByTagName("body")[0]||k.body))&&e(),H||(typeof k.addEventListener!=M&&k.addEventListener("DOMContentLoaded",e,!1),X.ie&&X.win&&(k.attachEvent(F,function(){"complete"==k.readyState&&(k.detachEvent(F,arguments.callee),e())}),R==top&&function(){if(!H){try{k.documentElement.doScroll("left")}catch(t){return setTimeout(arguments.callee,0),void 0}e()}}()),X.wk&&function(){return H?void 0:/loaded|complete/.test(k.readyState)?(e(),void 0):(setTimeout(arguments.callee,0),void 0)}(),i(e)))}(),function(){X.ie&&X.win&&window.attachEvent("onunload",function(){for(var e=W.length,t=0;e>t;t++)W[t][0].detachEvent(W[t][1],W[t][2]);for(var i=z.length,s=0;i>s;s++)p(z[s]);for(var n in X)X[n]=null;X=null;for(var r in swfobject)swfobject[r]=null;swfobject=null,window.detachEvent("onunload",arguments.callee)})}(),{registerObject:function(e,t,i,s){if(X.w3&&e&&t){var n={};n.id=e,n.swfVersion=t,n.expressInstall=i,n.callbackFn=s,B[B.length]=n,E(e,!1)}else s&&s({success:!1,id:e})},getObjectById:function(e){return X.w3?a(e):void 0},embedSWF:function(e,i,s,n,r,a,h,u,d,p){var f={success:!1,id:i};X.w3&&!(X.wk&&X.wk<312)&&e&&i&&s&&n&&r?(E(i,!1),t(function(){s+="",n+="";var t={};if(d&&typeof d===P)for(var m in d)t[m]=d[m];t.data=e,t.width=s,t.height=n;var y={};if(u&&typeof u===P)for(var g in u)y[g]=u[g];if(h&&typeof h===P)for(var x in h)typeof y.flashvars!=M?y.flashvars+="&"+x+"="+h[x]:y.flashvars=x+"="+h[x];if(v(r)){var b=c(t,y,i);t.id==i&&E(i,!0),f.success=!0,f.ref=b}else{if(a&&o())return t.data=a,l(t,y,i,p),void 0;E(i,!0)}p&&p(f)})):p&&p(f)},switchOffAutoHideShow:function(){U=!1},ua:X,getFlashPlayerVersion:function(){return{major:X.pv[0],minor:X.pv[1],release:X.pv[2]}},hasFlashPlayerVersion:v,createSWF:function(e,t,i){return X.w3?c(e,t,i):void 0},showExpressInstall:function(e,t,i,s){X.w3&&o()&&l(e,t,i,s)},removeSWF:function(e){X.w3&&p(e)},createCSS:function(e,t,i,s){X.w3&&x(e,t,i,s)},addDomLoadEvent:t,addLoadEvent:i,getQueryParamValue:function(e){var t=k.location.search||k.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return b(t);for(var i=t.split("&"),s=0;s<i.length;s++)if(i[s].substring(0,i[s].indexOf("="))==e)return b(i[s].substring(i[s].indexOf("=")+1))}return""},expressInstallCallback:function(){if(V){var e=m(I);e&&L&&(e.parentNode.replaceChild(L,e),S&&(E(S,!0),X.ie&&X.win&&(L.style.display="block")),C&&C(w)),V=!1}}}}();Ext.FlashComponent=Ext.extend(Ext.BoxComponent,{flashVersion:"9.0.115",backgroundColor:"#ffffff",wmode:"opaque",flashVars:void 0,flashParams:void 0,url:void 0,swfId:void 0,swfWidth:"100%",swfHeight:"100%",expressInstall:!1,initComponent:function(){Ext.FlashComponent.superclass.initComponent.call(this),this.addEvents("initialize")},onRender:function(){Ext.FlashComponent.superclass.onRender.apply(this,arguments);var e=Ext.apply({allowScriptAccess:"always",bgcolor:this.backgroundColor,wmode:this.wmode},this.flashParams),t=Ext.apply({allowedDomain:document.location.hostname,YUISwfId:this.getId(),YUIBridgeCallback:"Ext.FlashEventProxy.onEvent"},this.flashVars);new swfobject.embedSWF(this.url,this.id,this.swfWidth,this.swfHeight,this.flashVersion,this.expressInstall?Ext.FlashComponent.EXPRESS_INSTALL_URL:void 0,t,e),this.swf=Ext.getDom(this.id),this.el=Ext.get(this.swf)},getSwfId:function(){return this.swfId||(this.swfId="extswf"+ ++Ext.Component.AUTO_ID)},getId:function(){return this.id||(this.id="extflashcmp"+ ++Ext.Component.AUTO_ID)},onFlashEvent:function(e){switch(e.type){case"swfReady":return this.initSwf(),void 0;case"log":return}e.component=this,this.fireEvent(e.type.toLowerCase().replace(/event$/,""),e)},initSwf:function(){this.onSwfReady(!!this.isInitialized),this.isInitialized=!0,this.fireEvent("initialize",this)},beforeDestroy:function(){this.rendered&&swfobject.removeSWF(this.swf.id),Ext.FlashComponent.superclass.beforeDestroy.call(this)},onSwfReady:Ext.emptyFn}),Ext.FlashComponent.EXPRESS_INSTALL_URL="http://swfobject.googlecode.com/svn/trunk/swfobject/expressInstall.swf",Ext.reg("flash",Ext.FlashComponent),Ext.FlashEventProxy={onEvent:function(e,t){var i=Ext.getCmp(e);i?i.onFlashEvent(t):arguments.callee.defer(10,this,[e,t])}},Ext.chart.Chart=Ext.extend(Ext.FlashComponent,{refreshBuffer:100,chartStyle:{padding:10,animationEnabled:!0,font:{name:"Tahoma",color:4473924,size:11},dataTip:{padding:5,border:{color:10075112,size:1},background:{color:14346230,alpha:.9},font:{name:"Tahoma",color:1393291,size:10,bold:!0}}},extraStyle:null,seriesStyles:null,disableCaching:Ext.isIE||Ext.isOpera,disableCacheParam:"_dc",initComponent:function(){Ext.chart.Chart.superclass.initComponent.call(this),this.url||(this.url=Ext.chart.Chart.CHART_URL),this.disableCaching&&(this.url=Ext.urlAppend(this.url,String.format("{0}={1}",this.disableCacheParam,(new Date).getTime()))),this.addEvents("itemmouseover","itemmouseout","itemclick","itemdoubleclick","itemdragstart","itemdrag","itemdragend","beforerefresh","refresh"),this.store=Ext.StoreMgr.lookup(this.store)},setStyle:function(e,t){this.swf.setStyle(e,Ext.encode(t))},setStyles:function(e){this.swf.setStyles(Ext.encode(e))},setSeriesStyles:function(e){this.seriesStyles=e;var t=[];Ext.each(e,function(e){t.push(Ext.encode(e))}),this.swf.setSeriesStyles(t)},setCategoryNames:function(e){this.swf.setCategoryNames(e)},setLegendRenderer:function(e,t){var i=this;t=t||i,i.removeFnProxy(i.legendFnName),i.legendFnName=i.createFnProxy(function(i){return e.call(t,i)}),i.swf.setLegendLabelFunction(i.legendFnName)},setTipRenderer:function(e,t){var i=this;t=t||i,i.removeFnProxy(i.tipFnName),i.tipFnName=i.createFnProxy(function(s,n,r){var a=i.store.getAt(n);return e.call(t,i,a,n,r)}),i.swf.setDataTipFunction(i.tipFnName)},setSeries:function(e){this.series=e,this.refresh()},bindStore:function(e,t){!t&&this.store&&(e!==this.store&&this.store.autoDestroy?this.store.destroy():(this.store.un("datachanged",this.refresh,this),this.store.un("add",this.delayRefresh,this),this.store.un("remove",this.delayRefresh,this),this.store.un("update",this.delayRefresh,this),this.store.un("clear",this.refresh,this))),e&&(e=Ext.StoreMgr.lookup(e),e.on({scope:this,datachanged:this.refresh,add:this.delayRefresh,remove:this.delayRefresh,update:this.delayRefresh,clear:this.refresh})),this.store=e,e&&!t&&this.refresh()},onSwfReady:function(e){Ext.chart.Chart.superclass.onSwfReady.call(this,e);var t;this.swf.setType(this.type),this.chartStyle&&this.setStyles(Ext.apply({},this.extraStyle,this.chartStyle)),this.categoryNames&&this.setCategoryNames(this.categoryNames),this.tipRenderer&&(t=this.getFunctionRef(this.tipRenderer),this.setTipRenderer(t.fn,t.scope)),this.legendRenderer&&(t=this.getFunctionRef(this.legendRenderer),this.setLegendRenderer(t.fn,t.scope)),e||this.bindStore(this.store,!0),this.refresh.defer(10,this)
},delayRefresh:function(){this.refreshTask||(this.refreshTask=new Ext.util.DelayedTask(this.refresh,this)),this.refreshTask.delay(this.refreshBuffer)},refresh:function(){if(this.fireEvent("beforerefresh",this)!==!1){for(var e=!1,t=[],i=this.store.data.items,s=0,n=i.length;n>s;s++)t[s]=i[s].data;var r=[],a=0,o=null,l=0;if(this.series)for(a=this.series.length,l=0;a>l;l++){o=this.series[l];var h={};for(var u in o)"style"==u&&null!==o.style?(h.style=Ext.encode(o.style),e=!0):h[u]=o[u];r.push(h)}if(a>0)for(l=0;a>l;l++)o=r[l],o.type||(o.type=this.type),o.dataProvider=t;else r.push({type:this.type,dataProvider:t});this.swf.setDataProvider(r),this.seriesStyles&&this.setSeriesStyles(this.seriesStyles),this.fireEvent("refresh",this)}},createFnProxy:function(e){var t="extFnProxy"+ ++Ext.chart.Chart.PROXY_FN_ID;return Ext.chart.Chart.proxyFunction[t]=e,"Ext.chart.Chart.proxyFunction."+t},removeFnProxy:function(e){Ext.isEmpty(e)||(e=e.replace("Ext.chart.Chart.proxyFunction.",""),delete Ext.chart.Chart.proxyFunction[e])},getFunctionRef:function(e){return Ext.isFunction(e)?{fn:e,scope:this}:{fn:e.fn,scope:e.scope||this}},onDestroy:function(){this.refreshTask&&this.refreshTask.cancel&&this.refreshTask.cancel(),Ext.chart.Chart.superclass.onDestroy.call(this),this.bindStore(null),this.removeFnProxy(this.tipFnName),this.removeFnProxy(this.legendFnName)}}),Ext.reg("chart",Ext.chart.Chart),Ext.chart.Chart.PROXY_FN_ID=0,Ext.chart.Chart.proxyFunction={},Ext.chart.Chart.CHART_URL="http://yui.yahooapis.com/2.8.2/build/charts/assets/charts.swf",Ext.chart.PieChart=Ext.extend(Ext.chart.Chart,{type:"pie",onSwfReady:function(e){Ext.chart.PieChart.superclass.onSwfReady.call(this,e),this.setDataField(this.dataField),this.setCategoryField(this.categoryField)},setDataField:function(e){this.dataField=e,this.swf.setDataField(e)},setCategoryField:function(e){this.categoryField=e,this.swf.setCategoryField(e)}}),Ext.reg("piechart",Ext.chart.PieChart),Ext.chart.CartesianChart=Ext.extend(Ext.chart.Chart,{onSwfReady:function(e){Ext.chart.CartesianChart.superclass.onSwfReady.call(this,e),this.labelFn=[],this.xField&&this.setXField(this.xField),this.yField&&this.setYField(this.yField),this.xAxis&&this.setXAxis(this.xAxis),this.xAxes&&this.setXAxes(this.xAxes),this.yAxis&&this.setYAxis(this.yAxis),this.yAxes&&this.setYAxes(this.yAxes),Ext.isDefined(this.constrainViewport)&&this.swf.setConstrainViewport(this.constrainViewport)},setXField:function(e){this.xField=e,this.swf.setHorizontalField(e)},setYField:function(e){this.yField=e,this.swf.setVerticalField(e)},setXAxis:function(e){this.xAxis=this.createAxis("xAxis",e),this.swf.setHorizontalAxis(this.xAxis)},setXAxes:function(e){for(var t,i=0;i<e.length;i++)t=this.createAxis("xAxis"+i,e[i]),this.swf.setHorizontalAxis(t)},setYAxis:function(e){this.yAxis=this.createAxis("yAxis",e),this.swf.setVerticalAxis(this.yAxis)},setYAxes:function(e){for(var t,i=0;i<e.length;i++)t=this.createAxis("yAxis"+i,e[i]),this.swf.setVerticalAxis(t)},createAxis:function(e,t){var i,s,n=Ext.apply({},t);return this[e]&&(s=this[e].labelFunction,this.removeFnProxy(s),this.labelFn.remove(s)),n.labelRenderer&&(i=this.getFunctionRef(n.labelRenderer),n.labelFunction=this.createFnProxy(function(e){return i.fn.call(i.scope,e)}),delete n.labelRenderer,this.labelFn.push(n.labelFunction)),e.indexOf("xAxis")>-1&&"left"==n.position&&(n.position="bottom"),n},onDestroy:function(){Ext.chart.CartesianChart.superclass.onDestroy.call(this),Ext.each(this.labelFn,function(e){this.removeFnProxy(e)},this)}}),Ext.reg("cartesianchart",Ext.chart.CartesianChart),Ext.chart.LineChart=Ext.extend(Ext.chart.CartesianChart,{type:"line"}),Ext.reg("linechart",Ext.chart.LineChart),Ext.chart.ColumnChart=Ext.extend(Ext.chart.CartesianChart,{type:"column"}),Ext.reg("columnchart",Ext.chart.ColumnChart),Ext.chart.StackedColumnChart=Ext.extend(Ext.chart.CartesianChart,{type:"stackcolumn"}),Ext.reg("stackedcolumnchart",Ext.chart.StackedColumnChart),Ext.chart.BarChart=Ext.extend(Ext.chart.CartesianChart,{type:"bar"}),Ext.reg("barchart",Ext.chart.BarChart),Ext.chart.StackedBarChart=Ext.extend(Ext.chart.CartesianChart,{type:"stackbar"}),Ext.reg("stackedbarchart",Ext.chart.StackedBarChart),Ext.chart.Axis=function(e){Ext.apply(this,e)},Ext.chart.Axis.prototype={type:null,orientation:"horizontal",reverse:!1,labelFunction:null,hideOverlappingLabels:!0,labelSpacing:2},Ext.chart.NumericAxis=Ext.extend(Ext.chart.Axis,{type:"numeric",minimum:0/0,maximum:0/0,majorUnit:0/0,minorUnit:0/0,snapToUnits:!0,alwaysShowZero:!0,scale:"linear",roundMajorUnit:!0,calculateByLabelSize:!0,position:"left",adjustMaximumByMajorUnit:!0,adjustMinimumByMajorUnit:!0}),Ext.chart.TimeAxis=Ext.extend(Ext.chart.Axis,{type:"time",minimum:null,maximum:null,majorUnit:0/0,majorTimeUnit:null,minorUnit:0/0,minorTimeUnit:null,snapToUnits:!0,stackingEnabled:!1,calculateByLabelSize:!0}),Ext.chart.CategoryAxis=Ext.extend(Ext.chart.Axis,{type:"category",categoryNames:null,calculateCategoryCount:!1}),Ext.chart.Series=function(e){Ext.apply(this,e)},Ext.chart.Series.prototype={type:null,displayName:null},Ext.chart.CartesianSeries=Ext.extend(Ext.chart.Series,{xField:null,yField:null,showInLegend:!0,axis:"primary"}),Ext.chart.ColumnSeries=Ext.extend(Ext.chart.CartesianSeries,{type:"column"}),Ext.chart.LineSeries=Ext.extend(Ext.chart.CartesianSeries,{type:"line"}),Ext.chart.BarSeries=Ext.extend(Ext.chart.CartesianSeries,{type:"bar"}),Ext.chart.PieSeries=Ext.extend(Ext.chart.Series,{type:"pie",dataField:null,categoryField:null}),Ext.menu.Menu=Ext.extend(Ext.Container,{minWidth:120,shadow:"sides",subMenuAlign:"tl-tr?",defaultAlign:"tl-bl?",allowOtherMenus:!1,ignoreParentClicks:!1,enableScrolling:!0,maxHeight:null,scrollIncrement:24,showSeparator:!0,defaultOffsets:[0,0],plain:!1,floating:!0,zIndex:15e3,hidden:!0,layout:"menu",hideMode:"offsets",scrollerHeight:8,autoLayout:!0,defaultType:"menuitem",bufferResize:!1,initComponent:function(){if(Ext.isArray(this.initialConfig)&&Ext.apply(this,{items:this.initialConfig}),this.addEvents("click","mouseover","mouseout","itemclick"),Ext.menu.MenuMgr.register(this),this.floating?Ext.EventManager.onWindowResize(this.hide,this):(this.initialConfig.hidden!==!1&&(this.hidden=!1),this.internalDefaults={hideOnClick:!1}),Ext.menu.Menu.superclass.initComponent.call(this),this.autoLayout){var e=this.doLayout.createDelegate(this,[]);this.on({add:e,remove:e})}},getLayoutTarget:function(){return this.ul},onRender:function(e,t){e||(e=Ext.getBody());var i={id:this.getId(),cls:"x-menu "+(this.floating?"x-menu-floating x-layer ":"")+(this.cls||"")+(this.plain?" x-menu-plain":"")+(this.showSeparator?"":" x-menu-nosep"),style:this.style,cn:[{tag:"a",cls:"x-menu-focus",href:"#",onclick:"return false;",tabIndex:"-1"},{tag:"ul",cls:"x-menu-list"}]};this.el=this.floating?new Ext.Layer({shadow:this.shadow,dh:i,constrain:!1,parentEl:e,zindex:this.zIndex}):e.createChild(i),Ext.menu.Menu.superclass.onRender.call(this,e,t),this.keyNav||(this.keyNav=new Ext.menu.MenuNav(this)),this.focusEl=this.el.child("a.x-menu-focus"),this.ul=this.el.child("ul.x-menu-list"),this.mon(this.ul,{scope:this,click:this.onClick,mouseover:this.onMouseOver,mouseout:this.onMouseOut}),this.enableScrolling&&this.mon(this.el,{scope:this,delegate:".x-menu-scroller",click:this.onScroll,mouseover:this.deactivateActive})},findTargetItem:function(e){var t=e.getTarget(".x-menu-list-item",this.ul,!0);return t&&t.menuItemId?this.items.get(t.menuItemId):void 0},onClick:function(e){var t=this.findTargetItem(e);t&&(t.isFormField?this.setActiveItem(t):t instanceof Ext.menu.BaseItem&&(t.menu&&this.ignoreParentClicks?(t.expandMenu(),e.preventDefault()):t.onClick&&(t.onClick(e),this.fireEvent("click",this,t,e))))},setActiveItem:function(e,t){e!=this.activeItem?(this.deactivateActive(),(this.activeItem=e).isFormField?e.focus():e.activate(t)):t&&e.expandMenu()},deactivateActive:function(){var e=this.activeItem;e&&(e.isFormField?e.collapse&&e.collapse():e.deactivate(),delete this.activeItem)},tryActivate:function(e,t){for(var i=this.items,s=e,n=i.length;s>=0&&n>s;s+=t){var r=i.get(s);if(r.isVisible()&&!r.disabled&&(r.canActivate||r.isFormField))return this.setActiveItem(r,!1),r}return!1},onMouseOver:function(e){var t=this.findTargetItem(e);t&&t.canActivate&&!t.disabled&&this.setActiveItem(t,!0),this.over=!0,this.fireEvent("mouseover",this,e,t)},onMouseOut:function(e){var t=this.findTargetItem(e);t&&t==this.activeItem&&t.shouldDeactivate&&t.shouldDeactivate(e)&&(this.activeItem.deactivate(),delete this.activeItem),this.over=!1,this.fireEvent("mouseout",this,e,t)},onScroll:function(e,t){e&&e.stopEvent();var i=this.ul.dom,s=Ext.fly(t).is(".x-menu-scroller-top");i.scrollTop+=this.scrollIncrement*(s?-1:1),(s?i.scrollTop<=0:i.scrollTop+this.activeMax>=i.scrollHeight)&&this.onScrollerOut(null,t)},onScrollerIn:function(e,t){var i=this.ul.dom,s=Ext.fly(t).is(".x-menu-scroller-top");(s?i.scrollTop>0:i.scrollTop+this.activeMax<i.scrollHeight)&&Ext.fly(t).addClass(["x-menu-item-active","x-menu-scroller-active"])},onScrollerOut:function(e,t){Ext.fly(t).removeClass(["x-menu-item-active","x-menu-scroller-active"])},show:function(e,t,i){this.floating?(this.parentMenu=i,this.el||(this.render(),this.doLayout(!1,!0)),this.showAt(this.el.getAlignToXY(e,t||this.defaultAlign,this.defaultOffsets),i)):Ext.menu.Menu.superclass.show.call(this)},showAt:function(e,t){this.fireEvent("beforeshow",this)!==!1&&(this.parentMenu=t,this.el||this.render(),this.enableScrolling?(this.el.setXY(e),e[1]=this.constrainScroll(e[1]),e=[this.el.adjustForConstraints(e)[0],e[1]]):e=this.el.adjustForConstraints(e),this.el.setXY(e),this.el.show(),Ext.menu.Menu.superclass.onShow.call(this),Ext.isIE&&(this.fireEvent("autosize",this),Ext.isIE8||this.el.repaint()),this.hidden=!1,this.focus(),this.fireEvent("show",this))},constrainScroll:function(e){var t,i,s,n,r,a=this.ul.setHeight("auto").getHeight(),o=e;return this.floating?(s=Ext.fly(this.el.dom.parentNode),n=s.getScroll().top,r=s.getViewSize().height,i=e-n,t=this.maxHeight?this.maxHeight:r-i,a>r?(t=r,o=e-i):a>t&&(o=e-(a-t),t=a)):t=this.getHeight(),this.maxHeight&&(t=Math.min(this.maxHeight,t)),a>t&&t>0?(this.activeMax=t-2*this.scrollerHeight-this.el.getFrameWidth("tb")-Ext.num(this.el.shadowOffset,0),this.ul.setHeight(this.activeMax),this.createScrollers(),this.el.select(".x-menu-scroller").setDisplayed("")):(this.ul.setHeight(a),this.el.select(".x-menu-scroller").setDisplayed("none")),this.ul.dom.scrollTop=0,o},createScrollers:function(){this.scroller||(this.scroller={pos:0,top:this.el.insertFirst({tag:"div",cls:"x-menu-scroller x-menu-scroller-top",html:"&#160;"}),bottom:this.el.createChild({tag:"div",cls:"x-menu-scroller x-menu-scroller-bottom",html:"&#160;"})},this.scroller.top.hover(this.onScrollerIn,this.onScrollerOut,this),this.scroller.topRepeater=new Ext.util.ClickRepeater(this.scroller.top,{listeners:{click:this.onScroll.createDelegate(this,[null,this.scroller.top],!1)}}),this.scroller.bottom.hover(this.onScrollerIn,this.onScrollerOut,this),this.scroller.bottomRepeater=new Ext.util.ClickRepeater(this.scroller.bottom,{listeners:{click:this.onScroll.createDelegate(this,[null,this.scroller.bottom],!1)}}))},onLayout:function(){this.isVisible()&&(this.enableScrolling&&this.constrainScroll(this.el.getTop()),this.floating&&this.el.sync())},focus:function(){this.hidden||this.doFocus.defer(50,this)},doFocus:function(){this.hidden||this.focusEl.focus()},hide:function(e){this.isDestroyed||(this.deepHide=e,Ext.menu.Menu.superclass.hide.call(this),delete this.deepHide)},onHide:function(){Ext.menu.Menu.superclass.onHide.call(this),this.deactivateActive(),this.el&&this.floating&&this.el.hide();var e=this.parentMenu;this.deepHide===!0&&e&&(e.floating?e.hide(!0):e.deactivateActive())},lookupComponent:function(e){return Ext.isString(e)?(e="separator"==e||"-"==e?new Ext.menu.Separator:new Ext.menu.TextItem(e),this.applyDefaults(e)):Ext.isObject(e)?e=this.getMenuItem(e):(e.tagName||e.el)&&(e=new Ext.BoxComponent({el:e})),e},applyDefaults:function(e){if(!Ext.isString(e)){e=Ext.menu.Menu.superclass.applyDefaults.call(this,e);var t=this.internalDefaults;t&&(e.events?(Ext.applyIf(e.initialConfig,t),Ext.apply(e,t)):Ext.applyIf(e,t))}return e},getMenuItem:function(e){return e.ownerCt=this,e.isXType?e:!e.xtype&&Ext.isBoolean(e.checked)?new Ext.menu.CheckItem(e):Ext.create(e,this.defaultType)},addSeparator:function(){return this.add(new Ext.menu.Separator)},addElement:function(e){return this.add(new Ext.menu.BaseItem({el:e}))},addItem:function(e){return this.add(e)},addMenuItem:function(e){return this.add(this.getMenuItem(e))},addText:function(e){return this.add(new Ext.menu.TextItem(e))},onDestroy:function(){Ext.EventManager.removeResizeListener(this.hide,this);var e=this.parentMenu;e&&e.activeChild==this&&delete e.activeChild,delete this.parentMenu,Ext.menu.Menu.superclass.onDestroy.call(this),Ext.menu.MenuMgr.unregister(this),this.keyNav&&this.keyNav.disable();var t=this.scroller;t&&Ext.destroy(t.topRepeater,t.bottomRepeater,t.top,t.bottom),Ext.destroy(this.el,this.focusEl,this.ul)}}),Ext.reg("menu",Ext.menu.Menu),Ext.menu.MenuNav=Ext.extend(Ext.KeyNav,function(){function e(e,t){t.tryActivate(t.items.indexOf(t.activeItem)-1,-1)||t.tryActivate(t.items.length-1,-1)}function t(e,t){t.tryActivate(t.items.indexOf(t.activeItem)+1,1)||t.tryActivate(0,1)}return{constructor:function(e){Ext.menu.MenuNav.superclass.constructor.call(this,e.el),this.scope=this.menu=e},doRelay:function(e,t){var i=e.getKey();return this.menu.activeItem&&this.menu.activeItem.isFormField&&i!=e.TAB?!1:!this.menu.activeItem&&e.isNavKeyPress()&&i!=e.SPACE&&i!=e.RETURN?(this.menu.tryActivate(0,1),!1):t.call(this.scope||this,e,this.menu)},tab:function(i,s){i.stopEvent(),i.shiftKey?e(i,s):t(i,s)},up:e,down:t,right:function(e,t){t.activeItem&&t.activeItem.expandMenu(!0)},left:function(e,t){t.hide(),t.parentMenu&&t.parentMenu.activeItem&&t.parentMenu.activeItem.activate()},enter:function(e,t){return t.activeItem?(e.stopPropagation(),t.activeItem.onClick(e),t.fireEvent("click",this,t.activeItem),!0):void 0}}}()),Ext.menu.MenuMgr=function(){function e(){o={},l=new Ext.util.MixedCollection,h=Ext.getDoc().addKeyListener(27,t),h.disable()}function t(){if(l&&l.length>0){var e=l.clone();return e.each(function(e){e.hide()}),!0}return!1}function i(e){l.remove(e),l.length<1&&(h.disable(),Ext.getDoc().un("mousedown",a),c=!1)}function s(e){var t=l.last();d=new Date,l.add(e),c||(h.enable(),Ext.getDoc().on("mousedown",a),c=!0),e.parentMenu?(e.getEl().setZIndex(parseInt(e.parentMenu.getEl().getStyle("z-index"),10)+3),e.parentMenu.activeChild=e):t&&!t.isDestroyed&&t.isVisible()&&e.getEl().setZIndex(parseInt(t.getEl().getStyle("z-index"),10)+3)}function n(e){e.activeChild&&e.activeChild.hide(),e.autoHideTimer&&(clearTimeout(e.autoHideTimer),delete e.autoHideTimer)}function r(e){var i=e.parentMenu;i||e.allowOtherMenus?i&&i.activeChild&&i.activeChild.hide():t()}function a(e){d.getElapsed()>50&&l.length>0&&!e.getTarget(".x-menu")&&t()}var o,l,h,u={},c=!1,d=new Date;return{hideAll:function(){return t()},register:function(t){o||e(),o[t.id]=t,t.on({beforehide:n,hide:i,beforeshow:r,show:s})},get:function(e){return"string"==typeof e?o?o[e]:null:e.events?e:"number"==typeof e.length?new Ext.menu.Menu({items:e}):Ext.create(e,"menu")},unregister:function(e){delete o[e.id],e.un("beforehide",n),e.un("hide",i),e.un("beforeshow",r),e.un("show",s)},registerCheckable:function(e){var t=e.group;t&&(u[t]||(u[t]=[]),u[t].push(e))},unregisterCheckable:function(e){var t=e.group;t&&u[t].remove(e)},onCheckChange:function(e,t){if(e.group&&t)for(var i,s=u[e.group],n=0,r=s.length;r>n;n++)i=s[n],i!=e&&i.setChecked(!1)},getCheckedItem:function(e){var t=u[e];if(t)for(var i=0,s=t.length;s>i;i++)if(t[i].checked)return t[i];return null},setCheckedItem:function(e,t){var i=u[e];if(i)for(var s=0,n=i.length;n>s;s++)i[s].id==t&&i[s].setChecked(!0);return null}}}(),Ext.menu.BaseItem=Ext.extend(Ext.Component,{canActivate:!1,activeClass:"x-menu-item-active",hideOnClick:!0,clickHideDelay:1,ctype:"Ext.menu.BaseItem",actionMode:"container",initComponent:function(){Ext.menu.BaseItem.superclass.initComponent.call(this),this.addEvents("click","activate","deactivate"),this.handler&&this.on("click",this.handler,this.scope)},onRender:function(){Ext.menu.BaseItem.superclass.onRender.apply(this,arguments),this.ownerCt&&this.ownerCt instanceof Ext.menu.Menu?this.parentMenu=this.ownerCt:(this.container.addClass("x-menu-list-item"),this.mon(this.el,{scope:this,click:this.onClick,mouseenter:this.activate,mouseleave:this.deactivate}))},setHandler:function(e,t){this.handler&&this.un("click",this.handler,this.scope),this.on("click",this.handler=e,this.scope=t)},onClick:function(e){!this.disabled&&this.fireEvent("click",this,e)!==!1&&this.parentMenu&&this.parentMenu.fireEvent("itemclick",this,e)!==!1?this.handleClick(e):e.stopEvent()},activate:function(){if(this.disabled)return!1;var e=this.container;return e.addClass(this.activeClass),this.region=e.getRegion().adjust(2,2,-2,-2),this.fireEvent("activate",this),!0},deactivate:function(){this.container.removeClass(this.activeClass),this.fireEvent("deactivate",this)},shouldDeactivate:function(e){return!this.region||!this.region.contains(e.getPoint())},handleClick:function(){var e=this.parentMenu;this.hideOnClick&&(e.floating?this.clickHideDelayTimer=e.hide.defer(this.clickHideDelay,e,[!0]):e.deactivateActive())},beforeDestroy:function(){clearTimeout(this.clickHideDelayTimer),Ext.menu.BaseItem.superclass.beforeDestroy.call(this)},expandMenu:Ext.emptyFn,hideMenu:Ext.emptyFn}),Ext.reg("menubaseitem",Ext.menu.BaseItem),Ext.menu.TextItem=Ext.extend(Ext.menu.BaseItem,{hideOnClick:!1,itemCls:"x-menu-text",constructor:function(e){"string"==typeof e&&(e={text:e}),Ext.menu.TextItem.superclass.constructor.call(this,e)},onRender:function(){var e=document.createElement("span");e.className=this.itemCls,e.innerHTML=this.text,this.el=e,Ext.menu.TextItem.superclass.onRender.apply(this,arguments)}}),Ext.reg("menutextitem",Ext.menu.TextItem),Ext.menu.Separator=Ext.extend(Ext.menu.BaseItem,{itemCls:"x-menu-sep",hideOnClick:!1,activeClass:"",onRender:function(e){var t=document.createElement("span");t.className=this.itemCls,t.innerHTML="&#160;",this.el=t,e.addClass("x-menu-sep-li"),Ext.menu.Separator.superclass.onRender.apply(this,arguments)}}),Ext.reg("menuseparator",Ext.menu.Separator),Ext.menu.Item=Ext.extend(Ext.menu.BaseItem,{itemCls:"x-menu-item",canActivate:!0,showDelay:200,altText:"",hideDelay:200,ctype:"Ext.menu.Item",initComponent:function(){Ext.menu.Item.superclass.initComponent.call(this),this.menu&&(Ext.isArray(this.menu)&&(this.menu={items:this.menu}),Ext.isObject(this.menu)&&(this.menu.ownerCt=this),this.menu=Ext.menu.MenuMgr.get(this.menu),this.menu.ownerCt=void 0)},onRender:function(e,t){this.itemTpl||(this.itemTpl=Ext.menu.Item.prototype.itemTpl=new Ext.XTemplate('<a id="{id}" class="{cls}" hidefocus="true" unselectable="on" href="{href}"','<tpl if="hrefTarget">',' target="{hrefTarget}"',"</tpl>",">",'<img alt="{altText}" src="{icon}" class="x-menu-item-icon {iconCls}"/>','<span class="x-menu-item-text">{text}</span>',"</a>"));var i=this.getTemplateArgs();this.el=t?this.itemTpl.insertBefore(t,i,!0):this.itemTpl.append(e,i,!0),this.iconEl=this.el.child("img.x-menu-item-icon"),this.textEl=this.el.child(".x-menu-item-text"),this.href||this.mon(this.el,"click",Ext.emptyFn,null,{preventDefault:!0}),Ext.menu.Item.superclass.onRender.call(this,e,t)},getTemplateArgs:function(){return{id:this.id,cls:this.itemCls+(this.menu?" x-menu-item-arrow":"")+(this.cls?" "+this.cls:""),href:this.href||"#",hrefTarget:this.hrefTarget,icon:this.icon||Ext.BLANK_IMAGE_URL,iconCls:this.iconCls||"",text:this.itemText||this.text||"&#160;",altText:this.altText||""}},setText:function(e){this.text=e||"&#160;",this.rendered&&(this.textEl.update(this.text),this.parentMenu.layout.doAutoSize())},setIconClass:function(e){var t=this.iconCls;this.iconCls=e,this.rendered&&this.iconEl.replaceClass(t,this.iconCls)},beforeDestroy:function(){clearTimeout(this.showTimer),clearTimeout(this.hideTimer),this.menu&&(delete this.menu.ownerCt,this.menu.destroy()),Ext.menu.Item.superclass.beforeDestroy.call(this)},handleClick:function(e){this.href||e.stopEvent(),Ext.menu.Item.superclass.handleClick.apply(this,arguments)},activate:function(e){return Ext.menu.Item.superclass.activate.apply(this,arguments)&&(this.focus(),e&&this.expandMenu()),!0},shouldDeactivate:function(e){return Ext.menu.Item.superclass.shouldDeactivate.call(this,e)?this.menu&&this.menu.isVisible()?!this.menu.getEl().getRegion().contains(e.getPoint()):!0:!1},deactivate:function(){Ext.menu.Item.superclass.deactivate.apply(this,arguments),this.hideMenu()},expandMenu:function(e){!this.disabled&&this.menu&&(clearTimeout(this.hideTimer),delete this.hideTimer,this.menu.isVisible()||this.showTimer?this.menu.isVisible()&&e&&this.menu.tryActivate(0,1):this.showTimer=this.deferExpand.defer(this.showDelay,this,[e]))},deferExpand:function(e){delete this.showTimer,this.menu.show(this.container,this.parentMenu.subMenuAlign||"tl-tr?",this.parentMenu),e&&this.menu.tryActivate(0,1)},hideMenu:function(){clearTimeout(this.showTimer),delete this.showTimer,!this.hideTimer&&this.menu&&this.menu.isVisible()&&(this.hideTimer=this.deferHide.defer(this.hideDelay,this))},deferHide:function(){delete this.hideTimer,this.menu.over?this.parentMenu.setActiveItem(this,!1):this.menu.hide()}}),Ext.reg("menuitem",Ext.menu.Item),Ext.menu.CheckItem=Ext.extend(Ext.menu.Item,{itemCls:"x-menu-item x-menu-check-item",groupClass:"x-menu-group-item",checked:!1,ctype:"Ext.menu.CheckItem",initComponent:function(){Ext.menu.CheckItem.superclass.initComponent.call(this),this.addEvents("beforecheckchange","checkchange"),this.checkHandler&&this.on("checkchange",this.checkHandler,this.scope),Ext.menu.MenuMgr.registerCheckable(this)},onRender:function(){Ext.menu.CheckItem.superclass.onRender.apply(this,arguments),this.group&&this.el.addClass(this.groupClass),this.checked&&(this.checked=!1,this.setChecked(!0,!0))},destroy:function(){Ext.menu.MenuMgr.unregisterCheckable(this),Ext.menu.CheckItem.superclass.destroy.apply(this,arguments)},setChecked:function(e,t){var i=t===!0;this.checked==e||!i&&this.fireEvent("beforecheckchange",this,e)===!1||(Ext.menu.MenuMgr.onCheckChange(this,e),this.container&&this.container[e?"addClass":"removeClass"]("x-menu-item-checked"),this.checked=e,i||this.fireEvent("checkchange",this,e))},handleClick:function(){this.disabled||this.checked&&this.group||this.setChecked(!this.checked),Ext.menu.CheckItem.superclass.handleClick.apply(this,arguments)}}),Ext.reg("menucheckitem",Ext.menu.CheckItem),Ext.menu.DateMenu=Ext.extend(Ext.menu.Menu,{enableScrolling:!1,hideOnClick:!0,pickerId:null,cls:"x-date-menu",initComponent:function(){this.on("beforeshow",this.onBeforeShow,this),(this.strict=Ext.isIE7&&Ext.isStrict)&&this.on("show",this.onShow,this,{single:!0,delay:20}),Ext.apply(this,{plain:!0,showSeparator:!1,items:this.picker=new Ext.DatePicker(Ext.applyIf({internalRender:this.strict||!Ext.isIE,ctCls:"x-menu-date-item",id:this.pickerId},this.initialConfig))}),this.picker.purgeListeners(),Ext.menu.DateMenu.superclass.initComponent.call(this),this.relayEvents(this.picker,["select"]),this.on("show",this.picker.focus,this.picker),this.on("select",this.menuHide,this),this.handler&&this.on("select",this.handler,this.scope||this)},menuHide:function(){this.hideOnClick&&this.hide(!0)},onBeforeShow:function(){this.picker&&this.picker.hideMonthPicker(!0)},onShow:function(){var e=this.picker.getEl();e.setWidth(e.getWidth())}}),Ext.reg("datemenu",Ext.menu.DateMenu),Ext.menu.ColorMenu=Ext.extend(Ext.menu.Menu,{enableScrolling:!1,hideOnClick:!0,cls:"x-color-menu",paletteId:null,initComponent:function(){Ext.apply(this,{plain:!0,showSeparator:!1,items:this.palette=new Ext.ColorPalette(Ext.applyIf({id:this.paletteId},this.initialConfig))}),this.palette.purgeListeners(),Ext.menu.ColorMenu.superclass.initComponent.call(this),this.relayEvents(this.palette,["select"]),this.on("select",this.menuHide,this),this.handler&&this.on("select",this.handler,this.scope||this)},menuHide:function(){this.hideOnClick&&this.hide(!0)}}),Ext.reg("colormenu",Ext.menu.ColorMenu),Ext.form.Field=Ext.extend(Ext.BoxComponent,{invalidClass:"x-form-invalid",invalidText:"The value in this field is invalid",focusClass:"x-form-focus",validationEvent:"keyup",validateOnBlur:!0,validationDelay:250,defaultAutoCreate:{tag:"input",type:"text",size:"20",autocomplete:"off"},fieldClass:"x-form-field",msgTarget:"qtip",msgFx:"normal",readOnly:!1,disabled:!1,submitValue:!0,isFormField:!0,msgDisplay:"",hasFocus:!1,initComponent:function(){Ext.form.Field.superclass.initComponent.call(this),this.addEvents("focus","blur","specialkey","change","invalid","valid")},getName:function(){return this.rendered&&this.el.dom.name?this.el.dom.name:this.name||this.id||""},onRender:function(e,t){if(!this.el){var i=this.getAutoCreate();i.name||(i.name=this.name||this.id),this.inputType&&(i.type=this.inputType),this.autoEl=i}Ext.form.Field.superclass.onRender.call(this,e,t),this.submitValue===!1&&this.el.dom.removeAttribute("name");var s=this.el.dom.type;s&&("password"==s&&(s="text"),this.el.addClass("x-form-"+s)),this.readOnly&&this.setReadOnly(!0),void 0!==this.tabIndex&&this.el.dom.setAttribute("tabIndex",this.tabIndex),this.el.addClass([this.fieldClass,this.cls])},getItemCt:function(){return this.itemCt},initValue:function(){void 0!==this.value?this.setValue(this.value):Ext.isEmpty(this.el.dom.value)||this.el.dom.value==this.emptyText||this.setValue(this.el.dom.value),this.originalValue=this.getValue()},isDirty:function(){return this.disabled||!this.rendered?!1:String(this.getValue())!==String(this.originalValue)},setReadOnly:function(e){this.rendered&&(this.el.dom.readOnly=e),this.readOnly=e},afterRender:function(){Ext.form.Field.superclass.afterRender.call(this),this.initEvents(),this.initValue()},fireKey:function(e){e.isSpecialKey()&&this.fireEvent("specialkey",this,e)},reset:function(){this.setValue(this.originalValue),this.clearInvalid()},initEvents:function(){this.mon(this.el,Ext.EventManager.getKeyEvent(),this.fireKey,this),this.mon(this.el,"focus",this.onFocus,this),this.mon(this.el,"blur",this.onBlur,this,this.inEditor?{buffer:10}:null)},preFocus:Ext.emptyFn,onFocus:function(){this.preFocus(),this.focusClass&&this.el.addClass(this.focusClass),this.hasFocus||(this.hasFocus=!0,this.startValue=this.getValue(),this.fireEvent("focus",this))},beforeBlur:Ext.emptyFn,onBlur:function(){this.beforeBlur(),this.focusClass&&this.el.removeClass(this.focusClass),this.hasFocus=!1,this.validationEvent===!1||!this.validateOnBlur&&"blur"!=this.validationEvent||this.validate();var e=this.getValue();String(e)!==String(this.startValue)&&this.fireEvent("change",this,e,this.startValue),this.fireEvent("blur",this),this.postBlur()},postBlur:Ext.emptyFn,isValid:function(e){if(this.disabled)return!0;var t=this.preventMark;this.preventMark=e===!0;var i=this.validateValue(this.processValue(this.getRawValue()),e);return this.preventMark=t,i},validate:function(){return this.disabled||this.validateValue(this.processValue(this.getRawValue()))?(this.clearInvalid(),!0):!1},processValue:function(e){return e},validateValue:function(e){var t=this.getErrors(e)[0];return void 0==t?!0:(this.markInvalid(t),!1)},getErrors:function(){return[]},getActiveError:function(){return this.activeError||""},markInvalid:function(e){if(this.rendered&&!this.preventMark){e=e||this.invalidText;var t=this.getMessageHandler();if(t)t.mark(this,e);else if(this.msgTarget){this.el.addClass(this.invalidClass);var i=Ext.getDom(this.msgTarget);i&&(i.innerHTML=e,i.style.display=this.msgDisplay)}}this.setActiveError(e)},clearInvalid:function(){if(this.rendered&&!this.preventMark){this.el.removeClass(this.invalidClass);var e=this.getMessageHandler();if(e)e.clear(this);else if(this.msgTarget){this.el.removeClass(this.invalidClass);var t=Ext.getDom(this.msgTarget);t&&(t.innerHTML="",t.style.display="none")}}this.unsetActiveError()},setActiveError:function(e,t){this.activeError=e,t!==!0&&this.fireEvent("invalid",this,e)},unsetActiveError:function(e){delete this.activeError,e!==!0&&this.fireEvent("valid",this)},getMessageHandler:function(){return Ext.form.MessageTargets[this.msgTarget]},getErrorCt:function(){return this.el.findParent(".x-form-element",5,!0)||this.el.findParent(".x-form-field-wrap",5,!0)},alignErrorEl:function(){this.errorEl.setWidth(this.getErrorCt().getWidth(!0)-20)},alignErrorIcon:function(){this.errorIcon.alignTo(this.el,"tl-tr",[2,0])},getRawValue:function(){var e=this.rendered?this.el.getValue():Ext.value(this.value,"");return e===this.emptyText&&(e=""),e},getValue:function(){if(!this.rendered)return this.value;var e=this.el.getValue();return(e===this.emptyText||void 0===e)&&(e=""),e},setRawValue:function(e){return this.rendered?this.el.dom.value=Ext.isEmpty(e)?"":e:""},setValue:function(e){return this.value=e,this.rendered&&(this.el.dom.value=Ext.isEmpty(e)?"":e,this.validate()),this},append:function(e){this.setValue([this.getValue(),e].join(""))}}),Ext.form.MessageTargets={qtip:{mark:function(e,t){e.el.addClass(e.invalidClass),e.el.dom.qtip=t,e.el.dom.qclass="x-form-invalid-tip",Ext.QuickTips&&Ext.QuickTips.enable()},clear:function(e){e.el.removeClass(e.invalidClass),e.el.dom.qtip=""}},title:{mark:function(e,t){e.el.addClass(e.invalidClass),e.el.dom.title=t},clear:function(e){e.el.dom.title=""}},under:{mark:function(e,t){if(e.el.addClass(e.invalidClass),!e.errorEl){var i=e.getErrorCt();if(!i)return e.el.dom.title=t,void 0;e.errorEl=i.createChild({cls:"x-form-invalid-msg"}),e.on("resize",e.alignErrorEl,e),e.on("destroy",function(){Ext.destroy(this.errorEl)},e)}e.alignErrorEl(),e.errorEl.update(t),Ext.form.Field.msgFx[e.msgFx].show(e.errorEl,e)},clear:function(e){e.el.removeClass(e.invalidClass),e.errorEl?Ext.form.Field.msgFx[e.msgFx].hide(e.errorEl,e):e.el.dom.title=""}},side:{mark:function(e,t){if(e.el.addClass(e.invalidClass),!e.errorIcon){var i=e.getErrorCt();if(!i)return e.el.dom.title=t,void 0;e.errorIcon=i.createChild({cls:"x-form-invalid-icon"}),e.ownerCt&&(e.ownerCt.on("afterlayout",e.alignErrorIcon,e),e.ownerCt.on("expand",e.alignErrorIcon,e)),e.on("resize",e.alignErrorIcon,e),e.on("destroy",function(){Ext.destroy(this.errorIcon)},e)}e.alignErrorIcon(),e.errorIcon.dom.qtip=t,e.errorIcon.dom.qclass="x-form-invalid-tip",e.errorIcon.show()},clear:function(e){e.el.removeClass(e.invalidClass),e.errorIcon?(e.errorIcon.dom.qtip="",e.errorIcon.hide()):e.el.dom.title=""}}},Ext.form.Field.msgFx={normal:{show:function(e){e.setDisplayed("block")},hide:function(e){e.setDisplayed(!1).update("")}},slide:{show:function(e){e.slideIn("t",{stopFx:!0})},hide:function(e){e.slideOut("t",{stopFx:!0,useDisplay:!0})}},slideRight:{show:function(e,t){e.fixDisplay(),e.alignTo(t.el,"tl-tr"),e.slideIn("l",{stopFx:!0})},hide:function(e){e.slideOut("l",{stopFx:!0,useDisplay:!0})}}},Ext.reg("field",Ext.form.Field),Ext.form.TextField=Ext.extend(Ext.form.Field,{grow:!1,growMin:30,growMax:800,vtype:null,maskRe:null,disableKeyFilter:!1,allowBlank:!0,minLength:0,maxLength:Number.MAX_VALUE,minLengthText:"The minimum length for this field is {0}",maxLengthText:"The maximum length for this field is {0}",selectOnFocus:!1,blankText:"This field is required",validator:null,regex:null,regexText:"",emptyText:null,emptyClass:"x-form-empty-field",initComponent:function(){Ext.form.TextField.superclass.initComponent.call(this),this.addEvents("autosize","keydown","keyup","keypress")},initEvents:function(){Ext.form.TextField.superclass.initEvents.call(this),"keyup"==this.validationEvent?(this.validationTask=new Ext.util.DelayedTask(this.validate,this),this.mon(this.el,"keyup",this.filterValidation,this)):this.validationEvent!==!1&&"blur"!=this.validationEvent&&this.mon(this.el,this.validationEvent,this.validate,this,{buffer:this.validationDelay}),(this.selectOnFocus||this.emptyText)&&(this.mon(this.el,"mousedown",this.onMouseDown,this),this.emptyText&&this.applyEmptyText()),(this.maskRe||this.vtype&&this.disableKeyFilter!==!0&&(this.maskRe=Ext.form.VTypes[this.vtype+"Mask"]))&&this.mon(this.el,"keypress",this.filterKeys,this),this.grow&&(this.mon(this.el,"keyup",this.onKeyUpBuffered,this,{buffer:50}),this.mon(this.el,"click",this.autoSize,this)),this.enableKeyEvents&&this.mon(this.el,{scope:this,keyup:this.onKeyUp,keydown:this.onKeyDown,keypress:this.onKeyPress})},onMouseDown:function(){this.hasFocus||this.mon(this.el,"mouseup",Ext.emptyFn,this,{single:!0,preventDefault:!0})},processValue:function(e){if(this.stripCharsRe){var t=e.replace(this.stripCharsRe,"");if(t!==e)return this.setRawValue(t),t}return e},filterValidation:function(e){e.isNavKeyPress()||this.validationTask.delay(this.validationDelay)
},onDisable:function(){Ext.form.TextField.superclass.onDisable.call(this),Ext.isIE&&(this.el.dom.unselectable="on")},onEnable:function(){Ext.form.TextField.superclass.onEnable.call(this),Ext.isIE&&(this.el.dom.unselectable="")},onKeyUpBuffered:function(e){this.doAutoSize(e)&&this.autoSize()},doAutoSize:function(e){return!e.isNavKeyPress()},onKeyUp:function(e){this.fireEvent("keyup",this,e)},onKeyDown:function(e){this.fireEvent("keydown",this,e)},onKeyPress:function(e){this.fireEvent("keypress",this,e)},reset:function(){Ext.form.TextField.superclass.reset.call(this),this.applyEmptyText()},applyEmptyText:function(){this.rendered&&this.emptyText&&this.getRawValue().length<1&&!this.hasFocus&&(this.setRawValue(this.emptyText),this.el.addClass(this.emptyClass))},preFocus:function(){var e,t=this.el;this.emptyText&&(t.dom.value==this.emptyText&&(this.setRawValue(""),e=!0),t.removeClass(this.emptyClass)),(this.selectOnFocus||e)&&t.dom.select()},postBlur:function(){this.applyEmptyText()},filterKeys:function(e){if(!e.ctrlKey){var t=e.getKey();if(!Ext.isGecko||!(e.isNavKeyPress()||t==e.BACKSPACE||t==e.DELETE&&-1==e.button)){var i=String.fromCharCode(e.getCharCode());(Ext.isGecko||!e.isSpecialKey()||i)&&(this.maskRe.test(i)||e.stopEvent())}}},setValue:function(e){return this.emptyText&&this.el&&!Ext.isEmpty(e)&&this.el.removeClass(this.emptyClass),Ext.form.TextField.superclass.setValue.apply(this,arguments),this.applyEmptyText(),this.autoSize(),this},getErrors:function(e){var t=Ext.form.TextField.superclass.getErrors.apply(this,arguments);if(e=Ext.isDefined(e)?e:this.processValue(this.getRawValue()),Ext.isFunction(this.validator)){var i=this.validator(e);i!==!0&&t.push(i)}if(e.length<1||e===this.emptyText){if(this.allowBlank)return t;t.push(this.blankText)}if(!this.allowBlank&&(e.length<1||e===this.emptyText)&&t.push(this.blankText),e.length<this.minLength&&t.push(String.format(this.minLengthText,this.minLength)),e.length>this.maxLength&&t.push(String.format(this.maxLengthText,this.maxLength)),this.vtype){var s=Ext.form.VTypes;s[this.vtype](e,this)||t.push(this.vtypeText||s[this.vtype+"Text"])}return this.regex&&!this.regex.test(e)&&t.push(this.regexText),t},selectText:function(e,t){var i=this.getRawValue(),s=!1;if(i.length>0){e=void 0===e?0:e,t=void 0===t?i.length:t;var n=this.el.dom;if(n.setSelectionRange)n.setSelectionRange(e,t);else if(n.createTextRange){var r=n.createTextRange();r.moveStart("character",e),r.moveEnd("character",t-i.length),r.select()}s=Ext.isGecko||Ext.isOpera}else s=!0;s&&this.focus()},autoSize:function(){if(this.grow&&this.rendered){this.metrics||(this.metrics=Ext.util.TextMetrics.createInstance(this.el));var e=this.el,t=e.dom.value,i=document.createElement("div");i.appendChild(document.createTextNode(t)),t=i.innerHTML,Ext.removeNode(i),i=null,t+="&#160;";var s=Math.min(this.growMax,Math.max(this.metrics.getWidth(t)+10,this.growMin));this.el.setWidth(s),this.fireEvent("autosize",this,s)}},onDestroy:function(){this.validationTask&&(this.validationTask.cancel(),this.validationTask=null),Ext.form.TextField.superclass.onDestroy.call(this)}}),Ext.reg("textfield",Ext.form.TextField),Ext.form.TriggerField=Ext.extend(Ext.form.TextField,{defaultAutoCreate:{tag:"input",type:"text",size:"16",autocomplete:"off"},hideTrigger:!1,editable:!0,readOnly:!1,wrapFocusClass:"x-trigger-wrap-focus",autoSize:Ext.emptyFn,monitorTab:!0,deferHeight:!0,mimicing:!1,actionMode:"wrap",defaultTriggerWidth:17,onResize:function(e,t){Ext.form.TriggerField.superclass.onResize.call(this,e,t);var i=this.getTriggerWidth();Ext.isNumber(e)&&this.el.setWidth(e-i),this.wrap.setWidth(this.el.getWidth()+i)},getTriggerWidth:function(){var e=this.trigger.getWidth();return this.hideTrigger||this.readOnly||0!==e||(e=this.defaultTriggerWidth),e},alignErrorIcon:function(){this.wrap&&this.errorIcon.alignTo(this.wrap,"tl-tr",[2,0])},onRender:function(e,t){this.doc=Ext.isIE?Ext.getBody():Ext.getDoc(),Ext.form.TriggerField.superclass.onRender.call(this,e,t),this.wrap=this.el.wrap({cls:"x-form-field-wrap x-form-field-trigger-wrap"}),this.trigger=this.wrap.createChild(this.triggerConfig||{tag:"img",src:Ext.BLANK_IMAGE_URL,alt:"",cls:"x-form-trigger "+this.triggerClass}),this.initTrigger(),this.width||this.wrap.setWidth(this.el.getWidth()+this.trigger.getWidth()),this.resizeEl=this.positionEl=this.wrap},getWidth:function(){return this.el.getWidth()+this.trigger.getWidth()},updateEditState:function(){this.rendered&&(this.readOnly?(this.el.dom.readOnly=!0,this.el.addClass("x-trigger-noedit"),this.mun(this.el,"click",this.onTriggerClick,this),this.trigger.setDisplayed(!1)):(this.editable?(this.el.dom.readOnly=!1,this.el.removeClass("x-trigger-noedit"),this.mun(this.el,"click",this.onTriggerClick,this)):(this.el.dom.readOnly=!0,this.el.addClass("x-trigger-noedit"),this.mon(this.el,"click",this.onTriggerClick,this)),this.trigger.setDisplayed(!this.hideTrigger)),this.onResize(this.width||this.wrap.getWidth()))},setHideTrigger:function(e){e!=this.hideTrigger&&(this.hideTrigger=e,this.updateEditState())},setEditable:function(e){e!=this.editable&&(this.editable=e,this.updateEditState())},setReadOnly:function(e){e!=this.readOnly&&(this.readOnly=e,this.updateEditState())},afterRender:function(){Ext.form.TriggerField.superclass.afterRender.call(this),this.updateEditState()},initTrigger:function(){this.mon(this.trigger,"click",this.onTriggerClick,this,{preventDefault:!0}),this.trigger.addClassOnOver("x-form-trigger-over"),this.trigger.addClassOnClick("x-form-trigger-click")},onDestroy:function(){Ext.destroy(this.trigger,this.wrap),this.mimicing&&this.doc.un("mousedown",this.mimicBlur,this),delete this.doc,Ext.form.TriggerField.superclass.onDestroy.call(this)},onFocus:function(){Ext.form.TriggerField.superclass.onFocus.call(this),this.mimicing||(this.wrap.addClass(this.wrapFocusClass),this.mimicing=!0,this.doc.on("mousedown",this.mimicBlur,this,{delay:10}),this.monitorTab&&this.on("specialkey",this.checkTab,this))},checkTab:function(e,t){t.getKey()==t.TAB&&this.triggerBlur()},onBlur:Ext.emptyFn,mimicBlur:function(e){this.isDestroyed||this.wrap.contains(e.target)||!this.validateBlur(e)||this.triggerBlur()},triggerBlur:function(){this.mimicing=!1,this.doc.un("mousedown",this.mimicBlur,this),this.monitorTab&&this.el&&this.un("specialkey",this.checkTab,this),Ext.form.TriggerField.superclass.onBlur.call(this),this.wrap&&this.wrap.removeClass(this.wrapFocusClass)},beforeBlur:Ext.emptyFn,validateBlur:function(){return!0},onTriggerClick:Ext.emptyFn}),Ext.form.TwinTriggerField=Ext.extend(Ext.form.TriggerField,{initComponent:function(){Ext.form.TwinTriggerField.superclass.initComponent.call(this),this.triggerConfig={tag:"span",cls:"x-form-twin-triggers",cn:[{tag:"img",src:Ext.BLANK_IMAGE_URL,alt:"",cls:"x-form-trigger "+this.trigger1Class},{tag:"img",src:Ext.BLANK_IMAGE_URL,alt:"",cls:"x-form-trigger "+this.trigger2Class}]}},getTrigger:function(e){return this.triggers[e]},afterRender:function(){Ext.form.TwinTriggerField.superclass.afterRender.call(this);for(var e=this.triggers,t=0,i=e.length;i>t;++t)this["hideTrigger"+(t+1)]&&e[t].hide()},initTrigger:function(){var e=this.trigger.select(".x-form-trigger",!0),t=this;e.each(function(e,i,s){var n="Trigger"+(s+1);e.hide=function(){var e=t.wrap.getWidth();this.dom.style.display="none",t.el.setWidth(e-t.trigger.getWidth()),t["hidden"+n]=!0},e.show=function(){var e=t.wrap.getWidth();this.dom.style.display="",t.el.setWidth(e-t.trigger.getWidth()),t["hidden"+n]=!1},this.mon(e,"click",this["on"+n+"Click"],this,{preventDefault:!0}),e.addClassOnOver("x-form-trigger-over"),e.addClassOnClick("x-form-trigger-click")},this),this.triggers=e.elements},getTriggerWidth:function(){var e=0;return Ext.each(this.triggers,function(t,i){var s="Trigger"+(i+1),n=t.getWidth();e+=0!==n||this["hidden"+s]?n:this.defaultTriggerWidth},this),e},onDestroy:function(){Ext.destroy(this.triggers),Ext.form.TwinTriggerField.superclass.onDestroy.call(this)},onTrigger1Click:Ext.emptyFn,onTrigger2Click:Ext.emptyFn}),Ext.reg("trigger",Ext.form.TriggerField),Ext.form.TextArea=Ext.extend(Ext.form.TextField,{growMin:60,growMax:1e3,growAppend:"&#160;\n&#160;",enterIsSpecial:!1,preventScrollbars:!1,onRender:function(e,t){this.el||(this.defaultAutoCreate={tag:"textarea",style:"width:100px;height:60px;",autocomplete:"off"}),Ext.form.TextArea.superclass.onRender.call(this,e,t),this.grow&&(this.textSizeEl=Ext.DomHelper.append(document.body,{tag:"pre",cls:"x-form-grow-sizer"}),this.preventScrollbars&&this.el.setStyle("overflow","hidden"),this.el.setHeight(this.growMin))},onDestroy:function(){Ext.removeNode(this.textSizeEl),Ext.form.TextArea.superclass.onDestroy.call(this)},fireKey:function(e){e.isSpecialKey()&&(this.enterIsSpecial||e.getKey()!=e.ENTER||e.hasModifier())&&this.fireEvent("specialkey",this,e)},doAutoSize:function(e){return!e.isNavKeyPress()||e.getKey()==e.ENTER},filterValidation:function(e){(!e.isNavKeyPress()||!this.enterIsSpecial&&e.keyCode==e.ENTER)&&this.validationTask.delay(this.validationDelay)},autoSize:function(){if(this.grow&&this.textSizeEl){var e,t=this.el,i=Ext.util.Format.htmlEncode(t.dom.value),s=this.textSizeEl;Ext.fly(s).setWidth(this.el.getWidth()),i.length<1?i="&#160;&#160;":(i+=this.growAppend,Ext.isIE&&(i=i.replace(/\n/g,"&#160;<br />"))),s.innerHTML=i,e=Math.min(this.growMax,Math.max(s.offsetHeight,this.growMin)),e!=this.lastHeight&&(this.lastHeight=e,this.el.setHeight(e),this.fireEvent("autosize",this,e))}}}),Ext.reg("textarea",Ext.form.TextArea),Ext.form.NumberField=Ext.extend(Ext.form.TextField,{fieldClass:"x-form-field x-form-num-field",allowDecimals:!0,decimalSeparator:".",decimalPrecision:2,allowNegative:!0,minValue:Number.NEGATIVE_INFINITY,maxValue:Number.MAX_VALUE,minText:"The minimum value for this field is {0}",maxText:"The maximum value for this field is {0}",nanText:"{0} is not a valid number",baseChars:"0123456789",autoStripChars:!1,initEvents:function(){var e=this.baseChars+"";this.allowDecimals&&(e+=this.decimalSeparator),this.allowNegative&&(e+="-"),e=Ext.escapeRe(e),this.maskRe=new RegExp("["+e+"]"),this.autoStripChars&&(this.stripCharsRe=new RegExp("[^"+e+"]","gi")),Ext.form.NumberField.superclass.initEvents.call(this)},getErrors:function(e){var t=Ext.form.NumberField.superclass.getErrors.apply(this,arguments);if(e=Ext.isDefined(e)?e:this.processValue(this.getRawValue()),e.length<1)return t;e=String(e).replace(this.decimalSeparator,"."),isNaN(e)&&t.push(String.format(this.nanText,e));var i=this.parseValue(e);return i<this.minValue&&t.push(String.format(this.minText,this.minValue)),i>this.maxValue&&t.push(String.format(this.maxText,this.maxValue)),t},getValue:function(){return this.fixPrecision(this.parseValue(Ext.form.NumberField.superclass.getValue.call(this)))},setValue:function(e){return e=Ext.isNumber(e)?e:parseFloat(String(e).replace(this.decimalSeparator,".")),e=this.fixPrecision(e),e=isNaN(e)?"":String(e).replace(".",this.decimalSeparator),Ext.form.NumberField.superclass.setValue.call(this,e)},setMinValue:function(e){this.minValue=Ext.num(e,Number.NEGATIVE_INFINITY)},setMaxValue:function(e){this.maxValue=Ext.num(e,Number.MAX_VALUE)},parseValue:function(e){return e=parseFloat(String(e).replace(this.decimalSeparator,".")),isNaN(e)?"":e},fixPrecision:function(e){var t=isNaN(e);return this.allowDecimals&&-1!=this.decimalPrecision&&!t&&e?parseFloat(parseFloat(e).toFixed(this.decimalPrecision)):t?"":e},beforeBlur:function(){var e=this.parseValue(this.getRawValue());Ext.isEmpty(e)||this.setValue(e)}}),Ext.reg("numberfield",Ext.form.NumberField),Ext.form.DateField=Ext.extend(Ext.form.TriggerField,{format:"m/d/Y",altFormats:"m/d/Y|n/j/Y|n/j/y|m/j/y|n/d/y|m/j/Y|n/d/Y|m-d-y|m-d-Y|m/d|m-d|md|mdy|mdY|d|Y-m-d|n-j|n/j",disabledDaysText:"Disabled",disabledDatesText:"Disabled",minText:"The date in this field must be equal to or after {0}",maxText:"The date in this field must be equal to or before {0}",invalidText:"{0} is not a valid date - it must be in the format {1}",triggerClass:"x-form-date-trigger",showToday:!0,startDay:0,defaultAutoCreate:{tag:"input",type:"text",size:"10",autocomplete:"off"},initTime:"12",initTimeFormat:"H",safeParse:function(e,t){if(Date.formatContainsHourInfo(t))return Date.parseDate(e,t);var i=Date.parseDate(e+" "+this.initTime,t+" "+this.initTimeFormat);return i?i.clearTime():void 0},initComponent:function(){Ext.form.DateField.superclass.initComponent.call(this),this.addEvents("select"),Ext.isString(this.minValue)&&(this.minValue=this.parseDate(this.minValue)),Ext.isString(this.maxValue)&&(this.maxValue=this.parseDate(this.maxValue)),this.disabledDatesRE=null,this.initDisabledDays()},initEvents:function(){Ext.form.DateField.superclass.initEvents.call(this),this.keyNav=new Ext.KeyNav(this.el,{down:function(){this.onTriggerClick()},scope:this,forceKeyDown:!0})},initDisabledDays:function(){if(this.disabledDates){var e=this.disabledDates,t=e.length-1,i="(?:";Ext.each(e,function(s,n){i+=Ext.isDate(s)?"^"+Ext.escapeRe(s.dateFormat(this.format))+"$":e[n],n!=t&&(i+="|")},this),this.disabledDatesRE=new RegExp(i+")")}},setDisabledDates:function(e){this.disabledDates=e,this.initDisabledDays(),this.menu&&this.menu.picker.setDisabledDates(this.disabledDatesRE)},setDisabledDays:function(e){this.disabledDays=e,this.menu&&this.menu.picker.setDisabledDays(e)},setMinValue:function(e){this.minValue=Ext.isString(e)?this.parseDate(e):e,this.menu&&this.menu.picker.setMinDate(this.minValue)},setMaxValue:function(e){this.maxValue=Ext.isString(e)?this.parseDate(e):e,this.menu&&this.menu.picker.setMaxDate(this.maxValue)},getErrors:function(e){var t=Ext.form.DateField.superclass.getErrors.apply(this,arguments);if(e=this.formatDate(e||this.processValue(this.getRawValue())),e.length<1)return t;var i=e;if(e=this.parseDate(e),!e)return t.push(String.format(this.invalidText,i,this.format)),t;var s=e.getTime();if(this.minValue&&s<this.minValue.clearTime().getTime()&&t.push(String.format(this.minText,this.formatDate(this.minValue))),this.maxValue&&s>this.maxValue.clearTime().getTime()&&t.push(String.format(this.maxText,this.formatDate(this.maxValue))),this.disabledDays)for(var n=e.getDay(),r=0;r<this.disabledDays.length;r++)if(n===this.disabledDays[r]){t.push(this.disabledDaysText);break}var a=this.formatDate(e);return this.disabledDatesRE&&this.disabledDatesRE.test(a)&&t.push(String.format(this.disabledDatesText,a)),t},validateBlur:function(){return!this.menu||!this.menu.isVisible()},getValue:function(){return this.parseDate(Ext.form.DateField.superclass.getValue.call(this))||""},setValue:function(e){return Ext.form.DateField.superclass.setValue.call(this,this.formatDate(this.parseDate(e)))},parseDate:function(e){if(!e||Ext.isDate(e))return e;var t=this.safeParse(e,this.format),i=this.altFormats,s=this.altFormatsArray;if(!t&&i){s=s||i.split("|");for(var n=0,r=s.length;r>n&&!t;n++)t=this.safeParse(e,s[n])}return t},onDestroy:function(){Ext.destroy(this.menu,this.keyNav),Ext.form.DateField.superclass.onDestroy.call(this)},formatDate:function(e){return Ext.isDate(e)?e.dateFormat(this.format):e},onTriggerClick:function(){this.disabled||(null==this.menu&&(this.menu=new Ext.menu.DateMenu({hideOnClick:!1,focusOnSelect:!1})),this.onFocus(),Ext.apply(this.menu.picker,{minDate:this.minValue,maxDate:this.maxValue,disabledDatesRE:this.disabledDatesRE,disabledDatesText:this.disabledDatesText,disabledDays:this.disabledDays,disabledDaysText:this.disabledDaysText,format:this.format,showToday:this.showToday,startDay:this.startDay,minText:String.format(this.minText,this.formatDate(this.minValue)),maxText:String.format(this.maxText,this.formatDate(this.maxValue))}),this.menu.picker.setValue(this.getValue()||new Date),this.menu.show(this.el,"tl-bl?"),this.menuEvents("on"))},menuEvents:function(e){this.menu[e]("select",this.onSelect,this),this.menu[e]("hide",this.onMenuHide,this),this.menu[e]("show",this.onFocus,this)},onSelect:function(e,t){this.setValue(t),this.fireEvent("select",this,t),this.menu.hide()},onMenuHide:function(){this.focus(!1,60),this.menuEvents("un")},beforeBlur:function(){var e=this.parseDate(this.getRawValue());e&&this.setValue(e)}}),Ext.reg("datefield",Ext.form.DateField),Ext.form.DisplayField=Ext.extend(Ext.form.Field,{validationEvent:!1,validateOnBlur:!1,defaultAutoCreate:{tag:"div"},fieldClass:"x-form-display-field",htmlEncode:!1,initEvents:Ext.emptyFn,isValid:function(){return!0},validate:function(){return!0},getRawValue:function(){var e=this.rendered?this.el.dom.innerHTML:Ext.value(this.value,"");return e===this.emptyText&&(e=""),this.htmlEncode&&(e=Ext.util.Format.htmlDecode(e)),e},getValue:function(){return this.getRawValue()},getName:function(){return this.name},setRawValue:function(e){return this.htmlEncode&&(e=Ext.util.Format.htmlEncode(e)),this.rendered?this.el.dom.innerHTML=Ext.isEmpty(e)?"":e:this.value=e},setValue:function(e){return this.setRawValue(e),this}}),Ext.reg("displayfield",Ext.form.DisplayField),Ext.form.ComboBox=Ext.extend(Ext.form.TriggerField,{defaultAutoCreate:{tag:"input",type:"text",size:"24",autocomplete:"off"},listClass:"",selectedClass:"x-combo-selected",listEmptyText:"",triggerClass:"x-form-arrow-trigger",shadow:"sides",listAlign:"tl-bl?",maxHeight:300,minHeight:90,triggerAction:"query",minChars:4,autoSelect:!0,typeAhead:!1,queryDelay:500,pageSize:0,selectOnFocus:!1,queryParam:"query",loadingText:"Loading...",resizable:!1,handleHeight:8,allQuery:"",mode:"remote",minListWidth:70,forceSelection:!1,typeAheadDelay:250,lazyInit:!0,clearFilterOnReset:!0,submitValue:void 0,initComponent:function(){if(Ext.form.ComboBox.superclass.initComponent.call(this),this.addEvents("expand","collapse","beforeselect","select","beforequery"),this.transform){var e=Ext.getDom(this.transform);if(this.hiddenName||(this.hiddenName=e.name),!this.store){this.mode="local";for(var t=[],i=e.options,s=0,n=i.length;n>s;s++){var r=i[s],a=(r.hasAttribute?r.hasAttribute("value"):r.getAttributeNode("value").specified)?r.value:r.text;r.selected&&Ext.isEmpty(this.value,!0)&&(this.value=a),t.push([a,r.text])}this.store=new Ext.data.ArrayStore({idIndex:0,fields:["value","text"],data:t,autoDestroy:!0}),this.valueField="value",this.displayField="text"}e.name=Ext.id(),this.lazyRender||(this.target=!0,this.el=Ext.DomHelper.insertBefore(e,this.autoCreate||this.defaultAutoCreate),this.render(this.el.parentNode,e)),Ext.removeNode(e)}else this.store&&(this.store=Ext.StoreMgr.lookup(this.store),this.store.autoCreated&&(this.displayField=this.valueField="field1",this.store.expandData||(this.displayField="field2"),this.mode="local"));this.selectedIndex=-1,"local"==this.mode&&(Ext.isDefined(this.initialConfig.queryDelay)||(this.queryDelay=10),Ext.isDefined(this.initialConfig.minChars)||(this.minChars=0))},onRender:function(e,t){this.hiddenName&&!Ext.isDefined(this.submitValue)&&(this.submitValue=!1),Ext.form.ComboBox.superclass.onRender.call(this,e,t),this.hiddenName&&(this.hiddenField=this.el.insertSibling({tag:"input",type:"hidden",name:this.hiddenName,id:this.hiddenId||Ext.id()},"before",!0)),Ext.isGecko&&this.el.dom.setAttribute("autocomplete","off"),this.lazyInit?this.on("focus",this.initList,this,{single:!0}):this.initList()},initValue:function(){Ext.form.ComboBox.superclass.initValue.call(this),this.hiddenField&&(this.hiddenField.value=Ext.value(Ext.isDefined(this.hiddenValue)?this.hiddenValue:this.value,""))},getParentZIndex:function(){var e;return this.ownerCt&&this.findParentBy(function(t){return e=parseInt(t.getPositionEl().getStyle("z-index"),10),!!e}),e},getZIndex:function(e){e=e||Ext.getDom(this.getListParent()||Ext.getBody());var t=parseInt(Ext.fly(e).getStyle("z-index"),10);return t||(t=this.getParentZIndex()),(t||12e3)+5},initList:function(){if(!this.list){var e="x-combo-list",t=Ext.getDom(this.getListParent()||Ext.getBody());this.list=new Ext.Layer({parentEl:t,shadow:this.shadow,cls:[e,this.listClass].join(" "),constrain:!1,zindex:this.getZIndex(t)});var i=this.listWidth||Math.max(this.wrap.getWidth(),this.minListWidth);this.list.setSize(i,0),this.list.swallowEvent("mousewheel"),this.assetHeight=0,this.syncFont!==!1&&this.list.setStyle("font-size",this.el.getStyle("font-size")),this.title&&(this.header=this.list.createChild({cls:e+"-hd",html:this.title}),this.assetHeight+=this.header.getHeight()),this.innerList=this.list.createChild({cls:e+"-inner"}),this.mon(this.innerList,"mouseover",this.onViewOver,this),this.mon(this.innerList,"mousemove",this.onViewMove,this),this.innerList.setWidth(i-this.list.getFrameWidth("lr")),this.pageSize&&(this.footer=this.list.createChild({cls:e+"-ft"}),this.pageTb=new Ext.PagingToolbar({store:this.store,pageSize:this.pageSize,renderTo:this.footer}),this.assetHeight+=this.footer.getHeight()),this.tpl||(this.tpl='<tpl for="."><div class="'+e+'-item">{'+this.displayField+"}</div></tpl>"),this.view=new Ext.DataView({applyTo:this.innerList,tpl:this.tpl,singleSelect:!0,selectedClass:this.selectedClass,itemSelector:this.itemSelector||"."+e+"-item",emptyText:this.listEmptyText,deferEmptyText:!1}),this.mon(this.view,{containerclick:this.onViewClick,click:this.onViewClick,scope:this}),this.bindStore(this.store,!0),this.resizable&&(this.resizer=new Ext.Resizable(this.list,{pinned:!0,handles:"se"}),this.mon(this.resizer,"resize",function(e,t,i){this.maxHeight=i-this.handleHeight-this.list.getFrameWidth("tb")-this.assetHeight,this.listWidth=t,this.innerList.setWidth(t-this.list.getFrameWidth("lr")),this.restrictHeight()},this),this[this.pageSize?"footer":"innerList"].setStyle("margin-bottom",this.handleHeight+"px"))}},getListParent:function(){return document.body},getStore:function(){return this.store},bindStore:function(e,t){this.store&&!t&&(this.store!==e&&this.store.autoDestroy?this.store.destroy():(this.store.un("beforeload",this.onBeforeLoad,this),this.store.un("load",this.onLoad,this),this.store.un("exception",this.collapse,this)),e||(this.store=null,this.view&&this.view.bindStore(null),this.pageTb&&this.pageTb.bindStore(null))),e&&(t||(this.lastQuery=null,this.pageTb&&this.pageTb.bindStore(e)),this.store=Ext.StoreMgr.lookup(e),this.store.on({scope:this,beforeload:this.onBeforeLoad,load:this.onLoad,exception:this.collapse}),this.view&&this.view.bindStore(e))},reset:function(){this.clearFilterOnReset&&"local"==this.mode&&this.store.clearFilter(),Ext.form.ComboBox.superclass.reset.call(this)},initEvents:function(){Ext.form.ComboBox.superclass.initEvents.call(this),this.keyNav=new Ext.KeyNav(this.el,{up:function(){this.inKeyMode=!0,this.selectPrev()},down:function(){this.isExpanded()?(this.inKeyMode=!0,this.selectNext()):this.onTriggerClick()},enter:function(){this.onViewClick()},esc:function(){this.collapse()},tab:function(){return this.forceSelection===!0?this.collapse():this.onViewClick(!1),!0},scope:this,doRelay:function(e,t,i){if("down"==i||this.scope.isExpanded()){var s=Ext.KeyNav.prototype.doRelay.apply(this,arguments);return!Ext.isIE&&Ext.EventManager.useKeydown&&this.scope.fireKey(e),s}return!0},forceKeyDown:!0,defaultEventAction:"stopEvent"}),this.queryDelay=Math.max(this.queryDelay||10,"local"==this.mode?10:250),this.dqTask=new Ext.util.DelayedTask(this.initQuery,this),this.typeAhead&&(this.taTask=new Ext.util.DelayedTask(this.onTypeAhead,this)),this.enableKeyEvents||this.mon(this.el,"keyup",this.onKeyUp,this)},onDestroy:function(){this.dqTask&&(this.dqTask.cancel(),this.dqTask=null),this.bindStore(null),Ext.destroy(this.resizer,this.view,this.pageTb,this.list),Ext.destroyMembers(this,"hiddenField"),Ext.form.ComboBox.superclass.onDestroy.call(this)},fireKey:function(e){this.isExpanded()||Ext.form.ComboBox.superclass.fireKey.call(this,e)},onResize:function(e){Ext.form.ComboBox.superclass.onResize.apply(this,arguments),!isNaN(e)&&this.isVisible()&&this.list?this.doResize(e):this.bufferSize=e},doResize:function(e){if(!Ext.isDefined(this.listWidth)){var t=Math.max(e,this.minListWidth);this.list.setWidth(t),this.innerList.setWidth(t-this.list.getFrameWidth("lr"))}},onEnable:function(){Ext.form.ComboBox.superclass.onEnable.apply(this,arguments),this.hiddenField&&(this.hiddenField.disabled=!1)},onDisable:function(){Ext.form.ComboBox.superclass.onDisable.apply(this,arguments),this.hiddenField&&(this.hiddenField.disabled=!0)},onBeforeLoad:function(){this.hasFocus&&(this.innerList.update(this.loadingText?'<div class="loading-indicator">'+this.loadingText+"</div>":""),this.restrictHeight(),this.selectedIndex=-1)},onLoad:function(){this.hasFocus&&(this.store.getCount()>0||this.listEmptyText?(this.expand(),this.restrictHeight(),this.lastQuery==this.allQuery?(this.editable&&this.el.dom.select(),this.autoSelect===!1||this.selectByValue(this.value,!0)||this.select(0,!0)):(this.autoSelect!==!1&&this.selectNext(),this.typeAhead&&this.lastKey!=Ext.EventObject.BACKSPACE&&this.lastKey!=Ext.EventObject.DELETE&&this.taTask.delay(this.typeAheadDelay))):this.collapse())},onTypeAhead:function(){if(this.store.getCount()>0){var e=this.store.getAt(0),t=e.data[this.displayField],i=t.length,s=this.getRawValue().length;s!=i&&(this.setRawValue(t),this.selectText(s,t.length))}},assertValue:function(){var e,t=this.getRawValue();if(this.valueField&&Ext.isDefined(this.value)&&(e=this.findRecord(this.valueField,this.value)),e&&e.get(this.displayField)==t||(e=this.findRecord(this.displayField,t)),!e&&this.forceSelection)t.length>0&&t!=this.emptyText?(this.el.dom.value=Ext.value(this.lastSelectionText,""),this.applyEmptyText()):this.clearValue();else{if(e&&this.valueField){if(this.value==t)return;t=e.get(this.valueField||this.displayField)}this.setValue(t)}},onSelect:function(e,t){this.fireEvent("beforeselect",this,e,t)!==!1&&(this.setValue(e.data[this.valueField||this.displayField]),this.collapse(),this.fireEvent("select",this,e,t))},getName:function(){var e=this.hiddenField;return e&&e.name?e.name:this.hiddenName||Ext.form.ComboBox.superclass.getName.call(this)},getValue:function(){return this.valueField?Ext.isDefined(this.value)?this.value:"":Ext.form.ComboBox.superclass.getValue.call(this)},clearValue:function(){this.hiddenField&&(this.hiddenField.value=""),this.setRawValue(""),this.lastSelectionText="",this.applyEmptyText(),this.value=""},setValue:function(e){var t=e;if(this.valueField){var i=this.findRecord(this.valueField,e);i?t=i.data[this.displayField]:Ext.isDefined(this.valueNotFoundText)&&(t=this.valueNotFoundText)}return this.lastSelectionText=t,this.hiddenField&&(this.hiddenField.value=Ext.value(e,"")),Ext.form.ComboBox.superclass.setValue.call(this,t),this.value=e,this},findRecord:function(e,t){var i;return this.store.getCount()>0&&this.store.each(function(s){return s.data[e]==t?(i=s,!1):void 0}),i},onViewMove:function(){this.inKeyMode=!1},onViewOver:function(e,t){if(!this.inKeyMode){var i=this.view.findItemFromChild(t);if(i){var s=this.view.indexOf(i);this.select(s,!1)}}},onViewClick:function(e){var t=this.view.getSelectedIndexes()[0],i=this.store,s=i.getAt(t);s?this.onSelect(s,t):this.collapse(),e!==!1&&this.el.focus()},restrictHeight:function(){this.innerList.dom.style.height="";var e=this.innerList.dom,t=this.list.getFrameWidth("tb")+(this.resizable?this.handleHeight:0)+this.assetHeight,i=Math.max(e.clientHeight,e.offsetHeight,e.scrollHeight),s=this.getPosition()[1]-Ext.getBody().getScroll().top,n=Ext.lib.Dom.getViewHeight()-s-this.getSize().height,r=Math.max(s,n,this.minHeight||0)-this.list.shadowOffset-t-5;i=Math.min(i,r,this.maxHeight),this.innerList.setHeight(i),this.list.beginUpdate(),this.list.setHeight(i+t),this.list.alignTo.apply(this.list,[this.el].concat(this.listAlign)),this.list.endUpdate()},isExpanded:function(){return this.list&&this.list.isVisible()},selectByValue:function(e,t){if(!Ext.isEmpty(e,!0)){var i=this.findRecord(this.valueField||this.displayField,e);if(i)return this.select(this.store.indexOf(i),t),!0}return!1},select:function(e,t){if(this.selectedIndex=e,this.view.select(e),t!==!1){var i=this.view.getNode(e);i&&this.innerList.scrollChildIntoView(i,!1)}},selectNext:function(){var e=this.store.getCount();e>0&&(-1==this.selectedIndex?this.select(0):this.selectedIndex<e-1&&this.select(this.selectedIndex+1))},selectPrev:function(){var e=this.store.getCount();e>0&&(-1==this.selectedIndex?this.select(0):0!==this.selectedIndex&&this.select(this.selectedIndex-1))},onKeyUp:function(e){var t=e.getKey();this.editable===!1||this.readOnly===!0||t!=e.BACKSPACE&&e.isSpecialKey()||(this.lastKey=t,this.dqTask.delay(this.queryDelay)),Ext.form.ComboBox.superclass.onKeyUp.call(this,e)},validateBlur:function(){return!this.list||!this.list.isVisible()},initQuery:function(){this.doQuery(this.getRawValue())},beforeBlur:function(){this.assertValue()},postBlur:function(){Ext.form.ComboBox.superclass.postBlur.call(this),this.collapse(),this.inKeyMode=!1},doQuery:function(e,t){e=Ext.isEmpty(e)?"":e;var i={query:e,forceAll:t,combo:this,cancel:!1};return this.fireEvent("beforequery",i)===!1||i.cancel?!1:(e=i.query,t=i.forceAll,(t===!0||e.length>=this.minChars)&&(this.lastQuery!==e?(this.lastQuery=e,"local"==this.mode?(this.selectedIndex=-1,t?this.store.clearFilter():this.store.filter(this.displayField,e),this.onLoad()):(this.store.baseParams[this.queryParam]=e,this.store.load({params:this.getParams(e)}),this.expand())):(this.selectedIndex=-1,this.onLoad())),void 0)},getParams:function(){var e={},t=this.store.paramNames;return this.pageSize&&(e[t.start]=0,e[t.limit]=this.pageSize),e},collapse:function(){this.isExpanded()&&(this.list.hide(),Ext.getDoc().un("mousewheel",this.collapseIf,this),Ext.getDoc().un("mousedown",this.collapseIf,this),this.fireEvent("collapse",this))},collapseIf:function(e){this.isDestroyed||e.within(this.wrap)||e.within(this.list)||this.collapse()},expand:function(){!this.isExpanded()&&this.hasFocus&&((this.title||this.pageSize)&&(this.assetHeight=0,this.title&&(this.assetHeight+=this.header.getHeight()),this.pageSize&&(this.assetHeight+=this.footer.getHeight())),this.bufferSize&&(this.doResize(this.bufferSize),delete this.bufferSize),this.list.alignTo.apply(this.list,[this.el].concat(this.listAlign)),this.list.setZIndex(this.getZIndex()),this.list.show(),Ext.isGecko2&&this.innerList.setOverflow("auto"),this.mon(Ext.getDoc(),{scope:this,mousewheel:this.collapseIf,mousedown:this.collapseIf}),this.fireEvent("expand",this))},onTriggerClick:function(){this.readOnly||this.disabled||(this.isExpanded()?(this.collapse(),this.el.focus()):(this.onFocus({}),"all"==this.triggerAction?this.doQuery(this.allQuery,!0):this.doQuery(this.getRawValue()),this.el.focus()))}}),Ext.reg("combo",Ext.form.ComboBox),Ext.form.Checkbox=Ext.extend(Ext.form.Field,{focusClass:void 0,fieldClass:"x-form-field",checked:!1,boxLabel:"&#160;",defaultAutoCreate:{tag:"input",type:"checkbox",autocomplete:"off"},actionMode:"wrap",initComponent:function(){Ext.form.Checkbox.superclass.initComponent.call(this),this.addEvents("check")},onResize:function(){Ext.form.Checkbox.superclass.onResize.apply(this,arguments),this.boxLabel||this.fieldLabel||this.el.alignTo(this.wrap,"c-c")},initEvents:function(){Ext.form.Checkbox.superclass.initEvents.call(this),this.mon(this.el,{scope:this,click:this.onClick,change:this.onClick})},markInvalid:Ext.emptyFn,clearInvalid:Ext.emptyFn,onRender:function(e,t){Ext.form.Checkbox.superclass.onRender.call(this,e,t),void 0!==this.inputValue&&(this.el.dom.value=this.inputValue),this.wrap=this.el.wrap({cls:"x-form-check-wrap"}),this.boxLabel&&this.wrap.createChild({tag:"label",htmlFor:this.el.id,cls:"x-form-cb-label",html:this.boxLabel}),this.checked?this.setValue(!0):this.checked=this.el.dom.checked,Ext.isIE&&!Ext.isStrict&&this.wrap.repaint(),this.resizeEl=this.positionEl=this.wrap},onDestroy:function(){Ext.destroy(this.wrap),Ext.form.Checkbox.superclass.onDestroy.call(this)},initValue:function(){this.originalValue=this.getValue()},getValue:function(){return this.rendered?this.el.dom.checked:this.checked},onClick:function(){this.el.dom.checked!=this.checked&&this.setValue(this.el.dom.checked)},setValue:function(e){var t=this.checked,i=this.inputValue;return this.checked=e===!1?!1:e===!0||"true"===e||"1"==e||(i?e==i:"on"==String(e).toLowerCase()),this.rendered&&(this.el.dom.checked=this.checked,this.el.dom.defaultChecked=this.checked),t!=this.checked&&(this.fireEvent("check",this,this.checked),this.handler&&this.handler.call(this.scope||this,this,this.checked)),this}}),Ext.reg("checkbox",Ext.form.Checkbox),Ext.form.CheckboxGroup=Ext.extend(Ext.form.Field,{columns:"auto",vertical:!1,allowBlank:!0,blankText:"You must select at least one item in this group",defaultType:"checkbox",groupCls:"x-form-check-group",initComponent:function(){this.addEvents("change"),this.on("change",this.validate,this),Ext.form.CheckboxGroup.superclass.initComponent.call(this)},onRender:function(e,t){if(!this.el){var i={autoEl:{id:this.id},cls:this.groupCls,layout:"column",renderTo:e,bufferResize:!1},s={xtype:"container",defaultType:this.defaultType,layout:"form",defaults:{hideLabel:!0,anchor:"100%"}};
if(this.items[0].items){Ext.apply(i,{layoutConfig:{columns:this.items.length},defaults:this.defaults,items:this.items});for(var n=0,r=this.items.length;r>n;n++)Ext.applyIf(this.items[n],s)}else{var a,o=[];if("string"==typeof this.columns&&(this.columns=this.items.length),!Ext.isArray(this.columns)){for(var l=[],n=0;n<this.columns;n++)l.push(.01*(100/this.columns));this.columns=l}a=this.columns.length;for(var n=0;a>n;n++){var h=Ext.apply({items:[]},s);h[this.columns[n]<=1?"columnWidth":"width"]=this.columns[n],this.defaults&&(h.defaults=Ext.apply(h.defaults||{},this.defaults)),o.push(h)}if(this.vertical)for(var u=Math.ceil(this.items.length/a),c=0,n=0,r=this.items.length;r>n;n++)n>0&&0==n%u&&c++,this.items[n].fieldLabel&&(this.items[n].hideLabel=!1),o[c].items.push(this.items[n]);else for(var n=0,r=this.items.length;r>n;n++){var d=n%a;this.items[n].fieldLabel&&(this.items[n].hideLabel=!1),o[d].items.push(this.items[n])}Ext.apply(i,{layoutConfig:{columns:a},items:o})}if(this.panel=new Ext.Container(i),this.panel.ownerCt=this,this.el=this.panel.getEl(),this.forId&&this.itemCls){var p=this.el.up(this.itemCls).child("label",!0);p&&p.setAttribute("htmlFor",this.forId)}var f=this.panel.findBy(function(e){return e.isFormField},this);this.items=new Ext.util.MixedCollection,this.items.addAll(f)}Ext.form.CheckboxGroup.superclass.onRender.call(this,e,t)},initValue:function(){this.value&&(this.setValue.apply(this,this.buffered?this.value:[this.value]),delete this.buffered,delete this.value)},afterRender:function(){Ext.form.CheckboxGroup.superclass.afterRender.call(this),this.eachItem(function(e){e.on("check",this.fireChecked,this),e.inGroup=!0})},doLayout:function(){this.rendered&&(this.panel.forceLayout=this.ownerCt.forceLayout,this.panel.doLayout())},fireChecked:function(){var e=[];this.eachItem(function(t){t.checked&&e.push(t)}),this.fireEvent("change",this,e)},getErrors:function(){var e=Ext.form.CheckboxGroup.superclass.getErrors.apply(this,arguments);if(!this.allowBlank){var t=!0;this.eachItem(function(e){return e.checked?t=!1:void 0}),t&&e.push(this.blankText)}return e},isDirty:function(){if(this.disabled||!this.rendered)return!1;var e=!1;return this.eachItem(function(t){return t.isDirty()?(e=!0,!1):void 0}),e},setReadOnly:function(e){this.rendered&&this.eachItem(function(t){t.setReadOnly(e)}),this.readOnly=e},onDisable:function(){this.eachItem(function(e){e.disable()})},onEnable:function(){this.eachItem(function(e){e.enable()})},onResize:function(e,t){this.panel.setSize(e,t),this.panel.doLayout()},reset:function(){this.originalValue?(this.eachItem(function(e){e.setValue&&(e.setValue(!1),e.originalValue=e.getValue())}),this.resetOriginal=!0,this.setValue(this.originalValue),delete this.resetOriginal):this.eachItem(function(e){e.reset&&e.reset()}),function(){this.clearInvalid()}.defer(50,this)},setValue:function(){return this.rendered?this.onSetValue.apply(this,arguments):(this.buffered=!0,this.value=arguments),this},onSetValue:function(e,t){if(1==arguments.length)if(Ext.isArray(e))Ext.each(e,function(e,t){if(Ext.isObject(e)&&e.setValue)e.setValue(!0),this.resetOriginal===!0&&(e.originalValue=e.getValue());else{var i=this.items.itemAt(t);i&&i.setValue(e)}},this);else if(Ext.isObject(e))for(var i in e){var s=this.getBox(i);s&&s.setValue(e[i])}else this.setValueForItem(e);else{var s=this.getBox(e);s&&s.setValue(t)}},beforeDestroy:function(){Ext.destroy(this.panel),this.rendered||Ext.destroy(this.items),Ext.form.CheckboxGroup.superclass.beforeDestroy.call(this)},setValueForItem:function(e){e=String(e).split(","),this.eachItem(function(t){e.indexOf(t.inputValue)>-1&&t.setValue(!0)})},getBox:function(e){var t=null;return this.eachItem(function(i){return e==i||i.dataIndex==e||i.id==e||i.getName()==e?(t=i,!1):void 0}),t},getValue:function(){var e=[];return this.eachItem(function(t){t.checked&&e.push(t)}),e},eachItem:function(e,t){this.items&&this.items.each&&this.items.each(e,t||this)},getRawValue:Ext.emptyFn,setRawValue:Ext.emptyFn}),Ext.reg("checkboxgroup",Ext.form.CheckboxGroup),Ext.form.CompositeField=Ext.extend(Ext.form.Field,{defaultMargins:"0 5 0 0",skipLastItemMargin:!0,isComposite:!0,combineErrors:!0,labelConnector:", ",initComponent:function(){for(var e,t=[],i=this.items,s=0,n=i.length;n>s;s++)e=i[s],Ext.isEmpty(e.ref)||(e.ref="../"+e.ref),t.push(e.fieldLabel),Ext.applyIf(e,this.defaults),s==n-1&&this.skipLastItemMargin||Ext.applyIf(e,{margins:this.defaultMargins});this.fieldLabel=this.fieldLabel||this.buildLabel(t),this.fieldErrors=new Ext.util.MixedCollection(!0,function(e){return e.field}),this.fieldErrors.on({scope:this,add:this.updateInvalidMark,remove:this.updateInvalidMark,replace:this.updateInvalidMark}),Ext.form.CompositeField.superclass.initComponent.apply(this,arguments),this.innerCt=new Ext.Container({layout:"hbox",items:this.items,cls:"x-form-composite",defaultMargins:"0 3 0 0",ownerCt:this}),this.innerCt.ownerCt=void 0;var r=this.innerCt.findBy(function(e){return e.isFormField},this);this.items=new Ext.util.MixedCollection,this.items.addAll(r)},onRender:function(e){if(!this.el){var t=this.innerCt;t.render(e),this.el=t.getEl(),this.combineErrors&&this.eachItem(function(e){Ext.apply(e,{markInvalid:this.onFieldMarkInvalid.createDelegate(this,[e],0),clearInvalid:this.onFieldClearInvalid.createDelegate(this,[e],0)})});var i=this.el.parent().parent().child("label",!0);i&&i.setAttribute("for",this.items.items[0].id)}Ext.form.CompositeField.superclass.onRender.apply(this,arguments)},onFieldMarkInvalid:function(e,t){var i=e.getName(),s={field:i,errorName:e.fieldLabel||i,error:t};this.fieldErrors.replace(i,s),e.preventMark||e.el.addClass(e.invalidClass)},onFieldClearInvalid:function(e){this.fieldErrors.removeKey(e.getName()),e.el.removeClass(e.invalidClass)},updateInvalidMark:function(){var e=Ext.isIE6&&Ext.isStrict;if(0==this.fieldErrors.length)this.clearInvalid(),e&&this.clearInvalid.defer(50,this);else{var t=this.buildCombinedErrorMessage(this.fieldErrors.items);this.sortErrors(),this.markInvalid(t),e&&this.markInvalid(t)}},validateValue:function(e,t){var i=!0;return this.eachItem(function(e){e.isValid(t)||(i=!1)}),i},buildCombinedErrorMessage:function(e){for(var t,i=[],s=0,n=e.length;n>s;s++)t=e[s],i.push(String.format("{0}: {1}",t.errorName,t.error));return i.join("<br />")},sortErrors:function(){var e=this.items;this.fieldErrors.sort("ASC",function(t,i){var s=function(e){return function(t){return t.getName()==e}},n=e.findIndexBy(s(t.field)),r=e.findIndexBy(s(i.field));return r>n?-1:1})},reset:function(){this.eachItem(function(e){e.reset()}),function(){this.clearInvalid()}.defer(50,this)},clearInvalidChildren:function(){this.eachItem(function(e){e.clearInvalid()})},buildLabel:function(e){return Ext.clean(e).join(this.labelConnector)},isDirty:function(){if(this.disabled||!this.rendered)return!1;var e=!1;return this.eachItem(function(t){return t.isDirty()?(e=!0,!1):void 0}),e},eachItem:function(e,t){this.items&&this.items.each&&this.items.each(e,t||this)},onResize:function(e,t){var i=this.innerCt;this.rendered&&i.rendered&&i.setSize(e,t),Ext.form.CompositeField.superclass.onResize.apply(this,arguments)},doLayout:function(e,t){if(this.rendered){var i=this.innerCt;i.forceLayout=this.ownerCt.forceLayout,i.doLayout(e,t)}},beforeDestroy:function(){Ext.destroy(this.innerCt),Ext.form.CompositeField.superclass.beforeDestroy.call(this)},setReadOnly:function(e){void 0==e&&(e=!0),e=!!e,this.rendered&&this.eachItem(function(t){t.setReadOnly(e)}),this.readOnly=e},onShow:function(){Ext.form.CompositeField.superclass.onShow.call(this),this.doLayout()},onDisable:function(){this.eachItem(function(e){e.disable()})},onEnable:function(){this.eachItem(function(e){e.enable()})}}),Ext.reg("compositefield",Ext.form.CompositeField),Ext.form.Radio=Ext.extend(Ext.form.Checkbox,{inputType:"radio",markInvalid:Ext.emptyFn,clearInvalid:Ext.emptyFn,getGroupValue:function(){var e=this.el.up("form")||Ext.getBody(),t=e.child('input[name="'+this.el.dom.name+'"]:checked',!0);return t?t.value:null},setValue:function(e){var t,i,s;return"boolean"==typeof e?Ext.form.Radio.superclass.setValue.call(this,e):this.rendered&&(t=this.getCheckEl(),s=t.child('input[name="'+this.el.dom.name+'"][value="'+e+'"]',!0),s&&Ext.getCmp(s.id).setValue(!0)),this.rendered&&this.checked&&(t=t||this.getCheckEl(),i=this.getCheckEl().select('input[name="'+this.el.dom.name+'"]'),i.each(function(e){e.dom.id!=this.id&&Ext.getCmp(e.dom.id).setValue(!1)},this)),this},getCheckEl:function(){return this.inGroup?this.el.up(".x-form-radio-group"):this.el.up("form")||Ext.getBody()}}),Ext.reg("radio",Ext.form.Radio),Ext.form.RadioGroup=Ext.extend(Ext.form.CheckboxGroup,{allowBlank:!0,blankText:"You must select one item in this group",defaultType:"radio",groupCls:"x-form-radio-group",getValue:function(){var e=null;return this.eachItem(function(t){return t.checked?(e=t,!1):void 0}),e},onSetValue:function(e,t){if(arguments.length>1){var i=this.getBox(e);i&&(i.setValue(t),i.checked&&this.eachItem(function(e){e!==i&&e.setValue(!1)}))}else this.setValueForItem(e)},setValueForItem:function(e){e=String(e).split(",")[0],this.eachItem(function(t){t.setValue(e==t.inputValue)})},fireChecked:function(){this.checkTask||(this.checkTask=new Ext.util.DelayedTask(this.bufferChecked,this)),this.checkTask.delay(10)},bufferChecked:function(){var e=null;this.eachItem(function(t){return t.checked?(e=t,!1):void 0}),this.fireEvent("change",this,e)},onDestroy:function(){this.checkTask&&(this.checkTask.cancel(),this.checkTask=null),Ext.form.RadioGroup.superclass.onDestroy.call(this)}}),Ext.reg("radiogroup",Ext.form.RadioGroup),Ext.form.Hidden=Ext.extend(Ext.form.Field,{inputType:"hidden",shouldLayout:!1,onRender:function(){Ext.form.Hidden.superclass.onRender.apply(this,arguments)},initEvents:function(){this.originalValue=this.getValue()},setSize:Ext.emptyFn,setWidth:Ext.emptyFn,setHeight:Ext.emptyFn,setPosition:Ext.emptyFn,setPagePosition:Ext.emptyFn,markInvalid:Ext.emptyFn,clearInvalid:Ext.emptyFn}),Ext.reg("hidden",Ext.form.Hidden),Ext.form.BasicForm=Ext.extend(Ext.util.Observable,{constructor:function(e,t){Ext.apply(this,t),Ext.isString(this.paramOrder)&&(this.paramOrder=this.paramOrder.split(/[\s,|]/)),this.items=new Ext.util.MixedCollection(!1,function(e){return e.getItemId()}),this.addEvents("beforeaction","actionfailed","actioncomplete"),e&&this.initEl(e),Ext.form.BasicForm.superclass.constructor.call(this)},timeout:30,paramOrder:void 0,paramsAsHash:!1,waitTitle:"Please Wait...",activeAction:null,trackResetOnLoad:!1,initEl:function(e){this.el=Ext.get(e),this.id=this.el.id||Ext.id(),this.standardSubmit||this.el.on("submit",this.onSubmit,this),this.el.addClass("x-form")},getEl:function(){return this.el},onSubmit:function(e){e.stopEvent()},destroy:function(e){e!==!0&&(this.items.each(function(e){Ext.destroy(e)}),Ext.destroy(this.el)),this.items.clear(),this.purgeListeners()},isValid:function(){var e=!0;return this.items.each(function(t){t.validate()||(e=!1)}),e},isDirty:function(){var e=!1;return this.items.each(function(t){return t.isDirty()?(e=!0,!1):void 0}),e},doAction:function(e,t){return Ext.isString(e)&&(e=new Ext.form.Action.ACTION_TYPES[e](this,t)),this.fireEvent("beforeaction",this,e)!==!1&&(this.beforeAction(e),e.run.defer(100,e)),this},submit:function(e){if(e=e||{},this.standardSubmit){var t=e.clientValidation===!1||this.isValid();if(t){var i=this.el.dom;this.url&&Ext.isEmpty(i.action)&&(i.action=this.url),i.submit()}return t}var s=String.format("{0}submit",this.api?"direct":"");return this.doAction(s,e),this},load:function(e){var t=String.format("{0}load",this.api?"direct":"");return this.doAction(t,e),this},updateRecord:function(e){e.beginEdit();var t,i,s=e.fields;return s.each(function(s){t=this.findField(s.name),t&&(i=t.getValue(),Ext.type(i)!==!1&&i.getGroupValue?i=i.getGroupValue():t.eachItem&&(i=[],t.eachItem(function(e){i.push(e.getValue())})),e.set(s.name,i))},this),e.endEdit(),this},loadRecord:function(e){return this.setValues(e.data),this},beforeAction:function(e){this.items.each(function(e){e.isFormField&&e.syncValue&&e.syncValue()});var t=e.options;t.waitMsg&&(this.waitMsgTarget===!0?this.el.mask(t.waitMsg,"x-mask-loading"):this.waitMsgTarget?(this.waitMsgTarget=Ext.get(this.waitMsgTarget),this.waitMsgTarget.mask(t.waitMsg,"x-mask-loading")):Ext.MessageBox.wait(t.waitMsg,t.waitTitle||this.waitTitle))},afterAction:function(e,t){this.activeAction=null;var i=e.options;i.waitMsg&&(this.waitMsgTarget===!0?this.el.unmask():this.waitMsgTarget?this.waitMsgTarget.unmask():(Ext.MessageBox.updateProgress(1),Ext.MessageBox.hide())),t?(i.reset&&this.reset(),Ext.callback(i.success,i.scope,[this,e]),this.fireEvent("actioncomplete",this,e)):(Ext.callback(i.failure,i.scope,[this,e]),this.fireEvent("actionfailed",this,e))},findField:function(e){var t=this.items.get(e);if(!Ext.isObject(t)){var i=function(s){if(s.isFormField){if(s.dataIndex==e||s.id==e||s.getName()==e)return t=s,!1;if(s.isComposite)return s.items.each(i);if(s instanceof Ext.form.CheckboxGroup&&s.rendered)return s.eachItem(i)}};this.items.each(i)}return t||null},markInvalid:function(e){if(Ext.isArray(e))for(var t=0,i=e.length;i>t;t++){var s=e[t],n=this.findField(s.id);n&&n.markInvalid(s.msg)}else{var r,a;for(a in e)!Ext.isFunction(e[a])&&(r=this.findField(a))&&r.markInvalid(e[a])}return this},setValues:function(e){if(Ext.isArray(e))for(var t=0,i=e.length;i>t;t++){var s=e[t],n=this.findField(s.id);n&&(n.setValue(s.value),this.trackResetOnLoad&&(n.originalValue=n.getValue()))}else{var r,a;for(a in e)!Ext.isFunction(e[a])&&(r=this.findField(a))&&(r.setValue(e[a]),this.trackResetOnLoad&&(r.originalValue=r.getValue()))}return this},getValues:function(e){var t=Ext.lib.Ajax.serializeForm(this.el.dom);return e===!0?t:Ext.urlDecode(t)},getFieldValues:function(e){var t,i,s,n={};return this.items.each(function(r){r.disabled||e===!0&&!r.isDirty()||(t=r.getName(),i=n[t],s=r.getValue(),Ext.isDefined(i)?Ext.isArray(i)?n[t].push(s):n[t]=[i,s]:n[t]=s)}),n},clearInvalid:function(){return this.items.each(function(e){e.clearInvalid()}),this},reset:function(){return this.items.each(function(e){e.reset()}),this},add:function(){return this.items.addAll(Array.prototype.slice.call(arguments,0)),this},remove:function(e){return this.items.remove(e),this},cleanDestroyed:function(){this.items.filterBy(function(e){return!!e.isDestroyed}).each(this.remove,this)},render:function(){return this.items.each(function(e){e.isFormField&&!e.rendered&&document.getElementById(e.id)&&e.applyToMarkup(e.id)}),this},applyToFields:function(e){return this.items.each(function(t){Ext.apply(t,e)}),this},applyIfToFields:function(e){return this.items.each(function(t){Ext.applyIf(t,e)}),this},callFieldMethod:function(e,t){return t=t||[],this.items.each(function(i){Ext.isFunction(i[e])&&i[e].apply(i,t)}),this}}),Ext.BasicForm=Ext.form.BasicForm,Ext.FormPanel=Ext.extend(Ext.Panel,{minButtonWidth:75,labelAlign:"left",monitorValid:!1,monitorPoll:200,layout:"form",initComponent:function(){this.form=this.createForm(),Ext.FormPanel.superclass.initComponent.call(this),this.bodyCfg={tag:"form",cls:this.baseCls+"-body",method:this.method||"POST",id:this.formId||Ext.id()},this.fileUpload&&(this.bodyCfg.enctype="multipart/form-data"),this.initItems(),this.addEvents("clientvalidation"),this.relayEvents(this.form,["beforeaction","actionfailed","actioncomplete"])},createForm:function(){var e=Ext.applyIf({listeners:{}},this.initialConfig);return new Ext.form.BasicForm(null,e)},initFields:function(){var e=this.form,t=this,i=function(s){t.isField(s)?e.add(s):s.findBy&&s!=t&&(t.applySettings(s),s.items&&s.items.each&&s.items.each(i,this))};this.items.each(i,this)},applySettings:function(e){var t=e.ownerCt;Ext.applyIf(e,{labelAlign:t.labelAlign,labelWidth:t.labelWidth,itemCls:t.itemCls})},getLayoutTarget:function(){return this.form.el},getForm:function(){return this.form},onRender:function(e,t){this.initFields(),Ext.FormPanel.superclass.onRender.call(this,e,t),this.form.initEl(this.body)},beforeDestroy:function(){this.stopMonitoring(),this.form.destroy(!0),Ext.FormPanel.superclass.beforeDestroy.call(this)},isField:function(e){return!!(e.setValue&&e.getValue&&e.markInvalid&&e.clearInvalid)},initEvents:function(){Ext.FormPanel.superclass.initEvents.call(this),this.on({scope:this,add:this.onAddEvent,remove:this.onRemoveEvent}),this.monitorValid&&this.startMonitoring()},onAdd:function(e){Ext.FormPanel.superclass.onAdd.call(this,e),this.processAdd(e)},onAddEvent:function(e,t){e!==this&&this.processAdd(t)},processAdd:function(e){this.isField(e)?this.form.add(e):e.findBy&&(this.applySettings(e),this.form.add.apply(this.form,e.findBy(this.isField)))},onRemove:function(e){Ext.FormPanel.superclass.onRemove.call(this,e),this.processRemove(e)},onRemoveEvent:function(e,t){e!==this&&this.processRemove(t)},processRemove:function(e){this.destroying||(this.isField(e)?this.form.remove(e):e.findBy&&(Ext.each(e.findBy(this.isField),this.form.remove,this.form),this.form.cleanDestroyed()))},startMonitoring:function(){this.validTask||(this.validTask=new Ext.util.TaskRunner,this.validTask.start({run:this.bindHandler,interval:this.monitorPoll||200,scope:this}))},stopMonitoring:function(){this.validTask&&(this.validTask.stopAll(),this.validTask=null)},load:function(){this.form.load.apply(this.form,arguments)},onDisable:function(){Ext.FormPanel.superclass.onDisable.call(this),this.form&&this.form.items.each(function(){this.disable()})},onEnable:function(){Ext.FormPanel.superclass.onEnable.call(this),this.form&&this.form.items.each(function(){this.enable()})},bindHandler:function(){var e=!0;if(this.form.items.each(function(t){return t.isValid(!0)?void 0:(e=!1,!1)}),this.fbar)for(var t=this.fbar.items.items,i=0,s=t.length;s>i;i++){var n=t[i];n.formBind===!0&&n.disabled===e&&n.setDisabled(!e)}this.fireEvent("clientvalidation",this,e)}}),Ext.reg("form",Ext.FormPanel),Ext.form.FormPanel=Ext.FormPanel,Ext.form.FieldSet=Ext.extend(Ext.Panel,{baseCls:"x-fieldset",layout:"form",animCollapse:!1,onRender:function(e,t){if(this.el||(this.el=document.createElement("fieldset"),this.el.id=this.id,(this.title||this.header||this.checkboxToggle)&&(this.el.appendChild(document.createElement("legend")).className=this.baseCls+"-header")),Ext.form.FieldSet.superclass.onRender.call(this,e,t),this.checkboxToggle){var i="object"==typeof this.checkboxToggle?this.checkboxToggle:{tag:"input",type:"checkbox",name:this.checkboxName||this.id+"-checkbox"};this.checkbox=this.header.insertFirst(i),this.checkbox.dom.checked=!this.collapsed,this.mon(this.checkbox,"click",this.onCheckClick,this)}},onCollapse:function(e,t){this.checkbox&&(this.checkbox.dom.checked=!1),Ext.form.FieldSet.superclass.onCollapse.call(this,e,t)},onExpand:function(e,t){this.checkbox&&(this.checkbox.dom.checked=!0),Ext.form.FieldSet.superclass.onExpand.call(this,e,t)},onCheckClick:function(){this[this.checkbox.dom.checked?"expand":"collapse"]()}}),Ext.reg("fieldset",Ext.form.FieldSet),Ext.form.HtmlEditor=Ext.extend(Ext.form.Field,{enableFormat:!0,enableFontSize:!0,enableColors:!0,enableAlignments:!0,enableLists:!0,enableSourceEdit:!0,enableLinks:!0,enableFont:!0,createLinkText:"Please enter the URL for the link:",defaultLinkValue:"http://",fontFamilies:["Arial","Courier New","Tahoma","Times New Roman","Verdana"],defaultFont:"tahoma",defaultValue:Ext.isOpera||Ext.isIE6?"&#160;":"&#8203;",actionMode:"wrap",validationEvent:!1,deferHeight:!0,initialized:!1,activated:!1,sourceEditMode:!1,onFocus:Ext.emptyFn,iframePad:3,hideMode:"offsets",defaultAutoCreate:{tag:"textarea",style:"width:500px;height:300px;",autocomplete:"off"},initComponent:function(){this.addEvents("initialize","activate","beforesync","beforepush","sync","push","editmodechange"),Ext.form.HtmlEditor.superclass.initComponent.call(this)},createFontOptions:function(){for(var e,t,i=[],s=this.fontFamilies,n=0,r=s.length;r>n;n++)e=s[n],t=e.toLowerCase(),i.push('<option value="',t,'" style="font-family:',e,';"',this.defaultFont==t?' selected="true">':">",e,"</option>");return i.join("")},createToolbar:function(e){function t(t,i,n){return{itemId:t,cls:"x-btn-icon",iconCls:"x-edit-"+t,enableToggle:i!==!1,scope:e,handler:n||e.relayBtnCmd,clickEvent:"mousedown",tooltip:s?e.buttonTips[t]||void 0:void 0,overflowText:e.buttonTips[t].title||void 0,tabIndex:-1}}var i=[],s=Ext.QuickTips&&Ext.QuickTips.isEnabled();if(this.enableFont&&!Ext.isSafari2){var n=new Ext.Toolbar.Item({autoEl:{tag:"select",cls:"x-font-select",html:this.createFontOptions()}});i.push(n,"-")}this.enableFormat&&i.push(t("bold"),t("italic"),t("underline")),this.enableFontSize&&i.push("-",t("increasefontsize",!1,this.adjustFont),t("decreasefontsize",!1,this.adjustFont)),this.enableColors&&i.push("-",{itemId:"forecolor",cls:"x-btn-icon",iconCls:"x-edit-forecolor",clickEvent:"mousedown",tooltip:s?e.buttonTips.forecolor||void 0:void 0,tabIndex:-1,menu:new Ext.menu.ColorMenu({allowReselect:!0,focus:Ext.emptyFn,value:"000000",plain:!0,listeners:{scope:this,select:function(e,t){this.execCmd("forecolor",Ext.isWebKit||Ext.isIE?"#"+t:t),this.deferFocus()}},clickEvent:"mousedown"})},{itemId:"backcolor",cls:"x-btn-icon",iconCls:"x-edit-backcolor",clickEvent:"mousedown",tooltip:s?e.buttonTips.backcolor||void 0:void 0,tabIndex:-1,menu:new Ext.menu.ColorMenu({focus:Ext.emptyFn,value:"FFFFFF",plain:!0,allowReselect:!0,listeners:{scope:this,select:function(e,t){Ext.isGecko?(this.execCmd("useCSS",!1),this.execCmd("hilitecolor",t),this.execCmd("useCSS",!0),this.deferFocus()):(this.execCmd(Ext.isOpera?"hilitecolor":"backcolor",Ext.isWebKit||Ext.isIE?"#"+t:t),this.deferFocus())}},clickEvent:"mousedown"})}),this.enableAlignments&&i.push("-",t("justifyleft"),t("justifycenter"),t("justifyright")),Ext.isSafari2||(this.enableLinks&&i.push("-",t("createlink",!1,this.createLink)),this.enableLists&&i.push("-",t("insertorderedlist"),t("insertunorderedlist")),this.enableSourceEdit&&i.push("-",t("sourceedit",!0,function(){this.toggleSourceEdit(!this.sourceEditMode)})));var r=new Ext.Toolbar({renderTo:this.wrap.dom.firstChild,items:i});n&&(this.fontSelect=n.el,this.mon(this.fontSelect,"change",function(){var e=this.fontSelect.dom.value;this.relayCmd("fontname",e),this.deferFocus()},this)),this.mon(r.el,"click",function(e){e.preventDefault()}),this.tb=r,this.tb.doLayout()},onDisable:function(){this.wrap.mask(),Ext.form.HtmlEditor.superclass.onDisable.call(this)},onEnable:function(){this.wrap.unmask(),Ext.form.HtmlEditor.superclass.onEnable.call(this)},setReadOnly:function(e){if(Ext.form.HtmlEditor.superclass.setReadOnly.call(this,e),this.initialized){Ext.isIE?this.getEditorBody().contentEditable=!e:this.setDesignMode(!e);var t=this.getEditorBody();t&&(t.style.cursor=this.readOnly?"default":"text"),this.disableItems(e)}},getDocMarkup:function(){var e=Ext.fly(this.iframe).getHeight()-2*this.iframePad;return String.format('<html><head><style type="text/css">body{border: 0; margin: 0; padding: {0}px; height: {1}px; cursor: text}</style></head><body></body></html>',this.iframePad,e)},getEditorBody:function(){var e=this.getDoc();return e.body||e.documentElement},getDoc:function(){return Ext.isIE?this.getWin().document:this.iframe.contentDocument||this.getWin().document},getWin:function(){return Ext.isIE?this.iframe.contentWindow:window.frames[this.iframe.name]},onRender:function(e,t){if(Ext.form.HtmlEditor.superclass.onRender.call(this,e,t),this.el.dom.style.border="0 none",this.el.dom.setAttribute("tabIndex",-1),this.el.addClass("x-hidden"),Ext.isIE&&this.el.applyStyles("margin-top:-1px;margin-bottom:-1px;"),this.wrap=this.el.wrap({cls:"x-html-editor-wrap",cn:{cls:"x-html-editor-tb"}}),this.createToolbar(this),this.disableItems(!0),this.tb.doLayout(),this.createIFrame(),!this.width){var i=this.el.getSize();this.setSize(i.width,this.height||i.height)}this.resizeEl=this.positionEl=this.wrap},createIFrame:function(){var e=document.createElement("iframe");e.name=Ext.id(),e.frameBorder="0",e.style.overflow="auto",e.src=Ext.SSL_SECURE_URL,this.wrap.dom.appendChild(e),this.iframe=e,this.monitorTask=Ext.TaskMgr.start({run:this.checkDesignMode,scope:this,interval:100})},initFrame:function(){Ext.TaskMgr.stop(this.monitorTask);var e=this.getDoc();this.win=this.getWin(),e.open(),e.write(this.getDocMarkup()),e.close();var t={run:function(){var e=this.getDoc();(e.body||"complete"==e.readyState)&&(Ext.TaskMgr.stop(t),this.setDesignMode(!0),this.initEditor.defer(10,this))},interval:10,duration:1e4,scope:this};Ext.TaskMgr.start(t)},checkDesignMode:function(){if(this.wrap&&this.wrap.dom.offsetWidth){var e=this.getDoc();if(!e)return;e.editorInitialized&&"on"==this.getDesignMode()||this.initFrame()}},setDesignMode:function(e){var t=this.getDoc();t&&(this.readOnly&&(e=!1),t.designMode=/on|true/i.test(String(e).toLowerCase())?"on":"off")},getDesignMode:function(){var e=this.getDoc();return e?String(e.designMode).toLowerCase():""},disableItems:function(e){this.fontSelect&&(this.fontSelect.dom.disabled=e),this.tb.items.each(function(t){"sourceedit"!=t.getItemId()&&t.setDisabled(e)})},onResize:function(e,t){if(Ext.form.HtmlEditor.superclass.onResize.apply(this,arguments),this.el&&this.iframe){if(Ext.isNumber(e)){var i=e-this.wrap.getFrameWidth("lr");this.el.setWidth(i),this.tb.setWidth(i),this.iframe.style.width=Math.max(i,0)+"px"}if(Ext.isNumber(t)){var s=t-this.wrap.getFrameWidth("tb")-this.tb.el.getHeight();this.el.setHeight(s),this.iframe.style.height=Math.max(s,0)+"px";var n=this.getEditorBody();n&&(n.style.height=Math.max(s-2*this.iframePad,0)+"px")}}},toggleSourceEdit:function(e){var t,i;void 0===e&&(e=!this.sourceEditMode),this.sourceEditMode=e===!0;var s=this.tb.getComponent("sourceedit");(s.pressed===this.sourceEditMode||(s.toggle(this.sourceEditMode),s.xtbHidden))&&(this.sourceEditMode?(this.previousSize=this.getSize(),t=Ext.get(this.iframe).getHeight(),this.disableItems(!0),this.syncValue(),this.iframe.className="x-hidden",this.el.removeClass("x-hidden"),this.el.dom.removeAttribute("tabIndex"),this.el.focus(),this.el.dom.style.height=t+"px"):(i=parseInt(this.el.dom.style.height,10),this.initialized&&this.disableItems(this.readOnly),this.pushValue(),this.iframe.className="",this.el.addClass("x-hidden"),this.el.dom.setAttribute("tabIndex",-1),this.deferFocus(),this.setSize(this.previousSize),delete this.previousSize,this.iframe.style.height=i+"px"),this.fireEvent("editmodechange",this,this.sourceEditMode))},createLink:function(){var e=prompt(this.createLinkText,this.defaultLinkValue);e&&"http://"!=e&&this.relayCmd("createlink",e)},initEvents:function(){this.originalValue=this.getValue()},markInvalid:Ext.emptyFn,clearInvalid:Ext.emptyFn,setValue:function(e){return Ext.form.HtmlEditor.superclass.setValue.call(this,e),this.pushValue(),this},cleanHtml:function(e){return e=String(e),Ext.isWebKit&&(e=e.replace(/\sclass="(?:Apple-style-span|khtml-block-placeholder)"/gi,"")),e.charCodeAt(0)==this.defaultValue.replace(/\D/g,"")&&(e=e.substring(1)),e},syncValue:function(){if(this.initialized){var e=this.getEditorBody(),t=e.innerHTML;if(Ext.isWebKit){var i=e.getAttribute("style"),s=i.match(/text-align:(.*?);/i);s&&s[1]&&(t='<div style="'+s[0]+'">'+t+"</div>")}t=this.cleanHtml(t),this.fireEvent("beforesync",this,t)!==!1&&(this.el.dom.value=t,this.fireEvent("sync",this,t))}},getValue:function(){return this[this.sourceEditMode?"pushValue":"syncValue"](),Ext.form.HtmlEditor.superclass.getValue.call(this)},pushValue:function(){if(this.initialized){var e=this.el.dom.value;!this.activated&&e.length<1&&(e=this.defaultValue),this.fireEvent("beforepush",this,e)!==!1&&(this.getEditorBody().innerHTML=e,Ext.isGecko&&(this.setDesignMode(!1),this.setDesignMode(!0)),this.fireEvent("push",this,e))}},deferFocus:function(){this.focus.defer(10,this)},focus:function(){this.win&&!this.sourceEditMode?this.win.focus():this.el.focus()},initEditor:function(){try{var e,t,i=this.getEditorBody(),s=this.el.getStyles("font-size","font-family","background-image","background-repeat","background-color","color");if(s["background-attachment"]="fixed",i.bgProperties="fixed",Ext.DomHelper.applyStyles(i,s),e=this.getDoc())try{Ext.EventManager.removeAll(e)}catch(n){}t=this.onEditorEvent.createDelegate(this),Ext.EventManager.on(e,{mousedown:t,dblclick:t,click:t,keyup:t,buffer:100}),Ext.isGecko&&Ext.EventManager.on(e,"keypress",this.applyCommand,this),(Ext.isIE||Ext.isWebKit||Ext.isOpera)&&Ext.EventManager.on(e,"keydown",this.fixKeys,this),e.editorInitialized=!0,this.initialized=!0,this.pushValue(),this.setReadOnly(this.readOnly),this.fireEvent("initialize",this)}catch(n){}},beforeDestroy:function(){if(this.monitorTask&&Ext.TaskMgr.stop(this.monitorTask),this.rendered){Ext.destroy(this.tb);var e=this.getDoc();if(e)try{Ext.EventManager.removeAll(e);for(var t in e)delete e[t]}catch(i){}this.wrap&&(this.wrap.dom.innerHTML="",this.wrap.remove())}Ext.form.HtmlEditor.superclass.beforeDestroy.call(this)},onFirstFocus:function(){if(this.activated=!0,this.disableItems(this.readOnly),Ext.isGecko){this.win.focus();var e=this.win.getSelection();if(!e.focusNode||3!=e.focusNode.nodeType){var t=e.getRangeAt(0);t.selectNodeContents(this.getEditorBody()),t.collapse(!0),this.deferFocus()}try{this.execCmd("useCSS",!0),this.execCmd("styleWithCSS",!1)}catch(i){}}this.fireEvent("activate",this)},adjustFont:function(e){var t="increasefontsize"==e.getItemId()?1:-1,i=this.getDoc(),s=parseInt(i.queryCommandValue("FontSize")||2,10);Ext.isSafari&&!Ext.isSafari2||Ext.isChrome||Ext.isAir?(s=10>=s?1+t:13>=s?2+t:16>=s?3+t:18>=s?4+t:24>=s?5+t:6+t,s=s.constrain(1,6)):(Ext.isSafari&&(t*=2),s=Math.max(1,s+t)+(Ext.isSafari?"px":0)),this.execCmd("FontSize",s)},onEditorEvent:function(){this.updateToolbar()},updateToolbar:function(){if(!this.readOnly){if(!this.activated)return this.onFirstFocus(),void 0;var e=this.tb.items.map,t=this.getDoc();if(this.enableFont&&!Ext.isSafari2){var i=(t.queryCommandValue("FontName")||this.defaultFont).toLowerCase();i!=this.fontSelect.dom.value&&(this.fontSelect.dom.value=i)}this.enableFormat&&(e.bold.toggle(t.queryCommandState("bold")),e.italic.toggle(t.queryCommandState("italic")),e.underline.toggle(t.queryCommandState("underline"))),this.enableAlignments&&(e.justifyleft.toggle(t.queryCommandState("justifyleft")),e.justifycenter.toggle(t.queryCommandState("justifycenter")),e.justifyright.toggle(t.queryCommandState("justifyright"))),!Ext.isSafari2&&this.enableLists&&(e.insertorderedlist.toggle(t.queryCommandState("insertorderedlist")),e.insertunorderedlist.toggle(t.queryCommandState("insertunorderedlist"))),Ext.menu.MenuMgr.hideAll(),this.syncValue()}},relayBtnCmd:function(e){this.relayCmd(e.getItemId())},relayCmd:function(e,t){!function(){this.focus(),this.execCmd(e,t),this.updateToolbar()}.defer(10,this)},execCmd:function(e,t){var i=this.getDoc();i.execCommand(e,!1,void 0===t?null:t),this.syncValue()},applyCommand:function(e){if(e.ctrlKey){var t,i=e.getCharCode();if(i>0){switch(i=String.fromCharCode(i)){case"b":t="bold";break;case"i":t="italic";break;case"u":t="underline"}t&&(this.win.focus(),this.execCmd(t),this.deferFocus(),e.preventDefault())}}},insertAtCursor:function(e){if(this.activated)if(Ext.isIE){this.win.focus();var t=this.getDoc(),i=t.selection.createRange();i&&(i.pasteHTML(e),this.syncValue(),this.deferFocus())}else this.win.focus(),this.execCmd("InsertHTML",e),this.deferFocus()},fixKeys:function(){return Ext.isIE?function(e){var t,i=e.getKey(),s=this.getDoc();if(i==e.TAB)e.stopEvent(),t=s.selection.createRange(),t&&(t.collapse(!0),t.pasteHTML("&nbsp;&nbsp;&nbsp;&nbsp;"),this.deferFocus());else if(i==e.ENTER&&(t=s.selection.createRange())){var n=t.parentElement();n&&"li"==n.tagName.toLowerCase()||(e.stopEvent(),t.pasteHTML("<br />"),t.collapse(!1),t.select())}}:Ext.isOpera?function(e){var t=e.getKey();t==e.TAB&&(e.stopEvent(),this.win.focus(),this.execCmd("InsertHTML","&nbsp;&nbsp;&nbsp;&nbsp;"),this.deferFocus())}:Ext.isWebKit?function(e){var t=e.getKey();t==e.TAB?(e.stopEvent(),this.execCmd("InsertText","	"),this.deferFocus()):t==e.ENTER&&(e.stopEvent(),this.execCmd("InsertHtml","<br /><br />"),this.deferFocus())}:void 0}(),getToolbar:function(){return this.tb},buttonTips:{bold:{title:"Bold (Ctrl+B)",text:"Make the selected text bold.",cls:"x-html-editor-tip"},italic:{title:"Italic (Ctrl+I)",text:"Make the selected text italic.",cls:"x-html-editor-tip"},underline:{title:"Underline (Ctrl+U)",text:"Underline the selected text.",cls:"x-html-editor-tip"},increasefontsize:{title:"Grow Text",text:"Increase the font size.",cls:"x-html-editor-tip"},decreasefontsize:{title:"Shrink Text",text:"Decrease the font size.",cls:"x-html-editor-tip"},backcolor:{title:"Text Highlight Color",text:"Change the background color of the selected text.",cls:"x-html-editor-tip"},forecolor:{title:"Font Color",text:"Change the color of the selected text.",cls:"x-html-editor-tip"},justifyleft:{title:"Align Text Left",text:"Align text to the left.",cls:"x-html-editor-tip"},justifycenter:{title:"Center Text",text:"Center text in the editor.",cls:"x-html-editor-tip"},justifyright:{title:"Align Text Right",text:"Align text to the right.",cls:"x-html-editor-tip"},insertunorderedlist:{title:"Bullet List",text:"Start a bulleted list.",cls:"x-html-editor-tip"},insertorderedlist:{title:"Numbered List",text:"Start a numbered list.",cls:"x-html-editor-tip"},createlink:{title:"Hyperlink",text:"Make the selected text a hyperlink.",cls:"x-html-editor-tip"},sourceedit:{title:"Source Edit",text:"Switch to source editing mode.",cls:"x-html-editor-tip"}}}),Ext.reg("htmleditor",Ext.form.HtmlEditor),Ext.form.TimeField=Ext.extend(Ext.form.ComboBox,{minValue:void 0,maxValue:void 0,minText:"The time in this field must be equal to or after {0}",maxText:"The time in this field must be equal to or before {0}",invalidText:"{0} is not a valid time",format:"g:i A",altFormats:"g:ia|g:iA|g:i a|g:i A|h:i|g:i|H:i|ga|ha|gA|h a|g a|g A|gi|hi|gia|hia|g|H|gi a|hi a|giA|hiA|gi A|hi A",increment:15,mode:"local",triggerAction:"all",typeAhead:!1,initDate:"1/1/2008",initDateFormat:"j/n/Y",initComponent:function(){Ext.isDefined(this.minValue)&&this.setMinValue(this.minValue,!0),Ext.isDefined(this.maxValue)&&this.setMaxValue(this.maxValue,!0),this.store||this.generateStore(!0),Ext.form.TimeField.superclass.initComponent.call(this)
},setMinValue:function(e,t){return this.setLimit(e,!0,t),this},setMaxValue:function(e,t){return this.setLimit(e,!1,t),this},generateStore:function(e){for(var t=this.minValue||new Date(this.initDate).clearTime(),i=this.maxValue||new Date(this.initDate).clearTime().add("mi",1439),s=[];i>=t;)s.push(t.dateFormat(this.format)),t=t.add("mi",this.increment);this.bindStore(s,e)},setLimit:function(e,t,i){var s;if(Ext.isString(e)?s=this.parseDate(e):Ext.isDate(e)&&(s=e),s){var n=new Date(this.initDate).clearTime();n.setHours(s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()),this[t?"minValue":"maxValue"]=n,i||this.generateStore()}},getValue:function(){var e=Ext.form.TimeField.superclass.getValue.call(this);return this.formatDate(this.parseDate(e))||""},setValue:function(e){return Ext.form.TimeField.superclass.setValue.call(this,this.formatDate(this.parseDate(e)))},validateValue:Ext.form.DateField.prototype.validateValue,formatDate:Ext.form.DateField.prototype.formatDate,parseDate:function(e){if(!e||Ext.isDate(e))return e;var t=this.initDate+" ",i=this.initDateFormat+" ",s=Date.parseDate(t+e,i+this.format),n=this.altFormats;if(!s&&n){this.altFormatsArray||(this.altFormatsArray=n.split("|"));for(var r=0,a=this.altFormatsArray,o=a.length;o>r&&!s;r++)s=Date.parseDate(t+e,i+a[r])}return s}}),Ext.reg("timefield",Ext.form.TimeField),Ext.form.SliderField=Ext.extend(Ext.form.Field,{useTips:!0,tipText:null,actionMode:"wrap",initComponent:function(){var e=Ext.copyTo({id:this.id+"-slider"},this.initialConfig,["vertical","minValue","maxValue","decimalPrecision","keyIncrement","increment","clickToChange","animate"]);if(this.useTips){var t=this.tipText?{getText:this.tipText}:{};e.plugins=[new Ext.slider.Tip(t)]}this.slider=new Ext.Slider(e),Ext.form.SliderField.superclass.initComponent.call(this)},onRender:function(e,t){this.autoCreate={id:this.id,name:this.name,type:"hidden",tag:"input"},Ext.form.SliderField.superclass.onRender.call(this,e,t),this.wrap=this.el.wrap({cls:"x-form-field-wrap"}),this.resizeEl=this.positionEl=this.wrap,this.slider.render(this.wrap)},onResize:function(e,t,i,s){Ext.form.SliderField.superclass.onResize.call(this,e,t,i,s),this.slider.setSize(e,t)},initEvents:function(){Ext.form.SliderField.superclass.initEvents.call(this),this.slider.on("change",this.onChange,this)},onChange:function(e,t){this.setValue(t,void 0,!0)},onEnable:function(){Ext.form.SliderField.superclass.onEnable.call(this),this.slider.enable()},onDisable:function(){Ext.form.SliderField.superclass.onDisable.call(this),this.slider.disable()},beforeDestroy:function(){Ext.destroy(this.slider),Ext.form.SliderField.superclass.beforeDestroy.call(this)},alignErrorIcon:function(){this.errorIcon.alignTo(this.slider.el,"tl-tr",[2,0])},setMinValue:function(e){return this.slider.setMinValue(e),this},setMaxValue:function(e){return this.slider.setMaxValue(e),this},setValue:function(e,t,i){return i||this.slider.setValue(e,t),Ext.form.SliderField.superclass.setValue.call(this,this.slider.getValue())},getValue:function(){return this.slider.getValue()}}),Ext.reg("sliderfield",Ext.form.SliderField),Ext.form.Label=Ext.extend(Ext.BoxComponent,{onRender:function(e,t){this.el||(this.el=document.createElement("label"),this.el.id=this.getId(),this.el.innerHTML=this.text?Ext.util.Format.htmlEncode(this.text):this.html||"",this.forId&&this.el.setAttribute("for",this.forId)),Ext.form.Label.superclass.onRender.call(this,e,t)},setText:function(e,t){var i=t===!1;return this[i?"html":"text"]=e,delete this[i?"text":"html"],this.rendered&&(this.el.dom.innerHTML=t!==!1?Ext.util.Format.htmlEncode(e):e),this}}),Ext.reg("label",Ext.form.Label),Ext.form.Action=function(e,t){this.form=e,this.options=t||{}},Ext.form.Action.CLIENT_INVALID="client",Ext.form.Action.SERVER_INVALID="server",Ext.form.Action.CONNECT_FAILURE="connect",Ext.form.Action.LOAD_FAILURE="load",Ext.form.Action.prototype={type:"default",run:function(){},success:function(){},handleResponse:function(){},failure:function(e){this.response=e,this.failureType=Ext.form.Action.CONNECT_FAILURE,this.form.afterAction(this,!1)},processResponse:function(e){return this.response=e,e.responseText||e.responseXML?(this.result=this.handleResponse(e),this.result):!0},decodeResponse:function(e){try{return Ext.decode(e.responseText)}catch(t){return!1}},getUrl:function(e){var t=this.options.url||this.form.url||this.form.el.dom.action;if(e){var i=this.getParams();i&&(t=Ext.urlAppend(t,i))}return t},getMethod:function(){return(this.options.method||this.form.method||this.form.el.dom.method||"POST").toUpperCase()},getParams:function(){var e=this.form.baseParams,t=this.options.params;return t?"object"==typeof t?t=Ext.urlEncode(Ext.applyIf(t,e)):"string"==typeof t&&e&&(t+="&"+Ext.urlEncode(e)):e&&(t=Ext.urlEncode(e)),t},createCallback:function(e){var e=e||{};return{success:this.success,failure:this.failure,scope:this,timeout:1e3*e.timeout||1e3*this.form.timeout,upload:this.form.fileUpload?this.success:void 0}}},Ext.form.Action.Submit=function(e,t){Ext.form.Action.Submit.superclass.constructor.call(this,e,t)},Ext.extend(Ext.form.Action.Submit,Ext.form.Action,{type:"submit",run:function(){var e=this.options,t=this.getMethod(),i="GET"==t;if(e.clientValidation===!1||this.form.isValid()){if(e.submitEmptyText===!1){var s=this.form.items,n=[],r=function(e){e.el.getValue()==e.emptyText&&(n.push(e),e.el.dom.value=""),e.isComposite&&e.rendered&&e.items.each(r)};s.each(r)}Ext.Ajax.request(Ext.apply(this.createCallback(e),{form:this.form.el.dom,url:this.getUrl(i),method:t,headers:e.headers,params:i?null:this.getParams(),isUpload:this.form.fileUpload})),e.submitEmptyText===!1&&Ext.each(n,function(e){e.applyEmptyText&&e.applyEmptyText()})}else e.clientValidation!==!1&&(this.failureType=Ext.form.Action.CLIENT_INVALID,this.form.afterAction(this,!1))},success:function(e){var t=this.processResponse(e);return t===!0||t.success?(this.form.afterAction(this,!0),void 0):(t.errors&&this.form.markInvalid(t.errors),this.failureType=Ext.form.Action.SERVER_INVALID,this.form.afterAction(this,!1),void 0)},handleResponse:function(e){if(this.form.errorReader){var t=this.form.errorReader.read(e),i=[];if(t.records)for(var s=0,n=t.records.length;n>s;s++){var r=t.records[s];i[s]=r.data}return i.length<1&&(i=null),{success:t.success,errors:i}}return this.decodeResponse(e)}}),Ext.form.Action.Load=function(e,t){Ext.form.Action.Load.superclass.constructor.call(this,e,t),this.reader=this.form.reader},Ext.extend(Ext.form.Action.Load,Ext.form.Action,{type:"load",run:function(){Ext.Ajax.request(Ext.apply(this.createCallback(this.options),{method:this.getMethod(),url:this.getUrl(!1),headers:this.options.headers,params:this.getParams()}))},success:function(e){var t=this.processResponse(e);return t!==!0&&t.success&&t.data?(this.form.clearInvalid(),this.form.setValues(t.data),this.form.afterAction(this,!0),void 0):(this.failureType=Ext.form.Action.LOAD_FAILURE,this.form.afterAction(this,!1),void 0)},handleResponse:function(e){if(this.form.reader){var t=this.form.reader.read(e),i=t.records&&t.records[0]?t.records[0].data:null;return{success:t.success,data:i}}return this.decodeResponse(e)}}),Ext.form.Action.DirectLoad=Ext.extend(Ext.form.Action.Load,{constructor:function(e,t){Ext.form.Action.DirectLoad.superclass.constructor.call(this,e,t)},type:"directload",run:function(){var e=this.getParams();e.push(this.success,this),this.form.api.load.apply(window,e)},getParams:function(){var e=[],t={},i=this.form.baseParams,s=this.options.params;Ext.apply(t,s,i);var n=this.form.paramOrder;if(n)for(var r=0,a=n.length;a>r;r++)e.push(t[n[r]]);else this.form.paramsAsHash&&e.push(t);return e},processResponse:function(e){return this.result=e,e},success:function(e,t){t.type==Ext.Direct.exceptions.SERVER&&(e={}),Ext.form.Action.DirectLoad.superclass.success.call(this,e)}}),Ext.form.Action.DirectSubmit=Ext.extend(Ext.form.Action.Submit,{constructor:function(e,t){Ext.form.Action.DirectSubmit.superclass.constructor.call(this,e,t)},type:"directsubmit",run:function(){var e=this.options;e.clientValidation===!1||this.form.isValid()?(this.success.params=this.getParams(),this.form.api.submit(this.form.el.dom,this.success,this)):e.clientValidation!==!1&&(this.failureType=Ext.form.Action.CLIENT_INVALID,this.form.afterAction(this,!1))},getParams:function(){var e={},t=this.form.baseParams,i=this.options.params;return Ext.apply(e,i,t),e},processResponse:function(e){return this.result=e,e},success:function(e,t){t.type==Ext.Direct.exceptions.SERVER&&(e={}),Ext.form.Action.DirectSubmit.superclass.success.call(this,e)}}),Ext.form.Action.ACTION_TYPES={load:Ext.form.Action.Load,submit:Ext.form.Action.Submit,directload:Ext.form.Action.DirectLoad,directsubmit:Ext.form.Action.DirectSubmit},Ext.form.VTypes=function(){var e=/^[a-zA-Z_]+$/,t=/^[a-zA-Z0-9_]+$/,i=/^(\w+)([\-+.\'][\w]+)*@(\w[\-\w]*\.){1,5}([A-Za-z]){2,6}$/,s=/(((^https?)|(^ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i;return{email:function(e){return i.test(e)},emailText:'This field should be an e-mail address in the format "user@example.com"',emailMask:/[a-z0-9_\.\-\+\'@]/i,url:function(e){return s.test(e)},urlText:'This field should be a URL in the format "http://www.example.com"',alpha:function(t){return e.test(t)},alphaText:"This field should only contain letters and _",alphaMask:/[a-z_]/i,alphanum:function(e){return t.test(e)},alphanumText:"This field should only contain letters, numbers and _",alphanumMask:/[a-z0-9_]/i}}(),Ext.grid.GridPanel=Ext.extend(Ext.Panel,{autoExpandColumn:!1,autoExpandMax:1e3,autoExpandMin:50,columnLines:!1,ddText:"{0} selected row{1}",deferRowRender:!0,enableColumnHide:!0,enableColumnMove:!0,enableDragDrop:!1,enableHdMenu:!0,loadMask:!1,minColumnWidth:25,stripeRows:!1,trackMouseOver:!0,stateEvents:["columnmove","columnresize","sortchange","groupchange"],view:null,bubbleEvents:[],rendered:!1,viewReady:!1,initComponent:function(){Ext.grid.GridPanel.superclass.initComponent.call(this),this.columnLines&&(this.cls=(this.cls||"")+" x-grid-with-col-lines"),this.autoScroll=!1,this.autoWidth=!1,Ext.isArray(this.columns)&&(this.colModel=new Ext.grid.ColumnModel(this.columns),delete this.columns),this.ds&&(this.store=this.ds,delete this.ds),this.cm&&(this.colModel=this.cm,delete this.cm),this.sm&&(this.selModel=this.sm,delete this.sm),this.store=Ext.StoreMgr.lookup(this.store),this.addEvents("click","dblclick","contextmenu","mousedown","mouseup","mouseover","mouseout","keypress","keydown","cellmousedown","rowmousedown","headermousedown","groupmousedown","rowbodymousedown","containermousedown","cellclick","celldblclick","rowclick","rowdblclick","headerclick","headerdblclick","groupclick","groupdblclick","containerclick","containerdblclick","rowbodyclick","rowbodydblclick","rowcontextmenu","cellcontextmenu","headercontextmenu","groupcontextmenu","containercontextmenu","rowbodycontextmenu","bodyscroll","columnresize","columnmove","sortchange","groupchange","reconfigure","viewready")},onRender:function(){Ext.grid.GridPanel.superclass.onRender.apply(this,arguments);var e=this.getGridEl();this.el.addClass("x-grid-panel"),this.mon(e,{scope:this,mousedown:this.onMouseDown,click:this.onClick,dblclick:this.onDblClick,contextmenu:this.onContextMenu}),this.relayEvents(e,["mousedown","mouseup","mouseover","mouseout","keypress","keydown"]);var t=this.getView();t.init(this),t.render(),this.getSelectionModel().init(this)},initEvents:function(){Ext.grid.GridPanel.superclass.initEvents.call(this),this.loadMask&&(this.loadMask=new Ext.LoadMask(this.bwrap,Ext.apply({store:this.store},this.loadMask)))},initStateEvents:function(){Ext.grid.GridPanel.superclass.initStateEvents.call(this),this.mon(this.colModel,"hiddenchange",this.saveState,this,{delay:100})},applyState:function(e){var t,i,s,n=this.colModel,r=e.columns,a=this.store;if(r)for(var o=0,l=r.length;l>o;o++)t=r[o],i=n.getColumnById(t.id),i&&(s=n.getIndexById(t.id),n.setState(s,{hidden:t.hidden,width:t.width,sortable:t.sortable}),s!=o&&n.moveColumn(s,o));a&&(t=e.sort,t&&a[a.remoteSort?"setDefaultSort":"sort"](t.field,t.direction),t=e.group,a.groupBy&&(t?a.groupBy(t):a.clearGrouping()));var h=Ext.apply({},e);delete h.columns,delete h.sort,Ext.grid.GridPanel.superclass.applyState.call(this,h)},getState:function(){for(var e,t,i,s={columns:[]},n=this.store,r=0;i=this.colModel.config[r];r++)s.columns[r]={id:i.id,width:i.width},i.hidden&&(s.columns[r].hidden=!0),i.sortable&&(s.columns[r].sortable=!0);return n&&(e=n.getSortState(),e&&(s.sort=e),n.getGroupState&&(t=n.getGroupState(),t&&(s.group=t))),s},afterRender:function(){Ext.grid.GridPanel.superclass.afterRender.call(this);var e=this.view;this.on("bodyresize",e.layout,e),e.layout(!0),this.deferRowRender?(this.deferRowRenderTask||(this.deferRowRenderTask=new Ext.util.DelayedTask(e.afterRender,this.view)),this.deferRowRenderTask.delay(10)):e.afterRender(),this.viewReady=!0},reconfigure:function(e,t){var i=this.rendered;i&&this.loadMask&&(this.loadMask.destroy(),this.loadMask=new Ext.LoadMask(this.bwrap,Ext.apply({},{store:e},this.initialConfig.loadMask))),this.view&&this.view.initData(e,t),this.store=e,this.colModel=t,i&&this.view.refresh(!0),this.fireEvent("reconfigure",this,e,t)},onDestroy:function(){this.deferRowRenderTask&&this.deferRowRenderTask.cancel&&this.deferRowRenderTask.cancel(),this.rendered?Ext.destroy(this.view,this.loadMask):this.store&&this.store.autoDestroy&&this.store.destroy(),Ext.destroy(this.colModel,this.selModel),this.store=this.selModel=this.colModel=this.view=this.loadMask=null,Ext.grid.GridPanel.superclass.onDestroy.call(this)},processEvent:function(e,t){this.view.processEvent(e,t)},onClick:function(e){this.processEvent("click",e)},onMouseDown:function(e){this.processEvent("mousedown",e)},onContextMenu:function(e){this.processEvent("contextmenu",e)},onDblClick:function(e){this.processEvent("dblclick",e)},walkCells:function(e,t,i,s,n){var r=this.colModel,a=r.getColumnCount(),o=this.store,l=o.getCount(),h=!0;if(0>i)for(0>t&&(e--,h=!1);e>=0;){for(h||(t=a-1),h=!1;t>=0;){if(s.call(n||this,e,t,r)===!0)return[e,t];t--}e--}else for(t>=a&&(e++,h=!1);l>e;){for(h||(t=0),h=!1;a>t;){if(s.call(n||this,e,t,r)===!0)return[e,t];t++}e++}return null},getGridEl:function(){return this.body},stopEditing:Ext.emptyFn,getSelectionModel:function(){return this.selModel||(this.selModel=new Ext.grid.RowSelectionModel(this.disableSelection?{selectRow:Ext.emptyFn}:null)),this.selModel},getStore:function(){return this.store},getColumnModel:function(){return this.colModel},getView:function(){return this.view||(this.view=new Ext.grid.GridView(this.viewConfig)),this.view},getDragDropText:function(){var e=this.selModel.getCount();return String.format(this.ddText,e,1==e?"":"s")}}),Ext.reg("grid",Ext.grid.GridPanel),Ext.grid.PivotGrid=Ext.extend(Ext.grid.GridPanel,{aggregator:"sum",renderer:void 0,initComponent:function(){Ext.grid.PivotGrid.superclass.initComponent.apply(this,arguments),this.initAxes(),this.enableColumnResize=!1,this.viewConfig=Ext.apply(this.viewConfig||{},{forceFit:!0}),this.colModel=new Ext.grid.ColumnModel({})},getAggregator:function(){return"string"==typeof this.aggregator?Ext.grid.PivotAggregatorMgr.types[this.aggregator]:this.aggregator},setAggregator:function(e){this.aggregator=e},setMeasure:function(e){this.measure=e},setLeftAxis:function(e,t){this.leftAxis=e,t&&this.view.refresh()},setTopAxis:function(e,t){this.topAxis=e,t&&this.view.refresh()},initAxes:function(){var e=Ext.grid.PivotAxis;this.leftAxis instanceof e||this.setLeftAxis(new e({orientation:"vertical",dimensions:this.leftAxis||[],store:this.store})),this.topAxis instanceof e||this.setTopAxis(new e({orientation:"horizontal",dimensions:this.topAxis||[],store:this.store}))},extractData:function(){var e,t,i,s,n=this.store.data.items,r=n.length,a=[];if(0==r)return[];var o=this.leftAxis.getTuples(),l=o.length,h=this.topAxis.getTuples(),u=h.length,c=this.getAggregator();for(t=0;r>t;t++)for(e=n[t],i=0;l>i;i++)if(a[i]=a[i]||[],o[i].matcher(e)===!0)for(s=0;u>s;s++)a[i][s]=a[i][s]||[],h[s].matcher(e)&&a[i][s].push(e);var d,p,f=a.length;for(t=0;f>t;t++)for(p=a[t],d=p.length,i=0;d>i;i++)a[t][i]=c(a[t][i],this.measure);return a},getView:function(){return this.view||(this.view=new Ext.grid.PivotGridView(this.viewConfig)),this.view}}),Ext.reg("pivotgrid",Ext.grid.PivotGrid),Ext.grid.PivotAggregatorMgr=new Ext.AbstractManager,Ext.grid.PivotAggregatorMgr.registerType("sum",function(e,t){var i,s=e.length,n=0;for(i=0;s>i;i++)n+=e[i].get(t);return n}),Ext.grid.PivotAggregatorMgr.registerType("avg",function(e,t){var i,s=e.length,n=0;for(i=0;s>i;i++)n+=e[i].get(t);return n/s||"n/a"}),Ext.grid.PivotAggregatorMgr.registerType("min",function(e,t){var i,s=[],n=e.length;for(i=0;n>i;i++)s.push(e[i].get(t));return Math.min.apply(this,s)||"n/a"}),Ext.grid.PivotAggregatorMgr.registerType("max",function(e,t){var i,s=[],n=e.length;for(i=0;n>i;i++)s.push(e[i].get(t));return Math.max.apply(this,s)||"n/a"}),Ext.grid.PivotAggregatorMgr.registerType("count",function(e){return e.length}),Ext.grid.GridView=Ext.extend(Ext.util.Observable,{deferEmptyText:!0,scrollOffset:void 0,autoFill:!1,forceFit:!1,sortClasses:["sort-asc","sort-desc"],sortAscText:"Sort Ascending",sortDescText:"Sort Descending",columnsText:"Columns",selectedRowClass:"x-grid3-row-selected",borderWidth:2,tdClass:"x-grid3-cell",hdCls:"x-grid3-hd",markDirty:!0,cellSelectorDepth:4,rowSelectorDepth:10,rowBodySelectorDepth:10,cellSelector:"td.x-grid3-cell",rowSelector:"div.x-grid3-row",rowBodySelector:"div.x-grid3-row-body",firstRowCls:"x-grid3-row-first",lastRowCls:"x-grid3-row-last",rowClsRe:/(?:^|\s+)x-grid3-row-(first|last|alt)(?:\s+|$)/g,headerMenuOpenCls:"x-grid3-hd-menu-open",rowOverCls:"x-grid3-row-over",constructor:function(e){Ext.apply(this,e),this.addEvents("beforerowremoved","beforerowsinserted","beforerefresh","rowremoved","rowsinserted","rowupdated","refresh"),Ext.grid.GridView.superclass.constructor.call(this)},masterTpl:new Ext.Template('<div class="x-grid3" hidefocus="true">','<div class="x-grid3-viewport">','<div class="x-grid3-header">','<div class="x-grid3-header-inner">','<div class="x-grid3-header-offset" style="{ostyle}">{header}</div>',"</div>",'<div class="x-clear"></div>',"</div>",'<div class="x-grid3-scroller">','<div class="x-grid3-body" style="{bstyle}">{body}</div>','<a href="#" class="x-grid3-focus" tabIndex="-1"></a>',"</div>","</div>",'<div class="x-grid3-resize-marker">&#160;</div>','<div class="x-grid3-resize-proxy">&#160;</div>',"</div>"),headerTpl:new Ext.Template('<table border="0" cellspacing="0" cellpadding="0" style="{tstyle}">',"<thead>",'<tr class="x-grid3-hd-row">{cells}</tr>',"</thead>","</table>"),bodyTpl:new Ext.Template("{rows}"),cellTpl:new Ext.Template('<td class="x-grid3-col x-grid3-cell x-grid3-td-{id} {css}" style="{style}" tabIndex="0" {cellAttr}>','<div class="x-grid3-cell-inner x-grid3-col-{id}" unselectable="on" {attr}>{value}</div>',"</td>"),initTemplates:function(){var e,t,i=this.templates||{},s=new Ext.Template('<td class="x-grid3-hd x-grid3-cell x-grid3-td-{id} {css}" style="{style}">','<div {tooltip} {attr} class="x-grid3-hd-inner x-grid3-hd-{id}" unselectable="on" style="{istyle}">',this.grid.enableHdMenu?'<a class="x-grid3-hd-btn" href="#"></a>':"","{value}",'<img alt="" class="x-grid3-sort-icon" src="',Ext.BLANK_IMAGE_URL,'" />',"</div>","</td>"),n=['<tr class="x-grid3-row-body-tr" style="{bodyStyle}">','<td colspan="{cols}" class="x-grid3-body-cell" tabIndex="0" hidefocus="on">','<div class="x-grid3-row-body">{body}</div>',"</td>","</tr>"].join(""),r=['<table class="x-grid3-row-table" border="0" cellspacing="0" cellpadding="0" style="{tstyle}">',"<tbody>","<tr>{cells}</tr>",this.enableRowBody?n:"","</tbody>","</table>"].join("");Ext.applyIf(i,{hcell:s,cell:this.cellTpl,body:this.bodyTpl,header:this.headerTpl,master:this.masterTpl,row:new Ext.Template('<div class="x-grid3-row {alt}" style="{tstyle}">'+r+"</div>"),rowInner:new Ext.Template(r)});for(t in i)e=i[t],e&&Ext.isFunction(e.compile)&&!e.compiled&&(e.disableFormats=!0,e.compile());this.templates=i,this.colRe=new RegExp("x-grid3-td-([^\\s]+)","")},fly:function(e){return this._flyweight||(this._flyweight=new Ext.Element.Flyweight(document.body)),this._flyweight.dom=e,this._flyweight},getEditorParent:function(){return this.scroller.dom},initElements:function(){var e=Ext.Element,t=Ext.get(this.grid.getGridEl().dom.firstChild),i=new e(t.child("div.x-grid3-viewport")),s=new e(i.child("div.x-grid3-header")),n=new e(i.child("div.x-grid3-scroller"));this.grid.hideHeaders&&s.setDisplayed(!1),this.forceFit&&n.setStyle("overflow-x","hidden"),Ext.apply(this,{el:t,mainWrap:i,scroller:n,mainHd:s,innerHd:s.child("div.x-grid3-header-inner").dom,mainBody:new e(e.fly(n).child("div.x-grid3-body")),focusEl:new e(e.fly(n).child("a")),resizeMarker:new e(t.child("div.x-grid3-resize-marker")),resizeProxy:new e(t.child("div.x-grid3-resize-proxy"))}),this.focusEl.swallowEvent("click",!0)},getRows:function(){return this.hasRows()?this.mainBody.dom.childNodes:[]},findCell:function(e){return e?this.fly(e).findParent(this.cellSelector,this.cellSelectorDepth):!1},findCellIndex:function(e,t){var i,s=this.findCell(e);return s&&(i=this.fly(s).hasClass(t),!t||i)?this.getCellIndex(s):!1},getCellIndex:function(e){if(e){var t=e.className.match(this.colRe);if(t&&t[1])return this.cm.getIndexById(t[1])}return!1},findHeaderCell:function(e){var t=this.findCell(e);return t&&this.fly(t).hasClass(this.hdCls)?t:null},findHeaderIndex:function(e){return this.findCellIndex(e,this.hdCls)},findRow:function(e){return e?this.fly(e).findParent(this.rowSelector,this.rowSelectorDepth):!1},findRowIndex:function(e){var t=this.findRow(e);return t?t.rowIndex:!1},findRowBody:function(e){return e?this.fly(e).findParent(this.rowBodySelector,this.rowBodySelectorDepth):!1},getRow:function(e){return this.getRows()[e]},getCell:function(e,t){return Ext.fly(this.getRow(e)).query(this.cellSelector)[t]},getHeaderCell:function(e){return this.mainHd.dom.getElementsByTagName("td")[e]},addRowClass:function(e,t){var i=this.getRow(e);i&&this.fly(i).addClass(t)},removeRowClass:function(e,t){var i=this.getRow(e);i&&this.fly(i).removeClass(t)},removeRow:function(e){Ext.removeNode(this.getRow(e)),this.syncFocusEl(e)},removeRows:function(e,t){var i,s=this.mainBody.dom;for(i=e;t>=i;i++)Ext.removeNode(s.childNodes[e]);this.syncFocusEl(e)},getScrollState:function(){var e=this.scroller.dom;return{left:e.scrollLeft,top:e.scrollTop}},restoreScroll:function(e){var t=this.scroller.dom;t.scrollLeft=e.left,t.scrollTop=e.top},scrollToTop:function(){var e=this.scroller.dom;e.scrollTop=0,e.scrollLeft=0},syncScroll:function(){this.syncHeaderScroll();var e=this.scroller.dom;this.grid.fireEvent("bodyscroll",e.scrollLeft,e.scrollTop)},syncHeaderScroll:function(){var e=this.innerHd,t=this.scroller.dom.scrollLeft;e.scrollLeft=t,e.scrollLeft=t},updateSortIcon:function(e,t){var i=this.sortClasses,s=i["DESC"==t?1:0],n=this.mainHd.select("td").removeClass(i);n.item(e).addClass(s)},updateAllColumnWidths:function(){var e,t,i,s,n,r=this.getTotalWidth(),a=this.cm.getColumnCount(),o=this.getRows(),l=o.length,h=[];for(s=0;a>s;s++)h[s]=this.getColumnWidth(s),this.getHeaderCell(s).style.width=h[s];for(this.updateHeaderWidth(),s=0;l>s;s++)if(e=o[s],e.style.width=r,t=e.firstChild)for(t.style.width=r,i=t.rows[0],n=0;a>n;n++)i.childNodes[n].style.width=h[n];this.onAllColumnWidthsUpdated(h,r)},updateColumnWidth:function(e){var t,i,s,n=this.getColumnWidth(e),r=this.getTotalWidth(),a=this.getHeaderCell(e),o=this.getRows(),l=o.length;for(this.updateHeaderWidth(),a.style.width=n,i=0;l>i;i++)t=o[i],s=t.firstChild,t.style.width=r,s&&(s.style.width=r,s.rows[0].childNodes[e].style.width=n);this.onColumnWidthUpdated(e,n,r)},updateColumnHidden:function(e,t){var i,s,n,r=this.getTotalWidth(),a=t?"none":"",o=this.getHeaderCell(e),l=this.getRows(),h=l.length;for(this.updateHeaderWidth(),o.style.display=a,n=0;h>n;n++)i=l[n],i.style.width=r,s=i.firstChild,s&&(s.style.width=r,s.rows[0].childNodes[e].style.display=a);this.onColumnHiddenUpdated(e,t,r),delete this.lastViewWidth,this.layout()},doRender:function(e,t,i,s,n,r){var a,o,l,h,u,c,d=this.templates,p=d.cell,f=d.row,m=n-1,y="width:"+this.getTotalWidth()+";",g=[],v=[],x={tstyle:y},E={},b=t.length;for(u=0;b>u;u++){for(l=t[u],v=[],c=u+s,h=0;n>h;h++)o=e[h],E.id=o.id,E.css=0===h?"x-grid3-cell-first ":h==m?"x-grid3-cell-last ":"",E.attr=E.cellAttr="",E.style=o.style,E.value=o.renderer.call(o.scope,l.data[o.name],E,l,c,h,i),Ext.isEmpty(E.value)&&(E.value="&#160;"),this.markDirty&&l.dirty&&"undefined"!=typeof l.modified[o.name]&&(E.css+=" x-grid3-dirty-cell"),v[v.length]=p.apply(E);a=[],r&&0===(c+1)%2&&(a[0]="x-grid3-row-alt"),l.dirty&&(a[1]=" x-grid3-dirty-row"),x.cols=n,this.getRowClass&&(a[2]=this.getRowClass(l,c,x,i)),x.alt=a.join(" "),x.cells=v.join(""),g[g.length]=f.apply(x)}return g.join("")},processRows:function(e,t){if(this.ds&&!(this.ds.getCount()<1)){var i,s,n=this.getRows(),r=n.length;for(t=t||!this.grid.stripeRows,e=e||0,s=0;r>s;s++)i=n[s],i&&(i.rowIndex=s,t||(i.className=i.className.replace(this.rowClsRe," "),0===(s+1)%2&&(i.className+=" x-grid3-row-alt")));0===e&&Ext.fly(n[0]).addClass(this.firstRowCls),Ext.fly(n[r-1]).addClass(this.lastRowCls)}},afterRender:function(){this.ds&&this.cm&&(this.mainBody.dom.innerHTML=this.renderBody()||"&#160;",this.processRows(0,!0),this.deferEmptyText!==!0&&this.applyEmptyText(),this.grid.fireEvent("viewready",this.grid))},afterRenderUI:function(){var e=this.grid;this.initElements(),Ext.fly(this.innerHd).on("click",this.handleHdDown,this),this.mainHd.on({scope:this,mouseover:this.handleHdOver,mouseout:this.handleHdOut,mousemove:this.handleHdMove}),this.scroller.on("scroll",this.syncScroll,this),e.enableColumnResize!==!1&&(this.splitZone=new Ext.grid.GridView.SplitDragZone(e,this.mainHd.dom)),e.enableColumnMove&&(this.columnDrag=new Ext.grid.GridView.ColumnDragZone(e,this.innerHd),this.columnDrop=new Ext.grid.HeaderDropZone(e,this.mainHd.dom)),e.enableHdMenu!==!1&&(this.hmenu=new Ext.menu.Menu({id:e.id+"-hctx"}),this.hmenu.add({itemId:"asc",text:this.sortAscText,cls:"xg-hmenu-sort-asc"},{itemId:"desc",text:this.sortDescText,cls:"xg-hmenu-sort-desc"}),e.enableColumnHide!==!1&&(this.colMenu=new Ext.menu.Menu({id:e.id+"-hcols-menu"}),this.colMenu.on({scope:this,beforeshow:this.beforeColMenuShow,itemclick:this.handleHdMenuClick}),this.hmenu.add("-",{itemId:"columns",hideOnClick:!1,text:this.columnsText,menu:this.colMenu,iconCls:"x-cols-icon"})),this.hmenu.on("itemclick",this.handleHdMenuClick,this)),e.trackMouseOver&&this.mainBody.on({scope:this,mouseover:this.onRowOver,mouseout:this.onRowOut}),(e.enableDragDrop||e.enableDrag)&&(this.dragZone=new Ext.grid.GridDragZone(e,{ddGroup:e.ddGroup||"GridDD"})),this.updateHeaderSortState()},renderUI:function(){var e=this.templates;return e.master.apply({body:e.body.apply({rows:"&#160;"}),header:this.renderHeaders(),ostyle:"width:"+this.getOffsetWidth()+";",bstyle:"width:"+this.getTotalWidth()+";"})},processEvent:function(e,t){var i,s,n,r,a=t.getTarget(),o=this.grid,l=this.findHeaderIndex(a);o.fireEvent(e,t),l!==!1?o.fireEvent("header"+e,o,l,t):(i=this.findRowIndex(a),i!==!1?(s=this.findCellIndex(a),s!==!1?(n=o.colModel.getColumnAt(s),o.fireEvent("cell"+e,o,i,s,t)!==!1&&(!n||n.processEvent&&n.processEvent(e,t,o,i,s)!==!1)&&o.fireEvent("row"+e,o,i,t)):o.fireEvent("row"+e,o,i,t)!==!1&&(r=this.findRowBody(a))&&o.fireEvent("rowbody"+e,o,i,t)):o.fireEvent("container"+e,o,t))},layout:function(e){if(this.mainBody){var t,i,s,n=this.grid,r=n.getGridEl(),a=r.getSize(!0),o=a.width,l=a.height,h=this.scroller;20>o||20>l||(n.autoHeight?(t=h.dom.style,t.overflow="visible",Ext.isWebKit&&(t.position="static")):(this.el.setSize(o,l),i=this.mainHd.getHeight(),s=l-i,h.setSize(o,s),this.innerHd&&(this.innerHd.style.width=o+"px")),this.forceFit||e===!0&&this.autoFill?this.lastViewWidth!=o&&(this.fitColumns(!1,!1),this.lastViewWidth=o):(this.autoExpand(),this.syncHeaderScroll()),this.onLayout(o,s))}},onLayout:function(){},onColumnWidthUpdated:function(){},onAllColumnWidthsUpdated:function(){},onColumnHiddenUpdated:function(){},updateColumnText:function(){},afterMove:function(){},init:function(e){this.grid=e,this.initTemplates(),this.initData(e.store,e.colModel),this.initUI(e)},getColumnId:function(e){return this.cm.getColumnId(e)},getOffsetWidth:function(){return this.cm.getTotalWidth()+this.getScrollOffset()+"px"},getScrollOffset:function(){return Ext.num(this.scrollOffset,Ext.getScrollBarWidth())},renderHeaders:function(){var e,t,i=this.cm,s=this.templates,n=s.hcell,r={},a=i.getColumnCount(),o=a-1,l=[];for(e=0;a>e;e++)t=0==e?"x-grid3-cell-first ":e==o?"x-grid3-cell-last ":"",r={id:i.getColumnId(e),value:i.getColumnHeader(e)||"",style:this.getColumnStyle(e,!0),css:t,tooltip:this.getColumnTooltip(e)},"right"==i.config[e].align?r.istyle="padding-right: 16px;":delete r.istyle,l[e]=n.apply(r);return s.header.apply({cells:l.join(""),tstyle:String.format("width: {0};",this.getTotalWidth())})},getColumnTooltip:function(e){var t=this.cm.getColumnTooltip(e);return t?Ext.QuickTips.isEnabled()?'ext:qtip="'+t+'"':'title="'+t+'"':""},beforeUpdate:function(){this.grid.stopEditing(!0)},updateHeaders:function(){this.innerHd.firstChild.innerHTML=this.renderHeaders(),this.updateHeaderWidth(!1)},updateHeaderWidth:function(e){var t=this.innerHd.firstChild,i=this.getTotalWidth();t.style.width=this.getOffsetWidth(),t.firstChild.style.width=i,e!==!1&&(this.mainBody.dom.style.width=i)},focusRow:function(e){this.focusCell(e,0,!1)},focusCell:function(e,t,i){this.syncFocusEl(this.ensureVisible(e,t,i));var s=this.focusEl;Ext.isGecko?s.focus():s.focus.defer(1,s)},resolveCell:function(e,t,i){if(Ext.isNumber(e)||(e=e.rowIndex),!this.ds)return null;if(0>e||e>=this.ds.getCount())return null;t=void 0!==t?t:0;var s,n=this.getRow(e),r=this.cm,a=r.getColumnCount();if(i!==!1||0!==t){for(;a>t&&r.isHidden(t);)t++;s=this.getCell(e,t)}return{row:n,cell:s}},getResolvedXY:function(e){if(!e)return null;var t=e.cell,i=e.row;return t?Ext.fly(t).getXY():[this.el.getX(),Ext.fly(i).getY()]},syncFocusEl:function(e,t,i){var s=e;if(!Ext.isArray(s)){if(e=Math.min(e,Math.max(0,this.getRows().length-1)),isNaN(e))return;s=this.getResolvedXY(this.resolveCell(e,t,i))}this.focusEl.setXY(s||this.scroller.getXY())},ensureVisible:function(e,t,i){var s=this.resolveCell(e,t,i);if(!s||!s.row)return null;for(var n=s.row,r=s.cell,a=this.scroller.dom,o=n,l=0,h=this.el.dom;o&&o!=h;)l+=o.offsetTop,o=o.offsetParent;l-=this.mainHd.dom.offsetHeight,h=parseInt(a.scrollTop,10);var u=l+n.offsetHeight,c=a.clientHeight,d=h+c;if(h>l?a.scrollTop=l:u>d&&(a.scrollTop=u-c),i!==!1){var p=parseInt(r.offsetLeft,10),f=p+r.offsetWidth,m=parseInt(a.scrollLeft,10),y=m+a.clientWidth;m>p?a.scrollLeft=p:f>y&&(a.scrollLeft=f-a.clientWidth)}return this.getResolvedXY(s)},insertRows:function(e,t,i,s){var n=e.getCount()-1;if(!s&&0===t&&i>=n)this.fireEvent("beforerowsinserted",this,t,i),this.refresh(),this.fireEvent("rowsinserted",this,t,i);else{s||this.fireEvent("beforerowsinserted",this,t,i);var r=this.renderRows(t,i),a=this.getRow(t);if(a)0===t&&Ext.fly(this.getRow(0)).removeClass(this.firstRowCls),Ext.DomHelper.insertHtml("beforeBegin",a,r);else{var o=this.getRow(n-1);o&&Ext.fly(o).removeClass(this.lastRowCls),Ext.DomHelper.insertHtml("beforeEnd",this.mainBody.dom,r)}s?(0===t||t>=n)&&Ext.fly(this.getRow(t)).addClass(0===t?this.firstRowCls:this.lastRowCls):(this.processRows(t),this.fireEvent("rowsinserted",this,t,i))}this.syncFocusEl(t)},deleteRows:function(e,t,i){e.getRowCount()<1?this.refresh():(this.fireEvent("beforerowsdeleted",this,t,i),this.removeRows(t,i),this.processRows(t),this.fireEvent("rowsdeleted",this,t,i))},getColumnStyle:function(e,t){var i=this.cm,s=i.config,n=t?"":s[e].css||"",r=s[e].align;return n+=String.format("width: {0};",this.getColumnWidth(e)),i.isHidden(e)&&(n+="display: none; "),r&&(n+=String.format("text-align: {0};",r)),n},getColumnWidth:function(e){var t=this.cm.getColumnWidth(e),i=this.borderWidth;return Ext.isNumber(t)?Ext.isBorderBox||Ext.isWebKit&&!Ext.isSafari2?t+"px":Math.max(t-i,0)+"px":t},getTotalWidth:function(){return this.cm.getTotalWidth()+"px"},fitColumns:function(e,t,i){var s,n,r,a=this.grid,o=this.cm,l=o.getTotalWidth(!1),h=this.getGridInnerWidth(),u=h-l,c=[],d=0,p=0;if(20>h||0===u)return!1;var f=o.getColumnCount(!0),m=o.getColumnCount(!1),y=f-(Ext.isNumber(i)?1:0);for(0===y&&(y=1,i=void 0),r=0;m>r;r++)o.isFixed(r)||r===i||(s=o.getColumnWidth(r),c.push(r,s),o.isHidden(r)||(d=r,p+=s));for(n=(h-o.getTotalWidth())/p;c.length;)s=c.pop(),r=c.pop(),o.setColumnWidth(r,Math.max(a.minColumnWidth,Math.floor(s+s*n)),!0);if(l=o.getTotalWidth(!1),l>h){var g=y==f?d:i,v=Math.max(1,o.getColumnWidth(g)-(l-h));o.setColumnWidth(g,v,!0)
}return e!==!0&&this.updateAllColumnWidths(),!0},autoExpand:function(e){var t=this.grid,i=this.cm,s=this.getGridInnerWidth(),n=i.getTotalWidth(!1),r=t.autoExpandColumn;if(!this.userResized&&r&&s!=n){var a=i.getIndexById(r),o=i.getColumnWidth(a),l=s-n+o,h=Math.min(Math.max(l,t.autoExpandMin),t.autoExpandMax);o!=h&&(i.setColumnWidth(a,h,!0),e!==!0&&this.updateColumnWidth(a,h))}},getGridInnerWidth:function(){return this.grid.getGridEl().getWidth(!0)-this.getScrollOffset()},getColumnData:function(){var e,t,i=[],s=this.cm,n=s.getColumnCount(),r=this.ds.fields;for(e=0;n>e;e++)t=s.getDataIndex(e),i[e]={name:Ext.isDefined(t)?t:r.get(e)?r.get(e).name:void 0,renderer:s.getRenderer(e),scope:s.getRendererScope(e),id:s.getColumnId(e),style:this.getColumnStyle(e)};return i},renderRows:function(e,t){var i,s=this.grid,n=s.store,r=s.stripeRows,a=s.colModel,o=a.getColumnCount(),l=n.getCount();return 1>l?"":(e=e||0,t=Ext.isDefined(t)?t:l-1,i=n.getRange(e,t),this.doRender(this.getColumnData(),i,n,e,o,r))},renderBody:function(){var e=this.renderRows()||"&#160;";return this.templates.body.apply({rows:e})},refreshRow:function(e){var t,i,s,n,r,a,o=this.ds,l=this.cm.getColumnCount(),h=this.getColumnData(),u=l-1,c=["x-grid3-row"],d={tstyle:String.format("width: {0};",this.getTotalWidth())},p=[],f=this.templates.cell;if(Ext.isNumber(e)?(t=e,e=o.getAt(t)):t=o.indexOf(e),e&&!(0>t)){for(a=0;l>a;a++)s=h[a],r=0==a?"x-grid3-cell-first":a==u?"x-grid3-cell-last ":"",n={id:s.id,style:s.style,css:r,attr:"",cellAttr:""},n.value=s.renderer.call(s.scope,e.data[s.name],n,e,t,a,o),Ext.isEmpty(n.value)&&(n.value="&#160;"),this.markDirty&&e.dirty&&"undefined"!=typeof e.modified[s.name]&&(n.css+=" x-grid3-dirty-cell"),p[a]=f.apply(n);i=this.getRow(t),i.className="",this.grid.stripeRows&&0===(t+1)%2&&c.push("x-grid3-row-alt"),this.getRowClass&&(d.cols=l,c.push(this.getRowClass(e,t,d,o))),this.fly(i).addClass(c).setStyle(d.tstyle),d.cells=p.join(""),i.innerHTML=this.templates.rowInner.apply(d),this.fireEvent("rowupdated",this,t,e)}},refresh:function(e){this.fireEvent("beforerefresh",this),this.grid.stopEditing(!0);var t=this.renderBody();this.mainBody.update(t).setWidth(this.getTotalWidth()),e===!0&&(this.updateHeaders(),this.updateHeaderSortState()),this.processRows(0,!0),this.layout(),this.applyEmptyText(),this.fireEvent("refresh",this)},applyEmptyText:function(){this.emptyText&&!this.hasRows()&&this.mainBody.update('<div class="x-grid-empty">'+this.emptyText+"</div>")},updateHeaderSortState:function(){var e=this.ds.getSortState();if(e){this.sortState&&this.sortState.field==e.field&&this.sortState.direction==e.direction||this.grid.fireEvent("sortchange",this.grid,e),this.sortState=e;var t=this.cm.findColumnIndex(e.field);if(-1!=t){var i=e.direction;this.updateSortIcon(t,i)}}},clearHeaderSortState:function(){this.sortState&&(this.grid.fireEvent("sortchange",this.grid,null),this.mainHd.select("td").removeClass(this.sortClasses),delete this.sortState)},destroy:function(){var e,t,i=this,s=i.grid,n=s.getGridEl(),r=i.dragZone,a=i.splitZone,o=i.columnDrag,l=i.columnDrop,h=i.scrollToTopTask;h&&h.cancel&&h.cancel(),Ext.destroyMembers(i,"colMenu","hmenu"),i.initData(null,null),i.purgeListeners(),Ext.fly(i.innerHd).un("click",i.handleHdDown,i),s.enableColumnMove&&(e=o.dragData,t=o.proxy,Ext.destroy(o.el,t.ghost,t.el,l.el,l.proxyTop,l.proxyBottom,e.ddel,e.header),t.anim&&Ext.destroy(t.anim),delete t.ghost,delete e.ddel,delete e.header,o.destroy(),delete Ext.dd.DDM.locationCache[o.id],delete o._domRef,delete l.proxyTop,delete l.proxyBottom,l.destroy(),delete Ext.dd.DDM.locationCache["gridHeader"+n.id],delete l._domRef,delete Ext.dd.DDM.ids[l.ddGroup]),a&&(a.destroy(),delete a._domRef,delete Ext.dd.DDM.ids["gridSplitters"+n.id]),Ext.fly(i.innerHd).removeAllListeners(),Ext.removeNode(i.innerHd),delete i.innerHd,Ext.destroy(i.el,i.mainWrap,i.mainHd,i.scroller,i.mainBody,i.focusEl,i.resizeMarker,i.resizeProxy,i.activeHdBtn,i._flyweight,r,a),delete s.container,r&&r.destroy(),Ext.dd.DDM.currentTarget=null,delete Ext.dd.DDM.locationCache[n.id],Ext.EventManager.removeResizeListener(i.onWindowResize,i)},onDenyColumnHide:function(){},render:function(){if(this.autoFill){var e=this.grid.ownerCt;e&&e.getLayout()&&e.on("afterlayout",function(){this.fitColumns(!0,!0),this.updateHeaders(),this.updateHeaderSortState()},this,{single:!0})}else this.forceFit?this.fitColumns(!0,!1):this.grid.autoExpandColumn&&this.autoExpand(!0);this.grid.getGridEl().dom.innerHTML=this.renderUI(),this.afterRenderUI()},initData:function(e,t){var i=this;if(i.ds){var s=i.ds;s.un("add",i.onAdd,i),s.un("load",i.onLoad,i),s.un("clear",i.onClear,i),s.un("remove",i.onRemove,i),s.un("update",i.onUpdate,i),s.un("datachanged",i.onDataChange,i),s!==e&&s.autoDestroy&&s.destroy()}if(e&&e.on({scope:i,load:i.onLoad,add:i.onAdd,remove:i.onRemove,update:i.onUpdate,clear:i.onClear,datachanged:i.onDataChange}),i.cm){var n=i.cm;n.un("configchange",i.onColConfigChange,i),n.un("widthchange",i.onColWidthChange,i),n.un("headerchange",i.onHeaderChange,i),n.un("hiddenchange",i.onHiddenChange,i),n.un("columnmoved",i.onColumnMove,i)}t&&(delete i.lastViewWidth,t.on({scope:i,configchange:i.onColConfigChange,widthchange:i.onColWidthChange,headerchange:i.onHeaderChange,hiddenchange:i.onHiddenChange,columnmoved:i.onColumnMove})),i.ds=e,i.cm=t},onDataChange:function(){this.refresh(!0),this.updateHeaderSortState(),this.syncFocusEl(0)},onClear:function(){this.refresh(),this.syncFocusEl(0)},onUpdate:function(e,t){this.refreshRow(t)},onAdd:function(e,t,i){this.insertRows(e,i,i+(t.length-1))},onRemove:function(e,t,i,s){s!==!0&&this.fireEvent("beforerowremoved",this,i,t),this.removeRow(i),s!==!0&&(this.processRows(i),this.applyEmptyText(),this.fireEvent("rowremoved",this,i,t))},onLoad:function(){Ext.isGecko?(this.scrollToTopTask||(this.scrollToTopTask=new Ext.util.DelayedTask(this.scrollToTop,this)),this.scrollToTopTask.delay(1)):this.scrollToTop()},onColWidthChange:function(e,t,i){this.updateColumnWidth(t,i)},onHeaderChange:function(){this.updateHeaders()},onHiddenChange:function(e,t,i){this.updateColumnHidden(t,i)},onColumnMove:function(e,t,i){this.indexMap=null,this.refresh(!0),this.restoreScroll(this.getScrollState()),this.afterMove(i),this.grid.fireEvent("columnmove",t,i)},onColConfigChange:function(){delete this.lastViewWidth,this.indexMap=null,this.refresh(!0)},initUI:function(e){e.on("headerclick",this.onHeaderClick,this)},initEvents:Ext.emptyFn,onHeaderClick:function(e,t){!this.headersDisabled&&this.cm.isSortable(t)&&(e.stopEditing(!0),e.store.sort(this.cm.getDataIndex(t)))},onRowOver:function(e,t){var i=this.findRowIndex(t);i!==!1&&this.addRowClass(i,this.rowOverCls)},onRowOut:function(e,t){var i=this.findRowIndex(t);i===!1||e.within(this.getRow(i),!0)||this.removeRowClass(i,this.rowOverCls)},onRowSelect:function(e){this.addRowClass(e,this.selectedRowClass)},onRowDeselect:function(e){this.removeRowClass(e,this.selectedRowClass)},onCellSelect:function(e,t){var i=this.getCell(e,t);i&&this.fly(i).addClass("x-grid3-cell-selected")},onCellDeselect:function(e,t){var i=this.getCell(e,t);i&&this.fly(i).removeClass("x-grid3-cell-selected")},handleWheel:function(e){e.stopPropagation()},onColumnSplitterMoved:function(e,t){this.userResized=!0,this.grid.colModel.setColumnWidth(e,t,!0),this.forceFit?(this.fitColumns(!0,!1,e),this.updateAllColumnWidths()):(this.updateColumnWidth(e,t),this.syncHeaderScroll()),this.grid.fireEvent("columnresize",e,t)},beforeColMenuShow:function(){var e,t=this.cm,i=t.getColumnCount(),s=this.colMenu;for(s.removeAll(),e=0;i>e;e++)t.config[e].hideable!==!1&&s.add(new Ext.menu.CheckItem({text:t.getColumnHeader(e),itemId:"col-"+t.getColumnId(e),checked:!t.isHidden(e),disabled:t.config[e].hideable===!1,hideOnClick:!1}))},handleHdMenuClick:function(e){var t=this.ds,i=this.cm.getDataIndex(this.hdCtxIndex);switch(e.getItemId()){case"asc":t.sort(i,"ASC");break;case"desc":t.sort(i,"DESC");break;default:this.handleHdMenuClickDefault(e)}return!0},handleHdMenuClickDefault:function(e){var t=this.cm,i=e.getItemId(),s=t.getIndexById(i.substr(4));if(-1!=s){if(e.checked&&t.getColumnsBy(this.isHideableColumn,this).length<=1)return this.onDenyColumnHide(),void 0;t.setHidden(s,e.checked)}},handleHdDown:function(e,t){if(Ext.fly(t).hasClass("x-grid3-hd-btn")){e.stopEvent();var i=this.cm,s=this.findHeaderCell(t),n=this.getCellIndex(s),r=i.isSortable(n),a=this.hmenu,o=a.items,l=this.headerMenuOpenCls;this.hdCtxIndex=n,Ext.fly(s).addClass(l),o.get("asc").setDisabled(!r),o.get("desc").setDisabled(!r),a.on("hide",function(){Ext.fly(s).removeClass(l)},this,{single:!0}),a.show(t,"tl-bl?")}},handleHdMove:function(e){var t=this.findHeaderCell(this.activeHdRef);if(t&&!this.headersDisabled){var i=this.splitHandleWidth||5,s=this.activeHdRegion,n=t.style,r=this.cm,a="",o=e.getPageX();if(this.grid.enableColumnResize!==!1){var l=this.activeHdIndex,h=this.getPreviousVisible(l),u=r.isResizable(l),c=h&&r.isResizable(h),d=o-s.left<=i,p=s.right-o<=(this.activeHdBtn?2:i);d&&c?a=Ext.isAir?"move":Ext.isWebKit?"e-resize":"col-resize":p&&u&&(a=Ext.isAir?"move":Ext.isWebKit?"w-resize":"col-resize")}n.cursor=a}},getPreviousVisible:function(e){for(;e>0;){if(!this.cm.isHidden(e-1))return e;e--}return void 0},handleHdOver:function(e,t){var i=this.findHeaderCell(t);if(i&&!this.headersDisabled){var s=this.fly(i);this.activeHdRef=t,this.activeHdIndex=this.getCellIndex(i),this.activeHdRegion=s.getRegion(),this.isMenuDisabled(this.activeHdIndex,s)||(s.addClass("x-grid3-hd-over"),this.activeHdBtn=s.child(".x-grid3-hd-btn"),this.activeHdBtn&&(this.activeHdBtn.dom.style.height=i.firstChild.offsetHeight-1+"px"))}},handleHdOut:function(e,t){var i=this.findHeaderCell(t);!i||Ext.isIE&&e.within(i,!0)||(this.activeHdRef=null,this.fly(i).removeClass("x-grid3-hd-over"),i.style.cursor="")},isMenuDisabled:function(e){return this.cm.isMenuDisabled(e)},hasRows:function(){var e=this.mainBody.dom.firstChild;return e&&1==e.nodeType&&"x-grid-empty"!=e.className},isHideableColumn:function(e){return!e.hidden},bind:function(e,t){this.initData(e,t)}}),Ext.grid.GridView.SplitDragZone=Ext.extend(Ext.dd.DDProxy,{constructor:function(e,t){this.grid=e,this.view=e.getView(),this.marker=this.view.resizeMarker,this.proxy=this.view.resizeProxy,Ext.grid.GridView.SplitDragZone.superclass.constructor.call(this,t,"gridSplitters"+this.grid.getGridEl().id,{dragElId:Ext.id(this.proxy.dom),resizeFrame:!1}),this.scroll=!1,this.hw=this.view.splitHandleWidth||5},b4StartDrag:function(e,t){this.dragHeadersDisabled=this.view.headersDisabled,this.view.headersDisabled=!0;var i=this.view.mainWrap.getHeight();this.marker.setHeight(i),this.marker.show(),this.marker.alignTo(this.view.getHeaderCell(this.cellIndex),"tl-tl",[-2,0]),this.proxy.setHeight(i);var s=this.cm.getColumnWidth(this.cellIndex),n=Math.max(s-this.grid.minColumnWidth,0);this.resetConstraints(),this.setXConstraint(n,1e3),this.setYConstraint(0,0),this.minX=e-n,this.maxX=e+1e3,this.startPos=e,Ext.dd.DDProxy.prototype.b4StartDrag.call(this,e,t)},allowHeaderDrag:function(){return!0},handleMouseDown:function(e){var t=this.view.findHeaderCell(e.getTarget());if(t&&this.allowHeaderDrag(e)){var i=this.view.fly(t).getXY(),s=i[0],n=e.getXY(),r=n[0],a=t.offsetWidth,o=!1;if(r-s<=this.hw?o=-1:s+a-r<=this.hw&&(o=0),o!==!1){this.cm=this.grid.colModel;var l=this.view.getCellIndex(t);if(-1==o){if(0>l+o)return;for(;this.cm.isHidden(l+o);)if(--o,0>l+o)return}this.cellIndex=l+o,this.split=t.dom,this.cm.isResizable(this.cellIndex)&&!this.cm.isFixed(this.cellIndex)&&Ext.grid.GridView.SplitDragZone.superclass.handleMouseDown.apply(this,arguments)}else this.view.columnDrag&&this.view.columnDrag.callHandleMouseDown(e)}},endDrag:function(e){this.marker.hide();var t=this.view,i=Math.max(this.minX,e.getPageX()),s=i-this.startPos,n=this.dragHeadersDisabled;t.onColumnSplitterMoved(this.cellIndex,this.cm.getColumnWidth(this.cellIndex)+s),setTimeout(function(){t.headersDisabled=n},50)},autoOffset:function(){this.setDelta(0,0)}}),Ext.grid.PivotGridView=Ext.extend(Ext.grid.GridView,{colHeaderCellCls:"grid-hd-group-cell",title:"",getColumnHeaders:function(){return this.grid.topAxis.buildHeaders()},getRowHeaders:function(){return this.grid.leftAxis.buildHeaders()},renderRows:function(e,t){var i,s,n,r,a=this.grid,o=a.extractData(),l=o.length,h=this.templates,u=a.renderer,c="function"==typeof u,d=this.getCellCls,p="function"==typeof d,f=h.cell,m=h.row,y=[],g={},v="width:"+this.getGridInnerWidth()+"px;";for(e=e||0,t=Ext.isDefined(t)?t:l-1,n=0;l>n;n++){r=o[n],s=r.length,i=[];for(var x=0;s>x;x++)g.id=n+"-"+x,g.css=0===x?"x-grid3-cell-first ":x==s-1?"x-grid3-cell-last ":"",g.attr=g.cellAttr="",g.value=r[x],Ext.isEmpty(g.value)&&(g.value="&#160;"),c&&(g.value=u(g.value)),p&&(g.css+=d(g.value)+" "),i[i.length]=f.apply(g);y[y.length]=m.apply({tstyle:v,cols:s,cells:i.join(""),alt:""})}return y.join("")},masterTpl:new Ext.Template('<div class="x-grid3 x-pivotgrid" hidefocus="true">','<div class="x-grid3-viewport">','<div class="x-grid3-header">','<div class="x-grid3-header-title"><span>{title}</span></div>','<div class="x-grid3-header-inner">','<div class="x-grid3-header-offset" style="{ostyle}"></div>',"</div>",'<div class="x-clear"></div>',"</div>",'<div class="x-grid3-scroller">','<div class="x-grid3-row-headers"></div>','<div class="x-grid3-body" style="{bstyle}">{body}</div>','<a href="#" class="x-grid3-focus" tabIndex="-1"></a>',"</div>","</div>",'<div class="x-grid3-resize-marker">&#160;</div>','<div class="x-grid3-resize-proxy">&#160;</div>',"</div>"),initTemplates:function(){Ext.grid.PivotGridView.superclass.initTemplates.apply(this,arguments);var e=this.templates||{};e.gcell||(e.gcell=new Ext.XTemplate('<td class="x-grid3-hd x-grid3-gcell x-grid3-td-{id} ux-grid-hd-group-row-{row} '+this.colHeaderCellCls+'" style="{style}">','<div {tooltip} class="x-grid3-hd-inner x-grid3-hd-{id}" unselectable="on" style="{istyle}">',this.grid.enableHdMenu?'<a class="x-grid3-hd-btn" href="#"></a>':"","{value}","</div>","</td>")),this.templates=e,this.hrowRe=new RegExp("ux-grid-hd-group-row-(\\d+)","")},initElements:function(){Ext.grid.PivotGridView.superclass.initElements.apply(this,arguments),this.rowHeadersEl=new Ext.Element(this.scroller.child("div.x-grid3-row-headers")),this.headerTitleEl=new Ext.Element(this.mainHd.child("div.x-grid3-header-title"))},getGridInnerWidth:function(){var e=Ext.grid.PivotGridView.superclass.getGridInnerWidth.apply(this,arguments);return e-this.getTotalRowHeaderWidth()},getTotalRowHeaderWidth:function(){var e,t=this.getRowHeaders(),i=t.length,s=0;for(e=0;i>e;e++)s+=t[e].width;return s},getTotalColumnHeaderHeight:function(){return 21*this.getColumnHeaders().length},getCellIndex:function(e){if(e){var t,i=e.className.match(this.colRe);if(i&&(t=i[1]))return parseInt(t.split("-")[1],10)}return!1},renderUI:function(){var e=this.templates,t=this.getGridInnerWidth();return e.master.apply({body:e.body.apply({rows:"&#160;"}),ostyle:"width:"+t+"px",bstyle:"width:"+t+"px"})},onLayout:function(e){Ext.grid.PivotGridView.superclass.onLayout.apply(this,arguments);var e=this.getGridInnerWidth();this.resizeColumnHeaders(e),this.resizeAllRows(e)},refresh:function(e){this.fireEvent("beforerefresh",this),this.grid.stopEditing(!0);var t=this.renderBody();this.mainBody.update(t).setWidth(this.getGridInnerWidth()),e===!0&&(this.updateHeaders(),this.updateHeaderSortState()),this.processRows(0,!0),this.layout(),this.applyEmptyText(),this.fireEvent("refresh",this)},renderHeaders:Ext.emptyFn,fitColumns:Ext.emptyFn,resizeColumnHeaders:function(e){var t=this.grid.topAxis;t.rendered&&t.el.setWidth(e)},resizeRowHeaders:function(){var e=this.getTotalRowHeaderWidth(),t=String.format("margin-left: {0}px;",e);this.rowHeadersEl.setWidth(e),this.mainBody.applyStyles(t),Ext.fly(this.innerHd).applyStyles(t),this.headerTitleEl.setWidth(e),this.headerTitleEl.setHeight(this.getTotalColumnHeaderHeight())},resizeAllRows:function(e){var t,i=this.getRows(),s=i.length;for(t=0;s>t;t++)Ext.fly(i[t]).setWidth(e),Ext.fly(i[t]).child("table").setWidth(e)},updateHeaders:function(){this.renderGroupRowHeaders(),this.renderGroupColumnHeaders()},renderGroupRowHeaders:function(){var e=this.grid.leftAxis;this.resizeRowHeaders(),e.rendered=!1,e.render(this.rowHeadersEl),this.setTitle(this.title)},setTitle:function(e){this.headerTitleEl.child("span").dom.innerHTML=e},renderGroupColumnHeaders:function(){var e=this.grid.topAxis;e.rendered=!1,e.render(this.innerHd.firstChild)},isMenuDisabled:function(){return!0}}),Ext.grid.PivotAxis=Ext.extend(Ext.Component,{orientation:"horizontal",defaultHeaderWidth:80,paddingWidth:7,setDimensions:function(e){this.dimensions=e},onRender:function(e){var t="horizontal"==this.orientation?this.renderHorizontalRows():this.renderVerticalRows();this.el=Ext.DomHelper.overwrite(e.dom,{tag:"table",cn:t},!0)},renderHorizontalRows:function(){var e,t,i,s,n,r=this.buildHeaders(),a=r.length,o=[];for(s=0;a>s;s++){for(e=[],t=r[s].items,i=t.length,n=0;i>n;n++)e.push({tag:"td",html:t[n].header,colspan:t[n].span});o[s]={tag:"tr",cn:e}}return o},renderVerticalRows:function(){var e,t,i,s,n,r,a=this.buildHeaders(),o=a.length,l=[],h=[];for(n=0;o>n;n++)for(t=a[n],s=t.width||80,e=t.items.length,r=0;e>r;r++)i=t.items[r],l[i.start]=l[i.start]||[],l[i.start].push({tag:"td",html:i.header,rowspan:i.span,width:Ext.isBorderBox?s:s-this.paddingWidth});for(e=l.length,n=0;e>n;n++)h[n]={tag:"tr",cn:l[n]};return h},getTuples:function(){var e=new Ext.data.Store({});e.data=this.store.data.clone(),e.fields=this.store.fields;var t,i=[],s=this.dimensions,n=s.length;for(t=0;n>t;t++)i.push({field:s[t].dataIndex,direction:s[t].direction||"ASC"});e.sort(i);var r,a,o,l,h=e.data.items,u=[],c=[];for(n=h.length,t=0;n>t;t++){a=this.getRecordInfo(h[t]),o=a.data,r="";for(l in o)r+=o[l]+"---";-1==u.indexOf(r)&&(u.push(r),c.push(a))}return e.destroy(),c},getRecordInfo:function(e){var t,i,s,n=this.dimensions,r=n.length,a={};for(s=0;r>s;s++)t=n[s],i=t.dataIndex,a[i]=e.get(i);var o=function(e){return function(t){for(var i in e)if(t.get(i)!=e[i])return!1;return!0}};return{data:a,matcher:o(a)}},buildHeaders:function(){var e,t,i,s,n,r,a,o,l,h,u,c=this.getTuples(),d=c.length,p=this.dimensions,f=p.length,m=[];for(h=0;f>h;h++){for(e=p[h],i=[],r=0,a=0,u=0;d>u;u++)t=c[u],o=u==d-1,s=t.data[e.dataIndex],l=void 0!=n&&n!=s,h>0&&u>0&&(l=l||t.data[p[h-1].dataIndex]!=c[u-1].data[p[h-1].dataIndex]),l&&(i.push({header:n,span:r,start:a}),a+=r,r=0),o&&(i.push({header:s,span:r+1,start:a}),a+=r,r=0),n=s,r++;m.push({items:i,width:e.width||this.defaultHeaderWidth}),n=void 0}return m}}),Ext.grid.HeaderDragZone=Ext.extend(Ext.dd.DragZone,{maxDragWidth:120,constructor:function(e,t,i){this.grid=e,this.view=e.getView(),this.ddGroup="gridHeader"+this.grid.getGridEl().id,Ext.grid.HeaderDragZone.superclass.constructor.call(this,t),i&&(this.setHandleElId(Ext.id(t)),this.setOuterHandleElId(Ext.id(i))),this.scroll=!1},getDragData:function(e){var t=Ext.lib.Event.getTarget(e),i=this.view.findHeaderCell(t);return i?{ddel:i.firstChild,header:i}:!1},onInitDrag:function(){this.dragHeadersDisabled=this.view.headersDisabled,this.view.headersDisabled=!0;var e=this.dragData.ddel.cloneNode(!0);return e.id=Ext.id(),e.style.width=Math.min(this.dragData.header.offsetWidth,this.maxDragWidth)+"px",this.proxy.update(e),!0},afterValidDrop:function(){this.completeDrop()},afterInvalidDrop:function(){this.completeDrop()},completeDrop:function(){var e=this.view,t=this.dragHeadersDisabled;setTimeout(function(){e.headersDisabled=t},50)}}),Ext.grid.HeaderDropZone=Ext.extend(Ext.dd.DropZone,{proxyOffsets:[-4,-9],fly:Ext.Element.fly,constructor:function(e){this.grid=e,this.view=e.getView(),this.proxyTop=Ext.DomHelper.append(document.body,{cls:"col-move-top",html:"&#160;"},!0),this.proxyBottom=Ext.DomHelper.append(document.body,{cls:"col-move-bottom",html:"&#160;"},!0),this.proxyTop.hide=this.proxyBottom.hide=function(){this.setLeftTop(-100,-100),this.setStyle("visibility","hidden")},this.ddGroup="gridHeader"+this.grid.getGridEl().id,Ext.grid.HeaderDropZone.superclass.constructor.call(this,e.getGridEl().dom)},getTargetFromEvent:function(e){var t=Ext.lib.Event.getTarget(e),i=this.view.findCellIndex(t);return i!==!1?this.view.getHeaderCell(i):void 0},nextVisible:function(e){var t=this.view,i=this.grid.colModel;for(e=e.nextSibling;e;){if(!i.isHidden(t.getCellIndex(e)))return e;e=e.nextSibling}return null},prevVisible:function(e){var t=this.view,i=this.grid.colModel;for(e=e.prevSibling;e;){if(!i.isHidden(t.getCellIndex(e)))return e;e=e.prevSibling}return null},positionIndicator:function(e,t,i){var s,n,r=Ext.lib.Event.getPageX(i),a=Ext.lib.Dom.getRegion(t.firstChild),o=a.top+this.proxyOffsets[1];return a.right-r<=(a.right-a.left)/2?(s=a.right+this.view.borderWidth,n="after"):(s=a.left,n="before"),this.grid.colModel.isFixed(this.view.getCellIndex(t))?!1:(s+=this.proxyOffsets[0],this.proxyTop.setLeftTop(s,o),this.proxyTop.show(),this.bottomOffset||(this.bottomOffset=this.view.mainHd.getHeight()),this.proxyBottom.setLeftTop(s,o+this.proxyTop.dom.offsetHeight+this.bottomOffset),this.proxyBottom.show(),n)},onNodeEnter:function(e,t,i,s){s.header!=e&&this.positionIndicator(s.header,e,i)},onNodeOver:function(e,t,i,s){var n=!1;return s.header!=e&&(n=this.positionIndicator(s.header,e,i)),n||(this.proxyTop.hide(),this.proxyBottom.hide()),n?this.dropAllowed:this.dropNotAllowed},onNodeOut:function(){this.proxyTop.hide(),this.proxyBottom.hide()},onNodeDrop:function(e,t,i,s){var n=s.header;if(n!=e){var r=this.grid.colModel,a=Ext.lib.Event.getPageX(i),o=Ext.lib.Dom.getRegion(e.firstChild),l=o.right-a<=(o.right-o.left)/2?"after":"before",h=this.view.getCellIndex(n),u=this.view.getCellIndex(e);return"after"==l&&u++,u>h&&u--,r.moveColumn(h,u),!0}return!1}}),Ext.grid.GridView.ColumnDragZone=Ext.extend(Ext.grid.HeaderDragZone,{constructor:function(e,t){Ext.grid.GridView.ColumnDragZone.superclass.constructor.call(this,e,t,null),this.proxy.el.addClass("x-grid3-col-dd")},handleMouseDown:function(){},callHandleMouseDown:function(e){Ext.grid.GridView.ColumnDragZone.superclass.handleMouseDown.call(this,e)}}),Ext.grid.SplitDragZone=Ext.extend(Ext.dd.DDProxy,{fly:Ext.Element.fly,constructor:function(e,t,i){this.grid=e,this.view=e.getView(),this.proxy=this.view.resizeProxy,Ext.grid.SplitDragZone.superclass.constructor.call(this,t,"gridSplitters"+this.grid.getGridEl().id,{dragElId:Ext.id(this.proxy.dom),resizeFrame:!1}),this.setHandleElId(Ext.id(t)),this.setOuterHandleElId(Ext.id(i)),this.scroll=!1},b4StartDrag:function(e,t){this.view.headersDisabled=!0,this.proxy.setHeight(this.view.mainWrap.getHeight());var i=this.cm.getColumnWidth(this.cellIndex),s=Math.max(i-this.grid.minColumnWidth,0);this.resetConstraints(),this.setXConstraint(s,1e3),this.setYConstraint(0,0),this.minX=e-s,this.maxX=e+1e3,this.startPos=e,Ext.dd.DDProxy.prototype.b4StartDrag.call(this,e,t)},handleMouseDown:function(e){var t=Ext.EventObject.setEvent(e),i=this.fly(t.getTarget());i.hasClass("x-grid-split")&&(this.cellIndex=this.view.getCellIndex(i.dom),this.split=i.dom,this.cm=this.grid.colModel,this.cm.isResizable(this.cellIndex)&&!this.cm.isFixed(this.cellIndex)&&Ext.grid.SplitDragZone.superclass.handleMouseDown.apply(this,arguments))},endDrag:function(e){this.view.headersDisabled=!1;var t=Math.max(this.minX,Ext.lib.Event.getPageX(e)),i=t-this.startPos;this.view.onColumnSplitterMoved(this.cellIndex,this.cm.getColumnWidth(this.cellIndex)+i)},autoOffset:function(){this.setDelta(0,0)}}),Ext.grid.GridDragZone=function(e,t){this.view=e.getView(),Ext.grid.GridDragZone.superclass.constructor.call(this,this.view.mainBody.dom,t),this.scroll=!1,this.grid=e,this.ddel=document.createElement("div"),this.ddel.className="x-grid-dd-wrap"},Ext.extend(Ext.grid.GridDragZone,Ext.dd.DragZone,{ddGroup:"GridDD",getDragData:function(e){var t=Ext.lib.Event.getTarget(e),i=this.view.findRowIndex(t);if(i!==!1){var s=this.grid.selModel;return(!s.isSelected(i)||e.hasModifier())&&s.handleMouseDown(this.grid,i,e),{grid:this.grid,ddel:this.ddel,rowIndex:i,selections:s.getSelections()}}return!1},onInitDrag:function(){this.dragData,this.ddel.innerHTML=this.grid.getDragDropText(),this.proxy.update(this.ddel)},afterRepair:function(){this.dragging=!1},getRepairXY:function(){return!1},onEndDrag:function(){},onValidDrop:function(){this.hideProxy()},beforeInvalidDrop:function(){}}),Ext.grid.ColumnModel=Ext.extend(Ext.util.Observable,{defaultWidth:100,defaultSortable:!1,constructor:function(e){e.columns?(Ext.apply(this,e),this.setConfig(e.columns,!0)):this.setConfig(e,!0),this.addEvents("widthchange","headerchange","hiddenchange","columnmoved","configchange"),Ext.grid.ColumnModel.superclass.constructor.call(this)},getColumnId:function(e){return this.config[e].id},getColumnAt:function(e){return this.config[e]},setConfig:function(e,t){var i,s,n;if(!t)for(delete this.totalWidth,i=0,n=this.config.length;n>i;i++)s=this.config[i],s.setEditor&&s.setEditor(null);for(this.defaults=Ext.apply({width:this.defaultWidth,sortable:this.defaultSortable},this.defaults),this.config=e,this.lookup={},i=0,n=e.length;n>i;i++){if(s=Ext.applyIf(e[i],this.defaults),Ext.isEmpty(s.id)&&(s.id=i),!s.isColumn){var r=Ext.grid.Column.types[s.xtype||"gridcolumn"];s=new r(s),e[i]=s}this.lookup[s.id]=s}t||this.fireEvent("configchange",this)},getColumnById:function(e){return this.lookup[e]},getIndexById:function(e){for(var t=0,i=this.config.length;i>t;t++)if(this.config[t].id==e)return t;return-1},moveColumn:function(e,t){var i=this.config,s=i[e];i.splice(e,1),i.splice(t,0,s),this.dataMap=null,this.fireEvent("columnmoved",this,e,t)},getColumnCount:function(e){var t,i=this.config.length,s=0;if(e===!0){for(t=0;i>t;t++)this.isHidden(t)||s++;return s}return i},getColumnsBy:function(e,t){var i,s,n=this.config,r=n.length,a=[];for(i=0;r>i;i++)s=n[i],e.call(t||this,s,i)===!0&&(a[a.length]=s);return a},isSortable:function(e){return!!this.config[e].sortable},isMenuDisabled:function(e){return!!this.config[e].menuDisabled},getRenderer:function(e){return this.config[e].renderer||Ext.grid.ColumnModel.defaultRenderer},getRendererScope:function(e){return this.config[e].scope},setRenderer:function(e,t){this.config[e].renderer=t},getColumnWidth:function(e){var t=this.config[e].width;return"number"!=typeof t&&(t=this.defaultWidth),t},setColumnWidth:function(e,t,i){this.config[e].width=t,this.totalWidth=null,i||this.fireEvent("widthchange",this,e,t)},getTotalWidth:function(e){if(!this.totalWidth){this.totalWidth=0;for(var t=0,i=this.config.length;i>t;t++)(e||!this.isHidden(t))&&(this.totalWidth+=this.getColumnWidth(t))}return this.totalWidth},getColumnHeader:function(e){return this.config[e].header},setColumnHeader:function(e,t){this.config[e].header=t,this.fireEvent("headerchange",this,e,t)},getColumnTooltip:function(e){return this.config[e].tooltip},setColumnTooltip:function(e,t){this.config[e].tooltip=t},getDataIndex:function(e){return this.config[e].dataIndex},setDataIndex:function(e,t){this.config[e].dataIndex=t},findColumnIndex:function(e){for(var t=this.config,i=0,s=t.length;s>i;i++)if(t[i].dataIndex==e)return i;return-1},isCellEditable:function(e){var t=this.config[e],i=t.editable;return!!(i||!Ext.isDefined(i)&&t.editor)},getCellEditor:function(e,t){return this.config[e].getCellEditor(t)},setEditable:function(e,t){this.config[e].editable=t},isHidden:function(e){return!!this.config[e].hidden},isFixed:function(e){return!!this.config[e].fixed},isResizable:function(e){return e>=0&&this.config[e].resizable!==!1&&this.config[e].fixed!==!0},setHidden:function(e,t){var i=this.config[e];i.hidden!==t&&(i.hidden=t,this.totalWidth=null,this.fireEvent("hiddenchange",this,e,t))},setEditor:function(e,t){this.config[e].setEditor(t)},destroy:function(){for(var e=this.config.length,t=0;e>t;t++)this.config[t].destroy();delete this.config,delete this.lookup,this.purgeListeners()},setState:function(e,t){t=Ext.applyIf(t,this.defaults),Ext.apply(this.config[e],t)}}),Ext.grid.ColumnModel.defaultRenderer=function(e){return"string"==typeof e&&e.length<1?"&#160;":e},Ext.grid.AbstractSelectionModel=Ext.extend(Ext.util.Observable,{constructor:function(){this.locked=!1,Ext.grid.AbstractSelectionModel.superclass.constructor.call(this)},init:function(e){this.grid=e,this.lockOnInit&&(delete this.lockOnInit,this.locked=!1,this.lock()),this.initEvents()},lock:function(){if(!this.locked){this.locked=!0;var e=this.grid;e?e.getView().on({scope:this,beforerefresh:this.sortUnLock,refresh:this.sortLock}):this.lockOnInit=!0}},sortLock:function(){this.locked=!0},sortUnLock:function(){this.locked=!1},unlock:function(){if(this.locked){this.locked=!1;var e,t=this.grid;t?(e=t.getView(),e.un("beforerefresh",this.sortUnLock,this),e.un("refresh",this.sortLock,this)):delete this.lockOnInit}},isLocked:function(){return this.locked},destroy:function(){this.unlock(),this.purgeListeners()}}),Ext.grid.RowSelectionModel=Ext.extend(Ext.grid.AbstractSelectionModel,{singleSelect:!1,constructor:function(e){Ext.apply(this,e),this.selections=new Ext.util.MixedCollection(!1,function(e){return e.id}),this.last=!1,this.lastActive=!1,this.addEvents("selectionchange","beforerowselect","rowselect","rowdeselect"),Ext.grid.RowSelectionModel.superclass.constructor.call(this)},initEvents:function(){this.grid.enableDragDrop||this.grid.enableDrag||this.grid.on("rowmousedown",this.handleMouseDown,this),this.rowNav=new Ext.KeyNav(this.grid.getGridEl(),{up:this.onKeyPress,down:this.onKeyPress,scope:this}),this.grid.getView().on({scope:this,refresh:this.onRefresh,rowupdated:this.onRowUpdated,rowremoved:this.onRemove})},onKeyPress:function(e,t){var i,s="up"==t,n=s?"selectPrevious":"selectNext",r=s?-1:1;!e.shiftKey||this.singleSelect?this[n](!1):this.last!==!1&&this.lastActive!==!1?(i=this.last,this.selectRange(this.last,this.lastActive+r),this.grid.getView().focusRow(this.lastActive),i!==!1&&(this.last=i)):this.selectFirstRow()},onRefresh:function(){var e,t,i=this.grid.store,s=this.getSelections(),n=0,r=s.length;for(this.silent=!0,this.clearSelections(!0);r>n;n++)t=s[n],-1!=(e=i.indexOfId(t.id))&&this.selectRow(e,!0);s.length!=this.selections.getCount()&&this.fireEvent("selectionchange",this),this.silent=!1},onRemove:function(e,t,i){this.selections.remove(i)!==!1&&this.fireEvent("selectionchange",this)},onRowUpdated:function(e,t,i){this.isSelected(i)&&e.onRowSelect(t)},selectRecords:function(e,t){t||this.clearSelections();for(var i=this.grid.store,s=0,n=e.length;n>s;s++)this.selectRow(i.indexOf(e[s]),!0)},getCount:function(){return this.selections.length},selectFirstRow:function(){this.selectRow(0)},selectLastRow:function(e){this.selectRow(this.grid.store.getCount()-1,e)},selectNext:function(e){return this.hasNext()?(this.selectRow(this.last+1,e),this.grid.getView().focusRow(this.last),!0):!1},selectPrevious:function(e){return this.hasPrevious()?(this.selectRow(this.last-1,e),this.grid.getView().focusRow(this.last),!0):!1},hasNext:function(){return this.last!==!1&&this.last+1<this.grid.store.getCount()},hasPrevious:function(){return!!this.last},getSelections:function(){return[].concat(this.selections.items)},getSelected:function(){return this.selections.itemAt(0)},each:function(e,t){for(var i=this.getSelections(),s=0,n=i.length;n>s;s++)if(e.call(t||this,i[s],s)===!1)return!1;return!0},clearSelections:function(e){if(!this.isLocked()){if(e!==!0){var t=this.grid.store,i=this.selections;i.each(function(e){this.deselectRow(t.indexOfId(e.id))},this),i.clear()}else this.selections.clear();this.last=!1}},selectAll:function(){if(!this.isLocked()){this.selections.clear();for(var e=0,t=this.grid.store.getCount();t>e;e++)this.selectRow(e,!0)}},hasSelection:function(){return this.selections.length>0},isSelected:function(e){var t=Ext.isNumber(e)?this.grid.store.getAt(e):e;return t&&this.selections.key(t.id)?!0:!1},isIdSelected:function(e){return this.selections.key(e)?!0:!1},handleMouseDown:function(e,t,i){if(0===i.button&&!this.isLocked()){var s=this.grid.getView();if(i.shiftKey&&!this.singleSelect&&this.last!==!1){var n=this.last;this.selectRange(n,t,i.ctrlKey),this.last=n,s.focusRow(t)}else{var r=this.isSelected(t);i.ctrlKey&&r?this.deselectRow(t):(!r||this.getCount()>1)&&(this.selectRow(t,i.ctrlKey||i.shiftKey),s.focusRow(t))}}},selectRows:function(e,t){t||this.clearSelections();for(var i=0,s=e.length;s>i;i++)this.selectRow(e[i],!0)},selectRange:function(e,t,i){var s;if(!this.isLocked())if(i||this.clearSelections(),t>=e)for(s=e;t>=s;s++)this.selectRow(s,!0);else for(s=e;s>=t;s--)this.selectRow(s,!0)},deselectRange:function(e,t,i){if(!this.isLocked())for(var s=e;t>=s;s++)this.deselectRow(s,i)},selectRow:function(e,t,i){if(!(this.isLocked()||0>e||e>=this.grid.store.getCount()||t&&this.isSelected(e))){var s=this.grid.store.getAt(e);s&&this.fireEvent("beforerowselect",this,e,t,s)!==!1&&((!t||this.singleSelect)&&this.clearSelections(),this.selections.add(s),this.last=this.lastActive=e,i||this.grid.getView().onRowSelect(e),this.silent||(this.fireEvent("rowselect",this,e,s),this.fireEvent("selectionchange",this)))
}},deselectRow:function(e,t){if(!this.isLocked()){this.last==e&&(this.last=!1),this.lastActive==e&&(this.lastActive=!1);var i=this.grid.store.getAt(e);i&&(this.selections.remove(i),t||this.grid.getView().onRowDeselect(e),this.fireEvent("rowdeselect",this,e,i),this.fireEvent("selectionchange",this))}},acceptsNav:function(e,t,i){return!i.isHidden(t)&&i.isCellEditable(t,e)},onEditorKey:function(e,t){var i,s,n,r,a,o=t.getKey(),l=this.grid,n=l.lastEdit,h=l.activeEditor,u=t.shiftKey;o==t.TAB?(t.stopEvent(),h.completeEdit(),i=u?l.walkCells(h.row,h.col-1,-1,this.acceptsNav,this):l.walkCells(h.row,h.col+1,1,this.acceptsNav,this)):o==t.ENTER&&this.moveEditorOnEnter!==!1&&(i=u?l.walkCells(n.row-1,n.col,-1,this.acceptsNav,this):l.walkCells(n.row+1,n.col,1,this.acceptsNav,this)),i&&(r=i[0],a=i[1],this.onEditorSelect(r,n.row),l.isEditor&&l.editing&&(s=l.activeEditor,s&&s.field.triggerBlur&&s.field.triggerBlur()),l.startEditing(r,a))},onEditorSelect:function(e,t){t!=e&&this.selectRow(e)},destroy:function(){Ext.destroy(this.rowNav),this.rowNav=null,Ext.grid.RowSelectionModel.superclass.destroy.call(this)}}),Ext.grid.Column=Ext.extend(Ext.util.Observable,{isColumn:!0,constructor:function(e){Ext.apply(this,e),Ext.isString(this.renderer)?this.renderer=Ext.util.Format[this.renderer]:Ext.isObject(this.renderer)&&(this.scope=this.renderer.scope,this.renderer=this.renderer.fn),this.scope||(this.scope=this);var t=this.editor;delete this.editor,this.setEditor(t),this.addEvents("click","contextmenu","dblclick","mousedown"),Ext.grid.Column.superclass.constructor.call(this)},processEvent:function(e,t,i,s){return this.fireEvent(e,this,i,s,t)},destroy:function(){this.setEditor&&this.setEditor(null),this.purgeListeners()},renderer:function(e){return e},getEditor:function(){return this.editable!==!1?this.editor:null},setEditor:function(e){var t=this.editor;t&&(t.gridEditor?(t.gridEditor.destroy(),delete t.gridEditor):t.destroy()),this.editor=null,e&&(e.isXType||(e=Ext.create(e,"textfield")),this.editor=e)},getCellEditor:function(e){var t=this.getEditor(e);return t&&(t.startEdit||(t.gridEditor||(t.gridEditor=new Ext.grid.GridEditor(t)),t=t.gridEditor)),t}}),Ext.grid.BooleanColumn=Ext.extend(Ext.grid.Column,{trueText:"true",falseText:"false",undefinedText:"&#160;",constructor:function(e){Ext.grid.BooleanColumn.superclass.constructor.call(this,e);var t=this.trueText,i=this.falseText,s=this.undefinedText;this.renderer=function(e){return void 0===e?s:e&&"false"!==e?t:i}}}),Ext.grid.NumberColumn=Ext.extend(Ext.grid.Column,{format:"0,000.00",constructor:function(e){Ext.grid.NumberColumn.superclass.constructor.call(this,e),this.renderer=Ext.util.Format.numberRenderer(this.format)}}),Ext.grid.DateColumn=Ext.extend(Ext.grid.Column,{format:"m/d/Y",constructor:function(e){Ext.grid.DateColumn.superclass.constructor.call(this,e),this.renderer=Ext.util.Format.dateRenderer(this.format)}}),Ext.grid.TemplateColumn=Ext.extend(Ext.grid.Column,{constructor:function(e){Ext.grid.TemplateColumn.superclass.constructor.call(this,e);var t=!Ext.isPrimitive(this.tpl)&&this.tpl.compile?this.tpl:new Ext.XTemplate(this.tpl);this.renderer=function(e,i,s){return t.apply(s.data)},this.tpl=t}}),Ext.grid.ActionColumn=Ext.extend(Ext.grid.Column,{header:"&#160;",actionIdRe:/x-action-col-(\d+)/,altText:"",constructor:function(e){var t,i,s=this,n=e.items||(s.items=[s]),r=n.length;Ext.grid.ActionColumn.superclass.constructor.call(s,e),s.renderer=function(a,o){for(a=Ext.isFunction(e.renderer)?e.renderer.apply(this,arguments)||"":"",o.css+=" x-action-col-cell",t=0;r>t;t++)i=n[t],a+='<img alt="'+(i.altText||s.altText)+'" src="'+(i.icon||Ext.BLANK_IMAGE_URL)+'" class="x-action-col-icon x-action-col-'+String(t)+" "+(i.iconCls||"")+" "+(Ext.isFunction(i.getClass)?i.getClass.apply(i.scope||this.scope||this,arguments):"")+'"'+(i.tooltip?' ext:qtip="'+i.tooltip+'"':"")+" />";return a}},destroy:function(){return delete this.items,delete this.renderer,Ext.grid.ActionColumn.superclass.destroy.apply(this,arguments)},processEvent:function(e,t,i,s,n){var r,a,o=t.getTarget().className.match(this.actionIdRe);if(o&&(r=this.items[parseInt(o[1],10)]))if("click"==e)(a=r.handler||this.handler)&&a.call(r.scope||this.scope||this,i,s,n,r,t);else if("mousedown"==e&&r.stopSelection!==!1)return!1;return Ext.grid.ActionColumn.superclass.processEvent.apply(this,arguments)}}),Ext.grid.Column.types={gridcolumn:Ext.grid.Column,booleancolumn:Ext.grid.BooleanColumn,numbercolumn:Ext.grid.NumberColumn,datecolumn:Ext.grid.DateColumn,templatecolumn:Ext.grid.TemplateColumn,actioncolumn:Ext.grid.ActionColumn},Ext.grid.RowNumberer=Ext.extend(Object,{header:"",width:23,sortable:!1,constructor:function(e){Ext.apply(this,e),this.rowspan&&(this.renderer=this.renderer.createDelegate(this))},fixed:!0,hideable:!1,menuDisabled:!0,dataIndex:"",id:"numberer",rowspan:void 0,renderer:function(e,t,i,s){return this.rowspan&&(t.cellAttr='rowspan="'+this.rowspan+'"'),s+1}}),Ext.grid.CheckboxSelectionModel=Ext.extend(Ext.grid.RowSelectionModel,{header:'<div class="x-grid3-hd-checker">&#160;</div>',width:20,sortable:!1,menuDisabled:!0,fixed:!0,hideable:!1,dataIndex:"",id:"checker",isColumn:!0,constructor:function(){Ext.grid.CheckboxSelectionModel.superclass.constructor.apply(this,arguments),this.checkOnly&&(this.handleMouseDown=Ext.emptyFn)},initEvents:function(){Ext.grid.CheckboxSelectionModel.superclass.initEvents.call(this),this.grid.on("render",function(){Ext.fly(this.grid.getView().innerHd).on("mousedown",this.onHdMouseDown,this)},this)},processEvent:function(e,t){return"mousedown"==e?(this.onMouseDown(t,t.getTarget()),!1):Ext.grid.Column.prototype.processEvent.apply(this,arguments)},onMouseDown:function(e,t){if(0===e.button&&"x-grid3-row-checker"==t.className){e.stopEvent();var i=e.getTarget(".x-grid3-row");if(i){var s=i.rowIndex;this.isSelected(s)?this.deselectRow(s):(this.selectRow(s,!0),this.grid.getView().focusRow(s))}}},onHdMouseDown:function(e,t){if("x-grid3-hd-checker"==t.className){e.stopEvent();var i=Ext.fly(t.parentNode),s=i.hasClass("x-grid3-hd-checker-on");s?(i.removeClass("x-grid3-hd-checker-on"),this.clearSelections()):(i.addClass("x-grid3-hd-checker-on"),this.selectAll())}},renderer:function(){return'<div class="x-grid3-row-checker">&#160;</div>'},onEditorSelect:function(e,t){t==e||this.checkOnly||this.selectRow(e)}}),Ext.grid.CellSelectionModel=Ext.extend(Ext.grid.AbstractSelectionModel,{constructor:function(e){Ext.apply(this,e),this.selection=null,this.addEvents("beforecellselect","cellselect","selectionchange"),Ext.grid.CellSelectionModel.superclass.constructor.call(this)},initEvents:function(){this.grid.on("cellmousedown",this.handleMouseDown,this),this.grid.on(Ext.EventManager.getKeyEvent(),this.handleKeyDown,this),this.grid.getView().on({scope:this,refresh:this.onViewChange,rowupdated:this.onRowUpdated,beforerowremoved:this.clearSelections,beforerowsinserted:this.clearSelections}),this.grid.isEditor&&this.grid.on("beforeedit",this.beforeEdit,this)},beforeEdit:function(e){this.select(e.row,e.column,!1,!0,e.record)},onRowUpdated:function(e,t,i){this.selection&&this.selection.record==i&&e.onCellSelect(t,this.selection.cell[1])},onViewChange:function(){this.clearSelections(!0)},getSelectedCell:function(){return this.selection?this.selection.cell:null},clearSelections:function(e){var t=this.selection;t&&(e!==!0&&this.grid.view.onCellDeselect(t.cell[0],t.cell[1]),this.selection=null,this.fireEvent("selectionchange",this,null))},hasSelection:function(){return this.selection?!0:!1},handleMouseDown:function(e,t,i,s){0!==s.button||this.isLocked()||this.select(t,i)},select:function(e,t,i,s,n){if(this.fireEvent("beforecellselect",this,e,t)!==!1){if(this.clearSelections(),n=n||this.grid.store.getAt(e),this.selection={record:n,cell:[e,t]},!i){var r=this.grid.getView();r.onCellSelect(e,t),s!==!0&&r.focusCell(e,t)}this.fireEvent("cellselect",this,e,t),this.fireEvent("selectionchange",this,this.selection)}},isSelectable:function(e,t,i){return!i.isHidden(t)},onEditorKey:function(e,t){t.getKey()==t.TAB&&this.handleKeyDown(t)},handleKeyDown:function(e){if(e.isNavKeyPress()){var t,i,s,n,r,a=e.getKey(),o=this.grid,l=this.selection,h=this,u=function(e,t,i){return o.walkCells(e,t,i,o.isEditor&&o.editing?h.acceptsNav:h.isSelectable,h)};switch(a){case e.ESC:case e.PAGE_UP:case e.PAGE_DOWN:break;default:e.stopEvent()}if(!l)return t=u(0,0,1),t&&this.select(t[0],t[1]),void 0;switch(t=l.cell,s=t[0],n=t[1],a){case e.TAB:i=e.shiftKey?u(s,n-1,-1):u(s,n+1,1);break;case e.DOWN:i=u(s+1,n,1);break;case e.UP:i=u(s-1,n,-1);break;case e.RIGHT:i=u(s,n+1,1);break;case e.LEFT:i=u(s,n-1,-1);break;case e.ENTER:if(o.isEditor&&!o.editing)return o.startEditing(s,n),void 0}i&&(s=i[0],n=i[1],this.select(s,n),o.isEditor&&o.editing&&(r=o.activeEditor,r&&r.field.triggerBlur&&r.field.triggerBlur(),o.startEditing(s,n)))}},acceptsNav:function(e,t,i){return!i.isHidden(t)&&i.isCellEditable(t,e)}}),Ext.grid.EditorGridPanel=Ext.extend(Ext.grid.GridPanel,{clicksToEdit:2,forceValidation:!1,isEditor:!0,detectEdit:!1,autoEncode:!1,trackMouseOver:!1,initComponent:function(){Ext.grid.EditorGridPanel.superclass.initComponent.call(this),this.selModel||(this.selModel=new Ext.grid.CellSelectionModel),this.activeEditor=null,this.addEvents("beforeedit","afteredit","validateedit")},initEvents:function(){if(Ext.grid.EditorGridPanel.superclass.initEvents.call(this),this.getGridEl().on("mousewheel",this.stopEditing.createDelegate(this,[!0]),this),this.on("columnresize",this.stopEditing,this,[!0]),1==this.clicksToEdit)this.on("cellclick",this.onCellDblClick,this);else{var e=this.getView();"auto"==this.clicksToEdit&&e.mainBody&&e.mainBody.on("mousedown",this.onAutoEditClick,this),this.on("celldblclick",this.onCellDblClick,this)}},onResize:function(){Ext.grid.EditorGridPanel.superclass.onResize.apply(this,arguments);var e=this.activeEditor;this.editing&&e&&e.realign(!0)},onCellDblClick:function(e,t,i){this.startEditing(t,i)},onAutoEditClick:function(e,t){if(0===e.button){var i=this.view.findRowIndex(t),s=this.view.findCellIndex(t);if(i!==!1&&s!==!1)if(this.stopEditing(),this.selModel.getSelectedCell){var n=this.selModel.getSelectedCell();n&&n[0]===i&&n[1]===s&&this.startEditing(i,s)}else this.selModel.isSelected(i)&&this.startEditing(i,s)}},onEditComplete:function(e,t,i){this.editing=!1,this.lastActiveEditor=this.activeEditor,this.activeEditor=null;var s=e.record,n=this.colModel.getDataIndex(e.col);if(t=this.postEditValue(t,i,s,n),this.forceValidation===!0||String(t)!==String(i)){var r={grid:this,record:s,field:n,originalValue:i,value:t,row:e.row,column:e.col,cancel:!1};this.fireEvent("validateedit",r)===!1||r.cancel||String(t)===String(i)||(s.set(n,r.value),delete r.cancel,this.fireEvent("afteredit",r))}this.view.focusCell(e.row,e.col)},startEditing:function(e,t){if(this.stopEditing(),this.colModel.isCellEditable(t,e)){this.view.ensureVisible(e,t,!0);var i=this.store.getAt(e),s=this.colModel.getDataIndex(t),n={grid:this,record:i,field:s,value:i.data[s],row:e,column:t,cancel:!1};if(this.fireEvent("beforeedit",n)!==!1&&!n.cancel){this.editing=!0;var r=this.colModel.getCellEditor(t,e);if(!r)return;r.rendered||(r.parentEl=this.view.getEditorParent(r),r.on({scope:this,render:{fn:function(e){e.field.focus(!1,!0)},single:!0,scope:this},specialkey:function(e,t){this.getSelectionModel().onEditorKey(e,t)},complete:this.onEditComplete,canceledit:this.stopEditing.createDelegate(this,[!0])})),Ext.apply(r,{row:e,col:t,record:i}),this.lastEdit={row:e,col:t},this.activeEditor=r,r.selectSameEditor=this.activeEditor==this.lastActiveEditor;var a=this.preEditValue(i,s);r.startEdit(this.view.getCell(e,t).firstChild,Ext.isDefined(a)?a:""),function(){delete r.selectSameEditor}.defer(50)}}},preEditValue:function(e,t){var i=e.data[t];return this.autoEncode&&Ext.isString(i)?Ext.util.Format.htmlDecode(i):i},postEditValue:function(e){return this.autoEncode&&Ext.isString(e)?Ext.util.Format.htmlEncode(e):e},stopEditing:function(e){if(this.editing){var t=this.lastActiveEditor=this.activeEditor;t&&(t[e===!0?"cancelEdit":"completeEdit"](),this.view.focusCell(t.row,t.col)),this.activeEditor=null}this.editing=!1}}),Ext.reg("editorgrid",Ext.grid.EditorGridPanel),Ext.grid.GridEditor=function(e,t){Ext.grid.GridEditor.superclass.constructor.call(this,e,t),e.monitorTab=!1},Ext.extend(Ext.grid.GridEditor,Ext.Editor,{alignment:"tl-tl",autoSize:"width",hideEl:!1,cls:"x-small-editor x-grid-editor",shim:!1,shadow:!1}),Ext.grid.PropertyRecord=Ext.data.Record.create([{name:"name",type:"string"},"value"]),Ext.grid.PropertyStore=Ext.extend(Ext.util.Observable,{constructor:function(e,t){this.grid=e,this.store=new Ext.data.Store({recordType:Ext.grid.PropertyRecord}),this.store.on("update",this.onUpdate,this),t&&this.setSource(t),Ext.grid.PropertyStore.superclass.constructor.call(this)},setSource:function(e){this.source=e,this.store.removeAll();var t=[];for(var i in e)this.isEditableValue(e[i])&&t.push(new Ext.grid.PropertyRecord({name:i,value:e[i]},i));this.store.loadRecords({records:t},{},!0)},onUpdate:function(e,t,i){if(i==Ext.data.Record.EDIT){var s=t.data.value,n=t.modified.value;this.grid.fireEvent("beforepropertychange",this.source,t.id,s,n)!==!1?(this.source[t.id]=s,t.commit(),this.grid.fireEvent("propertychange",this.source,t.id,s,n)):t.reject()}},getProperty:function(e){return this.store.getAt(e)},isEditableValue:function(e){return Ext.isPrimitive(e)||Ext.isDate(e)},setValue:function(e,t,i){var s=this.getRec(e);s?(s.set("value",t),this.source[e]=t):i&&(this.source[e]=t,s=new Ext.grid.PropertyRecord({name:e,value:t},e),this.store.add(s))},remove:function(e){var t=this.getRec(e);t&&(this.store.remove(t),delete this.source[e])},getRec:function(e){return this.store.getById(e)},getSource:function(){return this.source}}),Ext.grid.PropertyColumnModel=Ext.extend(Ext.grid.ColumnModel,{nameText:"Name",valueText:"Value",dateFormat:"m/j/Y",trueText:"true",falseText:"false",constructor:function(e,t){var i=Ext.grid,s=Ext.form;this.grid=e,i.PropertyColumnModel.superclass.constructor.call(this,[{header:this.nameText,width:50,sortable:!0,dataIndex:"name",id:"name",menuDisabled:!0},{header:this.valueText,width:50,resizable:!1,dataIndex:"value",id:"value",menuDisabled:!0}]),this.store=t;var n=new s.Field({autoCreate:{tag:"select",children:[{tag:"option",value:"true",html:this.trueText},{tag:"option",value:"false",html:this.falseText}]},getValue:function(){return"true"==this.el.dom.value}});this.editors={date:new i.GridEditor(new s.DateField({selectOnFocus:!0})),string:new i.GridEditor(new s.TextField({selectOnFocus:!0})),number:new i.GridEditor(new s.NumberField({selectOnFocus:!0,style:"text-align:left;"})),"boolean":new i.GridEditor(n,{autoSize:"both"})},this.renderCellDelegate=this.renderCell.createDelegate(this),this.renderPropDelegate=this.renderProp.createDelegate(this)},renderDate:function(e){return e.dateFormat(this.dateFormat)},renderBool:function(e){return this[e?"trueText":"falseText"]},isCellEditable:function(e){return 1==e},getRenderer:function(e){return 1==e?this.renderCellDelegate:this.renderPropDelegate},renderProp:function(e){return this.getPropertyName(e)},renderCell:function(e,t,i){var s=this.grid.customRenderers[i.get("name")];if(s)return s.apply(this,arguments);var n=e;return Ext.isDate(e)?n=this.renderDate(e):"boolean"==typeof e&&(n=this.renderBool(e)),Ext.util.Format.htmlEncode(n)},getPropertyName:function(e){var t=this.grid.propertyNames;return t&&t[e]?t[e]:e},getCellEditor:function(e,t){var i=this.store.getProperty(t),s=i.data.name,n=i.data.value;return this.grid.customEditors[s]?this.grid.customEditors[s]:Ext.isDate(n)?this.editors.date:"number"==typeof n?this.editors.number:"boolean"==typeof n?this.editors["boolean"]:this.editors.string},destroy:function(){Ext.grid.PropertyColumnModel.superclass.destroy.call(this),this.destroyEditors(this.editors),this.destroyEditors(this.grid.customEditors)},destroyEditors:function(e){for(var t in e)Ext.destroy(e[t])}}),Ext.grid.PropertyGrid=Ext.extend(Ext.grid.EditorGridPanel,{enableColumnMove:!1,stripeRows:!1,trackMouseOver:!1,clicksToEdit:1,enableHdMenu:!1,viewConfig:{forceFit:!0},initComponent:function(){this.customRenderers=this.customRenderers||{},this.customEditors=this.customEditors||{},this.lastEditRow=null;var e=new Ext.grid.PropertyStore(this);this.propStore=e;var t=new Ext.grid.PropertyColumnModel(this,e);e.store.sort("name","ASC"),this.addEvents("beforepropertychange","propertychange"),this.cm=t,this.ds=e.store,Ext.grid.PropertyGrid.superclass.initComponent.call(this),this.mon(this.selModel,"beforecellselect",function(e,t,i){return 0===i?(this.startEditing.defer(200,this,[t,1]),!1):void 0},this)},onRender:function(){Ext.grid.PropertyGrid.superclass.onRender.apply(this,arguments),this.getGridEl().addClass("x-props-grid")},afterRender:function(){Ext.grid.PropertyGrid.superclass.afterRender.apply(this,arguments),this.source&&this.setSource(this.source)},setSource:function(e){this.propStore.setSource(e)},getSource:function(){return this.propStore.getSource()},setProperty:function(e,t,i){this.propStore.setValue(e,t,i)},removeProperty:function(e){this.propStore.remove(e)}}),Ext.reg("propertygrid",Ext.grid.PropertyGrid),Ext.grid.GroupingView=Ext.extend(Ext.grid.GridView,{groupByText:"Group By This Field",showGroupsText:"Show in Groups",hideGroupedColumn:!1,showGroupName:!0,startCollapsed:!1,enableGrouping:!0,enableGroupingMenu:!0,enableNoGroups:!0,emptyGroupText:"(None)",ignoreAdd:!1,groupTextTpl:"{text}",groupMode:"value",cancelEditOnToggle:!0,initTemplates:function(){Ext.grid.GroupingView.superclass.initTemplates.call(this),this.state={};var e=this.grid.getSelectionModel();e.on(e.selectRow?"beforerowselect":"beforecellselect",this.onBeforeRowSelect,this),this.startGroup||(this.startGroup=new Ext.XTemplate('<div id="{groupId}" class="x-grid-group {cls}">','<div id="{groupId}-hd" class="x-grid-group-hd" style="{style}"><div class="x-grid-group-title">',this.groupTextTpl,"</div></div>",'<div id="{groupId}-bd" class="x-grid-group-body">')),this.startGroup.compile(),this.endGroup||(this.endGroup="</div></div>")},findGroup:function(e){return Ext.fly(e).up(".x-grid-group",this.mainBody.dom)},getGroups:function(){return this.hasRows()?this.mainBody.dom.childNodes:[]},onAdd:function(e,t,i){if(this.canGroup()&&!this.ignoreAdd){var s=this.getScrollState();this.fireEvent("beforerowsinserted",e,i,i+(t.length-1)),this.refresh(),this.restoreScroll(s),this.fireEvent("rowsinserted",e,i,i+(t.length-1))}else this.canGroup()||Ext.grid.GroupingView.superclass.onAdd.apply(this,arguments)},onRemove:function(e,t){Ext.grid.GroupingView.superclass.onRemove.apply(this,arguments);var i=document.getElementById(t._groupId);i&&i.childNodes[1].childNodes.length<1&&Ext.removeNode(i),this.applyEmptyText()},refreshRow:function(){1==this.ds.getCount()?this.refresh():(this.isUpdating=!0,Ext.grid.GroupingView.superclass.refreshRow.apply(this,arguments),this.isUpdating=!1)},beforeMenuShow:function(){var e,t=this.hmenu.items,i=this.cm.config[this.hdCtxIndex].groupable===!1;(e=t.get("groupBy"))&&e.setDisabled(i),(e=t.get("showGroups"))&&(e.setDisabled(i),e.setChecked(this.canGroup(),!0))},renderUI:function(){var e=Ext.grid.GroupingView.superclass.renderUI.call(this);return this.enableGroupingMenu&&this.hmenu&&(this.hmenu.add("-",{itemId:"groupBy",text:this.groupByText,handler:this.onGroupByClick,scope:this,iconCls:"x-group-by-icon"}),this.enableNoGroups&&this.hmenu.add({itemId:"showGroups",text:this.showGroupsText,checked:!0,checkHandler:this.onShowGroupsClick,scope:this}),this.hmenu.on("beforeshow",this.beforeMenuShow,this)),e},processEvent:function(e,t){Ext.grid.GroupingView.superclass.processEvent.call(this,e,t);var i=t.getTarget(".x-grid-group-hd",this.mainBody);if(i){var s=this.getGroupField(),n=this.getPrefix(s),r=i.id.substring(n.length),a=new RegExp("gp-"+Ext.escapeRe(s)+"--hd");r=r.substr(0,r.length-3),(r||a.test(i.id))&&this.grid.fireEvent("group"+e,this.grid,s,r,t),"mousedown"==e&&0==t.button&&this.toggleGroup(i.parentNode)}},onGroupByClick:function(){var e=this.grid;this.enableGrouping=!0,e.store.groupBy(this.cm.getDataIndex(this.hdCtxIndex)),e.fireEvent("groupchange",e,e.store.getGroupState()),this.beforeMenuShow(),this.refresh()},onShowGroupsClick:function(e,t){this.enableGrouping=t,t?this.onGroupByClick():(this.grid.store.clearGrouping(),this.grid.fireEvent("groupchange",this,null))},toggleRowIndex:function(e,t){if(this.canGroup()){var i=this.getRow(e);i&&this.toggleGroup(this.findGroup(i),t)}},toggleGroup:function(e,t){var i=Ext.get(e),s=Ext.util.Format.htmlEncode(i.id);t=Ext.isDefined(t)?t:i.hasClass("x-grid-group-collapsed"),this.state[s]!==t&&(this.cancelEditOnToggle!==!1&&this.grid.stopEditing(!0),this.state[s]=t,i[t?"removeClass":"addClass"]("x-grid-group-collapsed"))},toggleAllGroups:function(e){for(var t=this.getGroups(),i=0,s=t.length;s>i;i++)this.toggleGroup(t[i],e)},expandAllGroups:function(){this.toggleAllGroups(!0)},collapseAllGroups:function(){this.toggleAllGroups(!1)},getGroup:function(e,t,i,s,n,r){var a=this.cm.config[n],o=i?i.call(a.scope,e,{},t,s,n,r):String(e);return(""===o||"&#160;"===o)&&(o=a.emptyGroupText||this.emptyGroupText),o},getGroupField:function(){return this.grid.store.getGroupState()},afterRender:function(){this.ds&&this.cm&&(Ext.grid.GroupingView.superclass.afterRender.call(this),this.grid.deferRowRender&&this.updateGroupWidths())},afterRenderUI:function(){Ext.grid.GroupingView.superclass.afterRenderUI.call(this),this.enableGroupingMenu&&this.hmenu&&(this.hmenu.add("-",{itemId:"groupBy",text:this.groupByText,handler:this.onGroupByClick,scope:this,iconCls:"x-group-by-icon"}),this.enableNoGroups&&this.hmenu.add({itemId:"showGroups",text:this.showGroupsText,checked:!0,checkHandler:this.onShowGroupsClick,scope:this}),this.hmenu.on("beforeshow",this.beforeMenuShow,this))},renderRows:function(){var e=this.getGroupField(),t=!!e;if(this.hideGroupedColumn){var i=this.cm.findColumnIndex(e),s=Ext.isDefined(this.lastGroupField);if(!t&&s)this.mainBody.update(""),this.cm.setHidden(this.cm.findColumnIndex(this.lastGroupField),!1),delete this.lastGroupField;else if(t&&!s)this.lastGroupField=e,this.cm.setHidden(i,!0);else if(t&&s&&e!==this.lastGroupField){this.mainBody.update("");var n=this.cm.findColumnIndex(this.lastGroupField);this.cm.setHidden(n,!1),this.lastGroupField=e,this.cm.setHidden(i,!0)}}return Ext.grid.GroupingView.superclass.renderRows.apply(this,arguments)},doRender:function(e,t,i,s,n,r){if(t.length<1)return"";if(!this.canGroup()||this.isUpdating)return Ext.grid.GroupingView.superclass.doRender.apply(this,arguments);var a,o,l,h,u,c=this.getGroupField(),d=this.cm.findColumnIndex(c),p="width:"+this.getTotalWidth()+";",f=this.cm.config[d],m=f.groupRenderer||f.renderer,y=this.showGroupName?(f.groupName||f.header)+": ":"",g=[];for(l=0,h=t.length;h>l;l++){var v=s+l,x=t[l],E=x.data[c];a=this.getGroup(E,x,m,v,d,i),o&&o.group==a?o.rs.push(x):(u=this.constructId(E,c,d),this.state[u]=!(Ext.isDefined(this.state[u])?!this.state[u]:this.startCollapsed),o={group:a,gvalue:E,text:y+a,groupId:u,startRow:v,rs:[x],cls:this.state[u]?"":"x-grid-group-collapsed",style:p},g.push(o)),x._groupId=u}var b=[];for(l=0,h=g.length;h>l;l++)a=g[l],this.doGroupStart(b,a,e,i,n),b[b.length]=Ext.grid.GroupingView.superclass.doRender.call(this,e,a.rs,i,a.startRow,n,r),this.doGroupEnd(b,a,e,i,n);return b.join("")},getGroupId:function(e){var t=this.getGroupField();return this.constructId(e,t,this.cm.findColumnIndex(t))},constructId:function(e,t,i){var s=this.cm.config[i],n=s.groupRenderer||s.renderer,r="value"==this.groupMode?e:this.getGroup(e,{data:{}},n,0,i,this.ds);return this.getPrefix(t)+Ext.util.Format.htmlEncode(r)},canGroup:function(){return this.enableGrouping&&!!this.getGroupField()},getPrefix:function(e){return this.grid.getGridEl().id+"-gp-"+e+"-"},doGroupStart:function(e,t){e[e.length]=this.startGroup.apply(t)},doGroupEnd:function(e){e[e.length]=this.endGroup},getRows:function(){if(!this.canGroup())return Ext.grid.GroupingView.superclass.getRows.call(this);for(var e,t,i,s=[],n=this.getGroups(),r=0,a=n.length;a>r;++r)if(e=n[r].childNodes[1])for(e=e.childNodes,t=0,i=e.length;i>t;++t)s[s.length]=e[t];return s},updateGroupWidths:function(){if(this.canGroup()&&this.hasRows())for(var e=Math.max(this.cm.getTotalWidth(),this.el.dom.offsetWidth-this.getScrollOffset())+"px",t=this.getGroups(),i=0,s=t.length;s>i;i++)t[i].firstChild.style.width=e},onColumnWidthUpdated:function(e,t,i){Ext.grid.GroupingView.superclass.onColumnWidthUpdated.call(this,e,t,i),this.updateGroupWidths()},onAllColumnWidthsUpdated:function(e,t){Ext.grid.GroupingView.superclass.onAllColumnWidthsUpdated.call(this,e,t),this.updateGroupWidths()},onColumnHiddenUpdated:function(e,t,i){Ext.grid.GroupingView.superclass.onColumnHiddenUpdated.call(this,e,t,i),this.updateGroupWidths()},onLayout:function(){this.updateGroupWidths()},onBeforeRowSelect:function(e,t){this.toggleRowIndex(t,!0)}}),Ext.grid.GroupingView.GROUP_ID=1e3;/*

  OpenLayers.js -- OpenLayers Map Viewer Library

  Copyright (c) 2006-2012 by OpenLayers Contributors
  Published under the 2-clause BSD license.
  See http://openlayers.org/dev/license.txt for the full text of the license, and http://openlayers.org/dev/authors.txt for full list of contributors.

  Includes compressed code under the following licenses:

  (For uncompressed versions of the code used, please see the
  OpenLayers Github repository: <https://github.com/openlayers/openlayers>)

*/
/**
 * Contains XMLHttpRequest.js <http://code.google.com/p/xmlhttprequest/>
 * Copyright 2007 Sergey Ilinsky (http://www.ilinsky.com)
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 */
/**
 * OpenLayers.Util.pagePosition is based on Yahoo's getXY method, which is
 * Copyright (c) 2006, Yahoo! Inc.
 * All rights reserved.
 * 
 * Redistribution and use of this software in source and binary forms, with or
 * without modification, are permitted provided that the following conditions
 * are met:
 * 
 * * Redistributions of source code must retain the above copyright notice,
 *   this list of conditions and the following disclaimer.
 * 
 * * Redistributions in binary form must reproduce the above copyright notice,
 *   this list of conditions and the following disclaimer in the documentation
 *   and/or other materials provided with the distribution.
 * 
 * * Neither the name of Yahoo! Inc. nor the names of its contributors may be
 *   used to endorse or promote products derived from this software without
 *   specific prior written permission of Yahoo! Inc.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE 
 * POSSIBILITY OF SUCH DAMAGE.
 */
/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
var OpenLayers={VERSION_NUMBER:"Release 2.12",singleFile:!0,_getScriptLocation:function(){for(var e,t,i=new RegExp("(^|(.*?\\/))(OpenLayers[^\\/]*?\\.js)(\\?|$)"),s=document.getElementsByTagName("script"),n="",r=0,a=s.length;a>r;r++)if(e=s[r].getAttribute("src"),e&&(t=e.match(i))){n=t[1];break}return function(){return n}}(),ImgPath:""};if(/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Class=function(){var e=arguments.length,t=arguments[0],i=arguments[e-1],s="function"==typeof i.initialize?i.initialize:function(){t.prototype.initialize.apply(this,arguments)};if(e>1){var n=[s,t].concat(Array.prototype.slice.call(arguments).slice(1,e-1),i);OpenLayers.inherit.apply(null,n)}else s.prototype=i;return s},OpenLayers.inherit=function(e,t){var i=function(){};i.prototype=t.prototype,e.prototype=new i;var s,n,r;for(s=2,n=arguments.length;n>s;s++)r=arguments[s],"function"==typeof r&&(r=r.prototype),OpenLayers.Util.extend(e.prototype,r)},OpenLayers.Util=OpenLayers.Util||{},OpenLayers.Util.extend=function(e,t){if(e=e||{},t){for(var i in t){var s=t[i];void 0!==s&&(e[i]=s)}var n="function"==typeof window.Event&&t instanceof window.Event;!n&&t.hasOwnProperty&&t.hasOwnProperty("toString")&&(e.toString=t.toString)}return e},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control=OpenLayers.Class({id:null,map:null,div:null,type:null,allowSelection:!1,displayClass:"",title:"",autoActivate:!1,active:null,handler:null,eventListeners:null,events:null,initialize:function(e){this.displayClass=this.CLASS_NAME.replace("OpenLayers.","ol").replace(/\./g,""),OpenLayers.Util.extend(this,e),this.events=new OpenLayers.Events(this),this.eventListeners instanceof Object&&this.events.on(this.eventListeners),null==this.id&&(this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_"))},destroy:function(){if(this.events&&(this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy(),this.events=null),this.eventListeners=null,this.handler&&(this.handler.destroy(),this.handler=null),this.handlers){for(var e in this.handlers)this.handlers.hasOwnProperty(e)&&"function"==typeof this.handlers[e].destroy&&this.handlers[e].destroy();this.handlers=null}this.map&&(this.map.removeControl(this),this.map=null),this.div=null},setMap:function(e){this.map=e,this.handler&&this.handler.setMap(e)},draw:function(e){return null==this.div&&(this.div=OpenLayers.Util.createDiv(this.id),this.div.className=this.displayClass,this.allowSelection||(this.div.className+=" olControlNoSelect",this.div.setAttribute("unselectable","on",0),this.div.onselectstart=OpenLayers.Function.False),""!=this.title&&(this.div.title=this.title)),null!=e&&(this.position=e.clone()),this.moveTo(this.position),this.div},moveTo:function(e){null!=e&&null!=this.div&&(this.div.style.left=e.x+"px",this.div.style.top=e.y+"px")},activate:function(){return this.active?!1:(this.handler&&this.handler.activate(),this.active=!0,this.map&&OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active"),this.events.triggerEvent("activate"),!0)},deactivate:function(){return this.active?(this.handler&&this.handler.deactivate(),this.active=!1,this.map&&OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active"),this.events.triggerEvent("deactivate"),!0):!1},CLASS_NAME:"OpenLayers.Control"}),OpenLayers.Control.TYPE_BUTTON=1,OpenLayers.Control.TYPE_TOGGLE=2,OpenLayers.Control.TYPE_TOOL=3,/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Geometry=OpenLayers.Class({id:null,parent:null,bounds:null,initialize:function(){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){this.id=null,this.bounds=null},clone:function(){return new OpenLayers.Geometry},setBounds:function(e){e&&(this.bounds=e.clone())},clearBounds:function(){this.bounds=null,this.parent&&this.parent.clearBounds()},extendBounds:function(e){var t=this.getBounds();t?this.bounds.extend(e):this.setBounds(e)},getBounds:function(){return null==this.bounds&&this.calculateBounds(),this.bounds},calculateBounds:function(){},distanceTo:function(){},getVertices:function(){},atPoint:function(e,t,i){var s=!1,n=this.getBounds();if(null!=n&&null!=e){var r=null!=t?t:0,a=null!=i?i:0,o=new OpenLayers.Bounds(this.bounds.left-r,this.bounds.bottom-a,this.bounds.right+r,this.bounds.top+a);s=o.containsLonLat(e)}return s},getLength:function(){return 0},getArea:function(){return 0},getCentroid:function(){return null},toString:function(){var e;return e=OpenLayers.Format&&OpenLayers.Format.WKT?OpenLayers.Format.WKT.prototype.write(new OpenLayers.Feature.Vector(this)):Object.prototype.toString.call(this)},CLASS_NAME:"OpenLayers.Geometry"}),OpenLayers.Geometry.fromWKT=function(e){var t;if(OpenLayers.Format&&OpenLayers.Format.WKT){var i=OpenLayers.Geometry.fromWKT.format;i||(i=new OpenLayers.Format.WKT,OpenLayers.Geometry.fromWKT.format=i);var s=i.read(e);if(s instanceof OpenLayers.Feature.Vector)t=s.geometry;else if(OpenLayers.Util.isArray(s)){for(var n=s.length,r=new Array(n),a=0;n>a;++a)r[a]=s[a].geometry;t=new OpenLayers.Geometry.Collection(r)}}return t},OpenLayers.Geometry.segmentsIntersect=function(e,t,i){var s=i&&i.point,n=i&&i.tolerance,r=!1,a=e.x1-t.x1,o=e.y1-t.y1,l=e.x2-e.x1,h=e.y2-e.y1,u=t.y2-t.y1,c=t.x2-t.x1,d=u*l-c*h,p=c*o-u*a,f=l*o-h*a;if(0==d)0==p&&0==f&&(r=!0);else{var m=p/d,y=f/d;if(m>=0&&1>=m&&y>=0&&1>=y)if(s){var g=e.x1+m*l,v=e.y1+m*h;r=new OpenLayers.Geometry.Point(g,v)}else r=!0}if(n){var x;if(r){if(s){var E,g,v,b=[e,t];e:for(var L=0;2>L;++L){E=b[L];for(var S=1;3>S;++S)if(g=E["x"+S],v=E["y"+S],x=Math.sqrt(Math.pow(g-r.x,2)+Math.pow(v-r.y,2)),n>x){r.x=g,r.y=v;break e}}}}else{var C,w,g,v,O,T,b=[e,t];e:for(var L=0;2>L;++L){C=b[L],w=b[(L+1)%2];for(var S=1;3>S;++S)if(O={x:C["x"+S],y:C["y"+S]},T=OpenLayers.Geometry.distanceToSegment(O,w),T.distance<n){r=s?new OpenLayers.Geometry.Point(O.x,O.y):!0;break e}}}}return r},OpenLayers.Geometry.distanceToSegment=function(e,t){var i,s,n=e.x,r=e.y,a=t.x1,o=t.y1,l=t.x2,h=t.y2,u=l-a,c=h-o,d=(u*(n-a)+c*(r-o))/(Math.pow(u,2)+Math.pow(c,2));return 0>=d?(i=a,s=o):d>=1?(i=l,s=h):(i=a+d*u,s=o+d*c),{distance:Math.sqrt(Math.pow(i-n,2)+Math.pow(s-r,2)),x:i,y:s}},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Geometry.Point=OpenLayers.Class(OpenLayers.Geometry,{x:null,y:null,initialize:function(e,t){OpenLayers.Geometry.prototype.initialize.apply(this,arguments),this.x=parseFloat(e),this.y=parseFloat(t)},clone:function(e){return null==e&&(e=new OpenLayers.Geometry.Point(this.x,this.y)),OpenLayers.Util.applyDefaults(e,this),e},calculateBounds:function(){this.bounds=new OpenLayers.Bounds(this.x,this.y,this.x,this.y)},distanceTo:function(e,t){var i,s,n,r,a,o,l=!(t&&t.edge===!1),h=l&&t&&t.details;return e instanceof OpenLayers.Geometry.Point?(s=this.x,n=this.y,r=e.x,a=e.y,i=Math.sqrt(Math.pow(s-r,2)+Math.pow(n-a,2)),o=h?{x0:s,y0:n,x1:r,y1:a,distance:i}:i):(o=e.distanceTo(this,t),h&&(o={x0:o.x1,y0:o.y1,x1:o.x0,y1:o.y0,distance:o.distance})),o},equals:function(e){var t=!1;return null!=e&&(t=this.x==e.x&&this.y==e.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(e.x)&&isNaN(e.y)),t},toShortString:function(){return this.x+", "+this.y},move:function(e,t){this.x=this.x+e,this.y=this.y+t,this.clearBounds()},rotate:function(e,t){e*=Math.PI/180;var i=this.distanceTo(t),s=e+Math.atan2(this.y-t.y,this.x-t.x);this.x=t.x+i*Math.cos(s),this.y=t.y+i*Math.sin(s),this.clearBounds()},getCentroid:function(){return new OpenLayers.Geometry.Point(this.x,this.y)},resize:function(e,t,i){return i=void 0==i?1:i,this.x=t.x+e*i*(this.x-t.x),this.y=t.y+e*(this.y-t.y),this.clearBounds(),this},intersects:function(e){var t=!1;return t="OpenLayers.Geometry.Point"==e.CLASS_NAME?this.equals(e):e.intersects(this)},transform:function(e,t){return e&&t&&(OpenLayers.Projection.transform(this,e,t),this.bounds=null),this},getVertices:function(){return[this]},CLASS_NAME:"OpenLayers.Geometry.Point"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.String={startsWith:function(e,t){return 0==e.indexOf(t)},contains:function(e,t){return-1!=e.indexOf(t)},trim:function(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},camelize:function(e){for(var t=e.split("-"),i=t[0],s=1,n=t.length;n>s;s++){var r=t[s];i+=r.charAt(0).toUpperCase()+r.substring(1)}return i},format:function(e,t,i){t||(t=window);var s=function(e,s){for(var n,r=s.split(/\.+/),a=0;a<r.length;a++)0==a&&(n=t),n=n[r[a]];return"function"==typeof n&&(n=i?n.apply(null,i):n()),"undefined"==typeof n?"undefined":n};return e.replace(OpenLayers.String.tokenRegEx,s)},tokenRegEx:/\$\{([\w.]+?)\}/g,numberRegEx:/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,isNumeric:function(e){return OpenLayers.String.numberRegEx.test(e)},numericIf:function(e){return OpenLayers.String.isNumeric(e)?parseFloat(e):e}},OpenLayers.Number={decimalSeparator:".",thousandsSeparator:",",limitSigDigs:function(e,t){var i=0;return t>0&&(i=parseFloat(e.toPrecision(t))),i},format:function(e,t,i,s){t="undefined"!=typeof t?t:0,i="undefined"!=typeof i?i:OpenLayers.Number.thousandsSeparator,s="undefined"!=typeof s?s:OpenLayers.Number.decimalSeparator,null!=t&&(e=parseFloat(e.toFixed(t)));var n=e.toString().split(".");1==n.length&&null==t&&(t=0);var r=n[0];if(i)for(var a=/(-?[0-9]+)([0-9]{3})/;a.test(r);)r=r.replace(a,"$1"+i+"$2");var o;if(0==t)o=r;else{var l=n.length>1?n[1]:"0";null!=t&&(l+=new Array(t-l.length+1).join("0")),o=r+s+l}return o}},OpenLayers.Function={bind:function(e,t){var i=Array.prototype.slice.apply(arguments,[2]);return function(){var s=i.concat(Array.prototype.slice.apply(arguments,[0]));return e.apply(t,s)}},bindAsEventListener:function(e,t){return function(i){return e.call(t,i||window.event)}},False:function(){return!1},True:function(){return!0},Void:function(){}},OpenLayers.Array={filter:function(e,t,i){var s=[];if(Array.prototype.filter)s=e.filter(t,i);else{var n=e.length;if("function"!=typeof t)throw new TypeError;for(var r=0;n>r;r++)if(r in e){var a=e[r];t.call(i,a,r,e)&&s.push(a)}}return s}},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Bounds=OpenLayers.Class({left:null,bottom:null,right:null,top:null,centerLonLat:null,initialize:function(e,t,i,s){OpenLayers.Util.isArray(e)&&(s=e[3],i=e[2],t=e[1],e=e[0]),null!=e&&(this.left=OpenLayers.Util.toFloat(e)),null!=t&&(this.bottom=OpenLayers.Util.toFloat(t)),null!=i&&(this.right=OpenLayers.Util.toFloat(i)),null!=s&&(this.top=OpenLayers.Util.toFloat(s))},clone:function(){return new OpenLayers.Bounds(this.left,this.bottom,this.right,this.top)},equals:function(e){var t=!1;return null!=e&&(t=this.left==e.left&&this.right==e.right&&this.top==e.top&&this.bottom==e.bottom),t},toString:function(){return[this.left,this.bottom,this.right,this.top].join(",")},toArray:function(e){return e===!0?[this.bottom,this.left,this.top,this.right]:[this.left,this.bottom,this.right,this.top]},toBBOX:function(e,t){null==e&&(e=6);var i=Math.pow(10,e),s=Math.round(this.left*i)/i,n=Math.round(this.bottom*i)/i,r=Math.round(this.right*i)/i,a=Math.round(this.top*i)/i;return t===!0?n+","+s+","+a+","+r:s+","+n+","+r+","+a},toGeometry:function(){return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(this.left,this.bottom),new OpenLayers.Geometry.Point(this.right,this.bottom),new OpenLayers.Geometry.Point(this.right,this.top),new OpenLayers.Geometry.Point(this.left,this.top)])])},getWidth:function(){return this.right-this.left},getHeight:function(){return this.top-this.bottom},getSize:function(){return new OpenLayers.Size(this.getWidth(),this.getHeight())},getCenterPixel:function(){return new OpenLayers.Pixel((this.left+this.right)/2,(this.bottom+this.top)/2)},getCenterLonLat:function(){return this.centerLonLat||(this.centerLonLat=new OpenLayers.LonLat((this.left+this.right)/2,(this.bottom+this.top)/2)),this.centerLonLat},scale:function(e,t){null==t&&(t=this.getCenterLonLat());var i,s;"OpenLayers.LonLat"==t.CLASS_NAME?(i=t.lon,s=t.lat):(i=t.x,s=t.y);var n=(this.left-i)*e+i,r=(this.bottom-s)*e+s,a=(this.right-i)*e+i,o=(this.top-s)*e+s;return new OpenLayers.Bounds(n,r,a,o)},add:function(e,t){if(null==e||null==t)throw new TypeError("Bounds.add cannot receive null values");return new OpenLayers.Bounds(this.left+e,this.bottom+t,this.right+e,this.top+t)},extend:function(e){var t=null;if(e){switch(e.CLASS_NAME){case"OpenLayers.LonLat":t=new OpenLayers.Bounds(e.lon,e.lat,e.lon,e.lat);break;case"OpenLayers.Geometry.Point":t=new OpenLayers.Bounds(e.x,e.y,e.x,e.y);break;case"OpenLayers.Bounds":t=e}t&&(this.centerLonLat=null,(null==this.left||t.left<this.left)&&(this.left=t.left),(null==this.bottom||t.bottom<this.bottom)&&(this.bottom=t.bottom),(null==this.right||t.right>this.right)&&(this.right=t.right),(null==this.top||t.top>this.top)&&(this.top=t.top))}},containsLonLat:function(e,t){"boolean"==typeof t&&(t={inclusive:t}),t=t||{};var i=this.contains(e.lon,e.lat,t.inclusive),s=t.worldBounds;if(s&&!i){var n=s.getWidth(),r=(s.left+s.right)/2,a=Math.round((e.lon-r)/n);i=this.containsLonLat({lon:e.lon-a*n,lat:e.lat},{inclusive:t.inclusive})}return i},containsPixel:function(e,t){return this.contains(e.x,e.y,t)},contains:function(e,t,i){if(null==i&&(i=!0),null==e||null==t)return!1;e=OpenLayers.Util.toFloat(e),t=OpenLayers.Util.toFloat(t);var s=!1;return s=i?e>=this.left&&e<=this.right&&t>=this.bottom&&t<=this.top:e>this.left&&e<this.right&&t>this.bottom&&t<this.top},intersectsBounds:function(e,t){if("boolean"==typeof t&&(t={inclusive:t}),t=t||{},t.worldBounds){var i=this.wrapDateLine(t.worldBounds);e=e.wrapDateLine(t.worldBounds)}else i=this;null==t.inclusive&&(t.inclusive=!0);var s=!1,n=i.left==e.right||i.right==e.left||i.top==e.bottom||i.bottom==e.top;if(t.inclusive||!n){var r=e.bottom>=i.bottom&&e.bottom<=i.top||i.bottom>=e.bottom&&i.bottom<=e.top,a=e.top>=i.bottom&&e.top<=i.top||i.top>e.bottom&&i.top<e.top,o=e.left>=i.left&&e.left<=i.right||i.left>=e.left&&i.left<=e.right,l=e.right>=i.left&&e.right<=i.right||i.right>=e.left&&i.right<=e.right;s=(r||a)&&(o||l)}if(t.worldBounds&&!s){var h=t.worldBounds,u=h.getWidth(),c=!h.containsBounds(i),d=!h.containsBounds(e);c&&!d?(e=e.add(-u,0),s=i.intersectsBounds(e,{inclusive:t.inclusive})):d&&!c&&(i=i.add(-u,0),s=e.intersectsBounds(i,{inclusive:t.inclusive}))}return s},containsBounds:function(e,t,i){null==t&&(t=!1),null==i&&(i=!0);var s=this.contains(e.left,e.bottom,i),n=this.contains(e.right,e.bottom,i),r=this.contains(e.left,e.top,i),a=this.contains(e.right,e.top,i);return t?s||n||r||a:s&&n&&r&&a},determineQuadrant:function(e){var t="",i=this.getCenterLonLat();return t+=e.lat<i.lat?"b":"t",t+=e.lon<i.lon?"l":"r"},transform:function(e,t){this.centerLonLat=null;var i=OpenLayers.Projection.transform({x:this.left,y:this.bottom},e,t),s=OpenLayers.Projection.transform({x:this.right,y:this.bottom},e,t),n=OpenLayers.Projection.transform({x:this.left,y:this.top},e,t),r=OpenLayers.Projection.transform({x:this.right,y:this.top},e,t);return this.left=Math.min(i.x,n.x),this.bottom=Math.min(i.y,s.y),this.right=Math.max(s.x,r.x),this.top=Math.max(n.y,r.y),this},wrapDateLine:function(e,t){t=t||{};var i=t.leftTolerance||0,s=t.rightTolerance||0,n=this.clone();if(e){for(var r=e.getWidth();n.left<e.left&&n.right-s<=e.left;)n=n.add(r,0);for(;n.left+i>=e.right&&n.right>e.right;)n=n.add(-r,0);var a=n.left+i;a<e.right&&a>e.left&&n.right-s>e.right&&(n=n.add(-r,0))}return n},CLASS_NAME:"OpenLayers.Bounds"}),OpenLayers.Bounds.fromString=function(e,t){var i=e.split(",");return OpenLayers.Bounds.fromArray(i,t)},OpenLayers.Bounds.fromArray=function(e,t){return t===!0?new OpenLayers.Bounds(e[1],e[0],e[3],e[2]):new OpenLayers.Bounds(e[0],e[1],e[2],e[3])},OpenLayers.Bounds.fromSize=function(e){return new OpenLayers.Bounds(0,e.h,e.w,0)},OpenLayers.Bounds.oppositeQuadrant=function(e){var t="";return t+="t"==e.charAt(0)?"b":"t",t+="l"==e.charAt(1)?"r":"l"},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Element={visible:function(e){return"none"!=OpenLayers.Util.getElement(e).style.display},toggle:function(){for(var e=0,t=arguments.length;t>e;e++){var i=OpenLayers.Util.getElement(arguments[e]),s=OpenLayers.Element.visible(i)?"none":"";i.style.display=s}},remove:function(e){e=OpenLayers.Util.getElement(e),e.parentNode.removeChild(e)},getHeight:function(e){return e=OpenLayers.Util.getElement(e),e.offsetHeight},hasClass:function(e,t){var i=e.className;return!!i&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(i)},addClass:function(e,t){return OpenLayers.Element.hasClass(e,t)||(e.className+=(e.className?" ":"")+t),e},removeClass:function(e,t){var i=e.className;return i&&(e.className=OpenLayers.String.trim(i.replace(new RegExp("(^|\\s+)"+t+"(\\s+|$)")," "))),e},toggleClass:function(e,t){return OpenLayers.Element.hasClass(e,t)?OpenLayers.Element.removeClass(e,t):OpenLayers.Element.addClass(e,t),e},getStyle:function(e,t){e=OpenLayers.Util.getElement(e);var i=null;if(e&&e.style){if(i=e.style[OpenLayers.String.camelize(t)],!i)if(document.defaultView&&document.defaultView.getComputedStyle){var s=document.defaultView.getComputedStyle(e,null);i=s?s.getPropertyValue(t):null}else e.currentStyle&&(i=e.currentStyle[OpenLayers.String.camelize(t)]);var n=["left","top","right","bottom"];window.opera&&-1!=OpenLayers.Util.indexOf(n,t)&&"static"==OpenLayers.Element.getStyle(e,"position")&&(i="auto")}return"auto"==i?null:i}},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.LonLat=OpenLayers.Class({lon:0,lat:0,initialize:function(e,t){OpenLayers.Util.isArray(e)&&(t=e[1],e=e[0]),this.lon=OpenLayers.Util.toFloat(e),this.lat=OpenLayers.Util.toFloat(t)},toString:function(){return"lon="+this.lon+",lat="+this.lat},toShortString:function(){return this.lon+", "+this.lat},clone:function(){return new OpenLayers.LonLat(this.lon,this.lat)},add:function(e,t){if(null==e||null==t)throw new TypeError("LonLat.add cannot receive null values");return new OpenLayers.LonLat(this.lon+OpenLayers.Util.toFloat(e),this.lat+OpenLayers.Util.toFloat(t))},equals:function(e){var t=!1;return null!=e&&(t=this.lon==e.lon&&this.lat==e.lat||isNaN(this.lon)&&isNaN(this.lat)&&isNaN(e.lon)&&isNaN(e.lat)),t},transform:function(e,t){var i=OpenLayers.Projection.transform({x:this.lon,y:this.lat},e,t);return this.lon=i.x,this.lat=i.y,this},wrapDateLine:function(e){var t=this.clone();if(e){for(;t.lon<e.left;)t.lon+=e.getWidth();for(;t.lon>e.right;)t.lon-=e.getWidth()}return t},CLASS_NAME:"OpenLayers.LonLat"}),OpenLayers.LonLat.fromString=function(e){var t=e.split(",");return new OpenLayers.LonLat(t[0],t[1])},OpenLayers.LonLat.fromArray=function(e){var t=OpenLayers.Util.isArray(e),i=t&&e[0],s=t&&e[1];return new OpenLayers.LonLat(i,s)},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Pixel=OpenLayers.Class({x:0,y:0,initialize:function(e,t){this.x=parseFloat(e),this.y=parseFloat(t)},toString:function(){return"x="+this.x+",y="+this.y},clone:function(){return new OpenLayers.Pixel(this.x,this.y)},equals:function(e){var t=!1;return null!=e&&(t=this.x==e.x&&this.y==e.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(e.x)&&isNaN(e.y)),t},distanceTo:function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))},add:function(e,t){if(null==e||null==t)throw new TypeError("Pixel.add cannot receive null values");return new OpenLayers.Pixel(this.x+e,this.y+t)},offset:function(e){var t=this.clone();return e&&(t=this.add(e.x,e.y)),t},CLASS_NAME:"OpenLayers.Pixel"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Size=OpenLayers.Class({w:0,h:0,initialize:function(e,t){this.w=parseFloat(e),this.h=parseFloat(t)},toString:function(){return"w="+this.w+",h="+this.h},clone:function(){return new OpenLayers.Size(this.w,this.h)},equals:function(e){var t=!1;return null!=e&&(t=this.w==e.w&&this.h==e.h||isNaN(this.w)&&isNaN(this.h)&&isNaN(e.w)&&isNaN(e.h)),t},CLASS_NAME:"OpenLayers.Size"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){},userError:function(e){alert(e)},assert:function(){},dir:function(){},dirxml:function(){},trace:function(){},group:function(){},groupEnd:function(){},time:function(){},timeEnd:function(){},profile:function(){},profileEnd:function(){},count:function(){},CLASS_NAME:"OpenLayers.Console"},function(){for(var e=document.getElementsByTagName("script"),t=0,i=e.length;i>t;++t)if(-1!=e[t].src.indexOf("firebug.js")&&console){OpenLayers.Util.extend(OpenLayers.Console,console);break}}(),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Lang={code:null,defaultCode:"en",getCode:function(){return OpenLayers.Lang.code||OpenLayers.Lang.setCode(),OpenLayers.Lang.code},setCode:function(e){var t;e||(e="msie"==OpenLayers.BROWSER_NAME?navigator.userLanguage:navigator.language);var i=e.split("-");if(i[0]=i[0].toLowerCase(),"object"==typeof OpenLayers.Lang[i[0]]&&(t=i[0]),i[1]){var s=i[0]+"-"+i[1].toUpperCase();"object"==typeof OpenLayers.Lang[s]&&(t=s)}t||(OpenLayers.Console.warn("Failed to find OpenLayers.Lang."+i.join("-")+" dictionary, falling back to default language"),t=OpenLayers.Lang.defaultCode),OpenLayers.Lang.code=t},translate:function(e,t){var i=OpenLayers.Lang[OpenLayers.Lang.getCode()],s=i&&i[e];return s||(s=e),t&&(s=OpenLayers.String.format(s,t)),s}},OpenLayers.i18n=OpenLayers.Lang.translate,/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Util=OpenLayers.Util||{},OpenLayers.Util.getElement=function(){for(var e=[],t=0,i=arguments.length;i>t;t++){var s=arguments[t];if("string"==typeof s&&(s=document.getElementById(s)),1==arguments.length)return s;e.push(s)}return e},OpenLayers.Util.isElement=function(e){return!(!e||1!==e.nodeType)},OpenLayers.Util.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},"undefined"==typeof window.$&&(window.$=OpenLayers.Util.getElement),OpenLayers.Util.removeItem=function(e,t){for(var i=e.length-1;i>=0;i--)e[i]==t&&e.splice(i,1);return e},OpenLayers.Util.indexOf=function(e,t){if("function"==typeof e.indexOf)return e.indexOf(t);for(var i=0,s=e.length;s>i;i++)if(e[i]==t)return i;return-1},OpenLayers.Util.modifyDOMElement=function(e,t,i,s,n,r,a,o){t&&(e.id=t),i&&(e.style.left=i.x+"px",e.style.top=i.y+"px"),s&&(e.style.width=s.w+"px",e.style.height=s.h+"px"),n&&(e.style.position=n),r&&(e.style.border=r),a&&(e.style.overflow=a),parseFloat(o)>=0&&parseFloat(o)<1?(e.style.filter="alpha(opacity="+100*o+")",e.style.opacity=o):1==parseFloat(o)&&(e.style.filter="",e.style.opacity="")},OpenLayers.Util.createDiv=function(e,t,i,s,n,r,a,o){var l=document.createElement("div");return s&&(l.style.backgroundImage="url("+s+")"),e||(e=OpenLayers.Util.createUniqueID("OpenLayersDiv")),n||(n="absolute"),OpenLayers.Util.modifyDOMElement(l,e,t,i,n,r,a,o),l},OpenLayers.Util.createImage=function(e,t,i,s,n,r,a,o){function l(){h.style.display="",OpenLayers.Event.stopObservingElement(h)}var h=document.createElement("img");return e||(e=OpenLayers.Util.createUniqueID("OpenLayersDiv")),n||(n="relative"),OpenLayers.Util.modifyDOMElement(h,e,t,i,n,r,null,a),o&&(h.style.display="none",OpenLayers.Event.observe(h,"load",l),OpenLayers.Event.observe(h,"error",l)),h.style.alt=e,h.galleryImg="no",s&&(h.src=s),h},OpenLayers.IMAGE_RELOAD_ATTEMPTS=0,OpenLayers.Util.alphaHackNeeded=null,OpenLayers.Util.alphaHack=function(){if(null==OpenLayers.Util.alphaHackNeeded){var e=navigator.appVersion.split("MSIE"),t=parseFloat(e[1]),i=!1;try{i=!!document.body.filters}catch(s){}OpenLayers.Util.alphaHackNeeded=i&&t>=5.5&&7>t}return OpenLayers.Util.alphaHackNeeded},OpenLayers.Util.modifyAlphaImageDiv=function(e,t,i,s,n,r,a,o,l){OpenLayers.Util.modifyDOMElement(e,t,i,s,r,null,null,l);var h=e.childNodes[0];n&&(h.src=n),OpenLayers.Util.modifyDOMElement(h,e.id+"_innerImage",null,s,"relative",a),OpenLayers.Util.alphaHack()&&("none"!=e.style.display&&(e.style.display="inline-block"),null==o&&(o="scale"),e.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+h.src+"', "+"sizingMethod='"+o+"')",parseFloat(e.style.opacity)>=0&&parseFloat(e.style.opacity)<1&&(e.style.filter+=" alpha(opacity="+100*e.style.opacity+")"),h.style.filter="alpha(opacity=0)")},OpenLayers.Util.createAlphaImageDiv=function(e,t,i,s,n,r,a,o,l){var h=OpenLayers.Util.createDiv(),u=OpenLayers.Util.createImage(null,null,null,null,null,null,null,l);return u.className="olAlphaImg",h.appendChild(u),OpenLayers.Util.modifyAlphaImageDiv(h,e,t,i,s,n,r,a,o),h},OpenLayers.Util.upperCaseObject=function(e){var t={};for(var i in e)t[i.toUpperCase()]=e[i];return t},OpenLayers.Util.applyDefaults=function(e,t){e=e||{};var i="function"==typeof window.Event&&t instanceof window.Event;for(var s in t)(void 0===e[s]||!i&&t.hasOwnProperty&&t.hasOwnProperty(s)&&!e.hasOwnProperty(s))&&(e[s]=t[s]);return!i&&t&&t.hasOwnProperty&&t.hasOwnProperty("toString")&&!e.hasOwnProperty("toString")&&(e.toString=t.toString),e},OpenLayers.Util.getParameterString=function(e){var t=[];for(var i in e){var s=e[i];if(null!=s&&"function"!=typeof s){var n;if("object"==typeof s&&s.constructor==Array){for(var r,a=[],o=0,l=s.length;l>o;o++)r=s[o],a.push(encodeURIComponent(null===r||void 0===r?"":r));n=a.join(",")}else n=encodeURIComponent(s);t.push(encodeURIComponent(i)+"="+n)}}return t.join("&")},OpenLayers.Util.urlAppend=function(e,t){var i=e;if(t){var s=(e+" ").split(/[?&]/);i+=" "===s.pop()?t:s.length?"&"+t:"?"+t}return i},OpenLayers.Util.getImagesLocation=function(){return OpenLayers.ImgPath||OpenLayers._getScriptLocation()+"img/"},OpenLayers.Util.getImageLocation=function(e){return OpenLayers.Util.getImagesLocation()+e},OpenLayers.Util.Try=function(){for(var e=null,t=0,i=arguments.length;i>t;t++){var s=arguments[t];try{e=s();break}catch(n){}}return e},OpenLayers.Util.getXmlNodeValue=function(e){var t=null;return OpenLayers.Util.Try(function(){t=e.text,t||(t=e.textContent),t||(t=e.firstChild.nodeValue)},function(){t=e.textContent}),t},OpenLayers.Util.mouseLeft=function(e,t){for(var i=e.relatedTarget?e.relatedTarget:e.toElement;i!=t&&null!=i;)i=i.parentNode;return i!=t},OpenLayers.Util.DEFAULT_PRECISION=14,OpenLayers.Util.toFloat=function(e,t){return null==t&&(t=OpenLayers.Util.DEFAULT_PRECISION),"number"!=typeof e&&(e=parseFloat(e)),0===t?e:parseFloat(e.toPrecision(t))},OpenLayers.Util.rad=function(e){return e*Math.PI/180},OpenLayers.Util.deg=function(e){return 180*e/Math.PI},OpenLayers.Util.VincentyConstants={a:6378137,b:6356752.3142,f:1/298.257223563},OpenLayers.Util.distVincenty=function(e,t){for(var i=OpenLayers.Util.VincentyConstants,s=i.a,n=i.b,r=i.f,a=OpenLayers.Util.rad(t.lon-e.lon),o=Math.atan((1-r)*Math.tan(OpenLayers.Util.rad(e.lat))),l=Math.atan((1-r)*Math.tan(OpenLayers.Util.rad(t.lat))),h=Math.sin(o),u=Math.cos(o),c=Math.sin(l),d=Math.cos(l),p=a,f=2*Math.PI,m=20;Math.abs(p-f)>1e-12&&--m>0;){var y=Math.sin(p),g=Math.cos(p),v=Math.sqrt(d*y*d*y+(u*c-h*d*g)*(u*c-h*d*g));if(0==v)return 0;var x=h*c+u*d*g,E=Math.atan2(v,x),b=Math.asin(u*d*y/v),L=Math.cos(b)*Math.cos(b),S=x-2*h*c/L,C=r/16*L*(4+r*(4-3*L));f=p,p=a+(1-C)*r*Math.sin(b)*(E+C*v*(S+C*x*(-1+2*S*S)))}if(0==m)return 0/0;var w=L*(s*s-n*n)/(n*n),O=1+w/16384*(4096+w*(-768+w*(320-175*w))),T=w/1024*(256+w*(-128+w*(74-47*w))),M=T*v*(S+T/4*(x*(-1+2*S*S)-T/6*S*(-3+4*v*v)*(-3+4*S*S))),P=n*O*(E-M),N=P.toFixed(3)/1e3;return N},OpenLayers.Util.destinationVincenty=function(e,t,i){for(var s=OpenLayers.Util,n=s.VincentyConstants,r=n.a,a=n.b,o=n.f,l=e.lon,h=e.lat,u=i,c=s.rad(t),d=Math.sin(c),p=Math.cos(c),f=(1-o)*Math.tan(s.rad(h)),m=1/Math.sqrt(1+f*f),y=f*m,g=Math.atan2(f,p),v=m*d,x=1-v*v,E=x*(r*r-a*a)/(a*a),b=1+E/16384*(4096+E*(-768+E*(320-175*E))),L=E/1024*(256+E*(-128+E*(74-47*E))),S=u/(a*b),C=2*Math.PI;Math.abs(S-C)>1e-12;){var w=Math.cos(2*g+S),O=Math.sin(S),T=Math.cos(S),M=L*O*(w+L/4*(T*(-1+2*w*w)-L/6*w*(-3+4*O*O)*(-3+4*w*w)));C=S,S=u/(a*b)+M}var P=y*O-m*T*p,N=Math.atan2(y*T+m*O*p,(1-o)*Math.sqrt(v*v+P*P)),D=Math.atan2(O*d,m*T-y*O*p),A=o/16*x*(4+o*(4-3*x)),I=D-(1-A)*o*v*(S+A*O*(w+A*T*(-1+2*w*w)));return Math.atan2(v,-P),new OpenLayers.LonLat(l+s.deg(I),s.deg(N))},OpenLayers.Util.getParameters=function(e){e=null===e||void 0===e?window.location.href:e;var t="";if(OpenLayers.String.contains(e,"?")){var i=e.indexOf("?")+1,s=OpenLayers.String.contains(e,"#")?e.indexOf("#"):e.length;t=e.substring(i,s)}for(var n={},r=t.split(/[&;]/),a=0,o=r.length;o>a;++a){var l=r[a].split("=");if(l[0]){var h=l[0];try{h=decodeURIComponent(h)}catch(u){h=unescape(h)}var c=(l[1]||"").replace(/\+/g," ");try{c=decodeURIComponent(c)}catch(u){c=unescape(c)}c=c.split(","),1==c.length&&(c=c[0]),n[h]=c}}return n},OpenLayers.Util.lastSeqID=0,OpenLayers.Util.createUniqueID=function(e){return null==e&&(e="id_"),OpenLayers.Util.lastSeqID+=1,e+OpenLayers.Util.lastSeqID},OpenLayers.INCHES_PER_UNIT={inches:1,ft:12,mi:63360,m:39.3701,km:39370.1,dd:4374754,yd:36},OpenLayers.INCHES_PER_UNIT["in"]=OpenLayers.INCHES_PER_UNIT.inches,OpenLayers.INCHES_PER_UNIT.degrees=OpenLayers.INCHES_PER_UNIT.dd,OpenLayers.INCHES_PER_UNIT.nmi=1852*OpenLayers.INCHES_PER_UNIT.m,OpenLayers.METERS_PER_INCH=.0254000508001016,OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{Inch:OpenLayers.INCHES_PER_UNIT.inches,Meter:1/OpenLayers.METERS_PER_INCH,Foot:.3048006096012192/OpenLayers.METERS_PER_INCH,IFoot:.3048/OpenLayers.METERS_PER_INCH,ClarkeFoot:.3047972651151/OpenLayers.METERS_PER_INCH,SearsFoot:.30479947153867626/OpenLayers.METERS_PER_INCH,GoldCoastFoot:.3047997101815088/OpenLayers.METERS_PER_INCH,IInch:.0254/OpenLayers.METERS_PER_INCH,MicroInch:254e-7/OpenLayers.METERS_PER_INCH,Mil:2.54e-8/OpenLayers.METERS_PER_INCH,Centimeter:.01/OpenLayers.METERS_PER_INCH,Kilometer:1e3/OpenLayers.METERS_PER_INCH,Yard:.9144018288036576/OpenLayers.METERS_PER_INCH,SearsYard:.914398414616029/OpenLayers.METERS_PER_INCH,IndianYard:.9143985307444408/OpenLayers.METERS_PER_INCH,IndianYd37:.91439523/OpenLayers.METERS_PER_INCH,IndianYd62:.9143988/OpenLayers.METERS_PER_INCH,IndianYd75:.9143985/OpenLayers.METERS_PER_INCH,IndianFoot:.30479951/OpenLayers.METERS_PER_INCH,IndianFt37:.30479841/OpenLayers.METERS_PER_INCH,IndianFt62:.3047996/OpenLayers.METERS_PER_INCH,IndianFt75:.3047995/OpenLayers.METERS_PER_INCH,Mile:1609.3472186944373/OpenLayers.METERS_PER_INCH,IYard:.9144/OpenLayers.METERS_PER_INCH,IMile:1609.344/OpenLayers.METERS_PER_INCH,NautM:1852/OpenLayers.METERS_PER_INCH,"Lat-66":110943.31648893273/OpenLayers.METERS_PER_INCH,"Lat-83":110946.25736872235/OpenLayers.METERS_PER_INCH,Decimeter:.1/OpenLayers.METERS_PER_INCH,Millimeter:.001/OpenLayers.METERS_PER_INCH,Dekameter:10/OpenLayers.METERS_PER_INCH,Decameter:10/OpenLayers.METERS_PER_INCH,Hectometer:100/OpenLayers.METERS_PER_INCH,GermanMeter:1.0000135965/OpenLayers.METERS_PER_INCH,CaGrid:.999738/OpenLayers.METERS_PER_INCH,ClarkeChain:20.1166194976/OpenLayers.METERS_PER_INCH,GunterChain:20.11684023368047/OpenLayers.METERS_PER_INCH,BenoitChain:20.116782494375872/OpenLayers.METERS_PER_INCH,SearsChain:20.11676512155/OpenLayers.METERS_PER_INCH,ClarkeLink:.201166194976/OpenLayers.METERS_PER_INCH,GunterLink:.2011684023368047/OpenLayers.METERS_PER_INCH,BenoitLink:.20116782494375873/OpenLayers.METERS_PER_INCH,SearsLink:.2011676512155/OpenLayers.METERS_PER_INCH,Rod:5.02921005842012/OpenLayers.METERS_PER_INCH,IntnlChain:20.1168/OpenLayers.METERS_PER_INCH,IntnlLink:.201168/OpenLayers.METERS_PER_INCH,Perch:5.02921005842012/OpenLayers.METERS_PER_INCH,Pole:5.02921005842012/OpenLayers.METERS_PER_INCH,Furlong:201.1684023368046/OpenLayers.METERS_PER_INCH,Rood:3.778266898/OpenLayers.METERS_PER_INCH,CapeFoot:.3047972615/OpenLayers.METERS_PER_INCH,Brealey:375/OpenLayers.METERS_PER_INCH,ModAmFt:.304812252984506/OpenLayers.METERS_PER_INCH,Fathom:1.8288/OpenLayers.METERS_PER_INCH,"NautM-UK":1853.184/OpenLayers.METERS_PER_INCH,"50kilometers":5e4/OpenLayers.METERS_PER_INCH,"150kilometers":15e4/OpenLayers.METERS_PER_INCH}),OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{mm:OpenLayers.INCHES_PER_UNIT.Meter/1e3,cm:OpenLayers.INCHES_PER_UNIT.Meter/100,dm:100*OpenLayers.INCHES_PER_UNIT.Meter,km:1e3*OpenLayers.INCHES_PER_UNIT.Meter,kmi:OpenLayers.INCHES_PER_UNIT.nmi,fath:OpenLayers.INCHES_PER_UNIT.Fathom,ch:OpenLayers.INCHES_PER_UNIT.IntnlChain,link:OpenLayers.INCHES_PER_UNIT.IntnlLink,"us-in":OpenLayers.INCHES_PER_UNIT.inches,"us-ft":OpenLayers.INCHES_PER_UNIT.Foot,"us-yd":OpenLayers.INCHES_PER_UNIT.Yard,"us-ch":OpenLayers.INCHES_PER_UNIT.GunterChain,"us-mi":OpenLayers.INCHES_PER_UNIT.Mile,"ind-yd":OpenLayers.INCHES_PER_UNIT.IndianYd37,"ind-ft":OpenLayers.INCHES_PER_UNIT.IndianFt37,"ind-ch":20.11669506/OpenLayers.METERS_PER_INCH}),OpenLayers.DOTS_PER_INCH=72,OpenLayers.Util.normalizeScale=function(e){var t=e>1?1/e:e;return t},OpenLayers.Util.getResolutionFromScale=function(e,t){var i;if(e){null==t&&(t="degrees");var s=OpenLayers.Util.normalizeScale(e);i=1/(s*OpenLayers.INCHES_PER_UNIT[t]*OpenLayers.DOTS_PER_INCH)}return i},OpenLayers.Util.getScaleFromResolution=function(e,t){null==t&&(t="degrees");var i=e*OpenLayers.INCHES_PER_UNIT[t]*OpenLayers.DOTS_PER_INCH;return i},/**
 * Function: pagePosition
 * Calculates the position of an element on the page (see
 * http://code.google.com/p/doctype/wiki/ArticlePageOffset)
 *
 * OpenLayers.Util.pagePosition is based on Yahoo's getXY method, which is
 * Copyright (c) 2006, Yahoo! Inc.
 * All rights reserved.
 * 
 * Redistribution and use of this software in source and binary forms, with or
 * without modification, are permitted provided that the following conditions
 * are met:
 * 
 * * Redistributions of source code must retain the above copyright notice,
 *   this list of conditions and the following disclaimer.
 * 
 * * Redistributions in binary form must reproduce the above copyright notice,
 *   this list of conditions and the following disclaimer in the documentation
 *   and/or other materials provided with the distribution.
 * 
 * * Neither the name of Yahoo! Inc. nor the names of its contributors may be
 *   used to endorse or promote products derived from this software without
 *   specific prior written permission of Yahoo! Inc.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE 
 * POSSIBILITY OF SUCH DAMAGE.
 *
 * Parameters:
 * forElement - {DOMElement}
 * 
 * Returns:
 * {Array} two item array, Left value then Top value.
 */
OpenLayers.Util.pagePosition=function(e){var t=[0,0],i=OpenLayers.Util.getViewportElement();if(!e||e==window||e==i)return t;var s,n=OpenLayers.IS_GECKO&&document.getBoxObjectFor&&"absolute"==OpenLayers.Element.getStyle(e,"position")&&(""==e.style.top||""==e.style.left),r=null;if(e.getBoundingClientRect){s=e.getBoundingClientRect();var a=i.scrollTop,o=i.scrollLeft;t[0]=s.left+o,t[1]=s.top+a}else if(document.getBoxObjectFor&&!n){s=document.getBoxObjectFor(e);var l=document.getBoxObjectFor(i);t[0]=s.screenX-l.screenX,t[1]=s.screenY-l.screenY}else{if(t[0]=e.offsetLeft,t[1]=e.offsetTop,r=e.offsetParent,r!=e)for(;r;)t[0]+=r.offsetLeft,t[1]+=r.offsetTop,r=r.offsetParent;var h=OpenLayers.BROWSER_NAME;for(("opera"==h||"safari"==h&&"absolute"==OpenLayers.Element.getStyle(e,"position"))&&(t[1]-=document.body.offsetTop),r=e.offsetParent;r&&r!=document.body;)t[0]-=r.scrollLeft,("opera"!=h||"TR"!=r.tagName)&&(t[1]-=r.scrollTop),r=r.offsetParent}return t},OpenLayers.Util.getViewportElement=function(){var e=arguments.callee.viewportElement;return void 0==e&&(e="msie"==OpenLayers.BROWSER_NAME&&"CSS1Compat"!=document.compatMode?document.body:document.documentElement,arguments.callee.viewportElement=e),e},OpenLayers.Util.isEquivalentUrl=function(e,t,i){i=i||{},OpenLayers.Util.applyDefaults(i,{ignoreCase:!0,ignorePort80:!0,ignoreHash:!0});var s=OpenLayers.Util.createUrlObject(e,i),n=OpenLayers.Util.createUrlObject(t,i);for(var r in s)if("args"!==r&&s[r]!=n[r])return!1;for(var r in s.args){if(s.args[r]!=n.args[r])return!1;delete n.args[r]}for(var r in n.args)return!1;return!0},OpenLayers.Util.createUrlObject=function(e,t){if(t=t||{},!/^\w+:\/\//.test(e)){var i=window.location,s=i.port?":"+i.port:"",n=i.protocol+"//"+i.host.split(":").shift()+s;if(0===e.indexOf("/"))e=n+e;else{var r=i.pathname.split("/");r.pop(),e=n+r.join("/")+"/"+e}}t.ignoreCase&&(e=e.toLowerCase());var a=document.createElement("a");a.href=e;var o={};o.host=a.host.split(":").shift(),o.protocol=a.protocol,o.port=t.ignorePort80?"80"==a.port||"0"==a.port?"":a.port:""==a.port||"0"==a.port?"80":a.port,o.hash=t.ignoreHash||"#"===a.hash?"":a.hash;var l=a.search;if(!l){var h=e.indexOf("?");l=-1!=h?e.substr(h):""}return o.args=OpenLayers.Util.getParameters(l),o.pathname="/"==a.pathname.charAt(0)?a.pathname:"/"+a.pathname,o},OpenLayers.Util.removeTail=function(e){var t=null,i=e.indexOf("?"),s=e.indexOf("#");return t=-1==i?-1!=s?e.substr(0,s):e:-1!=s?e.substr(0,Math.min(i,s)):e.substr(0,i)},OpenLayers.IS_GECKO=function(){var e=navigator.userAgent.toLowerCase();return-1==e.indexOf("webkit")&&-1!=e.indexOf("gecko")}(),OpenLayers.CANVAS_SUPPORTED=function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))}(),OpenLayers.BROWSER_NAME=function(){var e="",t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("opera")?e="opera":-1!=t.indexOf("msie")?e="msie":-1!=t.indexOf("safari")?e="safari":-1!=t.indexOf("mozilla")&&(e=-1!=t.indexOf("firefox")?"firefox":"mozilla"),e}(),OpenLayers.Util.getBrowserName=function(){return OpenLayers.BROWSER_NAME},OpenLayers.Util.getRenderedDimensions=function(e,t,i){var s,n,r=document.createElement("div");r.style.visibility="hidden";for(var a=i&&i.containerElement?i.containerElement:document.body,o=!1,l=null,h=a;h&&"body"!=h.tagName.toLowerCase();){var u=OpenLayers.Element.getStyle(h,"position");if("absolute"==u){o=!0;break}if(u&&"static"!=u)break;h=h.parentNode}!o||0!==a.clientHeight&&0!==a.clientWidth||(l=document.createElement("div"),l.style.visibility="hidden",l.style.position="absolute",l.style.overflow="visible",l.style.width=document.body.clientWidth+"px",l.style.height=document.body.clientHeight+"px",l.appendChild(r)),r.style.position="absolute",t&&(t.w?(s=t.w,r.style.width=s+"px"):t.h&&(n=t.h,r.style.height=n+"px")),i&&i.displayClass&&(r.className=i.displayClass);var c=document.createElement("div");if(c.innerHTML=e,c.style.overflow="visible",c.childNodes)for(var d=0,p=c.childNodes.length;p>d;d++)c.childNodes[d].style&&(c.childNodes[d].style.overflow="visible");return r.appendChild(c),l?a.appendChild(l):a.appendChild(r),s||(s=parseInt(c.scrollWidth),r.style.width=s+"px"),n||(n=parseInt(c.scrollHeight)),r.removeChild(c),l?(l.removeChild(r),a.removeChild(l)):a.removeChild(r),new OpenLayers.Size(s,n)},OpenLayers.Util.getScrollbarWidth=function(){var e=OpenLayers.Util._scrollbarWidth;if(null==e){var t=null,i=null,s=0,n=0;t=document.createElement("div"),t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px",t.style.width="100px",t.style.height="50px",t.style.overflow="hidden",i=document.createElement("div"),i.style.width="100%",i.style.height="200px",t.appendChild(i),document.body.appendChild(t),s=i.offsetWidth,t.style.overflow="scroll",n=i.offsetWidth,document.body.removeChild(document.body.lastChild),OpenLayers.Util._scrollbarWidth=s-n,e=OpenLayers.Util._scrollbarWidth}return e},OpenLayers.Util.getFormattedLonLat=function(e,t,i){i||(i="dms"),e=(e+540)%360-180;var s=Math.abs(e),n=Math.floor(s),r=(s-n)/(1/60),a=r;r=Math.floor(r);var o=(a-r)/(1/60);o=Math.round(10*o),o/=10,o>=60&&(o-=60,r+=1,r>=60&&(r-=60,n+=1)),10>n&&(n="0"+n);var l=n+"°";return i.indexOf("dm")>=0&&(10>r&&(r="0"+r),l+=r+"'",i.indexOf("dms")>=0&&(10>o&&(o="0"+o),l+=o+'"')),l+="lon"==t?0>e?OpenLayers.i18n("W"):OpenLayers.i18n("E"):0>e?OpenLayers.i18n("S"):OpenLayers.i18n("N")},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Projection=OpenLayers.Class({proj:null,projCode:null,titleRegEx:/\+title=[^\+]*/,initialize:function(e,t){OpenLayers.Util.extend(this,t),this.projCode=e,window.Proj4js&&(this.proj=new Proj4js.Proj(e))},getCode:function(){return this.proj?this.proj.srsCode:this.projCode},getUnits:function(){return this.proj?this.proj.units:null},toString:function(){return this.getCode()},equals:function(e){var t=e,i=!1;if(t)if(t instanceof OpenLayers.Projection||(t=new OpenLayers.Projection(t)),window.Proj4js&&this.proj.defData&&t.proj.defData)i=this.proj.defData.replace(this.titleRegEx,"")==t.proj.defData.replace(this.titleRegEx,"");else if(t.getCode){var s=this.getCode(),n=t.getCode();i=s==n||!!OpenLayers.Projection.transforms[s]&&OpenLayers.Projection.transforms[s][n]===OpenLayers.Projection.nullTransform}return i},destroy:function(){delete this.proj,delete this.projCode},CLASS_NAME:"OpenLayers.Projection"}),OpenLayers.Projection.transforms={},OpenLayers.Projection.defaults={"EPSG:4326":{units:"degrees",maxExtent:[-180,-90,180,90],yx:!0},"CRS:84":{units:"degrees",maxExtent:[-180,-90,180,90]},"EPSG:900913":{units:"m",maxExtent:[-20037508.34,-20037508.34,20037508.34,20037508.34]}},OpenLayers.Projection.addTransform=function(e,t,i){if(i===OpenLayers.Projection.nullTransform){var s=OpenLayers.Projection.defaults[e];s&&!OpenLayers.Projection.defaults[t]&&(OpenLayers.Projection.defaults[t]=s)}OpenLayers.Projection.transforms[e]||(OpenLayers.Projection.transforms[e]={}),OpenLayers.Projection.transforms[e][t]=i},OpenLayers.Projection.transform=function(e,t,i){if(t&&i)if(t instanceof OpenLayers.Projection||(t=new OpenLayers.Projection(t)),i instanceof OpenLayers.Projection||(i=new OpenLayers.Projection(i)),t.proj&&i.proj)e=Proj4js.transform(t.proj,i.proj,e);else{var s=t.getCode(),n=i.getCode(),r=OpenLayers.Projection.transforms;r[s]&&r[s][n]&&r[s][n](e)}return e},OpenLayers.Projection.nullTransform=function(e){return e},function(){function e(e){return e.x=180*e.x/n,e.y=180/Math.PI*(2*Math.atan(Math.exp(e.y/n*Math.PI))-Math.PI/2),e}function t(e){return e.x=e.x*n/180,e.y=Math.log(Math.tan((90+e.y)*Math.PI/360))/Math.PI*n,e}function i(i,s){var n,r,a,o,l,h=OpenLayers.Projection.addTransform,u=OpenLayers.Projection.nullTransform;for(n=0,r=s.length;r>n;++n)for(a=s[n],h(i,a,t),h(a,i,e),l=n+1;r>l;++l)o=s[l],h(a,o,u),h(o,a,u)}var s,n=20037508.34,r=["EPSG:900913","EPSG:3857","EPSG:102113","EPSG:102100"],a=["CRS:84","urn:ogc:def:crs:EPSG:6.6:4326","EPSG:4326"];for(s=r.length-1;s>=0;--s)i(r[s],a);for(s=a.length-1;s>=0;--s)i(a[s],r)}(),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.Geolocate=OpenLayers.Class(OpenLayers.Control,{geolocation:navigator.geolocation,bind:!0,watch:!1,geolocationOptions:null,destroy:function(){this.deactivate(),OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){return this.geolocation?OpenLayers.Control.prototype.activate.apply(this,arguments)?(this.watch?this.watchId=this.geolocation.watchPosition(OpenLayers.Function.bind(this.geolocate,this),OpenLayers.Function.bind(this.failure,this),this.geolocationOptions):this.getCurrentLocation(),!0):!1:(this.events.triggerEvent("locationuncapable"),!1)},deactivate:function(){return this.active&&null!==this.watchId&&this.geolocation.clearWatch(this.watchId),OpenLayers.Control.prototype.deactivate.apply(this,arguments)},geolocate:function(e){var t=new OpenLayers.LonLat(e.coords.longitude,e.coords.latitude).transform(new OpenLayers.Projection("EPSG:4326"),this.map.getProjectionObject());this.bind&&this.map.setCenter(t),this.events.triggerEvent("locationupdated",{position:e,point:new OpenLayers.Geometry.Point(t.lon,t.lat)})},getCurrentLocation:function(){return!this.active||this.watch?!1:(this.geolocation.getCurrentPosition(OpenLayers.Function.bind(this.geolocate,this),OpenLayers.Function.bind(this.failure,this),this.geolocationOptions),!0)},failure:function(e){this.events.triggerEvent("locationfailed",{error:e})},CLASS_NAME:"OpenLayers.Control.Geolocate"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format=OpenLayers.Class({options:null,externalProjection:null,internalProjection:null,data:null,keepData:!1,initialize:function(e){OpenLayers.Util.extend(this,e),this.options=e},destroy:function(){},read:function(){throw new Error("Read not implemented.")},write:function(){throw new Error("Write not implemented.")},CLASS_NAME:"OpenLayers.Format"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.XML=OpenLayers.Class(OpenLayers.Format,{namespaces:null,namespaceAlias:null,defaultPrefix:null,readers:{},writers:{},xmldom:null,initialize:function(e){window.ActiveXObject&&(this.xmldom=new ActiveXObject("Microsoft.XMLDOM")),OpenLayers.Format.prototype.initialize.apply(this,[e]),this.namespaces=OpenLayers.Util.extend({},this.namespaces),this.namespaceAlias={};for(var t in this.namespaces)this.namespaceAlias[this.namespaces[t]]=t},destroy:function(){this.xmldom=null,OpenLayers.Format.prototype.destroy.apply(this,arguments)},setNamespace:function(e,t){this.namespaces[e]=t,this.namespaceAlias[t]=e},read:function(e){var t=e.indexOf("<");t>0&&(e=e.substring(t));var i=OpenLayers.Util.Try(OpenLayers.Function.bind(function(){var t;return t=window.ActiveXObject&&!this.xmldom?new ActiveXObject("Microsoft.XMLDOM"):this.xmldom,t.loadXML(e),t},this),function(){return(new DOMParser).parseFromString(e,"text/xml")},function(){var t=new XMLHttpRequest;return t.open("GET","data:text/xml;charset=utf-8,"+encodeURIComponent(e),!1),t.overrideMimeType&&t.overrideMimeType("text/xml"),t.send(null),t.responseXML});return this.keepData&&(this.data=i),i},write:function(e){var t;if(this.xmldom)t=e.xml;else{var i=new XMLSerializer;if(1==e.nodeType){var s=document.implementation.createDocument("","",null);s.importNode&&(e=s.importNode(e,!0)),s.appendChild(e),t=i.serializeToString(s)}else t=i.serializeToString(e)}return t},createElementNS:function(e,t){var i;return i=this.xmldom?"string"==typeof e?this.xmldom.createNode(1,t,e):this.xmldom.createNode(1,t,""):document.createElementNS(e,t)},createTextNode:function(e){var t;return"string"!=typeof e&&(e=String(e)),t=this.xmldom?this.xmldom.createTextNode(e):document.createTextNode(e)},getElementsByTagNameNS:function(e,t,i){var s=[];if(e.getElementsByTagNameNS)s=e.getElementsByTagNameNS(t,i);else for(var n,r,a=e.getElementsByTagName("*"),o=0,l=a.length;l>o;++o)n=a[o],r=n.prefix?n.prefix+":"+i:i,("*"==i||r==n.nodeName)&&("*"==t||t==n.namespaceURI)&&s.push(n);return s},getAttributeNodeNS:function(e,t,i){var s=null;if(e.getAttributeNodeNS)s=e.getAttributeNodeNS(t,i);else for(var n,r,a=e.attributes,o=0,l=a.length;l>o;++o)if(n=a[o],n.namespaceURI==t&&(r=n.prefix?n.prefix+":"+i:i,r==n.nodeName)){s=n;break}return s},getAttributeNS:function(e,t,i){var s="";if(e.getAttributeNS)s=e.getAttributeNS(t,i)||"";else{var n=this.getAttributeNodeNS(e,t,i);n&&(s=n.nodeValue)}return s},getChildValue:function(e,t){var i=t||"";if(e)for(var s=e.firstChild;s;s=s.nextSibling)switch(s.nodeType){case 3:case 4:i+=s.nodeValue}return i},isSimpleContent:function(e){for(var t=!0,i=e.firstChild;i;i=i.nextSibling)if(1===i.nodeType){t=!1;break}return t},contentType:function(e){for(var t=!1,i=!1,s=OpenLayers.Format.XML.CONTENT_TYPE.EMPTY,n=e.firstChild;n;n=n.nextSibling){switch(n.nodeType){case 1:i=!0;break;case 8:break;default:t=!0}if(i&&t)break}if(i&&t)s=OpenLayers.Format.XML.CONTENT_TYPE.MIXED;else{if(i)return OpenLayers.Format.XML.CONTENT_TYPE.COMPLEX;if(t)return OpenLayers.Format.XML.CONTENT_TYPE.SIMPLE}return s},hasAttributeNS:function(e,t,i){var s=!1;return s=e.hasAttributeNS?e.hasAttributeNS(t,i):!!this.getAttributeNodeNS(e,t,i)},setAttributeNS:function(e,t,i,s){if(e.setAttributeNS)e.setAttributeNS(t,i,s);else{if(!this.xmldom)throw"setAttributeNS not implemented";if(t){var n=e.ownerDocument.createNode(2,i,t);n.nodeValue=s,e.setAttributeNode(n)}else e.setAttribute(i,s)}},createElementNSPlus:function(e,t){t=t||{};var i=t.uri||this.namespaces[t.prefix];if(!i){var s=e.indexOf(":");i=this.namespaces[e.substring(0,s)]}i||(i=this.namespaces[this.defaultPrefix]);var n=this.createElementNS(i,e);t.attributes&&this.setAttributes(n,t.attributes);var r=t.value;return null!=r&&n.appendChild(this.createTextNode(r)),n},setAttributes:function(e,t){var i,s;for(var n in t)null!=t[n]&&t[n].toString&&(i=t[n].toString(),s=this.namespaces[n.substring(0,n.indexOf(":"))]||null,this.setAttributeNS(e,s,n,i))},readNode:function(e,t){t||(t={});var i=this.readers[e.namespaceURI?this.namespaceAlias[e.namespaceURI]:this.defaultPrefix];if(i){var s=e.localName||e.nodeName.split(":").pop(),n=i[s]||i["*"];n&&n.apply(this,[e,t])}return t},readChildNodes:function(e,t){t||(t={});for(var i,s=e.childNodes,n=0,r=s.length;r>n;++n)i=s[n],1==i.nodeType&&this.readNode(i,t);return t},writeNode:function(e,t,i){var s,n,r=e.indexOf(":");r>0?(s=e.substring(0,r),n=e.substring(r+1)):(s=i?this.namespaceAlias[i.namespaceURI]:this.defaultPrefix,n=e);var a=this.writers[s][n].apply(this,[t]);return i&&i.appendChild(a),a},getChildEl:function(e,t,i){return e&&this.getThisOrNextEl(e.firstChild,t,i)},getNextEl:function(e,t,i){return e&&this.getThisOrNextEl(e.nextSibling,t,i)},getThisOrNextEl:function(e,t,i){e:for(var s=e;s;s=s.nextSibling)switch(s.nodeType){case 1:if(!(t&&t!==(s.localName||s.nodeName.split(":").pop())||i&&i!==s.namespaceURI))break e;s=null;break e;case 3:if(/^\s*$/.test(s.nodeValue))break;case 4:case 6:case 12:case 10:case 11:s=null;break e}return s||null},lookupNamespaceURI:function(e,t){var i=null;if(e)if(e.lookupNamespaceURI)i=e.lookupNamespaceURI(t);else e:switch(e.nodeType){case 1:if(null!==e.namespaceURI&&e.prefix===t){i=e.namespaceURI;break e}var s=e.attributes.length;if(s)for(var n,r=0;s>r;++r){if(n=e.attributes[r],"xmlns"===n.prefix&&n.name==="xmlns:"+t){i=n.value||null;break e}if("xmlns"===n.name&&null===t){i=n.value||null;break e}}i=this.lookupNamespaceURI(e.parentNode,t);break e;case 2:i=this.lookupNamespaceURI(e.ownerElement,t);break e;case 9:i=this.lookupNamespaceURI(e.documentElement,t);break e;case 6:case 12:case 10:case 11:break e;default:i=this.lookupNamespaceURI(e.parentNode,t)}return i},getXMLDoc:function(){return OpenLayers.Format.XML.document||this.xmldom||(document.implementation&&document.implementation.createDocument?OpenLayers.Format.XML.document=document.implementation.createDocument("","",null):!this.xmldom&&window.ActiveXObject&&(this.xmldom=new ActiveXObject("Microsoft.XMLDOM"))),OpenLayers.Format.XML.document||this.xmldom},CLASS_NAME:"OpenLayers.Format.XML"}),OpenLayers.Format.XML.CONTENT_TYPE={EMPTY:0,SIMPLE:1,COMPLEX:2,MIXED:3},OpenLayers.Format.XML.lookupNamespaceURI=OpenLayers.Function.bind(OpenLayers.Format.XML.prototype.lookupNamespaceURI,OpenLayers.Format.XML.prototype),OpenLayers.Format.XML.document=null,/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Date={toISOString:function(){function e(e,t){for(var i=e+"";i.length<t;)i="0"+i;return i}return"toISOString"in Date.prototype?function(e){return e.toISOString()}:function(t){var i;return i=isNaN(t.getTime())?"Invalid Date":t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1,2)+"-"+e(t.getUTCDate(),2)+"T"+e(t.getUTCHours(),2)+":"+e(t.getUTCMinutes(),2)+":"+e(t.getUTCSeconds(),2)+"."+e(t.getUTCMilliseconds(),3)+"Z"}}(),parse:function(e){var t,i=e.match(/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:(?:T(\d{1,2}):(\d{2}):(\d{2}(?:\.\d+)?)(Z|(?:[+-]\d{1,2}(?::(\d{2}))?)))|Z)?$/);if(i&&(i[1]||i[7])){var s=parseInt(i[1],10)||0,n=parseInt(i[2],10)-1||0,r=parseInt(i[3],10)||1;t=new Date(Date.UTC(s,n,r));var a=i[7];if(a){var o=parseInt(i[4],10),l=parseInt(i[5],10),h=parseFloat(i[6]),u=0|h,c=Math.round(1e3*(h-u));if(t.setUTCHours(o,l,u,c),"Z"!==a){var d=parseInt(a,10),p=parseInt(i[8],10)||0,f=-1e3*(60*60*d+60*p);t=new Date(t.getTime()+f)}}}else t=new Date("invalid");return t}},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Feature=OpenLayers.Class({layer:null,id:null,lonlat:null,data:null,marker:null,popupClass:null,popup:null,initialize:function(e,t,i){this.layer=e,this.lonlat=t,this.data=null!=i?i:{},this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){null!=this.layer&&null!=this.layer.map&&null!=this.popup&&this.layer.map.removePopup(this.popup),null!=this.layer&&null!=this.marker&&this.layer.removeMarker(this.marker),this.layer=null,this.id=null,this.lonlat=null,this.data=null,null!=this.marker&&(this.destroyMarker(this.marker),this.marker=null),null!=this.popup&&(this.destroyPopup(this.popup),this.popup=null)},onScreen:function(){var e=!1;if(null!=this.layer&&null!=this.layer.map){var t=this.layer.map.getExtent();e=t.containsLonLat(this.lonlat)}return e},createMarker:function(){return null!=this.lonlat&&(this.marker=new OpenLayers.Marker(this.lonlat,this.data.icon)),this.marker},destroyMarker:function(){this.marker.destroy()},createPopup:function(e){if(null!=this.lonlat){if(!this.popup){var t=this.marker?this.marker.icon:null,i=this.popupClass?this.popupClass:OpenLayers.Popup.Anchored;this.popup=new i(this.id+"_popup",this.lonlat,this.data.popupSize,this.data.popupContentHTML,t,e)}null!=this.data.overflow&&(this.popup.contentDiv.style.overflow=this.data.overflow),this.popup.feature=this}return this.popup},destroyPopup:function(){this.popup&&(this.popup.feature=null,this.popup.destroy(),this.popup=null)},CLASS_NAME:"OpenLayers.Feature"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.State={UNKNOWN:"Unknown",INSERT:"Insert",UPDATE:"Update",DELETE:"Delete"},OpenLayers.Feature.Vector=OpenLayers.Class(OpenLayers.Feature,{fid:null,geometry:null,attributes:null,bounds:null,state:null,style:null,url:null,renderIntent:"default",modified:null,initialize:function(e,t,i){OpenLayers.Feature.prototype.initialize.apply(this,[null,null,t]),this.lonlat=null,this.geometry=e?e:null,this.state=null,this.attributes={},t&&(this.attributes=OpenLayers.Util.extend(this.attributes,t)),this.style=i?i:null},destroy:function(){this.layer&&(this.layer.removeFeatures(this),this.layer=null),this.geometry=null,this.modified=null,OpenLayers.Feature.prototype.destroy.apply(this,arguments)},clone:function(){return new OpenLayers.Feature.Vector(this.geometry?this.geometry.clone():null,this.attributes,this.style)},onScreen:function(e){var t=!1;if(this.layer&&this.layer.map){var i=this.layer.map.getExtent();if(e){var s=this.geometry.getBounds();t=i.intersectsBounds(s)}else{var n=i.toGeometry();t=n.intersects(this.geometry)}}return t},getVisibility:function(){return!(this.style&&"none"==this.style.display||!this.layer||this.layer&&this.layer.styleMap&&"none"==this.layer.styleMap.createSymbolizer(this,this.renderIntent).display||this.layer&&!this.layer.getVisibility())},createMarker:function(){return null},destroyMarker:function(){},createPopup:function(){return null},atPoint:function(e,t,i){var s=!1;return this.geometry&&(s=this.geometry.atPoint(e,t,i)),s},destroyPopup:function(){},move:function(e){if(!this.layer||!this.geometry.move)return void 0;var t;t="OpenLayers.LonLat"==e.CLASS_NAME?this.layer.getViewPortPxFromLonLat(e):e;var i=this.layer.getViewPortPxFromLonLat(this.geometry.getBounds().getCenterLonLat()),s=this.layer.map.getResolution();return this.geometry.move(s*(t.x-i.x),s*(i.y-t.y)),this.layer.drawFeature(this),i},toState:function(e){if(e==OpenLayers.State.UPDATE)switch(this.state){case OpenLayers.State.UNKNOWN:case OpenLayers.State.DELETE:this.state=e;break;case OpenLayers.State.UPDATE:case OpenLayers.State.INSERT:}else if(e==OpenLayers.State.INSERT)switch(this.state){case OpenLayers.State.UNKNOWN:break;default:this.state=e}else if(e==OpenLayers.State.DELETE)switch(this.state){case OpenLayers.State.INSERT:break;case OpenLayers.State.DELETE:break;case OpenLayers.State.UNKNOWN:case OpenLayers.State.UPDATE:this.state=e}else e==OpenLayers.State.UNKNOWN&&(this.state=e)},CLASS_NAME:"OpenLayers.Feature.Vector"}),OpenLayers.Feature.Vector.style={"default":{fillColor:"#ee9900",fillOpacity:.4,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"#ee9900",strokeOpacity:1,strokeWidth:1,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},select:{fillColor:"blue",fillOpacity:.4,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"blue",strokeOpacity:1,strokeWidth:2,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"pointer",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},temporary:{fillColor:"#66cccc",fillOpacity:.2,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"#66cccc",strokeOpacity:1,strokeLinecap:"round",strokeWidth:2,strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},"delete":{display:"none"}},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Geometry.Collection=OpenLayers.Class(OpenLayers.Geometry,{components:null,componentTypes:null,initialize:function(e){OpenLayers.Geometry.prototype.initialize.apply(this,arguments),this.components=[],null!=e&&this.addComponents(e)},destroy:function(){this.components.length=0,this.components=null,OpenLayers.Geometry.prototype.destroy.apply(this,arguments)},clone:function(){for(var geometry=eval("new "+this.CLASS_NAME+"()"),i=0,len=this.components.length;len>i;i++)geometry.addComponent(this.components[i].clone());return OpenLayers.Util.applyDefaults(geometry,this),geometry},getComponentsString:function(){for(var e=[],t=0,i=this.components.length;i>t;t++)e.push(this.components[t].toShortString());return e.join(",")},calculateBounds:function(){this.bounds=null;var e=new OpenLayers.Bounds,t=this.components;if(t)for(var i=0,s=t.length;s>i;i++)e.extend(t[i].getBounds());null!=e.left&&null!=e.bottom&&null!=e.right&&null!=e.top&&this.setBounds(e)},addComponents:function(e){OpenLayers.Util.isArray(e)||(e=[e]);for(var t=0,i=e.length;i>t;t++)this.addComponent(e[t])},addComponent:function(e,t){var i=!1;if(e&&(null==this.componentTypes||OpenLayers.Util.indexOf(this.componentTypes,e.CLASS_NAME)>-1)){if(null!=t&&t<this.components.length){var s=this.components.slice(0,t),n=this.components.slice(t,this.components.length);s.push(e),this.components=s.concat(n)}else this.components.push(e);e.parent=this,this.clearBounds(),i=!0}return i},removeComponents:function(e){var t=!1;OpenLayers.Util.isArray(e)||(e=[e]);for(var i=e.length-1;i>=0;--i)t=this.removeComponent(e[i])||t;return t},removeComponent:function(e){return OpenLayers.Util.removeItem(this.components,e),this.clearBounds(),!0},getLength:function(){for(var e=0,t=0,i=this.components.length;i>t;t++)e+=this.components[t].getLength();return e},getArea:function(){for(var e=0,t=0,i=this.components.length;i>t;t++)e+=this.components[t].getArea();return e},getGeodesicArea:function(e){for(var t=0,i=0,s=this.components.length;s>i;i++)t+=this.components[i].getGeodesicArea(e);return t},getCentroid:function(e){if(!e)return this.components.length&&this.components[0].getCentroid();var t=this.components.length;if(!t)return!1;for(var i,s=[],n=[],r=0,a=Number.MAX_VALUE,o=0;t>o;++o){i=this.components[o];var l=i.getArea(),h=i.getCentroid(!0);isNaN(l)||isNaN(h.x)||isNaN(h.y)||(s.push(l),r+=l,a=a>l&&l>0?l:a,n.push(h))}if(t=s.length,0===r){for(var o=0;t>o;++o)s[o]=1;r=s.length}else{for(var o=0;t>o;++o)s[o]/=a;r/=a}for(var h,l,u=0,c=0,o=0;t>o;++o)h=n[o],l=s[o],u+=h.x*l,c+=h.y*l;return new OpenLayers.Geometry.Point(u/r,c/r)},getGeodesicLength:function(e){for(var t=0,i=0,s=this.components.length;s>i;i++)t+=this.components[i].getGeodesicLength(e);return t},move:function(e,t){for(var i=0,s=this.components.length;s>i;i++)this.components[i].move(e,t)},rotate:function(e,t){for(var i=0,s=this.components.length;s>i;++i)this.components[i].rotate(e,t)},resize:function(e,t,i){for(var s=0;s<this.components.length;++s)this.components[s].resize(e,t,i);return this},distanceTo:function(e,t){for(var i,s,n,r=!(t&&t.edge===!1),a=r&&t&&t.details,o=Number.POSITIVE_INFINITY,l=0,h=this.components.length;h>l&&(i=this.components[l].distanceTo(e,t),n=a?i.distance:i,!(o>n&&(o=n,s=i,0==o)));++l);return s},equals:function(e){var t=!0;if(e&&e.CLASS_NAME&&this.CLASS_NAME==e.CLASS_NAME)if(OpenLayers.Util.isArray(e.components)&&e.components.length==this.components.length){for(var i=0,s=this.components.length;s>i;++i)if(!this.components[i].equals(e.components[i])){t=!1;break}}else t=!1;else t=!1;return t},transform:function(e,t){if(e&&t){for(var i=0,s=this.components.length;s>i;i++){var n=this.components[i];n.transform(e,t)}this.bounds=null}return this},intersects:function(e){for(var t=!1,i=0,s=this.components.length;s>i&&!(t=e.intersects(this.components[i]));++i);return t},getVertices:function(e){for(var t=[],i=0,s=this.components.length;s>i;++i)Array.prototype.push.apply(t,this.components[i].getVertices(e));return t},CLASS_NAME:"OpenLayers.Geometry.Collection"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Geometry.MultiPoint=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Point"],addPoint:function(e,t){this.addComponent(e,t)},removePoint:function(e){this.removeComponent(e)},CLASS_NAME:"OpenLayers.Geometry.MultiPoint"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Geometry.Curve=OpenLayers.Class(OpenLayers.Geometry.MultiPoint,{componentTypes:["OpenLayers.Geometry.Point"],getLength:function(){var e=0;if(this.components&&this.components.length>1)for(var t=1,i=this.components.length;i>t;t++)e+=this.components[t-1].distanceTo(this.components[t]);return e},getGeodesicLength:function(e){var t=this;if(e){var i=new OpenLayers.Projection("EPSG:4326");i.equals(e)||(t=this.clone().transform(e,i))}var s=0;if(t.components&&t.components.length>1)for(var n,r,a=1,o=t.components.length;o>a;a++)n=t.components[a-1],r=t.components[a],s+=OpenLayers.Util.distVincenty({lon:n.x,lat:n.y},{lon:r.x,lat:r.y});return 1e3*s},CLASS_NAME:"OpenLayers.Geometry.Curve"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Geometry.LineString=OpenLayers.Class(OpenLayers.Geometry.Curve,{removeComponent:function(){var e=this.components&&this.components.length>2;return e&&OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments),e},intersects:function(e){var t=!1,i=e.CLASS_NAME;if("OpenLayers.Geometry.LineString"==i||"OpenLayers.Geometry.LinearRing"==i||"OpenLayers.Geometry.Point"==i){var s,n=this.getSortedSegments();s="OpenLayers.Geometry.Point"==i?[{x1:e.x,y1:e.y,x2:e.x,y2:e.y}]:e.getSortedSegments();var r,a,o,l,h,u,c,d;e:for(var p=0,f=n.length;f>p;++p){r=n[p],a=r.x1,o=r.x2,l=r.y1,h=r.y2;for(var m=0,y=s.length;y>m&&(u=s[m],!(u.x1>o));++m)if(!(u.x2<a||(c=u.y1,d=u.y2,Math.min(c,d)>Math.max(l,h)||Math.max(c,d)<Math.min(l,h)||!OpenLayers.Geometry.segmentsIntersect(r,u)))){t=!0;break e}}}else t=e.intersects(this);return t},getSortedSegments:function(){function e(e,t){return e.x1-t.x1}for(var t,i,s=this.components.length-1,n=new Array(s),r=0;s>r;++r)t=this.components[r],i=this.components[r+1],n[r]=t.x<i.x?{x1:t.x,y1:t.y,x2:i.x,y2:i.y}:{x1:i.x,y1:i.y,x2:t.x,y2:t.y};return n.sort(e)},splitWithSegment:function(e,t){for(var i,s,n,r,a,o=!(t&&t.edge===!1),l=t&&t.tolerance,h=[],u=this.getVertices(),c=[],d=[],p=!1,f={point:!0,tolerance:l},m=null,y=0,g=u.length-2;g>=y;++y)if(i=u[y],c.push(i.clone()),s=u[y+1],a={x1:i.x,y1:i.y,x2:s.x,y2:s.y},n=OpenLayers.Geometry.segmentsIntersect(e,a,f),n instanceof OpenLayers.Geometry.Point&&(r=n.x===e.x1&&n.y===e.y1||n.x===e.x2&&n.y===e.y2||n.equals(i)||n.equals(s)?!0:!1,r||o)){if(n.equals(d[d.length-1])||d.push(n.clone()),0===y&&n.equals(i))continue;if(n.equals(s))continue;p=!0,n.equals(i)||c.push(n),h.push(new OpenLayers.Geometry.LineString(c)),c=[n.clone()]}if(p&&(c.push(s.clone()),h.push(new OpenLayers.Geometry.LineString(c))),d.length>0){var v=e.x1<e.x2?1:-1,x=e.y1<e.y2?1:-1;m={lines:h,points:d.sort(function(e,t){return v*e.x-v*t.x||x*e.y-x*t.y})}}return m},split:function(e,t){var i,s,n,r,a=null,o=t&&t.mutual;if(e instanceof OpenLayers.Geometry.LineString){var l,h,u,c,d,p,f=this.getVertices(),m=[];n=[];for(var y=0,g=f.length-2;g>=y;++y){l=f[y],h=f[y+1],u={x1:l.x,y1:l.y,x2:h.x,y2:h.y},r=r||[e],o&&m.push(l.clone());for(var v=0;v<r.length;++v)if(c=r[v].splitWithSegment(u,t),c&&(d=c.lines,d.length>0&&(d.unshift(v,1),Array.prototype.splice.apply(r,d),v+=d.length-2),o))for(var x=0,E=c.points.length;E>x;++x)p=c.points[x],p.equals(l)||(m.push(p),n.push(new OpenLayers.Geometry.LineString(m)),m=p.equals(h)?[]:[p.clone()])}o&&n.length>0&&m.length>0&&(m.push(h.clone()),n.push(new OpenLayers.Geometry.LineString(m)))}else a=e.splitWith(this,t);return r&&r.length>1?s=!0:r=[],n&&n.length>1?i=!0:n=[],(s||i)&&(a=o?[n,r]:r),a},splitWith:function(e,t){return e.split(this,t)},getVertices:function(e){var t;return t=e===!0?[this.components[0],this.components[this.components.length-1]]:e===!1?this.components.slice(1,this.components.length-1):this.components.slice()},distanceTo:function(e,t){var i,s=!(t&&t.edge===!1),n=s&&t&&t.details,r={},a=Number.POSITIVE_INFINITY;if(e instanceof OpenLayers.Geometry.Point){for(var o,l=this.getSortedSegments(),h=e.x,u=e.y,c=0,d=l.length;d>c;++c)if(o=l[c],i=OpenLayers.Geometry.distanceToSegment(e,o),i.distance<a){if(a=i.distance,r=i,0===a)break}else if(o.x2>h&&(u>o.y1&&u<o.y2||u<o.y1&&u>o.y2))break;r=n?{distance:r.distance,x0:r.x,y0:r.y,x1:h,y1:u}:r.distance}else if(e instanceof OpenLayers.Geometry.LineString){var p,f,m,y,g,v=this.getSortedSegments(),x=e.getSortedSegments(),E=x.length,b={point:!0};e:for(var c=0,d=v.length;d>c;++c){p=v[c],y=p.x1,g=p.y1;for(var L=0;E>L;++L){if(f=x[L],m=OpenLayers.Geometry.segmentsIntersect(p,f,b)){a=0,r={distance:0,x0:m.x,y0:m.y,x1:m.x,y1:m.y};break e}i=OpenLayers.Geometry.distanceToSegment({x:y,y:g},f),i.distance<a&&(a=i.distance,r={distance:a,x0:y,y0:g,x1:i.x,y1:i.y})}}if(n||(r=r.distance),0!==a&&p){i=e.distanceTo(new OpenLayers.Geometry.Point(p.x2,p.y2),t);var S=n?i.distance:i;a>S&&(r=n?{distance:a,x0:i.x1,y0:i.y1,x1:i.x0,y1:i.y0}:S)}}else r=e.distanceTo(this,t),n&&(r={distance:r.distance,x0:r.x1,y0:r.y1,x1:r.x0,y1:r.y0});return r},simplify:function(e){if(this&&null!==this){var t=this.getVertices();if(t.length<3)return this;var i=function(e,t){return e-t},s=function(e,t,i,r){for(var a,l=0,h=0,u=t;i>u;u++)a=n(e[t],e[i],e[u]),a>l&&(l=a,h=u);l>r&&h!=t&&(o.push(h),s(e,t,h,r),s(e,h,i,r))},n=function(e,t,i){var s=Math.abs(.5*(e.x*t.y+t.x*i.y+i.x*e.y-t.x*e.y-i.x*t.y-e.x*i.y)),n=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),r=2*(s/n);return r},r=0,a=t.length-1,o=[];for(o.push(r),o.push(a);t[r].equals(t[a]);)a--,o.push(a);s(t,r,a,e);var l=[];o.sort(i);for(var h=0;h<o.length;h++)l.push(t[o[h]]);return new OpenLayers.Geometry.LineString(l)}return this},CLASS_NAME:"OpenLayers.Geometry.LineString"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Geometry.LinearRing=OpenLayers.Class(OpenLayers.Geometry.LineString,{componentTypes:["OpenLayers.Geometry.Point"],addComponent:function(e,t){var i=!1,s=this.components.pop();null==t&&e.equals(s)||(i=OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,arguments));var n=this.components[0];return OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[n]),i},removeComponent:function(){var e=this.components&&this.components.length>3;if(e){this.components.pop(),OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments);var t=this.components[0];OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[t])}return e},move:function(e,t){for(var i=0,s=this.components.length;s-1>i;i++)this.components[i].move(e,t)},rotate:function(e,t){for(var i=0,s=this.components.length;s-1>i;++i)this.components[i].rotate(e,t)},resize:function(e,t,i){for(var s=0,n=this.components.length;n-1>s;++s)this.components[s].resize(e,t,i);return this},transform:function(e,t){if(e&&t){for(var i=0,s=this.components.length;s-1>i;i++){var n=this.components[i];n.transform(e,t)}this.bounds=null}return this},getCentroid:function(){if(this.components&&this.components.length>2){for(var e=0,t=0,i=0;i<this.components.length-1;i++){var s=this.components[i],n=this.components[i+1];e+=(s.x+n.x)*(s.x*n.y-n.x*s.y),t+=(s.y+n.y)*(s.x*n.y-n.x*s.y)}var r=-1*this.getArea(),a=e/(6*r),o=t/(6*r);return new OpenLayers.Geometry.Point(a,o)}return null},getArea:function(){var e=0;if(this.components&&this.components.length>2){for(var t=0,i=0,s=this.components.length;s-1>i;i++){var n=this.components[i],r=this.components[i+1];t+=(n.x+r.x)*(r.y-n.y)}e=-t/2}return e},getGeodesicArea:function(e){var t=this;if(e){var i=new OpenLayers.Projection("EPSG:4326");i.equals(e)||(t=this.clone().transform(e,i))}var s=0,n=t.components&&t.components.length;if(n>2){for(var r,a,o=0;n-1>o;o++)r=t.components[o],a=t.components[o+1],s+=OpenLayers.Util.rad(a.x-r.x)*(2+Math.sin(OpenLayers.Util.rad(r.y))+Math.sin(OpenLayers.Util.rad(a.y)));s=6378137*6378137*s/2}return s},containsPoint:function(e){function t(e,t,i,s,n){return(e-n)*((s-t)/(n-i))+s}for(var i,s,n,r,a,o,l,h=OpenLayers.Number.limitSigDigs,u=14,c=h(e.x,u),d=h(e.y,u),p=this.components.length-1,f=0,m=0;p>m;++m)if(i=this.components[m],n=h(i.x,u),r=h(i.y,u),s=this.components[m+1],a=h(s.x,u),o=h(s.y,u),r!=o){if(l=h(t(d,n,r,a,o),u),l==c&&(o>r&&d>=r&&o>=d||r>o&&r>=d&&d>=o)){f=-1;break}c>=l||n!=a&&(l<Math.min(n,a)||l>Math.max(n,a))||(o>r&&d>=r&&o>d||r>o&&r>d&&d>=o)&&++f}else if(d==r&&(a>=n&&c>=n&&a>=c||n>=a&&n>=c&&c>=a)){f=-1;break}var y=-1==f?1:!!(1&f);return y},intersects:function(e){var t=!1;if("OpenLayers.Geometry.Point"==e.CLASS_NAME)t=this.containsPoint(e);else if("OpenLayers.Geometry.LineString"==e.CLASS_NAME)t=e.intersects(this);else if("OpenLayers.Geometry.LinearRing"==e.CLASS_NAME)t=OpenLayers.Geometry.LineString.prototype.intersects.apply(this,[e]);else for(var i=0,s=e.components.length;s>i&&!(t=e.components[i].intersects(this));++i);return t},getVertices:function(e){return e===!0?[]:this.components.slice(0,this.components.length-1)},CLASS_NAME:"OpenLayers.Geometry.LinearRing"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Geometry.Polygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LinearRing"],getArea:function(){var e=0;if(this.components&&this.components.length>0){e+=Math.abs(this.components[0].getArea());for(var t=1,i=this.components.length;i>t;t++)e-=Math.abs(this.components[t].getArea())}return e},getGeodesicArea:function(e){var t=0;if(this.components&&this.components.length>0){t+=Math.abs(this.components[0].getGeodesicArea(e));for(var i=1,s=this.components.length;s>i;i++)t-=Math.abs(this.components[i].getGeodesicArea(e))}return t},containsPoint:function(e){var t=this.components.length,i=!1;if(t>0&&(i=this.components[0].containsPoint(e),1!==i&&i&&t>1))for(var s,n=1;t>n;++n)if(s=this.components[n].containsPoint(e)){i=1===s?1:!1;break}return i},intersects:function(e){var t,i,s=!1;if("OpenLayers.Geometry.Point"==e.CLASS_NAME)s=this.containsPoint(e);else if("OpenLayers.Geometry.LineString"==e.CLASS_NAME||"OpenLayers.Geometry.LinearRing"==e.CLASS_NAME){for(t=0,i=this.components.length;i>t&&!(s=e.intersects(this.components[t]));++t);if(!s)for(t=0,i=e.components.length;i>t&&!(s=this.containsPoint(e.components[t]));++t);}else for(t=0,i=e.components.length;i>t&&!(s=this.intersects(e.components[t]));++t);if(!s&&"OpenLayers.Geometry.Polygon"==e.CLASS_NAME){var n=this.components[0];for(t=0,i=n.components.length;i>t&&!(s=e.containsPoint(n.components[t]));++t);}return s},distanceTo:function(e,t){var i,s=!(t&&t.edge===!1);return i=!s&&this.intersects(e)?0:OpenLayers.Geometry.Collection.prototype.distanceTo.apply(this,[e,t])},CLASS_NAME:"OpenLayers.Geometry.Polygon"}),OpenLayers.Geometry.Polygon.createRegularPolygon=function(e,t,i,s){var n=Math.PI*(1/i-.5);s&&(n+=s/180*Math.PI);for(var r,a,o,l=[],h=0;i>h;++h)r=n+2*h*Math.PI/i,a=e.x+t*Math.cos(r),o=e.y+t*Math.sin(r),l.push(new OpenLayers.Geometry.Point(a,o));var u=new OpenLayers.Geometry.LinearRing(l);return new OpenLayers.Geometry.Polygon([u])},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Event={observers:!1,KEY_SPACE:32,KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,element:function(e){return e.target||e.srcElement},isSingleTouch:function(e){return e.touches&&1==e.touches.length},isMultiTouch:function(e){return e.touches&&e.touches.length>1},isLeftClick:function(e){return e.which&&1==e.which||e.button&&1==e.button},isRightClick:function(e){return e.which&&3==e.which||e.button&&2==e.button},stop:function(e,t){t||(e.preventDefault?e.preventDefault():e.returnValue=!1),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},findElement:function(e,t){for(var i=OpenLayers.Event.element(e);i.parentNode&&(!i.tagName||i.tagName.toUpperCase()!=t.toUpperCase());)i=i.parentNode;return i},observe:function(e,t,i,s){var n=OpenLayers.Util.getElement(e);if(s=s||!1,"keypress"==t&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||n.attachEvent)&&(t="keydown"),this.observers||(this.observers={}),!n._eventCacheID){var r="eventCacheID_";n.id&&(r=n.id+"_"+r),n._eventCacheID=OpenLayers.Util.createUniqueID(r)}var a=n._eventCacheID;this.observers[a]||(this.observers[a]=[]),this.observers[a].push({element:n,name:t,observer:i,useCapture:s}),n.addEventListener?n.addEventListener(t,i,s):n.attachEvent&&n.attachEvent("on"+t,i)},stopObservingElement:function(e){var t=OpenLayers.Util.getElement(e),i=t._eventCacheID;this._removeElementObservers(OpenLayers.Event.observers[i])},_removeElementObservers:function(e){if(e)for(var t=e.length-1;t>=0;t--){var i=e[t],s=new Array(i.element,i.name,i.observer,i.useCapture);OpenLayers.Event.stopObserving.apply(this,s)}},stopObserving:function(e,t,i,s){s=s||!1;var n=OpenLayers.Util.getElement(e),r=n._eventCacheID;"keypress"==t&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||n.detachEvent)&&(t="keydown");var a=!1,o=OpenLayers.Event.observers[r];if(o)for(var l=0;!a&&l<o.length;){var h=o[l];if(h.name==t&&h.observer==i&&h.useCapture==s){o.splice(l,1),0==o.length&&delete OpenLayers.Event.observers[r],a=!0;break}l++}return a&&(n.removeEventListener?n.removeEventListener(t,i,s):n&&n.detachEvent&&n.detachEvent("on"+t,i)),a},unloadCache:function(){if(OpenLayers.Event&&OpenLayers.Event.observers){for(var e in OpenLayers.Event.observers){var t=OpenLayers.Event.observers[e];OpenLayers.Event._removeElementObservers.apply(this,[t])}OpenLayers.Event.observers=!1}},CLASS_NAME:"OpenLayers.Event"},OpenLayers.Event.observe(window,"unload",OpenLayers.Event.unloadCache,!1),OpenLayers.Events=OpenLayers.Class({BROWSER_EVENTS:["mouseover","mouseout","mousedown","mouseup","mousemove","click","dblclick","rightclick","dblrightclick","resize","focus","blur","touchstart","touchmove","touchend","keydown"],listeners:null,object:null,element:null,eventHandler:null,fallThrough:null,includeXY:!1,extensions:null,extensionCount:null,clearMouseListener:null,initialize:function(e,t,i,s,n){OpenLayers.Util.extend(this,n),this.object=e,this.fallThrough=s,this.listeners={},this.extensions={},this.extensionCount={},null!=t&&this.attachToElement(t)},destroy:function(){for(var e in this.extensions)"boolean"!=typeof this.extensions[e]&&this.extensions[e].destroy();this.extensions=null,this.element&&(OpenLayers.Event.stopObservingElement(this.element),this.element.hasScrollEvent&&OpenLayers.Event.stopObserving(window,"scroll",this.clearMouseListener)),this.element=null,this.listeners=null,this.object=null,this.fallThrough=null,this.eventHandler=null},addEventType:function(){},attachToElement:function(e){this.element?OpenLayers.Event.stopObservingElement(this.element):(this.eventHandler=OpenLayers.Function.bindAsEventListener(this.handleBrowserEvent,this),this.clearMouseListener=OpenLayers.Function.bind(this.clearMouseCache,this)),this.element=e;for(var t=0,i=this.BROWSER_EVENTS.length;i>t;t++)OpenLayers.Event.observe(e,this.BROWSER_EVENTS[t],this.eventHandler);OpenLayers.Event.observe(e,"dragstart",OpenLayers.Event.stop)},on:function(e){for(var t in e)"scope"!=t&&e.hasOwnProperty(t)&&this.register(t,e.scope,e[t])},register:function(e,t,i,s){if(e in OpenLayers.Events&&!this.extensions[e]&&(this.extensions[e]=new OpenLayers.Events[e](this)),null!=i){null==t&&(t=this.object);var n=this.listeners[e];n||(n=[],this.listeners[e]=n,this.extensionCount[e]=0);var r={obj:t,func:i};s?(n.splice(this.extensionCount[e],0,r),"object"==typeof s&&s.extension&&this.extensionCount[e]++):n.push(r)}},registerPriority:function(e,t,i){this.register(e,t,i,!0)},un:function(e){for(var t in e)"scope"!=t&&e.hasOwnProperty(t)&&this.unregister(t,e.scope,e[t])},unregister:function(e,t,i){null==t&&(t=this.object);var s=this.listeners[e];if(null!=s)for(var n=0,r=s.length;r>n;n++)if(s[n].obj==t&&s[n].func==i){s.splice(n,1);break}},remove:function(e){null!=this.listeners[e]&&(this.listeners[e]=[])},triggerEvent:function(e,t){var i=this.listeners[e];if(!i||0==i.length)return void 0;null==t&&(t={}),t.object=this.object,t.element=this.element,t.type||(t.type=e),i=i.slice();for(var s,n=0,r=i.length;r>n;n++){var a=i[n];if(s=a.func.apply(a.obj,[t]),void 0!=s&&0==s)break}return this.fallThrough||OpenLayers.Event.stop(t,!0),s},handleBrowserEvent:function(e){var t=e.type,i=this.listeners[t];if(i&&0!=i.length){var s=e.touches;if(s&&s[0]){for(var n,r=0,a=0,o=s.length,l=0;o>l;++l)n=s[l],r+=n.clientX,a+=n.clientY;e.clientX=r/o,e.clientY=a/o}this.includeXY&&(e.xy=this.getMousePosition(e)),this.triggerEvent(t,e)}},clearMouseCache:function(){this.element.scrolls=null,this.element.lefttop=null;var e=document.body;e&&(0==e.scrollTop&&0==e.scrollLeft||!navigator.userAgent.match(/iPhone/i))&&(this.element.offsets=null)},getMousePosition:function(e){if(this.includeXY?this.element.hasScrollEvent||(OpenLayers.Event.observe(window,"scroll",this.clearMouseListener),this.element.hasScrollEvent=!0):this.clearMouseCache(),!this.element.scrolls){var t=OpenLayers.Util.getViewportElement();this.element.scrolls=[t.scrollLeft,t.scrollTop]}return this.element.lefttop||(this.element.lefttop=[document.documentElement.clientLeft||0,document.documentElement.clientTop||0]),this.element.offsets||(this.element.offsets=OpenLayers.Util.pagePosition(this.element)),new OpenLayers.Pixel(e.clientX+this.element.scrolls[0]-this.element.offsets[0]-this.element.lefttop[0],e.clientY+this.element.scrolls[1]-this.element.offsets[1]-this.element.lefttop[1])},CLASS_NAME:"OpenLayers.Events"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.ProxyHost="",OpenLayers.Request={DEFAULT_CONFIG:{method:"GET",url:window.location.href,async:!0,user:void 0,password:void 0,params:null,proxy:OpenLayers.ProxyHost,headers:{},data:null,callback:function(){},success:null,failure:null,scope:null},URL_SPLIT_REGEX:/([^:]*:)\/\/([^:]*:?[^@]*@)?([^:\/\?]*):?([^\/\?]*)/,events:new OpenLayers.Events(this),makeSameOrigin:function(e,t){var i=0!==e.indexOf("http"),s=!i&&e.match(this.URL_SPLIT_REGEX);if(s){var n=window.location;i=s[1]==n.protocol&&s[3]==n.hostname;var r=s[4],a=n.port;(80!=r&&""!=r||"80"!=a&&""!=a)&&(i=i&&r==a)}return i||(t?e="function"==typeof t?t(e):t+encodeURIComponent(e):OpenLayers.Console.warn(OpenLayers.i18n("proxyNeeded"),{url:e})),e},issue:function(e){var t=OpenLayers.Util.extend(this.DEFAULT_CONFIG,{proxy:OpenLayers.ProxyHost});e=OpenLayers.Util.applyDefaults(e,t);var i,s=!1;for(i in e.headers)e.headers.hasOwnProperty(i)&&"x-requested-with"===i.toLowerCase()&&(s=!0);s===!1&&(e.headers["X-Requested-With"]="XMLHttpRequest");var n=new OpenLayers.Request.XMLHttpRequest,r=OpenLayers.Util.urlAppend(e.url,OpenLayers.Util.getParameterString(e.params||{}));r=OpenLayers.Request.makeSameOrigin(r,e.proxy),n.open(e.method,r,e.async,e.user,e.password);for(var a in e.headers)n.setRequestHeader(a,e.headers[a]);var o=this.events,l=this;return n.onreadystatechange=function(){if(n.readyState==OpenLayers.Request.XMLHttpRequest.DONE){var t=o.triggerEvent("complete",{request:n,config:e,requestUrl:r});t!==!1&&l.runCallbacks({request:n,config:e,requestUrl:r})}},e.async===!1?n.send(e.data):window.setTimeout(function(){0!==n.readyState&&n.send(e.data)},0),n},runCallbacks:function(e){var t,i=e.request,s=e.config,n=s.scope?OpenLayers.Function.bind(s.callback,s.scope):s.callback;s.success&&(t=s.scope?OpenLayers.Function.bind(s.success,s.scope):s.success);var r;s.failure&&(r=s.scope?OpenLayers.Function.bind(s.failure,s.scope):s.failure),"file:"==OpenLayers.Util.createUrlObject(s.url).protocol&&i.responseText&&(i.status=200),n(i),(!i.status||i.status>=200&&i.status<300)&&(this.events.triggerEvent("success",e),t&&t(i)),i.status&&(i.status<200||i.status>=300)&&(this.events.triggerEvent("failure",e),r&&r(i))},GET:function(e){return e=OpenLayers.Util.extend(e,{method:"GET"}),OpenLayers.Request.issue(e)},POST:function(e){return e=OpenLayers.Util.extend(e,{method:"POST"}),e.headers=e.headers?e.headers:{},"CONTENT-TYPE"in OpenLayers.Util.upperCaseObject(e.headers)||(e.headers["Content-Type"]="application/xml"),OpenLayers.Request.issue(e)},PUT:function(e){return e=OpenLayers.Util.extend(e,{method:"PUT"}),e.headers=e.headers?e.headers:{},"CONTENT-TYPE"in OpenLayers.Util.upperCaseObject(e.headers)||(e.headers["Content-Type"]="application/xml"),OpenLayers.Request.issue(e)},DELETE:function(e){return e=OpenLayers.Util.extend(e,{method:"DELETE"}),OpenLayers.Request.issue(e)},HEAD:function(e){return e=OpenLayers.Util.extend(e,{method:"HEAD"}),OpenLayers.Request.issue(e)},OPTIONS:function(e){return e=OpenLayers.Util.extend(e,{method:"OPTIONS"}),OpenLayers.Request.issue(e)}},// XMLHttpRequest.js Copyright (C) 2010 Sergey Ilinsky (http://www.ilinsky.com)
function(){function e(){this._object=o&&!u?new o:new window.ActiveXObject("Microsoft.XMLHTTP"),this._listeners=[]}function t(){return new e}function i(e){if(e._object.send(e._data),l&&!e._async)for(e.readyState=t.OPENED,r(e);e.readyState<t.DONE;)if(e.readyState++,s(e),e._aborted)return}function s(e){t.onreadystatechange&&t.onreadystatechange.apply(e),e.dispatchEvent({type:"readystatechange",bubbles:!1,cancelable:!1,timeStamp:new Date+0})}function n(e){var t=e.responseXML,i=e.responseText;return h&&i&&t&&!t.documentElement&&e.getResponseHeader("Content-Type").match(/[^\/]+\/[^\+]+\+xml/)&&(t=new window.ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.validateOnParse=!1,t.loadXML(i)),t&&(h&&0!=t.parseError||!t.documentElement||t.documentElement&&"parsererror"==t.documentElement.tagName)?null:t}function r(e){try{e.responseText=e._object.responseText}catch(t){}try{e.responseXML=n(e._object)}catch(t){}try{e.status=e._object.status}catch(t){}try{e.statusText=e._object.statusText}catch(t){}}function a(e){e._object.onreadystatechange=new window.Function}var o=window.XMLHttpRequest,l=!!window.controllers,h=window.document.all&&!window.opera,u=h&&window.navigator.userAgent.match(/MSIE 7.0/);t.prototype=e.prototype,l&&o.wrapped&&(t.wrapped=o.wrapped),t.UNSENT=0,t.OPENED=1,t.HEADERS_RECEIVED=2,t.LOADING=3,t.DONE=4,t.prototype.readyState=t.UNSENT,t.prototype.responseText="",t.prototype.responseXML=null,t.prototype.status=0,t.prototype.statusText="",t.prototype.priority="NORMAL",t.prototype.onreadystatechange=null,t.onreadystatechange=null,t.onopen=null,t.onsend=null,t.onabort=null,t.prototype.open=function(e,i,n,o,u){delete this._headers,arguments.length<3&&(n=!0),this._async=n;var c,d=this,p=this.readyState;h&&n&&(c=function(){p!=t.DONE&&(a(d),d.abort())},window.attachEvent("onunload",c)),t.onopen&&t.onopen.apply(this,arguments),arguments.length>4?this._object.open(e,i,n,o,u):arguments.length>3?this._object.open(e,i,n,o):this._object.open(e,i,n),this.readyState=t.OPENED,s(this),this._object.onreadystatechange=function(){if(!l||n){if(d.readyState=d._object.readyState,r(d),d._aborted)return d.readyState=t.UNSENT,void 0;d.readyState==t.DONE&&(delete d._data,a(d),h&&n&&window.detachEvent("onunload",c)),p!=d.readyState&&s(d),p=d.readyState}}},t.prototype.send=function(e){t.onsend&&t.onsend.apply(this,arguments),arguments.length||(e=null),e&&e.nodeType&&(e=window.XMLSerializer?(new window.XMLSerializer).serializeToString(e):e.xml,this._headers["Content-Type"]||this._object.setRequestHeader("Content-Type","application/xml")),this._data=e,i(this)},t.prototype.abort=function(){t.onabort&&t.onabort.apply(this,arguments),this.readyState>t.UNSENT&&(this._aborted=!0),this._object.abort(),a(this),this.readyState=t.UNSENT,delete this._data},t.prototype.getAllResponseHeaders=function(){return this._object.getAllResponseHeaders()},t.prototype.getResponseHeader=function(e){return this._object.getResponseHeader(e)},t.prototype.setRequestHeader=function(e,t){return this._headers||(this._headers={}),this._headers[e]=t,this._object.setRequestHeader(e,t)},t.prototype.addEventListener=function(e,t,i){for(var s,n=0;s=this._listeners[n];n++)if(s[0]==e&&s[1]==t&&s[2]==i)return;this._listeners.push([e,t,i])},t.prototype.removeEventListener=function(e,t,i){for(var s,n=0;(s=this._listeners[n])&&(s[0]!=e||s[1]!=t||s[2]!=i);n++);s&&this._listeners.splice(n,1)},t.prototype.dispatchEvent=function(e){var t={type:e.type,target:this,currentTarget:this,eventPhase:2,bubbles:e.bubbles,cancelable:e.cancelable,timeStamp:e.timeStamp,stopPropagation:function(){},preventDefault:function(){},initEvent:function(){}};"readystatechange"==t.type&&this.onreadystatechange&&(this.onreadystatechange.handleEvent||this.onreadystatechange).apply(this,[t]);for(var i,s=0;i=this._listeners[s];s++)i[0]!=t.type||i[2]||(i[1].handleEvent||i[1]).apply(this,[t])},t.prototype.toString=function(){return"[object XMLHttpRequest]"},t.toString=function(){return"[XMLHttpRequest]"},window.Function.prototype.apply||(window.Function.prototype.apply=function(e,t){t||(t=[]),e.__func=this,e.__func(t[0],t[1],t[2],t[3],t[4]),delete e.__func}),OpenLayers.Request.XMLHttpRequest=t}(),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.KML=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{kml:"http://www.opengis.net/kml/2.2",gx:"http://www.google.com/kml/ext/2.2"},kmlns:"http://earth.google.com/kml/2.0",placemarksDesc:"No description available",foldersName:"OpenLayers export",foldersDesc:"Exported on "+new Date,extractAttributes:!0,kvpAttributes:!1,extractStyles:!1,extractTracks:!1,trackAttributes:null,internalns:null,features:null,styles:null,styleBaseUrl:"",fetched:null,maxDepth:0,initialize:function(e){this.regExes={trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g,kmlColor:/(\w{2})(\w{2})(\w{2})(\w{2})/,kmlIconPalette:/root:\/\/icons\/palette-(\d+)(\.\w+)/,straightBracket:/\$\[(.*?)\]/g},this.externalProjection=new OpenLayers.Projection("EPSG:4326"),OpenLayers.Format.XML.prototype.initialize.apply(this,[e])},read:function(e){this.features=[],this.styles={},this.fetched={};var t={depth:0,styleBaseUrl:this.styleBaseUrl};return this.parseData(e,t)},parseData:function(e,t){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e]));for(var i=["Link","NetworkLink","Style","StyleMap","Placemark"],s=0,n=i.length;n>s;++s){var r=i[s],a=this.getElementsByTagNameNS(e,"*",r);if(0!=a.length)switch(r.toLowerCase()){case"link":case"networklink":this.parseLinks(a,t);break;case"style":this.extractStyles&&this.parseStyles(a,t);break;case"stylemap":this.extractStyles&&this.parseStyleMaps(a,t);break;case"placemark":this.parseFeatures(a,t)}}return this.features},parseLinks:function(e,t){if(t.depth>=this.maxDepth)return!1;var i=OpenLayers.Util.extend({},t);i.depth++;for(var s=0,n=e.length;n>s;s++){var r=this.parseProperty(e[s],"*","href");if(r&&!this.fetched[r]){this.fetched[r]=!0;var a=this.fetchLink(r);a&&this.parseData(a,i)}}},fetchLink:function(e){var t=OpenLayers.Request.GET({url:e,async:!1});return t?t.responseText:void 0},parseStyles:function(e,t){for(var i=0,s=e.length;s>i;i++){var n=this.parseStyle(e[i]);if(n){var r=(t.styleBaseUrl||"")+"#"+n.id;this.styles[r]=n}}},parseKmlColor:function(e){var t=null;if(e){var i=e.match(this.regExes.kmlColor);i&&(t={color:"#"+i[4]+i[3]+i[2],opacity:parseInt(i[1],16)/255})}return t},parseStyle:function(e){for(var t,i,s={},n=["LineStyle","PolyStyle","IconStyle","BalloonStyle","LabelStyle"],r=0,a=n.length;a>r;++r)if(t=n[r],i=this.getElementsByTagNameNS(e,"*",t)[0])switch(t.toLowerCase()){case"linestyle":var o=this.parseProperty(i,"*","color"),l=this.parseKmlColor(o);l&&(s.strokeColor=l.color,s.strokeOpacity=l.opacity);var h=this.parseProperty(i,"*","width");h&&(s.strokeWidth=h);break;case"polystyle":var o=this.parseProperty(i,"*","color"),l=this.parseKmlColor(o);l&&(s.fillOpacity=l.opacity,s.fillColor=l.color);var u=this.parseProperty(i,"*","fill");"0"==u&&(s.fillColor="none");var c=this.parseProperty(i,"*","outline");"0"==c&&(s.strokeWidth="0");break;case"iconstyle":var d=parseFloat(this.parseProperty(i,"*","scale")||1),h=32*d,p=32*d,f=this.getElementsByTagNameNS(i,"*","Icon")[0];if(f){var m=this.parseProperty(f,"*","href");if(m){var y=this.parseProperty(f,"*","w"),g=this.parseProperty(f,"*","h"),v="http://maps.google.com/mapfiles/kml";!OpenLayers.String.startsWith(m,v)||y||g||(y=64,g=64,d/=2),y=y||g,g=g||y,y&&(h=parseInt(y)*d),g&&(p=parseInt(g)*d);var x=m.match(this.regExes.kmlIconPalette);if(x){var E=x[1],b=x[2],L=this.parseProperty(f,"*","x"),S=this.parseProperty(f,"*","y"),C=L?L/32:0,w=S?7-S/32:7,O=8*w+C;m="http://maps.google.com/mapfiles/kml/pal"+E+"/icon"+O+b}s.graphicOpacity=1,s.externalGraphic=m}}var T=this.getElementsByTagNameNS(i,"*","hotSpot")[0];if(T){var L=parseFloat(T.getAttribute("x")),S=parseFloat(T.getAttribute("y")),M=T.getAttribute("xunits");"pixels"==M?s.graphicXOffset=-L*d:"insetPixels"==M?s.graphicXOffset=-h+L*d:"fraction"==M&&(s.graphicXOffset=-h*L);var P=T.getAttribute("yunits");"pixels"==P?s.graphicYOffset=-p+S*d+1:"insetPixels"==P?s.graphicYOffset=-(S*d)+1:"fraction"==P&&(s.graphicYOffset=-p*(1-S)+1)}s.graphicWidth=h,s.graphicHeight=p;break;case"balloonstyle":var N=OpenLayers.Util.getXmlNodeValue(i);N&&(s.balloonStyle=N.replace(this.regExes.straightBracket,"${$1}"));break;case"labelstyle":var o=this.parseProperty(i,"*","color"),l=this.parseKmlColor(o);l&&(s.fontColor=l.color,s.fontOpacity=l.opacity)}!s.strokeColor&&s.fillColor&&(s.strokeColor=s.fillColor);var D=e.getAttribute("id");return D&&s&&(s.id=D),s},parseStyleMaps:function(e,t){for(var i=0,s=e.length;s>i;i++)for(var n=e[i],r=this.getElementsByTagNameNS(n,"*","Pair"),a=n.getAttribute("id"),o=0,l=r.length;l>o;o++){var h=r[o],u=this.parseProperty(h,"*","key"),c=this.parseProperty(h,"*","styleUrl");c&&"normal"==u&&(this.styles[(t.styleBaseUrl||"")+"#"+a]=this.styles[(t.styleBaseUrl||"")+c])}},parseFeatures:function(e,t){for(var i=[],s=0,n=e.length;n>s;s++){var r=e[s],a=this.parseFeature.apply(this,[r]);if(!a)throw"Bad Placemark: "+s;if(this.extractStyles&&a.attributes&&a.attributes.styleUrl&&(a.style=this.getStyle(a.attributes.styleUrl,t)),this.extractStyles){var o=this.getElementsByTagNameNS(r,"*","Style")[0];if(o){var l=this.parseStyle(o);l&&(a.style=OpenLayers.Util.extend(a.style,l))}}if(this.extractTracks){var h=this.getElementsByTagNameNS(r,this.namespaces.gx,"Track");if(h&&h.length>0){var u=h[0],c={features:[],feature:a};this.readNode(u,c),c.features.length>0&&i.push.apply(i,c.features)}}else i.push(a)}this.features=this.features.concat(i)},readers:{kml:{when:function(e,t){t.whens.push(OpenLayers.Date.parse(this.getChildValue(e)))},_trackPointAttribute:function(e,t){var i=e.nodeName.split(":").pop();t.attributes[i].push(this.getChildValue(e))}},gx:{Track:function(e,t){var i={whens:[],points:[],angles:[]};if(this.trackAttributes){var s;i.attributes={};for(var n=0,r=this.trackAttributes.length;r>n;++n)s=this.trackAttributes[n],i.attributes[s]=[],s in this.readers.kml||(this.readers.kml[s]=this.readers.kml._trackPointAttribute)}if(this.readChildNodes(e,i),i.whens.length!==i.points.length)throw new Error("gx:Track with unequal number of when ("+i.whens.length+") and gx:coord ("+i.points.length+") elements.");var a=i.angles.length>0;if(a&&i.whens.length!==i.angles.length)throw new Error("gx:Track with unequal number of when ("+i.whens.length+") and gx:angles ("+i.angles.length+") elements.");for(var o,l,h,n=0,r=i.whens.length;r>n;++n){if(o=t.feature.clone(),o.fid=t.feature.fid||t.feature.id,l=i.points[n],o.geometry=l,"z"in l&&(o.attributes.altitude=l.z),this.internalProjection&&this.externalProjection&&o.geometry.transform(this.externalProjection,this.internalProjection),this.trackAttributes)for(var u=0,c=this.trackAttributes.length;c>u;++u)o.attributes[s]=i.attributes[this.trackAttributes[u]][n];o.attributes.when=i.whens[n],o.attributes.trackId=t.feature.id,a&&(h=i.angles[n],o.attributes.heading=parseFloat(h[0]),o.attributes.tilt=parseFloat(h[1]),o.attributes.roll=parseFloat(h[2])),t.features.push(o)}},coord:function(e,t){var i=this.getChildValue(e),s=i.replace(this.regExes.trimSpace,"").split(/\s+/),n=new OpenLayers.Geometry.Point(s[0],s[1]);s.length>2&&(n.z=parseFloat(s[2])),t.points.push(n)},angles:function(e,t){var i=this.getChildValue(e),s=i.replace(this.regExes.trimSpace,"").split(/\s+/);t.angles.push(s)}}},parseFeature:function(e){for(var t,i,s,n,r=["MultiGeometry","Polygon","LineString","Point"],a=0,o=r.length;o>a;++a)if(t=r[a],this.internalns=e.namespaceURI?e.namespaceURI:this.kmlns,i=this.getElementsByTagNameNS(e,this.internalns,t),i.length>0){var n=this.parseGeometry[t.toLowerCase()];if(!n)throw new TypeError("Unsupported geometry type: "+t);s=n.apply(this,[i[0]]),this.internalProjection&&this.externalProjection&&s.transform(this.externalProjection,this.internalProjection);break}var l;this.extractAttributes&&(l=this.parseAttributes(e));var h=new OpenLayers.Feature.Vector(s,l),u=e.getAttribute("id")||e.getAttribute("name");return null!=u&&(h.fid=u),h},getStyle:function(e,t){var i=OpenLayers.Util.removeTail(e),s=OpenLayers.Util.extend({},t);if(s.depth++,s.styleBaseUrl=i,!this.styles[e]&&!OpenLayers.String.startsWith(e,"#")&&s.depth<=this.maxDepth&&!this.fetched[i]){var n=this.fetchLink(i);n&&this.parseData(n,s)}var r=OpenLayers.Util.extend({},this.styles[e]);return r},parseGeometry:{point:function(e){var t=this.getElementsByTagNameNS(e,this.internalns,"coordinates"),i=[];if(t.length>0){var s=t[0].firstChild.nodeValue;s=s.replace(this.regExes.removeSpace,""),i=s.split(",")}var n=null;if(!(i.length>1))throw"Bad coordinate string: "+s;return 2==i.length&&(i[2]=null),n=new OpenLayers.Geometry.Point(i[0],i[1],i[2])},linestring:function(e,t){var i=this.getElementsByTagNameNS(e,this.internalns,"coordinates"),s=null;if(i.length>0){var n=this.getChildValue(i[0]);n=n.replace(this.regExes.trimSpace,""),n=n.replace(this.regExes.trimComma,",");for(var r,a,o=n.split(this.regExes.splitSpace),l=o.length,h=new Array(l),u=0;l>u;++u){if(r=o[u].split(","),a=r.length,!(a>1))throw"Bad LineString point coordinates: "+o[u];2==r.length&&(r[2]=null),h[u]=new OpenLayers.Geometry.Point(r[0],r[1],r[2])}if(!l)throw"Bad LineString coordinates: "+n;s=t?new OpenLayers.Geometry.LinearRing(h):new OpenLayers.Geometry.LineString(h)}return s},polygon:function(e){var t=this.getElementsByTagNameNS(e,this.internalns,"LinearRing"),i=t.length,s=new Array(i);if(i>0)for(var n,r=0,a=t.length;a>r;++r){if(n=this.parseGeometry.linestring.apply(this,[t[r],!0]),!n)throw"Bad LinearRing geometry: "+r;s[r]=n}return new OpenLayers.Geometry.Polygon(s)},multigeometry:function(e){for(var t,i,s=[],n=e.childNodes,r=0,a=n.length;a>r;++r)if(t=n[r],1==t.nodeType){var o=t.prefix?t.nodeName.split(":")[1]:t.nodeName,i=this.parseGeometry[o.toLowerCase()];i&&s.push(i.apply(this,[t]))}return new OpenLayers.Geometry.Collection(s)}},parseAttributes:function(e){var t={},i=e.getElementsByTagName("ExtendedData");i.length&&(t=this.parseExtendedData(i[0]));for(var s,n,r,a=e.childNodes,o=0,l=a.length;l>o;++o)if(s=a[o],1==s.nodeType&&(n=s.childNodes,n.length>=1&&n.length<=3)){var r;switch(n.length){case 1:r=n[0];break;case 2:var h=n[0],u=n[1];r=3==h.nodeType||4==h.nodeType?h:u;break;case 3:default:r=n[1]}if(3==r.nodeType||4==r.nodeType){var c=s.prefix?s.nodeName.split(":")[1]:s.nodeName,d=OpenLayers.Util.getXmlNodeValue(r);d&&(d=d.replace(this.regExes.trimSpace,""),t[c]=d)}}return t},parseExtendedData:function(e){var t,i,s,n,r={},a=e.getElementsByTagName("Data");for(t=0,i=a.length;i>t;t++){s=a[t],n=s.getAttribute("name");var o={},l=s.getElementsByTagName("value");if(l.length&&(o.value=this.getChildValue(l[0])),this.kvpAttributes)r[n]=o.value;else{var h=s.getElementsByTagName("displayName");h.length&&(o.displayName=this.getChildValue(h[0])),r[n]=o}}var u=e.getElementsByTagName("SimpleData");for(t=0,i=u.length;i>t;t++){var o={};s=u[t],n=s.getAttribute("name"),o.value=this.getChildValue(s),this.kvpAttributes?r[n]=o.value:(o.displayName=n,r[n]=o)}return r},parseProperty:function(e,t,i){var s,n=this.getElementsByTagNameNS(e,t,i);try{s=OpenLayers.Util.getXmlNodeValue(n[0])}catch(r){s=null}return s},write:function(e){OpenLayers.Util.isArray(e)||(e=[e]);for(var t=this.createElementNS(this.kmlns,"kml"),i=this.createFolderXML(),s=0,n=e.length;n>s;++s)i.appendChild(this.createPlacemarkXML(e[s]));return t.appendChild(i),OpenLayers.Format.XML.prototype.write.apply(this,[t])},createFolderXML:function(){var e=this.createElementNS(this.kmlns,"Folder");if(this.foldersName){var t=this.createElementNS(this.kmlns,"name"),i=this.createTextNode(this.foldersName);t.appendChild(i),e.appendChild(t)}if(this.foldersDesc){var s=this.createElementNS(this.kmlns,"description"),n=this.createTextNode(this.foldersDesc);s.appendChild(n),e.appendChild(s)}return e},createPlacemarkXML:function(e){var t=this.createElementNS(this.kmlns,"name"),i=e.style&&e.style.label?e.style.label:e.attributes.name||e.id;t.appendChild(this.createTextNode(i));var s=this.createElementNS(this.kmlns,"description"),n=e.attributes.description||this.placemarksDesc;s.appendChild(this.createTextNode(n));var r=this.createElementNS(this.kmlns,"Placemark");null!=e.fid&&r.setAttribute("id",e.fid),r.appendChild(t),r.appendChild(s);var a=this.buildGeometryNode(e.geometry);if(r.appendChild(a),e.attributes){var o=this.buildExtendedData(e.attributes);o&&r.appendChild(o)}return r},buildGeometryNode:function(e){var t=e.CLASS_NAME,i=t.substring(t.lastIndexOf(".")+1),s=this.buildGeometry[i.toLowerCase()],n=null;return s&&(n=s.apply(this,[e])),n},buildGeometry:{point:function(e){var t=this.createElementNS(this.kmlns,"Point");return t.appendChild(this.buildCoordinatesNode(e)),t},multipoint:function(e){return this.buildGeometry.collection.apply(this,[e])},linestring:function(e){var t=this.createElementNS(this.kmlns,"LineString");return t.appendChild(this.buildCoordinatesNode(e)),t},multilinestring:function(e){return this.buildGeometry.collection.apply(this,[e])},linearring:function(e){var t=this.createElementNS(this.kmlns,"LinearRing");return t.appendChild(this.buildCoordinatesNode(e)),t},polygon:function(e){for(var t,i,s,n=this.createElementNS(this.kmlns,"Polygon"),r=e.components,a=0,o=r.length;o>a;++a)s=0==a?"outerBoundaryIs":"innerBoundaryIs",t=this.createElementNS(this.kmlns,s),i=this.buildGeometry.linearring.apply(this,[r[a]]),t.appendChild(i),n.appendChild(t);return n},multipolygon:function(e){return this.buildGeometry.collection.apply(this,[e])},collection:function(e){for(var t,i=this.createElementNS(this.kmlns,"MultiGeometry"),s=0,n=e.components.length;n>s;++s)t=this.buildGeometryNode.apply(this,[e.components[s]]),t&&i.appendChild(t);return i}},buildCoordinatesNode:function(e){var t,i=this.createElementNS(this.kmlns,"coordinates"),s=e.components;if(s){for(var n,r=s.length,a=new Array(r),o=0;r>o;++o)n=s[o],a[o]=this.buildCoordinates(n);t=a.join(" ")}else t=this.buildCoordinates(e);var l=this.createTextNode(t);return i.appendChild(l),i},buildCoordinates:function(e){return this.internalProjection&&this.externalProjection&&(e=e.clone(),e.transform(this.internalProjection,this.externalProjection)),e.x+","+e.y},buildExtendedData:function(e){var t=this.createElementNS(this.kmlns,"ExtendedData");for(var i in e)if(e[i]&&"name"!=i&&"description"!=i&&"styleUrl"!=i){var s=this.createElementNS(this.kmlns,"Data");s.setAttribute("name",i);var n=this.createElementNS(this.kmlns,"value");if("object"==typeof e[i]){if(e[i].value&&n.appendChild(this.createTextNode(e[i].value)),e[i].displayName){var r=this.createElementNS(this.kmlns,"displayName");r.appendChild(this.getXMLDoc().createCDATASection(e[i].displayName)),s.appendChild(r)}}else n.appendChild(this.createTextNode(e[i]));s.appendChild(n),t.appendChild(s)}return this.isSimpleContent(t)?null:t},CLASS_NAME:"OpenLayers.Format.KML"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Geometry.MultiLineString=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LineString"],split:function(e,t){for(var i,s,n,r,a,o=null,l=t&&t.mutual,h=[],u=[e],c=0,d=this.components.length;d>c;++c){s=this.components[c],r=!1;for(var p=0;p<u.length;++p)if(i=s.split(u[p],t)){if(l){n=i[0];for(var f=0,m=n.length;m>f;++f)0===f&&h.length?h[h.length-1].addComponent(n[f]):h.push(new OpenLayers.Geometry.MultiLineString([n[f]]));r=!0,i=i[1]}if(i.length){i.unshift(p,1),Array.prototype.splice.apply(u,i);break}}r||(h.length?h[h.length-1].addComponent(s.clone()):h=[new OpenLayers.Geometry.MultiLineString(s.clone())])}return h&&h.length>1?r=!0:h=[],u&&u.length>1?a=!0:u=[],(r||a)&&(o=l?[h,u]:u),o},splitWith:function(e,t){var i,s,n,r,a,o,l,h=null,u=t&&t.mutual;if(e instanceof OpenLayers.Geometry.LineString){l=[],o=[e];for(var c=0,d=this.components.length;d>c;++c){a=!1,s=this.components[c];for(var p=0;p<o.length;++p)if(i=o[p].split(s,t)){u&&(n=i[0],n.length&&(n.unshift(p,1),Array.prototype.splice.apply(o,n),p+=n.length-2),i=i[1],0===i.length&&(i=[s.clone()]));for(var f=0,m=i.length;m>f;++f)0===f&&l.length?l[l.length-1].addComponent(i[f]):l.push(new OpenLayers.Geometry.MultiLineString([i[f]]));a=!0}a||(l.length?l[l.length-1].addComponent(s.clone()):l=[new OpenLayers.Geometry.MultiLineString([s.clone()])])}}else h=e.split(this);return o&&o.length>1?r=!0:o=[],l&&l.length>1?a=!0:l=[],(r||a)&&(h=u?[o,l]:l),h},CLASS_NAME:"OpenLayers.Geometry.MultiLineString"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Geometry.MultiPolygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Polygon"],CLASS_NAME:"OpenLayers.Geometry.MultiPolygon"}),/* Copyright (c) 2006-2013 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.GML=OpenLayers.Class(OpenLayers.Format.XML,{featureNS:"http://mapserver.gis.umn.edu/mapserver",featurePrefix:"feature",featureName:"featureMember",layerName:"features",geometryName:"geometry",collectionName:"FeatureCollection",gmlns:"http://www.opengis.net/gml",extractAttributes:!0,xy:!0,initialize:function(e){this.regExes={trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},OpenLayers.Format.XML.prototype.initialize.apply(this,[e])},read:function(e){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e]));for(var t=this.getElementsByTagNameNS(e.documentElement,this.gmlns,this.featureName),i=[],s=0;s<t.length;s++){var n=this.parseFeature(t[s]);n&&i.push(n)}return i},parseFeature:function(e){for(var t,i,s,n,r=["MultiPolygon","Polygon","MultiLineString","LineString","MultiPoint","Point","Envelope"],a=0;a<r.length;++a)if(t=r[a],i=this.getElementsByTagNameNS(e,this.gmlns,t),i.length>0){if(n=this.parseGeometry[t.toLowerCase()],!n)throw new TypeError("Unsupported geometry type: "+t);s=n.apply(this,[i[0]]),this.internalProjection&&this.externalProjection&&s.transform(this.externalProjection,this.internalProjection);break}var o,l=this.getElementsByTagNameNS(e,this.gmlns,"Box");for(a=0;a<l.length;++a){var h=l[a],u=this.parseGeometry.box.apply(this,[h]),c=h.parentNode,d=c.localName||c.nodeName.split(":").pop();"boundedBy"===d?o=u:s=u.toGeometry()}var p;this.extractAttributes&&(p=this.parseAttributes(e));var f=new OpenLayers.Feature.Vector(s,p);f.bounds=o,f.gml={featureType:e.firstChild.nodeName.split(":")[1],featureNS:e.firstChild.namespaceURI,featureNSPrefix:e.firstChild.prefix};for(var m,y=e.firstChild;y&&(1!=y.nodeType||!(m=y.getAttribute("fid")||y.getAttribute("id")));)y=y.nextSibling;return f.fid=m,f},parseGeometry:{point:function(e){var t,i,s=[],t=this.getElementsByTagNameNS(e,this.gmlns,"pos");if(t.length>0&&(i=t[0].firstChild.nodeValue,i=i.replace(this.regExes.trimSpace,""),s=i.split(this.regExes.splitSpace)),0==s.length&&(t=this.getElementsByTagNameNS(e,this.gmlns,"coordinates"),t.length>0&&(i=t[0].firstChild.nodeValue,i=i.replace(this.regExes.removeSpace,""),s=i.split(","))),0==s.length&&(t=this.getElementsByTagNameNS(e,this.gmlns,"coord"),t.length>0)){var n=this.getElementsByTagNameNS(t[0],this.gmlns,"X"),r=this.getElementsByTagNameNS(t[0],this.gmlns,"Y");n.length>0&&r.length>0&&(s=[n[0].firstChild.nodeValue,r[0].firstChild.nodeValue])}return 2==s.length&&(s[2]=null),this.xy?new OpenLayers.Geometry.Point(s[0],s[1],s[2]):new OpenLayers.Geometry.Point(s[1],s[0],s[2])},multipoint:function(e){var t=this.getElementsByTagNameNS(e,this.gmlns,"Point"),i=[];if(t.length>0)for(var s,n=0;n<t.length;++n)s=this.parseGeometry.point.apply(this,[t[n]]),s&&i.push(s);return new OpenLayers.Geometry.MultiPoint(i)},linestring:function(e,t){var i,s,n=[],r=[];if(i=this.getElementsByTagNameNS(e,this.gmlns,"posList"),i.length>0){s=this.getChildValue(i[0]),s=s.replace(this.regExes.trimSpace,""),n=s.split(this.regExes.splitSpace);for(var a,o,l,h,u=parseInt(i[0].getAttribute("dimension")),c=0;c<n.length/u;++c)a=c*u,o=n[a],l=n[a+1],h=2==u?null:n[a+2],this.xy?r.push(new OpenLayers.Geometry.Point(o,l,h)):r.push(new OpenLayers.Geometry.Point(l,o,h))}if(0==n.length&&(i=this.getElementsByTagNameNS(e,this.gmlns,"coordinates"),i.length>0)){s=this.getChildValue(i[0]),s=s.replace(this.regExes.trimSpace,""),s=s.replace(this.regExes.trimComma,",");for(var d=s.split(this.regExes.splitSpace),c=0;c<d.length;++c)n=d[c].split(","),2==n.length&&(n[2]=null),this.xy?r.push(new OpenLayers.Geometry.Point(n[0],n[1],n[2])):r.push(new OpenLayers.Geometry.Point(n[1],n[0],n[2]))}var p=null;return 0!=r.length&&(p=t?new OpenLayers.Geometry.LinearRing(r):new OpenLayers.Geometry.LineString(r)),p},multilinestring:function(e){var t=this.getElementsByTagNameNS(e,this.gmlns,"LineString"),i=[];if(t.length>0)for(var s,n=0;n<t.length;++n)s=this.parseGeometry.linestring.apply(this,[t[n]]),s&&i.push(s);return new OpenLayers.Geometry.MultiLineString(i)},polygon:function(e){var t=this.getElementsByTagNameNS(e,this.gmlns,"LinearRing"),i=[];if(t.length>0)for(var s,n=0;n<t.length;++n)s=this.parseGeometry.linestring.apply(this,[t[n],!0]),s&&i.push(s);return new OpenLayers.Geometry.Polygon(i)},multipolygon:function(e){var t=this.getElementsByTagNameNS(e,this.gmlns,"Polygon"),i=[];if(t.length>0)for(var s,n=0;n<t.length;++n)s=this.parseGeometry.polygon.apply(this,[t[n]]),s&&i.push(s);return new OpenLayers.Geometry.MultiPolygon(i)},envelope:function(e){var t,i,s=[],n=this.getElementsByTagNameNS(e,this.gmlns,"lowerCorner");if(n.length>0){var r=[];if(n.length>0&&(t=n[0].firstChild.nodeValue,t=t.replace(this.regExes.trimSpace,""),r=t.split(this.regExes.splitSpace)),2==r.length&&(r[2]=null),this.xy)var a=new OpenLayers.Geometry.Point(r[0],r[1],r[2]);else var a=new OpenLayers.Geometry.Point(r[1],r[0],r[2])}var o=this.getElementsByTagNameNS(e,this.gmlns,"upperCorner");if(o.length>0){var r=[];if(o.length>0&&(t=o[0].firstChild.nodeValue,t=t.replace(this.regExes.trimSpace,""),r=t.split(this.regExes.splitSpace)),2==r.length&&(r[2]=null),this.xy)var l=new OpenLayers.Geometry.Point(r[0],r[1],r[2]);else var l=new OpenLayers.Geometry.Point(r[1],r[0],r[2])}if(a&&l){s.push(new OpenLayers.Geometry.Point(a.x,a.y)),s.push(new OpenLayers.Geometry.Point(l.x,a.y)),s.push(new OpenLayers.Geometry.Point(l.x,l.y)),s.push(new OpenLayers.Geometry.Point(a.x,l.y)),s.push(new OpenLayers.Geometry.Point(a.x,a.y));var h=new OpenLayers.Geometry.LinearRing(s);i=new OpenLayers.Geometry.Polygon([h])}return i},box:function(e){var t,i,s=this.getElementsByTagNameNS(e,this.gmlns,"coordinates"),n=null,r=null;return s.length>0&&(t=s[0].firstChild.nodeValue,i=t.split(" "),2==i.length&&(n=i[0].split(","),r=i[1].split(","))),null!==n&&null!==r?new OpenLayers.Bounds(parseFloat(n[0]),parseFloat(n[1]),parseFloat(r[0]),parseFloat(r[1])):void 0}},parseAttributes:function(e){for(var t,i,s,n,r,a,o,l={},h=e.firstChild;h;){if(1==h.nodeType){for(t=h.childNodes,i=0;i<t.length;++i)s=t[i],1==s.nodeType&&(n=s.childNodes,1==n.length?(r=n[0],(3==r.nodeType||4==r.nodeType)&&(a=s.prefix?s.nodeName.split(":")[1]:s.nodeName,o=r.nodeValue.replace(this.regExes.trimSpace,""),l[a]=o)):l[s.nodeName.split(":").pop()]=null);break}h=h.nextSibling}return l},write:function(e){OpenLayers.Util.isArray(e)||(e=[e]);for(var t=this.createElementNS("http://www.opengis.net/wfs","wfs:"+this.collectionName),i=0;i<e.length;i++)t.appendChild(this.createFeatureXML(e[i]));return OpenLayers.Format.XML.prototype.write.apply(this,[t])},createFeatureXML:function(e){var t=e.geometry,i=this.buildGeometryNode(t),s=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.geometryName);s.appendChild(i);var n=this.createElementNS(this.gmlns,"gml:"+this.featureName),r=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.layerName),a=e.fid||e.id;r.setAttribute("fid",a),r.appendChild(s);for(var o in e.attributes){var l=this.createTextNode(e.attributes[o]),h=o.substring(o.lastIndexOf(":")+1),u=this.createElementNS(this.featureNS,this.featurePrefix+":"+h);u.appendChild(l),r.appendChild(u)}return n.appendChild(r),n},buildGeometryNode:function(e){this.externalProjection&&this.internalProjection&&(e=e.clone(),e.transform(this.internalProjection,this.externalProjection));var t=e.CLASS_NAME,i=t.substring(t.lastIndexOf(".")+1),s=this.buildGeometry[i.toLowerCase()];return s.apply(this,[e])},buildGeometry:{point:function(e){var t=this.createElementNS(this.gmlns,"gml:Point");return t.appendChild(this.buildCoordinatesNode(e)),t},multipoint:function(e){for(var t,i,s=this.createElementNS(this.gmlns,"gml:MultiPoint"),n=e.components,r=0;r<n.length;r++)t=this.createElementNS(this.gmlns,"gml:pointMember"),i=this.buildGeometry.point.apply(this,[n[r]]),t.appendChild(i),s.appendChild(t);return s},linestring:function(e){var t=this.createElementNS(this.gmlns,"gml:LineString");return t.appendChild(this.buildCoordinatesNode(e)),t},multilinestring:function(e){for(var t,i,s=this.createElementNS(this.gmlns,"gml:MultiLineString"),n=e.components,r=0;r<n.length;++r)t=this.createElementNS(this.gmlns,"gml:lineStringMember"),i=this.buildGeometry.linestring.apply(this,[n[r]]),t.appendChild(i),s.appendChild(t);return s},linearring:function(e){var t=this.createElementNS(this.gmlns,"gml:LinearRing");return t.appendChild(this.buildCoordinatesNode(e)),t},polygon:function(e){for(var t,i,s,n=this.createElementNS(this.gmlns,"gml:Polygon"),r=e.components,a=0;a<r.length;++a)s=0==a?"outerBoundaryIs":"innerBoundaryIs",t=this.createElementNS(this.gmlns,"gml:"+s),i=this.buildGeometry.linearring.apply(this,[r[a]]),t.appendChild(i),n.appendChild(t);return n},multipolygon:function(e){for(var t,i,s=this.createElementNS(this.gmlns,"gml:MultiPolygon"),n=e.components,r=0;r<n.length;++r)t=this.createElementNS(this.gmlns,"gml:polygonMember"),i=this.buildGeometry.polygon.apply(this,[n[r]]),t.appendChild(i),s.appendChild(t);return s},bounds:function(e){var t=this.createElementNS(this.gmlns,"gml:Box");return t.appendChild(this.buildCoordinatesNode(e)),t}},buildCoordinatesNode:function(e){var t=this.createElementNS(this.gmlns,"gml:coordinates");t.setAttribute("decimal","."),t.setAttribute("cs",","),t.setAttribute("ts"," ");var i=[];if(e instanceof OpenLayers.Bounds)i.push(e.left+","+e.bottom),i.push(e.right+","+e.top);else for(var s=e.components?e.components:[e],n=0;n<s.length;n++)i.push(s[n].x+","+s[n].y);var r=this.createTextNode(i.join(" "));return t.appendChild(r),t},CLASS_NAME:"OpenLayers.Format.GML"}),/* Copyright (c) 2006-2013 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.GML||(OpenLayers.Format.GML={}),OpenLayers.Format.GML.Base=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",wfs:"http://www.opengis.net/wfs"},defaultPrefix:"gml",schemaLocation:null,featureType:null,featureNS:null,geometryName:"geometry",extractAttributes:!0,srsName:null,xy:!0,geometryTypes:null,singleFeatureType:null,regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g,featureMember:/^(.*:)?featureMembers?$/},initialize:function(e){OpenLayers.Format.XML.prototype.initialize.apply(this,[e]),this.setGeometryTypes(),e&&e.featureNS&&this.setNamespace("feature",e.featureNS),this.singleFeatureType=!e||"string"==typeof e.featureType},read:function(e){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e])),e&&9==e.nodeType&&(e=e.documentElement);var t=[];if(this.readNode(e,{features:t},!0),0==t.length){var i=this.getElementsByTagNameNS(e,this.namespaces.gml,"featureMember");if(i.length)for(var s=0,n=i.length;n>s;++s)this.readNode(i[s],{features:t},!0);else{var i=this.getElementsByTagNameNS(e,this.namespaces.gml,"featureMembers");i.length&&this.readNode(i[0],{features:t},!0)}}return t},readNode:function(e,t,i){return i===!0&&this.autoConfig===!0&&(this.featureType=null,delete this.namespaceAlias[this.featureNS],delete this.namespaces.feature,this.featureNS=null),this.featureNS||e.prefix in this.namespaces||e.parentNode.namespaceURI!=this.namespaces.gml||!this.regExes.featureMember.test(e.parentNode.nodeName)||(this.featureType=e.nodeName.split(":").pop(),this.setNamespace("feature",e.namespaceURI),this.featureNS=e.namespaceURI,this.autoConfig=!0),OpenLayers.Format.XML.prototype.readNode.apply(this,[e,t])},readers:{gml:{_inherit:function(){},featureMember:function(e,t){this.readChildNodes(e,t)},featureMembers:function(e,t){this.readChildNodes(e,t)},name:function(e,t){t.name=this.getChildValue(e)},boundedBy:function(e,t){var i={};this.readChildNodes(e,i),i.components&&i.components.length>0&&(t.bounds=i.components[0])},Point:function(e,t){var i={points:[]};this.readChildNodes(e,i),t.components||(t.components=[]),t.components.push(i.points[0])},coordinates:function(e,t){var i=this.getChildValue(e).replace(this.regExes.trimSpace,"");i=i.replace(this.regExes.trimComma,",");for(var s,n=i.split(this.regExes.splitSpace),r=n.length,a=new Array(r),o=0;r>o;++o)s=n[o].split(","),a[o]=this.xy?new OpenLayers.Geometry.Point(s[0],s[1],s[2]):new OpenLayers.Geometry.Point(s[1],s[0],s[2]);t.points=a},coord:function(e,t){var i={};this.readChildNodes(e,i),t.points||(t.points=[]),t.points.push(new OpenLayers.Geometry.Point(i.x,i.y,i.z))},X:function(e,t){t.x=this.getChildValue(e)},Y:function(e,t){t.y=this.getChildValue(e)},Z:function(e,t){t.z=this.getChildValue(e)},MultiPoint:function(e,t){var i={components:[]};this.readers.gml._inherit.apply(this,[e,i,t]),this.readChildNodes(e,i),t.components=[new OpenLayers.Geometry.MultiPoint(i.components)]},pointMember:function(e,t){this.readChildNodes(e,t)},LineString:function(e,t){var i={};this.readers.gml._inherit.apply(this,[e,i,t]),this.readChildNodes(e,i),t.components||(t.components=[]),t.components.push(new OpenLayers.Geometry.LineString(i.points))},MultiLineString:function(e,t){var i={components:[]};this.readers.gml._inherit.apply(this,[e,i,t]),this.readChildNodes(e,i),t.components=[new OpenLayers.Geometry.MultiLineString(i.components)]},lineStringMember:function(e,t){this.readChildNodes(e,t)},Polygon:function(e,t){var i={outer:null,inner:[]};this.readers.gml._inherit.apply(this,[e,i,t]),this.readChildNodes(e,i),i.inner.unshift(i.outer),t.components||(t.components=[]),t.components.push(new OpenLayers.Geometry.Polygon(i.inner))},LinearRing:function(e,t){var i={};this.readers.gml._inherit.apply(this,[e,i]),this.readChildNodes(e,i),t.components=[new OpenLayers.Geometry.LinearRing(i.points)]},MultiPolygon:function(e,t){var i={components:[]};this.readers.gml._inherit.apply(this,[e,i,t]),this.readChildNodes(e,i),t.components=[new OpenLayers.Geometry.MultiPolygon(i.components)]},polygonMember:function(e,t){this.readChildNodes(e,t)},GeometryCollection:function(e,t){var i={components:[]};this.readers.gml._inherit.apply(this,[e,i,t]),this.readChildNodes(e,i),t.components=[new OpenLayers.Geometry.Collection(i.components)]},geometryMember:function(e,t){this.readChildNodes(e,t)}},feature:{"*":function(e,t){var i,s=e.localName||e.nodeName.split(":").pop();t.features?this.singleFeatureType||-1===OpenLayers.Util.indexOf(this.featureType,s)?s===this.featureType&&(i="_typeName"):i="_typeName":0==e.childNodes.length||1==e.childNodes.length&&3==e.firstChild.nodeType?this.extractAttributes&&(i="_attribute"):i="_geometry",i&&this.readers.feature[i].apply(this,[e,t])},_typeName:function(e,t){var i={components:[],attributes:{}};this.readChildNodes(e,i),i.name&&(i.attributes.name=i.name);var s=new OpenLayers.Feature.Vector(i.components[0],i.attributes);this.singleFeatureType||(s.type=e.nodeName.split(":").pop(),s.namespace=e.namespaceURI);var n=e.getAttribute("fid")||this.getAttributeNS(e,this.namespaces.gml,"id");n&&(s.fid=n),this.internalProjection&&this.externalProjection&&s.geometry&&s.geometry.transform(this.externalProjection,this.internalProjection),i.bounds&&(s.bounds=i.bounds),t.features.push(s)},_geometry:function(e,t){this.geometryName||(this.geometryName=e.nodeName.split(":").pop()),this.readChildNodes(e,t)},_attribute:function(e,t){var i=e.localName||e.nodeName.split(":").pop(),s=this.getChildValue(e);t.attributes[i]=s}},wfs:{FeatureCollection:function(e,t){this.readChildNodes(e,t)}}},write:function(e){var t;t=OpenLayers.Util.isArray(e)?"featureMembers":"featureMember";var i=this.writeNode("gml:"+t,e);return this.setAttributeNS(i,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation),OpenLayers.Format.XML.prototype.write.apply(this,[i])},writers:{gml:{featureMember:function(e){var t=this.createElementNSPlus("gml:featureMember");return this.writeNode("feature:_typeName",e,t),t},MultiPoint:function(e){for(var t=this.createElementNSPlus("gml:MultiPoint"),i=e.components||[e],s=0,n=i.length;n>s;++s)this.writeNode("pointMember",i[s],t);return t},pointMember:function(e){var t=this.createElementNSPlus("gml:pointMember");return this.writeNode("Point",e,t),t},MultiLineString:function(e){for(var t=this.createElementNSPlus("gml:MultiLineString"),i=e.components||[e],s=0,n=i.length;n>s;++s)this.writeNode("lineStringMember",i[s],t);return t},lineStringMember:function(e){var t=this.createElementNSPlus("gml:lineStringMember");return this.writeNode("LineString",e,t),t},MultiPolygon:function(e){for(var t=this.createElementNSPlus("gml:MultiPolygon"),i=e.components||[e],s=0,n=i.length;n>s;++s)this.writeNode("polygonMember",i[s],t);return t},polygonMember:function(e){var t=this.createElementNSPlus("gml:polygonMember");return this.writeNode("Polygon",e,t),t},GeometryCollection:function(e){for(var t=this.createElementNSPlus("gml:GeometryCollection"),i=0,s=e.components.length;s>i;++i)this.writeNode("geometryMember",e.components[i],t);return t},geometryMember:function(e){var t=this.createElementNSPlus("gml:geometryMember"),i=this.writeNode("feature:_geometry",e);return t.appendChild(i.firstChild),t}},feature:{_typeName:function(e){var t=this.createElementNSPlus("feature:"+this.featureType,{attributes:{fid:e.fid}});e.geometry&&this.writeNode("feature:_geometry",e.geometry,t);for(var i in e.attributes){var s=e.attributes[i];null!=s&&this.writeNode("feature:_attribute",{name:i,value:s},t)}return t},_geometry:function(e){this.externalProjection&&this.internalProjection&&(e=e.clone().transform(this.internalProjection,this.externalProjection));var t=this.createElementNSPlus("feature:"+this.geometryName),i=this.geometryTypes[e.CLASS_NAME],s=this.writeNode("gml:"+i,e,t);return this.srsName&&s.setAttribute("srsName",this.srsName),t},_attribute:function(e){return this.createElementNSPlus("feature:"+e.name,{value:e.value})}},wfs:{FeatureCollection:function(e){for(var t=this.createElementNSPlus("wfs:FeatureCollection"),i=0,s=e.length;s>i;++i)this.writeNode("gml:featureMember",e[i],t);return t}}},setGeometryTypes:function(){this.geometryTypes={"OpenLayers.Geometry.Point":"Point","OpenLayers.Geometry.MultiPoint":"MultiPoint","OpenLayers.Geometry.LineString":"LineString","OpenLayers.Geometry.MultiLineString":"MultiLineString","OpenLayers.Geometry.Polygon":"Polygon","OpenLayers.Geometry.MultiPolygon":"MultiPolygon","OpenLayers.Geometry.Collection":"GeometryCollection"}},CLASS_NAME:"OpenLayers.Format.GML.Base"}),/* Copyright (c) 2006-2013 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.GML.v2=OpenLayers.Class(OpenLayers.Format.GML.Base,{schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/2.1.2/feature.xsd",initialize:function(e){OpenLayers.Format.GML.Base.prototype.initialize.apply(this,[e])},readers:{gml:OpenLayers.Util.applyDefaults({outerBoundaryIs:function(e,t){var i={};this.readChildNodes(e,i),t.outer=i.components[0]},innerBoundaryIs:function(e,t){var i={};this.readChildNodes(e,i),t.inner.push(i.components[0])},Box:function(e,t){var i={};this.readChildNodes(e,i),t.components||(t.components=[]);var s=i.points[0],n=i.points[1];t.components.push(new OpenLayers.Bounds(s.x,s.y,n.x,n.y))}},OpenLayers.Format.GML.Base.prototype.readers.gml),feature:OpenLayers.Format.GML.Base.prototype.readers.feature,wfs:OpenLayers.Format.GML.Base.prototype.readers.wfs},write:function(e){var t;t=OpenLayers.Util.isArray(e)?"wfs:FeatureCollection":"gml:featureMember";var i=this.writeNode(t,e);return this.setAttributeNS(i,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation),OpenLayers.Format.XML.prototype.write.apply(this,[i])},writers:{gml:OpenLayers.Util.applyDefaults({Point:function(e){var t=this.createElementNSPlus("gml:Point");return this.writeNode("coordinates",[e],t),t},coordinates:function(e){for(var t,i=e.length,s=new Array(i),n=0;i>n;++n)t=e[n],s[n]=this.xy?t.x+","+t.y:t.y+","+t.x,void 0!=t.z&&(s[n]+=","+t.z);return this.createElementNSPlus("gml:coordinates",{attributes:{decimal:".",cs:",",ts:" "},value:1==i?s[0]:s.join(" ")})},LineString:function(e){var t=this.createElementNSPlus("gml:LineString");return this.writeNode("coordinates",e.components,t),t},Polygon:function(e){var t=this.createElementNSPlus("gml:Polygon");this.writeNode("outerBoundaryIs",e.components[0],t);for(var i=1;i<e.components.length;++i)this.writeNode("innerBoundaryIs",e.components[i],t);return t},outerBoundaryIs:function(e){var t=this.createElementNSPlus("gml:outerBoundaryIs");return this.writeNode("LinearRing",e,t),t},innerBoundaryIs:function(e){var t=this.createElementNSPlus("gml:innerBoundaryIs");return this.writeNode("LinearRing",e,t),t},LinearRing:function(e){var t=this.createElementNSPlus("gml:LinearRing");return this.writeNode("coordinates",e.components,t),t},Box:function(e){var t=this.createElementNSPlus("gml:Box");return this.writeNode("coordinates",[{x:e.left,y:e.bottom},{x:e.right,y:e.top}],t),this.srsName&&t.setAttribute("srsName",this.srsName),t}},OpenLayers.Format.GML.Base.prototype.writers.gml),feature:OpenLayers.Format.GML.Base.prototype.writers.feature,wfs:OpenLayers.Format.GML.Base.prototype.writers.wfs},CLASS_NAME:"OpenLayers.Format.GML.v2"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Style=OpenLayers.Class({id:null,name:null,title:null,description:null,layerName:null,isDefault:!1,rules:null,context:null,defaultStyle:null,defaultsPerSymbolizer:!1,propertyStyles:null,initialize:function(e,t){OpenLayers.Util.extend(this,t),this.rules=[],t&&t.rules&&this.addRules(t.rules),this.setDefaultStyle(e||OpenLayers.Feature.Vector.style["default"]),this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var e=0,t=this.rules.length;t>e;e++)this.rules[e].destroy(),this.rules[e]=null;this.rules=null,this.defaultStyle=null},createSymbolizer:function(e){for(var t,i=this.defaultsPerSymbolizer?{}:this.createLiterals(OpenLayers.Util.extend({},this.defaultStyle),e),s=this.rules,n=[],r=!1,a=0,o=s.length;o>a;a++){t=s[a];var l=t.evaluate(e);l&&(t instanceof OpenLayers.Rule&&t.elseFilter?n.push(t):(r=!0,this.applySymbolizer(t,i,e)))}if(0==r&&n.length>0){r=!0;for(var a=0,o=n.length;o>a;a++)this.applySymbolizer(n[a],i,e)}return s.length>0&&0==r&&(i.display="none"),null!=i.label&&"string"!=typeof i.label&&(i.label=String(i.label)),i},applySymbolizer:function(e,t,i){var s=i.geometry?this.getSymbolizerPrefix(i.geometry):OpenLayers.Style.SYMBOLIZER_PREFIXES[0],n=e.symbolizer[s]||e.symbolizer;if(this.defaultsPerSymbolizer===!0){var r=this.defaultStyle;OpenLayers.Util.applyDefaults(n,{pointRadius:r.pointRadius}),(n.stroke===!0||n.graphic===!0)&&OpenLayers.Util.applyDefaults(n,{strokeWidth:r.strokeWidth,strokeColor:r.strokeColor,strokeOpacity:r.strokeOpacity,strokeDashstyle:r.strokeDashstyle,strokeLinecap:r.strokeLinecap}),(n.fill===!0||n.graphic===!0)&&OpenLayers.Util.applyDefaults(n,{fillColor:r.fillColor,fillOpacity:r.fillOpacity}),n.graphic===!0&&OpenLayers.Util.applyDefaults(n,{pointRadius:this.defaultStyle.pointRadius,externalGraphic:this.defaultStyle.externalGraphic,graphicName:this.defaultStyle.graphicName,graphicOpacity:this.defaultStyle.graphicOpacity,graphicWidth:this.defaultStyle.graphicWidth,graphicHeight:this.defaultStyle.graphicHeight,graphicXOffset:this.defaultStyle.graphicXOffset,graphicYOffset:this.defaultStyle.graphicYOffset})}return this.createLiterals(OpenLayers.Util.extend(t,n),i)},createLiterals:function(e,t){var i=OpenLayers.Util.extend({},t.attributes||t.data);OpenLayers.Util.extend(i,this.context);for(var s in this.propertyStyles)e[s]=OpenLayers.Style.createLiteral(e[s],i,t,s);return e},findPropertyStyles:function(){var e={},t=this.defaultStyle;this.addPropertyStyles(e,t);for(var i,s,n=this.rules,r=0,a=n.length;a>r;r++){i=n[r].symbolizer;for(var o in i){if(s=i[o],"object"!=typeof s){this.addPropertyStyles(e,i);break}this.addPropertyStyles(e,s)}}return e},addPropertyStyles:function(e,t){var i;for(var s in t)i=t[s],"string"==typeof i&&i.match(/\$\{\w+\}/)&&(e[s]=!0);return e},addRules:function(e){Array.prototype.push.apply(this.rules,e),this.propertyStyles=this.findPropertyStyles()},setDefaultStyle:function(e){this.defaultStyle=e,this.propertyStyles=this.findPropertyStyles()},getSymbolizerPrefix:function(e){for(var t=OpenLayers.Style.SYMBOLIZER_PREFIXES,i=0,s=t.length;s>i;i++)if(-1!=e.CLASS_NAME.indexOf(t[i]))return t[i]},clone:function(){var e=OpenLayers.Util.extend({},this);if(this.rules){e.rules=[];for(var t=0,i=this.rules.length;i>t;++t)e.rules.push(this.rules[t].clone())}e.context=this.context&&OpenLayers.Util.extend({},this.context);var s=OpenLayers.Util.extend({},this.defaultStyle);return new OpenLayers.Style(s,e)},CLASS_NAME:"OpenLayers.Style"}),OpenLayers.Style.createLiteral=function(e,t,i,s){return"string"==typeof e&&-1!=e.indexOf("${")&&(e=OpenLayers.String.format(e,t,[i,s]),e=isNaN(e)||!e?e:parseFloat(e)),e},OpenLayers.Style.SYMBOLIZER_PREFIXES=["Point","Line","Polygon","Text","Raster"],/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Rule=OpenLayers.Class({id:null,name:null,title:null,description:null,context:null,filter:null,elseFilter:!1,symbolizer:null,symbolizers:null,minScaleDenominator:null,maxScaleDenominator:null,initialize:function(e){this.symbolizer={},OpenLayers.Util.extend(this,e),this.symbolizers&&delete this.symbolizer,this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var e in this.symbolizer)this.symbolizer[e]=null;this.symbolizer=null,delete this.symbolizers},evaluate:function(e){var t=this.getContext(e),i=!0;if(this.minScaleDenominator||this.maxScaleDenominator)var s=e.layer.map.getScale();return this.minScaleDenominator&&(i=s>=OpenLayers.Style.createLiteral(this.minScaleDenominator,t)),i&&this.maxScaleDenominator&&(i=s<OpenLayers.Style.createLiteral(this.maxScaleDenominator,t)),i&&this.filter&&(i="OpenLayers.Filter.FeatureId"==this.filter.CLASS_NAME?this.filter.evaluate(e):this.filter.evaluate(t)),i},getContext:function(e){var t=this.context;return t||(t=e.attributes||e.data),"function"==typeof this.context&&(t=this.context(e)),t},clone:function(){var e=OpenLayers.Util.extend({},this);if(this.symbolizers){var t=this.symbolizers.length;e.symbolizers=new Array(t);for(var i=0;t>i;++i)e.symbolizers[i]=this.symbolizers[i].clone()}else{e.symbolizer={};var s,n;for(var r in this.symbolizer)s=this.symbolizer[r],n=typeof s,"object"===n?e.symbolizer[r]=OpenLayers.Util.extend({},s):"string"===n&&(e.symbolizer[r]=s)}return e.filter=this.filter&&this.filter.clone(),e.context=this.context&&OpenLayers.Util.extend({},this.context),new OpenLayers.Rule(e)},CLASS_NAME:"OpenLayers.Rule"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.OGCExceptionReport=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ogc:"http://www.opengis.net/ogc"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},defaultPrefix:"ogc",read:function(e){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e]));var t=e.documentElement,i={exceptionReport:null};return t&&(this.readChildNodes(e,i),null===i.exceptionReport&&(i=(new OpenLayers.Format.OWSCommon).read(e))),i},readers:{ogc:{ServiceExceptionReport:function(e,t){t.exceptionReport={exceptions:[]},this.readChildNodes(e,t.exceptionReport)},ServiceException:function(e,t){var i={code:e.getAttribute("code"),locator:e.getAttribute("locator"),text:this.getChildValue(e)};t.exceptions.push(i)}}},CLASS_NAME:"OpenLayers.Format.OGCExceptionReport"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.XML.VersionedOGC=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:null,version:null,profile:null,errorProperty:null,name:null,stringifyOutput:!1,parser:null,initialize:function(e){OpenLayers.Format.XML.prototype.initialize.apply(this,[e]);var t=this.CLASS_NAME;this.name=t.substring(t.lastIndexOf(".")+1)},getVersion:function(e,t){var i;return e?(i=this.version,i||(i=e.getAttribute("version"),i||(i=this.defaultVersion))):i=t&&t.version||this.version||this.defaultVersion,i},getParser:function(e){e=e||this.defaultVersion;var t=this.profile?"_"+this.profile:"";if(!this.parser||this.parser.VERSION!=e){var i=OpenLayers.Format[this.name]["v"+e.replace(/\./g,"_")+t];if(!i)throw"Can't find a "+this.name+" parser for version "+e+t;this.parser=new i(this.options)}return this.parser},write:function(e,t){var i=this.getVersion(null,t);this.parser=this.getParser(i);var s=this.parser.write(e,t);return this.stringifyOutput===!1?s:OpenLayers.Format.XML.prototype.write.apply(this,[s])},read:function(e,t){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e]));var i=e.documentElement,s=this.getVersion(i);this.parser=this.getParser(s);var n=this.parser.read(e,t);if(null!==this.errorProperty&&void 0===n[this.errorProperty]){var r=new OpenLayers.Format.OGCExceptionReport;n.error=r.read(e)}return n.version=s,n},CLASS_NAME:"OpenLayers.Format.XML.VersionedOGC"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Filter=OpenLayers.Class({initialize:function(e){OpenLayers.Util.extend(this,e)},destroy:function(){},evaluate:function(){return!0},clone:function(){return null},toString:function(){var e;return e=OpenLayers.Format&&OpenLayers.Format.CQL?OpenLayers.Format.CQL.prototype.write(this):Object.prototype.toString.call(this)},CLASS_NAME:"OpenLayers.Filter"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Filter.FeatureId=OpenLayers.Class(OpenLayers.Filter,{fids:null,type:"FID",initialize:function(e){this.fids=[],OpenLayers.Filter.prototype.initialize.apply(this,[e])},evaluate:function(e){for(var t=0,i=this.fids.length;i>t;t++){var s=e.fid||e.id;if(s==this.fids[t])return!0}return!1},clone:function(){var e=new OpenLayers.Filter.FeatureId;return OpenLayers.Util.extend(e,this),e.fids=this.fids.slice(),e},CLASS_NAME:"OpenLayers.Filter.FeatureId"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Filter.Logical=OpenLayers.Class(OpenLayers.Filter,{filters:null,type:null,initialize:function(e){this.filters=[],OpenLayers.Filter.prototype.initialize.apply(this,[e])},destroy:function(){this.filters=null,OpenLayers.Filter.prototype.destroy.apply(this)},evaluate:function(e){var t,i;switch(this.type){case OpenLayers.Filter.Logical.AND:for(t=0,i=this.filters.length;i>t;t++)if(0==this.filters[t].evaluate(e))return!1;return!0;case OpenLayers.Filter.Logical.OR:for(t=0,i=this.filters.length;i>t;t++)if(1==this.filters[t].evaluate(e))return!0;return!1;case OpenLayers.Filter.Logical.NOT:return!this.filters[0].evaluate(e)}return void 0},clone:function(){for(var e=[],t=0,i=this.filters.length;i>t;++t)e.push(this.filters[t].clone());return new OpenLayers.Filter.Logical({type:this.type,filters:e})},CLASS_NAME:"OpenLayers.Filter.Logical"}),OpenLayers.Filter.Logical.AND="&&",OpenLayers.Filter.Logical.OR="||",OpenLayers.Filter.Logical.NOT="!",/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Filter.Comparison=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,matchCase:!0,lowerBoundary:null,upperBoundary:null,initialize:function(e){OpenLayers.Filter.prototype.initialize.apply(this,[e]),this.type===OpenLayers.Filter.Comparison.LIKE&&void 0===e.matchCase&&(this.matchCase=null)},evaluate:function(e){e instanceof OpenLayers.Feature.Vector&&(e=e.attributes);var t,i=!1,s=e[this.property];switch(this.type){case OpenLayers.Filter.Comparison.EQUAL_TO:t=this.value,i=this.matchCase||"string"!=typeof s||"string"!=typeof t?s==t:s.toUpperCase()==t.toUpperCase();break;case OpenLayers.Filter.Comparison.NOT_EQUAL_TO:t=this.value,i=this.matchCase||"string"!=typeof s||"string"!=typeof t?s!=t:s.toUpperCase()!=t.toUpperCase();break;case OpenLayers.Filter.Comparison.LESS_THAN:i=s<this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN:i=s>this.value;break;case OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO:i=s<=this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO:i=s>=this.value;break;case OpenLayers.Filter.Comparison.BETWEEN:i=s>=this.lowerBoundary&&s<=this.upperBoundary;break;case OpenLayers.Filter.Comparison.LIKE:var n=new RegExp(this.value,"gi");i=n.test(s)}return i},value2regex:function(e,t,i){if("."==e)throw new Error("'.' is an unsupported wildCard character for OpenLayers.Filter.Comparison");return e=e?e:"*",t=t?t:".",i=i?i:"!",this.value=this.value.replace(new RegExp("\\"+i+"(.|$)","g"),"\\$1"),this.value=this.value.replace(new RegExp("\\"+t,"g"),"."),this.value=this.value.replace(new RegExp("\\"+e,"g"),".*"),this.value=this.value.replace(new RegExp("\\\\.\\*","g"),"\\"+e),this.value=this.value.replace(new RegExp("\\\\\\.","g"),"\\"+t),this.value},regex2value:function(){var e=this.value;return e=e.replace(/!/g,"!!"),e=e.replace(/(\\)?\\\./g,function(e,t){return t?e:"!."}),e=e.replace(/(\\)?\\\*/g,function(e,t){return t?e:"!*"}),e=e.replace(/\\\\/g,"\\"),e=e.replace(/\.\*/g,"*")},clone:function(){return OpenLayers.Util.extend(new OpenLayers.Filter.Comparison,this)},CLASS_NAME:"OpenLayers.Filter.Comparison"}),OpenLayers.Filter.Comparison.EQUAL_TO="==",OpenLayers.Filter.Comparison.NOT_EQUAL_TO="!=",OpenLayers.Filter.Comparison.LESS_THAN="<",OpenLayers.Filter.Comparison.GREATER_THAN=">",OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO="<=",OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO=">=",OpenLayers.Filter.Comparison.BETWEEN="..",OpenLayers.Filter.Comparison.LIKE="~",/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Filter.Spatial=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,distance:null,distanceUnits:null,evaluate:function(e){var t=!1;switch(this.type){case OpenLayers.Filter.Spatial.BBOX:case OpenLayers.Filter.Spatial.INTERSECTS:if(e.geometry){var i=this.value;"OpenLayers.Bounds"==this.value.CLASS_NAME&&(i=this.value.toGeometry()),e.geometry.intersects(i)&&(t=!0)}break;default:throw new Error("evaluate is not implemented for this filter type.")}return t},clone:function(){var e=OpenLayers.Util.applyDefaults({value:this.value&&this.value.clone&&this.value.clone()},this);return new OpenLayers.Filter.Spatial(e)},CLASS_NAME:"OpenLayers.Filter.Spatial"}),OpenLayers.Filter.Spatial.BBOX="BBOX",OpenLayers.Filter.Spatial.INTERSECTS="INTERSECTS",OpenLayers.Filter.Spatial.DWITHIN="DWITHIN",OpenLayers.Filter.Spatial.WITHIN="WITHIN",OpenLayers.Filter.Spatial.CONTAINS="CONTAINS",/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.SLD=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{profile:null,defaultVersion:"1.0.0",stringifyOutput:!0,namedLayersAsArray:!1,CLASS_NAME:"OpenLayers.Format.SLD"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.Filter=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",CLASS_NAME:"OpenLayers.Format.Filter"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Filter.Function=OpenLayers.Class(OpenLayers.Filter,{name:null,params:null,CLASS_NAME:"OpenLayers.Filter.Function"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.Filter.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ogc:"http://www.opengis.net/ogc",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"ogc",schemaLocation:null,initialize:function(e){OpenLayers.Format.XML.prototype.initialize.apply(this,[e])},read:function(e){var t={};return this.readers.ogc.Filter.apply(this,[e,t]),t.filter},readers:{ogc:{_expression:function(e){for(var t,i="",s=e.firstChild;s;s=s.nextSibling)switch(s.nodeType){case 1:t=this.readNode(s),t.property?i+="${"+t.property+"}":void 0!==t.value&&(i+=t.value);break;case 3:case 4:i+=s.nodeValue}return i},Filter:function(e,t){var i={fids:[],filters:[]};this.readChildNodes(e,i),i.fids.length>0?t.filter=new OpenLayers.Filter.FeatureId({fids:i.fids}):i.filters.length>0&&(t.filter=i.filters[0])},FeatureId:function(e,t){var i=e.getAttribute("fid");i&&t.fids.push(i)},And:function(e,t){var i=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND});this.readChildNodes(e,i),t.filters.push(i)},Or:function(e,t){var i=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.OR});this.readChildNodes(e,i),t.filters.push(i)},Not:function(e,t){var i=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.NOT});this.readChildNodes(e,i),t.filters.push(i)},PropertyIsLessThan:function(e,t){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN});this.readChildNodes(e,i),t.filters.push(i)},PropertyIsGreaterThan:function(e,t){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.GREATER_THAN});this.readChildNodes(e,i),t.filters.push(i)},PropertyIsLessThanOrEqualTo:function(e,t){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO});this.readChildNodes(e,i),t.filters.push(i)},PropertyIsGreaterThanOrEqualTo:function(e,t){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO});this.readChildNodes(e,i),t.filters.push(i)},PropertyIsBetween:function(e,t){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.BETWEEN});this.readChildNodes(e,i),t.filters.push(i)},Literal:function(e,t){t.value=OpenLayers.String.numericIf(this.getChildValue(e))},PropertyName:function(e,t){t.property=this.getChildValue(e)},LowerBoundary:function(e,t){t.lowerBoundary=OpenLayers.String.numericIf(this.readers.ogc._expression.call(this,e))},UpperBoundary:function(e,t){t.upperBoundary=OpenLayers.String.numericIf(this.readers.ogc._expression.call(this,e))},Intersects:function(e,t){this.readSpatial(e,t,OpenLayers.Filter.Spatial.INTERSECTS)},Within:function(e,t){this.readSpatial(e,t,OpenLayers.Filter.Spatial.WITHIN)},Contains:function(e,t){this.readSpatial(e,t,OpenLayers.Filter.Spatial.CONTAINS)},DWithin:function(e,t){this.readSpatial(e,t,OpenLayers.Filter.Spatial.DWITHIN)},Distance:function(e,t){t.distance=parseInt(this.getChildValue(e)),t.distanceUnits=e.getAttribute("units")},Function:function(){}}},readSpatial:function(e,t,i){var s=new OpenLayers.Filter.Spatial({type:i});this.readChildNodes(e,s),s.value=s.components[0],delete s.components,t.filters.push(s)},writeOgcExpression:function(e,t){if(e instanceof OpenLayers.Filter.Function){var i=this.writeNode("Function",e,t);t.appendChild(i)}else this.writeNode("Literal",e,t);return t},write:function(e){return this.writers.ogc.Filter.apply(this,[e])},writeFeatureIdNodes:function(e,t){for(var i=0,s=e.fids.length;s>i;++i)this.writeNode("FeatureId",e.fids[i],t)},writers:{ogc:{Filter:function(e){var t=this.createElementNSPlus("ogc:Filter");return"FID"===e.type?OpenLayers.Format.Filter.v1.prototype.writeFeatureIdNodes.call(this,e,t):this.writeNode(this.getFilterType(e),e,t),t},FeatureId:function(e){return this.createElementNSPlus("ogc:FeatureId",{attributes:{fid:e}})},And:function(e){for(var t,i=this.createElementNSPlus("ogc:And"),s=0,n=e.filters.length;n>s;++s)t=e.filters[s],"FID"===t.type?OpenLayers.Format.Filter.v1.prototype.writeFeatureIdNodes.call(this,t,i):this.writeNode(this.getFilterType(t),t,i);return i},Or:function(e){for(var t,i=this.createElementNSPlus("ogc:Or"),s=0,n=e.filters.length;n>s;++s)t=e.filters[s],"FID"===t.type?OpenLayers.Format.Filter.v1.prototype.writeFeatureIdNodes.call(this,t,i):this.writeNode(this.getFilterType(t),t,i);return i},Not:function(e){var t=this.createElementNSPlus("ogc:Not"),i=e.filters[0];return"FID"===i.type?OpenLayers.Format.Filter.v1.prototype.writeFeatureIdNodes.call(this,i,t):this.writeNode(this.getFilterType(i),i,t),t},PropertyIsLessThan:function(e){var t=this.createElementNSPlus("ogc:PropertyIsLessThan");return this.writeNode("PropertyName",e,t),this.writeOgcExpression(e.value,t),t},PropertyIsGreaterThan:function(e){var t=this.createElementNSPlus("ogc:PropertyIsGreaterThan");return this.writeNode("PropertyName",e,t),this.writeOgcExpression(e.value,t),t},PropertyIsLessThanOrEqualTo:function(e){var t=this.createElementNSPlus("ogc:PropertyIsLessThanOrEqualTo");return this.writeNode("PropertyName",e,t),this.writeOgcExpression(e.value,t),t},PropertyIsGreaterThanOrEqualTo:function(e){var t=this.createElementNSPlus("ogc:PropertyIsGreaterThanOrEqualTo");return this.writeNode("PropertyName",e,t),this.writeOgcExpression(e.value,t),t},PropertyIsBetween:function(e){var t=this.createElementNSPlus("ogc:PropertyIsBetween");return this.writeNode("PropertyName",e,t),this.writeNode("LowerBoundary",e,t),this.writeNode("UpperBoundary",e,t),t},PropertyName:function(e){return this.createElementNSPlus("ogc:PropertyName",{value:e.property})},Literal:function(e){return this.createElementNSPlus("ogc:Literal",{value:e})},LowerBoundary:function(e){var t=this.createElementNSPlus("ogc:LowerBoundary");return this.writeOgcExpression(e.lowerBoundary,t),t},UpperBoundary:function(e){var t=this.createElementNSPlus("ogc:UpperBoundary");return this.writeNode("Literal",e.upperBoundary,t),t},INTERSECTS:function(e){return this.writeSpatial(e,"Intersects")},WITHIN:function(e){return this.writeSpatial(e,"Within")},CONTAINS:function(e){return this.writeSpatial(e,"Contains")},DWITHIN:function(e){var t=this.writeSpatial(e,"DWithin");return this.writeNode("Distance",e,t),t},Distance:function(e){return this.createElementNSPlus("ogc:Distance",{attributes:{units:e.distanceUnits},value:e.distance})},Function:function(e){for(var t=this.createElementNSPlus("ogc:Function",{attributes:{name:e.name}}),i=e.params,s=0,n=i.length;n>s;s++)this.writeOgcExpression(i[s],t);return t}}},getFilterType:function(e){var t=this.filterMap[e.type];if(!t)throw"Filter writing not supported for rule type: "+e.type;return t},filterMap:{"&&":"And","||":"Or","!":"Not","==":"PropertyIsEqualTo","!=":"PropertyIsNotEqualTo","<":"PropertyIsLessThan",">":"PropertyIsGreaterThan","<=":"PropertyIsLessThanOrEqualTo",">=":"PropertyIsGreaterThanOrEqualTo","..":"PropertyIsBetween","~":"PropertyIsLike",BBOX:"BBOX",DWITHIN:"DWITHIN",WITHIN:"WITHIN",CONTAINS:"CONTAINS",INTERSECTS:"INTERSECTS",FID:"FeatureId"},CLASS_NAME:"OpenLayers.Format.Filter.v1"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.Filter.v1_0_0=OpenLayers.Class(OpenLayers.Format.GML.v2,OpenLayers.Format.Filter.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/ogc/filter/1.0.0/filter.xsd",initialize:function(e){OpenLayers.Format.GML.v2.prototype.initialize.apply(this,[e])},readers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(e,t){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO});this.readChildNodes(e,i),t.filters.push(i)},PropertyIsNotEqualTo:function(e,t){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.NOT_EQUAL_TO});this.readChildNodes(e,i),t.filters.push(i)},PropertyIsLike:function(e,t){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LIKE});this.readChildNodes(e,i);var s=e.getAttribute("wildCard"),n=e.getAttribute("singleChar"),r=e.getAttribute("escape");i.value2regex(s,n,r),t.filters.push(i)}},OpenLayers.Format.Filter.v1.prototype.readers.ogc),gml:OpenLayers.Format.GML.v2.prototype.readers.gml,feature:OpenLayers.Format.GML.v2.prototype.readers.feature},writers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(e){var t=this.createElementNSPlus("ogc:PropertyIsEqualTo");return this.writeNode("PropertyName",e,t),this.writeOgcExpression(e.value,t),t},PropertyIsNotEqualTo:function(e){var t=this.createElementNSPlus("ogc:PropertyIsNotEqualTo");return this.writeNode("PropertyName",e,t),this.writeOgcExpression(e.value,t),t},PropertyIsLike:function(e){var t=this.createElementNSPlus("ogc:PropertyIsLike",{attributes:{wildCard:"*",singleChar:".",escape:"!"}});return this.writeNode("PropertyName",e,t),this.writeNode("Literal",e.regex2value(),t),t},BBOX:function(e){var t=this.createElementNSPlus("ogc:BBOX");e.property&&this.writeNode("PropertyName",e,t);var i=this.writeNode("gml:Box",e.value,t);return e.projection&&i.setAttribute("srsName",e.projection),t}},OpenLayers.Format.Filter.v1.prototype.writers.ogc),gml:OpenLayers.Format.GML.v2.prototype.writers.gml,feature:OpenLayers.Format.GML.v2.prototype.writers.feature},writeSpatial:function(e,t){var i=this.createElementNSPlus("ogc:"+t);if(this.writeNode("PropertyName",e,i),e.value instanceof OpenLayers.Filter.Function)this.writeNode("Function",e.value,i);else{var s;s=e.value instanceof OpenLayers.Geometry?this.writeNode("feature:_geometry",e.value).firstChild:this.writeNode("gml:Box",e.value),e.projection&&s.setAttribute("srsName",e.projection),i.appendChild(s)}return i},CLASS_NAME:"OpenLayers.Format.Filter.v1_0_0"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Symbolizer=OpenLayers.Class({zIndex:0,initialize:function(e){OpenLayers.Util.extend(this,e)},clone:function(){var Type=eval(this.CLASS_NAME);return new Type(OpenLayers.Util.extend({},this))},CLASS_NAME:"OpenLayers.Symbolizer"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Symbolizer.Point=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Point"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Symbolizer.Line=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Line"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Symbolizer.Polygon=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Polygon"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Symbolizer.Text=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Text"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Symbolizer.Raster=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Raster"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.SLD.v1=OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0,{namespaces:{sld:"http://www.opengis.net/sld",ogc:"http://www.opengis.net/ogc",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"sld",schemaLocation:null,multipleSymbolizers:!1,featureTypeCounter:null,defaultSymbolizer:{fillColor:"#808080",fillOpacity:1,strokeColor:"#000000",strokeOpacity:1,strokeWidth:1,strokeDashstyle:"solid",pointRadius:3,graphicName:"square"},read:function(e,t){t=OpenLayers.Util.applyDefaults(t,this.options);var i={namedLayers:t.namedLayersAsArray===!0?[]:{}};return this.readChildNodes(e,i),i},readers:OpenLayers.Util.applyDefaults({sld:{StyledLayerDescriptor:function(e,t){t.version=e.getAttribute("version"),this.readChildNodes(e,t)},Name:function(e,t){t.name=this.getChildValue(e)},Title:function(e,t){t.title=this.getChildValue(e)},Abstract:function(e,t){t.description=this.getChildValue(e)},NamedLayer:function(e,t){var i={userStyles:[],namedStyles:[]};this.readChildNodes(e,i);for(var s=0,n=i.userStyles.length;n>s;++s)i.userStyles[s].layerName=i.name;OpenLayers.Util.isArray(t.namedLayers)?t.namedLayers.push(i):t.namedLayers[i.name]=i},NamedStyle:function(e,t){t.namedStyles.push(this.getChildName(e.firstChild))},UserStyle:function(e,t){var i={defaultsPerSymbolizer:!0,rules:[]};this.featureTypeCounter=-1,this.readChildNodes(e,i);var s;this.multipleSymbolizers?(delete i.defaultsPerSymbolizer,s=new OpenLayers.Style2(i)):s=new OpenLayers.Style(this.defaultSymbolizer,i),t.userStyles.push(s)},IsDefault:function(e,t){"1"==this.getChildValue(e)&&(t.isDefault=!0)},FeatureTypeStyle:function(e,t){++this.featureTypeCounter;var i={rules:this.multipleSymbolizers?t.rules:[]};this.readChildNodes(e,i),this.multipleSymbolizers||(t.rules=i.rules)},Rule:function(e,t){var i;this.multipleSymbolizers&&(i={symbolizers:[]});var s=new OpenLayers.Rule(i);this.readChildNodes(e,s),t.rules.push(s)},ElseFilter:function(e,t){t.elseFilter=!0},MinScaleDenominator:function(e,t){t.minScaleDenominator=parseFloat(this.getChildValue(e))},MaxScaleDenominator:function(e,t){t.maxScaleDenominator=parseFloat(this.getChildValue(e))},TextSymbolizer:function(e,t){var i={};this.readChildNodes(e,i),this.multipleSymbolizers?(i.zIndex=this.featureTypeCounter,t.symbolizers.push(new OpenLayers.Symbolizer.Text(i))):t.symbolizer.Text=OpenLayers.Util.applyDefaults(i,t.symbolizer.Text)},LabelPlacement:function(e,t){this.readChildNodes(e,t)},PointPlacement:function(e,t){var i={};this.readChildNodes(e,i),i.labelRotation=i.rotation,delete i.rotation;var s,n=t.labelAnchorPointX,r=t.labelAnchorPointY;1/3>=n?s="l":n>1/3&&2/3>n?s="c":n>=2/3&&(s="r"),1/3>=r?s+="b":r>1/3&&2/3>r?s+="m":r>=2/3&&(s+="t"),i.labelAlign=s,OpenLayers.Util.applyDefaults(t,i)},AnchorPoint:function(e,t){this.readChildNodes(e,t)},AnchorPointX:function(e,t){var i=this.readers.ogc._expression.call(this,e);i&&(t.labelAnchorPointX=i)},AnchorPointY:function(e,t){var i=this.readers.ogc._expression.call(this,e);i&&(t.labelAnchorPointY=i)},Displacement:function(e,t){this.readChildNodes(e,t)},DisplacementX:function(e,t){var i=this.readers.ogc._expression.call(this,e);i&&(t.labelXOffset=i)},DisplacementY:function(e,t){var i=this.readers.ogc._expression.call(this,e);i&&(t.labelYOffset=i)},LinePlacement:function(e,t){this.readChildNodes(e,t)},PerpendicularOffset:function(e,t){var i=this.readers.ogc._expression.call(this,e);i&&(t.labelPerpendicularOffset=i)},Label:function(e,t){var i=this.readers.ogc._expression.call(this,e);i&&(t.label=i)},Font:function(e,t){this.readChildNodes(e,t)},Halo:function(e,t){var i={};this.readChildNodes(e,i),t.haloRadius=i.haloRadius,t.haloColor=i.fillColor,t.haloOpacity=i.fillOpacity},Radius:function(e,t){var i=this.readers.ogc._expression.call(this,e);null!=i&&(t.haloRadius=i)},RasterSymbolizer:function(e,t){var i={};this.readChildNodes(e,i),this.multipleSymbolizers?(i.zIndex=this.featureTypeCounter,t.symbolizers.push(new OpenLayers.Symbolizer.Raster(i))):t.symbolizer.Raster=OpenLayers.Util.applyDefaults(i,t.symbolizer.Raster)},Geometry:function(e,t){t.geometry={},this.readChildNodes(e,t.geometry)},ColorMap:function(e,t){t.colorMap=[],this.readChildNodes(e,t.colorMap)},ColorMapEntry:function(e,t){var i=e.getAttribute("quantity"),s=e.getAttribute("opacity");t.push({color:e.getAttribute("color"),quantity:null!==i?parseFloat(i):void 0,label:e.getAttribute("label")||void 0,opacity:null!==s?parseFloat(s):void 0})},LineSymbolizer:function(e,t){var i={};this.readChildNodes(e,i),this.multipleSymbolizers?(i.zIndex=this.featureTypeCounter,t.symbolizers.push(new OpenLayers.Symbolizer.Line(i))):t.symbolizer.Line=OpenLayers.Util.applyDefaults(i,t.symbolizer.Line)},PolygonSymbolizer:function(e,t){var i={fill:!1,stroke:!1};this.multipleSymbolizers||(i=t.symbolizer.Polygon||i),this.readChildNodes(e,i),this.multipleSymbolizers?(i.zIndex=this.featureTypeCounter,t.symbolizers.push(new OpenLayers.Symbolizer.Polygon(i))):t.symbolizer.Polygon=i},PointSymbolizer:function(e,t){var i={fill:!1,stroke:!1,graphic:!1};this.multipleSymbolizers||(i=t.symbolizer.Point||i),this.readChildNodes(e,i),this.multipleSymbolizers?(i.zIndex=this.featureTypeCounter,t.symbolizers.push(new OpenLayers.Symbolizer.Point(i))):t.symbolizer.Point=i},Stroke:function(e,t){t.stroke=!0,this.readChildNodes(e,t)},Fill:function(e,t){t.fill=!0,this.readChildNodes(e,t)},CssParameter:function(e,t){var i=e.getAttribute("name"),s=this.cssMap[i];if(t.label&&("fill"===i?s="fontColor":"fill-opacity"===i&&(s="fontOpacity")),s){var n=this.readers.ogc._expression.call(this,e);n&&(t[s]=n)}},Graphic:function(e,t){t.graphic=!0;var i={};this.readChildNodes(e,i);for(var s,n,r=["stroke","strokeColor","strokeWidth","strokeOpacity","strokeLinecap","fill","fillColor","fillOpacity","graphicName","rotation","graphicFormat"],a=0,o=r.length;o>a;++a)s=r[a],n=i[s],void 0!=n&&(t[s]=n);if(void 0!=i.opacity&&(t.graphicOpacity=i.opacity),void 0!=i.size){var l=i.size/2;isNaN(l)?t.graphicWidth=i.size:t.pointRadius=i.size/2}void 0!=i.href&&(t.externalGraphic=i.href),void 0!=i.rotation&&(t.rotation=i.rotation)},ExternalGraphic:function(e,t){this.readChildNodes(e,t)},Mark:function(e,t){this.readChildNodes(e,t)},WellKnownName:function(e,t){t.graphicName=this.getChildValue(e)},Opacity:function(e,t){var i=this.readers.ogc._expression.call(this,e);i&&(t.opacity=i)},Size:function(e,t){var i=this.readers.ogc._expression.call(this,e);i&&(t.size=i)},Rotation:function(e,t){var i=this.readers.ogc._expression.call(this,e);i&&(t.rotation=i)},OnlineResource:function(e,t){t.href=this.getAttributeNS(e,this.namespaces.xlink,"href")},Format:function(e,t){t.graphicFormat=this.getChildValue(e)}}},OpenLayers.Format.Filter.v1_0_0.prototype.readers),cssMap:{stroke:"strokeColor","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","stroke-linecap":"strokeLinecap","stroke-dasharray":"strokeDashstyle",fill:"fillColor","fill-opacity":"fillOpacity","font-family":"fontFamily","font-size":"fontSize","font-weight":"fontWeight","font-style":"fontStyle"},getCssProperty:function(e){var t=null;for(var i in this.cssMap)if(this.cssMap[i]==e){t=i;break}return t},getGraphicFormat:function(e){var t;for(var i in this.graphicFormats)if(this.graphicFormats[i].test(e)){t=i;break}return t||this.defaultGraphicFormat},defaultGraphicFormat:"image/png",graphicFormats:{"image/jpeg":/\.jpe?g$/i,"image/gif":/\.gif$/i,"image/png":/\.png$/i},write:function(e){return this.writers.sld.StyledLayerDescriptor.apply(this,[e])},writers:OpenLayers.Util.applyDefaults({sld:{_OGCExpression:function(e,t){var i=this.createElementNSPlus(e),s="string"==typeof t?t.split("${"):[t];i.appendChild(this.createTextNode(s[0]));for(var n,r,a=1,o=s.length;o>a;a++)n=s[a],r=n.indexOf("}"),r>0?(this.writeNode("ogc:PropertyName",{property:n.substring(0,r)},i),i.appendChild(this.createTextNode(n.substring(++r)))):i.appendChild(this.createTextNode("${"+n));return i},StyledLayerDescriptor:function(e){var t=this.createElementNSPlus("sld:StyledLayerDescriptor",{attributes:{version:this.VERSION,"xsi:schemaLocation":this.schemaLocation}});if(t.setAttribute("xmlns:ogc",this.namespaces.ogc),t.setAttribute("xmlns:gml",this.namespaces.gml),e.name&&this.writeNode("Name",e.name,t),e.title&&this.writeNode("Title",e.title,t),e.description&&this.writeNode("Abstract",e.description,t),OpenLayers.Util.isArray(e.namedLayers))for(var i=0,s=e.namedLayers.length;s>i;++i)this.writeNode("NamedLayer",e.namedLayers[i],t);else for(var n in e.namedLayers)this.writeNode("NamedLayer",e.namedLayers[n],t);return t},Name:function(e){return this.createElementNSPlus("sld:Name",{value:e})},Title:function(e){return this.createElementNSPlus("sld:Title",{value:e})},Abstract:function(e){return this.createElementNSPlus("sld:Abstract",{value:e})},NamedLayer:function(e){var t=this.createElementNSPlus("sld:NamedLayer");if(this.writeNode("Name",e.name,t),e.namedStyles)for(var i=0,s=e.namedStyles.length;s>i;++i)this.writeNode("NamedStyle",e.namedStyles[i],t);if(e.userStyles)for(var i=0,s=e.userStyles.length;s>i;++i)this.writeNode("UserStyle",e.userStyles[i],t);return t},NamedStyle:function(e){var t=this.createElementNSPlus("sld:NamedStyle");return this.writeNode("Name",e,t),t},UserStyle:function(e){var t=this.createElementNSPlus("sld:UserStyle");if(e.name&&this.writeNode("Name",e.name,t),e.title&&this.writeNode("Title",e.title,t),e.description&&this.writeNode("Abstract",e.description,t),e.isDefault&&this.writeNode("IsDefault",e.isDefault,t),this.multipleSymbolizers&&e.rules){for(var i,s,n,r,a,o={0:[]},l=[0],h=0,u=e.rules.length;u>h;++h)if(i=e.rules[h],i.symbolizers){s={};for(var c=0,d=i.symbolizers.length;d>c;++c)n=i.symbolizers[c],r=n.zIndex,r in s||(a=i.clone(),a.symbolizers=[],s[r]=a),s[r].symbolizers.push(n.clone());for(r in s)r in o||(l.push(r),o[r]=[]),o[r].push(s[r])}else o[0].push(i.clone());l.sort();for(var p,h=0,u=l.length;u>h;++h)p=o[l[h]],p.length>0&&(a=e.clone(),a.rules=o[l[h]],this.writeNode("FeatureTypeStyle",a,t))}else this.writeNode("FeatureTypeStyle",e,t);return t},IsDefault:function(e){return this.createElementNSPlus("sld:IsDefault",{value:e?"1":"0"})},FeatureTypeStyle:function(e){for(var t=this.createElementNSPlus("sld:FeatureTypeStyle"),i=0,s=e.rules.length;s>i;++i)this.writeNode("Rule",e.rules[i],t);return t},Rule:function(e){var t=this.createElementNSPlus("sld:Rule");e.name&&this.writeNode("Name",e.name,t),e.title&&this.writeNode("Title",e.title,t),e.description&&this.writeNode("Abstract",e.description,t),e.elseFilter?this.writeNode("ElseFilter",null,t):e.filter&&this.writeNode("ogc:Filter",e.filter,t),void 0!=e.minScaleDenominator&&this.writeNode("MinScaleDenominator",e.minScaleDenominator,t),void 0!=e.maxScaleDenominator&&this.writeNode("MaxScaleDenominator",e.maxScaleDenominator,t);var i,s;if(this.multipleSymbolizers&&e.symbolizers)for(var s,n=0,r=e.symbolizers.length;r>n;++n)s=e.symbolizers[n],i=s.CLASS_NAME.split(".").pop(),this.writeNode(i+"Symbolizer",s,t);else for(var a=OpenLayers.Style.SYMBOLIZER_PREFIXES,n=0,o=a.length;o>n;++n)i=a[n],s=e.symbolizer[i],s&&this.writeNode(i+"Symbolizer",s,t);return t},ElseFilter:function(){return this.createElementNSPlus("sld:ElseFilter")},MinScaleDenominator:function(e){return this.createElementNSPlus("sld:MinScaleDenominator",{value:e})},MaxScaleDenominator:function(e){return this.createElementNSPlus("sld:MaxScaleDenominator",{value:e})},LineSymbolizer:function(e){var t=this.createElementNSPlus("sld:LineSymbolizer");return this.writeNode("Stroke",e,t),t},Stroke:function(e){var t=this.createElementNSPlus("sld:Stroke");return void 0!=e.strokeColor&&this.writeNode("CssParameter",{symbolizer:e,key:"strokeColor"},t),void 0!=e.strokeOpacity&&this.writeNode("CssParameter",{symbolizer:e,key:"strokeOpacity"},t),void 0!=e.strokeWidth&&this.writeNode("CssParameter",{symbolizer:e,key:"strokeWidth"},t),void 0!=e.strokeDashstyle&&"solid"!==e.strokeDashstyle&&this.writeNode("CssParameter",{symbolizer:e,key:"strokeDashstyle"},t),void 0!=e.strokeLinecap&&this.writeNode("CssParameter",{symbolizer:e,key:"strokeLinecap"},t),t},CssParameter:function(e){return this.createElementNSPlus("sld:CssParameter",{attributes:{name:this.getCssProperty(e.key)},value:e.symbolizer[e.key]})},TextSymbolizer:function(e){var t=this.createElementNSPlus("sld:TextSymbolizer");return null!=e.label&&this.writeNode("Label",e.label,t),(null!=e.fontFamily||null!=e.fontSize||null!=e.fontWeight||null!=e.fontStyle)&&this.writeNode("Font",e,t),(null!=e.labelAnchorPointX||null!=e.labelAnchorPointY||null!=e.labelAlign||null!=e.labelXOffset||null!=e.labelYOffset||null!=e.labelRotation||null!=e.labelPerpendicularOffset)&&this.writeNode("LabelPlacement",e,t),(null!=e.haloRadius||null!=e.haloColor||null!=e.haloOpacity)&&this.writeNode("Halo",e,t),(null!=e.fontColor||null!=e.fontOpacity)&&this.writeNode("Fill",{fillColor:e.fontColor,fillOpacity:e.fontOpacity},t),t},LabelPlacement:function(e){var t=this.createElementNSPlus("sld:LabelPlacement");return null==e.labelAnchorPointX&&null==e.labelAnchorPointY&&null==e.labelAlign&&null==e.labelXOffset&&null==e.labelYOffset&&null==e.labelRotation||null!=e.labelPerpendicularOffset||this.writeNode("PointPlacement",e,t),null!=e.labelPerpendicularOffset&&this.writeNode("LinePlacement",e,t),t},LinePlacement:function(e){var t=this.createElementNSPlus("sld:LinePlacement");return this.writeNode("PerpendicularOffset",e.labelPerpendicularOffset,t),t},PerpendicularOffset:function(e){return this.createElementNSPlus("sld:PerpendicularOffset",{value:e})},PointPlacement:function(e){var t=this.createElementNSPlus("sld:PointPlacement");return(null!=e.labelAnchorPointX||null!=e.labelAnchorPointY||null!=e.labelAlign)&&this.writeNode("AnchorPoint",e,t),(null!=e.labelXOffset||null!=e.labelYOffset)&&this.writeNode("Displacement",e,t),null!=e.labelRotation&&this.writeNode("Rotation",e.labelRotation,t),t},AnchorPoint:function(e){var t=this.createElementNSPlus("sld:AnchorPoint"),i=e.labelAnchorPointX,s=e.labelAnchorPointY;if(null!=i&&this.writeNode("AnchorPointX",i,t),null!=s&&this.writeNode("AnchorPointY",s,t),null==i&&null==s){var n=e.labelAlign.substr(0,1),r=e.labelAlign.substr(1,1);"l"===n?i=0:"c"===n?i=.5:"r"===n&&(i=1),"b"===r?s=0:"m"===r?s=.5:"t"===r&&(s=1),this.writeNode("AnchorPointX",i,t),this.writeNode("AnchorPointY",s,t)}return t},AnchorPointX:function(e){return this.createElementNSPlus("sld:AnchorPointX",{value:e})},AnchorPointY:function(e){return this.createElementNSPlus("sld:AnchorPointY",{value:e})},Displacement:function(e){var t=this.createElementNSPlus("sld:Displacement");return null!=e.labelXOffset&&this.writeNode("DisplacementX",e.labelXOffset,t),null!=e.labelYOffset&&this.writeNode("DisplacementY",e.labelYOffset,t),t},DisplacementX:function(e){return this.createElementNSPlus("sld:DisplacementX",{value:e})},DisplacementY:function(e){return this.createElementNSPlus("sld:DisplacementY",{value:e})},Font:function(e){var t=this.createElementNSPlus("sld:Font");return e.fontFamily&&this.writeNode("CssParameter",{symbolizer:e,key:"fontFamily"},t),e.fontSize&&this.writeNode("CssParameter",{symbolizer:e,key:"fontSize"},t),e.fontWeight&&this.writeNode("CssParameter",{symbolizer:e,key:"fontWeight"},t),e.fontStyle&&this.writeNode("CssParameter",{symbolizer:e,key:"fontStyle"},t),t},Label:function(e){return this.writers.sld._OGCExpression.call(this,"sld:Label",e)},Halo:function(e){var t=this.createElementNSPlus("sld:Halo");return e.haloRadius&&this.writeNode("Radius",e.haloRadius,t),(e.haloColor||e.haloOpacity)&&this.writeNode("Fill",{fillColor:e.haloColor,fillOpacity:e.haloOpacity},t),t},Radius:function(e){return this.createElementNSPlus("sld:Radius",{value:e})},RasterSymbolizer:function(e){var t=this.createElementNSPlus("sld:RasterSymbolizer");return e.geometry&&this.writeNode("Geometry",e.geometry,t),e.opacity&&this.writeNode("Opacity",e.opacity,t),e.colorMap&&this.writeNode("ColorMap",e.colorMap,t),t},Geometry:function(e){var t=this.createElementNSPlus("sld:Geometry");return e.property&&this.writeNode("ogc:PropertyName",e,t),t},ColorMap:function(e){for(var t=this.createElementNSPlus("sld:ColorMap"),i=0,s=e.length;s>i;++i)this.writeNode("ColorMapEntry",e[i],t);return t},ColorMapEntry:function(e){var t=this.createElementNSPlus("sld:ColorMapEntry"),i=e;return t.setAttribute("color",i.color),void 0!==i.opacity&&t.setAttribute("opacity",parseFloat(i.opacity)),void 0!==i.quantity&&t.setAttribute("quantity",parseFloat(i.quantity)),void 0!==i.label&&t.setAttribute("label",i.label),t},PolygonSymbolizer:function(e){var t=this.createElementNSPlus("sld:PolygonSymbolizer");return e.fill!==!1&&this.writeNode("Fill",e,t),e.stroke!==!1&&this.writeNode("Stroke",e,t),t},Fill:function(e){var t=this.createElementNSPlus("sld:Fill");return e.fillColor&&this.writeNode("CssParameter",{symbolizer:e,key:"fillColor"},t),null!=e.fillOpacity&&this.writeNode("CssParameter",{symbolizer:e,key:"fillOpacity"},t),t},PointSymbolizer:function(e){var t=this.createElementNSPlus("sld:PointSymbolizer");return this.writeNode("Graphic",e,t),t},Graphic:function(e){var t=this.createElementNSPlus("sld:Graphic");return void 0!=e.externalGraphic?this.writeNode("ExternalGraphic",e,t):this.writeNode("Mark",e,t),void 0!=e.graphicOpacity&&this.writeNode("Opacity",e.graphicOpacity,t),void 0!=e.pointRadius?this.writeNode("Size",2*e.pointRadius,t):void 0!=e.graphicWidth&&this.writeNode("Size",e.graphicWidth,t),void 0!=e.rotation&&this.writeNode("Rotation",e.rotation,t),t},ExternalGraphic:function(e){var t=this.createElementNSPlus("sld:ExternalGraphic");this.writeNode("OnlineResource",e.externalGraphic,t);var i=e.graphicFormat||this.getGraphicFormat(e.externalGraphic);return this.writeNode("Format",i,t),t},Mark:function(e){var t=this.createElementNSPlus("sld:Mark");return e.graphicName&&this.writeNode("WellKnownName",e.graphicName,t),e.fill!==!1&&this.writeNode("Fill",e,t),e.stroke!==!1&&this.writeNode("Stroke",e,t),t},WellKnownName:function(e){return this.createElementNSPlus("sld:WellKnownName",{value:e})},Opacity:function(e){return this.createElementNSPlus("sld:Opacity",{value:e})},Size:function(e){return this.writers.sld._OGCExpression.call(this,"sld:Size",e)},Rotation:function(e){return this.createElementNSPlus("sld:Rotation",{value:e})},OnlineResource:function(e){return this.createElementNSPlus("sld:OnlineResource",{attributes:{"xlink:type":"simple","xlink:href":e}})},Format:function(e){return this.createElementNSPlus("sld:Format",{value:e})}}},OpenLayers.Format.Filter.v1_0_0.prototype.writers),CLASS_NAME:"OpenLayers.Format.SLD.v1"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.SLD.v1_0_0=OpenLayers.Class(OpenLayers.Format.SLD.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/sld http://schemas.opengis.net/sld/1.0.0/StyledLayerDescriptor.xsd",CLASS_NAME:"OpenLayers.Format.SLD.v1_0_0"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.Context=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{layerOptions:null,layerParams:null,read:function(e,t){var i,s=OpenLayers.Format.XML.VersionedOGC.prototype.read.apply(this,arguments);if(t&&t.map)if(this.context=s,t.map instanceof OpenLayers.Map)i=this.mergeContextToMap(s,t.map);else{var n=t.map;(OpenLayers.Util.isElement(n)||"string"==typeof n)&&(n={div:n}),i=this.contextToMap(s,n)}else i=s;return i},getLayerFromContext:function(e){var t,i,s={queryable:e.queryable,visibility:e.visibility,maxExtent:e.maxExtent,metadata:OpenLayers.Util.applyDefaults(e.metadata,{styles:e.styles,formats:e.formats,"abstract":e["abstract"],dataURL:e.dataURL}),numZoomLevels:e.numZoomLevels,units:e.units,isBaseLayer:e.isBaseLayer,opacity:e.opacity,displayInLayerSwitcher:e.displayInLayerSwitcher,singleTile:e.singleTile,tileSize:e.tileSize?new OpenLayers.Size(e.tileSize.width,e.tileSize.height):void 0,minScale:e.minScale||e.maxScaleDenominator,maxScale:e.maxScale||e.minScaleDenominator,srs:e.srs,dimensions:e.dimensions,metadataURL:e.metadataURL};this.layerOptions&&OpenLayers.Util.applyDefaults(s,this.layerOptions);var n={layers:e.name,transparent:e.transparent,version:e.version};if(e.formats&&e.formats.length>0)for(n.format=e.formats[0].value,t=0,i=e.formats.length;i>t;t++){var r=e.formats[t];if(1==r.current){n.format=r.value;break}}if(e.styles&&e.styles.length>0)for(t=0,i=e.styles.length;i>t;t++){var a=e.styles[t];if(1==a.current){a.href?n.sld=a.href:a.body?n.sld_body=a.body:n.styles=a.name;break}}this.layerParams&&OpenLayers.Util.applyDefaults(n,this.layerParams);var o=null,l=e.service;return l==OpenLayers.Format.Context.serviceTypes.WFS?(s.strategies=[new OpenLayers.Strategy.BBOX],s.protocol=new OpenLayers.Protocol.WFS({url:e.url,featurePrefix:e.name.split(":")[0],featureType:e.name.split(":").pop()}),o=new OpenLayers.Layer.Vector(e.title||e.name,s)):l==OpenLayers.Format.Context.serviceTypes.KML?(s.strategies=[new OpenLayers.Strategy.Fixed],s.protocol=new OpenLayers.Protocol.HTTP({url:e.url,format:new OpenLayers.Format.KML}),o=new OpenLayers.Layer.Vector(e.title||e.name,s)):l==OpenLayers.Format.Context.serviceTypes.GML?(s.strategies=[new OpenLayers.Strategy.Fixed],s.protocol=new OpenLayers.Protocol.HTTP({url:e.url,format:new OpenLayers.Format.GML}),o=new OpenLayers.Layer.Vector(e.title||e.name,s)):e.features?(o=new OpenLayers.Layer.Vector(e.title||e.name,s),o.addFeatures(e.features)):e.categoryLayer!==!0&&(o=new OpenLayers.Layer.WMS(e.title||e.name,e.url,n,s)),o},getLayersFromContext:function(e){for(var t=[],i=0,s=e.length;s>i;i++){var n=this.getLayerFromContext(e[i]);null!==n&&t.push(n)}return t},contextToMap:function(e,t){t=OpenLayers.Util.applyDefaults({maxExtent:e.maxExtent,projection:e.projection,units:e.units},t),t.maxExtent&&(t.maxResolution=t.maxExtent.getWidth()/OpenLayers.Map.TILE_WIDTH);var i={contactInformation:e.contactInformation,"abstract":e["abstract"],keywords:e.keywords,logo:e.logo,descriptionURL:e.descriptionURL};t.metadata=i;var s=new OpenLayers.Map(t);return s.addLayers(this.getLayersFromContext(e.layersContext)),s.setCenter(e.bounds.getCenterLonLat(),s.getZoomForExtent(e.bounds,!0)),s},mergeContextToMap:function(e,t){return t.addLayers(this.getLayersFromContext(e.layersContext)),t},write:function(e){return e=this.toContext(e),OpenLayers.Format.XML.VersionedOGC.prototype.write.apply(this,arguments)},CLASS_NAME:"OpenLayers.Format.Context"}),OpenLayers.Format.Context.serviceTypes={WMS:"urn:ogc:serviceType:WMS",WFS:"urn:ogc:serviceType:WFS",WCS:"urn:ogc:serviceType:WCS",GML:"urn:ogc:serviceType:GML",SLD:"urn:ogc:serviceType:SLD",FES:"urn:ogc:serviceType:FES",KML:"urn:ogc:serviceType:KML"},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.OWSContext=OpenLayers.Class(OpenLayers.Format.Context,{defaultVersion:"0.3.1",getVersion:function(){var e=OpenLayers.Format.XML.VersionedOGC.prototype.getVersion.apply(this,arguments);return"0.3.0"===e&&(e=this.defaultVersion),e},toContext:function(e){var t={};return"OpenLayers.Map"==e.CLASS_NAME&&(t.bounds=e.getExtent(),t.maxExtent=e.maxExtent,t.projection=e.projection,t.size=e.getSize(),t.layers=e.layers),t},CLASS_NAME:"OpenLayers.Format.OWSContext"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.OWSCommon=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",getVersion:function(e){var t=this.version;if(!t){var i=e.getAttribute("xmlns:ows");i&&"1.1"===i.substring(i.lastIndexOf("/")+1)&&(t="1.1.0"),t||(t=this.defaultVersion)}return t},CLASS_NAME:"OpenLayers.Format.OWSCommon"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.OWSCommon.v1=OpenLayers.Class(OpenLayers.Format.XML,{regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},read:function(e,t){t=OpenLayers.Util.applyDefaults(t,this.options);var i={};return this.readChildNodes(e,i),i},readers:{ows:{Exception:function(e,t){var i={code:e.getAttribute("exceptionCode"),locator:e.getAttribute("locator"),texts:[]};t.exceptions.push(i),this.readChildNodes(e,i)},ExceptionText:function(e,t){var i=this.getChildValue(e);t.texts.push(i)},ServiceIdentification:function(e,t){t.serviceIdentification={},this.readChildNodes(e,t.serviceIdentification)},Title:function(e,t){t.title=this.getChildValue(e)},Abstract:function(e,t){t["abstract"]=this.getChildValue(e)},Keywords:function(e,t){t.keywords={},this.readChildNodes(e,t.keywords)},Keyword:function(e,t){t[this.getChildValue(e)]=!0},ServiceType:function(e,t){t.serviceType={codeSpace:e.getAttribute("codeSpace"),value:this.getChildValue(e)}},ServiceTypeVersion:function(e,t){t.serviceTypeVersion=this.getChildValue(e)},Fees:function(e,t){t.fees=this.getChildValue(e)},AccessConstraints:function(e,t){t.accessConstraints=this.getChildValue(e)},ServiceProvider:function(e,t){t.serviceProvider={},this.readChildNodes(e,t.serviceProvider)},ProviderName:function(e,t){t.providerName=this.getChildValue(e)},ProviderSite:function(e,t){t.providerSite=this.getAttributeNS(e,this.namespaces.xlink,"href")},ServiceContact:function(e,t){t.serviceContact={},this.readChildNodes(e,t.serviceContact)},IndividualName:function(e,t){t.individualName=this.getChildValue(e)},PositionName:function(e,t){t.positionName=this.getChildValue(e)},ContactInfo:function(e,t){t.contactInfo={},this.readChildNodes(e,t.contactInfo)},Phone:function(e,t){t.phone={},this.readChildNodes(e,t.phone)},Voice:function(e,t){t.voice=this.getChildValue(e)},Address:function(e,t){t.address={},this.readChildNodes(e,t.address)},DeliveryPoint:function(e,t){t.deliveryPoint=this.getChildValue(e)},City:function(e,t){t.city=this.getChildValue(e)},AdministrativeArea:function(e,t){t.administrativeArea=this.getChildValue(e)},PostalCode:function(e,t){t.postalCode=this.getChildValue(e)},Country:function(e,t){t.country=this.getChildValue(e)},ElectronicMailAddress:function(e,t){t.electronicMailAddress=this.getChildValue(e)},Role:function(e,t){t.role=this.getChildValue(e)},OperationsMetadata:function(e,t){t.operationsMetadata={},this.readChildNodes(e,t.operationsMetadata)},Operation:function(e,t){var i=e.getAttribute("name");t[i]={},this.readChildNodes(e,t[i])},DCP:function(e,t){t.dcp={},this.readChildNodes(e,t.dcp)},HTTP:function(e,t){t.http={},this.readChildNodes(e,t.http)},Get:function(e,t){t.get||(t.get=[]);var i={url:this.getAttributeNS(e,this.namespaces.xlink,"href")};this.readChildNodes(e,i),t.get.push(i)},Post:function(e,t){t.post||(t.post=[]);var i={url:this.getAttributeNS(e,this.namespaces.xlink,"href")};this.readChildNodes(e,i),t.post.push(i)},Parameter:function(e,t){t.parameters||(t.parameters={});var i=e.getAttribute("name");t.parameters[i]={},this.readChildNodes(e,t.parameters[i])},Constraint:function(e,t){t.constraints||(t.constraints={});var i=e.getAttribute("name");t.constraints[i]={},this.readChildNodes(e,t.constraints[i])},Value:function(e,t){t[this.getChildValue(e)]=!0},OutputFormat:function(e,t){t.formats.push({value:this.getChildValue(e)}),this.readChildNodes(e,t)},WGS84BoundingBox:function(e,t){var i={};i.crs=e.getAttribute("crs"),t.BoundingBox?t.BoundingBox.push(i):(t.projection=i.crs,i=t),this.readChildNodes(e,i)},BoundingBox:function(e,t){this.readers.ows.WGS84BoundingBox.apply(this,[e,t])},LowerCorner:function(e,t){var i=this.getChildValue(e).replace(this.regExes.trimSpace,"");i=i.replace(this.regExes.trimComma,",");var s=i.split(this.regExes.splitSpace);t.left=s[0],t.bottom=s[1]},UpperCorner:function(e,t){var i=this.getChildValue(e).replace(this.regExes.trimSpace,"");i=i.replace(this.regExes.trimComma,",");var s=i.split(this.regExes.splitSpace);t.right=s[0],t.top=s[1],t.bounds=new OpenLayers.Bounds(t.left,t.bottom,t.right,t.top),delete t.left,delete t.bottom,delete t.right,delete t.top},Language:function(e,t){t.language=this.getChildValue(e)}}},writers:{ows:{BoundingBox:function(e){var t=this.createElementNSPlus("ows:BoundingBox",{attributes:{crs:e.projection}});return this.writeNode("ows:LowerCorner",e,t),this.writeNode("ows:UpperCorner",e,t),t},LowerCorner:function(e){var t=this.createElementNSPlus("ows:LowerCorner",{value:e.bounds.left+" "+e.bounds.bottom});return t},UpperCorner:function(e){var t=this.createElementNSPlus("ows:UpperCorner",{value:e.bounds.right+" "+e.bounds.top});return t},Identifier:function(e){var t=this.createElementNSPlus("ows:Identifier",{value:e});return t},Title:function(e){var t=this.createElementNSPlus("ows:Title",{value:e});return t},Abstract:function(e){var t=this.createElementNSPlus("ows:Abstract",{value:e});return t},OutputFormat:function(e){var t=this.createElementNSPlus("ows:OutputFormat",{value:e});return t}}},CLASS_NAME:"OpenLayers.Format.OWSCommon.v1"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.OWSCommon.v1_0_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1,{namespaces:{ows:"http://www.opengis.net/ows",xlink:"http://www.w3.org/1999/xlink"},readers:{ows:OpenLayers.Util.applyDefaults({ExceptionReport:function(e,t){t.success=!1,t.exceptionReport={version:e.getAttribute("version"),language:e.getAttribute("language"),exceptions:[]},this.readChildNodes(e,t.exceptionReport)}},OpenLayers.Format.OWSCommon.v1.prototype.readers.ows)},writers:{ows:OpenLayers.Format.OWSCommon.v1.prototype.writers.ows},CLASS_NAME:"OpenLayers.Format.OWSCommon.v1_0_0"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.OWSContext.v0_3_1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{owc:"http://www.opengis.net/ows-context",gml:"http://www.opengis.net/gml",kml:"http://www.opengis.net/kml/2.2",ogc:"http://www.opengis.net/ogc",ows:"http://www.opengis.net/ows",sld:"http://www.opengis.net/sld",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},VERSION:"0.3.1",schemaLocation:"http://www.opengis.net/ows-context http://www.ogcnetwork.net/schemas/owc/0.3.1/owsContext.xsd",defaultPrefix:"owc",extractAttributes:!0,xy:!0,regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},featureNS:"http://mapserver.gis.umn.edu/mapserver",featureType:"vector",geometryName:"geometry",nestingLayerLookup:null,initialize:function(e){OpenLayers.Format.XML.prototype.initialize.apply(this,[e]),OpenLayers.Format.GML.v2.prototype.setGeometryTypes.call(this)},setNestingPath:function(e){if(e.layersContext)for(var t=0,i=e.layersContext.length;i>t;t++){var s=e.layersContext[t],n=[],r=e.title||"";e.metadata&&e.metadata.nestingPath&&(n=e.metadata.nestingPath.slice()),""!=r&&n.push(r),s.metadata.nestingPath=n,s.layersContext&&this.setNestingPath(s)}},decomposeNestingPath:function(e){var t=[];if(OpenLayers.Util.isArray(e)){for(var i=e.slice();i.length>0;)t.push(i.slice()),i.pop();t.reverse()}return t},read:function(e){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e])),e&&9==e.nodeType&&(e=e.documentElement);var t={};this.readNode(e,t),this.setNestingPath({layersContext:t.layersContext});var i=[];return this.processLayer(i,t),delete t.layersContext,t.layersContext=i,t},processLayer:function(e,t){if(t.layersContext)for(var i=0,s=t.layersContext.length;s>i;i++){var n=t.layersContext[i];e.push(n),n.layersContext&&this.processLayer(e,n)}},write:function(e,t){var i="OWSContext";this.nestingLayerLookup={},t=t||{},OpenLayers.Util.applyDefaults(t,e);var s=this.writeNode(i,t);return this.nestingLayerLookup=null,this.setAttributeNS(s,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation),OpenLayers.Format.XML.prototype.write.apply(this,[s])},readers:{kml:{Document:function(e,t){t.features=new OpenLayers.Format.KML({kmlns:this.namespaces.kml,extractStyles:!0}).read(e)}},owc:{OWSContext:function(e,t){this.readChildNodes(e,t)},General:function(e,t){this.readChildNodes(e,t)},ResourceList:function(e,t){this.readChildNodes(e,t)},Layer:function(e,t){var i={metadata:{},visibility:"1"!=e.getAttribute("hidden"),queryable:"1"==e.getAttribute("queryable"),opacity:null!=e.getAttribute("opacity")?parseFloat(e.getAttribute("opacity")):null,name:e.getAttribute("name"),categoryLayer:null==e.getAttribute("name"),formats:[],styles:[]};t.layersContext||(t.layersContext=[]),t.layersContext.push(i),this.readChildNodes(e,i)},InlineGeometry:function(e,t){t.features=[];var i,s=this.getElementsByTagNameNS(e,this.namespaces.gml,"featureMember");if(s.length>=1&&(i=s[0]),i&&i.firstChild){var n=i.firstChild.nextSibling?i.firstChild.nextSibling:i.firstChild;this.setNamespace("feature",n.namespaceURI),this.featureType=n.localName||n.nodeName.split(":").pop(),this.readChildNodes(e,t)}},Server:function(e,t){(!t.service&&!t.version||t.service!=OpenLayers.Format.Context.serviceTypes.WMS)&&(t.service=e.getAttribute("service"),t.version=e.getAttribute("version"),this.readChildNodes(e,t))},Name:function(e,t){t.name=this.getChildValue(e),this.readChildNodes(e,t)},Title:function(e,t){t.title=this.getChildValue(e),this.readChildNodes(e,t)},StyleList:function(e,t){this.readChildNodes(e,t.styles)},Style:function(e,t){var i={};t.push(i),this.readChildNodes(e,i)},LegendURL:function(e,t){var i={};t.legend=i,this.readChildNodes(e,i)},OnlineResource:function(e,t){t.url=this.getAttributeNS(e,this.namespaces.xlink,"href"),this.readChildNodes(e,t)}},ows:OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows,gml:OpenLayers.Format.GML.v2.prototype.readers.gml,sld:OpenLayers.Format.SLD.v1_0_0.prototype.readers.sld,feature:OpenLayers.Format.GML.v2.prototype.readers.feature},writers:{owc:{OWSContext:function(e){var t=this.createElementNSPlus("OWSContext",{attributes:{version:this.VERSION,id:e.id||OpenLayers.Util.createUniqueID("OpenLayers_OWSContext_")}});return this.writeNode("General",e,t),this.writeNode("ResourceList",e,t),t},General:function(e){var t=this.createElementNSPlus("General");return this.writeNode("ows:BoundingBox",e,t),this.writeNode("ows:Title",e.title||"OpenLayers OWSContext",t),t},ResourceList:function(e){for(var t=this.createElementNSPlus("ResourceList"),i=0,s=e.layers.length;s>i;i++){var n=e.layers[i],r=this.decomposeNestingPath(n.metadata.nestingPath);this.writeNode("_Layer",{layer:n,subPaths:r},t)}return t},Server:function(e){var t=this.createElementNSPlus("Server",{attributes:{version:e.version,service:e.service}});return this.writeNode("OnlineResource",e,t),t},OnlineResource:function(e){var t=this.createElementNSPlus("OnlineResource",{attributes:{"xlink:href":e.url}});return t},InlineGeometry:function(e){var t=this.createElementNSPlus("InlineGeometry");this.writeNode("gml:boundedBy",e.getDataExtent(),t);for(var i=0,s=e.features.length;s>i;i++)this.writeNode("gml:featureMember",e.features[i],t);return t},StyleList:function(e){for(var t=this.createElementNSPlus("StyleList"),i=0,s=e.length;s>i;i++)this.writeNode("Style",e[i],t);return t},Style:function(e){var t=this.createElementNSPlus("Style");return this.writeNode("Name",e,t),this.writeNode("Title",e,t),e.legend&&this.writeNode("LegendURL",e,t),t},Name:function(e){var t=this.createElementNSPlus("Name",{value:e.name});return t},Title:function(e){var t=this.createElementNSPlus("Title",{value:e.title});return t},LegendURL:function(e){var t=this.createElementNSPlus("LegendURL");return this.writeNode("OnlineResource",e.legend,t),t},_WMS:function(e){var t=this.createElementNSPlus("Layer",{attributes:{name:e.params.LAYERS,queryable:e.queryable?"1":"0",hidden:e.visibility?"0":"1",opacity:e.hasOwnProperty("opacity")?e.opacity:null}});return this.writeNode("ows:Title",e.name,t),this.writeNode("ows:OutputFormat",e.params.FORMAT,t),this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.WMS,version:e.params.VERSION,url:e.url},t),e.metadata.styles&&e.metadata.styles.length>0&&this.writeNode("StyleList",e.metadata.styles,t),t},_Layer:function(e){var t,i,s,n;if(t=e.layer,i=e.subPaths,s=null,n=null,i.length>0){var r=i[0].join("/"),a=r.lastIndexOf("/");return s=this.nestingLayerLookup[r],n=a>0?r.substring(a+1,r.length):r,s||(s=this.createElementNSPlus("Layer"),this.writeNode("ows:Title",n,s),this.nestingLayerLookup[r]=s),e.subPaths.shift(),this.writeNode("_Layer",e,s),s}return t instanceof OpenLayers.Layer.WMS?s=this.writeNode("_WMS",t):t instanceof OpenLayers.Layer.Vector&&(t.protocol instanceof OpenLayers.Protocol.WFS.v1?s=this.writeNode("_WFS",t):t.protocol instanceof OpenLayers.Protocol.HTTP?t.protocol.format instanceof OpenLayers.Format.GML?(t.protocol.format.version="2.1.2",s=this.writeNode("_GML",t)):t.protocol.format instanceof OpenLayers.Format.KML&&(t.protocol.format.version="2.2",s=this.writeNode("_KML",t)):(this.setNamespace("feature",this.featureNS),s=this.writeNode("_InlineGeometry",t))),t.options.maxScale&&this.writeNode("sld:MinScaleDenominator",t.options.maxScale,s),t.options.minScale&&this.writeNode("sld:MaxScaleDenominator",t.options.minScale,s),this.nestingLayerLookup[t.name]=s,s},_WFS:function(e){var t=this.createElementNSPlus("Layer",{attributes:{name:e.protocol.featurePrefix+":"+e.protocol.featureType,hidden:e.visibility?"0":"1"}});return this.writeNode("ows:Title",e.name,t),this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.WFS,version:e.protocol.version,url:e.protocol.url},t),t},_InlineGeometry:function(e){var t=this.createElementNSPlus("Layer",{attributes:{name:this.featureType,hidden:e.visibility?"0":"1"}});return this.writeNode("ows:Title",e.name,t),this.writeNode("InlineGeometry",e,t),t},_GML:function(e){var t=this.createElementNSPlus("Layer");return this.writeNode("ows:Title",e.name,t),this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.GML,url:e.protocol.url,version:e.protocol.format.version},t),t},_KML:function(e){var t=this.createElementNSPlus("Layer");return this.writeNode("ows:Title",e.name,t),this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.KML,version:e.protocol.format.version,url:e.protocol.url},t),t}},gml:OpenLayers.Util.applyDefaults({boundedBy:function(e){var t=this.createElementNSPlus("gml:boundedBy");return this.writeNode("gml:Box",e,t),t}},OpenLayers.Format.GML.v2.prototype.writers.gml),ows:OpenLayers.Format.OWSCommon.v1_0_0.prototype.writers.ows,sld:OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld,feature:OpenLayers.Format.GML.v2.prototype.writers.feature},CLASS_NAME:"OpenLayers.Format.OWSContext.v0_3_1"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.CSWGetRecords=function(e){e=OpenLayers.Util.applyDefaults(e,OpenLayers.Format.CSWGetRecords.DEFAULTS);var t=OpenLayers.Format.CSWGetRecords["v"+e.version.replace(/\./g,"_")];if(!t)throw"Unsupported CSWGetRecords version: "+e.version;return new t(e)},OpenLayers.Format.CSWGetRecords.DEFAULTS={version:"2.0.2"},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WFSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.0",errorProperty:"service",CLASS_NAME:"OpenLayers.Format.WFSCapabilities"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WFSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{wfs:"http://www.opengis.net/wfs",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",ows:"http://www.opengis.net/ows"},defaultPrefix:"wfs",read:function(e){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e])),e&&9==e.nodeType&&(e=e.documentElement);var t={};return this.readNode(e,t),t},readers:{wfs:{WFS_Capabilities:function(e,t){this.readChildNodes(e,t)},FeatureTypeList:function(e,t){t.featureTypeList={featureTypes:[]},this.readChildNodes(e,t.featureTypeList)},FeatureType:function(e,t){var i={};this.readChildNodes(e,i),t.featureTypes.push(i)},Name:function(e,t){var i=this.getChildValue(e);if(i){var s=i.split(":");t.name=s.pop(),s.length>0&&(t.featureNS=this.lookupNamespaceURI(e,s[0]))}},Title:function(e,t){var i=this.getChildValue(e);i&&(t.title=i)},Abstract:function(e,t){var i=this.getChildValue(e);i&&(t["abstract"]=i)}}},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WFSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1,{regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},readers:{wfs:OpenLayers.Util.applyDefaults({DefaultSRS:function(e,t){var i=this.getChildValue(e);i&&(t.srs=i)}},OpenLayers.Format.WFSCapabilities.v1.prototype.readers.wfs),ows:OpenLayers.Format.OWSCommon.v1.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1_1_0"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.GeoRSS=OpenLayers.Class(OpenLayers.Format.XML,{rssns:"http://backend.userland.com/rss2",featureNS:"http://mapserver.gis.umn.edu/mapserver",georssns:"http://www.georss.org/georss",geons:"http://www.w3.org/2003/01/geo/wgs84_pos#",featureTitle:"Untitled",featureDescription:"No Description",gmlParser:null,xy:!1,createGeometryFromItem:function(e){var t=this.getElementsByTagNameNS(e,this.georssns,"point"),i=this.getElementsByTagNameNS(e,this.geons,"lat"),s=this.getElementsByTagNameNS(e,this.geons,"long"),n=this.getElementsByTagNameNS(e,this.georssns,"line"),r=this.getElementsByTagNameNS(e,this.georssns,"polygon"),a=this.getElementsByTagNameNS(e,this.georssns,"where"),o=this.getElementsByTagNameNS(e,this.georssns,"box");if(t.length>0||i.length>0&&s.length>0){var l;t.length>0?(l=OpenLayers.String.trim(t[0].firstChild.nodeValue).split(/\s+/),2!=l.length&&(l=OpenLayers.String.trim(t[0].firstChild.nodeValue).split(/\s*,\s*/))):l=[parseFloat(i[0].firstChild.nodeValue),parseFloat(s[0].firstChild.nodeValue)];var h=new OpenLayers.Geometry.Point(l[1],l[0])}else if(n.length>0){for(var t,u=OpenLayers.String.trim(this.getChildValue(n[0])).split(/\s+/),c=[],d=0,p=u.length;p>d;d+=2)t=new OpenLayers.Geometry.Point(u[d+1],u[d]),c.push(t);h=new OpenLayers.Geometry.LineString(c)}else if(r.length>0){for(var t,u=OpenLayers.String.trim(this.getChildValue(r[0])).split(/\s+/),c=[],d=0,p=u.length;p>d;d+=2)t=new OpenLayers.Geometry.Point(u[d+1],u[d]),c.push(t);h=new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(c)])}else if(a.length>0){this.gmlParser||(this.gmlParser=new OpenLayers.Format.GML({xy:this.xy}));var f=this.gmlParser.parseFeature(a[0]);h=f.geometry}else if(o.length>0){var t,u=OpenLayers.String.trim(o[0].firstChild.nodeValue).split(/\s+/),c=[];u.length>3&&(t=new OpenLayers.Geometry.Point(u[1],u[0]),c.push(t),t=new OpenLayers.Geometry.Point(u[1],u[2]),c.push(t),t=new OpenLayers.Geometry.Point(u[3],u[2]),c.push(t),t=new OpenLayers.Geometry.Point(u[3],u[0]),c.push(t),t=new OpenLayers.Geometry.Point(u[1],u[0]),c.push(t)),h=new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(c)])}return h&&this.internalProjection&&this.externalProjection&&h.transform(this.externalProjection,this.internalProjection),h},createFeatureFromItem:function(e){var t=this.createGeometryFromItem(e),i=this._getChildValue(e,"*","title",this.featureTitle),s=this._getChildValue(e,"*","description",this._getChildValue(e,"*","content",this._getChildValue(e,"*","summary",this.featureDescription))),n=this._getChildValue(e,"*","link");if(!n)try{n=this.getElementsByTagNameNS(e,"*","link")[0].getAttribute("href")}catch(r){n=null}var a=this._getChildValue(e,"*","id",null),o={title:i,description:s,link:n},l=new OpenLayers.Feature.Vector(t,o);return l.fid=a,l},_getChildValue:function(e,t,i,s){var n,r=this.getElementsByTagNameNS(e,t,i);return n=r&&r[0]&&r[0].firstChild&&r[0].firstChild.nodeValue?this.getChildValue(r[0]):void 0==s?"":s},read:function(e){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e]));var t=null;t=this.getElementsByTagNameNS(e,"*","item"),0==t.length&&(t=this.getElementsByTagNameNS(e,"*","entry"));for(var i=t.length,s=new Array(i),n=0;i>n;n++)s[n]=this.createFeatureFromItem(t[n]);return s},write:function(e){var t;if(OpenLayers.Util.isArray(e)){t=this.createElementNS(this.rssns,"rss");for(var i=0,s=e.length;s>i;i++)t.appendChild(this.createFeatureXML(e[i]))}else t=this.createFeatureXML(e);return OpenLayers.Format.XML.prototype.write.apply(this,[t])},createFeatureXML:function(e){var t=this.buildGeometryNode(e.geometry),i=this.createElementNS(this.rssns,"item"),s=this.createElementNS(this.rssns,"title");s.appendChild(this.createTextNode(e.attributes.title?e.attributes.title:""));var n=this.createElementNS(this.rssns,"description");if(n.appendChild(this.createTextNode(e.attributes.description?e.attributes.description:"")),i.appendChild(s),i.appendChild(n),e.attributes.link){var r=this.createElementNS(this.rssns,"link");r.appendChild(this.createTextNode(e.attributes.link)),i.appendChild(r)}for(var a in e.attributes)if("link"!=a&&"title"!=a&&"description"!=a){var o=this.createTextNode(e.attributes[a]),l=a;-1!=a.search(":")&&(l=a.split(":")[1]);var h=this.createElementNS(this.featureNS,"feature:"+l);h.appendChild(o),i.appendChild(h)}return i.appendChild(t),i},buildGeometryNode:function(e){this.internalProjection&&this.externalProjection&&(e=e.clone(),e.transform(this.internalProjection,this.externalProjection));var t;if("OpenLayers.Geometry.Polygon"==e.CLASS_NAME)t=this.createElementNS(this.georssns,"georss:polygon"),t.appendChild(this.buildCoordinatesNode(e.components[0]));else if("OpenLayers.Geometry.LineString"==e.CLASS_NAME)t=this.createElementNS(this.georssns,"georss:line"),t.appendChild(this.buildCoordinatesNode(e));else{if("OpenLayers.Geometry.Point"!=e.CLASS_NAME)throw"Couldn't parse "+e.CLASS_NAME;t=this.createElementNS(this.georssns,"georss:point"),t.appendChild(this.buildCoordinatesNode(e))}return t},buildCoordinatesNode:function(e){var t=null;e.components&&(t=e.components);var i;if(t){for(var s=t.length,n=new Array(s),r=0;s>r;r++)n[r]=t[r].y+" "+t[r].x;i=n.join(" ")}else i=e.y+" "+e.x;return this.createTextNode(i)},CLASS_NAME:"OpenLayers.Format.GeoRSS"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Events.buttonclick=OpenLayers.Class({target:null,events:["mousedown","mouseup","click","dblclick","touchstart","touchmove","touchend","keydown"],startRegEx:/^mousedown|touchstart$/,cancelRegEx:/^touchmove$/,completeRegEx:/^mouseup|touchend$/,initialize:function(e){this.target=e;for(var t=this.events.length-1;t>=0;--t)this.target.register(this.events[t],this,this.buttonClick,{extension:!0})},destroy:function(){for(var e=this.events.length-1;e>=0;--e)this.target.unregister(this.events[e],this,this.buttonClick);delete this.target},getPressedButton:function(e){var t,i=3;do{if(OpenLayers.Element.hasClass(e,"olButton")){t=e;break}e=e.parentNode}while(--i>0&&e);return t},buttonClick:function(e){var t=!0,i=OpenLayers.Event.element(e);if(i&&(OpenLayers.Event.isLeftClick(e)||!~e.type.indexOf("mouse"))){var s=this.getPressedButton(i);if(s){if("keydown"===e.type)switch(e.keyCode){case OpenLayers.Event.KEY_RETURN:case OpenLayers.Event.KEY_SPACE:this.target.triggerEvent("buttonclick",{buttonElement:s}),OpenLayers.Event.stop(e),t=!1}else if(this.startEvt){if(this.completeRegEx.test(e.type)){var n=OpenLayers.Util.pagePosition(s);this.target.triggerEvent("buttonclick",{buttonElement:s,buttonXY:{x:this.startEvt.clientX-n[0],y:this.startEvt.clientY-n[1]}})}this.cancelRegEx.test(e.type)&&delete this.startEvt,OpenLayers.Event.stop(e),t=!1}this.startRegEx.test(e.type)&&(this.startEvt=e,OpenLayers.Event.stop(e),t=!1)}else delete this.startEvt}return t}}),/**
 * Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. 
 *
 * @requires OpenLayers/SingleFile.js
 */
OpenLayers.Animation=function(e){function t(e,t,i){t=t>0?t:Number.POSITIVE_INFINITY;var s=++r,o=+new Date;return a[s]=function(){a[s]&&+new Date-o<=t?(e(),a[s]&&n(a[s],i)):delete a[s]},n(a[s],i),s}function i(e){delete a[e]}var s=!!(e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame),n=function(){var t=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){e.setTimeout(t,16)};return function(i,s){t.apply(e,[i,s])}}(),r=0,a={};return{isNative:s,requestFrame:n,start:t,stop:i}}(window),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Tween=OpenLayers.Class({easing:null,begin:null,finish:null,duration:null,callbacks:null,time:null,animationId:null,playing:!1,initialize:function(e){this.easing=e?e:OpenLayers.Easing.Expo.easeOut},start:function(e,t,i,s){this.playing=!0,this.begin=e,this.finish=t,this.duration=i,this.callbacks=s.callbacks,this.time=0,OpenLayers.Animation.stop(this.animationId),this.animationId=null,this.callbacks&&this.callbacks.start&&this.callbacks.start.call(this,this.begin),this.animationId=OpenLayers.Animation.start(OpenLayers.Function.bind(this.play,this))},stop:function(){this.playing&&(this.callbacks&&this.callbacks.done&&this.callbacks.done.call(this,this.finish),OpenLayers.Animation.stop(this.animationId),this.animationId=null,this.playing=!1)},play:function(){var e={};for(var t in this.begin){var i=this.begin[t],s=this.finish[t];if(null==i||null==s||isNaN(i)||isNaN(s))throw new TypeError("invalid value for Tween");var n=s-i;e[t]=this.easing.apply(this,[this.time,i,n,this.duration])}this.time++,this.callbacks&&this.callbacks.eachStep&&this.callbacks.eachStep.call(this,e),this.time>this.duration&&this.stop()},CLASS_NAME:"OpenLayers.Tween"}),OpenLayers.Easing={CLASS_NAME:"OpenLayers.Easing"},OpenLayers.Easing.Linear={easeIn:function(e,t,i,s){return i*e/s+t},easeOut:function(e,t,i,s){return i*e/s+t},easeInOut:function(e,t,i,s){return i*e/s+t},CLASS_NAME:"OpenLayers.Easing.Linear"},OpenLayers.Easing.Expo={easeIn:function(e,t,i,s){return 0==e?t:i*Math.pow(2,10*(e/s-1))+t},easeOut:function(e,t,i,s){return e==s?t+i:i*(-Math.pow(2,-10*e/s)+1)+t},easeInOut:function(e,t,i,s){return 0==e?t:e==s?t+i:(e/=s/2)<1?i/2*Math.pow(2,10*(e-1))+t:i/2*(-Math.pow(2,-10*--e)+2)+t},CLASS_NAME:"OpenLayers.Easing.Expo"},OpenLayers.Easing.Quad={easeIn:function(e,t,i,s){return i*(e/=s)*e+t},easeOut:function(e,t,i,s){return-i*(e/=s)*(e-2)+t},easeInOut:function(e,t,i,s){return(e/=s/2)<1?i/2*e*e+t:-i/2*(--e*(e-2)-1)+t},CLASS_NAME:"OpenLayers.Easing.Quad"},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Map=OpenLayers.Class({Z_INDEX_BASE:{BaseLayer:100,Overlay:325,Feature:725,Popup:750,Control:1e3},id:null,fractionalZoom:!1,events:null,allOverlays:!1,div:null,dragging:!1,size:null,viewPortDiv:null,layerContainerOrigin:null,layerContainerDiv:null,layers:null,controls:null,popups:null,baseLayer:null,center:null,resolution:null,zoom:0,panRatio:1.5,options:null,tileSize:null,projection:"EPSG:4326",units:null,resolutions:null,maxResolution:null,minResolution:null,maxScale:null,minScale:null,maxExtent:null,minExtent:null,restrictedExtent:null,numZoomLevels:16,theme:null,displayProjection:null,fallThrough:!0,panTween:null,eventListeners:null,panMethod:OpenLayers.Easing.Expo.easeOut,panDuration:50,paddingForPopups:null,minPx:null,maxPx:null,initialize:function(e,t){1===arguments.length&&"object"==typeof e&&(t=e,e=t&&t.div),this.tileSize=new OpenLayers.Size(OpenLayers.Map.TILE_WIDTH,OpenLayers.Map.TILE_HEIGHT),this.paddingForPopups=new OpenLayers.Bounds(15,15,15,15),this.options=OpenLayers.Util.extend({},t),OpenLayers.Util.extend(this,t);var i=this.projection instanceof OpenLayers.Projection?this.projection.projCode:this.projection;OpenLayers.Util.applyDefaults(this,OpenLayers.Projection.defaults[i]),!this.maxExtent||this.maxExtent instanceof OpenLayers.Bounds||(this.maxExtent=new OpenLayers.Bounds(this.maxExtent)),!this.minExtent||this.minExtent instanceof OpenLayers.Bounds||(this.minExtent=new OpenLayers.Bounds(this.minExtent)),!this.restrictedExtent||this.restrictedExtent instanceof OpenLayers.Bounds||(this.restrictedExtent=new OpenLayers.Bounds(this.restrictedExtent)),!this.center||this.center instanceof OpenLayers.LonLat||(this.center=new OpenLayers.LonLat(this.center)),this.layers=[],this.id=OpenLayers.Util.createUniqueID("OpenLayers.Map_"),this.div=OpenLayers.Util.getElement(e),this.div||(this.div=document.createElement("div"),this.div.style.height="1px",this.div.style.width="1px"),OpenLayers.Element.addClass(this.div,"olMap");var s=this.id+"_OpenLayers_ViewPort";if(this.viewPortDiv=OpenLayers.Util.createDiv(s,null,null,null,"relative",null,"hidden"),this.viewPortDiv.style.width="100%",this.viewPortDiv.style.height="100%",this.viewPortDiv.className="olMapViewport",this.div.appendChild(this.viewPortDiv),this.events=new OpenLayers.Events(this,this.viewPortDiv,null,this.fallThrough,{includeXY:!0}),s=this.id+"_OpenLayers_Container",this.layerContainerDiv=OpenLayers.Util.createDiv(s),this.layerContainerDiv.style.width="100px",this.layerContainerDiv.style.height="100px",this.layerContainerDiv.style.zIndex=this.Z_INDEX_BASE.Popup-1,this.viewPortDiv.appendChild(this.layerContainerDiv),this.updateSize(),this.eventListeners instanceof Object&&this.events.on(this.eventListeners),parseFloat(navigator.appVersion.split("MSIE")[1])<9?this.events.register("resize",this,this.updateSize):(this.updateSizeDestroy=OpenLayers.Function.bind(this.updateSize,this),OpenLayers.Event.observe(window,"resize",this.updateSizeDestroy)),this.theme){for(var n=!0,r=document.getElementsByTagName("link"),a=0,o=r.length;o>a;++a)if(OpenLayers.Util.isEquivalentUrl(r.item(a).href,this.theme)){n=!1;break}if(n){var l=document.createElement("link");l.setAttribute("rel","stylesheet"),l.setAttribute("type","text/css"),l.setAttribute("href",this.theme),document.getElementsByTagName("head")[0].appendChild(l)}}null==this.controls&&(this.controls=[],null!=OpenLayers.Control&&(OpenLayers.Control.Navigation?this.controls.push(new OpenLayers.Control.Navigation):OpenLayers.Control.TouchNavigation&&this.controls.push(new OpenLayers.Control.TouchNavigation),OpenLayers.Control.Zoom?this.controls.push(new OpenLayers.Control.Zoom):OpenLayers.Control.PanZoom&&this.controls.push(new OpenLayers.Control.PanZoom),OpenLayers.Control.ArgParser&&this.controls.push(new OpenLayers.Control.ArgParser),OpenLayers.Control.Attribution&&this.controls.push(new OpenLayers.Control.Attribution)));for(var a=0,o=this.controls.length;o>a;a++)this.addControlToMap(this.controls[a]);this.popups=[],this.unloadDestroy=OpenLayers.Function.bind(this.destroy,this),OpenLayers.Event.observe(window,"unload",this.unloadDestroy),t&&t.layers&&(delete this.center,this.addLayers(t.layers),t.center&&!this.getCenter()&&this.setCenter(t.center,t.zoom))},getViewport:function(){return this.viewPortDiv},render:function(e){this.div=OpenLayers.Util.getElement(e),OpenLayers.Element.addClass(this.div,"olMap"),this.viewPortDiv.parentNode.removeChild(this.viewPortDiv),this.div.appendChild(this.viewPortDiv),this.updateSize()},unloadDestroy:null,updateSizeDestroy:null,destroy:function(){if(!this.unloadDestroy)return!1;if(this.panTween&&(this.panTween.stop(),this.panTween=null),OpenLayers.Event.stopObserving(window,"unload",this.unloadDestroy),this.unloadDestroy=null,this.updateSizeDestroy?OpenLayers.Event.stopObserving(window,"resize",this.updateSizeDestroy):this.events.unregister("resize",this,this.updateSize),this.paddingForPopups=null,null!=this.controls){for(var e=this.controls.length-1;e>=0;--e)this.controls[e].destroy();this.controls=null}if(null!=this.layers){for(var e=this.layers.length-1;e>=0;--e)this.layers[e].destroy(!1);this.layers=null}this.viewPortDiv&&this.div.removeChild(this.viewPortDiv),this.viewPortDiv=null,this.eventListeners&&(this.events.un(this.eventListeners),this.eventListeners=null),this.events.destroy(),this.events=null,this.options=null},setOptions:function(e){var t=this.minPx&&e.restrictedExtent!=this.restrictedExtent;OpenLayers.Util.extend(this,e),t&&this.moveTo(this.getCachedCenter(),this.zoom,{forceZoomChange:!0})},getTileSize:function(){return this.tileSize},getBy:function(e,t,i){var s="function"==typeof i.test,n=OpenLayers.Array.filter(this[e],function(e){return e[t]==i||s&&i.test(e[t])});return n},getLayersBy:function(e,t){return this.getBy("layers",e,t)},getLayersByName:function(e){return this.getLayersBy("name",e)},getLayersByClass:function(e){return this.getLayersBy("CLASS_NAME",e)},getControlsBy:function(e,t){return this.getBy("controls",e,t)},getControlsByClass:function(e){return this.getControlsBy("CLASS_NAME",e)},getLayer:function(e){for(var t=null,i=0,s=this.layers.length;s>i;i++){var n=this.layers[i];if(n.id==e){t=n;break}}return t},setLayerZIndex:function(e,t){e.setZIndex(this.Z_INDEX_BASE[e.isBaseLayer?"BaseLayer":"Overlay"]+5*t)},resetLayersZIndex:function(){for(var e=0,t=this.layers.length;t>e;e++){var i=this.layers[e];this.setLayerZIndex(i,e)}},addLayer:function(e){for(var t=0,i=this.layers.length;i>t;t++)if(this.layers[t]==e)return!1;return this.events.triggerEvent("preaddlayer",{layer:e})===!1?!1:(this.allOverlays&&(e.isBaseLayer=!1),e.div.className="olLayerDiv",e.div.style.overflow="",this.setLayerZIndex(e,this.layers.length),e.isFixed?this.viewPortDiv.appendChild(e.div):this.layerContainerDiv.appendChild(e.div),this.layers.push(e),e.setMap(this),e.isBaseLayer||this.allOverlays&&!this.baseLayer?null==this.baseLayer?this.setBaseLayer(e):e.setVisibility(!1):e.redraw(),this.events.triggerEvent("addlayer",{layer:e}),e.events.triggerEvent("added",{map:this,layer:e}),e.afterAdd(),!0)},addLayers:function(e){for(var t=0,i=e.length;i>t;t++)this.addLayer(e[t])},removeLayer:function(e,t){if(this.events.triggerEvent("preremovelayer",{layer:e})!==!1){if(null==t&&(t=!0),e.isFixed?this.viewPortDiv.removeChild(e.div):this.layerContainerDiv.removeChild(e.div),OpenLayers.Util.removeItem(this.layers,e),e.removeMap(this),e.map=null,this.baseLayer==e&&(this.baseLayer=null,t))for(var i=0,s=this.layers.length;s>i;i++){var n=this.layers[i];if(n.isBaseLayer||this.allOverlays){this.setBaseLayer(n);break}}this.resetLayersZIndex(),this.events.triggerEvent("removelayer",{layer:e}),e.events.triggerEvent("removed",{map:this,layer:e})}},getNumLayers:function(){return this.layers.length},getLayerIndex:function(e){return OpenLayers.Util.indexOf(this.layers,e)},setLayerIndex:function(e,t){var i=this.getLayerIndex(e);if(0>t?t=0:t>this.layers.length&&(t=this.layers.length),i!=t){this.layers.splice(i,1),this.layers.splice(t,0,e);for(var s=0,n=this.layers.length;n>s;s++)this.setLayerZIndex(this.layers[s],s);this.events.triggerEvent("changelayer",{layer:e,property:"order"}),this.allOverlays&&(0===t?this.setBaseLayer(e):this.baseLayer!==this.layers[0]&&this.setBaseLayer(this.layers[0]))}},raiseLayer:function(e,t){var i=this.getLayerIndex(e)+t;this.setLayerIndex(e,i)},setBaseLayer:function(e){if(e!=this.baseLayer&&-1!=OpenLayers.Util.indexOf(this.layers,e)){var t=this.getCachedCenter(),i=OpenLayers.Util.getResolutionFromScale(this.getScale(),e.units);if(null==this.baseLayer||this.allOverlays||this.baseLayer.setVisibility(!1),this.baseLayer=e,(!this.allOverlays||this.baseLayer.visibility)&&(this.baseLayer.setVisibility(!0),this.baseLayer.inRange===!1&&this.baseLayer.redraw()),null!=t){var s=this.getZoomForResolution(i||this.resolution,!0);this.setCenter(t,s,!1,!0)}this.events.triggerEvent("changebaselayer",{layer:this.baseLayer})}},addControl:function(e,t){this.controls.push(e),this.addControlToMap(e,t)},addControls:function(e,t){for(var i=1===arguments.length?[]:t,s=0,n=e.length;n>s;s++){var r=e[s],a=i[s]?i[s]:null;this.addControl(r,a)}},addControlToMap:function(e,t){e.outsideViewport=null!=e.div,this.displayProjection&&!e.displayProjection&&(e.displayProjection=this.displayProjection),e.setMap(this);var i=e.draw(t);i&&(e.outsideViewport||(i.style.zIndex=this.Z_INDEX_BASE.Control+this.controls.length,this.viewPortDiv.appendChild(i))),e.autoActivate&&e.activate()},getControl:function(e){for(var t=null,i=0,s=this.controls.length;s>i;i++){var n=this.controls[i];if(n.id==e){t=n;break}}return t},removeControl:function(e){e&&e==this.getControl(e.id)&&(e.div&&e.div.parentNode==this.viewPortDiv&&this.viewPortDiv.removeChild(e.div),OpenLayers.Util.removeItem(this.controls,e))},addPopup:function(e,t){if(t)for(var i=this.popups.length-1;i>=0;--i)this.removePopup(this.popups[i]);e.map=this,this.popups.push(e);var s=e.draw();s&&(s.style.zIndex=this.Z_INDEX_BASE.Popup+this.popups.length,this.layerContainerDiv.appendChild(s))},removePopup:function(e){if(OpenLayers.Util.removeItem(this.popups,e),e.div)try{this.layerContainerDiv.removeChild(e.div)}catch(t){}e.map=null},getSize:function(){var e=null;return null!=this.size&&(e=this.size.clone()),e},updateSize:function(){var e=this.getCurrentSize();if(e&&!isNaN(e.h)&&!isNaN(e.w)){this.events.clearMouseCache();var t=this.getSize();if(null==t&&(this.size=t=e),!e.equals(t)){this.size=e;for(var i=0,s=this.layers.length;s>i;i++)this.layers[i].onMapResize();var n=this.getCachedCenter();if(null!=this.baseLayer&&null!=n){var r=this.getZoom();this.zoom=null,this.setCenter(n,r)}}}},getCurrentSize:function(){var e=new OpenLayers.Size(this.div.clientWidth,this.div.clientHeight);return(0==e.w&&0==e.h||isNaN(e.w)&&isNaN(e.h))&&(e.w=this.div.offsetWidth,e.h=this.div.offsetHeight),(0==e.w&&0==e.h||isNaN(e.w)&&isNaN(e.h))&&(e.w=parseInt(this.div.style.width),e.h=parseInt(this.div.style.height)),e},calculateBounds:function(e,t){var i=null;if(null==e&&(e=this.getCachedCenter()),null==t&&(t=this.getResolution()),null!=e&&null!=t){var s=this.size.w*t/2,n=this.size.h*t/2;i=new OpenLayers.Bounds(e.lon-s,e.lat-n,e.lon+s,e.lat+n)}return i},getCenter:function(){var e=null,t=this.getCachedCenter();return t&&(e=t.clone()),e},getCachedCenter:function(){return!this.center&&this.size&&(this.center=this.getLonLatFromViewPortPx({x:this.size.w/2,y:this.size.h/2})),this.center},getZoom:function(){return this.zoom},pan:function(e,t,i){if(i=OpenLayers.Util.applyDefaults(i,{animate:!0,dragging:!1}),i.dragging)(0!=e||0!=t)&&this.moveByPx(e,t);else{var s=this.getViewPortPxFromLonLat(this.getCachedCenter()),n=s.add(e,t);if(this.dragging||!n.equals(s)){var r=this.getLonLatFromViewPortPx(n);i.animate?this.panTo(r):(this.moveTo(r),this.dragging&&(this.dragging=!1,this.events.triggerEvent("moveend")))}}},panTo:function(e){if(this.panMethod&&this.getExtent().scale(this.panRatio).containsLonLat(e)){this.panTween||(this.panTween=new OpenLayers.Tween(this.panMethod));var t=this.getCachedCenter();if(e.equals(t))return;var i=this.getPixelFromLonLat(t),s=this.getPixelFromLonLat(e),n={x:s.x-i.x,y:s.y-i.y},r={x:0,y:0};this.panTween.start({x:0,y:0},n,this.panDuration,{callbacks:{eachStep:OpenLayers.Function.bind(function(e){var t=e.x-r.x,i=e.y-r.y;this.moveByPx(t,i),r.x=Math.round(e.x),r.y=Math.round(e.y)},this),done:OpenLayers.Function.bind(function(){this.moveTo(e),this.dragging=!1,this.events.triggerEvent("moveend")},this)}})}else this.setCenter(e)},setCenter:function(e,t,i,s){this.panTween&&this.panTween.stop(),this.moveTo(e,t,{dragging:i,forceZoomChange:s})},moveByPx:function(e,t){var i=this.size.w/2,s=this.size.h/2,n=i+e,r=s+t,a=this.baseLayer.wrapDateLine,o=0,l=0;if(this.restrictedExtent&&(o=i,l=s,a=!1),e=a||n<=this.maxPx.x-o&&n>=this.minPx.x+o?Math.round(e):0,t=r<=this.maxPx.y-l&&r>=this.minPx.y+l?Math.round(t):0,e||t){this.dragging||(this.dragging=!0,this.events.triggerEvent("movestart")),this.center=null,e&&(this.layerContainerDiv.style.left=parseInt(this.layerContainerDiv.style.left)-e+"px",this.minPx.x-=e,this.maxPx.x-=e),t&&(this.layerContainerDiv.style.top=parseInt(this.layerContainerDiv.style.top)-t+"px",this.minPx.y-=t,this.maxPx.y-=t);var h,u,c;for(u=0,c=this.layers.length;c>u;++u)h=this.layers[u],h.visibility&&(h===this.baseLayer||h.inRange)&&(h.moveByPx(e,t),h.events.triggerEvent("move"));this.events.triggerEvent("move")}},adjustZoom:function(e){var t=this.baseLayer.resolutions,i=this.getMaxExtent().getWidth()/this.size.w;if(this.getResolutionForZoom(e)>i)for(var s=0|e,n=t.length;n>s;++s)if(t[s]<=i){e=s;break}return e},moveTo:function(e,t,i){if(null==e||e instanceof OpenLayers.LonLat||(e=new OpenLayers.LonLat(e)),i||(i={}),null!=t&&(t=parseFloat(t),this.fractionalZoom||(t=Math.round(t))),this.baseLayer.wrapDateLine){var s=t;t=this.adjustZoom(t),t!==s&&(e=this.getCenter())}var n=i.dragging||this.dragging,r=i.forceZoomChange;if(this.getCachedCenter()||this.isValidLonLat(e)||(e=this.maxExtent.getCenterLonLat(),this.center=e.clone()),null!=this.restrictedExtent){null==e&&(e=this.center),null==t&&(t=this.getZoom());var a=this.getResolutionForZoom(t),o=this.calculateBounds(e,a);if(!this.restrictedExtent.containsBounds(o)){var l=this.restrictedExtent.getCenterLonLat();o.getWidth()>this.restrictedExtent.getWidth()?e=new OpenLayers.LonLat(l.lon,e.lat):o.left<this.restrictedExtent.left?e=e.add(this.restrictedExtent.left-o.left,0):o.right>this.restrictedExtent.right&&(e=e.add(this.restrictedExtent.right-o.right,0)),o.getHeight()>this.restrictedExtent.getHeight()?e=new OpenLayers.LonLat(e.lon,l.lat):o.bottom<this.restrictedExtent.bottom?e=e.add(0,this.restrictedExtent.bottom-o.bottom):o.top>this.restrictedExtent.top&&(e=e.add(0,this.restrictedExtent.top-o.top))}}var h=r||this.isValidZoomLevel(t)&&t!=this.getZoom(),u=this.isValidLonLat(e)&&!e.equals(this.center);if(h||u||n){n||this.events.triggerEvent("movestart"),u&&(!h&&this.center&&this.centerLayerContainer(e),this.center=e.clone());var c=h?this.getResolutionForZoom(t):this.getResolution();if(h||null==this.layerContainerOrigin){this.layerContainerOrigin=this.getCachedCenter(),this.layerContainerDiv.style.left="0px",this.layerContainerDiv.style.top="0px";var d=this.getMaxExtent({restricted:!0}),p=d.getCenterLonLat(),f=this.center.lon-p.lon,m=p.lat-this.center.lat,y=Math.round(d.getWidth()/c),g=Math.round(d.getHeight()/c);this.minPx={x:(this.size.w-y)/2-f/c,y:(this.size.h-g)/2-m/c},this.maxPx={x:this.minPx.x+Math.round(d.getWidth()/c),y:this.minPx.y+Math.round(d.getHeight()/c)}}h&&(this.zoom=t,this.resolution=c);var v=this.getExtent();this.baseLayer.visibility&&(this.baseLayer.moveTo(v,h,i.dragging),i.dragging||this.baseLayer.events.triggerEvent("moveend",{zoomChanged:h})),v=this.baseLayer.getExtent();for(var x=this.layers.length-1;x>=0;--x){var E=this.layers[x];if(E!==this.baseLayer&&!E.isBaseLayer){var b=E.calculateInRange();E.inRange!=b&&(E.inRange=b,b||E.display(!1),this.events.triggerEvent("changelayer",{layer:E,property:"visibility"})),b&&E.visibility&&(E.moveTo(v,h,i.dragging),i.dragging||E.events.triggerEvent("moveend",{zoomChanged:h}))}}if(this.events.triggerEvent("move"),n||this.events.triggerEvent("moveend"),h){for(var x=0,L=this.popups.length;L>x;x++)this.popups[x].updatePosition();this.events.triggerEvent("zoomend")}}},centerLayerContainer:function(e){var t=this.getViewPortPxFromLonLat(this.layerContainerOrigin),i=this.getViewPortPxFromLonLat(e);if(null!=t&&null!=i){var s=parseInt(this.layerContainerDiv.style.left),n=parseInt(this.layerContainerDiv.style.top),r=Math.round(t.x-i.x),a=Math.round(t.y-i.y);this.layerContainerDiv.style.left=r+"px",this.layerContainerDiv.style.top=a+"px";var o=s-r,l=n-a;this.minPx.x-=o,this.maxPx.x-=o,this.minPx.y-=l,this.maxPx.y-=l}},isValidZoomLevel:function(e){return null!=e&&e>=0&&e<this.getNumZoomLevels()},isValidLonLat:function(e){var t=!1;if(null!=e){var i=this.getMaxExtent(),s=this.baseLayer.wrapDateLine&&i;t=i.containsLonLat(e,{worldBounds:s})}return t},getProjection:function(){var e=this.getProjectionObject();return e?e.getCode():null},getProjectionObject:function(){var e=null;return null!=this.baseLayer&&(e=this.baseLayer.projection),e},getMaxResolution:function(){var e=null;return null!=this.baseLayer&&(e=this.baseLayer.maxResolution),e},getMaxExtent:function(e){var t=null;return e&&e.restricted&&this.restrictedExtent?t=this.restrictedExtent:null!=this.baseLayer&&(t=this.baseLayer.maxExtent),t},getNumZoomLevels:function(){var e=null;return null!=this.baseLayer&&(e=this.baseLayer.numZoomLevels),e},getExtent:function(){var e=null;return null!=this.baseLayer&&(e=this.baseLayer.getExtent()),e},getResolution:function(){var e=null;return null!=this.baseLayer?e=this.baseLayer.getResolution():this.allOverlays===!0&&this.layers.length>0&&(e=this.layers[0].getResolution()),e},getUnits:function(){var e=null;return null!=this.baseLayer&&(e=this.baseLayer.units),e},getScale:function(){var e=null;if(null!=this.baseLayer){var t=this.getResolution(),i=this.baseLayer.units;e=OpenLayers.Util.getScaleFromResolution(t,i)}return e},getZoomForExtent:function(e,t){var i=null;return null!=this.baseLayer&&(i=this.baseLayer.getZoomForExtent(e,t)),i},getResolutionForZoom:function(e){var t=null;return this.baseLayer&&(t=this.baseLayer.getResolutionForZoom(e)),t},getZoomForResolution:function(e,t){var i=null;return null!=this.baseLayer&&(i=this.baseLayer.getZoomForResolution(e,t)),i},zoomTo:function(e){this.isValidZoomLevel(e)&&this.setCenter(null,e)},zoomIn:function(){this.zoomTo(this.getZoom()+1)},zoomOut:function(){this.zoomTo(this.getZoom()-1)},zoomToExtent:function(e,t){e instanceof OpenLayers.Bounds||(e=new OpenLayers.Bounds(e));var i=e.getCenterLonLat();if(this.baseLayer.wrapDateLine){var s=this.getMaxExtent();for(e=e.clone();e.right<e.left;)e.right+=s.getWidth();i=e.getCenterLonLat().wrapDateLine(s)}this.setCenter(i,this.getZoomForExtent(e,t))},zoomToMaxExtent:function(e){var t=e?e.restricted:!0,i=this.getMaxExtent({restricted:t});this.zoomToExtent(i)},zoomToScale:function(e,t){var i=OpenLayers.Util.getResolutionFromScale(e,this.baseLayer.units),s=this.size.w*i/2,n=this.size.h*i/2,r=this.getCachedCenter(),a=new OpenLayers.Bounds(r.lon-s,r.lat-n,r.lon+s,r.lat+n);this.zoomToExtent(a,t)},getLonLatFromViewPortPx:function(e){var t=null;return null!=this.baseLayer&&(t=this.baseLayer.getLonLatFromViewPortPx(e)),t},getViewPortPxFromLonLat:function(e){var t=null;return null!=this.baseLayer&&(t=this.baseLayer.getViewPortPxFromLonLat(e)),t},getLonLatFromPixel:function(e){return this.getLonLatFromViewPortPx(e)},getPixelFromLonLat:function(e){var t=this.getViewPortPxFromLonLat(e);return t.x=Math.round(t.x),t.y=Math.round(t.y),t},getGeodesicPixelSize:function(e){var t=e?this.getLonLatFromPixel(e):this.getCachedCenter()||new OpenLayers.LonLat(0,0),i=this.getResolution(),s=t.add(-i/2,0),n=t.add(i/2,0),r=t.add(0,-i/2),a=t.add(0,i/2),o=new OpenLayers.Projection("EPSG:4326"),l=this.getProjectionObject()||o;return l.equals(o)||(s.transform(l,o),n.transform(l,o),r.transform(l,o),a.transform(l,o)),new OpenLayers.Size(OpenLayers.Util.distVincenty(s,n),OpenLayers.Util.distVincenty(r,a))},getViewPortPxFromLayerPx:function(e){var t=null;if(null!=e){var i=parseInt(this.layerContainerDiv.style.left),s=parseInt(this.layerContainerDiv.style.top);t=e.add(i,s)}return t},getLayerPxFromViewPortPx:function(e){var t=null;if(null!=e){var i=-parseInt(this.layerContainerDiv.style.left),s=-parseInt(this.layerContainerDiv.style.top);t=e.add(i,s),(isNaN(t.x)||isNaN(t.y))&&(t=null)}return t},getLonLatFromLayerPx:function(e){return e=this.getViewPortPxFromLayerPx(e),this.getLonLatFromViewPortPx(e)},getLayerPxFromLonLat:function(e){var t=this.getPixelFromLonLat(e);return this.getLayerPxFromViewPortPx(t)},CLASS_NAME:"OpenLayers.Map"}),OpenLayers.Map.TILE_WIDTH=256,OpenLayers.Map.TILE_HEIGHT=256,/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer=OpenLayers.Class({id:null,name:null,div:null,opacity:1,alwaysInRange:null,RESOLUTION_PROPERTIES:["scales","resolutions","maxScale","minScale","maxResolution","minResolution","numZoomLevels","maxZoomLevel"],events:null,map:null,isBaseLayer:!1,alpha:!1,displayInLayerSwitcher:!0,visibility:!0,attribution:null,inRange:!1,imageSize:null,options:null,eventListeners:null,gutter:0,projection:null,units:null,scales:null,resolutions:null,maxExtent:null,minExtent:null,maxResolution:null,minResolution:null,numZoomLevels:null,minScale:null,maxScale:null,displayOutsideMaxExtent:!1,wrapDateLine:!1,metadata:null,initialize:function(e,t){this.metadata={},this.addOptions(t),this.name=e,null==this.id&&(this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_"),this.div=OpenLayers.Util.createDiv(this.id),this.div.style.width="100%",this.div.style.height="100%",this.div.dir="ltr",this.events=new OpenLayers.Events(this,this.div),this.eventListeners instanceof Object&&this.events.on(this.eventListeners))},destroy:function(e){null==e&&(e=!0),null!=this.map&&this.map.removeLayer(this,e),this.projection=null,this.map=null,this.name=null,this.div=null,this.options=null,this.events&&(this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy()),this.eventListeners=null,this.events=null},clone:function(e){return null==e&&(e=new OpenLayers.Layer(this.name,this.getOptions())),OpenLayers.Util.applyDefaults(e,this),e.map=null,e},getOptions:function(){var e={};for(var t in this.options)e[t]=this[t];return e},setName:function(e){e!=this.name&&(this.name=e,null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"name"}))},addOptions:function(e,t){if(null==this.options&&(this.options={}),e&&("string"==typeof e.projection&&(e.projection=new OpenLayers.Projection(e.projection)),e.projection&&OpenLayers.Util.applyDefaults(e,OpenLayers.Projection.defaults[e.projection.getCode()]),!e.maxExtent||e.maxExtent instanceof OpenLayers.Bounds||(e.maxExtent=new OpenLayers.Bounds(e.maxExtent)),!e.minExtent||e.minExtent instanceof OpenLayers.Bounds||(e.minExtent=new OpenLayers.Bounds(e.minExtent))),OpenLayers.Util.extend(this.options,e),OpenLayers.Util.extend(this,e),this.projection&&this.projection.getUnits()&&(this.units=this.projection.getUnits()),this.map){var i=this.map.getResolution(),s=this.RESOLUTION_PROPERTIES.concat(["projection","units","minExtent","maxExtent"]);for(var n in e)if(e.hasOwnProperty(n)&&OpenLayers.Util.indexOf(s,n)>=0){this.initResolutions(),t&&this.map.baseLayer===this&&(this.map.setCenter(this.map.getCenter(),this.map.getZoomForResolution(i),!1,!0),this.map.events.triggerEvent("changebaselayer",{layer:this}));break}}},onMapResize:function(){},redraw:function(){var e=!1;if(this.map){this.inRange=this.calculateInRange();var t=this.getExtent();if(t&&this.inRange&&this.visibility){var i=!0;this.moveTo(t,i,!1),this.events.triggerEvent("moveend",{zoomChanged:i}),e=!0}}return e},moveTo:function(){var e=this.visibility;this.isBaseLayer||(e=e&&this.inRange),this.display(e)},moveByPx:function(){},setMap:function(e){if(null==this.map){if(this.map=e,this.maxExtent=this.maxExtent||this.map.maxExtent,this.minExtent=this.minExtent||this.map.minExtent,this.projection=this.projection||this.map.projection,"string"==typeof this.projection&&(this.projection=new OpenLayers.Projection(this.projection)),this.units=this.projection.getUnits()||this.units||this.map.units,this.initResolutions(),!this.isBaseLayer){this.inRange=this.calculateInRange();var t=this.visibility&&this.inRange;this.div.style.display=t?"":"none"}this.setTileSize()}},afterAdd:function(){},removeMap:function(){},getImageSize:function(){return this.imageSize||this.tileSize},setTileSize:function(e){var t=e?e:this.tileSize?this.tileSize:this.map.getTileSize();this.tileSize=t,this.gutter&&(this.imageSize=new OpenLayers.Size(t.w+2*this.gutter,t.h+2*this.gutter))},getVisibility:function(){return this.visibility},setVisibility:function(e){e!=this.visibility&&(this.visibility=e,this.display(e),this.redraw(),null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"visibility"}),this.events.triggerEvent("visibilitychanged"))},display:function(e){e!=("none"!=this.div.style.display)&&(this.div.style.display=e&&this.calculateInRange()?"block":"none")},calculateInRange:function(){var e=!1;if(this.alwaysInRange)e=!0;else if(this.map){var t=this.map.getResolution();e=t>=this.minResolution&&t<=this.maxResolution}return e},setIsBaseLayer:function(e){e!=this.isBaseLayer&&(this.isBaseLayer=e,null!=this.map&&this.map.events.triggerEvent("changebaselayer",{layer:this}))},initResolutions:function(){var e,t,i,s={},n=!0;for(e=0,t=this.RESOLUTION_PROPERTIES.length;t>e;e++)i=this.RESOLUTION_PROPERTIES[e],s[i]=this.options[i],n&&this.options[i]&&(n=!1);if(null==this.alwaysInRange&&(this.alwaysInRange=n),null==s.resolutions&&(s.resolutions=this.resolutionsFromScales(s.scales)),null==s.resolutions&&(s.resolutions=this.calculateResolutions(s)),null==s.resolutions){for(e=0,t=this.RESOLUTION_PROPERTIES.length;t>e;e++)i=this.RESOLUTION_PROPERTIES[e],s[i]=null!=this.options[i]?this.options[i]:this.map[i];null==s.resolutions&&(s.resolutions=this.resolutionsFromScales(s.scales)),null==s.resolutions&&(s.resolutions=this.calculateResolutions(s))}var r;this.options.maxResolution&&"auto"!==this.options.maxResolution&&(r=this.options.maxResolution),this.options.minScale&&(r=OpenLayers.Util.getResolutionFromScale(this.options.minScale,this.units));var a;if(this.options.minResolution&&"auto"!==this.options.minResolution&&(a=this.options.minResolution),this.options.maxScale&&(a=OpenLayers.Util.getResolutionFromScale(this.options.maxScale,this.units)),s.resolutions&&(s.resolutions.sort(function(e,t){return t-e}),r||(r=s.resolutions[0]),!a)){var o=s.resolutions.length-1;a=s.resolutions[o]}if(this.resolutions=s.resolutions,this.resolutions){for(t=this.resolutions.length,this.scales=new Array(t),e=0;t>e;e++)this.scales[e]=OpenLayers.Util.getScaleFromResolution(this.resolutions[e],this.units);this.numZoomLevels=t}this.minResolution=a,a&&(this.maxScale=OpenLayers.Util.getScaleFromResolution(a,this.units)),this.maxResolution=r,r&&(this.minScale=OpenLayers.Util.getScaleFromResolution(r,this.units))},resolutionsFromScales:function(e){if(null!=e){var t,i,s;for(s=e.length,t=new Array(s),i=0;s>i;i++)t[i]=OpenLayers.Util.getResolutionFromScale(e[i],this.units);return t}},calculateResolutions:function(e){var t,i,s,n=e.maxResolution;null!=e.minScale?n=OpenLayers.Util.getResolutionFromScale(e.minScale,this.units):"auto"==n&&null!=this.maxExtent&&(t=this.map.getSize(),i=this.maxExtent.getWidth()/t.w,s=this.maxExtent.getHeight()/t.h,n=Math.max(i,s));var r=e.minResolution;if(null!=e.maxScale?r=OpenLayers.Util.getResolutionFromScale(e.maxScale,this.units):"auto"==e.minResolution&&null!=this.minExtent&&(t=this.map.getSize(),i=this.minExtent.getWidth()/t.w,s=this.minExtent.getHeight()/t.h,r=Math.max(i,s)),"number"!=typeof n&&"number"!=typeof r&&null!=this.maxExtent){var a=this.map.getTileSize();n=Math.max(this.maxExtent.getWidth()/a.w,this.maxExtent.getHeight()/a.h)}var o=e.maxZoomLevel,l=e.numZoomLevels;if("number"==typeof r&&"number"==typeof n&&void 0===l){var h=n/r;l=Math.floor(Math.log(h)/Math.log(2))+1}else void 0===l&&null!=o&&(l=o+1);if(!("number"!=typeof l||0>=l||"number"!=typeof n&&"number"!=typeof r)){var u=new Array(l),c=2;"number"==typeof r&&"number"==typeof n&&(c=Math.pow(n/r,1/(l-1)));var d;if("number"==typeof n)for(d=0;l>d;d++)u[d]=n/Math.pow(c,d);else for(d=0;l>d;d++)u[l-1-d]=r*Math.pow(c,d);return u}},getResolution:function(){var e=this.map.getZoom();return this.getResolutionForZoom(e)},getExtent:function(){return this.map.calculateBounds()},getZoomForExtent:function(e,t){var i=this.map.getSize(),s=Math.max(e.getWidth()/i.w,e.getHeight()/i.h);return this.getZoomForResolution(s,t)},getDataExtent:function(){},getResolutionForZoom:function(e){e=Math.max(0,Math.min(e,this.resolutions.length-1));var t;if(this.map.fractionalZoom){var i=Math.floor(e),s=Math.ceil(e);t=this.resolutions[i]-(e-i)*(this.resolutions[i]-this.resolutions[s])}else t=this.resolutions[Math.round(e)];return t},getZoomForResolution:function(e,t){var i,s,n;if(this.map.fractionalZoom){var r,a=0,o=this.resolutions.length-1,l=this.resolutions[a],h=this.resolutions[o];for(s=0,n=this.resolutions.length;n>s;++s)if(r=this.resolutions[s],r>=e&&(l=r,a=s),e>=r){h=r,o=s;break}var u=l-h;i=u>0?a+(l-e)/u:a}else{var c,d=Number.POSITIVE_INFINITY;for(s=0,n=this.resolutions.length;n>s;s++)if(t){if(c=Math.abs(this.resolutions[s]-e),c>d)break;d=c}else if(this.resolutions[s]<e)break;i=Math.max(0,s-1)}return i},getLonLatFromViewPortPx:function(e){var t=null,i=this.map;if(null!=e&&i.minPx){var s=i.getResolution(),n=i.getMaxExtent({restricted:!0}),r=(e.x-i.minPx.x)*s+n.left,a=(i.minPx.y-e.y)*s+n.top;t=new OpenLayers.LonLat(r,a),this.wrapDateLine&&(t=t.wrapDateLine(this.maxExtent))}return t},getViewPortPxFromLonLat:function(e,t){var i=null;if(null!=e){t=t||this.map.getResolution();var s=this.map.calculateBounds(null,t);i=new OpenLayers.Pixel(1/t*(e.lon-s.left),1/t*(s.top-e.lat))}return i},setOpacity:function(e){if(e!=this.opacity){this.opacity=e;for(var t=this.div.childNodes,i=0,s=t.length;s>i;++i){var n=t[i].firstChild||t[i],r=t[i].lastChild;r&&"iframe"===r.nodeName.toLowerCase()&&(n=r.parentNode),OpenLayers.Util.modifyDOMElement(n,null,null,null,null,null,null,e)}null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"})}},getZIndex:function(){return this.div.style.zIndex},setZIndex:function(e){this.div.style.zIndex=e},adjustBounds:function(e){if(this.gutter){var t=this.gutter*this.map.getResolution();e=new OpenLayers.Bounds(e.left-t,e.bottom-t,e.right+t,e.top+t)}if(this.wrapDateLine){var i={rightTolerance:this.getResolution(),leftTolerance:this.getResolution()};e=e.wrapDateLine(this.maxExtent,i)}return e},CLASS_NAME:"OpenLayers.Layer"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.SphericalMercator={getExtent:function(){var e=null;return e=this.sphericalMercator?this.map.calculateBounds():OpenLayers.Layer.FixedZoomLevels.prototype.getExtent.apply(this)},getLonLatFromViewPortPx:function(){return OpenLayers.Layer.prototype.getLonLatFromViewPortPx.apply(this,arguments)},getViewPortPxFromLonLat:function(){return OpenLayers.Layer.prototype.getViewPortPxFromLonLat.apply(this,arguments)},initMercatorParameters:function(){this.RESOLUTIONS=[];for(var e=156543.03390625,t=0;t<=this.MAX_ZOOM_LEVEL;++t)this.RESOLUTIONS[t]=e/Math.pow(2,t);this.units="m",this.projection=this.projection||"EPSG:900913"},forwardMercator:function(){var e=new OpenLayers.Projection("EPSG:4326"),t=new OpenLayers.Projection("EPSG:900913");return function(i,s){var n=OpenLayers.Projection.transform({x:i,y:s},e,t);return new OpenLayers.LonLat(n.x,n.y)}}(),inverseMercator:function(){var e=new OpenLayers.Projection("EPSG:4326"),t=new OpenLayers.Projection("EPSG:900913");return function(i,s){var n=OpenLayers.Projection.transform({x:i,y:s},t,e);return new OpenLayers.LonLat(n.x,n.y)}}()},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.EventPane=OpenLayers.Class(OpenLayers.Layer,{smoothDragPan:!0,isBaseLayer:!0,isFixed:!0,pane:null,mapObject:null,initialize:function(){OpenLayers.Layer.prototype.initialize.apply(this,arguments),null==this.pane&&(this.pane=OpenLayers.Util.createDiv(this.div.id+"_EventPane"))},destroy:function(){this.mapObject=null,this.pane=null,OpenLayers.Layer.prototype.destroy.apply(this,arguments)},setMap:function(){OpenLayers.Layer.prototype.setMap.apply(this,arguments),this.pane.style.zIndex=parseInt(this.div.style.zIndex)+1,this.pane.style.display=this.div.style.display,this.pane.style.width="100%",this.pane.style.height="100%","msie"==OpenLayers.BROWSER_NAME&&(this.pane.style.background="url("+OpenLayers.Util.getImageLocation("blank.gif")+")"),this.isFixed?this.map.viewPortDiv.appendChild(this.pane):this.map.layerContainerDiv.appendChild(this.pane),this.loadMapObject(),null==this.mapObject&&this.loadWarningMessage()},removeMap:function(){this.pane&&this.pane.parentNode&&this.pane.parentNode.removeChild(this.pane),OpenLayers.Layer.prototype.removeMap.apply(this,arguments)},loadWarningMessage:function(){this.div.style.backgroundColor="darkblue";var e=this.map.getSize(),t=Math.min(e.w,300),i=Math.min(e.h,200),s=new OpenLayers.Size(t,i),n=new OpenLayers.Pixel(e.w/2,e.h/2),r=n.add(-s.w/2,-s.h/2),a=OpenLayers.Util.createDiv(this.name+"_warning",r,s,null,null,null,"auto");a.style.padding="7px",a.style.backgroundColor="yellow",a.innerHTML=this.getWarningHTML(),this.div.appendChild(a)},getWarningHTML:function(){return""},display:function(){OpenLayers.Layer.prototype.display.apply(this,arguments),this.pane.style.display=this.div.style.display},setZIndex:function(){OpenLayers.Layer.prototype.setZIndex.apply(this,arguments),this.pane.style.zIndex=parseInt(this.div.style.zIndex)+1},moveByPx:function(e,t){OpenLayers.Layer.prototype.moveByPx.apply(this,arguments),this.dragPanMapObject?this.dragPanMapObject(e,-t):this.moveTo(this.map.getCachedCenter())},moveTo:function(e,t,i){if(OpenLayers.Layer.prototype.moveTo.apply(this,arguments),null!=this.mapObject){var s=this.map.getCenter(),n=this.map.getZoom();if(null!=s){var r=this.getMapObjectCenter(),a=this.getOLLonLatFromMapObjectLonLat(r),o=this.getMapObjectZoom(),l=this.getOLZoomFromMapObjectZoom(o);if(!s.equals(a)||n!=l)if(!t&&a&&this.dragPanMapObject&&this.smoothDragPan){var h=this.map.getViewPortPxFromLonLat(a),u=this.map.getViewPortPxFromLonLat(s);this.dragPanMapObject(u.x-h.x,h.y-u.y)}else{var c=this.getMapObjectLonLatFromOLLonLat(s),d=this.getMapObjectZoomFromOLZoom(n);this.setMapObjectCenter(c,d,i)}}}},getLonLatFromViewPortPx:function(e){var t=null;if(null!=this.mapObject&&null!=this.getMapObjectCenter()){var i=this.getMapObjectPixelFromOLPixel(e),s=this.getMapObjectLonLatFromMapObjectPixel(i);t=this.getOLLonLatFromMapObjectLonLat(s)}return t},getViewPortPxFromLonLat:function(e){var t=null;if(null!=this.mapObject&&null!=this.getMapObjectCenter()){var i=this.getMapObjectLonLatFromOLLonLat(e),s=this.getMapObjectPixelFromMapObjectLonLat(i);t=this.getOLPixelFromMapObjectPixel(s)}return t},getOLLonLatFromMapObjectLonLat:function(e){var t=null;if(null!=e){var i=this.getLongitudeFromMapObjectLonLat(e),s=this.getLatitudeFromMapObjectLonLat(e);t=new OpenLayers.LonLat(i,s)}return t},getMapObjectLonLatFromOLLonLat:function(e){var t=null;return null!=e&&(t=this.getMapObjectLonLatFromLonLat(e.lon,e.lat)),t},getOLPixelFromMapObjectPixel:function(e){var t=null;if(null!=e){var i=this.getXFromMapObjectPixel(e),s=this.getYFromMapObjectPixel(e);t=new OpenLayers.Pixel(i,s)}return t},getMapObjectPixelFromOLPixel:function(e){var t=null;return null!=e&&(t=this.getMapObjectPixelFromXY(e.x,e.y)),t},CLASS_NAME:"OpenLayers.Layer.EventPane"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.FixedZoomLevels=OpenLayers.Class({initialize:function(){},initResolutions:function(){for(var e=["minZoomLevel","maxZoomLevel","numZoomLevels"],t=0,i=e.length;i>t;t++){var s=e[t];this[s]=null!=this.options[s]?this.options[s]:this.map[s]}(null==this.minZoomLevel||this.minZoomLevel<this.MIN_ZOOM_LEVEL)&&(this.minZoomLevel=this.MIN_ZOOM_LEVEL);var n,r=this.MAX_ZOOM_LEVEL-this.minZoomLevel+1;if(n=null==this.options.numZoomLevels&&null!=this.options.maxZoomLevel||null==this.numZoomLevels&&null!=this.maxZoomLevel?this.maxZoomLevel-this.minZoomLevel+1:this.numZoomLevels,this.numZoomLevels=null!=n?Math.min(n,r):r,this.maxZoomLevel=this.minZoomLevel+this.numZoomLevels-1,null!=this.RESOLUTIONS){var a=0;this.resolutions=[];for(var t=this.minZoomLevel;t<=this.maxZoomLevel;t++)this.resolutions[a++]=this.RESOLUTIONS[t];this.maxResolution=this.resolutions[0],this.minResolution=this.resolutions[this.resolutions.length-1]}},getResolution:function(){if(null!=this.resolutions)return OpenLayers.Layer.prototype.getResolution.apply(this,arguments);var e=null,t=this.map.getSize(),i=this.getExtent();return null!=t&&null!=i&&(e=Math.max(i.getWidth()/t.w,i.getHeight()/t.h)),e},getExtent:function(){var e=this.map.getSize(),t=this.getLonLatFromViewPortPx({x:0,y:0}),i=this.getLonLatFromViewPortPx({x:e.w,y:e.h});return null!=t&&null!=i?new OpenLayers.Bounds(t.lon,i.lat,i.lon,t.lat):null},getZoomForResolution:function(){if(null!=this.resolutions)return OpenLayers.Layer.prototype.getZoomForResolution.apply(this,arguments);var e=OpenLayers.Layer.prototype.getExtent.apply(this,[]);return this.getZoomForExtent(e)},getOLZoomFromMapObjectZoom:function(e){var t=null;return null!=e&&(t=e-this.minZoomLevel,this.map.baseLayer!==this&&(t=this.map.baseLayer.getZoomForResolution(this.getResolutionForZoom(t)))),t},getMapObjectZoomFromOLZoom:function(e){var t=null;return null!=e&&(t=e+this.minZoomLevel,this.map.baseLayer!==this&&(t=this.getZoomForResolution(this.map.baseLayer.getResolutionForZoom(t)))),t},CLASS_NAME:"OpenLayers.Layer.FixedZoomLevels"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.Google=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:0,MAX_ZOOM_LEVEL:21,RESOLUTIONS:[1.40625,.703125,.3515625,.17578125,.087890625,.0439453125,.02197265625,.010986328125,.0054931640625,.00274658203125,.001373291015625,.0006866455078125,.00034332275390625,.000171661376953125,858306884765625e-19,4291534423828125e-20,2145767211914062e-20,1072883605957031e-20,536441802978515e-20,268220901489257e-20,1341104507446289e-21,6.705522537231445e-7],type:null,wrapDateLine:!0,sphericalMercator:!1,version:null,initialize:function(e,t){t=t||{},t.version||(t.version="function"==typeof GMap2?"2":"3");var i=OpenLayers.Layer.Google["v"+t.version.replace(/\./g,"_")];if(!i)throw"Unsupported Google Maps API version: "+t.version;OpenLayers.Util.applyDefaults(t,i),OpenLayers.Util.applyDefaults(t,i.DEFAULTS),t.maxExtent&&(t.maxExtent=t.maxExtent.clone()),OpenLayers.Layer.EventPane.prototype.initialize.apply(this,[e,t]),OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,[e,t]),this.sphericalMercator&&(OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator),this.initMercatorParameters())},clone:function(){return new OpenLayers.Layer.Google(this.name,this.getOptions())},setVisibility:function(){var e=null==this.opacity?1:this.opacity;OpenLayers.Layer.EventPane.prototype.setVisibility.apply(this,arguments),this.setOpacity(e)},display:function(e){this._dragging||this.setGMapVisibility(e),OpenLayers.Layer.EventPane.prototype.display.apply(this,arguments)},moveTo:function(e,t,i){this._dragging=i,OpenLayers.Layer.EventPane.prototype.moveTo.apply(this,arguments),delete this._dragging},setOpacity:function(e){if(e!==this.opacity&&(null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"}),this.opacity=e),this.getVisibility()){var t=this.getMapContainer();OpenLayers.Util.modifyDOMElement(t,null,null,null,null,null,null,e)}},destroy:function(){if(this.map){this.setGMapVisibility(!1);var e=OpenLayers.Layer.Google.cache[this.map.id];e&&e.count<=1&&this.removeGMapElements()}OpenLayers.Layer.EventPane.prototype.destroy.apply(this,arguments)},removeGMapElements:function(){var e=OpenLayers.Layer.Google.cache[this.map.id];if(e){var t=this.mapObject&&this.getMapContainer();t&&t.parentNode&&t.parentNode.removeChild(t);var i=e.termsOfUse;i&&i.parentNode&&i.parentNode.removeChild(i);var s=e.poweredBy;s&&s.parentNode&&s.parentNode.removeChild(s)}},removeMap:function(e){this.visibility&&this.mapObject&&this.setGMapVisibility(!1);var t=OpenLayers.Layer.Google.cache[e.id];t&&(t.count<=1?(this.removeGMapElements(),delete OpenLayers.Layer.Google.cache[e.id]):--t.count),delete this.termsOfUse,delete this.poweredBy,delete this.mapObject,delete this.dragObject,OpenLayers.Layer.EventPane.prototype.removeMap.apply(this,arguments)},getOLBoundsFromMapObjectBounds:function(e){var t=null;if(null!=e){var i=e.getSouthWest(),s=e.getNorthEast();this.sphericalMercator?(i=this.forwardMercator(i.lng(),i.lat()),s=this.forwardMercator(s.lng(),s.lat())):(i=new OpenLayers.LonLat(i.lng(),i.lat()),s=new OpenLayers.LonLat(s.lng(),s.lat())),t=new OpenLayers.Bounds(i.lon,i.lat,s.lon,s.lat)}return t},getWarningHTML:function(){return OpenLayers.i18n("googleWarning")},getMapObjectCenter:function(){return this.mapObject.getCenter()},getMapObjectZoom:function(){return this.mapObject.getZoom()},getLongitudeFromMapObjectLonLat:function(e){return this.sphericalMercator?this.forwardMercator(e.lng(),e.lat()).lon:e.lng()},getLatitudeFromMapObjectLonLat:function(e){var t=this.sphericalMercator?this.forwardMercator(e.lng(),e.lat()).lat:e.lat();return t},getXFromMapObjectPixel:function(e){return e.x},getYFromMapObjectPixel:function(e){return e.y},CLASS_NAME:"OpenLayers.Layer.Google"}),OpenLayers.Layer.Google.cache={},OpenLayers.Layer.Google.v2={/**
     * Property: termsOfUse
     * {DOMElement} Div for Google's copyright and terms of use link
     */
termsOfUse:null,poweredBy:null,dragObject:null,loadMapObject:function(){this.type||(this.type=G_NORMAL_MAP);var e,t,i,s=OpenLayers.Layer.Google.cache[this.map.id];if(s)e=s.mapObject,t=s.termsOfUse,i=s.poweredBy,++s.count;else{var n=this.map.viewPortDiv,r=document.createElement("div");r.id=this.map.id+"_GMap2Container",r.style.position="absolute",r.style.width="100%",r.style.height="100%",n.appendChild(r);try{e=new GMap2(r),t=r.lastChild,n.appendChild(t),t.style.zIndex="1100",t.style.right="",t.style.bottom="",t.className="olLayerGoogleCopyright",i=r.lastChild,n.appendChild(i),i.style.zIndex="1100",i.style.right="",i.style.bottom="",i.className="olLayerGooglePoweredBy gmnoprint"}catch(a){throw a}OpenLayers.Layer.Google.cache[this.map.id]={mapObject:e,termsOfUse:t,poweredBy:i,count:1}}this.mapObject=e,this.termsOfUse=t,this.poweredBy=i,-1===OpenLayers.Util.indexOf(this.mapObject.getMapTypes(),this.type)&&this.mapObject.addMapType(this.type),"function"==typeof e.getDragObject?this.dragObject=e.getDragObject():this.dragPanMapObject=null,this.isBaseLayer===!1&&this.setGMapVisibility("none"!==this.div.style.display)},onMapResize:function(){if(this.visibility&&this.mapObject.isLoaded())this.mapObject.checkResize();else{if(!this._resized)var e=this,t=GEvent.addListener(this.mapObject,"load",function(){GEvent.removeListener(t),delete e._resized,e.mapObject.checkResize(),e.moveTo(e.map.getCenter(),e.map.getZoom())});this._resized=!0}},setGMapVisibility:function(e){var t=OpenLayers.Layer.Google.cache[this.map.id];if(t){var i=this.mapObject.getContainer();e===!0?(this.mapObject.setMapType(this.type),i.style.display="",this.termsOfUse.style.left="",this.termsOfUse.style.display="",this.poweredBy.style.display="",t.displayed=this.id):(t.displayed===this.id&&delete t.displayed,t.displayed||(i.style.display="none",this.termsOfUse.style.display="none",this.termsOfUse.style.left="-9999px",this.poweredBy.style.display="none"))}},getMapContainer:function(){return this.mapObject.getContainer()},getMapObjectBoundsFromOLBounds:function(e){var t=null;if(null!=e){var i=this.sphericalMercator?this.inverseMercator(e.bottom,e.left):new OpenLayers.LonLat(e.bottom,e.left),s=this.sphericalMercator?this.inverseMercator(e.top,e.right):new OpenLayers.LonLat(e.top,e.right);t=new GLatLngBounds(new GLatLng(i.lat,i.lon),new GLatLng(s.lat,s.lon))}return t},setMapObjectCenter:function(e,t){this.mapObject.setCenter(e,t)},dragPanMapObject:function(e,t){this.dragObject.moveBy(new GSize(-e,t))},getMapObjectLonLatFromMapObjectPixel:function(e){return this.mapObject.fromContainerPixelToLatLng(e)},getMapObjectPixelFromMapObjectLonLat:function(e){return this.mapObject.fromLatLngToContainerPixel(e)},getMapObjectZoomFromMapObjectBounds:function(e){return this.mapObject.getBoundsZoomLevel(e)},getMapObjectLonLatFromLonLat:function(e,t){var i;if(this.sphericalMercator){var s=this.inverseMercator(e,t);i=new GLatLng(s.lat,s.lon)}else i=new GLatLng(t,e);return i},getMapObjectPixelFromXY:function(e,t){return new GPoint(e,t)}},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WFST=function(e){e=OpenLayers.Util.applyDefaults(e,OpenLayers.Format.WFST.DEFAULTS);var t=OpenLayers.Format.WFST["v"+e.version.replace(/\./g,"_")];if(!t)throw"Unsupported WFST version: "+e.version;return new t(e)},OpenLayers.Format.WFST.DEFAULTS={version:"1.0.0"},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WFST.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",wfs:"http://www.opengis.net/wfs",gml:"http://www.opengis.net/gml",ogc:"http://www.opengis.net/ogc",ows:"http://www.opengis.net/ows"},defaultPrefix:"wfs",version:null,schemaLocations:null,srsName:null,extractAttributes:!0,xy:!0,stateName:null,initialize:function(e){this.stateName={},this.stateName[OpenLayers.State.INSERT]="wfs:Insert",this.stateName[OpenLayers.State.UPDATE]="wfs:Update",this.stateName[OpenLayers.State.DELETE]="wfs:Delete",OpenLayers.Format.XML.prototype.initialize.apply(this,[e])},getSrsName:function(e,t){var i=t&&t.srsName;return i||(i=e&&e.layer?e.layer.projection.getCode():this.srsName),i},read:function(e,t){t=t||{},OpenLayers.Util.applyDefaults(t,{output:"features"}),"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e])),e&&9==e.nodeType&&(e=e.documentElement);var i={};return e&&this.readNode(e,i,!0),i.features&&"features"===t.output&&(i=i.features),i},readers:{wfs:{FeatureCollection:function(e,t){t.features=[],this.readChildNodes(e,t)}}},write:function(e,t){var i=this.writeNode("wfs:Transaction",{features:e,options:t}),s=this.schemaLocationAttr();return s&&this.setAttributeNS(i,this.namespaces.xsi,"xsi:schemaLocation",s),OpenLayers.Format.XML.prototype.write.apply(this,[i])},writers:{wfs:{GetFeature:function(e){var t=this.createElementNSPlus("wfs:GetFeature",{attributes:{service:"WFS",version:this.version,handle:e&&e.handle,outputFormat:e&&e.outputFormat,maxFeatures:e&&e.maxFeatures,"xsi:schemaLocation":this.schemaLocationAttr(e)}});if("string"==typeof this.featureType)this.writeNode("Query",e,t);else for(var i=0,s=this.featureType.length;s>i;i++)e.featureType=this.featureType[i],this.writeNode("Query",e,t);return t},Transaction:function(e){e=e||{};var t,i,s=e.options||{},n=this.createElementNSPlus("wfs:Transaction",{attributes:{service:"WFS",version:this.version,handle:s.handle}}),r=e.features;if(r){s.multi===!0&&OpenLayers.Util.extend(this.geometryTypes,{"OpenLayers.Geometry.Point":"MultiPoint","OpenLayers.Geometry.LineString":this.multiCurve===!0?"MultiCurve":"MultiLineString","OpenLayers.Geometry.Polygon":this.multiSurface===!0?"MultiSurface":"MultiPolygon"});var a,o;for(t=0,i=r.length;i>t;++t)o=r[t],a=this.stateName[o.state],a&&this.writeNode(a,{feature:o,options:s},n);s.multi===!0&&this.setGeometryTypes()}if(s.nativeElements)for(t=0,i=s.nativeElements.length;i>t;++t)this.writeNode("wfs:Native",s.nativeElements[t],n);return n},Native:function(e){var t=this.createElementNSPlus("wfs:Native",{attributes:{vendorId:e.vendorId,safeToIgnore:e.safeToIgnore},value:e.value});return t},Insert:function(e){var t=e.feature,i=e.options,s=this.createElementNSPlus("wfs:Insert",{attributes:{handle:i&&i.handle}});return this.srsName=this.getSrsName(t),this.writeNode("feature:_typeName",t,s),s},Update:function(e){var t=e.feature,i=e.options,s=this.createElementNSPlus("wfs:Update",{attributes:{handle:i&&i.handle,typeName:(this.featureNS?this.featurePrefix+":":"")+this.featureType}});this.featureNS&&s.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);var n=t.modified;null===this.geometryName||n&&void 0===n.geometry||(this.srsName=this.getSrsName(t),this.writeNode("Property",{name:this.geometryName,value:t.geometry},s));for(var r in t.attributes)void 0===t.attributes[r]||n&&n.attributes&&(!n.attributes||void 0===n.attributes[r])||this.writeNode("Property",{name:r,value:t.attributes[r]},s);return this.writeNode("ogc:Filter",new OpenLayers.Filter.FeatureId({fids:[t.fid]}),s),s},Property:function(e){var t=this.createElementNSPlus("wfs:Property");return this.writeNode("Name",e.name,t),null!==e.value&&this.writeNode("Value",e.value,t),t},Name:function(e){return this.createElementNSPlus("wfs:Name",{value:e})},Value:function(e){var t;if(e instanceof OpenLayers.Geometry){t=this.createElementNSPlus("wfs:Value");var i=this.writeNode("feature:_geometry",e).firstChild;t.appendChild(i)}else t=this.createElementNSPlus("wfs:Value",{value:e});return t},Delete:function(e){var t=e.feature,i=e.options,s=this.createElementNSPlus("wfs:Delete",{attributes:{handle:i&&i.handle,typeName:(this.featureNS?this.featurePrefix+":":"")+this.featureType}});return this.featureNS&&s.setAttribute("xmlns:"+this.featurePrefix,this.featureNS),this.writeNode("ogc:Filter",new OpenLayers.Filter.FeatureId({fids:[t.fid]}),s),s}}},schemaLocationAttr:function(e){e=OpenLayers.Util.extend({featurePrefix:this.featurePrefix,schema:this.schema},e);var t=OpenLayers.Util.extend({},this.schemaLocations);e.schema&&(t[e.featurePrefix]=e.schema);var i,s=[];for(var n in t)i=this.namespaces[n],i&&s.push(i+" "+t[n]);var r=s.join(" ")||void 0;return r},setFilterProperty:function(e){if(e.filters)for(var t=0,i=e.filters.length;i>t;++t)OpenLayers.Format.WFST.v1.prototype.setFilterProperty.call(this,e.filters[t]);else e instanceof OpenLayers.Filter.Spatial&&!e.property&&(e.property=this.geometryName)},CLASS_NAME:"OpenLayers.Format.WFST.v1"}),/* Copyright (c) 2006-2013 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.GML.v3=OpenLayers.Class(OpenLayers.Format.GML.Base,{schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",curve:!1,multiCurve:!0,surface:!1,multiSurface:!0,initialize:function(e){OpenLayers.Format.GML.Base.prototype.initialize.apply(this,[e])},readers:{gml:OpenLayers.Util.applyDefaults({_inherit:function(e,t,i){var s=parseInt(e.getAttribute("srsDimension"),10)||i&&i.srsDimension;s&&(t.srsDimension=s)},featureMembers:function(e,t){this.readChildNodes(e,t)},Curve:function(e,t){var i={points:[]};this.readers.gml._inherit.apply(this,[e,i,t]),this.readChildNodes(e,i),t.components||(t.components=[]),t.components.push(new OpenLayers.Geometry.LineString(i.points))},segments:function(e,t){this.readChildNodes(e,t)},LineStringSegment:function(e,t){var i={};this.readChildNodes(e,i),i.points&&Array.prototype.push.apply(t.points,i.points)},pos:function(e,t){var i,s=this.getChildValue(e).replace(this.regExes.trimSpace,""),n=s.split(this.regExes.splitSpace);i=this.xy?new OpenLayers.Geometry.Point(n[0],n[1],n[2]):new OpenLayers.Geometry.Point(n[1],n[0],n[2]),t.points||(t.points=[]),t.points.push(i)},posList:function(e,t){for(var i,s,n,r=this.getChildValue(e).replace(this.regExes.trimSpace,""),a=r.split(this.regExes.splitSpace),o=t.srsDimension||parseInt(e.getAttribute("srsDimension")||e.getAttribute("dimension"),10)||2,l=a.length/o,h=new Array(l),u=0,c=a.length;c>u;u+=o)i=a[u],s=a[u+1],n=2==o?void 0:a[u+2],h[u/o]=this.xy?new OpenLayers.Geometry.Point(i,s,n):new OpenLayers.Geometry.Point(s,i,n);t.points=h},Surface:function(e,t){this.readChildNodes(e,t)},patches:function(e,t){this.readChildNodes(e,t)},PolygonPatch:function(e,t){this.readers.gml.Polygon.apply(this,[e,t])},exterior:function(e,t){var i={};this.readChildNodes(e,i),t.outer=i.components[0]},interior:function(e,t){var i={};this.readChildNodes(e,i),t.inner.push(i.components[0])},MultiCurve:function(e,t){var i={components:[]};this.readers.gml._inherit.apply(this,[e,i,t]),this.readChildNodes(e,i),i.components.length>0&&(t.components=[new OpenLayers.Geometry.MultiLineString(i.components)])},curveMember:function(e,t){this.readChildNodes(e,t)},MultiSurface:function(e,t){var i={components:[]};this.readers.gml._inherit.apply(this,[e,i,t]),this.readChildNodes(e,i),i.components.length>0&&(t.components=[new OpenLayers.Geometry.MultiPolygon(i.components)])},surfaceMember:function(e,t){this.readChildNodes(e,t)},surfaceMembers:function(e,t){this.readChildNodes(e,t)},pointMembers:function(e,t){this.readChildNodes(e,t)},lineStringMembers:function(e,t){this.readChildNodes(e,t)},polygonMembers:function(e,t){this.readChildNodes(e,t)},geometryMembers:function(e,t){this.readChildNodes(e,t)},Envelope:function(e,t){var i={points:[]};this.readChildNodes(e,i),t.components||(t.components=[]);var s=i.points[0],n=i.points[1];t.components.push(new OpenLayers.Bounds(s.x,s.y,n.x,n.y))},lowerCorner:function(e,t){var i={};this.readers.gml.pos.apply(this,[e,i]),t.points[0]=i.points[0]},upperCorner:function(e,t){var i={};this.readers.gml.pos.apply(this,[e,i]),t.points[1]=i.points[0]}},OpenLayers.Format.GML.Base.prototype.readers.gml),feature:OpenLayers.Format.GML.Base.prototype.readers.feature,wfs:OpenLayers.Format.GML.Base.prototype.readers.wfs},write:function(e){var t;t=OpenLayers.Util.isArray(e)?"featureMembers":"featureMember";var i=this.writeNode("gml:"+t,e);return this.setAttributeNS(i,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation),OpenLayers.Format.XML.prototype.write.apply(this,[i])},writers:{gml:OpenLayers.Util.applyDefaults({featureMembers:function(e){for(var t=this.createElementNSPlus("gml:featureMembers"),i=0,s=e.length;s>i;++i)this.writeNode("feature:_typeName",e[i],t);return t},Point:function(e){var t=this.createElementNSPlus("gml:Point");return this.writeNode("pos",e,t),t},pos:function(e){var t=this.xy?e.x+" "+e.y:e.y+" "+e.x;return this.createElementNSPlus("gml:pos",{value:t})},LineString:function(e){var t=this.createElementNSPlus("gml:LineString");return this.writeNode("posList",e.components,t),t},Curve:function(e){var t=this.createElementNSPlus("gml:Curve");return this.writeNode("segments",e,t),t},segments:function(e){var t=this.createElementNSPlus("gml:segments");return this.writeNode("LineStringSegment",e,t),t},LineStringSegment:function(e){var t=this.createElementNSPlus("gml:LineStringSegment");return this.writeNode("posList",e.components,t),t},posList:function(e){for(var t,i=e.length,s=new Array(i),n=0;i>n;++n)t=e[n],s[n]=this.xy?t.x+" "+t.y:t.y+" "+t.x;return this.createElementNSPlus("gml:posList",{value:s.join(" ")})},Surface:function(e){var t=this.createElementNSPlus("gml:Surface");return this.writeNode("patches",e,t),t},patches:function(e){var t=this.createElementNSPlus("gml:patches");return this.writeNode("PolygonPatch",e,t),t},PolygonPatch:function(e){var t=this.createElementNSPlus("gml:PolygonPatch",{attributes:{interpolation:"planar"}});this.writeNode("exterior",e.components[0],t);for(var i=1,s=e.components.length;s>i;++i)this.writeNode("interior",e.components[i],t);return t},Polygon:function(e){var t=this.createElementNSPlus("gml:Polygon");this.writeNode("exterior",e.components[0],t);for(var i=1,s=e.components.length;s>i;++i)this.writeNode("interior",e.components[i],t);return t},exterior:function(e){var t=this.createElementNSPlus("gml:exterior");return this.writeNode("LinearRing",e,t),t},interior:function(e){var t=this.createElementNSPlus("gml:interior");return this.writeNode("LinearRing",e,t),t},LinearRing:function(e){var t=this.createElementNSPlus("gml:LinearRing");return this.writeNode("posList",e.components,t),t},MultiCurve:function(e){for(var t=this.createElementNSPlus("gml:MultiCurve"),i=e.components||[e],s=0,n=i.length;n>s;++s)this.writeNode("curveMember",i[s],t);return t},curveMember:function(e){var t=this.createElementNSPlus("gml:curveMember");return this.curve?this.writeNode("Curve",e,t):this.writeNode("LineString",e,t),t},MultiSurface:function(e){for(var t=this.createElementNSPlus("gml:MultiSurface"),i=e.components||[e],s=0,n=i.length;n>s;++s)this.writeNode("surfaceMember",i[s],t);return t},surfaceMember:function(e){var t=this.createElementNSPlus("gml:surfaceMember");return this.surface?this.writeNode("Surface",e,t):this.writeNode("Polygon",e,t),t},Envelope:function(e){var t=this.createElementNSPlus("gml:Envelope");return this.writeNode("lowerCorner",e,t),this.writeNode("upperCorner",e,t),this.srsName&&t.setAttribute("srsName",this.srsName),t},lowerCorner:function(e){var t=this.xy?e.left+" "+e.bottom:e.bottom+" "+e.left;return this.createElementNSPlus("gml:lowerCorner",{value:t})},upperCorner:function(e){var t=this.xy?e.right+" "+e.top:e.top+" "+e.right;return this.createElementNSPlus("gml:upperCorner",{value:t})}},OpenLayers.Format.GML.Base.prototype.writers.gml),feature:OpenLayers.Format.GML.Base.prototype.writers.feature,wfs:OpenLayers.Format.GML.Base.prototype.writers.wfs},setGeometryTypes:function(){this.geometryTypes={"OpenLayers.Geometry.Point":"Point","OpenLayers.Geometry.MultiPoint":"MultiPoint","OpenLayers.Geometry.LineString":this.curve===!0?"Curve":"LineString","OpenLayers.Geometry.MultiLineString":this.multiCurve===!1?"MultiLineString":"MultiCurve","OpenLayers.Geometry.Polygon":this.surface===!0?"Surface":"Polygon","OpenLayers.Geometry.MultiPolygon":this.multiSurface===!1?"MultiPolygon":"MultiSurface","OpenLayers.Geometry.Collection":"GeometryCollection"}},CLASS_NAME:"OpenLayers.Format.GML.v3"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.Filter.v1_1_0=OpenLayers.Class(OpenLayers.Format.GML.v3,OpenLayers.Format.Filter.v1,{VERSION:"1.1.0",schemaLocation:"http://www.opengis.net/ogc/filter/1.1.0/filter.xsd",initialize:function(e){OpenLayers.Format.GML.v3.prototype.initialize.apply(this,[e])},readers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(e,t){var i=e.getAttribute("matchCase"),s=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,matchCase:!("false"===i||"0"===i)});this.readChildNodes(e,s),t.filters.push(s)},PropertyIsNotEqualTo:function(e,t){var i=e.getAttribute("matchCase"),s=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.NOT_EQUAL_TO,matchCase:!("false"===i||"0"===i)});this.readChildNodes(e,s),t.filters.push(s)},PropertyIsLike:function(e,t){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LIKE});this.readChildNodes(e,i);var s=e.getAttribute("wildCard"),n=e.getAttribute("singleChar"),r=e.getAttribute("escapeChar");i.value2regex(s,n,r),t.filters.push(i)}},OpenLayers.Format.Filter.v1.prototype.readers.ogc),gml:OpenLayers.Format.GML.v3.prototype.readers.gml,feature:OpenLayers.Format.GML.v3.prototype.readers.feature},writers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(e){var t=this.createElementNSPlus("ogc:PropertyIsEqualTo",{attributes:{matchCase:e.matchCase}});return this.writeNode("PropertyName",e,t),this.writeOgcExpression(e.value,t),t},PropertyIsNotEqualTo:function(e){var t=this.createElementNSPlus("ogc:PropertyIsNotEqualTo",{attributes:{matchCase:e.matchCase}});return this.writeNode("PropertyName",e,t),this.writeOgcExpression(e.value,t),t},PropertyIsLike:function(e){var t=this.createElementNSPlus("ogc:PropertyIsLike",{attributes:{matchCase:e.matchCase,wildCard:"*",singleChar:".",escapeChar:"!"}});return this.writeNode("PropertyName",e,t),this.writeNode("Literal",e.regex2value(),t),t},BBOX:function(e){var t=this.createElementNSPlus("ogc:BBOX");e.property&&this.writeNode("PropertyName",e,t);var i=this.writeNode("gml:Envelope",e.value);return e.projection&&i.setAttribute("srsName",e.projection),t.appendChild(i),t},SortBy:function(e){for(var t=this.createElementNSPlus("ogc:SortBy"),i=0,s=e.length;s>i;i++)this.writeNode("ogc:SortProperty",e[i],t);return t},SortProperty:function(e){var t=this.createElementNSPlus("ogc:SortProperty");return this.writeNode("ogc:PropertyName",e,t),this.writeNode("ogc:SortOrder","DESC"==e.order?"DESC":"ASC",t),t},SortOrder:function(e){var t=this.createElementNSPlus("ogc:SortOrder",{value:e});return t}},OpenLayers.Format.Filter.v1.prototype.writers.ogc),gml:OpenLayers.Format.GML.v3.prototype.writers.gml,feature:OpenLayers.Format.GML.v3.prototype.writers.feature},writeSpatial:function(e,t){var i=this.createElementNSPlus("ogc:"+t);if(this.writeNode("PropertyName",e,i),e.value instanceof OpenLayers.Filter.Function)this.writeNode("Function",e.value,i);else{var s;s=e.value instanceof OpenLayers.Geometry?this.writeNode("feature:_geometry",e.value).firstChild:this.writeNode("gml:Envelope",e.value),e.projection&&s.setAttribute("srsName",e.projection),i.appendChild(s)}return i},CLASS_NAME:"OpenLayers.Format.Filter.v1_1_0"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WFST.v1_1_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_1_0,OpenLayers.Format.WFST.v1,{version:"1.1.0",schemaLocations:{wfs:"http://schemas.opengis.net/wfs/1.1.0/wfs.xsd"},initialize:function(e){OpenLayers.Format.Filter.v1_1_0.prototype.initialize.apply(this,[e]),OpenLayers.Format.WFST.v1.prototype.initialize.apply(this,[e])},readNode:function(e,t){return OpenLayers.Format.GML.v3.prototype.readNode.apply(this,[e,t])},readers:{wfs:OpenLayers.Util.applyDefaults({FeatureCollection:function(e,t){t.numberOfFeatures=parseInt(e.getAttribute("numberOfFeatures")),OpenLayers.Format.WFST.v1.prototype.readers.wfs.FeatureCollection.apply(this,arguments)},TransactionResponse:function(e,t){t.insertIds=[],t.success=!1,this.readChildNodes(e,t)},TransactionSummary:function(e,t){t.success=!0},InsertResults:function(e,t){this.readChildNodes(e,t)},Feature:function(e,t){var i={fids:[]};this.readChildNodes(e,i),t.insertIds.push(i.fids[0])}},OpenLayers.Format.WFST.v1.prototype.readers.wfs),gml:OpenLayers.Format.GML.v3.prototype.readers.gml,feature:OpenLayers.Format.GML.v3.prototype.readers.feature,ogc:OpenLayers.Format.Filter.v1_1_0.prototype.readers.ogc,ows:OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows},writers:{wfs:OpenLayers.Util.applyDefaults({GetFeature:function(e){var t=OpenLayers.Format.WFST.v1.prototype.writers.wfs.GetFeature.apply(this,arguments);return e&&this.setAttributes(t,{resultType:e.resultType,startIndex:e.startIndex,count:e.count}),t},Query:function(e){e=OpenLayers.Util.extend({featureNS:this.featureNS,featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName},e);var t=e.featurePrefix,i=this.createElementNSPlus("wfs:Query",{attributes:{typeName:(t?t+":":"")+e.featureType,srsName:e.srsName}});if(e.featureNS&&i.setAttribute("xmlns:"+t,e.featureNS),e.propertyNames)for(var s=0,n=e.propertyNames.length;n>s;s++)this.writeNode("wfs:PropertyName",{property:e.propertyNames[s]},i);return e.filter&&(OpenLayers.Format.WFST.v1_1_0.prototype.setFilterProperty.call(this,e.filter),this.writeNode("ogc:Filter",e.filter,i)),i},PropertyName:function(e){return this.createElementNSPlus("wfs:PropertyName",{value:e.property})}},OpenLayers.Format.WFST.v1.prototype.writers.wfs),gml:OpenLayers.Format.GML.v3.prototype.writers.gml,feature:OpenLayers.Format.GML.v3.prototype.writers.feature,ogc:OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc},CLASS_NAME:"OpenLayers.Format.WFST.v1_1_0"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Protocol=OpenLayers.Class({format:null,options:null,autoDestroy:!0,defaultFilter:null,initialize:function(e){e=e||{},OpenLayers.Util.extend(this,e),this.options=e},mergeWithDefaultFilter:function(e){var t;return t=e&&this.defaultFilter?new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,filters:[this.defaultFilter,e]}):e||this.defaultFilter||void 0},destroy:function(){this.options=null,this.format=null},read:function(e){e=e||{},e.filter=this.mergeWithDefaultFilter(e.filter)},create:function(){},update:function(){},"delete":function(){},commit:function(){},abort:function(){},createCallback:function(e,t,i){return OpenLayers.Function.bind(function(){e.apply(this,[t,i])},this)},CLASS_NAME:"OpenLayers.Protocol"}),OpenLayers.Protocol.Response=OpenLayers.Class({code:null,requestType:null,last:!0,features:null,data:null,reqFeatures:null,priv:null,error:null,initialize:function(e){OpenLayers.Util.extend(this,e)},success:function(){return this.code>0},CLASS_NAME:"OpenLayers.Protocol.Response"}),OpenLayers.Protocol.Response.SUCCESS=1,OpenLayers.Protocol.Response.FAILURE=0,/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.JSON=OpenLayers.Class(OpenLayers.Format,{indent:"    ",space:" ",newline:"\n",level:0,pretty:!1,nativeJSON:function(){return!(!window.JSON||"function"!=typeof JSON.parse||"function"!=typeof JSON.stringify)}(),read:function(json,filter){function walk(e,t){if(t&&"object"==typeof t)for(var i in t)t.hasOwnProperty(i)&&(t[i]=walk(i,t[i]));return filter(e,t)}var object;if(this.nativeJSON)object=JSON.parse(json,filter);else try{/^[\],:{}\s]*$/.test(json.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))&&(object=eval("("+json+")"),"function"==typeof filter&&(object=walk("",object)))}catch(e){}return this.keepData&&(this.data=object),object},write:function(e,t){this.pretty=!!t;var i=null,s=typeof e;if(this.serialize[s])try{i=!this.pretty&&this.nativeJSON?JSON.stringify(e):this.serialize[s].apply(this,[e])}catch(n){OpenLayers.Console.error("Trouble serializing: "+n)}return i},writeIndent:function(){var e=[];if(this.pretty)for(var t=0;t<this.level;++t)e.push(this.indent);return e.join("")},writeNewline:function(){return this.pretty?this.newline:""},writeSpace:function(){return this.pretty?this.space:""},serialize:{object:function(e){if(null==e)return"null";if(e.constructor==Date)return this.serialize.date.apply(this,[e]);if(e.constructor==Array)return this.serialize.array.apply(this,[e]);var t=["{"];this.level+=1;var i,s,n,r=!1;for(i in e)e.hasOwnProperty(i)&&(s=OpenLayers.Format.JSON.prototype.write.apply(this,[i,this.pretty]),n=OpenLayers.Format.JSON.prototype.write.apply(this,[e[i],this.pretty]),null!=s&&null!=n&&(r&&t.push(","),t.push(this.writeNewline(),this.writeIndent(),s,":",this.writeSpace(),n),r=!0));return this.level-=1,t.push(this.writeNewline(),this.writeIndent(),"}"),t.join("")},array:function(e){var t,i=["["];this.level+=1;for(var s=0,n=e.length;n>s;++s)t=OpenLayers.Format.JSON.prototype.write.apply(this,[e[s],this.pretty]),null!=t&&(s>0&&i.push(","),i.push(this.writeNewline(),this.writeIndent(),t));return this.level-=1,i.push(this.writeNewline(),this.writeIndent(),"]"),i.join("")},string:function(e){var t={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return/["\\\x00-\x1f]/.test(e)?'"'+e.replace(/([\x00-\x1f\\"])/g,function(e,i){var s=t[i];return s?s:(s=i.charCodeAt(),"\\u00"+Math.floor(s/16).toString(16)+(s%16).toString(16))})+'"':'"'+e+'"'},number:function(e){return isFinite(e)?String(e):"null"},"boolean":function(e){return String(e)},date:function(e){function t(e){return 10>e?"0"+e:e}return'"'+e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())+"T"+t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())+'"'}},CLASS_NAME:"OpenLayers.Format.JSON"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.GeoJSON=OpenLayers.Class(OpenLayers.Format.JSON,{ignoreExtraDims:!1,read:function(e,t,i){t=t?t:"FeatureCollection";var s=null,n=null;if(n="string"==typeof e?OpenLayers.Format.JSON.prototype.read.apply(this,[e,i]):e){if("string"!=typeof n.type)OpenLayers.Console.error("Bad GeoJSON - no type: "+e);else if(this.isValidType(n,t))switch(t){case"Geometry":try{s=this.parseGeometry(n)}catch(r){OpenLayers.Console.error(r)}break;case"Feature":try{s=this.parseFeature(n),s.type="Feature"}catch(r){OpenLayers.Console.error(r)}break;case"FeatureCollection":switch(s=[],n.type){case"Feature":try{s.push(this.parseFeature(n))}catch(r){s=null,OpenLayers.Console.error(r)}break;case"FeatureCollection":for(var a=0,o=n.features.length;o>a;++a)try{s.push(this.parseFeature(n.features[a]))}catch(r){s=null,OpenLayers.Console.error(r)}break;default:try{var l=this.parseGeometry(n);s.push(new OpenLayers.Feature.Vector(l))}catch(r){s=null,OpenLayers.Console.error(r)}}}}else OpenLayers.Console.error("Bad JSON: "+e);return s},isValidType:function(e,t){var i=!1;switch(t){case"Geometry":-1==OpenLayers.Util.indexOf(["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","Box","GeometryCollection"],e.type)?OpenLayers.Console.error("Unsupported geometry type: "+e.type):i=!0;break;case"FeatureCollection":i=!0;break;default:e.type==t?i=!0:OpenLayers.Console.error("Cannot convert types from "+e.type+" to "+t)}return i},parseFeature:function(e){var t,i,s,n;s=e.properties?e.properties:{},n=e.geometry&&e.geometry.bbox||e.bbox;try{i=this.parseGeometry(e.geometry)}catch(r){throw r}return t=new OpenLayers.Feature.Vector(i,s),n&&(t.bounds=OpenLayers.Bounds.fromArray(n)),e.id&&(t.fid=e.id),t},parseGeometry:function(e){if(null==e)return null;var t,i=!1;if("GeometryCollection"==e.type){if(!OpenLayers.Util.isArray(e.geometries))throw"GeometryCollection must have geometries array: "+e;for(var s=e.geometries.length,n=new Array(s),r=0;s>r;++r)n[r]=this.parseGeometry.apply(this,[e.geometries[r]]);t=new OpenLayers.Geometry.Collection(n),i=!0}else{if(!OpenLayers.Util.isArray(e.coordinates))throw"Geometry must have coordinates array: "+e;if(!this.parseCoords[e.type.toLowerCase()])throw"Unsupported geometry type: "+e.type;try{t=this.parseCoords[e.type.toLowerCase()].apply(this,[e.coordinates])}catch(a){throw a}}return this.internalProjection&&this.externalProjection&&!i&&t.transform(this.externalProjection,this.internalProjection),t},parseCoords:{point:function(e){if(0==this.ignoreExtraDims&&2!=e.length)throw"Only 2D points are supported: "+e;return new OpenLayers.Geometry.Point(e[0],e[1])},multipoint:function(e){for(var t=[],i=null,s=0,n=e.length;n>s;++s){try{i=this.parseCoords.point.apply(this,[e[s]])}catch(r){throw r}t.push(i)}return new OpenLayers.Geometry.MultiPoint(t)},linestring:function(e){for(var t=[],i=null,s=0,n=e.length;n>s;++s){try{i=this.parseCoords.point.apply(this,[e[s]])}catch(r){throw r}t.push(i)}return new OpenLayers.Geometry.LineString(t)},multilinestring:function(e){for(var t=[],i=null,s=0,n=e.length;n>s;++s){try{i=this.parseCoords.linestring.apply(this,[e[s]])}catch(r){throw r}t.push(i)}return new OpenLayers.Geometry.MultiLineString(t)},polygon:function(e){for(var t,i,s=[],n=0,r=e.length;r>n;++n){try{i=this.parseCoords.linestring.apply(this,[e[n]])}catch(a){throw a}t=new OpenLayers.Geometry.LinearRing(i.components),s.push(t)}return new OpenLayers.Geometry.Polygon(s)},multipolygon:function(e){for(var t=[],i=null,s=0,n=e.length;n>s;++s){try{i=this.parseCoords.polygon.apply(this,[e[s]])}catch(r){throw r}t.push(i)}return new OpenLayers.Geometry.MultiPolygon(t)},box:function(e){if(2!=e.length)throw"GeoJSON box coordinates must have 2 elements";return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(e[0][0],e[0][1]),new OpenLayers.Geometry.Point(e[1][0],e[0][1]),new OpenLayers.Geometry.Point(e[1][0],e[1][1]),new OpenLayers.Geometry.Point(e[0][0],e[1][1]),new OpenLayers.Geometry.Point(e[0][0],e[0][1])])])}},write:function(e,t){var i={type:null};if(OpenLayers.Util.isArray(e)){i.type="FeatureCollection";var s=e.length;i.features=new Array(s);for(var n=0;s>n;++n){var r=e[n];if(!r instanceof OpenLayers.Feature.Vector){var a="FeatureCollection only supports collections of features: "+r;throw a}i.features[n]=this.extract.feature.apply(this,[r])}}else 0==e.CLASS_NAME.indexOf("OpenLayers.Geometry")?i=this.extract.geometry.apply(this,[e]):e instanceof OpenLayers.Feature.Vector&&(i=this.extract.feature.apply(this,[e]),e.layer&&e.layer.projection&&(i.crs=this.createCRSObject(e)));return OpenLayers.Format.JSON.prototype.write.apply(this,[i,t])},createCRSObject:function(e){var t=e.layer.projection.toString(),i={};if(t.match(/epsg:/i)){var s=parseInt(t.substring(t.indexOf(":")+1));i=4326==s?{type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}}:{type:"name",properties:{name:"EPSG:"+s}}}return i},extract:{feature:function(e){var t=this.extract.geometry.apply(this,[e.geometry]),i={type:"Feature",properties:e.attributes,geometry:t};return null!=e.fid&&(i.id=e.fid),i},geometry:function(e){if(null==e)return null;this.internalProjection&&this.externalProjection&&(e=e.clone(),e.transform(this.internalProjection,this.externalProjection));var t,i=e.CLASS_NAME.split(".")[2],s=this.extract[i.toLowerCase()].apply(this,[e]);return t="Collection"==i?{type:"GeometryCollection",geometries:s}:{type:i,coordinates:s}},point:function(e){return[e.x,e.y]},multipoint:function(e){for(var t=[],i=0,s=e.components.length;s>i;++i)t.push(this.extract.point.apply(this,[e.components[i]]));return t},linestring:function(e){for(var t=[],i=0,s=e.components.length;s>i;++i)t.push(this.extract.point.apply(this,[e.components[i]]));return t},multilinestring:function(e){for(var t=[],i=0,s=e.components.length;s>i;++i)t.push(this.extract.linestring.apply(this,[e.components[i]]));return t},polygon:function(e){for(var t=[],i=0,s=e.components.length;s>i;++i)t.push(this.extract.linestring.apply(this,[e.components[i]]));return t},multipolygon:function(e){for(var t=[],i=0,s=e.components.length;s>i;++i)t.push(this.extract.polygon.apply(this,[e.components[i]]));return t},collection:function(e){for(var t=e.components.length,i=new Array(t),s=0;t>s;++s)i[s]=this.extract.geometry.apply(this,[e.components[s]]);return i}},CLASS_NAME:"OpenLayers.Format.GeoJSON"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Protocol.Script=OpenLayers.Class(OpenLayers.Protocol,{url:null,params:null,callback:null,callbackTemplate:"OpenLayers.Protocol.Script.registry.${id}",callbackKey:"callback",callbackPrefix:"",scope:null,format:null,pendingRequests:null,srsInBBOX:!1,initialize:function(e){if(e=e||{},this.params={},this.pendingRequests={},OpenLayers.Protocol.prototype.initialize.apply(this,arguments),this.format||(this.format=new OpenLayers.Format.GeoJSON),!this.filterToParams&&OpenLayers.Format.QueryStringFilter){var t=new OpenLayers.Format.QueryStringFilter({srsInBBOX:this.srsInBBOX});this.filterToParams=function(e,i){return t.write(e,i)}}},read:function(e){OpenLayers.Protocol.prototype.read.apply(this,arguments),e=OpenLayers.Util.applyDefaults(e,this.options),e.params=OpenLayers.Util.applyDefaults(e.params,this.options.params),e.filter&&this.filterToParams&&(e.params=this.filterToParams(e.filter,e.params));var t=new OpenLayers.Protocol.Response({requestType:"read"}),i=this.createRequest(e.url,e.params,OpenLayers.Function.bind(function(i){t.data=i,this.handleRead(t,e)},this));return t.priv=i,t},createRequest:function(e,t,i){var s=OpenLayers.Protocol.Script.register(i),n=OpenLayers.String.format(this.callbackTemplate,{id:s});t=OpenLayers.Util.extend({},t),t[this.callbackKey]=this.callbackPrefix+n,e=OpenLayers.Util.urlAppend(e,OpenLayers.Util.getParameterString(t));var r=document.createElement("script");r.type="text/javascript",r.src=e,r.id="OpenLayers_Protocol_Script_"+s,this.pendingRequests[r.id]=r;var a=document.getElementsByTagName("head")[0];return a.appendChild(r),r},destroyRequest:function(e){OpenLayers.Protocol.Script.unregister(e.id.split("_").pop()),delete this.pendingRequests[e.id],e.parentNode&&e.parentNode.removeChild(e)},handleRead:function(e,t){this.handleResponse(e,t)},handleResponse:function(e,t){t.callback&&(e.data?(e.features=this.parseFeatures(e.data),e.code=OpenLayers.Protocol.Response.SUCCESS):e.code=OpenLayers.Protocol.Response.FAILURE,this.destroyRequest(e.priv),t.callback.call(t.scope,e))},parseFeatures:function(e){return this.format.read(e)},abort:function(e){if(e)this.destroyRequest(e.priv);else for(var t in this.pendingRequests)this.destroyRequest(this.pendingRequests[t])},destroy:function(){this.abort(),delete this.params,delete this.format,OpenLayers.Protocol.prototype.destroy.apply(this)},CLASS_NAME:"OpenLayers.Protocol.Script"}),function(){var e=OpenLayers.Protocol.Script,t=0;e.registry={},e.register=function(i){var s="c"+ ++t;return e.registry[s]=function(){i.apply(this,arguments)},s},e.unregister=function(t){delete e.registry[t]}}(),/* Copyright (c) 2006-2013 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WCSDescribeCoverage=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.0",CLASS_NAME:"OpenLayers.Format.WCSDescribeCoverage"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.HTTPRequest=OpenLayers.Class(OpenLayers.Layer,{URL_HASH_FACTOR:(Math.sqrt(5)-1)/2,url:null,params:null,reproject:!1,initialize:function(e,t,i,s){OpenLayers.Layer.prototype.initialize.apply(this,[e,s]),this.url=t,this.params||(this.params=OpenLayers.Util.extend({},i))},destroy:function(){this.url=null,this.params=null,OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(e){return null==e&&(e=new OpenLayers.Layer.HTTPRequest(this.name,this.url,this.params,this.getOptions())),e=OpenLayers.Layer.prototype.clone.apply(this,[e])},setUrl:function(e){this.url=e},mergeNewParams:function(e){this.params=OpenLayers.Util.extend(this.params,e);var t=this.redraw();return null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"params"}),t},redraw:function(e){return e?this.mergeNewParams({_olSalt:Math.random()}):OpenLayers.Layer.prototype.redraw.apply(this,[])},selectUrl:function(e,t){for(var i=1,s=0,n=e.length;n>s;s++)i*=e.charCodeAt(s)*this.URL_HASH_FACTOR,i-=Math.floor(i);return t[Math.floor(i*t.length)]},getFullRequestString:function(e,t){var i=t||this.url,s=OpenLayers.Util.extend({},this.params);s=OpenLayers.Util.extend(s,e);var n=OpenLayers.Util.getParameterString(s);OpenLayers.Util.isArray(i)&&(i=this.selectUrl(n,i));var r=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(i));for(var a in s)a.toUpperCase()in r&&delete s[a];return n=OpenLayers.Util.getParameterString(s),OpenLayers.Util.urlAppend(i,n)},CLASS_NAME:"OpenLayers.Layer.HTTPRequest"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Tile=OpenLayers.Class({events:null,eventListeners:null,id:null,layer:null,url:null,bounds:null,size:null,position:null,isLoading:!1,initialize:function(e,t,i,s,n,r){this.layer=e,this.position=t.clone(),this.setBounds(i),this.url=s,n&&(this.size=n.clone()),this.id=OpenLayers.Util.createUniqueID("Tile_"),OpenLayers.Util.extend(this,r),this.events=new OpenLayers.Events(this),this.eventListeners instanceof Object&&this.events.on(this.eventListeners)},unload:function(){this.isLoading&&(this.isLoading=!1,this.events.triggerEvent("unload"))},destroy:function(){this.layer=null,this.bounds=null,this.size=null,this.position=null,this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy(),this.eventListeners=null,this.events=null},draw:function(e){e||this.clear();var t=this.shouldDraw();return t&&!e&&(t=this.events.triggerEvent("beforedraw")!==!1),t},shouldDraw:function(){var e=!1,t=this.layer.maxExtent;if(t){var i=this.layer.map,s=i.baseLayer.wrapDateLine&&i.getMaxExtent();this.bounds.intersectsBounds(t,{inclusive:!1,worldBounds:s})&&(e=!0)}return e||this.layer.displayOutsideMaxExtent},setBounds:function(e){if(e=e.clone(),this.layer.map.baseLayer.wrapDateLine){var t=this.layer.map.getMaxExtent(),i=this.layer.map.getResolution();e=e.wrapDateLine(t,{leftTolerance:i,rightTolerance:i})}this.bounds=e},moveTo:function(e,t,i){null==i&&(i=!0),this.setBounds(e),this.position=t.clone(),i&&this.draw()},clear:function(){},CLASS_NAME:"OpenLayers.Tile"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Tile.Image=OpenLayers.Class(OpenLayers.Tile,{url:null,imgDiv:null,frame:null,imageReloadAttempts:null,layerAlphaHack:null,asyncRequestId:null,blankImageUrl:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAQAIBRAA7",maxGetUrlLength:null,canvasContext:null,crossOriginKeyword:null,initialize:function(e,t,i,s){OpenLayers.Tile.prototype.initialize.apply(this,arguments),this.url=s,this.layerAlphaHack=this.layer.alpha&&OpenLayers.Util.alphaHack(),(null!=this.maxGetUrlLength||this.layer.gutter||this.layerAlphaHack)&&(this.frame=document.createElement("div"),this.frame.style.position="absolute",this.frame.style.overflow="hidden"),null!=this.maxGetUrlLength&&OpenLayers.Util.extend(this,OpenLayers.Tile.Image.IFrame)},destroy:function(){this.imgDiv&&(this.clear(),this.imgDiv=null,this.frame=null),this.asyncRequestId=null,OpenLayers.Tile.prototype.destroy.apply(this,arguments)},draw:function(){var e=OpenLayers.Tile.prototype.draw.apply(this,arguments);return e?(this.layer!=this.layer.map.baseLayer&&this.layer.reproject&&(this.bounds=this.getBoundsFromBaseLayer(this.position)),this.isLoading?this._loadEvent="reload":(this.isLoading=!0,this._loadEvent="loadstart"),this.positionTile(),this.renderTile()):this.unload(),e},renderTile:function(){if(this.layer.div.appendChild(this.getTile()),this.layer.async){var e=this.asyncRequestId=(this.asyncRequestId||0)+1;this.layer.getURLasync(this.bounds,function(t){e==this.asyncRequestId&&(this.url=t,this.initImage())},this)}else this.url=this.layer.getURL(this.bounds),this.initImage()},positionTile:function(){var e=this.getTile().style,t=this.frame?this.size:this.layer.getImageSize(this.bounds);e.left=this.position.x+"%",e.top=this.position.y+"%",e.width=t.w+"%",e.height=t.h+"%"},clear:function(){OpenLayers.Tile.prototype.clear.apply(this,arguments);var e=this.imgDiv;if(e){OpenLayers.Event.stopObservingElement(e);var t=this.getTile();t.parentNode===this.layer.div&&this.layer.div.removeChild(t),this.setImgSrc(),this.layerAlphaHack===!0&&(e.style.filter=""),OpenLayers.Element.removeClass(e,"olImageLoadError")}this.canvasContext=null},getImage:function(){if(!this.imgDiv){this.imgDiv=document.createElement("img"),this.imgDiv.className="olTileImage",this.imgDiv.galleryImg="no";var e=this.imgDiv.style;if(this.frame){var t=0,i=0;this.layer.gutter&&(t=100*(this.layer.gutter/this.layer.tileSize.w),i=100*(this.layer.gutter/this.layer.tileSize.h)),e.left=-t+"%",e.top=-i+"%",e.width=2*t+100+"%",e.height=2*i+100+"%"}e.visibility="hidden",e.opacity=0,this.layer.opacity<1&&(e.filter="alpha(opacity="+100*this.layer.opacity+")"),e.position="absolute",this.layerAlphaHack&&(e.paddingTop=e.height,e.height="0",e.width="100%"),this.frame&&this.frame.appendChild(this.imgDiv)}return this.imgDiv},initImage:function(){this.events.triggerEvent(this._loadEvent);var e=this.getImage();if(this.url&&e.getAttribute("src")==this.url)this.onImageLoad();else{var t=OpenLayers.Function.bind(function(){OpenLayers.Event.stopObservingElement(e),OpenLayers.Event.observe(e,"load",OpenLayers.Function.bind(this.onImageLoad,this)),OpenLayers.Event.observe(e,"error",OpenLayers.Function.bind(this.onImageError,this)),this.imageReloadAttempts=0,this.setImgSrc(this.url)},this);e.getAttribute("src")==this.blankImageUrl?t():(OpenLayers.Event.observe(e,"load",t),OpenLayers.Event.observe(e,"error",t),this.crossOriginKeyword&&e.removeAttribute("crossorigin"),e.src=this.blankImageUrl)}},setImgSrc:function(e){var t=this.imgDiv;t.style.visibility="hidden",t.style.opacity=0,e&&(this.crossOriginKeyword&&("data:"!==e.substr(0,5)?t.setAttribute("crossorigin",this.crossOriginKeyword):t.removeAttribute("crossorigin")),t.src=e)},getTile:function(){return this.frame?this.frame:this.getImage()},createBackBuffer:function(){if(this.imgDiv&&!this.isLoading){var e;return this.frame?(e=this.frame.cloneNode(!1),e.appendChild(this.imgDiv)):e=this.imgDiv,this.imgDiv=null,e}},onImageLoad:function(){var e=this.imgDiv;if(OpenLayers.Event.stopObservingElement(e),e.style.visibility="inherit",e.style.opacity=this.layer.opacity,this.isLoading=!1,this.canvasContext=null,this.events.triggerEvent("loadend"),parseFloat(navigator.appVersion.split("MSIE")[1])<7&&this.layer&&this.layer.div){var t=document.createElement("span");t.style.display="none";var i=this.layer.div;i.appendChild(t),window.setTimeout(function(){t.parentNode===i&&t.parentNode.removeChild(t)},0)}this.layerAlphaHack===!0&&(e.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+e.src+"', sizingMethod='scale')")},onImageError:function(){var e=this.imgDiv;null!=e.src&&(this.imageReloadAttempts++,this.imageReloadAttempts<=OpenLayers.IMAGE_RELOAD_ATTEMPTS?this.setImgSrc(this.layer.getURL(this.bounds)):(OpenLayers.Element.addClass(e,"olImageLoadError"),this.events.triggerEvent("loaderror"),this.onImageLoad()))},getCanvasContext:function(){if(OpenLayers.CANVAS_SUPPORTED&&this.imgDiv&&!this.isLoading){if(!this.canvasContext){var e=document.createElement("canvas");e.width=this.size.w,e.height=this.size.h,this.canvasContext=e.getContext("2d"),this.canvasContext.drawImage(this.imgDiv,0,0)}return this.canvasContext}},CLASS_NAME:"OpenLayers.Tile.Image"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.Grid=OpenLayers.Class(OpenLayers.Layer.HTTPRequest,{tileSize:null,tileOriginCorner:"bl",tileOrigin:null,tileOptions:null,tileClass:OpenLayers.Tile.Image,grid:null,singleTile:!1,ratio:1.5,buffer:0,transitionEffect:null,numLoadingTiles:0,tileLoadingDelay:85,serverResolutions:null,moveTimerId:null,deferMoveGriddedTiles:null,tileQueueId:null,tileQueue:null,loading:!1,backBuffer:null,gridResolution:null,backBufferResolution:null,backBufferLonLat:null,backBufferTimerId:null,removeBackBufferDelay:null,className:null,initialize:function(){OpenLayers.Layer.HTTPRequest.prototype.initialize.apply(this,arguments),this.grid=[],this.tileQueue=[],null===this.removeBackBufferDelay&&(this.removeBackBufferDelay=this.singleTile?0:2500),null===this.className&&(this.className=this.singleTile?"olLayerGridSingleTile":"olLayerGrid"),OpenLayers.Animation.isNative||(this.deferMoveGriddedTiles=OpenLayers.Function.bind(function(){this.moveGriddedTiles(!0),this.moveTimerId=null},this))},setMap:function(e){OpenLayers.Layer.HTTPRequest.prototype.setMap.call(this,e),OpenLayers.Element.addClass(this.div,this.className)},removeMap:function(){null!==this.moveTimerId&&(window.clearTimeout(this.moveTimerId),this.moveTimerId=null),this.clearTileQueue(),null!==this.backBufferTimerId&&(window.clearTimeout(this.backBufferTimerId),this.backBufferTimerId=null)},destroy:function(){this.removeBackBuffer(),this.clearGrid(),this.grid=null,this.tileSize=null,OpenLayers.Layer.HTTPRequest.prototype.destroy.apply(this,arguments)},clearGrid:function(){if(this.clearTileQueue(),this.grid){for(var e=0,t=this.grid.length;t>e;e++)for(var i=this.grid[e],s=0,n=i.length;n>s;s++){var r=i[s];this.destroyTile(r)}this.grid=[],this.gridResolution=null}},clone:function(e){return null==e&&(e=new OpenLayers.Layer.Grid(this.name,this.url,this.params,this.getOptions())),e=OpenLayers.Layer.HTTPRequest.prototype.clone.apply(this,[e]),null!=this.tileSize&&(e.tileSize=this.tileSize.clone()),e.grid=[],e.gridResolution=null,e.backBuffer=null,e.backBufferTimerId=null,e.tileQueue=[],e.tileQueueId=null,e.loading=!1,e.moveTimerId=null,e},moveTo:function(e,t,i){if(OpenLayers.Layer.HTTPRequest.prototype.moveTo.apply(this,arguments),e=e||this.map.getExtent(),null!=e){var s=!this.grid.length||t,n=this.getTilesBounds(),r=this.map.getResolution(),a=this.getServerResolution(r);if(this.singleTile)(s||!i&&!n.containsBounds(e))&&(t&&"resize"!==this.transitionEffect&&this.removeBackBuffer(),t&&"resize"!==this.transitionEffect||this.applyBackBuffer(a),this.initSingleTile(e));else{if(s=s||!n.intersectsBounds(e,{worldBounds:this.map.baseLayer.wrapDateLine&&this.map.getMaxExtent()}),r!==a){if(e=this.map.calculateBounds(null,a),s){var o=a/r;this.transformDiv(o)}}else this.div.style.width="100%",this.div.style.height="100%",this.div.style.left="0%",this.div.style.top="0%";s?(t&&"resize"===this.transitionEffect&&this.applyBackBuffer(a),this.initGriddedTiles(e)):this.moveGriddedTiles()}}},getTileData:function(e){var t=null,i=e.lon,s=e.lat,n=this.grid.length;if(this.map&&n){var r=this.map.getResolution(),a=this.tileSize.w,o=this.tileSize.h,l=this.grid[0][0].bounds,h=l.left,u=l.top;if(h>i&&this.map.baseLayer.wrapDateLine){var c=this.map.getMaxExtent().getWidth(),d=Math.ceil((h-i)/c);i+=c*d}var p=(i-h)/(r*a),f=(u-s)/(r*o),m=Math.floor(p),y=Math.floor(f);if(y>=0&&n>y){var g=this.grid[y][m];g&&(t={tile:g,i:Math.floor((p-m)*a),j:Math.floor((f-y)*o)})}}return t},queueTileDraw:function(e){var t=e.object;return~OpenLayers.Util.indexOf(this.tileQueue,t)||this.tileQueue.push(t),this.tileQueueId||(this.tileQueueId=OpenLayers.Animation.start(OpenLayers.Function.bind(this.drawTileFromQueue,this),null,this.div)),!1},drawTileFromQueue:function(){0===this.tileQueue.length?this.clearTileQueue():this.tileQueue.shift().draw(!0)},clearTileQueue:function(){OpenLayers.Animation.stop(this.tileQueueId),this.tileQueueId=null,this.tileQueue=[]},destroyTile:function(e){this.removeTileMonitoringHooks(e),e.destroy()},getServerResolution:function(e){if(e=e||this.map.getResolution(),this.serverResolutions&&-1===OpenLayers.Util.indexOf(this.serverResolutions,e)){var t,i;for(t=this.serverResolutions.length-1;t>=0;t--)if(i=this.serverResolutions[t],i>e){e=i;break}if(-1===t)throw"no appropriate resolution in serverResolutions"}return e},getServerZoom:function(){var e=this.getServerResolution();return this.serverResolutions?OpenLayers.Util.indexOf(this.serverResolutions,e):this.map.getZoomForResolution(e)+(this.zoomOffset||0)},transformDiv:function(e){this.div.style.width=100*e+"%",this.div.style.height=100*e+"%";var t=this.map.getSize(),i=parseInt(this.map.layerContainerDiv.style.left,10),s=parseInt(this.map.layerContainerDiv.style.top,10),n=(i-t.w/2)*(e-1),r=(s-t.h/2)*(e-1);this.div.style.left=n+"%",this.div.style.top=r+"%"},getResolutionScale:function(){return parseInt(this.div.style.width,10)/100},applyBackBuffer:function(e){null!==this.backBufferTimerId&&this.removeBackBuffer();var t=this.backBuffer;if(!t){if(t=this.createBackBuffer(),!t)return;this.div.insertBefore(t,this.div.firstChild),this.backBuffer=t;var i=this.grid[0][0].bounds;this.backBufferLonLat={lon:i.left,lat:i.top},this.backBufferResolution=this.gridResolution}var s=t.style,n=this.backBufferResolution/e;s.width=100*n+"%",s.height=100*n+"%";var r=this.getViewPortPxFromLonLat(this.backBufferLonLat,e),a=parseInt(this.map.layerContainerDiv.style.left,10),o=parseInt(this.map.layerContainerDiv.style.top,10);t.style.left=Math.round(r.x-a)+"%",t.style.top=Math.round(r.y-o)+"%"},createBackBuffer:function(){var e;if(this.grid.length>0){e=document.createElement("div"),e.id=this.div.id+"_bb",e.className="olBackBuffer",e.style.position="absolute",e.style.width="100%",e.style.height="100%";for(var t=0,i=this.grid.length;i>t;t++)for(var s=0,n=this.grid[t].length;n>s;s++){var r=this.grid[t][s].createBackBuffer();r&&(r.style.top=t*this.tileSize.h+"%",r.style.left=s*this.tileSize.w+"%",e.appendChild(r))}}return e},removeBackBuffer:function(){this.backBuffer&&(this.div.removeChild(this.backBuffer),this.backBuffer=null,this.backBufferResolution=null,null!==this.backBufferTimerId&&(window.clearTimeout(this.backBufferTimerId),this.backBufferTimerId=null))},moveByPx:function(){this.singleTile||this.moveGriddedTiles()},setTileSize:function(e){this.singleTile&&(e=this.map.getSize(),e.h=parseInt(e.h*this.ratio),e.w=parseInt(e.w*this.ratio)),OpenLayers.Layer.HTTPRequest.prototype.setTileSize.apply(this,[e])},getTilesBounds:function(){var e=null,t=this.grid.length;if(t){var i=this.grid[t-1][0].bounds,s=this.grid[0].length*i.getWidth(),n=this.grid.length*i.getHeight();e=new OpenLayers.Bounds(i.left,i.bottom,i.left+s,i.bottom+n)}return e},initSingleTile:function(e){this.clearTileQueue();var t=e.getCenterLonLat(),i=e.getWidth()*this.ratio,s=e.getHeight()*this.ratio,n=new OpenLayers.Bounds(t.lon-i/2,t.lat-s/2,t.lon+i/2,t.lat+s/2),r=this.map.getLayerPxFromLonLat({lon:n.left,lat:n.top});this.grid.length||(this.grid[0]=[]);var a=this.grid[0][0];a?a.moveTo(n,r):(a=this.addTile(n,r),this.addTileMonitoringHooks(a),a.draw(),this.grid[0][0]=a),this.removeExcessTiles(1,1),this.gridResolution=this.getServerResolution()},calculateGridLayout:function(e,t,i){var s=i*this.tileSize.w,n=i*this.tileSize.h,r=e.left-t.lon,a=Math.floor(r/s)-this.buffer,o=r/s-a,l=-o*this.tileSize.w,h=t.lon+a*s,u=e.top-(t.lat+n),c=Math.ceil(u/n)+this.buffer,d=c-u/n,p=-d*this.tileSize.h,f=t.lat+c*n;return{tilelon:s,tilelat:n,tileoffsetlon:h,tileoffsetlat:f,tileoffsetx:l,tileoffsety:p}},getTileOrigin:function(){var e=this.tileOrigin;if(!e){var t=this.getMaxExtent(),i={tl:["left","top"],tr:["right","top"],bl:["left","bottom"],br:["right","bottom"]}[this.tileOriginCorner];e=new OpenLayers.LonLat(t[i[0]],t[i[1]])}return e},initGriddedTiles:function(e){this.clearTileQueue();var t=this.map.getSize(),i=Math.ceil(t.h/this.tileSize.h)+Math.max(1,2*this.buffer),s=Math.ceil(t.w/this.tileSize.w)+Math.max(1,2*this.buffer),n=this.getTileOrigin(),r=this.getServerResolution(),a=this.calculateGridLayout(e,n,r),o=Math.round(a.tileoffsetx),l=Math.round(a.tileoffsety),h=a.tileoffsetlon,u=a.tileoffsetlat,c=a.tilelon,d=a.tilelat,p=o,f=h,m=0,y=parseInt(this.map.layerContainerDiv.style.left),g=parseInt(this.map.layerContainerDiv.style.top),v=[],x=this.map.getCenter();do{var E=this.grid[m++];E||(E=[],this.grid.push(E)),h=f,o=p;var b=0;do{var L=new OpenLayers.Bounds(h,u,h+c,u+d),S=o;S-=y;var C=l;C-=g;var w=new OpenLayers.Pixel(S,C),O=E[b++];O?O.moveTo(L,w,!1):(O=this.addTile(L,w),this.addTileMonitoringHooks(O),E.push(O));var T=L.getCenterLonLat();v.push({tile:O,distance:Math.pow(T.lon-x.lon,2)+Math.pow(T.lat-x.lat,2)}),h+=c,o+=this.tileSize.w}while(h<=e.right+c*this.buffer||s>b);u-=d,l+=this.tileSize.h}while(u>=e.bottom-d*this.buffer||i>m);this.removeExcessTiles(m,b),this.gridResolution=this.getServerResolution(),v.sort(function(e,t){return e.distance-t.distance});for(var M=0,P=v.length;P>M;++M)v[M].tile.draw()},getMaxExtent:function(){return this.maxExtent},addTile:function(e,t){var i=new this.tileClass(this,t,e,null,this.tileSize,this.tileOptions);return i.events.register("beforedraw",this,this.queueTileDraw),i},addTileMonitoringHooks:function(e){e.onLoadStart=function(){this.loading===!1&&(this.loading=!0,this.events.triggerEvent("loadstart")),this.events.triggerEvent("tileloadstart",{tile:e}),this.numLoadingTiles++},e.onLoadEnd=function(){this.numLoadingTiles--,this.events.triggerEvent("tileloaded",{tile:e}),0===this.tileQueue.length&&0===this.numLoadingTiles&&(this.loading=!1,this.events.triggerEvent("loadend"),this.backBuffer&&(this.backBufferTimerId=window.setTimeout(OpenLayers.Function.bind(this.removeBackBuffer,this),this.removeBackBufferDelay)))},e.onLoadError=function(){this.events.triggerEvent("tileerror",{tile:e})},e.events.on({loadstart:e.onLoadStart,loadend:e.onLoadEnd,unload:e.onLoadEnd,loaderror:e.onLoadError,scope:this})},removeTileMonitoringHooks:function(e){e.unload(),e.events.un({loadstart:e.onLoadStart,loadend:e.onLoadEnd,unload:e.onLoadEnd,loaderror:e.onLoadError,scope:this})},moveGriddedTiles:function(e){if(!e&&!OpenLayers.Animation.isNative)return null!=this.moveTimerId&&window.clearTimeout(this.moveTimerId),this.moveTimerId=window.setTimeout(this.deferMoveGriddedTiles,this.tileLoadingDelay),void 0;for(var t=this.buffer||1,i=this.getResolutionScale();;){var s={x:this.grid[0][0].position.x*i+parseInt(this.div.style.left,10)+parseInt(this.map.layerContainerDiv.style.left),y:this.grid[0][0].position.y*i+parseInt(this.div.style.top,10)+parseInt(this.map.layerContainerDiv.style.top)},n={w:this.tileSize.w*i,h:this.tileSize.h*i};if(s.x>-n.w*(t-1))this.shiftColumn(!0);else if(s.x<-n.w*t)this.shiftColumn(!1);else if(s.y>-n.h*(t-1))this.shiftRow(!0);else{if(!(s.y<-n.h*t))break;this.shiftRow(!1)}}},shiftRow:function(e){for(var t=e?0:this.grid.length-1,i=this.grid,s=i[t],n=this.getServerResolution(),r=e?-this.tileSize.h:this.tileSize.h,a=n*-r,o=e?i.pop():i.shift(),l=0,h=s.length;h>l;l++){var u=s[l],c=u.bounds.clone(),d=u.position.clone();c.bottom=c.bottom+a,c.top=c.top+a,d.y=d.y+r,o[l].moveTo(c,d)}e?i.unshift(o):i.push(o)},shiftColumn:function(e){for(var t=e?-this.tileSize.w:this.tileSize.w,i=this.getServerResolution(),s=i*t,n=0,r=this.grid.length;r>n;n++){var a=this.grid[n],o=e?0:a.length-1,l=a[o],h=l.bounds.clone(),u=l.position.clone();h.left=h.left+s,h.right=h.right+s,u.x=u.x+t;var c=e?this.grid[n].pop():this.grid[n].shift();c.moveTo(h,u),e?a.unshift(c):a.push(c)}},removeExcessTiles:function(e,t){for(var i,s;this.grid.length>e;){var n=this.grid.pop();for(i=0,s=n.length;s>i;i++){var r=n[i];this.destroyTile(r)}}for(i=0,s=this.grid.length;s>i;i++)for(;this.grid[i].length>t;){var n=this.grid[i],r=n.pop();this.destroyTile(r)}},onMapResize:function(){this.singleTile&&(this.clearGrid(),this.setTileSize())},getTileBounds:function(e){var t=this.maxExtent,i=this.getResolution(),s=i*this.tileSize.w,n=i*this.tileSize.h,r=this.getLonLatFromViewPortPx(e),a=t.left+s*Math.floor((r.lon-t.left)/s),o=t.bottom+n*Math.floor((r.lat-t.bottom)/n);return new OpenLayers.Bounds(a,o,a+s,o+n)},CLASS_NAME:"OpenLayers.Layer.Grid"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.ArcXML=OpenLayers.Class(OpenLayers.Format.XML,{fontStyleKeys:["antialiasing","blockout","font","fontcolor","fontsize","fontstyle","glowing","interval","outline","printmode","shadow","transparency"],request:null,response:null,initialize:function(e){if(this.request=new OpenLayers.Format.ArcXML.Request,this.response=new OpenLayers.Format.ArcXML.Response,e)if("feature"==e.requesttype){this.request.get_image=null;var t=this.request.get_feature.query;this.addCoordSys(t.featurecoordsys,e.featureCoordSys),this.addCoordSys(t.filtercoordsys,e.filterCoordSys),e.polygon?(t.isspatial=!0,t.spatialfilter.polygon=e.polygon):e.envelope&&(t.isspatial=!0,t.spatialfilter.envelope={minx:0,miny:0,maxx:0,maxy:0},this.parseEnvelope(t.spatialfilter.envelope,e.envelope))}else if("image"==e.requesttype){this.request.get_feature=null;var i=this.request.get_image.properties;this.parseEnvelope(i.envelope,e.envelope),this.addLayers(i.layerlist,e.layers),this.addImageSize(i.imagesize,e.tileSize),this.addCoordSys(i.featurecoordsys,e.featureCoordSys),this.addCoordSys(i.filtercoordsys,e.filterCoordSys)}else this.request=null;OpenLayers.Format.XML.prototype.initialize.apply(this,[e])},parseEnvelope:function(e,t){t&&4==t.length&&(e.minx=t[0],e.miny=t[1],e.maxx=t[2],e.maxy=t[3])},addLayers:function(e,t){for(var i=0,s=t.length;s>i;i++)e.push(t[i])},addImageSize:function(e,t){null!==t&&(e.width=t.w,e.height=t.h,e.printwidth=t.w,e.printheight=t.h)},addCoordSys:function(e,t){"string"==typeof t?(e.id=parseInt(t),e.string=t):"object"==typeof t&&null!==t.proj?(e.id=t.proj.srsProjNumber,e.string=t.proj.srsCode):e=t},iserror:function(e){var t=null;if(e){e=OpenLayers.Format.XML.prototype.read.apply(this,[e]);var i=e.documentElement.getElementsByTagName("ERROR");t=null!==i&&i.length>0}else t=""!==this.response.error;return t},read:function(e){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e]));var t=null;if(e&&e.documentElement&&(t="ARCXML"==e.documentElement.nodeName?e.documentElement:e.documentElement.getElementsByTagName("ARCXML")[0]),!t||"parsererror"===t.firstChild.nodeName){var i,s;try{i=e.firstChild.nodeValue,s=e.firstChild.childNodes[1].firstChild.nodeValue}catch(n){}throw{message:"Error parsing the ArcXML request",error:i,source:s}}var r=this.parseResponse(t);return r},write:function(e){e||(e=this.request);var t=this.createElementNS("","ARCXML");t.setAttribute("version","1.1");var i=this.createElementNS("","REQUEST");if(null!=e.get_image){var s=this.createElementNS("","GET_IMAGE");i.appendChild(s);var n=this.createElementNS("","PROPERTIES");s.appendChild(n);var r=e.get_image.properties;if(null!=r.featurecoordsys){var a=this.createElementNS("","FEATURECOORDSYS");n.appendChild(a),0===r.featurecoordsys.id?a.setAttribute("string",r.featurecoordsys.string):a.setAttribute("id",r.featurecoordsys.id)}if(null!=r.filtercoordsys){var o=this.createElementNS("","FILTERCOORDSYS");n.appendChild(o),0===r.filtercoordsys.id?o.setAttribute("string",r.filtercoordsys.string):o.setAttribute("id",r.filtercoordsys.id)}if(null!=r.envelope){var l=this.createElementNS("","ENVELOPE");n.appendChild(l),l.setAttribute("minx",r.envelope.minx),l.setAttribute("miny",r.envelope.miny),l.setAttribute("maxx",r.envelope.maxx),l.setAttribute("maxy",r.envelope.maxy)}var h=this.createElementNS("","IMAGESIZE");if(n.appendChild(h),h.setAttribute("height",r.imagesize.height),h.setAttribute("width",r.imagesize.width),(r.imagesize.height!=r.imagesize.printheight||r.imagesize.width!=r.imagesize.printwidth)&&(h.setAttribute("printheight",r.imagesize.printheight),h.setArrtibute("printwidth",r.imagesize.printwidth)),null!=r.background){var u=this.createElementNS("","BACKGROUND");n.appendChild(u),u.setAttribute("color",r.background.color.r+","+r.background.color.g+","+r.background.color.b),null!==r.background.transcolor&&u.setAttribute("transcolor",r.background.transcolor.r+","+r.background.transcolor.g+","+r.background.transcolor.b)}if(null!=r.layerlist&&r.layerlist.length>0){var c=this.createElementNS("","LAYERLIST");n.appendChild(c);for(var d=0;d<r.layerlist.length;d++){var p=this.createElementNS("","LAYERDEF");if(c.appendChild(p),p.setAttribute("id",r.layerlist[d].id),p.setAttribute("visible",r.layerlist[d].visible),"object"==typeof r.layerlist[d].query){var f=r.layerlist[d].query;if(f.where.length<0)continue;var m=null;m="boolean"==typeof f.spatialfilter&&f.spatialfilter?this.createElementNS("","SPATIALQUERY"):this.createElementNS("","QUERY"),m.setAttribute("where",f.where),"number"==typeof f.accuracy&&f.accuracy>0&&m.setAttribute("accuracy",f.accuracy),"number"==typeof f.featurelimit&&f.featurelimit<2e3&&m.setAttribute("featurelimit",f.featurelimit),"string"==typeof f.subfields&&"#ALL#"!=f.subfields&&m.setAttribute("subfields",f.subfields),"string"==typeof f.joinexpression&&f.joinexpression.length>0&&m.setAttribute("joinexpression",f.joinexpression),"string"==typeof f.jointables&&f.jointables.length>0&&m.setAttribute("jointables",f.jointables),p.appendChild(m)}"object"==typeof r.layerlist[d].renderer&&this.addRenderer(p,r.layerlist[d].renderer)}}}else if(null!=e.get_feature){var s=this.createElementNS("","GET_FEATURES");if(s.setAttribute("outputmode","newxml"),s.setAttribute("checkesc","true"),e.get_feature.geometry?s.setAttribute("geometry",e.get_feature.geometry):s.setAttribute("geometry","false"),e.get_feature.compact&&s.setAttribute("compact",e.get_feature.compact),"number"==e.get_feature.featurelimit&&s.setAttribute("featurelimit",e.get_feature.featurelimit),s.setAttribute("globalenvelope","true"),i.appendChild(s),null!=e.get_feature.layer&&e.get_feature.layer.length>0){var y=this.createElementNS("","LAYER");y.setAttribute("id",e.get_feature.layer),s.appendChild(y)}var g=e.get_feature.query;if(null!=g){var v=null;if(v=g.isspatial?this.createElementNS("","SPATIALQUERY"):this.createElementNS("","QUERY"),s.appendChild(v),"number"==typeof g.accuracy&&v.setAttribute("accuracy",g.accuracy),null!=g.featurecoordsys){var x=this.createElementNS("","FEATURECOORDSYS");0==g.featurecoordsys.id?x.setAttribute("string",g.featurecoordsys.string):x.setAttribute("id",g.featurecoordsys.id),v.appendChild(x)}if(null!=g.filtercoordsys){var E=this.createElementNS("","FILTERCOORDSYS");0===g.filtercoordsys.id?E.setAttribute("string",g.filtercoordsys.string):E.setAttribute("id",g.filtercoordsys.id),v.appendChild(E)}if(g.buffer>0){var b=this.createElementNS("","BUFFER");b.setAttribute("distance",g.buffer),v.appendChild(b)}if(g.isspatial){var L=this.createElementNS("","SPATIALFILTER");if(L.setAttribute("relation",g.spatialfilter.relation),v.appendChild(L),g.spatialfilter.envelope){var S=this.createElementNS("","ENVELOPE");S.setAttribute("minx",g.spatialfilter.envelope.minx),S.setAttribute("miny",g.spatialfilter.envelope.miny),S.setAttribute("maxx",g.spatialfilter.envelope.maxx),S.setAttribute("maxy",g.spatialfilter.envelope.maxy),L.appendChild(S)}else"object"==typeof g.spatialfilter.polygon&&L.appendChild(this.writePolygonGeometry(g.spatialfilter.polygon))}null!=g.where&&g.where.length>0&&v.setAttribute("where",g.where)}}return t.appendChild(i),OpenLayers.Format.XML.prototype.write.apply(this,[t])},addGroupRenderer:function(e,t){var i=this.createElementNS("","GROUPRENDERER");e.appendChild(i);for(var s=0;s<t.length;s++){var n=t[s];this.addRenderer(i,n)}},addRenderer:function(e,t){if(OpenLayers.Util.isArray(t))this.addGroupRenderer(e,t);else{var i=this.createElementNS("",t.type.toUpperCase()+"RENDERER");e.appendChild(i),"VALUEMAPRENDERER"==i.tagName?this.addValueMapRenderer(i,t):"VALUEMAPLABELRENDERER"==i.tagName?this.addValueMapLabelRenderer(i,t):"SIMPLELABELRENDERER"==i.tagName?this.addSimpleLabelRenderer(i,t):"SCALEDEPENDENTRENDERER"==i.tagName&&this.addScaleDependentRenderer(i,t)}},addScaleDependentRenderer:function(e,t){("string"==typeof t.lower||"number"==typeof t.lower)&&e.setAttribute("lower",t.lower),("string"==typeof t.upper||"number"==typeof t.upper)&&e.setAttribute("upper",t.upper),this.addRenderer(e,t.renderer)},addValueMapLabelRenderer:function(e,t){if(e.setAttribute("lookupfield",t.lookupfield),e.setAttribute("labelfield",t.labelfield),"object"==typeof t.exacts)for(var i=0,s=t.exacts.length;s>i;i++){var n=t.exacts[i],r=this.createElementNS("","EXACT");if("string"==typeof n.value&&r.setAttribute("value",n.value),"string"==typeof n.label&&r.setAttribute("label",n.label),"string"==typeof n.method&&r.setAttribute("method",n.method),e.appendChild(r),"object"==typeof n.symbol){var a=null;if("text"==n.symbol.type&&(a=this.createElementNS("","TEXTSYMBOL")),null!=a){for(var o=this.fontStyleKeys,l=0,h=o.length;h>l;l++){var u=o[l];n.symbol[u]&&a.setAttribute(u,n.symbol[u])}r.appendChild(a)}}}},addValueMapRenderer:function(e,t){if(e.setAttribute("lookupfield",t.lookupfield),"object"==typeof t.ranges)for(var i=0,s=t.ranges.length;s>i;i++){var n=t.ranges[i],r=this.createElementNS("","RANGE");if(r.setAttribute("lower",n.lower),r.setAttribute("upper",n.upper),e.appendChild(r),"object"==typeof n.symbol){var a=null;"simplepolygon"==n.symbol.type&&(a=this.createElementNS("","SIMPLEPOLYGONSYMBOL")),null!=a&&("string"==typeof n.symbol.boundarycolor&&a.setAttribute("boundarycolor",n.symbol.boundarycolor),"string"==typeof n.symbol.fillcolor&&a.setAttribute("fillcolor",n.symbol.fillcolor),"number"==typeof n.symbol.filltransparency&&a.setAttribute("filltransparency",n.symbol.filltransparency),r.appendChild(a))}}else if("object"==typeof t.exacts)for(var o=0,l=t.exacts.length;l>o;o++){var h=t.exacts[o],u=this.createElementNS("","EXACT");if("string"==typeof h.value&&u.setAttribute("value",h.value),"string"==typeof h.label&&u.setAttribute("label",h.label),"string"==typeof h.method&&u.setAttribute("method",h.method),e.appendChild(u),"object"==typeof h.symbol){var a=null;"simplemarker"==h.symbol.type&&(a=this.createElementNS("","SIMPLEMARKERSYMBOL")),null!=a&&("string"==typeof h.symbol.antialiasing&&a.setAttribute("antialiasing",h.symbol.antialiasing),"string"==typeof h.symbol.color&&a.setAttribute("color",h.symbol.color),"string"==typeof h.symbol.outline&&a.setAttribute("outline",h.symbol.outline),"string"==typeof h.symbol.overlap&&a.setAttribute("overlap",h.symbol.overlap),"string"==typeof h.symbol.shadow&&a.setAttribute("shadow",h.symbol.shadow),"number"==typeof h.symbol.transparency&&a.setAttribute("transparency",h.symbol.transparency),"string"==typeof h.symbol.usecentroid&&a.setAttribute("usecentroid",h.symbol.usecentroid),"number"==typeof h.symbol.width&&a.setAttribute("width",h.symbol.width),u.appendChild(a))}}},addSimpleLabelRenderer:function(e,t){e.setAttribute("field",t.field);for(var i=["featureweight","howmanylabels","labelbufferratio","labelpriorities","labelweight","linelabelposition","rotationalangles"],s=0,n=i.length;n>s;s++){var r=i[s];t[r]&&e.setAttribute(r,t[r])}if("text"==t.symbol.type){var a=t.symbol,o=this.createElementNS("","TEXTSYMBOL");e.appendChild(o);for(var i=this.fontStyleKeys,s=0,n=i.length;n>s;s++){var r=i[s];a[r]&&o.setAttribute(r,t[r])}}},writePolygonGeometry:function(e){if(!(e instanceof OpenLayers.Geometry.Polygon))throw{message:"Cannot write polygon geometry to ArcXML with an "+e.CLASS_NAME+" object.",geometry:e};for(var t=this.createElementNS("","POLYGON"),i=0,s=e.components.length;s>i;i++){for(var n=e.components[i],r=this.createElementNS("","RING"),a=0,o=n.components.length;o>a;a++){var l=n.components[a],h=this.createElementNS("","POINT");h.setAttribute("x",l.x),h.setAttribute("y",l.y),r.appendChild(h)}t.appendChild(r)}return t},parseResponse:function(e){if("string"==typeof e){var t=new OpenLayers.Format.XML;e=t.read(e)}var i=new OpenLayers.Format.ArcXML.Response,s=e.getElementsByTagName("ERROR");if(null!=s&&s.length>0)i.error=this.getChildValue(s,"Unknown error.");else{var n=e.getElementsByTagName("RESPONSE");if(null==n||0==n.length)return i.error="No RESPONSE tag found in ArcXML response.",i;var r=n[0].firstChild.nodeName;if("#text"==r&&(r=n[0].firstChild.nextSibling.nodeName),"IMAGE"==r){var a=e.getElementsByTagName("ENVELOPE"),o=e.getElementsByTagName("OUTPUT");if(null==a||0==a.length)i.error="No ENVELOPE tag found in ArcXML response.";else if(null==o||0==o.length)i.error="No OUTPUT tag found in ArcXML response.";else{var l=this.parseAttributes(a[0]),h=this.parseAttributes(o[0]);i.image="string"==typeof h.type?{envelope:l,output:{type:h.type,data:this.getChildValue(o[0])}}:{envelope:l,output:h}}}else if("FEATURES"==r){var u=n[0].getElementsByTagName("FEATURES"),c=u[0].getElementsByTagName("FEATURECOUNT");if(i.features.featurecount=c[0].getAttribute("count"),i.features.featurecount>0){var d=u[0].getElementsByTagName("ENVELOPE");i.features.envelope=this.parseAttributes(d[0],"number");for(var p=u[0].getElementsByTagName("FEATURE"),f=0;f<p.length;f++){for(var m=new OpenLayers.Feature.Vector,y=p[f].getElementsByTagName("FIELD"),g=0;g<y.length;g++){var v=y[g].getAttribute("name"),x=y[g].getAttribute("value");m.attributes[v]=x}var E=p[f].getElementsByTagName("POLYGON");if(E.length>0){for(var b=E[0].getElementsByTagName("RING"),L=[],S=0;S<b.length;S++){var C=[];C.push(this.parsePointGeometry(b[S]));for(var w=b[S].getElementsByTagName("HOLE"),O=0;O<w.length;O++)C.push(this.parsePointGeometry(w[O]));w=null,L.push(new OpenLayers.Geometry.Polygon(C)),C=null}b=null,m.geometry=1==L.length?L[0]:new OpenLayers.Geometry.MultiPolygon(L)}i.features.feature.push(m)}}}else i.error="Unidentified response type."}return i},parseAttributes:function(e,t){for(var i={},s=0;s<e.attributes.length;s++)i[e.attributes[s].nodeName]="number"==t?parseFloat(e.attributes[s].nodeValue):e.attributes[s].nodeValue;return i},parsePointGeometry:function(e){var t=[],i=e.getElementsByTagName("COORDS");if(i.length>0){var s=this.getChildValue(i[0]);s=s.split(/;/);for(var n=0;n<s.length;n++){var r=s[n].split(/ /);t.push(new OpenLayers.Geometry.Point(r[0],r[1]))}i=null}else{var a=e.getElementsByTagName("POINT");if(a.length>0)for(var o=0;o<a.length;o++)t.push(new OpenLayers.Geometry.Point(parseFloat(a[o].getAttribute("x")),parseFloat(a[o].getAttribute("y"))));a=null}return new OpenLayers.Geometry.LinearRing(t)},CLASS_NAME:"OpenLayers.Format.ArcXML"}),OpenLayers.Format.ArcXML.Request=OpenLayers.Class({initialize:function(){var e={get_image:{properties:{background:null,draw:!0,envelope:{minx:0,miny:0,maxx:0,maxy:0},featurecoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},filtercoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},imagesize:{height:0,width:0,dpi:96,printheight:0,printwidth:0,scalesymbols:!1},layerlist:[],output:{baseurl:"",legendbaseurl:"",legendname:"",legendpath:"",legendurl:"",name:"",path:"",type:"jpg",url:""}}},get_feature:{layer:"",query:{isspatial:!1,featurecoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},filtercoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},buffer:0,where:"",spatialfilter:{relation:"envelope_intersection",envelope:null}}},environment:{separators:{cs:" ",ts:";"}},layer:[],workspaces:[]};return OpenLayers.Util.extend(this,e)},CLASS_NAME:"OpenLayers.Format.ArcXML.Request"}),OpenLayers.Format.ArcXML.Response=OpenLayers.Class({initialize:function(){var e={image:{envelope:null,output:""},features:{featurecount:0,envelope:null,feature:[]},error:""};return OpenLayers.Util.extend(this,e)},CLASS_NAME:"OpenLayers.Format.ArcXML.Response"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.ArcIMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{ClientVersion:"9.2",ServiceName:""},featureCoordSys:"4326",filterCoordSys:"4326",layers:null,async:!0,name:"ArcIMS",isBaseLayer:!0,DEFAULT_OPTIONS:{tileSize:new OpenLayers.Size(512,512),featureCoordSys:"4326",filterCoordSys:"4326",layers:null,isBaseLayer:!0,async:!0,name:"ArcIMS"},initialize:function(e,t,i){this.tileSize=new OpenLayers.Size(512,512),this.params=OpenLayers.Util.applyDefaults({ServiceName:i.serviceName},this.DEFAULT_PARAMS),this.options=OpenLayers.Util.applyDefaults(i,this.DEFAULT_OPTIONS),OpenLayers.Layer.Grid.prototype.initialize.apply(this,[e,t,this.params,i]),this.transparent&&(this.isBaseLayer||(this.isBaseLayer=!1),"image/jpeg"==this.format&&(this.format=OpenLayers.Util.alphaHack()?"image/gif":"image/png")),null===this.options.layers&&(this.options.layers=[])},getURL:function(e){var t="";e=this.adjustBounds(e);var i=new OpenLayers.Format.ArcXML(OpenLayers.Util.extend(this.options,{requesttype:"image",envelope:e.toArray(),tileSize:this.tileSize})),s=new OpenLayers.Request.POST({url:this.getFullRequestString(),data:i.write(),async:!1});if(null!=s){var n=s.responseXML;n&&n.documentElement||(n=s.responseText);var r=new OpenLayers.Format.ArcXML,a=r.read(n);t=this.getUrlOrImage(a.image.output)}return t},getURLasync:function(e,t,i){e=this.adjustBounds(e);var s=new OpenLayers.Format.ArcXML(OpenLayers.Util.extend(this.options,{requesttype:"image",envelope:e.toArray(),tileSize:this.tileSize}));OpenLayers.Request.POST({url:this.getFullRequestString(),async:!0,data:s.write(),callback:function(e){var s=e.responseXML;s&&s.documentElement||(s=e.responseText);var n=new OpenLayers.Format.ArcXML,r=n.read(s);t.call(i,this.getUrlOrImage(r.image.output))},scope:this})},getUrlOrImage:function(e){var t="";return e.url?t=e.url:e.data&&(t="data:image/"+e.type+";base64,"+e.data),t},setLayerQuery:function(e,t){for(var i=0;i<this.options.layers.length;i++)if(e==this.options.layers[i].id)return this.options.layers[i].query=t,void 0;this.options.layers.push({id:e,visible:!0,query:t})},getFeatureInfo:function(e,t,i){var s=i.buffer||1,n=i.callback||function(){},r=i.scope||window,a={};OpenLayers.Util.extend(a,this.options),a.requesttype="feature",e instanceof OpenLayers.LonLat?(a.polygon=null,a.envelope=[e.lon-s,e.lat-s,e.lon+s,e.lat+s]):e instanceof OpenLayers.Geometry.Polygon&&(a.envelope=null,a.polygon=e);var o=new OpenLayers.Format.ArcXML(a);if(OpenLayers.Util.extend(o.request.get_feature,i),o.request.get_feature.layer=t.id,"number"==typeof t.query.accuracy)o.request.get_feature.query.accuracy=t.query.accuracy;else{var l=this.map.getCenter(),h=this.map.getViewPortPxFromLonLat(l);h.x++;var u=this.map.getLonLatFromPixel(h);o.request.get_feature.query.accuracy=u.lon-l.lon}o.request.get_feature.query.where=t.query.where,o.request.get_feature.query.spatialfilter.relation="area_intersection",OpenLayers.Request.POST({url:this.getFullRequestString({CustomService:"Query"}),data:o.write(),callback:function(e){var t=o.parseResponse(e.responseText);o.iserror()?n.call(r,null):n.call(r,t.features)}})},clone:function(e){return null==e&&(e=new OpenLayers.Layer.ArcIMS(this.name,this.url,this.getOptions())),e=OpenLayers.Layer.Grid.prototype.clone.apply(this,[e])},CLASS_NAME:"OpenLayers.Layer.ArcIMS"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.OWSCommon.v1_1_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1,{namespaces:{ows:"http://www.opengis.net/ows/1.1",xlink:"http://www.w3.org/1999/xlink"},readers:{ows:OpenLayers.Util.applyDefaults({ExceptionReport:function(e,t){t.exceptionReport={version:e.getAttribute("version"),language:e.getAttribute("xml:lang"),exceptions:[]},this.readChildNodes(e,t.exceptionReport)},AllowedValues:function(e,t){t.allowedValues={},this.readChildNodes(e,t.allowedValues)},AnyValue:function(e,t){t.anyValue=!0},DataType:function(e,t){t.dataType=this.getChildValue(e)},Range:function(e,t){t.range={},this.readChildNodes(e,t.range)},MinimumValue:function(e,t){t.minValue=this.getChildValue(e)},MaximumValue:function(e,t){t.maxValue=this.getChildValue(e)},Identifier:function(e,t){t.identifier=this.getChildValue(e)},SupportedCRS:function(e,t){t.supportedCRS=this.getChildValue(e)}},OpenLayers.Format.OWSCommon.v1.prototype.readers.ows)},writers:{ows:OpenLayers.Util.applyDefaults({Range:function(e){var t=this.createElementNSPlus("ows:Range",{attributes:{"ows:rangeClosure":e.closure}});return this.writeNode("ows:MinimumValue",e.minValue,t),this.writeNode("ows:MaximumValue",e.maxValue,t),t},MinimumValue:function(e){var t=this.createElementNSPlus("ows:MinimumValue",{value:e});return t},MaximumValue:function(e){var t=this.createElementNSPlus("ows:MaximumValue",{value:e});return t},Value:function(e){var t=this.createElementNSPlus("ows:Value",{value:e});return t}},OpenLayers.Format.OWSCommon.v1.prototype.writers.ows)},CLASS_NAME:"OpenLayers.Format.OWSCommon.v1_1_0"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WCSGetCoverage=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows/1.1",wcs:"http://www.opengis.net/wcs/1.1",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},VERSION:"1.1.2",schemaLocation:"http://www.opengis.net/wcs/1.1 http://schemas.opengis.net/wcs/1.1/wcsGetCoverage.xsd",write:function(e){var t=this.writeNode("wcs:GetCoverage",e);return this.setAttributeNS(t,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation),OpenLayers.Format.XML.prototype.write.apply(this,[t])},writers:{wcs:{GetCoverage:function(e){var t=this.createElementNSPlus("wcs:GetCoverage",{attributes:{version:e.version||this.VERSION,service:"WCS"}});return this.writeNode("ows:Identifier",e.identifier,t),this.writeNode("wcs:DomainSubset",e.domainSubset,t),this.writeNode("wcs:Output",e.output,t),t},DomainSubset:function(e){var t=this.createElementNSPlus("wcs:DomainSubset",{});return this.writeNode("ows:BoundingBox",e.boundingBox,t),e.temporalSubset&&this.writeNode("wcs:TemporalSubset",e.temporalSubset,t),t},TemporalSubset:function(e){for(var t=this.createElementNSPlus("wcs:TemporalSubset",{}),i=0,s=e.timePeriods.length;s>i;++i)this.writeNode("wcs:TimePeriod",e.timePeriods[i],t);return t},TimePeriod:function(e){var t=this.createElementNSPlus("wcs:TimePeriod",{});return this.writeNode("wcs:BeginPosition",e.begin,t),this.writeNode("wcs:EndPosition",e.end,t),e.resolution&&this.writeNode("wcs:TimeResolution",e.resolution,t),t},BeginPosition:function(e){var t=this.createElementNSPlus("wcs:BeginPosition",{value:e});return t},EndPosition:function(e){var t=this.createElementNSPlus("wcs:EndPosition",{value:e});return t},TimeResolution:function(e){var t=this.createElementNSPlus("wcs:TimeResolution",{value:e});return t},Output:function(e){var t=this.createElementNSPlus("wcs:Output",{attributes:{format:e.format,store:e.store}});return e.gridCRS&&this.writeNode("wcs:GridCRS",e.gridCRS,t),t},GridCRS:function(e){var t=this.createElementNSPlus("wcs:GridCRS",{});return this.writeNode("wcs:GridBaseCRS",e.baseCRS,t),e.type&&this.writeNode("wcs:GridType",e.type,t),e.origin&&this.writeNode("wcs:GridOrigin",e.origin,t),this.writeNode("wcs:GridOffsets",e.offsets,t),e.CS&&this.writeNode("wcs:GridCS",e.CS,t),t},GridBaseCRS:function(e){return this.createElementNSPlus("wcs:GridBaseCRS",{value:e})},GridOrigin:function(e){return this.createElementNSPlus("wcs:GridOrigin",{value:e})},GridType:function(e){return this.createElementNSPlus("wcs:GridType",{value:e})},GridOffsets:function(e){return this.createElementNSPlus("wcs:GridOffsets",{value:e})},GridCS:function(e){return this.createElementNSPlus("wcs:GridCS",{value:e})}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.writers.ows},CLASS_NAME:"OpenLayers.Format.WCSGetCoverage"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WPSExecute=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows/1.1",gml:"http://www.opengis.net/gml",wps:"http://www.opengis.net/wps/1.0.0",wfs:"http://www.opengis.net/wfs",ogc:"http://www.opengis.net/ogc",wcs:"http://www.opengis.net/wcs",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd",schemaLocationAttr:function(){return void 0},write:function(e){var t;window.ActiveXObject?(t=new ActiveXObject("Microsoft.XMLDOM"),this.xmldom=t):t=document.implementation.createDocument("","",null);var i=this.writeNode("wps:Execute",e,t);return this.setAttributeNS(i,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation),OpenLayers.Format.XML.prototype.write.apply(this,[i])},writers:{wps:{Execute:function(e){var t=this.createElementNSPlus("wps:Execute",{attributes:{version:this.VERSION,service:"WPS"}});return this.writeNode("ows:Identifier",e.identifier,t),this.writeNode("wps:DataInputs",e.dataInputs,t),this.writeNode("wps:ResponseForm",e.responseForm,t),t},ResponseForm:function(e){var t=this.createElementNSPlus("wps:ResponseForm",{});return e.rawDataOutput&&this.writeNode("wps:RawDataOutput",e.rawDataOutput,t),e.responseDocument&&this.writeNode("wps:ResponseDocument",e.responseDocument,t),t},ResponseDocument:function(e){var t=this.createElementNSPlus("wps:ResponseDocument",{attributes:{storeExecuteResponse:e.storeExecuteResponse,lineage:e.lineage,status:e.status}});return e.output&&this.writeNode("wps:Output",e.output,t),t},Output:function(e){var t=this.createElementNSPlus("wps:Output",{attributes:{asReference:e.asReference}});return this.writeNode("ows:Identifier",e.identifier,t),this.writeNode("ows:Title",e.title,t),this.writeNode("ows:Abstract",e["abstract"],t),t},RawDataOutput:function(e){var t=this.createElementNSPlus("wps:RawDataOutput",{attributes:{mimeType:e.mimeType}});return this.writeNode("ows:Identifier",e.identifier,t),t},DataInputs:function(e){for(var t=this.createElementNSPlus("wps:DataInputs",{}),i=0,s=e.length;s>i;++i)this.writeNode("wps:Input",e[i],t);return t},Input:function(e){var t=this.createElementNSPlus("wps:Input",{});return this.writeNode("ows:Identifier",e.identifier,t),e.title&&this.writeNode("ows:Title",e.title,t),e.data&&this.writeNode("wps:Data",e.data,t),e.reference&&this.writeNode("wps:Reference",e.reference,t),t},Data:function(e){var t=this.createElementNSPlus("wps:Data",{});return e.literalData?this.writeNode("wps:LiteralData",e.literalData,t):e.complexData&&this.writeNode("wps:ComplexData",e.complexData,t),t},LiteralData:function(e){var t=this.createElementNSPlus("wps:LiteralData",{attributes:{uom:e.uom},value:e.value});return t},ComplexData:function(e){var t=this.createElementNSPlus("wps:ComplexData",{attributes:{mimeType:e.mimeType,encoding:e.encoding,schema:e.schema}}),i=e.value;return"string"==typeof i?t.appendChild(this.getXMLDoc().createCDATASection(e.value)):t.appendChild(i),t},Reference:function(e){var t=this.createElementNSPlus("wps:Reference",{attributes:{mimeType:e.mimeType,"xlink:href":e.href,method:e.method,encoding:e.encoding,schema:e.schema}});return e.body&&this.writeNode("wps:Body",e.body,t),t},Body:function(e){var t=this.createElementNSPlus("wps:Body",{});return e.wcs?this.writeNode("wcs:GetCoverage",e.wcs,t):e.wfs?(this.featureType=e.wfs.featureType,this.version=e.wfs.version,this.writeNode("wfs:GetFeature",e.wfs,t)):this.writeNode("wps:Execute",e,t),t}},wcs:OpenLayers.Format.WCSGetCoverage.prototype.writers.wcs,wfs:OpenLayers.Format.WFST.v1_1_0.prototype.writers.wfs,ogc:OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc,ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.writers.ows},CLASS_NAME:"OpenLayers.Format.WPSExecute"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Strategy=OpenLayers.Class({layer:null,options:null,active:null,autoActivate:!0,autoDestroy:!0,initialize:function(e){OpenLayers.Util.extend(this,e),this.options=e,this.active=!1},destroy:function(){this.deactivate(),this.layer=null,this.options=null},setLayer:function(e){this.layer=e},activate:function(){return this.active?!1:(this.active=!0,!0)},deactivate:function(){return this.active?(this.active=!1,!0):!1},CLASS_NAME:"OpenLayers.Strategy"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Strategy.Filter=OpenLayers.Class(OpenLayers.Strategy,{filter:null,cache:null,caching:!1,activate:function(){var e=OpenLayers.Strategy.prototype.activate.apply(this,arguments);return e&&(this.cache=[],this.layer.events.on({beforefeaturesadded:this.handleAdd,beforefeaturesremoved:this.handleRemove,scope:this})),e},deactivate:function(){return this.cache=null,this.layer&&this.layer.events&&this.layer.events.un({beforefeaturesadded:this.handleAdd,beforefeaturesremoved:this.handleRemove,scope:this}),OpenLayers.Strategy.prototype.deactivate.apply(this,arguments)},handleAdd:function(e){if(!this.caching&&this.filter){var t=e.features;e.features=[];for(var i,s=0,n=t.length;n>s;++s)i=t[s],this.filter.evaluate(i)?e.features.push(i):this.cache.push(i)}},handleRemove:function(){this.caching||(this.cache=[])},setFilter:function(e){this.filter=e;var t=this.cache;if(this.cache=[],this.handleAdd({features:this.layer.features}),this.cache.length>0&&(this.caching=!0,this.layer.removeFeatures(this.cache.slice()),this.caching=!1),t.length>0){var i={features:t};this.handleAdd(i),i.features.length>0&&(this.caching=!0,this.layer.addFeatures(i.features),this.caching=!1)}},CLASS_NAME:"OpenLayers.Strategy.Filter"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.XLS=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.0",stringifyOutput:!0,CLASS_NAME:"OpenLayers.Format.XLS"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.XLS.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xls:"http://www.opengis.net/xls",gml:"http://www.opengis.net/gml",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},xy:!0,defaultPrefix:"xls",schemaLocation:null,read:function(e,t){t=OpenLayers.Util.applyDefaults(t,this.options);var i={};return this.readChildNodes(e,i),i},readers:{xls:{XLS:function(e,t){t.version=e.getAttribute("version"),this.readChildNodes(e,t)},Response:function(e,t){this.readChildNodes(e,t)},GeocodeResponse:function(e,t){t.responseLists=[],this.readChildNodes(e,t)},GeocodeResponseList:function(e,t){var i={features:[],numberOfGeocodedAddresses:parseInt(e.getAttribute("numberOfGeocodedAddresses"))};t.responseLists.push(i),this.readChildNodes(e,i)},GeocodedAddress:function(e,t){var i=new OpenLayers.Feature.Vector;t.features.push(i),this.readChildNodes(e,i),i.geometry=i.components[0]},GeocodeMatchCode:function(e,t){t.attributes.matchCode={accuracy:parseFloat(e.getAttribute("accuracy")),matchType:e.getAttribute("matchType")}},Address:function(e,t){var i={countryCode:e.getAttribute("countryCode"),addressee:e.getAttribute("addressee"),street:[],place:[]};t.attributes.address=i,this.readChildNodes(e,i)},freeFormAddress:function(e,t){t.freeFormAddress=this.getChildValue(e)},StreetAddress:function(e,t){this.readChildNodes(e,t)},Building:function(e,t){t.building={number:e.getAttribute("number"),subdivision:e.getAttribute("subdivision"),buildingName:e.getAttribute("buildingName")}},Street:function(e,t){t.street.push(this.getChildValue(e))},Place:function(e,t){t.place[e.getAttribute("type")]=this.getChildValue(e)},PostalCode:function(e,t){t.postalCode=this.getChildValue(e)}},gml:OpenLayers.Format.GML.v3.prototype.readers.gml},write:function(e){return this.writers.xls.XLS.apply(this,[e])},writers:{xls:{XLS:function(e){var t=this.createElementNSPlus("xls:XLS",{attributes:{version:this.VERSION,"xsi:schemaLocation":this.schemaLocation}});return this.writeNode("RequestHeader",e.header,t),this.writeNode("Request",e,t),t},RequestHeader:function(){return this.createElementNSPlus("xls:RequestHeader")},Request:function(e){var t=this.createElementNSPlus("xls:Request",{attributes:{methodName:"GeocodeRequest",requestID:e.requestID||"",version:this.VERSION}});return this.writeNode("GeocodeRequest",e.addresses,t),t},GeocodeRequest:function(e){for(var t=this.createElementNSPlus("xls:GeocodeRequest"),i=0,s=e.length;s>i;i++)this.writeNode("Address",e[i],t);return t},Address:function(e){var t=this.createElementNSPlus("xls:Address",{attributes:{countryCode:e.countryCode}});return e.freeFormAddress?this.writeNode("freeFormAddress",e.freeFormAddress,t):(e.street&&this.writeNode("StreetAddress",e,t),e.municipality&&this.writeNode("Municipality",e.municipality,t),e.countrySubdivision&&this.writeNode("CountrySubdivision",e.countrySubdivision,t),e.postalCode&&this.writeNode("PostalCode",e.postalCode,t)),t},freeFormAddress:function(e){return this.createElementNSPlus("freeFormAddress",{value:e})},StreetAddress:function(e){var t=this.createElementNSPlus("xls:StreetAddress");e.building&&this.writeNode(t,"Building",e.building);var i=e.street;OpenLayers.Util.isArray(i)||(i=[i]);for(var s=0,n=i.length;n>s;s++)this.writeNode("Street",i[s],t);return t},Building:function(e){return this.createElementNSPlus("xls:Building",{attributes:{number:e.number,subdivision:e.subdivision,buildingName:e.buildingName}})},Street:function(e){return this.createElementNSPlus("xls:Street",{value:e})},Municipality:function(e){return this.createElementNSPlus("xls:Place",{attributes:{type:"Municipality"},value:e})},CountrySubdivision:function(e){return this.createElementNSPlus("xls:Place",{attributes:{type:"CountrySubdivision"},value:e})},PostalCode:function(e){return this.createElementNSPlus("xls:PostalCode",{value:e})}}},CLASS_NAME:"OpenLayers.Format.XLS.v1"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.XLS.v1_1_0=OpenLayers.Class(OpenLayers.Format.XLS.v1,{VERSION:"1.1",schemaLocation:"http://www.opengis.net/xls http://schemas.opengis.net/ols/1.1.0/LocationUtilityService.xsd",CLASS_NAME:"OpenLayers.Format.XLS.v1_1_0"}),OpenLayers.Format.XLS.v1_1=OpenLayers.Format.XLS.v1_1_0,/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.Image=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!0,url:null,extent:null,size:null,tile:null,aspectRatio:null,initialize:function(e,t,i,s,n){this.url=t,this.extent=i,this.maxExtent=i,this.size=s,OpenLayers.Layer.prototype.initialize.apply(this,[e,n]),this.aspectRatio=this.extent.getHeight()/this.size.h/(this.extent.getWidth()/this.size.w)},destroy:function(){this.tile&&(this.removeTileMonitoringHooks(this.tile),this.tile.destroy(),this.tile=null),OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(e){return null==e&&(e=new OpenLayers.Layer.Image(this.name,this.url,this.extent,this.size,this.getOptions())),e=OpenLayers.Layer.prototype.clone.apply(this,[e])},setMap:function(){null==this.options.maxResolution&&(this.options.maxResolution=this.aspectRatio*this.extent.getWidth()/this.size.w),OpenLayers.Layer.prototype.setMap.apply(this,arguments)},moveTo:function(e,t){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var i=null==this.tile;if(t||i){this.setTileSize();var s=this.map.getLayerPxFromLonLat({lon:this.extent.left,lat:this.extent.top});i?(this.tile=new OpenLayers.Tile.Image(this,s,this.extent,null,this.tileSize),this.addTileMonitoringHooks(this.tile)):(this.tile.size=this.tileSize.clone(),this.tile.position=s.clone()),this.tile.draw()}},setTileSize:function(){var e=this.extent.getWidth()/this.map.getResolution(),t=this.extent.getHeight()/this.map.getResolution();this.tileSize=new OpenLayers.Size(e,t)},addTileMonitoringHooks:function(e){e.onLoadStart=function(){this.events.triggerEvent("loadstart")},e.events.register("loadstart",this,e.onLoadStart),e.onLoadEnd=function(){this.events.triggerEvent("loadend")},e.events.register("loadend",this,e.onLoadEnd),e.events.register("unload",this,e.onLoadEnd)},removeTileMonitoringHooks:function(e){e.unload(),e.events.un({loadstart:e.onLoadStart,loadend:e.onLoadEnd,unload:e.onLoadEnd,scope:this})},setUrl:function(e){this.url=e,this.tile.draw()},getURL:function(){return this.url},CLASS_NAME:"OpenLayers.Layer.Image"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Strategy.Save=OpenLayers.Class(OpenLayers.Strategy,{events:null,auto:!1,timer:null,initialize:function(e){OpenLayers.Strategy.prototype.initialize.apply(this,[e]),this.events=new OpenLayers.Events(this)},activate:function(){var e=OpenLayers.Strategy.prototype.activate.call(this);return e&&this.auto&&("number"==typeof this.auto?this.timer=window.setInterval(OpenLayers.Function.bind(this.save,this),1e3*this.auto):this.layer.events.on({featureadded:this.triggerSave,afterfeaturemodified:this.triggerSave,scope:this})),e},deactivate:function(){var e=OpenLayers.Strategy.prototype.deactivate.call(this);return e&&this.auto&&("number"==typeof this.auto?window.clearInterval(this.timer):this.layer.events.un({featureadded:this.triggerSave,afterfeaturemodified:this.triggerSave,scope:this})),e},triggerSave:function(e){var t=e.feature;(t.state===OpenLayers.State.INSERT||t.state===OpenLayers.State.UPDATE||t.state===OpenLayers.State.DELETE)&&this.save([e.feature])},save:function(e){e||(e=this.layer.features),this.events.triggerEvent("start",{features:e});var t=this.layer.projection,i=this.layer.map.getProjectionObject();if(!i.equals(t)){for(var s,n,r=e.length,a=new Array(r),o=0;r>o;++o)s=e[o],n=s.clone(),n.fid=s.fid,n.state=s.state,s.url&&(n.url=s.url),n._original=s,n.geometry.transform(i,t),a[o]=n;e=a}this.layer.protocol.commit(e,{callback:this.onCommit,scope:this})},onCommit:function(e){var t={response:e};if(e.success()){for(var i,s,n=e.reqFeatures,r=[],a=e.insertIds||[],o=0,l=0,h=n.length;h>l;++l)s=n[l],s=s._original||s,i=s.state,i&&(i==OpenLayers.State.DELETE?r.push(s):i==OpenLayers.State.INSERT&&(s.fid=a[o],++o),s.state=null);r.length>0&&this.layer.destroyFeatures(r),this.events.triggerEvent("success",t)}else this.events.triggerEvent("fail",t)},CLASS_NAME:"OpenLayers.Strategy.Save"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.GPX=OpenLayers.Class(OpenLayers.Format.XML,{defaultDesc:"No description available",extractWaypoints:!0,extractTracks:!0,extractRoutes:!0,extractAttributes:!0,namespaces:{gpx:"http://www.topografix.com/GPX/1/1",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",creator:"OpenLayers",initialize:function(e){this.externalProjection=new OpenLayers.Projection("EPSG:4326"),OpenLayers.Format.XML.prototype.initialize.apply(this,[e])},read:function(e){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e]));var t=[];if(this.extractTracks)for(var i=e.getElementsByTagName("trk"),s=0,n=i.length;n>s;s++){var r={};this.extractAttributes&&(r=this.parseAttributes(i[s]));for(var a=this.getElementsByTagNameNS(i[s],i[s].namespaceURI,"trkseg"),o=0,l=a.length;l>o;o++){var h=this.extractSegment(a[o],"trkpt");t.push(new OpenLayers.Feature.Vector(h,r))}}if(this.extractRoutes)for(var u=e.getElementsByTagName("rte"),c=0,d=u.length;d>c;c++){var r={};this.extractAttributes&&(r=this.parseAttributes(u[c]));var p=this.extractSegment(u[c],"rtept");t.push(new OpenLayers.Feature.Vector(p,r))}if(this.extractWaypoints)for(var f=e.getElementsByTagName("wpt"),m=0,n=f.length;n>m;m++){var r={};this.extractAttributes&&(r=this.parseAttributes(f[m]));var y=new OpenLayers.Geometry.Point(f[m].getAttribute("lon"),f[m].getAttribute("lat"));t.push(new OpenLayers.Feature.Vector(y,r))}if(this.internalProjection&&this.externalProjection)for(var g=0,v=t.length;v>g;g++)t[g].geometry.transform(this.externalProjection,this.internalProjection);return t},extractSegment:function(e,t){for(var i=this.getElementsByTagNameNS(e,e.namespaceURI,t),s=[],n=0,r=i.length;r>n;n++)s.push(new OpenLayers.Geometry.Point(i[n].getAttribute("lon"),i[n].getAttribute("lat")));return new OpenLayers.Geometry.LineString(s)},parseAttributes:function(e){for(var t,i,s={},n=e.firstChild;n;)1==n.nodeType&&n.firstChild&&(t=n.firstChild,(3==t.nodeType||4==t.nodeType)&&(i=n.prefix?n.nodeName.split(":")[1]:n.nodeName,"trkseg"!=i&&"rtept"!=i&&(s[i]=t.nodeValue))),n=n.nextSibling;return s},write:function(e,t){e=OpenLayers.Util.isArray(e)?e:[e];var i=this.createElementNS(this.namespaces.gpx,"gpx");i.setAttribute("version","1.1"),i.setAttribute("creator",this.creator),this.setAttributes(i,{"xsi:schemaLocation":this.schemaLocation}),t&&"object"==typeof t&&i.appendChild(this.buildMetadataNode(t));for(var s=0,n=e.length;n>s;s++)i.appendChild(this.buildFeatureNode(e[s]));return OpenLayers.Format.XML.prototype.write.apply(this,[i])},buildMetadataNode:function(e){for(var t=["name","desc","author"],i=this.createElementNSPlus("gpx:metadata"),s=0;s<t.length;s++){var n=t[s];if(e[n]){var r=this.createElementNSPlus("gpx:"+n);r.appendChild(this.createTextNode(e[n])),i.appendChild(r)}}return i},buildFeatureNode:function(e){var t=e.geometry;if(t=t.clone(),this.internalProjection&&this.externalProjection&&t.transform(this.internalProjection,this.externalProjection),"OpenLayers.Geometry.Point"==t.CLASS_NAME){var i=this.buildWptNode(t);return this.appendAttributesNode(i,e),i}var s=this.createElementNSPlus("gpx:trk");this.appendAttributesNode(s,e);var n=this.buildTrkSegNode(t);n=OpenLayers.Util.isArray(n)?n:[n];for(var r=0,a=n.length;a>r;r++)s.appendChild(n[r]);return s},buildTrkSegNode:function(e){var t,i,s,n,r;if("OpenLayers.Geometry.LineString"==e.CLASS_NAME||"OpenLayers.Geometry.LinearRing"==e.CLASS_NAME){for(t=this.createElementNSPlus("gpx:trkseg"),i=0,s=e.components.length;s>i;i++)n=e.components[i],t.appendChild(this.buildTrkPtNode(n));return t}for(r=[],i=0,s=e.components.length;s>i;i++)r.push(this.buildTrkSegNode(e.components[i]));return r},buildTrkPtNode:function(e){var t=this.createElementNSPlus("gpx:trkpt");return t.setAttribute("lon",e.x),t.setAttribute("lat",e.y),t},buildWptNode:function(e){var t=this.createElementNSPlus("gpx:wpt");return t.setAttribute("lon",e.x),t.setAttribute("lat",e.y),t},appendAttributesNode:function(e,t){var i=this.createElementNSPlus("gpx:name");i.appendChild(this.createTextNode(t.attributes.name||t.id)),e.appendChild(i);var s=this.createElementNSPlus("gpx:desc");s.appendChild(this.createTextNode(t.attributes.description||this.defaultDesc)),e.appendChild(s)},CLASS_NAME:"OpenLayers.Format.GPX"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WMSDescribeLayer=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.1",getVersion:function(){var e=OpenLayers.Format.XML.VersionedOGC.prototype.getVersion.apply(this,arguments);return("1.1.1"==e||"1.1.0"==e)&&(e="1.1"),e},CLASS_NAME:"OpenLayers.Format.WMSDescribeLayer"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.Panel=OpenLayers.Class(OpenLayers.Control,{controls:null,autoActivate:!0,defaultControl:null,saveState:!1,allowDepress:!1,activeState:null,initialize:function(e){OpenLayers.Control.prototype.initialize.apply(this,[e]),this.controls=[],this.activeState={}},destroy:function(){this.map&&this.map.events.unregister("buttonclick",this,this.onButtonClick),OpenLayers.Control.prototype.destroy.apply(this,arguments);for(var e,t=this.controls.length-1;t>=0;t--)e=this.controls[t],e.events&&e.events.un({activate:this.iconOn,deactivate:this.iconOff}),e.panel_div=null;this.activeState=null},activate:function(){if(OpenLayers.Control.prototype.activate.apply(this,arguments)){for(var e,t=0,i=this.controls.length;i>t;t++)e=this.controls[t],(e===this.defaultControl||this.saveState&&this.activeState[e.id])&&e.activate();return this.saveState===!0&&(this.defaultControl=null),this.redraw(),!0}return!1},deactivate:function(){if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){for(var e,t=0,i=this.controls.length;i>t;t++)e=this.controls[t],this.activeState[e.id]=e.deactivate();return this.redraw(),!0}return!1},draw:function(){return OpenLayers.Control.prototype.draw.apply(this,arguments),this.outsideViewport?(this.events.attachToElement(this.div),this.events.register("buttonclick",this,this.onButtonClick)):this.map.events.register("buttonclick",this,this.onButtonClick),this.addControlsToMap(this.controls),this.div},redraw:function(){for(var e=this.div.childNodes.length,t=e-1;t>=0;t--)this.div.removeChild(this.div.childNodes[t]);if(this.div.innerHTML="",this.active)for(var t=0,i=this.controls.length;i>t;t++)this.div.appendChild(this.controls[t].panel_div)},activateControl:function(e){if(!this.active)return!1;if(e.type==OpenLayers.Control.TYPE_BUTTON)return e.trigger(),void 0;if(e.type==OpenLayers.Control.TYPE_TOGGLE)return e.active?e.deactivate():e.activate(),void 0;if(this.allowDepress&&e.active)e.deactivate();else{for(var t,i=0,s=this.controls.length;s>i;i++)t=this.controls[i],t==e||t.type!==OpenLayers.Control.TYPE_TOOL&&null!=t.type||t.deactivate();e.activate()}},addControls:function(e){OpenLayers.Util.isArray(e)||(e=[e]),this.controls=this.controls.concat(e);for(var t=0,i=e.length;i>t;t++){var s=e[t],n=this.createControlMarkup(s);OpenLayers.Element.addClass(n,s.displayClass+"ItemInactive"),OpenLayers.Element.addClass(n,"olButton"),""==s.title||n.title||(n.title=s.title),s.panel_div=n}this.map&&(this.addControlsToMap(e),this.redraw())},createControlMarkup:function(){return document.createElement("div")},addControlsToMap:function(e){for(var t,i=0,s=e.length;s>i;i++)t=e[i],t.autoActivate===!0?(t.autoActivate=!1,this.map.addControl(t),t.autoActivate=!0):(this.map.addControl(t),t.deactivate()),t.events.on({activate:this.iconOn,deactivate:this.iconOff})},iconOn:function(){var e=this.panel_div,t=new RegExp("\\b("+this.displayClass+"Item)Inactive\\b");e.className=e.className.replace(t,"$1Active")},iconOff:function(){var e=this.panel_div,t=new RegExp("\\b("+this.displayClass+"Item)Active\\b");e.className=e.className.replace(t,"$1Inactive")},onButtonClick:function(e){for(var t=this.controls,i=e.buttonElement,s=t.length-1;s>=0;--s)if(t[s].panel_div===i){this.activateControl(t[s]);break}},getControlsBy:function(e,t){var i="function"==typeof t.test,s=OpenLayers.Array.filter(this.controls,function(s){return s[e]==t||i&&t.test(s[e])});return s},getControlsByName:function(e){return this.getControlsBy("name",e)},getControlsByClass:function(e){return this.getControlsBy("CLASS_NAME",e)},CLASS_NAME:"OpenLayers.Control.Panel"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.ZoomIn=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){this.map.zoomIn()},CLASS_NAME:"OpenLayers.Control.ZoomIn"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.ZoomOut=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){this.map.zoomOut()},CLASS_NAME:"OpenLayers.Control.ZoomOut"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.ZoomToMaxExtent=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){this.map&&this.map.zoomToMaxExtent()},CLASS_NAME:"OpenLayers.Control.ZoomToMaxExtent"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.ZoomPanel=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(e){OpenLayers.Control.Panel.prototype.initialize.apply(this,[e]),this.addControls([new OpenLayers.Control.ZoomIn,new OpenLayers.Control.ZoomToMaxExtent,new OpenLayers.Control.ZoomOut])},CLASS_NAME:"OpenLayers.Control.ZoomPanel"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.XYZ=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,sphericalMercator:!1,zoomOffset:0,serverResolutions:null,initialize:function(e,t,i){(i&&i.sphericalMercator||this.sphericalMercator)&&(i=OpenLayers.Util.extend({projection:"EPSG:900913",numZoomLevels:19},i)),OpenLayers.Layer.Grid.prototype.initialize.apply(this,[e||this.name,t||this.url,{},i])},clone:function(e){return null==e&&(e=new OpenLayers.Layer.XYZ(this.name,this.url,this.getOptions())),e=OpenLayers.Layer.Grid.prototype.clone.apply(this,[e])},getURL:function(e){var t=this.getXYZ(e),i=this.url;if(OpenLayers.Util.isArray(i)){var s=""+t.x+t.y+t.z;i=this.selectUrl(s,i)}return OpenLayers.String.format(i,t)},getXYZ:function(e){var t=this.getServerResolution(),i=Math.round((e.left-this.maxExtent.left)/(t*this.tileSize.w)),s=Math.round((this.maxExtent.top-e.top)/(t*this.tileSize.h)),n=this.getServerZoom();if(this.wrapDateLine){var r=Math.pow(2,n);i=(i%r+r)%r}return{x:i,y:s,z:n}},setMap:function(){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments),this.tileOrigin||(this.tileOrigin=new OpenLayers.LonLat(this.maxExtent.left,this.maxExtent.bottom))},CLASS_NAME:"OpenLayers.Layer.XYZ"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.OSM=OpenLayers.Class(OpenLayers.Layer.XYZ,{name:"OpenStreetMap",url:["http://a.tile.openstreetmap.org/${z}/${x}/${y}.png","http://b.tile.openstreetmap.org/${z}/${x}/${y}.png","http://c.tile.openstreetmap.org/${z}/${x}/${y}.png"],attribution:"Data CC-By-SA by <a href='http://openstreetmap.org/'>OpenStreetMap</a>",sphericalMercator:!0,wrapDateLine:!0,tileOptions:null,initialize:function(){OpenLayers.Layer.XYZ.prototype.initialize.apply(this,arguments),this.tileOptions=OpenLayers.Util.extend({crossOriginKeyword:"anonymous"},this.options&&this.options.tileOptions)},clone:function(e){return null==e&&(e=new OpenLayers.Layer.OSM(this.name,this.url,this.getOptions())),e=OpenLayers.Layer.XYZ.prototype.clone.apply(this,[e])},CLASS_NAME:"OpenLayers.Layer.OSM"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Renderer=OpenLayers.Class({container:null,root:null,extent:null,locked:!1,size:null,resolution:null,map:null,featureDx:0,initialize:function(e,t){this.container=OpenLayers.Util.getElement(e),OpenLayers.Util.extend(this,t)},destroy:function(){this.container=null,this.extent=null,this.size=null,this.resolution=null,this.map=null},supported:function(){return!1},setExtent:function(e,t){if(this.extent=e.clone(),this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var i=e.getWidth()/this.map.getExtent().getWidth(),e=e.scale(1/i);this.extent=e.wrapDateLine(this.map.getMaxExtent()).scale(i)}return t&&(this.resolution=null),!0},setSize:function(e){this.size=e.clone(),this.resolution=null},getResolution:function(){return this.resolution=this.resolution||this.map.getResolution(),this.resolution},drawFeature:function(e,t){if(null==t&&(t=e.style),e.geometry){var i=e.geometry.getBounds();if(i){var s;this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&(s=this.map.getMaxExtent()),i.intersectsBounds(this.extent,{worldBounds:s})?this.calculateFeatureDx(i,s):t={display:"none"};var n=this.drawGeometry(e.geometry,t,e.id);if("none"!=t.display&&t.label&&n!==!1){var r=e.geometry.getCentroid();if(t.labelXOffset||t.labelYOffset){var a=isNaN(t.labelXOffset)?0:t.labelXOffset,o=isNaN(t.labelYOffset)?0:t.labelYOffset,l=this.getResolution();r.move(a*l,o*l)}this.drawText(e.id,t,r)}else this.removeText(e.id);return n}}},calculateFeatureDx:function(e,t){if(this.featureDx=0,t){var i=t.getWidth(),s=(this.extent.left+this.extent.right)/2,n=(e.left+e.right)/2,r=Math.round((n-s)/i);this.featureDx=r*i}},drawGeometry:function(){},drawText:function(){},removeText:function(){},clear:function(){},getFeatureIdFromEvent:function(){},eraseFeatures:function(e){OpenLayers.Util.isArray(e)||(e=[e]);for(var t=0,i=e.length;i>t;++t){var s=e[t];this.eraseGeometry(s.geometry,s.id),this.removeText(s.id)}},eraseGeometry:function(){},moveRoot:function(){},getRenderLayerId:function(){return this.container.id},applyDefaultSymbolizer:function(e){var t=OpenLayers.Util.extend({},OpenLayers.Renderer.defaultSymbolizer);return e.stroke===!1&&(delete t.strokeWidth,delete t.strokeColor),e.fill===!1&&delete t.fillColor,OpenLayers.Util.extend(t,e),t},CLASS_NAME:"OpenLayers.Renderer"}),OpenLayers.Renderer.defaultSymbolizer={fillColor:"#000000",strokeColor:"#000000",strokeWidth:2,fillOpacity:1,strokeOpacity:1,pointRadius:0,labelAlign:"cm"},OpenLayers.Renderer.symbol={star:[350,75,379,161,469,161,397,215,423,301,350,250,277,301,303,215,231,161,321,161,350,75],cross:[4,0,6,0,6,4,10,4,10,6,6,6,6,10,4,10,4,6,0,6,0,4,4,4,4,0],x:[0,0,25,0,50,35,75,0,100,0,65,50,100,100,75,100,50,65,25,100,0,100,35,50,0,0],square:[0,0,0,1,1,1,1,0,0,0],triangle:[0,10,10,10,5,0,0,10]},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Renderer.Canvas=OpenLayers.Class(OpenLayers.Renderer,{hitDetection:!0,hitOverflow:0,canvas:null,features:null,pendingRedraw:!1,cachedSymbolBounds:{},initialize:function(){OpenLayers.Renderer.prototype.initialize.apply(this,arguments),this.root=document.createElement("canvas"),this.container.appendChild(this.root),this.canvas=this.root.getContext("2d"),this.features={},this.hitDetection&&(this.hitCanvas=document.createElement("canvas"),this.hitContext=this.hitCanvas.getContext("2d"))},setExtent:function(){return OpenLayers.Renderer.prototype.setExtent.apply(this,arguments),!1},eraseGeometry:function(e,t){this.eraseFeatures(this.features[t][0])},supported:function(){return OpenLayers.CANVAS_SUPPORTED},setSize:function(e){this.size=e.clone();var t=this.root;if(t.style.width=e.w+"px",t.style.height=e.h+"px",t.width=e.w,t.height=e.h,this.resolution=null,this.hitDetection){var i=this.hitCanvas;i.style.width=e.w+"px",i.style.height=e.h+"px",i.width=e.w,i.height=e.h}},drawFeature:function(e,t){var i;if(e.geometry){t=this.applyDefaultSymbolizer(t||e.style);var s,n=e.geometry.getBounds();this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&(s=this.map.getMaxExtent());var r=n&&n.intersectsBounds(this.extent,{worldBounds:s});i="none"!==t.display&&!!n&&r,i?this.features[e.id]=[e,t]:delete this.features[e.id],this.pendingRedraw=!0}return this.pendingRedraw&&!this.locked&&(this.redraw(),this.pendingRedraw=!1),i},drawGeometry:function(e,t,i){var s=e.CLASS_NAME;if("OpenLayers.Geometry.Collection"!=s&&"OpenLayers.Geometry.MultiPoint"!=s&&"OpenLayers.Geometry.MultiLineString"!=s&&"OpenLayers.Geometry.MultiPolygon"!=s)switch(e.CLASS_NAME){case"OpenLayers.Geometry.Point":this.drawPoint(e,t,i);break;case"OpenLayers.Geometry.LineString":this.drawLineString(e,t,i);break;case"OpenLayers.Geometry.LinearRing":this.drawLinearRing(e,t,i);break;case"OpenLayers.Geometry.Polygon":this.drawPolygon(e,t,i)}else for(var n=0;n<e.components.length;n++)this.drawGeometry(e.components[n],t,i)},drawExternalGraphic:function(e,t,i){var s=new Image;t.graphicTitle&&(s.title=t.graphicTitle);var n=t.graphicWidth||t.graphicHeight,r=t.graphicHeight||t.graphicWidth;n=n?n:2*t.pointRadius,r=r?r:2*t.pointRadius;var a=void 0!=t.graphicXOffset?t.graphicXOffset:-(.5*n),o=void 0!=t.graphicYOffset?t.graphicYOffset:-(.5*r),l=t.graphicOpacity||t.fillOpacity,h=function(){if(this.features[i]){var t=this.getLocalXY(e),h=t[0],u=t[1];if(!isNaN(h)&&!isNaN(u)){var c=0|h+a,d=0|u+o,p=this.canvas;p.globalAlpha=l;var f=OpenLayers.Renderer.Canvas.drawImageScaleFactor||(OpenLayers.Renderer.Canvas.drawImageScaleFactor=/android 2.1/.test(navigator.userAgent.toLowerCase())?320/window.screen.width:1);p.drawImage(s,c*f,d*f,n*f,r*f),this.hitDetection&&(this.setHitContextStyle("fill",i),this.hitContext.fillRect(c,d,n,r))}}};s.onload=OpenLayers.Function.bind(h,this),s.src=t.externalGraphic},drawNamedSymbol:function(e,t,i){var s,n,r,a,o,l,h,u,c,d=Math.PI/180,p=OpenLayers.Renderer.symbol[t.graphicName];if(!p)throw new Error(t.graphicName+" is not a valid symbol name");if(p.length&&!(p.length<2)){var f=this.getLocalXY(e),m=f[0],y=f[1];if(!isNaN(m)&&!isNaN(y)){if(this.canvas.lineCap="round",this.canvas.lineJoin="round",this.hitDetection&&(this.hitContext.lineCap="round",this.hitContext.lineJoin="round"),t.graphicName in this.cachedSymbolBounds)l=this.cachedSymbolBounds[t.graphicName];else{for(l=new OpenLayers.Bounds,o=0;o<p.length;o+=2)l.extend(new OpenLayers.LonLat(p[o],p[o+1]));this.cachedSymbolBounds[t.graphicName]=l}if(this.canvas.save(),this.hitDetection&&this.hitContext.save(),this.canvas.translate(m,y),this.hitDetection&&this.hitContext.translate(m,y),u=d*t.rotation,isNaN(u)||(this.canvas.rotate(u),this.hitDetection&&this.hitContext.rotate(u)),h=2*t.pointRadius/Math.max(l.getWidth(),l.getHeight()),this.canvas.scale(h,h),this.hitDetection&&this.hitContext.scale(h,h),r=l.getCenterLonLat().lon,a=l.getCenterLonLat().lat,this.canvas.translate(-r,-a),this.hitDetection&&this.hitContext.translate(-r,-a),c=t.strokeWidth,t.strokeWidth=c/h,t.fill!==!1){for(this.setCanvasStyle("fill",t),this.canvas.beginPath(),o=0;o<p.length;o+=2)s=p[o],n=p[o+1],0==o&&this.canvas.moveTo(s,n),this.canvas.lineTo(s,n);if(this.canvas.closePath(),this.canvas.fill(),this.hitDetection){for(this.setHitContextStyle("fill",i,t),this.hitContext.beginPath(),o=0;o<p.length;o+=2)s=p[o],n=p[o+1],0==o&&this.canvas.moveTo(s,n),this.hitContext.lineTo(s,n);this.hitContext.closePath(),this.hitContext.fill()}}if(t.stroke!==!1){for(this.setCanvasStyle("stroke",t),this.canvas.beginPath(),o=0;o<p.length;o+=2)s=p[o],n=p[o+1],0==o&&this.canvas.moveTo(s,n),this.canvas.lineTo(s,n);if(this.canvas.closePath(),this.canvas.stroke(),this.hitDetection){for(this.setHitContextStyle("stroke",i,t,h),this.hitContext.beginPath(),o=0;o<p.length;o+=2)s=p[o],n=p[o+1],0==o&&this.hitContext.moveTo(s,n),this.hitContext.lineTo(s,n);this.hitContext.closePath(),this.hitContext.stroke()}}t.strokeWidth=c,this.canvas.restore(),this.hitDetection&&this.hitContext.restore(),this.setCanvasStyle("reset")}}},setCanvasStyle:function(e,t){"fill"===e?(this.canvas.globalAlpha=t.fillOpacity,this.canvas.fillStyle=t.fillColor):"stroke"===e?(this.canvas.globalAlpha=t.strokeOpacity,this.canvas.strokeStyle=t.strokeColor,this.canvas.lineWidth=t.strokeWidth):(this.canvas.globalAlpha=0,this.canvas.lineWidth=1)},featureIdToHex:function(e){var t=Number(e.split("_").pop())+1;t>=16777216&&(this.hitOverflow=t-16777215,t=t%16777216+1);var i="000000"+t.toString(16),s=i.length;return i="#"+i.substring(s-6,s)},setHitContextStyle:function(e,t,i,s){var n=this.featureIdToHex(t);"fill"==e?(this.hitContext.globalAlpha=1,this.hitContext.fillStyle=n):"stroke"==e?(this.hitContext.globalAlpha=1,this.hitContext.strokeStyle=n,"undefined"==typeof s?this.hitContext.lineWidth=i.strokeWidth+2:isNaN(s)||(this.hitContext.lineWidth=i.strokeWidth+2/s)):(this.hitContext.globalAlpha=0,this.hitContext.lineWidth=1)},drawPoint:function(e,t,i){if(t.graphic!==!1)if(t.externalGraphic)this.drawExternalGraphic(e,t,i);else if(t.graphicName&&"circle"!=t.graphicName)this.drawNamedSymbol(e,t,i);else{var s=this.getLocalXY(e),n=s[0],r=s[1];if(!isNaN(n)&&!isNaN(r)){var a=2*Math.PI,o=t.pointRadius;t.fill!==!1&&(this.setCanvasStyle("fill",t),this.canvas.beginPath(),this.canvas.arc(n,r,o,0,a,!0),this.canvas.fill(),this.hitDetection&&(this.setHitContextStyle("fill",i,t),this.hitContext.beginPath(),this.hitContext.arc(n,r,o,0,a,!0),this.hitContext.fill())),t.stroke!==!1&&(this.setCanvasStyle("stroke",t),this.canvas.beginPath(),this.canvas.arc(n,r,o,0,a,!0),this.canvas.stroke(),this.hitDetection&&(this.setHitContextStyle("stroke",i,t),this.hitContext.beginPath(),this.hitContext.arc(n,r,o,0,a,!0),this.hitContext.stroke()),this.setCanvasStyle("reset"))}}},drawLineString:function(e,t,i){t=OpenLayers.Util.applyDefaults({fill:!1},t),this.drawLinearRing(e,t,i)},drawLinearRing:function(e,t,i){t.fill!==!1&&(this.setCanvasStyle("fill",t),this.renderPath(this.canvas,e,t,i,"fill"),this.hitDetection&&(this.setHitContextStyle("fill",i,t),this.renderPath(this.hitContext,e,t,i,"fill"))),t.stroke!==!1&&(this.setCanvasStyle("stroke",t),this.renderPath(this.canvas,e,t,i,"stroke"),this.hitDetection&&(this.setHitContextStyle("stroke",i,t),this.renderPath(this.hitContext,e,t,i,"stroke"))),this.setCanvasStyle("reset")},renderPath:function(e,t,i,s,n){var r=t.components,a=r.length;e.beginPath();var o=this.getLocalXY(r[0]),l=o[0],h=o[1];if(!isNaN(l)&&!isNaN(h)){e.moveTo(o[0],o[1]);for(var u=1;a>u;++u){var c=this.getLocalXY(r[u]);e.lineTo(c[0],c[1])}"fill"===n?e.fill():e.stroke()}},drawPolygon:function(e,t,i){var s=e.components,n=s.length;this.drawLinearRing(s[0],t,i);for(var r=1;n>r;++r)this.canvas.globalCompositeOperation="destination-out",this.hitDetection&&(this.hitContext.globalCompositeOperation="destination-out"),this.drawLinearRing(s[r],OpenLayers.Util.applyDefaults({stroke:!1,fillOpacity:1},t),i),this.canvas.globalCompositeOperation="source-over",this.hitDetection&&(this.hitContext.globalCompositeOperation="source-over"),this.drawLinearRing(s[r],OpenLayers.Util.applyDefaults({fill:!1},t),i)},drawText:function(e,t){var i=this.getLocalXY(e);this.setCanvasStyle("reset"),this.canvas.fillStyle=t.fontColor,this.canvas.globalAlpha=t.fontOpacity||1;var s=[t.fontStyle?t.fontStyle:"normal","normal",t.fontWeight?t.fontWeight:"normal",t.fontSize?t.fontSize:"1em",t.fontFamily?t.fontFamily:"sans-serif"].join(" "),n=t.label.split("\n"),r=n.length;if(this.canvas.fillText){this.canvas.font=s,this.canvas.textAlign=OpenLayers.Renderer.Canvas.LABEL_ALIGN[t.labelAlign[0]]||"center",this.canvas.textBaseline=OpenLayers.Renderer.Canvas.LABEL_ALIGN[t.labelAlign[1]]||"middle";var a=OpenLayers.Renderer.Canvas.LABEL_FACTOR[t.labelAlign[1]];null==a&&(a=-.5);var o=this.canvas.measureText("Mg").height||this.canvas.measureText("xx").width;i[1]+=o*a*(r-1);for(var l=0;r>l;l++)t.labelOutlineWidth&&(this.canvas.save(),this.canvas.strokeStyle=t.labelOutlineColor,this.canvas.lineWidth=t.labelOutlineWidth,this.canvas.strokeText(n[l],i[0],i[1]+o*l+1),this.canvas.restore()),this.canvas.fillText(n[l],i[0],i[1]+o*l)}else if(this.canvas.mozDrawText){this.canvas.mozTextStyle=s;var h=OpenLayers.Renderer.Canvas.LABEL_FACTOR[t.labelAlign[0]];null==h&&(h=-.5);var a=OpenLayers.Renderer.Canvas.LABEL_FACTOR[t.labelAlign[1]];null==a&&(a=-.5);var o=this.canvas.mozMeasureText("xx");i[1]+=o*(1+a*r);for(var l=0;r>l;l++){var u=i[0]+h*this.canvas.mozMeasureText(n[l]),c=i[1]+l*o;this.canvas.translate(u,c),this.canvas.mozDrawText(n[l]),this.canvas.translate(-u,-c)}}this.setCanvasStyle("reset")},getLocalXY:function(e){var t=this.getResolution(),i=this.extent,s=(e.x-this.featureDx)/t+-i.left/t,n=i.top/t-e.y/t;return[s,n]},clear:function(){var e=this.root.height,t=this.root.width;this.canvas.clearRect(0,0,t,e),this.features={},this.hitDetection&&this.hitContext.clearRect(0,0,t,e)},getFeatureIdFromEvent:function(e){var t,i;if(this.hitDetection&&"none"!==this.root.style.display&&!this.map.dragging){var s=e.xy,n=0|s.x,r=0|s.y,a=this.hitContext.getImageData(n,r,1,1).data;if(255===a[3]){var o=a[2]+256*(a[1]+256*a[0]);if(o){t="OpenLayers.Feature.Vector_"+(o-1+this.hitOverflow);try{i=this.features[t][0]}catch(l){}}}}return i},eraseFeatures:function(e){OpenLayers.Util.isArray(e)||(e=[e]);for(var t=0;t<e.length;++t)delete this.features[e[t].id];this.redraw()},redraw:function(){if(!this.locked){var e=this.root.height,t=this.root.width;this.canvas.clearRect(0,0,t,e),this.hitDetection&&this.hitContext.clearRect(0,0,t,e);var i,s,n,r=[],a=this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&this.map.getMaxExtent();for(var o in this.features)this.features.hasOwnProperty(o)&&(i=this.features[o][0],s=i.geometry,this.calculateFeatureDx(s.getBounds(),a),n=this.features[o][1],this.drawGeometry(s,n,i.id),n.label&&r.push([i,n]));for(var l,h=0,u=r.length;u>h;++h)l=r[h],this.drawText(l[0].geometry.getCentroid(),l[1])}},CLASS_NAME:"OpenLayers.Renderer.Canvas"}),OpenLayers.Renderer.Canvas.LABEL_ALIGN={l:"left",r:"right",t:"top",b:"bottom"},OpenLayers.Renderer.Canvas.LABEL_FACTOR={l:0,r:-1,t:0,b:-1},OpenLayers.Renderer.Canvas.drawImageScaleFactor=null,/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.OSM=OpenLayers.Class(OpenLayers.Format.XML,{checkTags:!1,interestingTagsExclude:null,areaTags:null,initialize:function(e){var t={interestingTagsExclude:["source","source_ref","source:ref","history","attribution","created_by"],areaTags:["area","building","leisure","tourism","ruins","historic","landuse","military","natural","sport"]};t=OpenLayers.Util.extend(t,e);for(var i={},s=0;s<t.interestingTagsExclude.length;s++)i[t.interestingTagsExclude[s]]=!0;t.interestingTagsExclude=i;for(var n={},s=0;s<t.areaTags.length;s++)n[t.areaTags[s]]=!0;t.areaTags=n,this.externalProjection=new OpenLayers.Projection("EPSG:4326"),OpenLayers.Format.XML.prototype.initialize.apply(this,[t])},read:function(e){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e]));for(var t=this.getNodes(e),i=this.getWays(e),s=new Array(i.length),n=0;n<i.length;n++){for(var r=new Array(i[n].nodes.length),a=this.isWayArea(i[n])?1:0,o=0;o<i[n].nodes.length;o++){var l=t[i[n].nodes[o]],h=new OpenLayers.Geometry.Point(l.lon,l.lat);h.osm_id=parseInt(i[n].nodes[o]),r[o]=h,l.used=!0}var u=null;u=a?new OpenLayers.Geometry.Polygon(new OpenLayers.Geometry.LinearRing(r)):new OpenLayers.Geometry.LineString(r),this.internalProjection&&this.externalProjection&&u.transform(this.externalProjection,this.internalProjection);var c=new OpenLayers.Feature.Vector(u,i[n].tags);c.osm_id=parseInt(i[n].id),c.fid="way."+c.osm_id,s[n]=c}for(var d in t){var l=t[d];if(!l.used||this.checkTags){var p=null;if(this.checkTags){var f=this.getTags(l.node,!0);if(l.used&&!f[1])continue;p=f[0]}else p=this.getTags(l.node);var c=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(l.lon,l.lat),p);this.internalProjection&&this.externalProjection&&c.geometry.transform(this.externalProjection,this.internalProjection),c.osm_id=parseInt(d),c.fid="node."+c.osm_id,s.push(c)}l.node=null}return s},getNodes:function(e){for(var t=e.getElementsByTagName("node"),i={},s=0;s<t.length;s++){var n=t[s],r=n.getAttribute("id");i[r]={lat:n.getAttribute("lat"),lon:n.getAttribute("lon"),node:n}}return i},getWays:function(e){for(var t=e.getElementsByTagName("way"),i=[],s=0;s<t.length;s++){var n=t[s],r={id:n.getAttribute("id")};r.tags=this.getTags(n);var a=n.getElementsByTagName("nd");r.nodes=new Array(a.length);for(var o=0;o<a.length;o++)r.nodes[o]=a[o].getAttribute("ref");i.push(r)}return i},getTags:function(e,t){for(var i=e.getElementsByTagName("tag"),s={},n=!1,r=0;r<i.length;r++){var a=i[r].getAttribute("k");s[a]=i[r].getAttribute("v"),t&&(this.interestingTagsExclude[a]||(n=!0))}return t?[s,n]:s},isWayArea:function(e){var t=!1,i=!1;if(e.nodes[0]==e.nodes[e.nodes.length-1]&&(t=!0),this.checkTags)for(var s in e.tags)if(this.areaTags[s]){i=!0;break}return t&&(this.checkTags?i:!0)},write:function(e){OpenLayers.Util.isArray(e)||(e=[e]),this.osm_id=1,this.created_nodes={};var t=this.createElementNS(null,"osm");t.setAttribute("version","0.5"),t.setAttribute("generator","OpenLayers "+OpenLayers.VERSION_NUMBER);for(var i=e.length-1;i>=0;i--)for(var s=this.createFeatureNodes(e[i]),n=0;n<s.length;n++)t.appendChild(s[n]);return OpenLayers.Format.XML.prototype.write.apply(this,[t])},createFeatureNodes:function(e){var t=[],i=e.geometry.CLASS_NAME,s=i.substring(i.lastIndexOf(".")+1);s=s.toLowerCase();var n=this.createXML[s];return n&&(t=n.apply(this,[e])),t},createXML:{point:function(e){var t=null,i=e.geometry?e.geometry:e;this.internalProjection&&this.externalProjection&&(i=i.clone(),i.transform(this.internalProjection,this.externalProjection));var s=!1;if(e.osm_id?(t=e.osm_id,this.created_nodes[t]&&(s=!0)):(t=-this.osm_id,this.osm_id++),s)n=this.created_nodes[t];else var n=this.createElementNS(null,"node");return this.created_nodes[t]=n,n.setAttribute("id",t),n.setAttribute("lon",i.x),n.setAttribute("lat",i.y),e.attributes&&this.serializeTags(e,n),this.setState(e,n),s?[]:[n]},linestring:function(e){var t,i=[],s=e.geometry;e.osm_id?t=e.osm_id:(t=-this.osm_id,this.osm_id++);var n=this.createElementNS(null,"way");n.setAttribute("id",t);for(var r=0;r<s.components.length;r++){var a=this.createXML.point.apply(this,[s.components[r]]);if(a.length){a=a[0];var o=a.getAttribute("id");i.push(a)}else o=s.components[r].osm_id,a=this.created_nodes[o];this.setState(e,a);var l=this.createElementNS(null,"nd");l.setAttribute("ref",o),n.appendChild(l)}return this.serializeTags(e,n),i.push(n),i},polygon:function(e){var t=OpenLayers.Util.extend({area:"yes"},e.attributes),i=new OpenLayers.Feature.Vector(e.geometry.components[0],t);return i.osm_id=e.osm_id,this.createXML.linestring.apply(this,[i])}},serializeTags:function(e,t){for(var i in e.attributes){var s=this.createElementNS(null,"tag");s.setAttribute("k",i),s.setAttribute("v",e.attributes[i]),t.appendChild(s)}},setState:function(e,t){if(e.state){var i=null;switch(e.state){case OpenLayers.State.UPDATE:i="modify";case OpenLayers.State.DELETE:i="delete"}i&&t.setAttribute("action",i)}},CLASS_NAME:"OpenLayers.Format.OSM"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.Bing=OpenLayers.Class(OpenLayers.Layer.XYZ,{key:null,serverResolutions:[156543.03390625,78271.516953125,39135.7584765625,19567.87923828125,9783.939619140625,4891.9698095703125,2445.9849047851562,1222.9924523925781,611.4962261962891,305.74811309814453,152.87405654907226,76.43702827453613,38.218514137268066,19.109257068634033,9.554628534317017,4.777314267158508,2.388657133579254,1.194328566789627,.5971642833948135,.29858214169740677,.14929107084870338,.07464553542435169],attributionTemplate:'<span class="olBingAttribution ${type}"><div><a target="_blank" href="http://www.bing.com/maps/"><img src="${logo}" /></a></div>${copyrights}<a style="white-space: nowrap" target="_blank" href="http://www.microsoft.com/maps/product/terms.html">Terms of Use</a></span>',metadata:null,type:"Road",culture:"en-US",metadataParams:null,tileOptions:null,initialize:function(e){e=OpenLayers.Util.applyDefaults({sphericalMercator:!0},e);var t=e.name||"Bing "+(e.type||this.type),i=[t,null,e];OpenLayers.Layer.XYZ.prototype.initialize.apply(this,i),this.tileOptions=OpenLayers.Util.extend({crossOriginKeyword:"anonymous"},this.options.tileOptions),this.loadMetadata()},loadMetadata:function(){this._callbackId="_callback_"+this.id.replace(/\./g,"_"),window[this._callbackId]=OpenLayers.Function.bind(OpenLayers.Layer.Bing.processMetadata,this);var e=OpenLayers.Util.applyDefaults({key:this.key,jsonp:this._callbackId,include:"ImageryProviders"},this.metadataParams),t="http://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.type+"?"+OpenLayers.Util.getParameterString(e),i=document.createElement("script");i.type="text/javascript",i.src=t,i.id=this._callbackId,document.getElementsByTagName("head")[0].appendChild(i)},initLayer:function(){var e=this.metadata.resourceSets[0].resources[0],t=e.imageUrl.replace("{quadkey}","${quadkey}");t=t.replace("{culture}",this.culture),this.url=[];for(var i=0;i<e.imageUrlSubdomains.length;++i)this.url.push(t.replace("{subdomain}",e.imageUrlSubdomains[i]));this.addOptions({maxResolution:Math.min(this.serverResolutions[e.zoomMin],this.maxResolution||Number.POSITIVE_INFINITY),numZoomLevels:Math.min(e.zoomMax+1-e.zoomMin,this.numZoomLevels)},!0)},getURL:function(e){if(this.url){for(var t=this.getXYZ(e),i=t.x,s=t.y,n=t.z,r=[],a=n;a>0;--a){var o="0",l=1<<a-1;0!=(i&l)&&o++,0!=(s&l)&&(o++,o++),r.push(o)}var h=r.join(""),u=this.selectUrl(""+i+s+n,this.url);return OpenLayers.String.format(u,{quadkey:h})}},updateAttribution:function(){var e=this.metadata;if(e.resourceSets&&this.map&&this.map.center){var t,i,s,n,r,a,o,l=e.resourceSets[0].resources[0],h=this.map.getExtent().transform(this.map.getProjectionObject(),new OpenLayers.Projection("EPSG:4326")),u=l.imageryProviders,c=OpenLayers.Util.indexOf(this.serverResolutions,this.getServerResolution()),d="";for(i=0,s=u.length;s>i;++i)for(t=u[i],n=0,r=t.coverageAreas.length;r>n;++n)o=t.coverageAreas[n],a=OpenLayers.Bounds.fromArray(o.bbox,!0),h.intersectsBounds(a)&&c<=o.zoomMax&&c>=o.zoomMin&&(d+=t.attribution+" ");this.attribution=OpenLayers.String.format(this.attributionTemplate,{type:this.type.toLowerCase(),logo:e.brandLogoUri,copyrights:d}),this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"attribution"})}},setMap:function(){OpenLayers.Layer.XYZ.prototype.setMap.apply(this,arguments),this.updateAttribution(),this.map.events.register("moveend",this,this.updateAttribution)},clone:function(e){return null==e&&(e=new OpenLayers.Layer.Bing(this.options)),e=OpenLayers.Layer.XYZ.prototype.clone.apply(this,[e])},destroy:function(){this.map&&this.map.events.unregister("moveend",this,this.updateAttribution),OpenLayers.Layer.XYZ.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.Bing"}),OpenLayers.Layer.Bing.processMetadata=function(e){this.metadata=e,this.initLayer();var t=document.getElementById(this._callbackId);t.parentNode.removeChild(t),window[this._callbackId]=void 0,delete this._callbackId},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.StyleMap=OpenLayers.Class({styles:null,extendDefault:!0,initialize:function(e,t){if(this.styles={"default":new OpenLayers.Style(OpenLayers.Feature.Vector.style["default"]),select:new OpenLayers.Style(OpenLayers.Feature.Vector.style.select),temporary:new OpenLayers.Style(OpenLayers.Feature.Vector.style.temporary),"delete":new OpenLayers.Style(OpenLayers.Feature.Vector.style["delete"])},e instanceof OpenLayers.Style)this.styles["default"]=e,this.styles.select=e,this.styles.temporary=e,this.styles["delete"]=e;else if("object"==typeof e)for(var i in e)if(e[i]instanceof OpenLayers.Style)this.styles[i]=e[i];else{if("object"!=typeof e[i]){this.styles["default"]=new OpenLayers.Style(e),this.styles.select=new OpenLayers.Style(e),this.styles.temporary=new OpenLayers.Style(e),this.styles["delete"]=new OpenLayers.Style(e);break}this.styles[i]=new OpenLayers.Style(e[i])}OpenLayers.Util.extend(this,t)},destroy:function(){for(var e in this.styles)this.styles[e].destroy();this.styles=null},createSymbolizer:function(e,t){e||(e=new OpenLayers.Feature.Vector),this.styles[t]||(t="default"),e.renderIntent=t;var i={};return this.extendDefault&&"default"!=t&&(i=this.styles["default"].createSymbolizer(e)),OpenLayers.Util.extend(i,this.styles[t].createSymbolizer(e))},addUniqueValueRules:function(e,t,i,s){var n=[];for(var r in i)n.push(new OpenLayers.Rule({symbolizer:i[r],context:s,filter:new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,property:t,value:r})}));this.styles[e].addRules(n)},CLASS_NAME:"OpenLayers.StyleMap"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.Vector=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!1,isFixed:!1,features:null,filter:null,selectedFeatures:null,unrenderedFeatures:null,reportError:!0,style:null,styleMap:null,strategies:null,protocol:null,renderers:["SVG","VML","Canvas"],renderer:null,rendererOptions:null,geometryType:null,drawn:!1,ratio:1,initialize:function(){if(OpenLayers.Layer.prototype.initialize.apply(this,arguments),this.renderer&&this.renderer.supported()||this.assignRenderer(),this.renderer&&this.renderer.supported()||(this.renderer=null,this.displayError()),this.styleMap||(this.styleMap=new OpenLayers.StyleMap),this.features=[],this.selectedFeatures=[],this.unrenderedFeatures={},this.strategies)for(var e=0,t=this.strategies.length;t>e;e++)this.strategies[e].setLayer(this)},destroy:function(){if(this.strategies){var e,t,i;for(t=0,i=this.strategies.length;i>t;t++)e=this.strategies[t],e.autoDestroy&&e.destroy();this.strategies=null}this.protocol&&(this.protocol.autoDestroy&&this.protocol.destroy(),this.protocol=null),this.destroyFeatures(),this.features=null,this.selectedFeatures=null,this.unrenderedFeatures=null,this.renderer&&this.renderer.destroy(),this.renderer=null,this.geometryType=null,this.drawn=null,OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(e){null==e&&(e=new OpenLayers.Layer.Vector(this.name,this.getOptions())),e=OpenLayers.Layer.prototype.clone.apply(this,[e]);for(var t=this.features,i=t.length,s=new Array(i),n=0;i>n;++n)s[n]=t[n].clone();return e.features=s,e},refresh:function(e){this.calculateInRange()&&this.visibility&&this.events.triggerEvent("refresh",e)},assignRenderer:function(){for(var e=0,t=this.renderers.length;t>e;e++){var i=this.renderers[e],s="function"==typeof i?i:OpenLayers.Renderer[i];if(s&&s.prototype.supported()){this.renderer=new s(this.div,this.rendererOptions);break}}},displayError:function(){this.reportError&&OpenLayers.Console.userError(OpenLayers.i18n("browserNotSupported",{renderers:this.renderers.join("\n")}))},setMap:function(){if(OpenLayers.Layer.prototype.setMap.apply(this,arguments),this.renderer){this.renderer.map=this.map;var e=this.map.getSize();e.w=e.w*this.ratio,e.h=e.h*this.ratio,this.renderer.setSize(e)}else this.map.removeLayer(this)},afterAdd:function(){if(this.strategies){var e,t,i;for(t=0,i=this.strategies.length;i>t;t++)e=this.strategies[t],e.autoActivate&&e.activate()}},removeMap:function(){if(this.drawn=!1,this.strategies){var e,t,i;for(t=0,i=this.strategies.length;i>t;t++)e=this.strategies[t],e.autoActivate&&e.deactivate()}},onMapResize:function(){OpenLayers.Layer.prototype.onMapResize.apply(this,arguments);var e=this.map.getSize();e.w=e.w*this.ratio,e.h=e.h*this.ratio,this.renderer.setSize(e)},moveTo:function(e,t,i){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var s=!0;if(!i){this.renderer.root.style.visibility="hidden";var n=this.map.getSize(),r=n.w,a=n.h,o=r/2*this.ratio-r/2,l=a/2*this.ratio-a/2;o+=parseInt(this.map.layerContainerDiv.style.left,10),o=-Math.round(o),l+=parseInt(this.map.layerContainerDiv.style.top,10),l=-Math.round(l),this.div.style.left=o+"px",this.div.style.top=l+"px";var h=this.map.getExtent().scale(this.ratio);if(s=this.renderer.setExtent(h,t),this.renderer.root.style.visibility="visible",OpenLayers.IS_GECKO===!0&&(this.div.scrollLeft=this.div.scrollLeft),!t&&s)for(var u in this.unrenderedFeatures){var c=this.unrenderedFeatures[u];this.drawFeature(c)}}if(!this.drawn||t||!s){this.drawn=!0;for(var c,u=0,d=this.features.length;d>u;u++)this.renderer.locked=u!==d-1,c=this.features[u],this.drawFeature(c)}},display:function(){OpenLayers.Layer.prototype.display.apply(this,arguments);var e=this.div.style.display;e!=this.renderer.root.style.display&&(this.renderer.root.style.display=e)},addFeatures:function(e,t){OpenLayers.Util.isArray(e)||(e=[e]);var i=!t||!t.silent;if(i){var s={features:e},n=this.events.triggerEvent("beforefeaturesadded",s);if(n===!1)return;e=s.features}for(var r=[],a=0,o=e.length;o>a;a++){this.renderer.locked=a!=e.length-1?!0:!1;var l=e[a];if(this.geometryType&&!(l.geometry instanceof this.geometryType))throw new TypeError("addFeatures: component should be an "+this.geometryType.prototype.CLASS_NAME);if(l.layer=this,!l.style&&this.style&&(l.style=OpenLayers.Util.extend({},this.style)),i){if(this.events.triggerEvent("beforefeatureadded",{feature:l})===!1)continue;this.preFeatureInsert(l)}r.push(l),this.features.push(l),this.drawFeature(l),i&&(this.events.triggerEvent("featureadded",{feature:l}),this.onFeatureInsert(l))}i&&this.events.triggerEvent("featuresadded",{features:r})},removeFeatures:function(e,t){if(e&&0!==e.length){if(e===this.features)return this.removeAllFeatures(t);OpenLayers.Util.isArray(e)||(e=[e]),e===this.selectedFeatures&&(e=e.slice());var i=!t||!t.silent;i&&this.events.triggerEvent("beforefeaturesremoved",{features:e});for(var s=e.length-1;s>=0;s--){this.renderer.locked=0!=s&&e[s-1].geometry?!0:!1;var n=e[s];delete this.unrenderedFeatures[n.id],i&&this.events.triggerEvent("beforefeatureremoved",{feature:n}),this.features=OpenLayers.Util.removeItem(this.features,n),n.layer=null,n.geometry&&this.renderer.eraseFeatures(n),-1!=OpenLayers.Util.indexOf(this.selectedFeatures,n)&&OpenLayers.Util.removeItem(this.selectedFeatures,n),i&&this.events.triggerEvent("featureremoved",{feature:n})}i&&this.events.triggerEvent("featuresremoved",{features:e})}},removeAllFeatures:function(e){var t=!e||!e.silent,i=this.features;t&&this.events.triggerEvent("beforefeaturesremoved",{features:i});for(var s,n=i.length-1;n>=0;n--)s=i[n],t&&this.events.triggerEvent("beforefeatureremoved",{feature:s}),s.layer=null,t&&this.events.triggerEvent("featureremoved",{feature:s});this.renderer.clear(),this.features=[],this.unrenderedFeatures={},this.selectedFeatures=[],t&&this.events.triggerEvent("featuresremoved",{features:i})},destroyFeatures:function(e,t){var i=void 0==e;if(i&&(e=this.features),e){this.removeFeatures(e,t);for(var s=e.length-1;s>=0;s--)e[s].destroy()}},drawFeature:function(e,t){if(this.drawn){if("object"!=typeof t){t||e.state!==OpenLayers.State.DELETE||(t="delete");var i=t||e.renderIntent;t=e.style||this.style,t||(t=this.styleMap.createSymbolizer(e,i))}var s=this.renderer.drawFeature(e,t);s===!1||null===s?this.unrenderedFeatures[e.id]=e:delete this.unrenderedFeatures[e.id]}},eraseFeatures:function(e){this.renderer.eraseFeatures(e)},getFeatureFromEvent:function(e){if(!this.renderer)throw new Error("getFeatureFromEvent called on layer with no renderer. This usually means you destroyed a layer, but not some handler which is associated with it.");var t=null,i=this.renderer.getFeatureIdFromEvent(e);return i&&(t="string"==typeof i?this.getFeatureById(i):i),t},getFeatureBy:function(e,t){for(var i=null,s=0,n=this.features.length;n>s;++s)if(this.features[s][e]==t){i=this.features[s];break}return i},getFeatureById:function(e){return this.getFeatureBy("id",e)},getFeatureByFid:function(e){return this.getFeatureBy("fid",e)},getFeaturesByAttribute:function(e,t){var i,s,n=this.features.length,r=[];for(i=0;n>i;i++)s=this.features[i],s&&s.attributes&&s.attributes[e]===t&&r.push(s);return r},onFeatureInsert:function(){},preFeatureInsert:function(){},getDataExtent:function(){var e=null,t=this.features;if(t&&t.length>0)for(var i=null,s=0,n=t.length;n>s;s++)i=t[s].geometry,i&&(null===e&&(e=new OpenLayers.Bounds),e.extend(i.getBounds()));return e},CLASS_NAME:"OpenLayers.Layer.Vector"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.PointGrid=OpenLayers.Class(OpenLayers.Layer.Vector,{dx:null,dy:null,ratio:1.5,maxFeatures:250,rotation:0,origin:null,gridBounds:null,initialize:function(e){e=e||{},OpenLayers.Layer.Vector.prototype.initialize.apply(this,[e.name,e])},setMap:function(e){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments),e.events.register("moveend",this,this.onMoveEnd)},removeMap:function(e){e.events.unregister("moveend",this,this.onMoveEnd),OpenLayers.Layer.Vector.prototype.removeMap.apply(this,arguments)},setRatio:function(e){this.ratio=e,this.updateGrid(!0)},setMaxFeatures:function(e){this.maxFeatures=e,this.updateGrid(!0)},setSpacing:function(e,t){this.dx=e,this.dy=t||e,this.updateGrid(!0)},setOrigin:function(e){this.origin=e,this.updateGrid(!0)},getOrigin:function(){return this.origin||(this.origin=this.map.getExtent().getCenterLonLat()),this.origin},setRotation:function(e){this.rotation=e,this.updateGrid(!0)},onMoveEnd:function(){this.updateGrid()},getViewBounds:function(){var e=this.map.getExtent();if(this.rotation){var t=this.getOrigin(),i=new OpenLayers.Geometry.Point(t.lon,t.lat),s=e.toGeometry();s.rotate(-this.rotation,i),e=s.getBounds()}return e},updateGrid:function(e){if(e||this.invalidBounds()){var t=this.getViewBounds(),i=this.getOrigin(),s=new OpenLayers.Geometry.Point(i.lon,i.lat),n=t.getWidth(),r=t.getHeight(),a=n/r,o=Math.sqrt(this.dx*this.dy*this.maxFeatures/a),l=o*a,h=Math.min(n*this.ratio,l),u=Math.min(r*this.ratio,o),c=t.getCenterLonLat();this.gridBounds=new OpenLayers.Bounds(c.lon-h/2,c.lat-u/2,c.lon+h/2,c.lat+u/2);for(var d,p,f,m=Math.floor(u/this.dy),y=Math.floor(h/this.dx),g=i.lon+this.dx*Math.ceil((this.gridBounds.left-i.lon)/this.dx),v=i.lat+this.dy*Math.ceil((this.gridBounds.bottom-i.lat)/this.dy),x=new Array(m*y),E=0;y>E;++E){d=g+E*this.dx;for(var b=0;m>b;++b)p=v+b*this.dy,f=new OpenLayers.Geometry.Point(d,p),this.rotation&&f.rotate(this.rotation,s),x[E*m+b]=new OpenLayers.Feature.Vector(f)}this.destroyFeatures(this.features,{silent:!0}),this.addFeatures(x,{silent:!0})}},invalidBounds:function(){return!this.gridBounds||!this.gridBounds.containsBounds(this.getViewBounds())},CLASS_NAME:"OpenLayers.Layer.PointGrid"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Handler=OpenLayers.Class({id:null,control:null,map:null,keyMask:null,active:!1,evt:null,initialize:function(e,t,i){OpenLayers.Util.extend(this,i),this.control=e,this.callbacks=t;var s=this.map||e.map;s&&this.setMap(s),this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},setMap:function(e){this.map=e},checkModifiers:function(e){if(null==this.keyMask)return!0;var t=(e.shiftKey?OpenLayers.Handler.MOD_SHIFT:0)|(e.ctrlKey?OpenLayers.Handler.MOD_CTRL:0)|(e.altKey?OpenLayers.Handler.MOD_ALT:0);return t==this.keyMask},activate:function(){if(this.active)return!1;for(var e=OpenLayers.Events.prototype.BROWSER_EVENTS,t=0,i=e.length;i>t;t++)this[e[t]]&&this.register(e[t],this[e[t]]);return this.active=!0,!0},deactivate:function(){if(!this.active)return!1;for(var e=OpenLayers.Events.prototype.BROWSER_EVENTS,t=0,i=e.length;i>t;t++)this[e[t]]&&this.unregister(e[t],this[e[t]]);return this.active=!1,!0},callback:function(e,t){e&&this.callbacks[e]&&this.callbacks[e].apply(this.control,t)},register:function(e,t){this.map.events.registerPriority(e,this,t),this.map.events.registerPriority(e,this,this.setEvent)},unregister:function(e,t){this.map.events.unregister(e,this,t),this.map.events.unregister(e,this,this.setEvent)},setEvent:function(e){return this.evt=e,!0},destroy:function(){this.deactivate(),this.control=this.map=null},CLASS_NAME:"OpenLayers.Handler"}),OpenLayers.Handler.MOD_NONE=0,OpenLayers.Handler.MOD_SHIFT=1,OpenLayers.Handler.MOD_CTRL=2,OpenLayers.Handler.MOD_ALT=4,/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Handler.MouseWheel=OpenLayers.Class(OpenLayers.Handler,{wheelListener:null,mousePosition:null,interval:0,delta:0,cumulative:!0,initialize:function(){OpenLayers.Handler.prototype.initialize.apply(this,arguments),this.wheelListener=OpenLayers.Function.bindAsEventListener(this.onWheelEvent,this)},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments),this.wheelListener=null},onWheelEvent:function(e){if(this.map&&this.checkModifiers(e)){for(var t=!1,i=!1,s=!1,n=OpenLayers.Event.element(e);null!=n&&!s&&!t;){if(!t)try{if(n.currentStyle)a=n.currentStyle.overflow;else var r=document.defaultView.getComputedStyle(n,null),a=r.getPropertyValue("overflow");t=a&&"auto"==a||"scroll"==a}catch(o){}if(!i)for(var l=0,h=this.map.layers.length;h>l;l++)if(n==this.map.layers[l].div||n==this.map.layers[l].pane){i=!0;break}s=n==this.map.div,n=n.parentNode}if(!t&&s){if(i){var u=0;e||(e=window.event),e.wheelDelta?(u=e.wheelDelta/120,window.opera&&window.opera.version()<9.2&&(u=-u)):e.detail&&(u=-e.detail/3),this.delta=this.delta+u,this.interval?(window.clearTimeout(this._timeoutId),this._timeoutId=window.setTimeout(OpenLayers.Function.bind(function(){this.wheelZoom(e)},this),this.interval)):this.wheelZoom(e)}OpenLayers.Event.stop(e)}}},wheelZoom:function(e){var t=this.delta;this.delta=0,t&&(this.mousePosition&&(e.xy=this.mousePosition),e.xy||(e.xy=this.map.getPixelFromLonLat(this.map.getCenter())),0>t?this.callback("down",[e,this.cumulative?t:-1]):this.callback("up",[e,this.cumulative?t:1]))},mousemove:function(e){this.mousePosition=e.xy},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){var e=this.wheelListener;return OpenLayers.Event.observe(window,"DOMMouseScroll",e),OpenLayers.Event.observe(window,"mousewheel",e),OpenLayers.Event.observe(document,"mousewheel",e),!0}return!1},deactivate:function(){if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){var e=this.wheelListener;return OpenLayers.Event.stopObserving(window,"DOMMouseScroll",e),OpenLayers.Event.stopObserving(window,"mousewheel",e),OpenLayers.Event.stopObserving(document,"mousewheel",e),!0}return!1},CLASS_NAME:"OpenLayers.Handler.MouseWheel"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Handler.Drag=OpenLayers.Class(OpenLayers.Handler,{started:!1,stopDown:!0,dragging:!1,touch:!1,last:null,start:null,lastMoveEvt:null,oldOnselectstart:null,interval:0,timeoutId:null,documentDrag:!1,documentEvents:null,initialize:function(){if(OpenLayers.Handler.prototype.initialize.apply(this,arguments),this.documentDrag===!0){var e=this;this._docMove=function(t){e.mousemove({xy:{x:t.clientX,y:t.clientY},element:document})},this._docUp=function(t){e.mouseup({xy:{x:t.clientX,y:t.clientY}})}}},dragstart:function(e){var t=!0;return this.dragging=!1,this.checkModifiers(e)&&(OpenLayers.Event.isLeftClick(e)||OpenLayers.Event.isSingleTouch(e))?(this.started=!0,this.start=e.xy,this.last=e.xy,OpenLayers.Element.addClass(this.map.viewPortDiv,"olDragDown"),this.down(e),this.callback("down",[e.xy]),OpenLayers.Event.stop(e),this.oldOnselectstart||(this.oldOnselectstart=document.onselectstart?document.onselectstart:OpenLayers.Function.True),document.onselectstart=OpenLayers.Function.False,t=!this.stopDown):(this.started=!1,this.start=null,this.last=null),t},dragmove:function(e){return this.lastMoveEvt=e,!this.started||this.timeoutId||e.xy.x==this.last.x&&e.xy.y==this.last.y||(this.documentDrag===!0&&this.documentEvents&&(e.element===document?(this.adjustXY(e),this.setEvent(e)):this.removeDocumentEvents()),this.interval>0&&(this.timeoutId=setTimeout(OpenLayers.Function.bind(this.removeTimeout,this),this.interval)),this.dragging=!0,this.move(e),this.callback("move",[e.xy]),this.oldOnselectstart||(this.oldOnselectstart=document.onselectstart,document.onselectstart=OpenLayers.Function.False),this.last=e.xy),!0},dragend:function(e){if(this.started){this.documentDrag===!0&&this.documentEvents&&(this.adjustXY(e),this.removeDocumentEvents());var t=this.start!=this.last;this.started=!1,this.dragging=!1,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown"),this.up(e),this.callback("up",[e.xy]),t&&this.callback("done",[e.xy]),document.onselectstart=this.oldOnselectstart}return!0},down:function(){},move:function(){},up:function(){},out:function(){},mousedown:function(e){return this.dragstart(e)},touchstart:function(e){return this.touch||(this.touch=!0,this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,mousemove:this.mousemove,click:this.click,scope:this})),this.dragstart(e)},mousemove:function(e){return this.dragmove(e)},touchmove:function(e){return this.dragmove(e)},removeTimeout:function(){this.timeoutId=null,this.dragging&&this.mousemove(this.lastMoveEvt)},mouseup:function(e){return this.dragend(e)},touchend:function(e){return e.xy=this.last,this.dragend(e)},mouseout:function(e){if(this.started&&OpenLayers.Util.mouseLeft(e,this.map.viewPortDiv))if(this.documentDrag===!0)this.addDocumentEvents();else{var t=this.start!=this.last;this.started=!1,this.dragging=!1,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown"),this.out(e),this.callback("out",[]),t&&this.callback("done",[e.xy]),document.onselectstart&&(document.onselectstart=this.oldOnselectstart)}return!0},click:function(){return this.start==this.last},activate:function(){var e=!1;return OpenLayers.Handler.prototype.activate.apply(this,arguments)&&(this.dragging=!1,e=!0),e},deactivate:function(){var e=!1;return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.touch=!1,this.started=!1,this.dragging=!1,this.start=null,this.last=null,e=!0,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown")),e},adjustXY:function(e){var t=OpenLayers.Util.pagePosition(this.map.viewPortDiv);e.xy.x-=t[0],e.xy.y-=t[1]},addDocumentEvents:function(){OpenLayers.Element.addClass(document.body,"olDragDown"),this.documentEvents=!0,OpenLayers.Event.observe(document,"mousemove",this._docMove),OpenLayers.Event.observe(document,"mouseup",this._docUp)},removeDocumentEvents:function(){OpenLayers.Element.removeClass(document.body,"olDragDown"),this.documentEvents=!1,OpenLayers.Event.stopObserving(document,"mousemove",this._docMove),OpenLayers.Event.stopObserving(document,"mouseup",this._docUp)},CLASS_NAME:"OpenLayers.Handler.Drag"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Handler.RegularPolygon=OpenLayers.Class(OpenLayers.Handler.Drag,{sides:4,radius:null,snapAngle:null,snapToggle:"shiftKey",layerOptions:null,persist:!1,irregular:!1,citeCompliant:!1,angle:null,fixedRadius:!1,feature:null,layer:null,origin:null,initialize:function(e,t,i){i&&i.layerOptions&&i.layerOptions.styleMap||(this.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style["default"],{})),OpenLayers.Handler.Drag.prototype.initialize.apply(this,[e,t,i]),this.options=i?i:{}},setOptions:function(e){OpenLayers.Util.extend(this.options,e),OpenLayers.Util.extend(this,e)},activate:function(){var e=!1;if(OpenLayers.Handler.Drag.prototype.activate.apply(this,arguments)){var t=OpenLayers.Util.extend({displayInLayerSwitcher:!1,calculateInRange:OpenLayers.Function.True,wrapDateLine:this.citeCompliant},this.layerOptions);this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,t),this.map.addLayer(this.layer),e=!0}return e},deactivate:function(){var e=!1;return OpenLayers.Handler.Drag.prototype.deactivate.apply(this,arguments)&&(this.dragging&&this.cancel(),null!=this.layer.map&&(this.layer.destroy(!1),this.feature&&this.feature.destroy()),this.layer=null,this.feature=null,e=!0),e},down:function(e){this.fixedRadius=!!this.radius;var t=this.layer.getLonLatFromViewPortPx(e.xy);this.origin=new OpenLayers.Geometry.Point(t.lon,t.lat),(!this.fixedRadius||this.irregular)&&(this.radius=this.map.getResolution()),this.persist&&this.clear(),this.feature=new OpenLayers.Feature.Vector,this.createGeometry(),this.callback("create",[this.origin,this.feature]),this.layer.addFeatures([this.feature],{silent:!0}),this.layer.drawFeature(this.feature,this.style)},move:function(e){var t=this.layer.getLonLatFromViewPortPx(e.xy),i=new OpenLayers.Geometry.Point(t.lon,t.lat);if(this.irregular){var s=Math.sqrt(2)*Math.abs(i.y-this.origin.y)/2;this.radius=Math.max(this.map.getResolution()/2,s)}else this.fixedRadius?this.origin=i:(this.calculateAngle(i,e),this.radius=Math.max(this.map.getResolution()/2,i.distanceTo(this.origin)));if(this.modifyGeometry(),this.irregular){var n,r=i.x-this.origin.x,a=i.y-this.origin.y;n=0==a?r/(this.radius*Math.sqrt(2)):r/a,this.feature.geometry.resize(1,this.origin,n),this.feature.geometry.move(r/2,a/2)}this.layer.drawFeature(this.feature,this.style)},up:function(e){this.finalize(),this.start==this.last&&this.callback("done",[e.xy])},out:function(){this.finalize()},createGeometry:function(){this.angle=Math.PI*(1/this.sides-.5),this.snapAngle&&(this.angle+=this.snapAngle*(Math.PI/180)),this.feature.geometry=OpenLayers.Geometry.Polygon.createRegularPolygon(this.origin,this.radius,this.sides,this.snapAngle)},modifyGeometry:function(){var e,t,i=this.feature.geometry.components[0];i.components.length!=this.sides+1&&(this.createGeometry(),i=this.feature.geometry.components[0]);for(var s=0;s<this.sides;++s)t=i.components[s],e=this.angle+2*s*Math.PI/this.sides,t.x=this.origin.x+this.radius*Math.cos(e),t.y=this.origin.y+this.radius*Math.sin(e),t.clearBounds()},calculateAngle:function(e,t){var i=Math.atan2(e.y-this.origin.y,e.x-this.origin.x);if(this.snapAngle&&this.snapToggle&&!t[this.snapToggle]){var s=Math.PI/180*this.snapAngle;this.angle=Math.round(i/s)*s}else this.angle=i},cancel:function(){this.callback("cancel",null),this.finalize()},finalize:function(){this.origin=null,this.radius=this.options.radius},clear:function(){this.layer&&(this.layer.renderer.clear(),this.layer.destroyFeatures())},callback:function(e){this.callbacks[e]&&this.callbacks[e].apply(this.control,[this.feature.geometry.clone()]),this.persist||"done"!=e&&"cancel"!=e||this.clear()},CLASS_NAME:"OpenLayers.Handler.RegularPolygon"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WFST.v1_0_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0,OpenLayers.Format.WFST.v1,{version:"1.0.0",srsNameInQuery:!1,schemaLocations:{wfs:"http://schemas.opengis.net/wfs/1.0.0/WFS-transaction.xsd"},initialize:function(e){OpenLayers.Format.Filter.v1_0_0.prototype.initialize.apply(this,[e]),OpenLayers.Format.WFST.v1.prototype.initialize.apply(this,[e])},readNode:function(e,t){return OpenLayers.Format.GML.v2.prototype.readNode.apply(this,[e,t])},readers:{wfs:OpenLayers.Util.applyDefaults({WFS_TransactionResponse:function(e,t){t.insertIds=[],t.success=!1,this.readChildNodes(e,t)},InsertResult:function(e,t){var i={fids:[]};this.readChildNodes(e,i),t.insertIds.push(i.fids[0])},TransactionResult:function(e,t){this.readChildNodes(e,t)},Status:function(e,t){this.readChildNodes(e,t)},SUCCESS:function(e,t){t.success=!0}},OpenLayers.Format.WFST.v1.prototype.readers.wfs),gml:OpenLayers.Format.GML.v2.prototype.readers.gml,feature:OpenLayers.Format.GML.v2.prototype.readers.feature,ogc:OpenLayers.Format.Filter.v1_0_0.prototype.readers.ogc},writers:{wfs:OpenLayers.Util.applyDefaults({Query:function(e){e=OpenLayers.Util.extend({featureNS:this.featureNS,featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName,srsNameInQuery:this.srsNameInQuery},e);var t=e.featurePrefix,i=this.createElementNSPlus("wfs:Query",{attributes:{typeName:(t?t+":":"")+e.featureType}});if(e.srsNameInQuery&&e.srsName&&i.setAttribute("srsName",e.srsName),e.featureNS&&i.setAttribute("xmlns:"+t,e.featureNS),e.propertyNames)for(var s=0,n=e.propertyNames.length;n>s;s++)this.writeNode("ogc:PropertyName",{property:e.propertyNames[s]},i);return e.filter&&(this.setFilterProperty(e.filter),this.writeNode("ogc:Filter",e.filter,i)),i}},OpenLayers.Format.WFST.v1.prototype.writers.wfs),gml:OpenLayers.Format.GML.v2.prototype.writers.gml,feature:OpenLayers.Format.GML.v2.prototype.writers.feature,ogc:OpenLayers.Format.Filter.v1_0_0.prototype.writers.ogc},CLASS_NAME:"OpenLayers.Format.WFST.v1_0_0"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.ElementsIndexer=OpenLayers.Class({maxZIndex:null,order:null,indices:null,compare:null,initialize:function(e){this.compare=e?OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_Y_ORDER:OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_DRAWING_ORDER,this.clear()},insert:function(e){this.exists(e)&&this.remove(e);var t=e.id;this.determineZIndex(e);for(var i,s=-1,n=this.order.length;n-s>1;){i=parseInt((s+n)/2);var r=this.compare(this,e,OpenLayers.Util.getElement(this.order[i]));r>0?s=i:n=i}return this.order.splice(n,0,t),this.indices[t]=this.getZIndex(e),this.getNextElement(n)},remove:function(e){var t=e.id,i=OpenLayers.Util.indexOf(this.order,t);if(i>=0)if(this.order.splice(i,1),delete this.indices[t],this.order.length>0){var s=this.order[this.order.length-1];this.maxZIndex=this.indices[s]}else this.maxZIndex=0},clear:function(){this.order=[],this.indices={},this.maxZIndex=0},exists:function(e){return null!=this.indices[e.id]},getZIndex:function(e){return e._style.graphicZIndex},determineZIndex:function(e){var t=e._style.graphicZIndex;null==t?(t=this.maxZIndex,e._style.graphicZIndex=t):t>this.maxZIndex&&(this.maxZIndex=t)},getNextElement:function(e){var t=e+1;if(t<this.order.length){var i=OpenLayers.Util.getElement(this.order[t]);return void 0==i&&(i=this.getNextElement(t)),i}return null},CLASS_NAME:"OpenLayers.ElementsIndexer"}),OpenLayers.ElementsIndexer.IndexingMethods={Z_ORDER:function(e,t,i){var s=e.getZIndex(t),n=0;if(i){var r=e.getZIndex(i);n=s-r}return n},Z_ORDER_DRAWING_ORDER:function(e,t,i){var s=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(e,t,i);return i&&0==s&&(s=1),s},Z_ORDER_Y_ORDER:function(e,t,i){var s=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(e,t,i);if(i&&0===s){var n=i._boundsBottom-t._boundsBottom;s=0===n?1:n}return s}},OpenLayers.Renderer.Elements=OpenLayers.Class(OpenLayers.Renderer,{rendererRoot:null,root:null,vectorRoot:null,textRoot:null,xmlns:null,xOffset:0,indexer:null,BACKGROUND_ID_SUFFIX:"_background",LABEL_ID_SUFFIX:"_label",LABEL_OUTLINE_SUFFIX:"_outline",initialize:function(e,t){OpenLayers.Renderer.prototype.initialize.apply(this,arguments),this.rendererRoot=this.createRenderRoot(),this.root=this.createRoot("_root"),this.vectorRoot=this.createRoot("_vroot"),this.textRoot=this.createRoot("_troot"),this.root.appendChild(this.vectorRoot),this.root.appendChild(this.textRoot),this.rendererRoot.appendChild(this.root),this.container.appendChild(this.rendererRoot),t&&(t.zIndexing||t.yOrdering)&&(this.indexer=new OpenLayers.ElementsIndexer(t.yOrdering))},destroy:function(){this.clear(),this.rendererRoot=null,this.root=null,this.xmlns=null,OpenLayers.Renderer.prototype.destroy.apply(this,arguments)},clear:function(){var e,t=this.vectorRoot;if(t)for(;e=t.firstChild;)t.removeChild(e);if(t=this.textRoot)for(;e=t.firstChild;)t.removeChild(e);this.indexer&&this.indexer.clear()},setExtent:function(e,t){var i=OpenLayers.Renderer.prototype.setExtent.apply(this,arguments),s=this.getResolution();if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var n,r=e.getWidth()/this.map.getExtent().getWidth(),e=e.scale(1/r),a=this.map.getMaxExtent();a.right>e.left&&a.right<e.right?n=!0:a.left>e.left&&a.left<e.right&&(n=!1),(n!==this.rightOfDateLine||t)&&(i=!1,this.xOffset=n===!0?a.getWidth()/s:0),this.rightOfDateLine=n}return i},getNodeType:function(){},drawGeometry:function(e,t,i){var s=e.CLASS_NAME,n=!0;if("OpenLayers.Geometry.Collection"==s||"OpenLayers.Geometry.MultiPoint"==s||"OpenLayers.Geometry.MultiLineString"==s||"OpenLayers.Geometry.MultiPolygon"==s){for(var r=0,a=e.components.length;a>r;r++)n=this.drawGeometry(e.components[r],t,i)&&n;return n}n=!1;var o=!1;if("none"!=t.display&&(t.backgroundGraphic?this.redrawBackgroundNode(e.id,e,t,i):o=!0,n=this.redrawNode(e.id,e,t,i)),0==n){var l=document.getElementById(e.id);l&&(l._style.backgroundGraphic&&(o=!0),l.parentNode.removeChild(l))}if(o){var l=document.getElementById(e.id+this.BACKGROUND_ID_SUFFIX);l&&l.parentNode.removeChild(l)}return n},redrawNode:function(e,t,i,s){i=this.applyDefaultSymbolizer(i);var n=this.nodeFactory(e,this.getNodeType(t,i));n._featureId=s,n._boundsBottom=t.getBounds().bottom,n._geometryClass=t.CLASS_NAME,n._style=i;var r=this.drawGeometryNode(n,t,i);if(r===!1)return!1;if(n=r.node,this.indexer){var a=this.indexer.insert(n);a?this.vectorRoot.insertBefore(n,a):this.vectorRoot.appendChild(n)}else n.parentNode!==this.vectorRoot&&this.vectorRoot.appendChild(n);return this.postDraw(n),r.complete},redrawBackgroundNode:function(e,t,i){var s=OpenLayers.Util.extend({},i);return s.externalGraphic=s.backgroundGraphic,s.graphicXOffset=s.backgroundXOffset,s.graphicYOffset=s.backgroundYOffset,s.graphicZIndex=s.backgroundGraphicZIndex,s.graphicWidth=s.backgroundWidth||s.graphicWidth,s.graphicHeight=s.backgroundHeight||s.graphicHeight,s.backgroundGraphic=null,s.backgroundXOffset=null,s.backgroundYOffset=null,s.backgroundGraphicZIndex=null,this.redrawNode(e+this.BACKGROUND_ID_SUFFIX,t,s,null)},drawGeometryNode:function(e,t,i){i=i||e._style;var s,n={isFilled:void 0===i.fill?!0:i.fill,isStroked:void 0===i.stroke?!!i.strokeWidth:i.stroke};switch(t.CLASS_NAME){case"OpenLayers.Geometry.Point":i.graphic===!1&&(n.isFilled=!1,n.isStroked=!1),s=this.drawPoint(e,t);break;case"OpenLayers.Geometry.LineString":n.isFilled=!1,s=this.drawLineString(e,t);break;case"OpenLayers.Geometry.LinearRing":s=this.drawLinearRing(e,t);break;case"OpenLayers.Geometry.Polygon":s=this.drawPolygon(e,t);break;case"OpenLayers.Geometry.Rectangle":s=this.drawRectangle(e,t)}return e._options=n,0!=s?{node:this.setStyle(e,i,n,t),complete:s}:!1},postDraw:function(){},drawPoint:function(){},drawLineString:function(){},drawLinearRing:function(){},drawPolygon:function(){},drawRectangle:function(){},drawCircle:function(){},removeText:function(e){var t=document.getElementById(e+this.LABEL_ID_SUFFIX);t&&this.textRoot.removeChild(t);var i=document.getElementById(e+this.LABEL_OUTLINE_SUFFIX);i&&this.textRoot.removeChild(i)},getFeatureIdFromEvent:function(e){var t=e.target,i=t&&t.correspondingUseElement,s=i?i:t||e.srcElement;return s._featureId},eraseGeometry:function(e,t){if("OpenLayers.Geometry.MultiPoint"==e.CLASS_NAME||"OpenLayers.Geometry.MultiLineString"==e.CLASS_NAME||"OpenLayers.Geometry.MultiPolygon"==e.CLASS_NAME||"OpenLayers.Geometry.Collection"==e.CLASS_NAME)for(var i=0,s=e.components.length;s>i;i++)this.eraseGeometry(e.components[i],t);else{var n=OpenLayers.Util.getElement(e.id);if(n&&n.parentNode&&(n.geometry&&(n.geometry.destroy(),n.geometry=null),n.parentNode.removeChild(n),this.indexer&&this.indexer.remove(n),n._style.backgroundGraphic)){var r=e.id+this.BACKGROUND_ID_SUFFIX,a=OpenLayers.Util.getElement(r);a&&a.parentNode&&a.parentNode.removeChild(a)}}},nodeFactory:function(e,t){var i=OpenLayers.Util.getElement(e);return i?this.nodeTypeCompare(i,t)||(i.parentNode.removeChild(i),i=this.nodeFactory(e,t)):i=this.createNode(t,e),i},nodeTypeCompare:function(){},createNode:function(){},moveRoot:function(e){var t=this.root;e.root.parentNode==this.rendererRoot&&(t=e.root),t.parentNode.removeChild(t),e.rendererRoot.appendChild(t)},getRenderLayerId:function(){return this.root.parentNode.parentNode.id},isComplexSymbol:function(e){return"circle"!=e&&!!e},CLASS_NAME:"OpenLayers.Renderer.Elements"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.ArgParser=OpenLayers.Class(OpenLayers.Control,{center:null,zoom:null,layers:null,displayProjection:null,getParameters:function(e){e=e||window.location.href;var t=OpenLayers.Util.getParameters(e),i=e.indexOf("#");return i>0&&(e="?"+e.substring(i+1,e.length),OpenLayers.Util.extend(t,OpenLayers.Util.getParameters(e))),t},setMap:function(){OpenLayers.Control.prototype.setMap.apply(this,arguments);for(var e=0,t=this.map.controls.length;t>e;e++){var i=this.map.controls[e];if(i!=this&&"OpenLayers.Control.ArgParser"==i.CLASS_NAME){i.displayProjection!=this.displayProjection&&(this.displayProjection=i.displayProjection);break}}if(e==this.map.controls.length){var s=this.getParameters();s.layers&&(this.layers=s.layers,this.map.events.register("addlayer",this,this.configureLayers),this.configureLayers()),s.lat&&s.lon&&(this.center=new OpenLayers.LonLat(parseFloat(s.lon),parseFloat(s.lat)),s.zoom&&(this.zoom=parseFloat(s.zoom)),this.map.events.register("changebaselayer",this,this.setCenter),this.setCenter())}},setCenter:function(){this.map.baseLayer&&(this.map.events.unregister("changebaselayer",this,this.setCenter),this.displayProjection&&this.center.transform(this.displayProjection,this.map.getProjectionObject()),this.map.setCenter(this.center,this.zoom))},configureLayers:function(){if(this.layers.length==this.map.layers.length){this.map.events.unregister("addlayer",this,this.configureLayers);for(var e=0,t=this.layers.length;t>e;e++){var i=this.map.layers[e],s=this.layers.charAt(e);"B"==s?this.map.setBaseLayer(i):("T"==s||"F"==s)&&i.setVisibility("T"==s)}}},CLASS_NAME:"OpenLayers.Control.ArgParser"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.Permalink=OpenLayers.Class(OpenLayers.Control,{argParserClass:OpenLayers.Control.ArgParser,element:null,anchor:!1,base:"",displayProjection:null,initialize:function(e,t,i){null===e||"object"!=typeof e||OpenLayers.Util.isElement(e)?(OpenLayers.Control.prototype.initialize.apply(this,[i]),this.element=OpenLayers.Util.getElement(e),this.base=t||document.location.href):(i=e,this.base=document.location.href,OpenLayers.Control.prototype.initialize.apply(this,[i]),null!=this.element&&(this.element=OpenLayers.Util.getElement(this.element)))},destroy:function(){this.element&&this.element.parentNode==this.div&&(this.div.removeChild(this.element),this.element=null),this.map&&this.map.events.unregister("moveend",this,this.updateLink),OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(){OpenLayers.Control.prototype.setMap.apply(this,arguments);for(var e=0,t=this.map.controls.length;t>e;e++){var i=this.map.controls[e];if(i.CLASS_NAME==this.argParserClass.CLASS_NAME){i.displayProjection!=this.displayProjection&&(this.displayProjection=i.displayProjection);break}}e==this.map.controls.length&&this.map.addControl(new this.argParserClass({displayProjection:this.displayProjection}))},draw:function(){return OpenLayers.Control.prototype.draw.apply(this,arguments),this.element||this.anchor||(this.element=document.createElement("a"),this.element.innerHTML=OpenLayers.i18n("Permalink"),this.element.href="",this.div.appendChild(this.element)),this.map.events.on({moveend:this.updateLink,changelayer:this.updateLink,changebaselayer:this.updateLink,scope:this}),this.updateLink(),this.div},updateLink:function(){var e=this.anchor?"#":"?",t=this.base;-1!=t.indexOf(e)&&(t=t.substring(0,t.indexOf(e))),t+=e+OpenLayers.Util.getParameterString(this.createParams()),this.anchor&&!this.element?window.location.href=t:this.element.href=t},createParams:function(e,t,i){e=e||this.map.getCenter();var s=OpenLayers.Util.getParameters(this.base);if(e){s.zoom=t||this.map.getZoom();var n=e.lat,r=e.lon;if(this.displayProjection){var a=OpenLayers.Projection.transform({x:r,y:n},this.map.getProjectionObject(),this.displayProjection);r=a.x,n=a.y}s.lat=Math.round(1e5*n)/1e5,s.lon=Math.round(1e5*r)/1e5,i=i||this.map.layers,s.layers="";for(var o=0,l=i.length;l>o;o++){var h=i[o];s.layers+=h.isBaseLayer?h==this.map.baseLayer?"B":"0":h.getVisibility()?"T":"F"}}return s},CLASS_NAME:"OpenLayers.Control.Permalink"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.TMS=OpenLayers.Class(OpenLayers.Layer.Grid,{serviceVersion:"1.0.0",layername:null,type:null,isBaseLayer:!0,tileOrigin:null,serverResolutions:null,zoomOffset:0,initialize:function(e,t,i){var s=[];s.push(e,t,{},i),OpenLayers.Layer.Grid.prototype.initialize.apply(this,s)},clone:function(e){return null==e&&(e=new OpenLayers.Layer.TMS(this.name,this.url,this.getOptions())),e=OpenLayers.Layer.Grid.prototype.clone.apply(this,[e])},getURL:function(e){e=this.adjustBounds(e);var t=this.getServerResolution(),i=Math.round((e.left-this.tileOrigin.lon)/(t*this.tileSize.w)),s=Math.round((e.bottom-this.tileOrigin.lat)/(t*this.tileSize.h)),n=this.getServerZoom(),r=this.serviceVersion+"/"+this.layername+"/"+n+"/"+i+"/"+s+"."+this.type,a=this.url;return OpenLayers.Util.isArray(a)&&(a=this.selectUrl(r,a)),a+r},setMap:function(){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments),this.tileOrigin||(this.tileOrigin=new OpenLayers.LonLat(this.map.maxExtent.left,this.map.maxExtent.bottom))},CLASS_NAME:"OpenLayers.Layer.TMS"}),/* Copyright (c) 2006-2013 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WCSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.0",CLASS_NAME:"OpenLayers.Format.WCSCapabilities"}),/* Copyright (c) 2006-2013 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WCSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.XML,{regExes:{trimSpace:/^\s*|\s*$/g,splitSpace:/\s+/},defaultPrefix:"wcs",read:function(e){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e])),e&&9==e.nodeType&&(e=e.documentElement);var t={};return this.readNode(e,t),t},CLASS_NAME:"OpenLayers.Format.WCSCapabilities.v1"}),/* Copyright (c) 2006-2013 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WCSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.GML.v3,OpenLayers.Format.WCSCapabilities.v1,{namespaces:{wcs:"http://www.opengis.net/wcs",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",ows:"http://www.opengis.net/ows"},errorProperty:"serviceIdentification",readers:{wcs:{WCS_Capabilities:function(e,t){this.readChildNodes(e,t)},Service:function(e,t){var i={};this.readChildNodes(e,i);var s=i.serviceContact.providerName;i.serviceContact.providerName=void 0,t.serviceProvider={providerName:s,serviceContact:i.serviceContact},i.serviceContact=void 0,t.serviceIdentification=i},keywords:function(e,t){t.keywords=[],this.readChildNodes(e,t.keywords)},keyword:function(e,t){t.push(this.getChildValue(e))},responsibleParty:function(e,t){t.serviceContact={},this.readChildNodes(e,t.serviceContact)},individualName:function(e,t){t.individualName=this.getChildValue(e)},organisationName:function(e,t){t.providerName=this.getChildValue(e)},positionName:function(e,t){t.positionName=this.getChildValue(e)},contactInfo:function(e,t){t.contactInfo={},this.readChildNodes(e,t.contactInfo)},phone:function(e,t){t.phone={},this.readChildNodes(e,t.phone)},voice:function(e,t){t.voice=this.getChildValue(e)},facsimile:function(e,t){t.facsimile=this.getChildValue(e)},address:function(e,t){t.address={},this.readChildNodes(e,t.address)},deliveryPoint:function(e,t){t.deliveryPoint=this.getChildValue(e)},city:function(e,t){t.city=this.getChildValue(e)},postalCode:function(e,t){t.postalCode=this.getChildValue(e)},country:function(e,t){t.country=this.getChildValue(e)},electronicMailAddress:function(e,t){t.electronicMailAddress=this.getChildValue(e)},fees:function(e,t){t.fees=this.getChildValue(e)},accessConstraints:function(e,t){t.accessConstraints=this.getChildValue(e)},ContentMetadata:function(e,t){t.contentMetadata=[],this.readChildNodes(e,t.contentMetadata)},CoverageOfferingBrief:function(e,t){var i={};this.readChildNodes(e,i),t.push(i)},name:function(e,t){"Service"===e.parentNode.nodeName?t.title=this.getChildValue(e):t.identifier=this.getChildValue(e)},label:function(e,t){"Service"===e.parentNode.nodeName?t.abstract=this.getChildValue(e):t.title=this.getChildValue(e)},lonLatEnvelope:function(e,t){var i=this.getElementsByTagNameNS(e,"http://www.opengis.net/gml","pos");if(2==i.length){var s={},n={};this.xy=!0,this.readers.gml.pos.apply(this,[i[0],s]),this.readers.gml.pos.apply(this,[i[1],n]),t.lonLatEnvelope={},t.lonLatEnvelope.srsName=e.getAttribute("srsName"),t.lonLatEnvelope.min=s.points[0],t.lonLatEnvelope.max=n.points[0]}}},gml:OpenLayers.Format.GML.v3.prototype.readers.gml},CLASS_NAME:"OpenLayers.Format.WCSCapabilities.v1_0_0"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Strategy.Fixed=OpenLayers.Class(OpenLayers.Strategy,{preload:!1,activate:function(){return OpenLayers.Strategy.prototype.activate.apply(this,arguments)?(this.layer.events.on({refresh:this.load,scope:this}),1==this.layer.visibility||this.preload?this.load():this.layer.events.on({visibilitychanged:this.load,scope:this}),!0):!1},deactivate:function(){var e=OpenLayers.Strategy.prototype.deactivate.call(this);return e&&this.layer.events.un({refresh:this.load,visibilitychanged:this.load,scope:this}),e},load:function(e){var t=this.layer;t.events.triggerEvent("loadstart"),t.protocol.read(OpenLayers.Util.applyDefaults({callback:OpenLayers.Function.bind(this.merge,this,t.map.getProjectionObject()),filter:t.filter},e)),t.events.un({visibilitychanged:this.load,scope:this})},merge:function(e,t){var i=this.layer;i.destroyFeatures();var s=t.features;if(s&&s.length>0){if(!e.equals(i.projection))for(var n,r=0,a=s.length;a>r;++r)n=s[r].geometry,n&&n.transform(i.projection,e);i.addFeatures(s)}i.events.triggerEvent("loadend")},CLASS_NAME:"OpenLayers.Strategy.Fixed"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.Zoom=OpenLayers.Class(OpenLayers.Control,{zoomInText:"+",zoomInId:"olZoomInLink",zoomOutText:"-",zoomOutId:"olZoomOutLink",draw:function(){var e=OpenLayers.Control.prototype.draw.apply(this),t=this.getOrCreateLinks(e),i=t.zoomIn,s=t.zoomOut,n=this.map.events;return s.parentNode!==e&&(n=this.events,n.attachToElement(s.parentNode)),n.register("buttonclick",this,this.onZoomClick),this.zoomInLink=i,this.zoomOutLink=s,e},getOrCreateLinks:function(e){var t=document.getElementById(this.zoomInId),i=document.getElementById(this.zoomOutId);return t||(t=document.createElement("a"),t.href="#zoomIn",t.appendChild(document.createTextNode(this.zoomInText)),t.className="olControlZoomIn",e.appendChild(t)),OpenLayers.Element.addClass(t,"olButton"),i||(i=document.createElement("a"),i.href="#zoomOut",i.appendChild(document.createTextNode(this.zoomOutText)),i.className="olControlZoomOut",e.appendChild(i)),OpenLayers.Element.addClass(i,"olButton"),{zoomIn:t,zoomOut:i}},onZoomClick:function(e){var t=e.buttonElement;t===this.zoomInLink?this.map.zoomIn():t===this.zoomOutLink&&this.map.zoomOut()},destroy:function(){this.map&&this.map.events.unregister("buttonclick",this,this.onZoomClick),delete this.zoomInLink,delete this.zoomOutLink,OpenLayers.Control.prototype.destroy.apply(this)},CLASS_NAME:"OpenLayers.Control.Zoom"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.PointTrack=OpenLayers.Class(OpenLayers.Layer.Vector,{dataFrom:null,styleFrom:null,addNodes:function(e,t){if(e.length<2)throw new Error("At least two point features have to be added to create a line from");for(var i,s,n,r=new Array(e.length-1),a=0,o=e.length;o>a;a++){if(i=e[a],n=i.geometry){if("OpenLayers.Geometry.Point"!=n.CLASS_NAME)throw new TypeError("Only features with point geometries are supported.")}else{var l=i.lonlat;n=new OpenLayers.Geometry.Point(l.lon,l.lat)}if(a>0){var h=null!=this.dataFrom?e[a+this.dataFrom].data||e[a+this.dataFrom].attributes:null,u=null!=this.styleFrom?e[a+this.styleFrom].style:null,c=new OpenLayers.Geometry.LineString([s,n]);r[a-1]=new OpenLayers.Feature.Vector(c,h,u)}s=n}this.addFeatures(r,t)},CLASS_NAME:"OpenLayers.Layer.PointTrack"}),OpenLayers.Layer.PointTrack.SOURCE_NODE=-1,OpenLayers.Layer.PointTrack.TARGET_NODE=0,OpenLayers.Layer.PointTrack.dataFrom={SOURCE_NODE:-1,TARGET_NODE:0},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Protocol.WFS=function(e){e=OpenLayers.Util.applyDefaults(e,OpenLayers.Protocol.WFS.DEFAULTS);var t=OpenLayers.Protocol.WFS["v"+e.version.replace(/\./g,"_")];if(!t)throw"Unsupported WFS version: "+e.version;return new t(e)},OpenLayers.Protocol.WFS.fromWMSLayer=function(e,t){var i,s,n=e.params.LAYERS,r=(OpenLayers.Util.isArray(n)?n[0]:n).split(":");r.length>1&&(s=r[0]),i=r.pop();var a={url:e.url,featureType:i,featurePrefix:s,srsName:e.projection&&e.projection.getCode()||e.map&&e.map.getProjectionObject().getCode(),version:"1.1.0"};return new OpenLayers.Protocol.WFS(OpenLayers.Util.applyDefaults(t,a))},OpenLayers.Protocol.WFS.DEFAULTS={version:"1.0.0"},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.Markers=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!1,markers:null,drawn:!1,initialize:function(){OpenLayers.Layer.prototype.initialize.apply(this,arguments),this.markers=[]},destroy:function(){this.clearMarkers(),this.markers=null,OpenLayers.Layer.prototype.destroy.apply(this,arguments)},setOpacity:function(e){if(e!=this.opacity){this.opacity=e;for(var t=0,i=this.markers.length;i>t;t++)this.markers[t].setOpacity(this.opacity)}},moveTo:function(e,t){if(OpenLayers.Layer.prototype.moveTo.apply(this,arguments),t||!this.drawn){for(var i=0,s=this.markers.length;s>i;i++)this.drawMarker(this.markers[i]);this.drawn=!0}},addMarker:function(e){this.markers.push(e),this.opacity<1&&e.setOpacity(this.opacity),this.map&&this.map.getExtent()&&(e.map=this.map,this.drawMarker(e))},removeMarker:function(e){this.markers&&this.markers.length&&(OpenLayers.Util.removeItem(this.markers,e),e.erase())},clearMarkers:function(){if(null!=this.markers)for(;this.markers.length>0;)this.removeMarker(this.markers[0])},drawMarker:function(e){var t=this.map.getLayerPxFromLonLat(e.lonlat);if(null==t)e.display(!1);else if(e.isDrawn())e.icon&&e.icon.moveTo(t);else{var i=e.draw(t);this.div.appendChild(i)}},getDataExtent:function(){var e=null;if(this.markers&&this.markers.length>0)for(var e=new OpenLayers.Bounds,t=0,i=this.markers.length;i>t;t++){var s=this.markers[t];e.extend(s.lonlat)}return e},CLASS_NAME:"OpenLayers.Layer.Markers"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.Pan=OpenLayers.Class(OpenLayers.Control,{slideFactor:50,slideRatio:null,direction:null,type:OpenLayers.Control.TYPE_BUTTON,initialize:function(e,t){this.direction=e,this.CLASS_NAME+=this.direction,OpenLayers.Control.prototype.initialize.apply(this,[t])},trigger:function(){var e=OpenLayers.Function.bind(function(e){return this.slideRatio?this.map.getSize()[e]*this.slideRatio:this.slideFactor},this);switch(this.direction){case OpenLayers.Control.Pan.NORTH:this.map.pan(0,-e("h"));break;case OpenLayers.Control.Pan.SOUTH:this.map.pan(0,e("h"));break;case OpenLayers.Control.Pan.WEST:this.map.pan(-e("w"),0);break;case OpenLayers.Control.Pan.EAST:this.map.pan(e("w"),0)}},CLASS_NAME:"OpenLayers.Control.Pan"}),OpenLayers.Control.Pan.NORTH="North",OpenLayers.Control.Pan.SOUTH="South",OpenLayers.Control.Pan.EAST="East",OpenLayers.Control.Pan.WEST="West",/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.CSWGetDomain=function(e){e=OpenLayers.Util.applyDefaults(e,OpenLayers.Format.CSWGetDomain.DEFAULTS);var t=OpenLayers.Format.CSWGetDomain["v"+e.version.replace(/\./g,"_")];if(!t)throw"Unsupported CSWGetDomain version: "+e.version;return new t(e)},OpenLayers.Format.CSWGetDomain.DEFAULTS={version:"2.0.2"},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.CSWGetDomain.v2_0_2=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",csw:"http://www.opengis.net/cat/csw/2.0.2"},defaultPrefix:"csw",version:"2.0.2",schemaLocation:"http://www.opengis.net/cat/csw/2.0.2 http://schemas.opengis.net/csw/2.0.2/CSW-discovery.xsd",PropertyName:null,ParameterName:null,read:function(e){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e])),e&&9==e.nodeType&&(e=e.documentElement);var t={};return this.readNode(e,t),t},readers:{csw:{GetDomainResponse:function(e,t){this.readChildNodes(e,t)},DomainValues:function(e,t){OpenLayers.Util.isArray(t.DomainValues)||(t.DomainValues=[]);for(var i=e.attributes,s={},n=0,r=i.length;r>n;++n)s[i[n].name]=i[n].nodeValue;this.readChildNodes(e,s),t.DomainValues.push(s)},PropertyName:function(e,t){t.PropertyName=this.getChildValue(e)},ParameterName:function(e,t){t.ParameterName=this.getChildValue(e)},ListOfValues:function(e,t){OpenLayers.Util.isArray(t.ListOfValues)||(t.ListOfValues=[]),this.readChildNodes(e,t.ListOfValues)},Value:function(e,t){for(var i=e.attributes,s={},n=0,r=i.length;r>n;++n)s[i[n].name]=i[n].nodeValue;s.value=this.getChildValue(e),t.push({Value:s})},ConceptualScheme:function(e,t){t.ConceptualScheme={},this.readChildNodes(e,t.ConceptualScheme)},Name:function(e,t){t.Name=this.getChildValue(e)},Document:function(e,t){t.Document=this.getChildValue(e)},Authority:function(e,t){t.Authority=this.getChildValue(e)},RangeOfValues:function(e,t){t.RangeOfValues={},this.readChildNodes(e,t.RangeOfValues)},MinValue:function(e,t){for(var i=e.attributes,s={},n=0,r=i.length;r>n;++n)s[i[n].name]=i[n].nodeValue;s.value=this.getChildValue(e),t.MinValue=s},MaxValue:function(e,t){for(var i=e.attributes,s={},n=0,r=i.length;r>n;++n)s[i[n].name]=i[n].nodeValue;s.value=this.getChildValue(e),t.MaxValue=s}}},write:function(e){var t=this.writeNode("csw:GetDomain",e);return OpenLayers.Format.XML.prototype.write.apply(this,[t])},writers:{csw:{GetDomain:function(e){var t=this.createElementNSPlus("csw:GetDomain",{attributes:{service:"CSW",version:this.version}});return e.PropertyName||this.PropertyName?this.writeNode("csw:PropertyName",e.PropertyName||this.PropertyName,t):(e.ParameterName||this.ParameterName)&&this.writeNode("csw:ParameterName",e.ParameterName||this.ParameterName,t),this.readChildNodes(t,e),t},PropertyName:function(e){var t=this.createElementNSPlus("csw:PropertyName",{value:e});return t},ParameterName:function(e){var t=this.createElementNSPlus("csw:ParameterName",{value:e});return t}}},CLASS_NAME:"OpenLayers.Format.CSWGetDomain.v2_0_2"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.ArcXML.Features=OpenLayers.Class(OpenLayers.Format.XML,{read:function(e){var t=new OpenLayers.Format.ArcXML,i=t.read(e);return i.features.feature}}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.Snapping=OpenLayers.Class(OpenLayers.Control,{DEFAULTS:{tolerance:10,node:!0,edge:!0,vertex:!0},greedy:!0,precedence:["node","vertex","edge"],resolution:null,geoToleranceCache:null,layer:null,feature:null,point:null,initialize:function(e){OpenLayers.Control.prototype.initialize.apply(this,[e]),this.options=e||{},this.options.layer&&this.setLayer(this.options.layer);var t=OpenLayers.Util.extend({},this.options.defaults);this.defaults=OpenLayers.Util.applyDefaults(t,this.DEFAULTS),this.setTargets(this.options.targets),0===this.targets.length&&this.layer&&this.addTargetLayer(this.layer),this.geoToleranceCache={}},setLayer:function(e){this.active?(this.deactivate(),this.layer=e,this.activate()):this.layer=e},setTargets:function(e){if(this.targets=[],e&&e.length)for(var t,i=0,s=e.length;s>i;++i)t=e[i],t instanceof OpenLayers.Layer.Vector?this.addTargetLayer(t):this.addTarget(t)},addTargetLayer:function(e){this.addTarget({layer:e})},addTarget:function(e){e=OpenLayers.Util.applyDefaults(e,this.defaults),e.nodeTolerance=e.nodeTolerance||e.tolerance,e.vertexTolerance=e.vertexTolerance||e.tolerance,e.edgeTolerance=e.edgeTolerance||e.tolerance,this.targets.push(e)},removeTargetLayer:function(e){for(var t,i=this.targets.length-1;i>=0;--i)t=this.targets[i],t.layer===e&&this.removeTarget(t)},removeTarget:function(e){return OpenLayers.Util.removeItem(this.targets,e)},activate:function(){var e=OpenLayers.Control.prototype.activate.call(this);return e&&this.layer&&this.layer.events&&this.layer.events.on({sketchstarted:this.onSketchModified,sketchmodified:this.onSketchModified,vertexmodified:this.onVertexModified,scope:this}),e},deactivate:function(){var e=OpenLayers.Control.prototype.deactivate.call(this);return e&&this.layer&&this.layer.events&&this.layer.events.un({sketchstarted:this.onSketchModified,sketchmodified:this.onSketchModified,vertexmodified:this.onVertexModified,scope:this}),this.feature=null,this.point=null,e},onSketchModified:function(e){this.feature=e.feature,this.considerSnapping(e.vertex,e.vertex)},onVertexModified:function(e){this.feature=e.feature;var t=this.layer.map.getLonLatFromViewPortPx(e.pixel);this.considerSnapping(e.vertex,new OpenLayers.Geometry.Point(t.lon,t.lat))},considerSnapping:function(e,t){for(var i,s,n={rank:Number.POSITIVE_INFINITY,dist:Number.POSITIVE_INFINITY,x:null,y:null},r=!1,a=0,o=this.targets.length;o>a;++a)if(s=this.targets[a],i=this.testTarget(s,t)){if(this.greedy){n=i,n.target=s,r=!0;break}(i.rank<n.rank||i.rank===n.rank&&i.dist<n.dist)&&(n=i,n.target=s,r=!0)}if(r){var l=this.events.triggerEvent("beforesnap",{point:e,x:n.x,y:n.y,distance:n.dist,layer:n.target.layer,snapType:this.precedence[n.rank]});l!==!1?(e.x=n.x,e.y=n.y,this.point=e,this.events.triggerEvent("snap",{point:e,snapType:this.precedence[n.rank],layer:n.target.layer,distance:n.dist})):r=!1}this.point&&!r&&(e.x=t.x,e.y=t.y,this.point=null,this.events.triggerEvent("unsnap",{point:e}))},testTarget:function(e,t){var i=this.layer.map.getResolution();if("minResolution"in e&&i<e.minResolution)return null;if("maxResolution"in e&&i>=e.maxResolution)return null;for(var s,n,r,a,o,l,h,u={node:this.getGeoTolerance(e.nodeTolerance,i),vertex:this.getGeoTolerance(e.vertexTolerance,i),edge:this.getGeoTolerance(e.edgeTolerance,i)},c=Math.max(u.node,u.vertex,u.edge),d={rank:Number.POSITIVE_INFINITY,dist:Number.POSITIVE_INFINITY},p=!1,f=e.layer.features,m=this.precedence.length,y=new OpenLayers.LonLat(t.x,t.y),g=0,v=f.length;v>g;++g)if(s=f[g],s!==this.feature&&!s._sketch&&s.state!==OpenLayers.State.DELETE&&(!e.filter||e.filter.evaluate(s))&&s.atPoint(y,c,c))for(var x=0,E=Math.min(d.rank+1,m);E>x;++x)if(n=this.precedence[x],e[n])if("edge"===n){if(o=s.geometry.distanceTo(t,{details:!0}),l=o.distance,l<=u[n]&&l<d.dist){d={rank:x,dist:l,x:o.x0,y:o.y0},p=!0;break}}else{r=s.geometry.getVertices("node"===n),h=!1;for(var b=0,L=r.length;L>b;++b)a=r[b],l=a.distanceTo(t),l<=u[n]&&(x<d.rank||x===d.rank&&l<d.dist)&&(d={rank:x,dist:l,x:a.x,y:a.y},p=!0,h=!0);if(h)break}return p?d:null},getGeoTolerance:function(e,t){t!==this.resolution&&(this.resolution=t,this.geoToleranceCache={});var i=this.geoToleranceCache[e];return void 0===i&&(i=e*t,this.geoToleranceCache[e]=i),i},destroy:function(){this.active&&this.deactivate(),delete this.layer,delete this.targets,OpenLayers.Control.prototype.destroy.call(this)},CLASS_NAME:"OpenLayers.Control.Snapping"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.Boxes=OpenLayers.Class(OpenLayers.Layer.Markers,{drawMarker:function(e){var t=this.map.getLayerPxFromLonLat({lon:e.bounds.left,lat:e.bounds.top}),i=this.map.getLayerPxFromLonLat({lon:e.bounds.right,lat:e.bounds.bottom});if(null==i||null==t)e.display(!1);else{var s=e.draw(t,{w:Math.max(1,i.x-t.x),h:Math.max(1,i.y-t.y)});e.drawn||(this.div.appendChild(s),e.drawn=!0)}},removeMarker:function(e){OpenLayers.Util.removeItem(this.markers,e),null!=e.div&&e.div.parentNode==this.div&&this.div.removeChild(e.div)},CLASS_NAME:"OpenLayers.Layer.Boxes"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WMSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.1",profile:null,CLASS_NAME:"OpenLayers.Format.WMSCapabilities"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WMSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{wms:"http://www.opengis.net/wms",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"wms",read:function(e){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e]));var t=e;e&&9==e.nodeType&&(e=e.documentElement);var i={};if(this.readNode(e,i),void 0===i.service){var s=new OpenLayers.Format.OGCExceptionReport;i.error=s.read(t)}return i},readers:{wms:{Service:function(e,t){t.service={},this.readChildNodes(e,t.service)},Name:function(e,t){t.name=this.getChildValue(e)},Title:function(e,t){t.title=this.getChildValue(e)},Abstract:function(e,t){t["abstract"]=this.getChildValue(e)},BoundingBox:function(e){var t={};t.bbox=[parseFloat(e.getAttribute("minx")),parseFloat(e.getAttribute("miny")),parseFloat(e.getAttribute("maxx")),parseFloat(e.getAttribute("maxy"))];var i={x:parseFloat(e.getAttribute("resx")),y:parseFloat(e.getAttribute("resy"))};return isNaN(i.x)&&isNaN(i.y)||(t.res=i),t},OnlineResource:function(e,t){t.href=this.getAttributeNS(e,this.namespaces.xlink,"href")},ContactInformation:function(e,t){t.contactInformation={},this.readChildNodes(e,t.contactInformation)},ContactPersonPrimary:function(e,t){t.personPrimary={},this.readChildNodes(e,t.personPrimary)},ContactPerson:function(e,t){t.person=this.getChildValue(e)},ContactOrganization:function(e,t){t.organization=this.getChildValue(e)},ContactPosition:function(e,t){t.position=this.getChildValue(e)},ContactAddress:function(e,t){t.contactAddress={},this.readChildNodes(e,t.contactAddress)},AddressType:function(e,t){t.type=this.getChildValue(e)},Address:function(e,t){t.address=this.getChildValue(e)},City:function(e,t){t.city=this.getChildValue(e)},StateOrProvince:function(e,t){t.stateOrProvince=this.getChildValue(e)},PostCode:function(e,t){t.postcode=this.getChildValue(e)},Country:function(e,t){t.country=this.getChildValue(e)},ContactVoiceTelephone:function(e,t){t.phone=this.getChildValue(e)},ContactFacsimileTelephone:function(e,t){t.fax=this.getChildValue(e)},ContactElectronicMailAddress:function(e,t){t.email=this.getChildValue(e)},Fees:function(e,t){var i=this.getChildValue(e);i&&"none"!=i.toLowerCase()&&(t.fees=i)},AccessConstraints:function(e,t){var i=this.getChildValue(e);i&&"none"!=i.toLowerCase()&&(t.accessConstraints=i)},Capability:function(e,t){t.capability={nestedLayers:[],layers:[]},this.readChildNodes(e,t.capability)},Request:function(e,t){t.request={},this.readChildNodes(e,t.request)},GetCapabilities:function(e,t){t.getcapabilities={formats:[]},this.readChildNodes(e,t.getcapabilities)},Format:function(e,t){OpenLayers.Util.isArray(t.formats)?t.formats.push(this.getChildValue(e)):t.format=this.getChildValue(e)},DCPType:function(e,t){this.readChildNodes(e,t)},HTTP:function(e,t){this.readChildNodes(e,t)},Get:function(e,t){t.get={},this.readChildNodes(e,t.get),t.href||(t.href=t.get.href)},Post:function(e,t){t.post={},this.readChildNodes(e,t.post),t.href||(t.href=t.get.href)},GetMap:function(e,t){t.getmap={formats:[]},this.readChildNodes(e,t.getmap)},GetFeatureInfo:function(e,t){t.getfeatureinfo={formats:[]},this.readChildNodes(e,t.getfeatureinfo)},Exception:function(e,t){t.exception={formats:[]},this.readChildNodes(e,t.exception)},Layer:function(e,t){var i,s;t.capability?(s=t.capability,i=t):s=t;var n=e.getAttributeNode("queryable"),r=n&&n.specified?e.getAttribute("queryable"):null;n=e.getAttributeNode("cascaded");var a=n&&n.specified?e.getAttribute("cascaded"):null;n=e.getAttributeNode("opaque");var o=n&&n.specified?e.getAttribute("opaque"):null,l=e.getAttribute("noSubsets"),h=e.getAttribute("fixedWidth"),u=e.getAttribute("fixedHeight"),c=i||{},d=OpenLayers.Util.extend,p={nestedLayers:[],styles:i?[].concat(i.styles):[],srs:i?d({},c.srs):{},metadataURLs:[],bbox:i?d({},c.bbox):{},llbbox:c.llbbox,dimensions:i?d({},c.dimensions):{},authorityURLs:i?d({},c.authorityURLs):{},identifiers:{},keywords:[],queryable:r&&""!==r?"1"===r||"true"===r:c.queryable||!1,cascaded:null!==a?parseInt(a):c.cascaded||0,opaque:o?"1"===o||"true"===o:c.opaque||!1,noSubsets:null!==l?"1"===l||"true"===l:c.noSubsets||!1,fixedWidth:null!=h?parseInt(h):c.fixedWidth||0,fixedHeight:null!=u?parseInt(u):c.fixedHeight||0,minScale:c.minScale,maxScale:c.maxScale,attribution:c.attribution};if(t.nestedLayers.push(p),p.capability=s,this.readChildNodes(e,p),delete p.capability,p.name){var f=p.name.split(":"),m=s.request,y=m.getfeatureinfo;f.length>0&&(p.prefix=f[0]),s.layers.push(p),void 0===p.formats&&(p.formats=m.getmap.formats),void 0===p.infoFormats&&y&&(p.infoFormats=y.formats)}},Attribution:function(e,t){t.attribution={},this.readChildNodes(e,t.attribution)},LogoURL:function(e,t){t.logo={width:e.getAttribute("width"),height:e.getAttribute("height")},this.readChildNodes(e,t.logo)},Style:function(e,t){var i={};t.styles.push(i),this.readChildNodes(e,i)},LegendURL:function(e,t){var i={width:e.getAttribute("width"),height:e.getAttribute("height")};t.legend=i,this.readChildNodes(e,i)},MetadataURL:function(e,t){var i={type:e.getAttribute("type")};t.metadataURLs.push(i),this.readChildNodes(e,i)},DataURL:function(e,t){t.dataURL={},this.readChildNodes(e,t.dataURL)},FeatureListURL:function(e,t){t.featureListURL={},this.readChildNodes(e,t.featureListURL)},AuthorityURL:function(e,t){var i=e.getAttribute("name"),s={};this.readChildNodes(e,s),t.authorityURLs[i]=s.href},Identifier:function(e,t){var i=e.getAttribute("authority");t.identifiers[i]=this.getChildValue(e)},KeywordList:function(e,t){this.readChildNodes(e,t)},SRS:function(e,t){t.srs[this.getChildValue(e)]=!0}}},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WMSCapabilities.v1_1=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1,{readers:{wms:OpenLayers.Util.applyDefaults({WMT_MS_Capabilities:function(e,t){this.readChildNodes(e,t)},Keyword:function(e,t){t.keywords&&t.keywords.push(this.getChildValue(e))},DescribeLayer:function(e,t){t.describelayer={formats:[]},this.readChildNodes(e,t.describelayer)},GetLegendGraphic:function(e,t){t.getlegendgraphic={formats:[]},this.readChildNodes(e,t.getlegendgraphic)},GetStyles:function(e,t){t.getstyles={formats:[]},this.readChildNodes(e,t.getstyles)},PutStyles:function(e,t){t.putstyles={formats:[]},this.readChildNodes(e,t.putstyles)},UserDefinedSymbolization:function(e,t){var i={supportSLD:1==parseInt(e.getAttribute("SupportSLD")),userLayer:1==parseInt(e.getAttribute("UserLayer")),userStyle:1==parseInt(e.getAttribute("UserStyle")),remoteWFS:1==parseInt(e.getAttribute("RemoteWFS"))};t.userSymbols=i},LatLonBoundingBox:function(e,t){t.llbbox=[parseFloat(e.getAttribute("minx")),parseFloat(e.getAttribute("miny")),parseFloat(e.getAttribute("maxx")),parseFloat(e.getAttribute("maxy"))]},BoundingBox:function(e,t){var i=OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms.BoundingBox.apply(this,[e,t]);i.srs=e.getAttribute("SRS"),t.bbox[i.srs]=i},ScaleHint:function(e,t){var i=e.getAttribute("min"),s=e.getAttribute("max"),n=Math.pow(2,.5),r=OpenLayers.INCHES_PER_UNIT.m;t.maxScale=parseFloat((i/n*r*OpenLayers.DOTS_PER_INCH).toPrecision(13)),t.minScale=parseFloat((s/n*r*OpenLayers.DOTS_PER_INCH).toPrecision(13))},Dimension:function(e,t){var i=e.getAttribute("name").toLowerCase(),s={name:i,units:e.getAttribute("units"),unitsymbol:e.getAttribute("unitSymbol")};t.dimensions[s.name]=s},Extent:function(e,t){var i=e.getAttribute("name").toLowerCase();if(i in t.dimensions){var s=t.dimensions[i];s.nearestVal="1"===e.getAttribute("nearestValue"),s.multipleVal="1"===e.getAttribute("multipleValues"),s.current="1"===e.getAttribute("current"),s["default"]=e.getAttribute("default")||"";var n=this.getChildValue(e);s.values=n.split(",")}}},OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WMSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,{version:"1.1.0",readers:{wms:OpenLayers.Util.applyDefaults({SRS:function(e,t){for(var i=this.getChildValue(e),s=i.split(/ +/),n=0,r=s.length;r>n;n++)t.srs[s[n]]=!0}},OpenLayers.Format.WMSCapabilities.v1_1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_0"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Strategy.BBOX=OpenLayers.Class(OpenLayers.Strategy,{bounds:null,resolution:null,ratio:2,resFactor:null,response:null,activate:function(){var e=OpenLayers.Strategy.prototype.activate.call(this);return e&&(this.layer.events.on({moveend:this.update,refresh:this.update,visibilitychanged:this.update,scope:this}),this.update()),e},deactivate:function(){var e=OpenLayers.Strategy.prototype.deactivate.call(this);return e&&this.layer.events.un({moveend:this.update,refresh:this.update,visibilitychanged:this.update,scope:this}),e},update:function(e){var t=this.getMapBounds();null!==t&&(e&&e.force||this.layer.visibility&&this.layer.calculateInRange()&&this.invalidBounds(t))&&(this.calculateBounds(t),this.resolution=this.layer.map.getResolution(),this.triggerRead(e))},getMapBounds:function(){if(null===this.layer.map)return null;var e=this.layer.map.getExtent();return e&&!this.layer.projection.equals(this.layer.map.getProjectionObject())&&(e=e.clone().transform(this.layer.map.getProjectionObject(),this.layer.projection)),e},invalidBounds:function(e){e||(e=this.getMapBounds());var t=!this.bounds||!this.bounds.containsBounds(e);if(!t&&this.resFactor){var i=this.resolution/this.layer.map.getResolution();t=i>=this.resFactor||i<=1/this.resFactor}return t},calculateBounds:function(e){e||(e=this.getMapBounds());var t=e.getCenterLonLat(),i=e.getWidth()*this.ratio,s=e.getHeight()*this.ratio;this.bounds=new OpenLayers.Bounds(t.lon-i/2,t.lat-s/2,t.lon+i/2,t.lat+s/2)},triggerRead:function(e){!this.response||e&&e.noAbort===!0||(this.layer.protocol.abort(this.response),this.layer.events.triggerEvent("loadend")),this.layer.events.triggerEvent("loadstart"),this.response=this.layer.protocol.read(OpenLayers.Util.applyDefaults({filter:this.createFilter(),callback:this.merge,scope:this},e))},createFilter:function(){var e=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,value:this.bounds,projection:this.layer.projection});return this.layer.filter&&(e=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,filters:[this.layer.filter,e]})),e},merge:function(e){this.layer.destroyFeatures();var t=e.features;if(t&&t.length>0){var i=this.layer.projection,s=this.layer.map.getProjectionObject();if(!s.equals(i))for(var n,r=0,a=t.length;a>r;++r)n=t[r].geometry,n&&n.transform(i,s);this.layer.addFeatures(t)}this.response=null,this.layer.events.triggerEvent("loadend")},CLASS_NAME:"OpenLayers.Strategy.BBOX"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.SLD.v1_0_0_GeoServer=OpenLayers.Class(OpenLayers.Format.SLD.v1_0_0,{version:"1.0.0",profile:"GeoServer",readers:OpenLayers.Util.applyDefaults({sld:OpenLayers.Util.applyDefaults({Priority:function(e,t){var i=this.readers.ogc._expression.call(this,e);i&&(t.priority=i)},VendorOption:function(e,t){t.vendorOptions||(t.vendorOptions={}),t.vendorOptions[e.getAttribute("name")]=this.getChildValue(e)}},OpenLayers.Format.SLD.v1_0_0.prototype.readers.sld)},OpenLayers.Format.SLD.v1_0_0.prototype.readers),writers:OpenLayers.Util.applyDefaults({sld:OpenLayers.Util.applyDefaults({Priority:function(e){return this.writers.sld._OGCExpression.call(this,"sld:Priority",e)},VendorOption:function(e){return this.createElementNSPlus("sld:VendorOption",{attributes:{name:e.name},value:e.value})},TextSymbolizer:function(e){var t=OpenLayers.Format.SLD.v1_0_0.prototype.writers,i=t.sld.TextSymbolizer.apply(this,arguments);return e.graphic!==!1&&(e.externalGraphic||e.graphicName)&&this.writeNode("Graphic",e,i),"priority"in e&&this.writeNode("Priority",e.priority,i),this.addVendorOptions(i,e)},PointSymbolizer:function(e){var t=OpenLayers.Format.SLD.v1_0_0.prototype.writers,i=t.sld.PointSymbolizer.apply(this,arguments);return this.addVendorOptions(i,e)},LineSymbolizer:function(e){var t=OpenLayers.Format.SLD.v1_0_0.prototype.writers,i=t.sld.LineSymbolizer.apply(this,arguments);return this.addVendorOptions(i,e)},PolygonSymbolizer:function(e){var t=OpenLayers.Format.SLD.v1_0_0.prototype.writers,i=t.sld.PolygonSymbolizer.apply(this,arguments);return this.addVendorOptions(i,e)}},OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld)},OpenLayers.Format.SLD.v1_0_0.prototype.writers),addVendorOptions:function(e,t){var i=t.vendorOptions;if(i)for(var s in t.vendorOptions)this.writeNode("VendorOption",{name:s,value:t.vendorOptions[s]},e);return e},CLASS_NAME:"OpenLayers.Format.SLD.v1_0_0_GeoServer"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Handler.Point=OpenLayers.Class(OpenLayers.Handler,{point:null,layer:null,multi:!1,citeCompliant:!1,mouseDown:!1,stoppedDown:null,lastDown:null,lastUp:null,persist:!1,stopDown:!1,stopUp:!1,layerOptions:null,pixelTolerance:5,touch:!1,lastTouchPx:null,initialize:function(e,t,i){i&&i.layerOptions&&i.layerOptions.styleMap||(this.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style["default"],{})),OpenLayers.Handler.prototype.initialize.apply(this,arguments)},activate:function(){if(!OpenLayers.Handler.prototype.activate.apply(this,arguments))return!1;var e=OpenLayers.Util.extend({displayInLayerSwitcher:!1,calculateInRange:OpenLayers.Function.True,wrapDateLine:this.citeCompliant},this.layerOptions);return this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,e),this.map.addLayer(this.layer),!0},createFeature:function(e){var t=this.layer.getLonLatFromViewPortPx(e),i=new OpenLayers.Geometry.Point(t.lon,t.lat);this.point=new OpenLayers.Feature.Vector(i),this.callback("create",[this.point.geometry,this.point]),this.point.geometry.clearBounds(),this.layer.addFeatures([this.point],{silent:!0})},deactivate:function(){return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)?(this.cancel(),null!=this.layer.map&&(this.destroyFeature(!0),this.layer.destroy(!1)),this.layer=null,this.touch=!1,!0):!1},destroyFeature:function(e){!this.layer||!e&&this.persist||this.layer.destroyFeatures(),this.point=null},destroyPersistedFeature:function(){var e=this.layer;e&&e.features.length>1&&this.layer.features[0].destroy()},finalize:function(e){var t=e?"cancel":"done";this.mouseDown=!1,this.lastDown=null,this.lastUp=null,this.lastTouchPx=null,this.callback(t,[this.geometryClone()]),this.destroyFeature(e)},cancel:function(){this.finalize(!0)},click:function(e){return OpenLayers.Event.stop(e),!1},dblclick:function(e){return OpenLayers.Event.stop(e),!1},modifyFeature:function(e){this.point||this.createFeature(e);var t=this.layer.getLonLatFromViewPortPx(e);this.point.geometry.x=t.lon,this.point.geometry.y=t.lat,this.callback("modify",[this.point.geometry,this.point,!1]),this.point.geometry.clearBounds(),this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.point,this.style)},getGeometry:function(){var e=this.point&&this.point.geometry;return e&&this.multi&&(e=new OpenLayers.Geometry.MultiPoint([e])),e},geometryClone:function(){var e=this.getGeometry();return e&&e.clone()},mousedown:function(e){return this.down(e)},touchstart:function(e){return this.touch||(this.touch=!0,this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,mousemove:this.mousemove,click:this.click,dblclick:this.dblclick,scope:this})),this.lastTouchPx=e.xy,this.down(e)},mousemove:function(e){return this.move(e)},touchmove:function(e){return this.lastTouchPx=e.xy,this.move(e)},mouseup:function(e){return this.up(e)},touchend:function(e){return e.xy=this.lastTouchPx,this.up(e)},down:function(e){return this.mouseDown=!0,this.lastDown=e.xy,this.touch||this.modifyFeature(e.xy),this.stoppedDown=this.stopDown,!this.stopDown},move:function(e){return this.touch||this.mouseDown&&!this.stoppedDown||this.modifyFeature(e.xy),!0},up:function(e){return this.mouseDown=!1,this.stoppedDown=this.stopDown,this.checkModifiers(e)?this.lastUp&&this.lastUp.equals(e.xy)?!0:this.lastDown&&this.passesTolerance(this.lastDown,e.xy,this.pixelTolerance)?(this.touch&&this.modifyFeature(e.xy),this.persist&&this.destroyPersistedFeature(),this.lastUp=e.xy,this.finalize(),!this.stopUp):!0:!0},mouseout:function(e){OpenLayers.Util.mouseLeft(e,this.map.viewPortDiv)&&(this.stoppedDown=this.stopDown,this.mouseDown=!1)},passesTolerance:function(e,t,i){var s=!0;if(null!=i&&e&&t){var n=e.distanceTo(t);n>i&&(s=!1)}return s},CLASS_NAME:"OpenLayers.Handler.Point"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Handler.Path=OpenLayers.Class(OpenLayers.Handler.Point,{line:null,maxVertices:null,doubleTouchTolerance:20,freehand:!1,freehandToggle:"shiftKey",timerId:null,redoStack:null,createFeature:function(e){var t=this.layer.getLonLatFromViewPortPx(e),i=new OpenLayers.Geometry.Point(t.lon,t.lat);this.point=new OpenLayers.Feature.Vector(i),this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([this.point.geometry])),this.callback("create",[this.point.geometry,this.getSketch()]),this.point.geometry.clearBounds(),this.layer.addFeatures([this.line,this.point],{silent:!0})},destroyFeature:function(e){OpenLayers.Handler.Point.prototype.destroyFeature.call(this,e),this.line=null},destroyPersistedFeature:function(){var e=this.layer;e&&e.features.length>2&&this.layer.features[0].destroy()},removePoint:function(){this.point&&this.layer.removeFeatures([this.point])},addPoint:function(e){this.layer.removeFeatures([this.point]);var t=this.layer.getLonLatFromViewPortPx(e);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(t.lon,t.lat)),this.line.geometry.addComponent(this.point.geometry,this.line.geometry.components.length),this.layer.addFeatures([this.point]),this.callback("point",[this.point.geometry,this.getGeometry()]),this.callback("modify",[this.point.geometry,this.getSketch()]),this.drawFeature(),delete this.redoStack},insertXY:function(e,t){this.line.geometry.addComponent(new OpenLayers.Geometry.Point(e,t),this.getCurrentPointIndex()),this.drawFeature(),delete this.redoStack},insertDeltaXY:function(e,t){var i=this.getCurrentPointIndex()-1,s=this.line.geometry.components[i];!s||isNaN(s.x)||isNaN(s.y)||this.insertXY(s.x+e,s.y+t)},insertDirectionLength:function(e,t){e*=Math.PI/180;var i=t*Math.cos(e),s=t*Math.sin(e);this.insertDeltaXY(i,s)},insertDeflectionLength:function(e,t){var i=this.getCurrentPointIndex()-1;if(i>0){var s=this.line.geometry.components[i],n=this.line.geometry.components[i-1],r=Math.atan2(s.y-n.y,s.x-n.x);this.insertDirectionLength(180*r/Math.PI+e,t)}},getCurrentPointIndex:function(){return this.line.geometry.components.length-1},undo:function(){var e=this.line.geometry,t=e.components,i=this.getCurrentPointIndex()-1,s=t[i],n=e.removeComponent(s);return n&&(this.redoStack||(this.redoStack=[]),this.redoStack.push(s),this.drawFeature()),n},redo:function(){var e=this.redoStack&&this.redoStack.pop();return e&&(this.line.geometry.addComponent(e,this.getCurrentPointIndex()),this.drawFeature()),!!e},freehandMode:function(e){return this.freehandToggle&&e[this.freehandToggle]?!this.freehand:this.freehand},modifyFeature:function(e,t){this.line||this.createFeature(e);var i=this.layer.getLonLatFromViewPortPx(e);this.point.geometry.x=i.lon,this.point.geometry.y=i.lat,this.callback("modify",[this.point.geometry,this.getSketch(),t]),this.point.geometry.clearBounds(),this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.line,this.style),this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.line},getGeometry:function(){var e=this.line&&this.line.geometry;return e&&this.multi&&(e=new OpenLayers.Geometry.MultiLineString([e])),e},touchstart:function(e){return this.timerId&&this.passesTolerance(this.lastTouchPx,e.xy,this.doubleTouchTolerance)?(this.finishGeometry(),window.clearTimeout(this.timerId),this.timerId=null,!1):(this.timerId&&(window.clearTimeout(this.timerId),this.timerId=null),this.timerId=window.setTimeout(OpenLayers.Function.bind(function(){this.timerId=null},this),300),OpenLayers.Handler.Point.prototype.touchstart.call(this,e))},down:function(e){var t=this.stopDown;return this.freehandMode(e)&&(t=!0,this.touch&&(this.modifyFeature(e.xy,!!this.lastUp),OpenLayers.Event.stop(e))),this.touch||this.lastDown&&this.passesTolerance(this.lastDown,e.xy,this.pixelTolerance)||this.modifyFeature(e.xy,!!this.lastUp),this.mouseDown=!0,this.lastDown=e.xy,this.stoppedDown=t,!t},move:function(e){return this.stoppedDown&&this.freehandMode(e)?(this.persist&&this.destroyPersistedFeature(),this.maxVertices&&this.line&&this.line.geometry.components.length===this.maxVertices?(this.removePoint(),this.finalize()):this.addPoint(e.xy),!1):(this.touch||this.mouseDown&&!this.stoppedDown||this.modifyFeature(e.xy,!!this.lastUp),!0)},up:function(e){return!this.mouseDown||this.lastUp&&this.lastUp.equals(e.xy)||(this.stoppedDown&&this.freehandMode(e)?(this.persist&&this.destroyPersistedFeature(),this.removePoint(),this.finalize()):this.passesTolerance(this.lastDown,e.xy,this.pixelTolerance)&&(this.touch&&this.modifyFeature(e.xy),null==this.lastUp&&this.persist&&this.destroyPersistedFeature(),this.addPoint(e.xy),this.lastUp=e.xy,this.line.geometry.components.length===this.maxVertices+1&&this.finishGeometry())),this.stoppedDown=this.stopDown,this.mouseDown=!1,!this.stopUp},finishGeometry:function(){var e=this.line.geometry.components.length-1;this.line.geometry.removeComponent(this.line.geometry.components[e]),this.removePoint(),this.finalize()},dblclick:function(e){return this.freehandMode(e)||this.finishGeometry(),!1},CLASS_NAME:"OpenLayers.Handler.Path"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Spherical=OpenLayers.Spherical||{},OpenLayers.Spherical.DEFAULT_RADIUS=6378137,OpenLayers.Spherical.computeDistanceBetween=function(e,t,i){var s=i||OpenLayers.Spherical.DEFAULT_RADIUS,n=Math.sin(Math.PI*(t.lon-e.lon)/360),r=Math.sin(Math.PI*(t.lat-e.lat)/360),a=r*r+n*n*Math.cos(Math.PI*e.lat/180)*Math.cos(Math.PI*t.lat/180);return 2*s*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))},OpenLayers.Spherical.computeHeading=function(e,t){var i=Math.sin(Math.PI*(e.lon-t.lon)/180)*Math.cos(Math.PI*t.lat/180),s=Math.cos(Math.PI*e.lat/180)*Math.sin(Math.PI*t.lat/180)-Math.sin(Math.PI*e.lat/180)*Math.cos(Math.PI*t.lat/180)*Math.cos(Math.PI*(e.lon-t.lon)/180);return 180*Math.atan2(i,s)/Math.PI},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.CacheWrite=OpenLayers.Class(OpenLayers.Control,{layers:null,imageFormat:"image/png",quotaRegEx:/quota/i,setMap:function(e){OpenLayers.Control.prototype.setMap.apply(this,arguments);var t,i=this.layers||e.layers;for(t=i.length-1;t>=0;--t)this.addLayer({layer:i[t]});this.layers||e.events.on({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this})},addLayer:function(e){e.layer.events.on({tileloadstart:this.makeSameOrigin,tileloaded:this.cache,scope:this})},removeLayer:function(e){e.layer.events.un({tileloadstart:this.makeSameOrigin,tileloaded:this.cache,scope:this})},makeSameOrigin:function(e){if(this.active){var t=e.tile;if(t instanceof OpenLayers.Tile.Image&&!t.crossOriginKeyword&&"data:"!==t.url.substr(0,5)){var i=OpenLayers.Request.makeSameOrigin(t.url,OpenLayers.ProxyHost);OpenLayers.Control.CacheWrite.urlMap[i]=t.url,t.url=i}}},cache:function(e){if(this.active&&window.localStorage){var t=e.tile;if(t instanceof OpenLayers.Tile.Image&&"data:"!==t.url.substr(0,5))try{var i=t.getCanvasContext();if(i){var s=OpenLayers.Control.CacheWrite.urlMap,n=s[t.url]||t.url;window.localStorage.setItem("olCache_"+n,i.canvas.toDataURL(this.imageFormat)),delete s[t.url]}}catch(r){var a=r.name||r.message;a&&this.quotaRegEx.test(a)?this.events.triggerEvent("cachefull",{tile:t}):OpenLayers.Console.error(r.toString())}}},destroy:function(){if(this.layers||this.map){var e,t=this.layers||this.map.layers;for(e=t.length-1;e>=0;--e)this.removeLayer({layer:t[e]})}this.map&&this.map.events.un({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this}),OpenLayers.Control.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.CacheWrite"}),OpenLayers.Control.CacheWrite.clearCache=function(){if(window.localStorage){var e,t;for(e=window.localStorage.length-1;e>=0;--e)t=window.localStorage.key(e),"olCache_"===t.substr(0,8)&&window.localStorage.removeItem(t)}},OpenLayers.Control.CacheWrite.urlMap={},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.PanPanel=OpenLayers.Class(OpenLayers.Control.Panel,{slideFactor:50,slideRatio:null,initialize:function(e){OpenLayers.Control.Panel.prototype.initialize.apply(this,[e]);var e={slideFactor:this.slideFactor,slideRatio:this.slideRatio};this.addControls([new OpenLayers.Control.Pan(OpenLayers.Control.Pan.NORTH,e),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.SOUTH,e),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.EAST,e),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.WEST,e)])},CLASS_NAME:"OpenLayers.Control.PanPanel"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.Attribution=OpenLayers.Class(OpenLayers.Control,{separator:", ",template:"${layers}",destroy:function(){this.map.events.un({removelayer:this.updateAttribution,addlayer:this.updateAttribution,changelayer:this.updateAttribution,changebaselayer:this.updateAttribution,scope:this}),OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){return OpenLayers.Control.prototype.draw.apply(this,arguments),this.map.events.on({changebaselayer:this.updateAttribution,changelayer:this.updateAttribution,addlayer:this.updateAttribution,removelayer:this.updateAttribution,scope:this}),this.updateAttribution(),this.div},updateAttribution:function(){var e=[];if(this.map&&this.map.layers){for(var t=0,i=this.map.layers.length;i>t;t++){var s=this.map.layers[t];s.attribution&&s.getVisibility()&&-1===OpenLayers.Util.indexOf(e,s.attribution)&&e.push(s.attribution)}this.div.innerHTML=OpenLayers.String.format(this.template,{layers:e.join(this.separator)})}},CLASS_NAME:"OpenLayers.Control.Attribution"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Kinetic=OpenLayers.Class({threshold:0,deceleration:.0035,nbPoints:100,delay:200,points:void 0,timerId:void 0,initialize:function(e){OpenLayers.Util.extend(this,e)},begin:function(){OpenLayers.Animation.stop(this.timerId),this.timerId=void 0,this.points=[]},update:function(e){this.points.unshift({xy:e,tick:(new Date).getTime()}),this.points.length>this.nbPoints&&this.points.pop()},end:function(e){for(var t,i,s=(new Date).getTime(),n=0,r=this.points.length;r>n&&(i=this.points[n],!(s-i.tick>this.delay));n++)t=i;if(t){var a=(new Date).getTime()-t.tick,o=Math.sqrt(Math.pow(e.x-t.xy.x,2)+Math.pow(e.y-t.xy.y,2)),l=o/a;if(!(0==l||l<this.threshold)){var h=Math.asin((e.y-t.xy.y)/o);return t.xy.x<=e.x&&(h=Math.PI-h),{speed:l,theta:h}}}},move:function(e,t){var i=e.speed,s=Math.cos(e.theta),n=-Math.sin(e.theta),r=(new Date).getTime(),a=0,o=0,l=function(){if(null!=this.timerId){var e=(new Date).getTime()-r,l=-this.deceleration*Math.pow(e,2)/2+i*e,h=l*s,u=l*n,c={};c.end=!1;var d=-this.deceleration*e+i;0>=d&&(OpenLayers.Animation.stop(this.timerId),this.timerId=null,c.end=!0),c.x=h-a,c.y=u-o,a=h,o=u,t(c.x,c.y,c.end)}};this.timerId=OpenLayers.Animation.start(OpenLayers.Function.bind(l,this))},CLASS_NAME:"OpenLayers.Kinetic"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.GeoRSS=OpenLayers.Class(OpenLayers.Layer.Markers,{location:null,features:null,formatOptions:null,selectedFeature:null,icon:null,popupSize:null,useFeedTitle:!0,initialize:function(e,t,i){OpenLayers.Layer.Markers.prototype.initialize.apply(this,[e,i]),this.location=t,this.features=[]},destroy:function(){OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments),this.clearFeatures(),this.features=null},loadRSS:function(){this.loaded||(this.events.triggerEvent("loadstart"),OpenLayers.Request.GET({url:this.location,success:this.parseData,scope:this}),this.loaded=!0)},moveTo:function(){OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments),this.visibility&&!this.loaded&&this.loadRSS()},parseData:function(e){var t=e.responseXML;if(t&&t.documentElement||(t=OpenLayers.Format.XML.prototype.read(e.responseText)),this.useFeedTitle){var i=null;try{i=t.getElementsByTagNameNS("*","title")[0].firstChild.nodeValue}catch(s){i=t.getElementsByTagName("title")[0].firstChild.nodeValue}i&&this.setName(i)}var n={};OpenLayers.Util.extend(n,this.formatOptions),this.map&&!this.projection.equals(this.map.getProjectionObject())&&(n.externalProjection=this.projection,n.internalProjection=this.map.getProjectionObject());for(var r=new OpenLayers.Format.GeoRSS(n),a=r.read(t),o=0,l=a.length;l>o;o++){var h={},u=a[o];if(u.geometry){var c=u.attributes.title?u.attributes.title:"Untitled",d=u.attributes.description?u.attributes.description:"No description.",p=u.attributes.link?u.attributes.link:"",f=u.geometry.getBounds().getCenterLonLat();if(h.icon=null==this.icon?OpenLayers.Marker.defaultIcon():this.icon.clone(),h.popupSize=this.popupSize?this.popupSize.clone():new OpenLayers.Size(250,120),c||d){h.title=c,h.description=d;var m='<div class="olLayerGeoRSSClose">[x]</div>';m+='<div class="olLayerGeoRSSTitle">',p&&(m+='<a class="link" href="'+p+'" target="_blank">'),m+=c,p&&(m+="</a>"),m+="</div>",m+='<div style="" class="olLayerGeoRSSDescription">',m+=d,m+="</div>",h.popupContentHTML=m}var u=new OpenLayers.Feature(this,f,h);this.features.push(u);var y=u.createMarker();y.events.register("click",u,this.markerClick),this.addMarker(y)}}this.events.triggerEvent("loadend")},markerClick:function(e){var t=this==this.layer.selectedFeature;this.layer.selectedFeature=t?null:this;for(var i=0,s=this.layer.map.popups.length;s>i;i++)this.layer.map.removePopup(this.layer.map.popups[i]);if(!t){var n=this.createPopup();OpenLayers.Event.observe(n.div,"click",OpenLayers.Function.bind(function(){for(var e=0,t=this.layer.map.popups.length;t>e;e++)this.layer.map.removePopup(this.layer.map.popups[e])},this)),this.layer.map.addPopup(n)}OpenLayers.Event.stop(e)},clearFeatures:function(){if(null!=this.features)for(;this.features.length>0;){var e=this.features[0];OpenLayers.Util.removeItem(this.features,e),e.destroy()}},CLASS_NAME:"OpenLayers.Layer.GeoRSS"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WMSCapabilities.v1_3=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1,{readers:{wms:OpenLayers.Util.applyDefaults({WMS_Capabilities:function(e,t){this.readChildNodes(e,t)},LayerLimit:function(e,t){t.layerLimit=parseInt(this.getChildValue(e))},MaxWidth:function(e,t){t.maxWidth=parseInt(this.getChildValue(e))},MaxHeight:function(e,t){t.maxHeight=parseInt(this.getChildValue(e))},BoundingBox:function(e,t){var i=OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms.BoundingBox.apply(this,[e,t]);i.srs=e.getAttribute("CRS"),t.bbox[i.srs]=i},CRS:function(e,t){this.readers.wms.SRS.apply(this,[e,t])},EX_GeographicBoundingBox:function(e,t){t.llbbox=[],this.readChildNodes(e,t.llbbox)},westBoundLongitude:function(e,t){t[0]=this.getChildValue(e)},eastBoundLongitude:function(e,t){t[2]=this.getChildValue(e)},southBoundLatitude:function(e,t){t[1]=this.getChildValue(e)},northBoundLatitude:function(e,t){t[3]=this.getChildValue(e)},MinScaleDenominator:function(e,t){t.maxScale=parseFloat(this.getChildValue(e)).toPrecision(16)},MaxScaleDenominator:function(e,t){t.minScale=parseFloat(this.getChildValue(e)).toPrecision(16)},Dimension:function(e,t){var i=e.getAttribute("name").toLowerCase(),s={name:i,units:e.getAttribute("units"),unitsymbol:e.getAttribute("unitSymbol"),nearestVal:"1"===e.getAttribute("nearestValue"),multipleVal:"1"===e.getAttribute("multipleValues"),"default":e.getAttribute("default")||"",current:"1"===e.getAttribute("current"),values:this.getChildValue(e).split(",")};t.dimensions[s.name]=s},Keyword:function(e,t){var i={value:this.getChildValue(e),vocabulary:e.getAttribute("vocabulary")};t.keywords&&t.keywords.push(i)}},OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms),sld:{UserDefinedSymbolization:function(e,t){this.readers.wms.UserDefinedSymbolization.apply(this,[e,t]),t.userSymbols.inlineFeature=1==parseInt(e.getAttribute("InlineFeature")),t.userSymbols.remoteWCS=1==parseInt(e.getAttribute("RemoteWCS"))},DescribeLayer:function(e,t){this.readers.wms.DescribeLayer.apply(this,[e,t])},GetLegendGraphic:function(e,t){this.readers.wms.GetLegendGraphic.apply(this,[e,t])}}},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_3"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.SOSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",CLASS_NAME:"OpenLayers.Format.SOSCapabilities"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.WMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{service:"WMS",version:"1.1.1",request:"GetMap",styles:"",format:"image/jpeg"},isBaseLayer:!0,encodeBBOX:!1,noMagic:!1,yx:{},initialize:function(e,t,i,s){var n=[];i=OpenLayers.Util.upperCaseObject(i),parseFloat(i.VERSION)>=1.3&&!i.EXCEPTIONS&&(i.EXCEPTIONS="INIMAGE"),n.push(e,t,i,s),OpenLayers.Layer.Grid.prototype.initialize.apply(this,n),OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS)),!this.noMagic&&this.params.TRANSPARENT&&"true"==this.params.TRANSPARENT.toString().toLowerCase()&&(null!=s&&s.isBaseLayer||(this.isBaseLayer=!1),"image/jpeg"==this.params.FORMAT&&(this.params.FORMAT=OpenLayers.Util.alphaHack()?"image/gif":"image/png"))},clone:function(e){return null==e&&(e=new OpenLayers.Layer.WMS(this.name,this.url,this.params,this.getOptions())),e=OpenLayers.Layer.Grid.prototype.clone.apply(this,[e])},reverseAxisOrder:function(){var e=this.projection.getCode();return parseFloat(this.params.VERSION)>=1.3&&!(!this.yx[e]&&!OpenLayers.Projection.defaults[e].yx)},getURL:function(e){e=this.adjustBounds(e);var t=this.getImageSize(),i={},s=this.reverseAxisOrder();i.BBOX=this.encodeBBOX?e.toBBOX(null,s):e.toArray(s),i.WIDTH=t.w,i.HEIGHT=t.h;var n=this.getFullRequestString(i);return n},mergeNewParams:function(e){var t=OpenLayers.Util.upperCaseObject(e),i=[t];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,i)},getFullRequestString:function(e){var t=this.map.getProjectionObject(),i=this.projection&&this.projection.equals(t)?this.projection.getCode():t.getCode(),s="none"==i?null:i;return parseFloat(this.params.VERSION)>=1.3?this.params.CRS=s:this.params.SRS=s,"boolean"==typeof this.params.TRANSPARENT&&(e.TRANSPARENT=this.params.TRANSPARENT?"TRUE":"FALSE"),OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.WMS"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.KaMap=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,DEFAULT_PARAMS:{i:"jpeg",map:""},initialize:function(){OpenLayers.Layer.Grid.prototype.initialize.apply(this,arguments),this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS)},getURL:function(e){e=this.adjustBounds(e);var t=this.map.getResolution(),i=Math.round(1e4*this.map.getScale())/1e4,s=Math.round(e.left/t),n=-Math.round(e.top/t);return this.getFullRequestString({t:n,l:s,s:i})},calculateGridLayout:function(e,t,i){var s=i*this.tileSize.w,n=i*this.tileSize.h,r=e.left,a=Math.floor(r/s)-this.buffer,o=r/s-a,l=-o*this.tileSize.w,h=a*s,u=e.top,c=Math.ceil(u/n)+this.buffer,d=c-u/n,p=-(d+1)*this.tileSize.h,f=c*n;return{tilelon:s,tilelat:n,tileoffsetlon:h,tileoffsetlat:f,tileoffsetx:l,tileoffsety:p}},clone:function(e){return null==e&&(e=new OpenLayers.Layer.KaMap(this.name,this.url,this.params,this.getOptions())),e=OpenLayers.Layer.Grid.prototype.clone.apply(this,[e]),null!=this.tileSize&&(e.tileSize=this.tileSize.clone()),e.grid=[],e},getTileBounds:function(e){var t=this.getResolution(),i=t*this.tileSize.w,s=t*this.tileSize.h,n=this.getLonLatFromViewPortPx(e),r=i*Math.floor(n.lon/i),a=s*Math.floor(n.lat/s);return new OpenLayers.Bounds(r,a,r+i,a+s)},CLASS_NAME:"OpenLayers.Layer.KaMap"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WMC=OpenLayers.Class(OpenLayers.Format.Context,{defaultVersion:"1.1.0",layerToContext:function(e){var t=this.getParser(),i={queryable:e.queryable,visibility:e.visibility,name:e.params.LAYERS,title:e.name,"abstract":e.metadata["abstract"],dataURL:e.metadata.dataURL,metadataURL:e.metadataURL,server:{version:e.params.VERSION,url:e.url},maxExtent:e.maxExtent,transparent:e.params.TRANSPARENT,numZoomLevels:e.numZoomLevels,units:e.units,isBaseLayer:e.isBaseLayer,opacity:1==e.opacity?void 0:e.opacity,displayInLayerSwitcher:e.displayInLayerSwitcher,singleTile:e.singleTile,tileSize:e.singleTile||!e.tileSize?void 0:{width:e.tileSize.w,height:e.tileSize.h},minScale:e.options.resolutions||e.options.scales||e.options.maxResolution||e.options.minScale?e.minScale:void 0,maxScale:e.options.resolutions||e.options.scales||e.options.minResolution||e.options.maxScale?e.maxScale:void 0,formats:[],styles:[],srs:e.srs,dimensions:e.dimensions};if(e.metadata.servertitle&&(i.server.title=e.metadata.servertitle),e.metadata.formats&&e.metadata.formats.length>0)for(var s=0,n=e.metadata.formats.length;n>s;s++){var r=e.metadata.formats[s];i.formats.push({value:r.value,current:r.value==e.params.FORMAT})}else i.formats.push({value:e.params.FORMAT,current:!0});if(e.metadata.styles&&e.metadata.styles.length>0)for(var s=0,n=e.metadata.styles.length;n>s;s++){var a=e.metadata.styles[s];a.current=a.href==e.params.SLD||a.body==e.params.SLD_BODY||a.name==e.params.STYLES?!0:!1,i.styles.push(a)}else i.styles.push({href:e.params.SLD,body:e.params.SLD_BODY,name:e.params.STYLES||t.defaultStyleName,title:t.defaultStyleTitle,current:!0});return i},toContext:function(e){var t={},i=e.layers;if("OpenLayers.Map"==e.CLASS_NAME){var s=e.metadata||{};t.size=e.getSize(),t.bounds=e.getExtent(),t.projection=e.projection,t.title=e.title,t.keywords=s.keywords,t["abstract"]=s["abstract"],t.logo=s.logo,t.descriptionURL=s.descriptionURL,t.contactInformation=s.contactInformation,t.maxExtent=e.maxExtent}else OpenLayers.Util.applyDefaults(t,e),void 0!=t.layers&&delete t.layers;if(void 0==t.layersContext&&(t.layersContext=[]),void 0!=i&&OpenLayers.Util.isArray(i))for(var n=0,r=i.length;r>n;n++){var a=i[n];a instanceof OpenLayers.Layer.WMS&&t.layersContext.push(this.layerToContext(a))}return t},CLASS_NAME:"OpenLayers.Format.WMC"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WMC.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ol:"http://openlayers.org/context",wmc:"http://www.opengis.net/context",sld:"http://www.opengis.net/sld",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"",getNamespacePrefix:function(e){var t=null;if(null==e)t=this.namespaces[this.defaultPrefix];else for(t in this.namespaces)if(this.namespaces[t]==e)break;return t},defaultPrefix:"wmc",rootPrefix:null,defaultStyleName:"",defaultStyleTitle:"Default",initialize:function(e){OpenLayers.Format.XML.prototype.initialize.apply(this,[e])},read:function(e){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e]));var t=e.documentElement;this.rootPrefix=t.prefix;var i={version:t.getAttribute("version")};return this.runChildNodes(i,t),i},runChildNodes:function(e,t){for(var i,s,n,r,a=t.childNodes,o=0,l=a.length;l>o;++o)i=a[o],1==i.nodeType&&(n=this.getNamespacePrefix(i.namespaceURI),r=i.nodeName.split(":").pop(),s=this["read_"+n+"_"+r],s&&s.apply(this,[e,i]))},read_wmc_General:function(e,t){this.runChildNodes(e,t)},read_wmc_BoundingBox:function(e,t){e.projection=t.getAttribute("SRS"),e.bounds=new OpenLayers.Bounds(t.getAttribute("minx"),t.getAttribute("miny"),t.getAttribute("maxx"),t.getAttribute("maxy"))},read_wmc_LayerList:function(e,t){e.layersContext=[],this.runChildNodes(e,t)},read_wmc_Layer:function(e,t){var i={visibility:"1"!=t.getAttribute("hidden"),queryable:"1"==t.getAttribute("queryable"),formats:[],styles:[],metadata:{}};this.runChildNodes(i,t),e.layersContext.push(i)},read_wmc_Extension:function(e,t){this.runChildNodes(e,t)},read_ol_units:function(e,t){e.units=this.getChildValue(t)},read_ol_maxExtent:function(e,t){var i=new OpenLayers.Bounds(t.getAttribute("minx"),t.getAttribute("miny"),t.getAttribute("maxx"),t.getAttribute("maxy"));e.maxExtent=i},read_ol_transparent:function(e,t){e.transparent=this.getChildValue(t)},read_ol_numZoomLevels:function(e,t){e.numZoomLevels=parseInt(this.getChildValue(t))},read_ol_opacity:function(e,t){e.opacity=parseFloat(this.getChildValue(t))},read_ol_singleTile:function(e,t){e.singleTile="true"==this.getChildValue(t)},read_ol_tileSize:function(e,t){var i={width:t.getAttribute("width"),height:t.getAttribute("height")};e.tileSize=i},read_ol_isBaseLayer:function(e,t){e.isBaseLayer="true"==this.getChildValue(t)},read_ol_displayInLayerSwitcher:function(e,t){e.displayInLayerSwitcher="true"==this.getChildValue(t)},read_wmc_Server:function(e,t){e.version=t.getAttribute("version"),e.url=this.getOnlineResource_href(t),e.metadata.servertitle=t.getAttribute("title")},read_wmc_FormatList:function(e,t){this.runChildNodes(e,t)},read_wmc_Format:function(e,t){var i={value:this.getChildValue(t)};"1"==t.getAttribute("current")&&(i.current=!0),e.formats.push(i)},read_wmc_StyleList:function(e,t){this.runChildNodes(e,t)},read_wmc_Style:function(e,t){var i={};this.runChildNodes(i,t),"1"==t.getAttribute("current")&&(i.current=!0),e.styles.push(i)},read_wmc_SLD:function(e,t){this.runChildNodes(e,t)},read_sld_StyledLayerDescriptor:function(e,t){var i=OpenLayers.Format.XML.prototype.write.apply(this,[t]);e.body=i},read_sld_FeatureTypeStyle:function(e,t){var i=OpenLayers.Format.XML.prototype.write.apply(this,[t]);e.body=i},read_wmc_OnlineResource:function(e,t){e.href=this.getAttributeNS(t,this.namespaces.xlink,"href")},read_wmc_Name:function(e,t){var i=this.getChildValue(t);i&&(e.name=i)},read_wmc_Title:function(e,t){var i=this.getChildValue(t);i&&(e.title=i)},read_wmc_MetadataURL:function(e,t){e.metadataURL=this.getOnlineResource_href(t)},read_wmc_KeywordList:function(e,t){e.keywords=[],this.runChildNodes(e.keywords,t)},read_wmc_Keyword:function(e,t){e.push(this.getChildValue(t))},read_wmc_Abstract:function(e,t){var i=this.getChildValue(t);i&&(e["abstract"]=i)},read_wmc_LogoURL:function(e,t){e.logo={width:t.getAttribute("width"),height:t.getAttribute("height"),format:t.getAttribute("format"),href:this.getOnlineResource_href(t)}},read_wmc_DescriptionURL:function(e,t){e.descriptionURL=this.getOnlineResource_href(t)},read_wmc_ContactInformation:function(e,t){var i={};this.runChildNodes(i,t),e.contactInformation=i},read_wmc_ContactPersonPrimary:function(e,t){var i={};this.runChildNodes(i,t),e.personPrimary=i},read_wmc_ContactPerson:function(e,t){var i=this.getChildValue(t);i&&(e.person=i)},read_wmc_ContactOrganization:function(e,t){var i=this.getChildValue(t);i&&(e.organization=i)},read_wmc_ContactPosition:function(e,t){var i=this.getChildValue(t);i&&(e.position=i)},read_wmc_ContactAddress:function(e,t){var i={};this.runChildNodes(i,t),e.contactAddress=i},read_wmc_AddressType:function(e,t){var i=this.getChildValue(t);i&&(e.type=i)},read_wmc_Address:function(e,t){var i=this.getChildValue(t);i&&(e.address=i)},read_wmc_City:function(e,t){var i=this.getChildValue(t);i&&(e.city=i)},read_wmc_StateOrProvince:function(e,t){var i=this.getChildValue(t);i&&(e.stateOrProvince=i)},read_wmc_PostCode:function(e,t){var i=this.getChildValue(t);i&&(e.postcode=i)},read_wmc_Country:function(e,t){var i=this.getChildValue(t);i&&(e.country=i)},read_wmc_ContactVoiceTelephone:function(e,t){var i=this.getChildValue(t);i&&(e.phone=i)},read_wmc_ContactFacsimileTelephone:function(e,t){var i=this.getChildValue(t);i&&(e.fax=i)},read_wmc_ContactElectronicMailAddress:function(e,t){var i=this.getChildValue(t);i&&(e.email=i)},read_wmc_DataURL:function(e,t){e.dataURL=this.getOnlineResource_href(t)},read_wmc_LegendURL:function(e,t){var i={width:t.getAttribute("width"),height:t.getAttribute("height"),format:t.getAttribute("format"),href:this.getOnlineResource_href(t)};e.legend=i},read_wmc_DimensionList:function(e,t){e.dimensions={},this.runChildNodes(e.dimensions,t)},read_wmc_Dimension:function(e,t){var i=t.getAttribute("name").toLowerCase(),s={name:i,units:t.getAttribute("units")||"",unitSymbol:t.getAttribute("unitSymbol")||"",userValue:t.getAttribute("userValue")||"",nearestValue:"1"===t.getAttribute("nearestValue"),multipleValues:"1"===t.getAttribute("multipleValues"),current:"1"===t.getAttribute("current"),"default":t.getAttribute("default")||""},n=this.getChildValue(t);s.values=n.split(","),e[s.name]=s},write:function(e,t){var i=this.createElementDefaultNS("ViewContext");return this.setAttributes(i,{version:this.VERSION,id:t&&"string"==typeof t.id?t.id:OpenLayers.Util.createUniqueID("OpenLayers_Context_")}),this.setAttributeNS(i,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation),i.appendChild(this.write_wmc_General(e)),i.appendChild(this.write_wmc_LayerList(e)),OpenLayers.Format.XML.prototype.write.apply(this,[i])},createElementDefaultNS:function(e,t,i){var s=this.createElementNS(this.namespaces[this.defaultPrefix],e);return t&&s.appendChild(this.createTextNode(t)),i&&this.setAttributes(s,i),s},setAttributes:function(e,t){var i;for(var s in t)i=t[s].toString(),i.match(/[A-Z]/)?this.setAttributeNS(e,null,s,i):e.setAttribute(s,i)},write_wmc_General:function(e){var t=this.createElementDefaultNS("General");e.size&&t.appendChild(this.createElementDefaultNS("Window",null,{width:e.size.w,height:e.size.h}));var i=e.bounds;return t.appendChild(this.createElementDefaultNS("BoundingBox",null,{minx:i.left.toPrecision(18),miny:i.bottom.toPrecision(18),maxx:i.right.toPrecision(18),maxy:i.top.toPrecision(18),SRS:e.projection})),t.appendChild(this.createElementDefaultNS("Title",e.title)),e.keywords&&t.appendChild(this.write_wmc_KeywordList(e.keywords)),e["abstract"]&&t.appendChild(this.createElementDefaultNS("Abstract",e["abstract"])),e.logo&&t.appendChild(this.write_wmc_URLType("LogoURL",e.logo.href,e.logo)),e.descriptionURL&&t.appendChild(this.write_wmc_URLType("DescriptionURL",e.descriptionURL)),e.contactInformation&&t.appendChild(this.write_wmc_ContactInformation(e.contactInformation)),t.appendChild(this.write_ol_MapExtension(e)),t},write_wmc_KeywordList:function(e){for(var t=this.createElementDefaultNS("KeywordList"),i=0,s=e.length;s>i;i++)t.appendChild(this.createElementDefaultNS("Keyword",e[i]));return t},write_wmc_ContactInformation:function(e){var t=this.createElementDefaultNS("ContactInformation");return e.personPrimary&&t.appendChild(this.write_wmc_ContactPersonPrimary(e.personPrimary)),e.position&&t.appendChild(this.createElementDefaultNS("ContactPosition",e.position)),e.contactAddress&&t.appendChild(this.write_wmc_ContactAddress(e.contactAddress)),e.phone&&t.appendChild(this.createElementDefaultNS("ContactVoiceTelephone",e.phone)),e.fax&&t.appendChild(this.createElementDefaultNS("ContactFacsimileTelephone",e.fax)),e.email&&t.appendChild(this.createElementDefaultNS("ContactElectronicMailAddress",e.email)),t},write_wmc_ContactPersonPrimary:function(e){var t=this.createElementDefaultNS("ContactPersonPrimary");return e.person&&t.appendChild(this.createElementDefaultNS("ContactPerson",e.person)),e.organization&&t.appendChild(this.createElementDefaultNS("ContactOrganization",e.organization)),t},write_wmc_ContactAddress:function(e){var t=this.createElementDefaultNS("ContactAddress");return e.type&&t.appendChild(this.createElementDefaultNS("AddressType",e.type)),e.address&&t.appendChild(this.createElementDefaultNS("Address",e.address)),e.city&&t.appendChild(this.createElementDefaultNS("City",e.city)),e.stateOrProvince&&t.appendChild(this.createElementDefaultNS("StateOrProvince",e.stateOrProvince)),e.postcode&&t.appendChild(this.createElementDefaultNS("PostCode",e.postcode)),e.country&&t.appendChild(this.createElementDefaultNS("Country",e.country)),t},write_ol_MapExtension:function(e){var t=this.createElementDefaultNS("Extension"),i=e.maxExtent;if(i){var s=this.createElementNS(this.namespaces.ol,"ol:maxExtent");this.setAttributes(s,{minx:i.left.toPrecision(18),miny:i.bottom.toPrecision(18),maxx:i.right.toPrecision(18),maxy:i.top.toPrecision(18)}),t.appendChild(s)}return t},write_wmc_LayerList:function(e){for(var t=this.createElementDefaultNS("LayerList"),i=0,s=e.layersContext.length;s>i;++i)t.appendChild(this.write_wmc_Layer(e.layersContext[i]));return t},write_wmc_Layer:function(e){var t=this.createElementDefaultNS("Layer",null,{queryable:e.queryable?"1":"0",hidden:e.visibility?"0":"1"});return t.appendChild(this.write_wmc_Server(e)),t.appendChild(this.createElementDefaultNS("Name",e.name)),t.appendChild(this.createElementDefaultNS("Title",e.title)),e["abstract"]&&t.appendChild(this.createElementDefaultNS("Abstract",e["abstract"])),e.dataURL&&t.appendChild(this.write_wmc_URLType("DataURL",e.dataURL)),e.metadataURL&&t.appendChild(this.write_wmc_URLType("MetadataURL",e.metadataURL)),t},write_wmc_LayerExtension:function(e){var t=this.createElementDefaultNS("Extension"),i=e.maxExtent,s=this.createElementNS(this.namespaces.ol,"ol:maxExtent");if(this.setAttributes(s,{minx:i.left.toPrecision(18),miny:i.bottom.toPrecision(18),maxx:i.right.toPrecision(18),maxy:i.top.toPrecision(18)}),t.appendChild(s),e.tileSize&&!e.singleTile){var n=this.createElementNS(this.namespaces.ol,"ol:tileSize");this.setAttributes(n,e.tileSize),t.appendChild(n)}for(var r,a=["transparent","numZoomLevels","units","isBaseLayer","opacity","displayInLayerSwitcher","singleTile"],o=0,l=a.length;l>o;++o)r=this.createOLPropertyNode(e,a[o]),r&&t.appendChild(r);return t},createOLPropertyNode:function(e,t){var i=null;return null!=e[t]&&(i=this.createElementNS(this.namespaces.ol,"ol:"+t),i.appendChild(this.createTextNode(e[t].toString()))),i},write_wmc_Server:function(e){var t=e.server,i=this.createElementDefaultNS("Server"),s={service:"OGC:WMS",version:t.version};return t.title&&(s.title=t.title),this.setAttributes(i,s),i.appendChild(this.write_wmc_OnlineResource(t.url)),i},write_wmc_URLType:function(e,t,i){var s=this.createElementDefaultNS(e);if(s.appendChild(this.write_wmc_OnlineResource(t)),i)for(var n=["width","height","format"],r=0;r<n.length;r++)n[r]in i&&s.setAttribute(n[r],i[n[r]]);return s},write_wmc_DimensionList:function(e){var t=this.createElementDefaultNS("DimensionList");for(var i in e.dimensions){var s={},n=e.dimensions[i];for(var r in n)s[r]="boolean"==typeof n[r]?Number(n[r]):n[r];var a="";s.values&&(a=s.values.join(","),delete s.values),t.appendChild(this.createElementDefaultNS("Dimension",a,s))}return t},write_wmc_FormatList:function(e){for(var t=this.createElementDefaultNS("FormatList"),i=0,s=e.formats.length;s>i;i++){var n=e.formats[i];t.appendChild(this.createElementDefaultNS("Format",n.value,n.current&&1==n.current?{current:"1"}:null))}return t},write_wmc_StyleList:function(e){var t=this.createElementDefaultNS("StyleList"),i=e.styles;if(i&&OpenLayers.Util.isArray(i))for(var s,n=0,r=i.length;r>n;n++){var a=i[n],o=this.createElementDefaultNS("Style",null,a.current&&1==a.current?{current:"1"}:null);if(a.href){s=this.createElementDefaultNS("SLD"),a.name&&s.appendChild(this.createElementDefaultNS("Name",a.name)),a.title&&s.appendChild(this.createElementDefaultNS("Title",a.title)),a.legend&&s.appendChild(this.write_wmc_URLType("LegendURL",a.legend.href,a.legend));var l=this.write_wmc_OnlineResource(a.href);s.appendChild(l),o.appendChild(s)}else if(a.body){s=this.createElementDefaultNS("SLD"),a.name&&s.appendChild(this.createElementDefaultNS("Name",a.name)),a.title&&s.appendChild(this.createElementDefaultNS("Title",a.title)),a.legend&&s.appendChild(this.write_wmc_URLType("LegendURL",a.legend.href,a.legend));var h=OpenLayers.Format.XML.prototype.read.apply(this,[a.body]),u=h.documentElement;s.ownerDocument&&s.ownerDocument.importNode&&(u=s.ownerDocument.importNode(u,!0)),s.appendChild(u),o.appendChild(s)}else o.appendChild(this.createElementDefaultNS("Name",a.name)),o.appendChild(this.createElementDefaultNS("Title",a.title)),a["abstract"]&&o.appendChild(this.createElementDefaultNS("Abstract",a["abstract"])),a.legend&&o.appendChild(this.write_wmc_URLType("LegendURL",a.legend.href,a.legend));t.appendChild(o)}return t},write_wmc_OnlineResource:function(e){var t=this.createElementDefaultNS("OnlineResource");return this.setAttributeNS(t,this.namespaces.xlink,"xlink:type","simple"),this.setAttributeNS(t,this.namespaces.xlink,"xlink:href",e),t},getOnlineResource_href:function(e){var t={},i=e.getElementsByTagName("OnlineResource");return i.length>0&&this.read_wmc_OnlineResource(t,i[0]),t.href},CLASS_NAME:"OpenLayers.Format.WMC.v1"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WMC.v1_1_0=OpenLayers.Class(OpenLayers.Format.WMC.v1,{VERSION:"1.1.0",schemaLocation:"http://www.opengis.net/context http://schemas.opengis.net/context/1.1.0/context.xsd",initialize:function(e){OpenLayers.Format.WMC.v1.prototype.initialize.apply(this,[e])},read_sld_MinScaleDenominator:function(e,t){var i=parseFloat(this.getChildValue(t));i>0&&(e.maxScale=i)},read_sld_MaxScaleDenominator:function(e,t){e.minScale=parseFloat(this.getChildValue(t))},read_wmc_SRS:function(e,t){"srs"in e||(e.srs={}),e.srs[this.getChildValue(t)]=!0},write_wmc_Layer:function(e){var t=OpenLayers.Format.WMC.v1.prototype.write_wmc_Layer.apply(this,[e]);if(e.maxScale){var i=this.createElementNS(this.namespaces.sld,"sld:MinScaleDenominator");i.appendChild(this.createTextNode(e.maxScale.toPrecision(16))),t.appendChild(i)}if(e.minScale){var s=this.createElementNS(this.namespaces.sld,"sld:MaxScaleDenominator");s.appendChild(this.createTextNode(e.minScale.toPrecision(16))),t.appendChild(s)}if(e.srs)for(var n in e.srs)t.appendChild(this.createElementDefaultNS("SRS",n));return t.appendChild(this.write_wmc_FormatList(e)),t.appendChild(this.write_wmc_StyleList(e)),e.dimensions&&t.appendChild(this.write_wmc_DimensionList(e)),t.appendChild(this.write_wmc_LayerExtension(e)),t},CLASS_NAME:"OpenLayers.Format.WMC.v1_1_0"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Renderer.SVG=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"http://www.w3.org/2000/svg",xlinkns:"http://www.w3.org/1999/xlink",MAX_PIXEL:15e3,translationParameters:null,symbolMetrics:null,initialize:function(){this.supported()&&(OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments),this.translationParameters={x:0,y:0},this.symbolMetrics={})},supported:function(){var e="http://www.w3.org/TR/SVG11/feature#";return document.implementation&&(document.implementation.hasFeature("org.w3c.svg","1.0")||document.implementation.hasFeature(e+"SVG","1.1")||document.implementation.hasFeature(e+"BasicStructure","1.1"))},inValidRange:function(e,t,i){var s=e+(i?0:this.translationParameters.x),n=t+(i?0:this.translationParameters.y);return s>=-this.MAX_PIXEL&&s<=this.MAX_PIXEL&&n>=-this.MAX_PIXEL&&n<=this.MAX_PIXEL},setExtent:function(e,t){var i=OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments),s=this.getResolution(),n=-e.left/s,r=e.top/s;if(t){this.left=n,this.top=r;var a="0 0 "+this.size.w+" "+this.size.h;return this.rendererRoot.setAttributeNS(null,"viewBox",a),this.translate(this.xOffset,0),!0}var o=this.translate(n-this.left+this.xOffset,r-this.top);return o||this.setExtent(e,!0),i&&o},translate:function(e,t){if(this.inValidRange(e,t,!0)){var i="";return(e||t)&&(i="translate("+e+","+t+")"),this.root.setAttributeNS(null,"transform",i),this.translationParameters={x:e,y:t},!0}return!1},setSize:function(){OpenLayers.Renderer.prototype.setSize.apply(this,arguments),this.rendererRoot.setAttributeNS(null,"width",this.size.w),this.rendererRoot.setAttributeNS(null,"height",this.size.h)},getNodeType:function(e,t){var i=null;switch(e.CLASS_NAME){case"OpenLayers.Geometry.Point":i=t.externalGraphic?"image":this.isComplexSymbol(t.graphicName)?"svg":"circle";break;case"OpenLayers.Geometry.Rectangle":i="rect";break;case"OpenLayers.Geometry.LineString":i="polyline";break;case"OpenLayers.Geometry.LinearRing":i="polygon";break;case"OpenLayers.Geometry.Polygon":case"OpenLayers.Geometry.Curve":i="path"}return i},setStyle:function(e,t,i){t=t||e._style,i=i||e._options;var s,n=parseFloat(e.getAttributeNS(null,"r")),r=1;if("OpenLayers.Geometry.Point"==e._geometryClass&&n){if(e.style.visibility="",t.graphic===!1)e.style.visibility="hidden";else if(t.externalGraphic){if(s=this.getPosition(e),t.graphicTitle){e.setAttributeNS(null,"title",t.graphicTitle);var a=e.getElementsByTagName("title");if(a.length>0)a[0].firstChild.textContent=t.graphicTitle;else{var o=this.nodeFactory(null,"title");o.textContent=t.graphicTitle,e.appendChild(o)}}t.graphicWidth&&t.graphicHeight&&e.setAttributeNS(null,"preserveAspectRatio","none");var l=t.graphicWidth||t.graphicHeight,h=t.graphicHeight||t.graphicWidth;l=l?l:2*t.pointRadius,h=h?h:2*t.pointRadius;var u=void 0!=t.graphicXOffset?t.graphicXOffset:-(.5*l),c=void 0!=t.graphicYOffset?t.graphicYOffset:-(.5*h),d=t.graphicOpacity||t.fillOpacity;e.setAttributeNS(null,"x",(s.x+u).toFixed()),e.setAttributeNS(null,"y",(s.y+c).toFixed()),e.setAttributeNS(null,"width",l),e.setAttributeNS(null,"height",h),e.setAttributeNS(this.xlinkns,"href",t.externalGraphic),e.setAttributeNS(null,"style","opacity: "+d),e.onclick=OpenLayers.Renderer.SVG.preventDefault}else if(this.isComplexSymbol(t.graphicName)){var p=3*t.pointRadius,f=2*p,m=this.importSymbol(t.graphicName);s=this.getPosition(e),r=3*this.symbolMetrics[m.id][0]/f;var y=e.parentNode,g=e.nextSibling;y&&y.removeChild(e),e.firstChild&&e.removeChild(e.firstChild),e.appendChild(m.firstChild.cloneNode(!0)),e.setAttributeNS(null,"viewBox",m.getAttributeNS(null,"viewBox")),e.setAttributeNS(null,"width",f),e.setAttributeNS(null,"height",f),e.setAttributeNS(null,"x",s.x-p),e.setAttributeNS(null,"y",s.y-p),g?y.insertBefore(e,g):y&&y.appendChild(e)}else e.setAttributeNS(null,"r",t.pointRadius);var v=t.rotation;if((void 0!==v||void 0!==e._rotation)&&s)if(e._rotation=v,v|=0,"svg"!==e.nodeName)e.setAttributeNS(null,"transform","rotate("+v+" "+s.x+" "+s.y+")");else{var x=this.symbolMetrics[m.id];e.firstChild.setAttributeNS(null,"transform","rotate("+v+" "+x[1]+" "+x[2]+")")}}return i.isFilled?(e.setAttributeNS(null,"fill",t.fillColor),e.setAttributeNS(null,"fill-opacity",t.fillOpacity)):e.setAttributeNS(null,"fill","none"),i.isStroked?(e.setAttributeNS(null,"stroke",t.strokeColor),e.setAttributeNS(null,"stroke-opacity",t.strokeOpacity),e.setAttributeNS(null,"stroke-width",t.strokeWidth*r),e.setAttributeNS(null,"stroke-linecap",t.strokeLinecap||"round"),e.setAttributeNS(null,"stroke-linejoin","round"),t.strokeDashstyle&&e.setAttributeNS(null,"stroke-dasharray",this.dashStyle(t,r))):e.setAttributeNS(null,"stroke","none"),t.pointerEvents&&e.setAttributeNS(null,"pointer-events",t.pointerEvents),null!=t.cursor&&e.setAttributeNS(null,"cursor",t.cursor),e},dashStyle:function(e,t){var i=e.strokeWidth*t,s=e.strokeDashstyle;switch(s){case"solid":return"none";case"dot":return[1,4*i].join();case"dash":return[4*i,4*i].join();case"dashdot":return[4*i,4*i,1,4*i].join();case"longdash":return[8*i,4*i].join();case"longdashdot":return[8*i,4*i,1,4*i].join();default:return OpenLayers.String.trim(s).replace(/\s+/g,",")}},createNode:function(e,t){var i=document.createElementNS(this.xmlns,e);return t&&i.setAttributeNS(null,"id",t),i},nodeTypeCompare:function(e,t){return t==e.nodeName},createRenderRoot:function(){var e=this.nodeFactory(this.container.id+"_svgRoot","svg");return e.style.display="block",e},createRoot:function(e){return this.nodeFactory(this.container.id+e,"g")},createDefs:function(){var e=this.nodeFactory(this.container.id+"_defs","defs");return this.rendererRoot.appendChild(e),e},drawPoint:function(e,t){return this.drawCircle(e,t,1)},drawCircle:function(e,t,i){var s=this.getResolution(),n=(t.x-this.featureDx)/s+this.left,r=this.top-t.y/s;return this.inValidRange(n,r)?(e.setAttributeNS(null,"cx",n),e.setAttributeNS(null,"cy",r),e.setAttributeNS(null,"r",i),e):!1},drawLineString:function(e,t){var i=this.getComponentsString(t.components);return i.path?(e.setAttributeNS(null,"points",i.path),i.complete?e:null):!1},drawLinearRing:function(e,t){var i=this.getComponentsString(t.components);return i.path?(e.setAttributeNS(null,"points",i.path),i.complete?e:null):!1},drawPolygon:function(e,t){for(var i,s,n="",r=!0,a=!0,o=0,l=t.components.length;l>o;o++)n+=" M",i=this.getComponentsString(t.components[o].components," "),s=i.path,s?(n+=" "+s,a=i.complete&&a):r=!1;return n+=" z",r?(e.setAttributeNS(null,"d",n),e.setAttributeNS(null,"fill-rule","evenodd"),a?e:null):!1},drawRectangle:function(e,t){var i=this.getResolution(),s=(t.x-this.featureDx)/i+this.left,n=this.top-t.y/i;return this.inValidRange(s,n)?(e.setAttributeNS(null,"x",s),e.setAttributeNS(null,"y",n),e.setAttributeNS(null,"width",t.width/i),e.setAttributeNS(null,"height",t.height/i),e):!1},drawText:function(e,t,i){var s=!!t.labelOutlineWidth;if(s){var n=OpenLayers.Util.extend({},t);n.fontColor=n.labelOutlineColor,n.fontStrokeColor=n.labelOutlineColor,n.fontStrokeWidth=t.labelOutlineWidth,delete n.labelOutlineWidth,this.drawText(e,n,i)}var r=this.getResolution(),a=(i.x-this.featureDx)/r+this.left,o=i.y/r-this.top,l=s?this.LABEL_OUTLINE_SUFFIX:this.LABEL_ID_SUFFIX,h=this.nodeFactory(e+l,"text");h.setAttributeNS(null,"x",a),h.setAttributeNS(null,"y",-o),t.fontColor&&h.setAttributeNS(null,"fill",t.fontColor),t.fontStrokeColor&&h.setAttributeNS(null,"stroke",t.fontStrokeColor),t.fontStrokeWidth&&h.setAttributeNS(null,"stroke-width",t.fontStrokeWidth),t.fontOpacity&&h.setAttributeNS(null,"opacity",t.fontOpacity),t.fontFamily&&h.setAttributeNS(null,"font-family",t.fontFamily),t.fontSize&&h.setAttributeNS(null,"font-size",t.fontSize),t.fontWeight&&h.setAttributeNS(null,"font-weight",t.fontWeight),t.fontStyle&&h.setAttributeNS(null,"font-style",t.fontStyle),t.labelSelect===!0?(h.setAttributeNS(null,"pointer-events","visible"),h._featureId=e):h.setAttributeNS(null,"pointer-events","none");var u=t.labelAlign||OpenLayers.Renderer.defaultSymbolizer.labelAlign;h.setAttributeNS(null,"text-anchor",OpenLayers.Renderer.SVG.LABEL_ALIGN[u[0]]||"middle"),OpenLayers.IS_GECKO===!0&&h.setAttributeNS(null,"dominant-baseline",OpenLayers.Renderer.SVG.LABEL_ALIGN[u[1]]||"central");for(var c=t.label.split("\n"),d=c.length;h.childNodes.length>d;)h.removeChild(h.lastChild);for(var p=0;d>p;p++){var f=this.nodeFactory(e+l+"_tspan_"+p,"tspan");if(t.labelSelect===!0&&(f._featureId=e,f._geometry=i,f._geometryClass=i.CLASS_NAME),OpenLayers.IS_GECKO===!1&&f.setAttributeNS(null,"baseline-shift",OpenLayers.Renderer.SVG.LABEL_VSHIFT[u[1]]||"-35%"),f.setAttribute("x",a),0==p){var m=OpenLayers.Renderer.SVG.LABEL_VFACTOR[u[1]];null==m&&(m=-.5),f.setAttribute("dy",m*(d-1)+"em")}else f.setAttribute("dy","1em");f.textContent=""===c[p]?" ":c[p],f.parentNode||h.appendChild(f)}h.parentNode||this.textRoot.appendChild(h)},getComponentsString:function(e,t){for(var i,s,n=[],r=!0,a=e.length,o=[],l=0;a>l;l++)s=e[l],n.push(s),i=this.getShortString(s),i?o.push(i):(l>0&&this.getShortString(e[l-1])&&o.push(this.clipLine(e[l],e[l-1])),a-1>l&&this.getShortString(e[l+1])&&o.push(this.clipLine(e[l],e[l+1])),r=!1);return{path:o.join(t||","),complete:r}},clipLine:function(e,t){if(t.equals(e))return"";var i,s=this.getResolution(),n=this.MAX_PIXEL-this.translationParameters.x,r=this.MAX_PIXEL-this.translationParameters.y,a=(t.x-this.featureDx)/s+this.left,o=this.top-t.y/s,l=(e.x-this.featureDx)/s+this.left,h=this.top-e.y/s;return(-n>l||l>n)&&(i=(h-o)/(l-a),l=0>l?-n:n,h=o+(l-a)*i),(-r>h||h>r)&&(i=(l-a)/(h-o),h=0>h?-r:r,l=a+(h-o)*i),l+","+h},getShortString:function(e){var t=this.getResolution(),i=(e.x-this.featureDx)/t+this.left,s=this.top-e.y/t;return this.inValidRange(i,s)?i+","+s:!1},getPosition:function(e){return{x:parseFloat(e.getAttributeNS(null,"cx")),y:parseFloat(e.getAttributeNS(null,"cy"))}},importSymbol:function(e){this.defs||(this.defs=this.createDefs());var t=this.container.id+"-"+e,i=document.getElementById(t);if(null!=i)return i;var s=OpenLayers.Renderer.symbol[e];if(!s)throw new Error(e+" is not a valid symbol name");var n=this.nodeFactory(t,"symbol"),r=this.nodeFactory(null,"polygon");n.appendChild(r);for(var a,o,l=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0),h=[],u=0;u<s.length;u+=2)a=s[u],o=s[u+1],l.left=Math.min(l.left,a),l.bottom=Math.min(l.bottom,o),l.right=Math.max(l.right,a),l.top=Math.max(l.top,o),h.push(a,",",o);r.setAttributeNS(null,"points",h.join(" "));var c=l.getWidth(),d=l.getHeight(),p=[l.left-c,l.bottom-d,3*c,3*d];return n.setAttributeNS(null,"viewBox",p.join(" ")),this.symbolMetrics[t]=[Math.max(c,d),l.getCenterLonLat().lon,l.getCenterLonLat().lat],this.defs.appendChild(n),n},getFeatureIdFromEvent:function(e){var t=OpenLayers.Renderer.Elements.prototype.getFeatureIdFromEvent.apply(this,arguments);if(!t){var i=e.target;t=i.parentNode&&i!=this.rendererRoot?i.parentNode._featureId:void 0}return t},CLASS_NAME:"OpenLayers.Renderer.SVG"}),OpenLayers.Renderer.SVG.LABEL_ALIGN={l:"start",r:"end",b:"bottom",t:"hanging"},OpenLayers.Renderer.SVG.LABEL_VSHIFT={t:"-70%",b:"0"},OpenLayers.Renderer.SVG.LABEL_VFACTOR={t:0,b:-1},OpenLayers.Renderer.SVG.preventDefault=function(e){e.preventDefault&&e.preventDefault()},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WMSDescribeLayer.v1_1=OpenLayers.Class(OpenLayers.Format.WMSDescribeLayer,{initialize:function(e){OpenLayers.Format.WMSDescribeLayer.prototype.initialize.apply(this,[e])},read:function(e){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e]));for(var t,i,s=e.documentElement,n=s.childNodes,r=[],a=0;a<n.length;++a)if(t=n[a],i=t.nodeName,"LayerDescription"==i){var o=t.getAttribute("name"),l="",h="",u="";t.getAttribute("owsType")?(l=t.getAttribute("owsType"),h=t.getAttribute("owsURL")):""!=t.getAttribute("wfs")?(l="WFS",h=t.getAttribute("wfs")):""!=t.getAttribute("wcs")&&(l="WCS",h=t.getAttribute("wcs"));var c=t.getElementsByTagName("Query");c.length>0&&(u=c[0].getAttribute("typeName"),u||(u=c[0].getAttribute("typename"))),r.push({layerName:o,owsType:l,owsURL:h,typeName:u})}return r},CLASS_NAME:"OpenLayers.Format.WMSDescribeLayer.v1_1"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.ScaleLine=OpenLayers.Class(OpenLayers.Control,{maxWidth:100,topOutUnits:"km",topInUnits:"m",bottomOutUnits:"mi",bottomInUnits:"ft",eTop:null,eBottom:null,geodesic:!1,draw:function(){return OpenLayers.Control.prototype.draw.apply(this,arguments),this.eTop||(this.eTop=document.createElement("div"),this.eTop.className=this.displayClass+"Top",this.topInUnits.length,this.div.appendChild(this.eTop),this.eTop.style.visibility=""==this.topOutUnits||""==this.topInUnits?"hidden":"visible",this.eBottom=document.createElement("div"),this.eBottom.className=this.displayClass+"Bottom",this.div.appendChild(this.eBottom),this.eBottom.style.visibility=""==this.bottomOutUnits||""==this.bottomInUnits?"hidden":"visible"),this.map.events.register("moveend",this,this.update),this.update(),this.div},getBarLen:function(e){var t,i=parseInt(Math.log(e)/Math.log(10)),s=Math.pow(10,i),n=parseInt(e/s);return t=n>5?5:n>2?2:1,t*s},update:function(){var e=this.map.getResolution();if(e){var t=this.map.getUnits(),i=OpenLayers.INCHES_PER_UNIT,s=this.maxWidth*e*i[t],n=1;if(this.geodesic===!0){var r=(this.map.getGeodesicPixelSize().w||1e-6)*this.maxWidth,a=s/i.km;n=r/a,s*=n}var o,l;s>1e5?(o=this.topOutUnits,l=this.bottomOutUnits):(o=this.topInUnits,l=this.bottomInUnits);var h=s/i[o],u=s/i[l],c=this.getBarLen(h),d=this.getBarLen(u);h=c/i[t]*i[o],u=d/i[t]*i[l];var p=h/e/n,f=u/e/n;"visible"==this.eBottom.style.visibility&&(this.eBottom.style.width=Math.round(f)+"px",this.eBottom.innerHTML=d+" "+l),"visible"==this.eTop.style.visibility&&(this.eTop.style.width=Math.round(p)+"px",this.eTop.innerHTML=c+" "+o)}},CLASS_NAME:"OpenLayers.Control.ScaleLine"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.PanZoom=OpenLayers.Class(OpenLayers.Control,{slideFactor:50,slideRatio:null,buttons:null,position:null,initialize:function(){this.position=new OpenLayers.Pixel(OpenLayers.Control.PanZoom.X,OpenLayers.Control.PanZoom.Y),OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.map&&this.map.events.unregister("buttonclick",this,this.onButtonClick),this.removeButtons(),this.buttons=null,this.position=null,OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(){OpenLayers.Control.prototype.setMap.apply(this,arguments),this.map.events.register("buttonclick",this,this.onButtonClick)},draw:function(e){OpenLayers.Control.prototype.draw.apply(this,arguments),e=this.position,this.buttons=[];var t={w:18,h:18},i=new OpenLayers.Pixel(e.x+t.w/2,e.y);return this._addButton("panup","north-mini.png",i,t),e.y=i.y+t.h,this._addButton("panleft","west-mini.png",e,t),this._addButton("panright","east-mini.png",e.add(t.w,0),t),this._addButton("pandown","south-mini.png",i.add(0,2*t.h),t),this._addButton("zoomin","zoom-plus-mini.png",i.add(0,3*t.h+5),t),this._addButton("zoomworld","zoom-world-mini.png",i.add(0,4*t.h+5),t),this._addButton("zoomout","zoom-minus-mini.png",i.add(0,5*t.h+5),t),this.div},_addButton:function(e,t,i,s){var n=OpenLayers.Util.getImageLocation(t),r=OpenLayers.Util.createAlphaImageDiv(this.id+"_"+e,i,s,n,"absolute");return r.style.cursor="pointer",this.div.appendChild(r),r.action=e,r.className="olButton",this.buttons.push(r),r},_removeButton:function(e){this.div.removeChild(e),OpenLayers.Util.removeItem(this.buttons,e)},removeButtons:function(){for(var e=this.buttons.length-1;e>=0;--e)this._removeButton(this.buttons[e])},onButtonClick:function(e){var t=e.buttonElement;switch(t.action){case"panup":this.map.pan(0,-this.getSlideFactor("h"));break;case"pandown":this.map.pan(0,this.getSlideFactor("h"));break;case"panleft":this.map.pan(-this.getSlideFactor("w"),0);break;case"panright":this.map.pan(this.getSlideFactor("w"),0);break;case"zoomin":this.map.zoomIn();break;case"zoomout":this.map.zoomOut();break;case"zoomworld":this.map.zoomToMaxExtent()}},getSlideFactor:function(e){return this.slideRatio?this.map.getSize()[e]*this.slideRatio:this.slideFactor},CLASS_NAME:"OpenLayers.Control.PanZoom"}),OpenLayers.Control.PanZoom.X=4,OpenLayers.Control.PanZoom.Y=4,/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Icon=OpenLayers.Class({url:null,size:null,offset:null,calculateOffset:null,imageDiv:null,px:null,initialize:function(e,t,i,s){this.url=e,this.size=t||{w:20,h:20},this.offset=i||{x:-(this.size.w/2),y:-(this.size.h/2)},this.calculateOffset=s;var n=OpenLayers.Util.createUniqueID("OL_Icon_");this.imageDiv=OpenLayers.Util.createAlphaImageDiv(n)},destroy:function(){this.erase(),OpenLayers.Event.stopObservingElement(this.imageDiv.firstChild),this.imageDiv.innerHTML="",this.imageDiv=null},clone:function(){return new OpenLayers.Icon(this.url,this.size,this.offset,this.calculateOffset)},setSize:function(e){null!=e&&(this.size=e),this.draw()},setUrl:function(e){null!=e&&(this.url=e),this.draw()},draw:function(e){return OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,this.size,this.url,"absolute"),this.moveTo(e),this.imageDiv},erase:function(){null!=this.imageDiv&&null!=this.imageDiv.parentNode&&OpenLayers.Element.remove(this.imageDiv)},setOpacity:function(e){OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,null,null,null,null,null,e)},moveTo:function(e){null!=e&&(this.px=e),null!=this.imageDiv&&(null==this.px?this.display(!1):(this.calculateOffset&&(this.offset=this.calculateOffset(this.size)),OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,{x:this.px.x+this.offset.x,y:this.px.y+this.offset.y})))},display:function(e){this.imageDiv.style.display=e?"":"none"},isDrawn:function(){var e=this.imageDiv&&this.imageDiv.parentNode&&11!=this.imageDiv.parentNode.nodeType;return e},CLASS_NAME:"OpenLayers.Icon"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Marker=OpenLayers.Class({icon:null,lonlat:null,events:null,map:null,initialize:function(e,t){this.lonlat=e;var i=t?t:OpenLayers.Marker.defaultIcon();null==this.icon?this.icon=i:(this.icon.url=i.url,this.icon.size=i.size,this.icon.offset=i.offset,this.icon.calculateOffset=i.calculateOffset),this.events=new OpenLayers.Events(this,this.icon.imageDiv)},destroy:function(){this.erase(),this.map=null,this.events.destroy(),this.events=null,null!=this.icon&&(this.icon.destroy(),this.icon=null)},draw:function(e){return this.icon.draw(e)},erase:function(){null!=this.icon&&this.icon.erase()},moveTo:function(e){null!=e&&null!=this.icon&&this.icon.moveTo(e),this.lonlat=this.map.getLonLatFromLayerPx(e)},isDrawn:function(){var e=this.icon&&this.icon.isDrawn();return e},onScreen:function(){var e=!1;if(this.map){var t=this.map.getExtent();e=t.containsLonLat(this.lonlat)}return e},inflate:function(e){this.icon&&this.icon.setSize({w:this.icon.size.w*e,h:this.icon.size.h*e})},setOpacity:function(e){this.icon.setOpacity(e)},setUrl:function(e){this.icon.setUrl(e)},display:function(e){this.icon.display(e)},CLASS_NAME:"OpenLayers.Marker"}),OpenLayers.Marker.defaultIcon=function(){return new OpenLayers.Icon(OpenLayers.Util.getImageLocation("marker.png"),{w:21,h:25},{x:-10.5,y:-25})},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Popup=OpenLayers.Class({events:null,id:"",lonlat:null,div:null,contentSize:null,size:null,contentHTML:null,backgroundColor:"",opacity:"",border:"",contentDiv:null,groupDiv:null,closeDiv:null,autoSize:!1,minSize:null,maxSize:null,displayClass:"olPopup",contentDisplayClass:"olPopupContent",padding:0,disableFirefoxOverflowHack:!1,fixPadding:function(){"number"==typeof this.padding&&(this.padding=new OpenLayers.Bounds(this.padding,this.padding,this.padding,this.padding))},panMapIfOutOfView:!1,keepInMap:!1,closeOnMove:!1,map:null,initialize:function(e,t,i,s,n,r){null==e&&(e=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")),this.id=e,this.lonlat=t,this.contentSize=null!=i?i:new OpenLayers.Size(OpenLayers.Popup.WIDTH,OpenLayers.Popup.HEIGHT),null!=s&&(this.contentHTML=s),this.backgroundColor=OpenLayers.Popup.COLOR,this.opacity=OpenLayers.Popup.OPACITY,this.border=OpenLayers.Popup.BORDER,this.div=OpenLayers.Util.createDiv(this.id,null,null,null,null,null,"hidden"),this.div.className=this.displayClass;var a=this.id+"_GroupDiv";this.groupDiv=OpenLayers.Util.createDiv(a,null,null,null,"relative",null,"hidden");var e=this.div.id+"_contentDiv";this.contentDiv=OpenLayers.Util.createDiv(e,null,this.contentSize.clone(),null,"relative"),this.contentDiv.className=this.contentDisplayClass,this.groupDiv.appendChild(this.contentDiv),this.div.appendChild(this.groupDiv),n&&this.addCloseBox(r),this.registerEvents()},destroy:function(){this.id=null,this.lonlat=null,this.size=null,this.contentHTML=null,this.backgroundColor=null,this.opacity=null,this.border=null,this.closeOnMove&&this.map&&this.map.events.unregister("movestart",this,this.hide),this.events.destroy(),this.events=null,this.closeDiv&&(OpenLayers.Event.stopObservingElement(this.closeDiv),this.groupDiv.removeChild(this.closeDiv)),this.closeDiv=null,this.div.removeChild(this.groupDiv),this.groupDiv=null,null!=this.map&&this.map.removePopup(this),this.map=null,this.div=null,this.autoSize=null,this.minSize=null,this.maxSize=null,this.padding=null,this.panMapIfOutOfView=null},draw:function(e){return null==e&&null!=this.lonlat&&null!=this.map&&(e=this.map.getLayerPxFromLonLat(this.lonlat)),this.closeOnMove&&this.map.events.register("movestart",this,this.hide),this.disableFirefoxOverflowHack||"firefox"!=OpenLayers.BROWSER_NAME||(this.map.events.register("movestart",this,function(){var e=document.defaultView.getComputedStyle(this.contentDiv,null),t=e.getPropertyValue("overflow");"hidden"!=t&&(this.contentDiv._oldOverflow=t,this.contentDiv.style.overflow="hidden")}),this.map.events.register("moveend",this,function(){var e=this.contentDiv._oldOverflow;e&&(this.contentDiv.style.overflow=e,this.contentDiv._oldOverflow=null)})),this.moveTo(e),this.autoSize||this.size||this.setSize(this.contentSize),this.setBackgroundColor(),this.setOpacity(),this.setBorder(),this.setContentHTML(),this.panMapIfOutOfView&&this.panIntoView(),this.div},updatePosition:function(){if(this.lonlat&&this.map){var e=this.map.getLayerPxFromLonLat(this.lonlat);e&&this.moveTo(e)}},moveTo:function(e){null!=e&&null!=this.div&&(this.div.style.left=e.x+"px",this.div.style.top=e.y+"px")},visible:function(){return OpenLayers.Element.visible(this.div)},toggle:function(){this.visible()?this.hide():this.show()},show:function(){this.div.style.display="",this.panMapIfOutOfView&&this.panIntoView()},hide:function(){this.div.style.display="none"},setSize:function(e){this.size=e.clone();var t=this.getContentDivPadding(),i=t.left+t.right,s=t.top+t.bottom;if(this.fixPadding(),i+=this.padding.left+this.padding.right,s+=this.padding.top+this.padding.bottom,this.closeDiv){var n=parseInt(this.closeDiv.style.width);i+=n+t.right}this.size.w+=i,this.size.h+=s,"msie"==OpenLayers.BROWSER_NAME&&(this.contentSize.w+=t.left+t.right,this.contentSize.h+=t.bottom+t.top),null!=this.div&&(this.div.style.width=this.size.w+"px",this.div.style.height=this.size.h+"px"),null!=this.contentDiv&&(this.contentDiv.style.width=e.w+"px",this.contentDiv.style.height=e.h+"px")},updateSize:function(){var e="<div class='"+this.contentDisplayClass+"'>"+this.contentDiv.innerHTML+"</div>",t=this.map?this.map.div:document.body,i=OpenLayers.Util.getRenderedDimensions(e,null,{displayClass:this.displayClass,containerElement:t}),s=this.getSafeContentSize(i),n=null;if(s.equals(i))n=i;else{var r={w:s.w<i.w?s.w:null,h:s.h<i.h?s.h:null};if(r.w&&r.h)n=s;else{var a=OpenLayers.Util.getRenderedDimensions(e,r,{displayClass:this.contentDisplayClass,containerElement:t}),o=OpenLayers.Element.getStyle(this.contentDiv,"overflow");if("hidden"!=o&&a.equals(s)){var l=OpenLayers.Util.getScrollbarWidth();r.w?a.h+=l:a.w+=l}n=this.getSafeContentSize(a)}}this.setSize(n)},setBackgroundColor:function(e){void 0!=e&&(this.backgroundColor=e),null!=this.div&&(this.div.style.backgroundColor=this.backgroundColor)},setOpacity:function(e){void 0!=e&&(this.opacity=e),null!=this.div&&(this.div.style.opacity=this.opacity,this.div.style.filter="alpha(opacity="+100*this.opacity+")")},setBorder:function(e){void 0!=e&&(this.border=e),null!=this.div&&(this.div.style.border=this.border)},setContentHTML:function(e){null!=e&&(this.contentHTML=e),null!=this.contentDiv&&null!=this.contentHTML&&this.contentHTML!=this.contentDiv.innerHTML&&(this.contentDiv.innerHTML=this.contentHTML,this.autoSize&&(this.registerImageListeners(),this.updateSize()))},registerImageListeners:function(){for(var e=function(){null!==this.popup.id&&(this.popup.updateSize(),this.popup.visible()&&this.popup.panMapIfOutOfView&&this.popup.panIntoView(),OpenLayers.Event.stopObserving(this.img,"load",this.img._onImageLoad))},t=this.contentDiv.getElementsByTagName("img"),i=0,s=t.length;s>i;i++){var n=t[i];if(0==n.width||0==n.height){var r={popup:this,img:n};n._onImgLoad=OpenLayers.Function.bind(e,r),OpenLayers.Event.observe(n,"load",n._onImgLoad)}}},getSafeContentSize:function(e){var t=e.clone(),i=this.getContentDivPadding(),s=i.left+i.right,n=i.top+i.bottom;if(this.fixPadding(),s+=this.padding.left+this.padding.right,n+=this.padding.top+this.padding.bottom,this.closeDiv){var r=parseInt(this.closeDiv.style.width);s+=r+i.right}if(this.minSize&&(t.w=Math.max(t.w,this.minSize.w-s),t.h=Math.max(t.h,this.minSize.h-n)),this.maxSize&&(t.w=Math.min(t.w,this.maxSize.w-s),t.h=Math.min(t.h,this.maxSize.h-n)),this.map&&this.map.size){var a=0,o=0;if(this.keepInMap&&!this.panMapIfOutOfView){var l=this.map.getPixelFromLonLat(this.lonlat);switch(this.relativePosition){case"tr":a=l.x,o=this.map.size.h-l.y;break;case"tl":a=this.map.size.w-l.x,o=this.map.size.h-l.y;break;case"bl":a=this.map.size.w-l.x,o=l.y;break;case"br":a=l.x,o=l.y;break;default:a=l.x,o=this.map.size.h-l.y}}var h=this.map.size.h-this.map.paddingForPopups.top-this.map.paddingForPopups.bottom-n-o,u=this.map.size.w-this.map.paddingForPopups.left-this.map.paddingForPopups.right-s-a;t.w=Math.min(t.w,u),t.h=Math.min(t.h,h)}return t},getContentDivPadding:function(){var e=this._contentDivPadding;return e||(null==this.div.parentNode&&(this.div.style.display="none",document.body.appendChild(this.div)),e=new OpenLayers.Bounds(OpenLayers.Element.getStyle(this.contentDiv,"padding-left"),OpenLayers.Element.getStyle(this.contentDiv,"padding-bottom"),OpenLayers.Element.getStyle(this.contentDiv,"padding-right"),OpenLayers.Element.getStyle(this.contentDiv,"padding-top")),this._contentDivPadding=e,this.div.parentNode==document.body&&(document.body.removeChild(this.div),this.div.style.display="")),e},addCloseBox:function(e){this.closeDiv=OpenLayers.Util.createDiv(this.id+"_close",null,{w:17,h:17}),this.closeDiv.className="olPopupCloseBox";var t=this.getContentDivPadding();this.closeDiv.style.right=t.right+"px",this.closeDiv.style.top=t.top+"px",this.groupDiv.appendChild(this.closeDiv);var i=e||function(e){this.hide(),OpenLayers.Event.stop(e)};OpenLayers.Event.observe(this.closeDiv,"touchend",OpenLayers.Function.bindAsEventListener(i,this)),OpenLayers.Event.observe(this.closeDiv,"click",OpenLayers.Function.bindAsEventListener(i,this))},panIntoView:function(){var e=this.map.getSize(),t=this.map.getViewPortPxFromLayerPx(new OpenLayers.Pixel(parseInt(this.div.style.left),parseInt(this.div.style.top))),i=t.clone();t.x<this.map.paddingForPopups.left?i.x=this.map.paddingForPopups.left:t.x+this.size.w>e.w-this.map.paddingForPopups.right&&(i.x=e.w-this.map.paddingForPopups.right-this.size.w),t.y<this.map.paddingForPopups.top?i.y=this.map.paddingForPopups.top:t.y+this.size.h>e.h-this.map.paddingForPopups.bottom&&(i.y=e.h-this.map.paddingForPopups.bottom-this.size.h);var s=t.x-i.x,n=t.y-i.y;this.map.pan(s,n)},registerEvents:function(){function e(e){OpenLayers.Event.stop(e,!0)}this.events=new OpenLayers.Events(this,this.div,null,!0),this.events.on({mousedown:this.onmousedown,mousemove:this.onmousemove,mouseup:this.onmouseup,click:this.onclick,mouseout:this.onmouseout,dblclick:this.ondblclick,touchstart:e,scope:this})},onmousedown:function(e){this.mousedown=!0,OpenLayers.Event.stop(e,!0)},onmousemove:function(e){this.mousedown&&OpenLayers.Event.stop(e,!0)},onmouseup:function(e){this.mousedown&&(this.mousedown=!1,OpenLayers.Event.stop(e,!0))},onclick:function(e){OpenLayers.Event.stop(e,!0)},onmouseout:function(){this.mousedown=!1},ondblclick:function(e){OpenLayers.Event.stop(e,!0)},CLASS_NAME:"OpenLayers.Popup"}),OpenLayers.Popup.WIDTH=200,OpenLayers.Popup.HEIGHT=200,OpenLayers.Popup.COLOR="white",OpenLayers.Popup.OPACITY=1,OpenLayers.Popup.BORDER="0px",/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Strategy.Paging=OpenLayers.Class(OpenLayers.Strategy,{features:null,length:10,num:null,paging:!1,activate:function(){var e=OpenLayers.Strategy.prototype.activate.call(this);return e&&this.layer.events.on({beforefeaturesadded:this.cacheFeatures,scope:this}),e},deactivate:function(){var e=OpenLayers.Strategy.prototype.deactivate.call(this);return e&&(this.clearCache(),this.layer.events.un({beforefeaturesadded:this.cacheFeatures,scope:this})),e},cacheFeatures:function(e){this.paging||(this.clearCache(),this.features=e.features,this.pageNext(e))},clearCache:function(){if(this.features)for(var e=0;e<this.features.length;++e)this.features[e].destroy();this.features=null,this.num=null},pageCount:function(){var e=this.features?this.features.length:0;return Math.ceil(e/this.length)},pageNum:function(){return this.num},pageLength:function(e){return e&&e>0&&(this.length=e),this.length},pageNext:function(e){var t=!1;if(this.features){null===this.num&&(this.num=-1);var i=(this.num+1)*this.length;t=this.page(i,e)}return t},pagePrevious:function(){var e=!1;if(this.features){null===this.num&&(this.num=this.pageCount());var t=(this.num-1)*this.length;e=this.page(t)}return e},page:function(e,t){var i=!1;if(this.features&&e>=0&&e<this.features.length){var s=Math.floor(e/this.length);if(s!=this.num){this.paging=!0;var n=this.features.slice(e,e+this.length);this.layer.removeFeatures(this.layer.features),this.num=s,t&&t.features?t.features=n:this.layer.addFeatures(n),this.paging=!1,i=!0}}return i},CLASS_NAME:"OpenLayers.Strategy.Paging"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Handler.Box=OpenLayers.Class(OpenLayers.Handler,{dragHandler:null,boxDivClassName:"olHandlerBoxZoomBox",boxOffsets:null,initialize:function(){OpenLayers.Handler.prototype.initialize.apply(this,arguments),this.dragHandler=new OpenLayers.Handler.Drag(this,{down:this.startBox,move:this.moveBox,out:this.removeBox,up:this.endBox},{keyMask:this.keyMask})},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments),this.dragHandler&&(this.dragHandler.destroy(),this.dragHandler=null)},setMap:function(e){OpenLayers.Handler.prototype.setMap.apply(this,arguments),this.dragHandler&&this.dragHandler.setMap(e)},startBox:function(){this.callback("start",[]),this.zoomBox=OpenLayers.Util.createDiv("zoomBox",{x:-9999,y:-9999}),this.zoomBox.className=this.boxDivClassName,this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1,this.map.viewPortDiv.appendChild(this.zoomBox),OpenLayers.Element.addClass(this.map.viewPortDiv,"olDrawBox")},moveBox:function(e){var t=this.dragHandler.start.x,i=this.dragHandler.start.y,s=Math.abs(t-e.x),n=Math.abs(i-e.y),r=this.getBoxOffsets();this.zoomBox.style.width=s+r.width+1+"px",this.zoomBox.style.height=n+r.height+1+"px",this.zoomBox.style.left=(e.x<t?t-s-r.left:t-r.left)+"px",this.zoomBox.style.top=(e.y<i?i-n-r.top:i-r.top)+"px"},endBox:function(e){var t;if(Math.abs(this.dragHandler.start.x-e.x)>5||Math.abs(this.dragHandler.start.y-e.y)>5){var i=this.dragHandler.start,s=Math.min(i.y,e.y),n=Math.max(i.y,e.y),r=Math.min(i.x,e.x),a=Math.max(i.x,e.x);t=new OpenLayers.Bounds(r,n,a,s)}else t=this.dragHandler.start.clone();this.removeBox(),this.callback("done",[t])},removeBox:function(){this.map.viewPortDiv.removeChild(this.zoomBox),this.zoomBox=null,this.boxOffsets=null,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDrawBox")},activate:function(){return OpenLayers.Handler.prototype.activate.apply(this,arguments)?(this.dragHandler.activate(),!0):!1},deactivate:function(){return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)?(this.dragHandler.deactivate()&&this.zoomBox&&this.removeBox(),!0):!1},getBoxOffsets:function(){if(!this.boxOffsets){var e=document.createElement("div");e.style.position="absolute",e.style.border="1px solid black",e.style.width="3px",document.body.appendChild(e);var t=3==e.clientWidth;document.body.removeChild(e);var i=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-left-width")),s=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-right-width")),n=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-top-width")),r=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-bottom-width"));this.boxOffsets={left:i,right:s,top:n,bottom:r,width:t===!1?i+s:0,height:t===!1?n+r:0}}return this.boxOffsets},CLASS_NAME:"OpenLayers.Handler.Box"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.ZoomBox=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,out:!1,keyMask:null,alwaysZoom:!1,draw:function(){this.handler=new OpenLayers.Handler.Box(this,{done:this.zoomBox},{keyMask:this.keyMask})},zoomBox:function(e){if(e instanceof OpenLayers.Bounds){var t;if(this.out){var i=Math.abs(e.right-e.left),s=Math.abs(e.top-e.bottom),n=Math.min(this.map.size.h/s,this.map.size.w/i),r=this.map.getExtent(),a=this.map.getLonLatFromPixel(e.getCenterPixel()),o=a.lon-r.getWidth()/2*n,l=a.lon+r.getWidth()/2*n,h=a.lat-r.getHeight()/2*n,u=a.lat+r.getHeight()/2*n;t=new OpenLayers.Bounds(o,h,l,u)}else{var c=this.map.getLonLatFromPixel({x:e.left,y:e.bottom}),d=this.map.getLonLatFromPixel({x:e.right,y:e.top});t=new OpenLayers.Bounds(c.lon,c.lat,d.lon,d.lat)}var p=this.map.getZoom();this.map.zoomToExtent(t),p==this.map.getZoom()&&1==this.alwaysZoom&&this.map.zoomTo(p+(this.out?-1:1))}else this.out?this.map.setCenter(this.map.getLonLatFromPixel(e),this.map.getZoom()-1):this.map.setCenter(this.map.getLonLatFromPixel(e),this.map.getZoom()+1)},CLASS_NAME:"OpenLayers.Control.ZoomBox"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.DragPan=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,panned:!1,interval:1,documentDrag:!1,kinetic:null,enableKinetic:!1,kineticInterval:10,draw:function(){if(this.enableKinetic){var e={interval:this.kineticInterval};"object"==typeof this.enableKinetic&&(e=OpenLayers.Util.extend(e,this.enableKinetic)),this.kinetic=new OpenLayers.Kinetic(e)}this.handler=new OpenLayers.Handler.Drag(this,{move:this.panMap,done:this.panMapDone,down:this.panMapStart},{interval:this.interval,documentDrag:this.documentDrag})},panMapStart:function(){this.kinetic&&this.kinetic.begin()},panMap:function(e){this.kinetic&&this.kinetic.update(e),this.panned=!0,this.map.pan(this.handler.last.x-e.x,this.handler.last.y-e.y,{dragging:!0,animate:!1})},panMapDone:function(e){if(this.panned){var t=null;if(this.kinetic&&(t=this.kinetic.end(e)),this.map.pan(this.handler.last.x-e.x,this.handler.last.y-e.y,{dragging:!!t,animate:!1}),t){var i=this;this.kinetic.move(t,function(e,t,s){i.map.pan(e,t,{dragging:!s,animate:!1})})}this.panned=!1}},CLASS_NAME:"OpenLayers.Control.DragPan"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Handler.Click=OpenLayers.Class(OpenLayers.Handler,{delay:300,single:!0,"double":!1,pixelTolerance:0,dblclickTolerance:13,stopSingle:!1,stopDouble:!1,timerId:null,touch:!1,down:null,last:null,first:null,rightclickTimerId:null,touchstart:function(e){return this.touch||(this.unregisterMouseListeners(),this.touch=!0),this.down=this.getEventInfo(e),this.last=this.getEventInfo(e),!0},touchmove:function(e){return this.last=this.getEventInfo(e),!0},touchend:function(e){return this.down&&(e.xy=this.last.xy,e.lastTouches=this.last.touches,this.handleSingle(e),this.down=null),!0},unregisterMouseListeners:function(){this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,click:this.click,dblclick:this.dblclick,scope:this})},mousedown:function(e){return this.down=this.getEventInfo(e),this.last=this.getEventInfo(e),!0},mouseup:function(e){var t=!0;return this.checkModifiers(e)&&this.control.handleRightClicks&&OpenLayers.Event.isRightClick(e)&&(t=this.rightclick(e)),t},rightclick:function(e){if(this.passesTolerance(e)){if(null!=this.rightclickTimerId)return this.clearTimer(),this.callback("dblrightclick",[e]),!this.stopDouble;var t=this["double"]?OpenLayers.Util.extend({},e):this.callback("rightclick",[e]),i=OpenLayers.Function.bind(this.delayedRightCall,this,t);this.rightclickTimerId=window.setTimeout(i,this.delay)}return!this.stopSingle},delayedRightCall:function(e){this.rightclickTimerId=null,e&&this.callback("rightclick",[e])},click:function(e){return this.last||(this.last=this.getEventInfo(e)),this.handleSingle(e),!this.stopSingle},dblclick:function(e){return this.handleDouble(e),!this.stopDouble},handleDouble:function(e){this.passesDblclickTolerance(e)&&(this["double"]&&this.callback("dblclick",[e]),this.clearTimer())},handleSingle:function(e){if(this.passesTolerance(e))if(null!=this.timerId)this.last.touches&&1===this.last.touches.length&&(this["double"]&&OpenLayers.Event.stop(e),this.handleDouble(e)),this.last.touches&&2===this.last.touches.length||this.clearTimer();else{this.first=this.getEventInfo(e);var t=this.single?OpenLayers.Util.extend({},e):null;this.queuePotentialClick(t)}},queuePotentialClick:function(e){this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,e),this.delay)},passesTolerance:function(e){var t=!0;if(null!=this.pixelTolerance&&this.down&&this.down.xy&&(t=this.pixelTolerance>=this.down.xy.distanceTo(e.xy),t&&this.touch&&this.down.touches.length===this.last.touches.length))for(var i=0,s=this.down.touches.length;s>i;++i)if(this.getTouchDistance(this.down.touches[i],this.last.touches[i])>this.pixelTolerance){t=!1;break}return t},getTouchDistance:function(e,t){return Math.sqrt(Math.pow(e.clientX-t.clientX,2)+Math.pow(e.clientY-t.clientY,2))},passesDblclickTolerance:function(){var e=!0;return this.down&&this.first&&(e=this.down.xy.distanceTo(this.first.xy)<=this.dblclickTolerance),e},clearTimer:function(){null!=this.timerId&&(window.clearTimeout(this.timerId),this.timerId=null),null!=this.rightclickTimerId&&(window.clearTimeout(this.rightclickTimerId),this.rightclickTimerId=null)},delayedCall:function(e){this.timerId=null,e&&this.callback("click",[e])},getEventInfo:function(e){var t;if(e.touches){var i=e.touches.length;t=new Array(i);for(var s,n=0;i>n;n++)s=e.touches[n],t[n]={clientX:s.clientX,clientY:s.clientY}}return{xy:e.xy,touches:t}},deactivate:function(){var e=!1;return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.clearTimer(),this.down=null,this.first=null,this.last=null,this.touch=!1,e=!0),e},CLASS_NAME:"OpenLayers.Handler.Click"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.Navigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,pinchZoom:null,pinchZoomOptions:null,documentDrag:!1,zoomBox:null,zoomBoxEnabled:!0,zoomWheelEnabled:!0,mouseWheelOptions:null,handleRightClicks:!1,zoomBoxKeyMask:OpenLayers.Handler.MOD_SHIFT,autoActivate:!0,initialize:function(){this.handlers={},OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate(),this.dragPan&&this.dragPan.destroy(),this.dragPan=null,this.zoomBox&&this.zoomBox.destroy(),this.zoomBox=null,this.pinchZoom&&this.pinchZoom.destroy(),this.pinchZoom=null,OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){return this.dragPan.activate(),this.zoomWheelEnabled&&this.handlers.wheel.activate(),this.handlers.click.activate(),this.zoomBoxEnabled&&this.zoomBox.activate(),this.pinchZoom&&this.pinchZoom.activate(),OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){return this.pinchZoom&&this.pinchZoom.deactivate(),this.zoomBox.deactivate(),this.dragPan.deactivate(),this.handlers.click.deactivate(),this.handlers.wheel.deactivate(),OpenLayers.Control.prototype.deactivate.apply(this,arguments)},draw:function(){this.handleRightClicks&&(this.map.viewPortDiv.oncontextmenu=OpenLayers.Function.False);var e={click:this.defaultClick,dblclick:this.defaultDblClick,dblrightclick:this.defaultDblRightClick},t={"double":!0,stopDouble:!0};this.handlers.click=new OpenLayers.Handler.Click(this,e,t),this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map,documentDrag:this.documentDrag},this.dragPanOptions)),this.zoomBox=new OpenLayers.Control.ZoomBox({map:this.map,keyMask:this.zoomBoxKeyMask}),this.dragPan.draw(),this.zoomBox.draw(),this.handlers.wheel=new OpenLayers.Handler.MouseWheel(this,{up:this.wheelUp,down:this.wheelDown},this.mouseWheelOptions),OpenLayers.Control.PinchZoom&&(this.pinchZoom=new OpenLayers.Control.PinchZoom(OpenLayers.Util.extend({map:this.map},this.pinchZoomOptions)))},defaultClick:function(e){e.lastTouches&&2==e.lastTouches.length&&this.map.zoomOut()},defaultDblClick:function(e){var t=this.map.getLonLatFromViewPortPx(e.xy);this.map.setCenter(t,this.map.zoom+1)},defaultDblRightClick:function(e){var t=this.map.getLonLatFromViewPortPx(e.xy);this.map.setCenter(t,this.map.zoom-1)},wheelChange:function(e,t){var i=this.map.getZoom(),s=this.map.getZoom()+Math.round(t);if(s=Math.max(s,0),s=Math.min(s,this.map.getNumZoomLevels()),s!==i){var n=this.map.getSize(),r=n.w/2-e.xy.x,a=e.xy.y-n.h/2,o=this.map.baseLayer.getResolutionForZoom(s),l=this.map.getLonLatFromPixel(e.xy),h=new OpenLayers.LonLat(l.lon+r*o,l.lat+a*o);this.map.setCenter(h,s)}},wheelUp:function(e,t){this.wheelChange(e,t||1)},wheelDown:function(e,t){this.wheelChange(e,t||-1)},disableZoomBox:function(){this.zoomBoxEnabled=!1,this.zoomBox.deactivate()},enableZoomBox:function(){this.zoomBoxEnabled=!0,this.active&&this.zoomBox.activate()},disableZoomWheel:function(){this.zoomWheelEnabled=!1,this.handlers.wheel.deactivate()},enableZoomWheel:function(){this.zoomWheelEnabled=!0,this.active&&this.handlers.wheel.activate()},CLASS_NAME:"OpenLayers.Control.Navigation"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.DrawFeature=OpenLayers.Class(OpenLayers.Control,{layer:null,callbacks:null,multi:!1,featureAdded:function(){},handlerOptions:null,initialize:function(e,t,i){OpenLayers.Control.prototype.initialize.apply(this,[i]),this.callbacks=OpenLayers.Util.extend({done:this.drawFeature,modify:function(e,t){this.layer.events.triggerEvent("sketchmodified",{vertex:e,feature:t})},create:function(e,t){this.layer.events.triggerEvent("sketchstarted",{vertex:e,feature:t})}},this.callbacks),this.layer=e,this.handlerOptions=this.handlerOptions||{},this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{renderers:e.renderers,rendererOptions:e.rendererOptions}),"multi"in this.handlerOptions||(this.handlerOptions.multi=this.multi);var s=this.layer.styleMap&&this.layer.styleMap.styles.temporary;s&&(this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{styleMap:new OpenLayers.StyleMap({"default":s})})),this.handler=new t(this,this.callbacks,this.handlerOptions)},drawFeature:function(e){var t=new OpenLayers.Feature.Vector(e),i=this.layer.events.triggerEvent("sketchcomplete",{feature:t});i!==!1&&(t.state=OpenLayers.State.INSERT,this.layer.addFeatures([t]),this.featureAdded(t),this.events.triggerEvent("featureadded",{feature:t}))},insertXY:function(e,t){this.handler&&this.handler.line&&this.handler.insertXY(e,t)},insertDeltaXY:function(e,t){this.handler&&this.handler.line&&this.handler.insertDeltaXY(e,t)},insertDirectionLength:function(e,t){this.handler&&this.handler.line&&this.handler.insertDirectionLength(e,t)},insertDeflectionLength:function(e,t){this.handler&&this.handler.line&&this.handler.insertDeflectionLength(e,t)},undo:function(){return this.handler.undo&&this.handler.undo()},redo:function(){return this.handler.redo&&this.handler.redo()},finishSketch:function(){this.handler.finishGeometry()},cancel:function(){this.handler.cancel()},CLASS_NAME:"OpenLayers.Control.DrawFeature"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Handler.Polygon=OpenLayers.Class(OpenLayers.Handler.Path,{holeModifier:null,drawingHole:!1,polygon:null,createFeature:function(e){var t=this.layer.getLonLatFromViewPortPx(e),i=new OpenLayers.Geometry.Point(t.lon,t.lat);this.point=new OpenLayers.Feature.Vector(i),this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LinearRing([this.point.geometry])),this.polygon=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon([this.line.geometry])),this.callback("create",[this.point.geometry,this.getSketch()]),this.point.geometry.clearBounds(),this.layer.addFeatures([this.polygon,this.point],{silent:!0})},addPoint:function(){if(!this.drawingHole&&this.holeModifier&&this.evt&&this.evt[this.holeModifier])for(var e,t,i=this.point.geometry,s=this.control.layer.features,n=s.length-1;n>=0;--n)if(e=s[n].geometry,(e instanceof OpenLayers.Geometry.Polygon||e instanceof OpenLayers.Geometry.MultiPolygon)&&e.intersects(i)){t=s[n],this.control.layer.removeFeatures([t],{silent:!0}),this.control.layer.events.registerPriority("sketchcomplete",this,this.finalizeInteriorRing),this.control.layer.events.registerPriority("sketchmodified",this,this.enforceTopology),t.geometry.addComponent(this.line.geometry),this.polygon=t,this.drawingHole=!0;break}OpenLayers.Handler.Path.prototype.addPoint.apply(this,arguments)},getCurrentPointIndex:function(){return this.line.geometry.components.length-2},enforceTopology:function(e){var t=e.vertex,i=this.line.geometry.components;if(!this.polygon.geometry.intersects(t)){var s=i[i.length-3];t.x=s.x,t.y=s.y}},finishGeometry:function(){var e=this.line.geometry.components.length-2;this.line.geometry.removeComponent(this.line.geometry.components[e]),this.removePoint(),this.finalize()},finalizeInteriorRing:function(){var e=this.line.geometry,t=0!==e.getArea();if(t){for(var i=this.polygon.geometry.components,s=i.length-2;s>=0;--s)if(e.intersects(i[s])){t=!1;break}if(t)e:for(var s=i.length-2;s>0;--s)for(var n=i[s].components,r=0,a=n.length;a>r;++r)if(e.containsPoint(n[r])){t=!1;break e}}return t?this.polygon.state!==OpenLayers.State.INSERT&&(this.polygon.state=OpenLayers.State.UPDATE):this.polygon.geometry.removeComponent(e),this.restoreFeature(),!1},cancel:function(){return this.drawingHole&&(this.polygon.geometry.removeComponent(this.line.geometry),this.restoreFeature(!0)),OpenLayers.Handler.Path.prototype.cancel.apply(this,arguments)},restoreFeature:function(e){this.control.layer.events.unregister("sketchcomplete",this,this.finalizeInteriorRing),this.control.layer.events.unregister("sketchmodified",this,this.enforceTopology),this.layer.removeFeatures([this.polygon],{silent:!0}),this.control.layer.addFeatures([this.polygon],{silent:!0}),this.drawingHole=!1,e||this.control.layer.events.triggerEvent("sketchcomplete",{feature:this.polygon})},destroyFeature:function(e){OpenLayers.Handler.Path.prototype.destroyFeature.call(this,e),this.polygon=null},drawFeature:function(){this.layer.drawFeature(this.polygon,this.style),this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.polygon},getGeometry:function(){var e=this.polygon&&this.polygon.geometry;return e&&this.multi&&(e=new OpenLayers.Geometry.MultiPolygon([e])),e},CLASS_NAME:"OpenLayers.Handler.Polygon"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.EditingToolbar=OpenLayers.Class(OpenLayers.Control.Panel,{citeCompliant:!1,initialize:function(e,t){OpenLayers.Control.Panel.prototype.initialize.apply(this,[t]),this.addControls([new OpenLayers.Control.Navigation]);var i=[new OpenLayers.Control.DrawFeature(e,OpenLayers.Handler.Point,{displayClass:"olControlDrawFeaturePoint",handlerOptions:{citeCompliant:this.citeCompliant}}),new OpenLayers.Control.DrawFeature(e,OpenLayers.Handler.Path,{displayClass:"olControlDrawFeaturePath",handlerOptions:{citeCompliant:this.citeCompliant}}),new OpenLayers.Control.DrawFeature(e,OpenLayers.Handler.Polygon,{displayClass:"olControlDrawFeaturePolygon",handlerOptions:{citeCompliant:this.citeCompliant}})];this.addControls(i)},draw:function(){var e=OpenLayers.Control.Panel.prototype.draw.apply(this,arguments);return null===this.defaultControl&&(this.defaultControl=this.controls[0]),e},CLASS_NAME:"OpenLayers.Control.EditingToolbar"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Format.XML,{layerIdentifier:"_layer",featureIdentifier:"_feature",regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},gmlFormat:null,read:function(e){var t;"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e]));var i=e.documentElement;if(i){var s=this["read_"+i.nodeName];t=s?s.call(this,i):new OpenLayers.Format.GML(this.options?this.options:{}).read(e)}else t=e;return t},read_msGMLOutput:function(e){var t=[],i=this.getSiblingNodesByTagCriteria(e,this.layerIdentifier);if(i)for(var s=0,n=i.length;n>s;++s){var r=i[s],a=r.nodeName;r.prefix&&(a=a.split(":")[1]);var a=a.replace(this.layerIdentifier,""),o=this.getSiblingNodesByTagCriteria(r,this.featureIdentifier);if(o)for(var l=0;l<o.length;l++){var h=o[l],u=this.parseGeometry(h),c=this.parseAttributes(h),d=new OpenLayers.Feature.Vector(u.geometry,c,null);d.bounds=u.bounds,d.type=a,t.push(d)}}return t},read_FeatureInfoResponse:function(e){for(var t=[],i=this.getElementsByTagNameNS(e,"*","FIELDS"),s=0,n=i.length;n>s;s++){var r,a=i[s],o=null,l={},h=a.attributes.length;if(h>0)for(r=0;h>r;r++){var u=a.attributes[r];l[u.nodeName]=u.nodeValue}else{var c=a.childNodes;for(r=0,h=c.length;h>r;++r){var d=c[r];3!=d.nodeType&&(l[d.getAttribute("name")]=d.getAttribute("value"))}}t.push(new OpenLayers.Feature.Vector(o,l,null))}return t},getSiblingNodesByTagCriteria:function(e,t){var i,s,n,r,a,o=[];if(e&&e.hasChildNodes()){i=e.childNodes,n=i.length;for(var l=0;n>l;l++){for(a=i[l];a&&1!=a.nodeType;)a=a.nextSibling,l++;s=a?a.nodeName:"",s.length>0&&s.indexOf(t)>-1?o.push(a):(r=this.getSiblingNodesByTagCriteria(a,t),r.length>0&&(0==o.length?o=r:o.push(r)))}}return o},parseAttributes:function(e){var t={};if(1==e.nodeType)for(var i=e.childNodes,s=i.length,n=0;s>n;++n){var r=i[n];if(1==r.nodeType){var a=r.childNodes,o=r.prefix?r.nodeName.split(":")[1]:r.nodeName;if(0==a.length)t[o]=null;else if(1==a.length){var l=a[0];if(3==l.nodeType||4==l.nodeType){var h=l.nodeValue.replace(this.regExes.trimSpace,"");t[o]=h}}}}return t},parseGeometry:function(e){this.gmlFormat||(this.gmlFormat=new OpenLayers.Format.GML);var t,i=this.gmlFormat.parseFeature(e),s=null;return i&&(t=i.geometry&&i.geometry.clone(),s=i.bounds&&i.bounds.clone(),i.destroy()),{geometry:t,bounds:s}},CLASS_NAME:"OpenLayers.Format.WMSGetFeatureInfo"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Protocol.WFS.v1=OpenLayers.Class(OpenLayers.Protocol,{version:null,srsName:"EPSG:4326",featureType:null,featureNS:null,geometryName:"the_geom",schema:null,featurePrefix:"feature",formatOptions:null,readFormat:null,readOptions:null,initialize:function(e){OpenLayers.Protocol.prototype.initialize.apply(this,[e]),e.format||(this.format=OpenLayers.Format.WFST(OpenLayers.Util.extend({version:this.version,featureType:this.featureType,featureNS:this.featureNS,featurePrefix:this.featurePrefix,geometryName:this.geometryName,srsName:this.srsName,schema:this.schema},this.formatOptions))),!e.geometryName&&parseFloat(this.format.version)>1&&this.setGeometryName(null)},destroy:function(){this.options&&!this.options.format&&this.format.destroy(),this.format=null,OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(e){OpenLayers.Protocol.prototype.read.apply(this,arguments),e=OpenLayers.Util.extend({},e),OpenLayers.Util.applyDefaults(e,this.options||{});var t=new OpenLayers.Protocol.Response({requestType:"read"}),i=OpenLayers.Format.XML.prototype.write.apply(this.format,[this.format.writeNode("wfs:GetFeature",e)]);return t.priv=OpenLayers.Request.POST({url:e.url,callback:this.createCallback(this.handleRead,t,e),params:e.params,headers:e.headers,data:i}),t},setFeatureType:function(e){this.featureType=e,this.format.featureType=e},setGeometryName:function(e){this.geometryName=e,this.format.geometryName=e},handleRead:function(e,t){if(t=OpenLayers.Util.extend({},t),OpenLayers.Util.applyDefaults(t,this.options),t.callback){var i=e.priv;if(i.status>=200&&i.status<300){var s=this.parseResponse(i,t.readOptions);s&&s.success!==!1?(t.readOptions&&"object"==t.readOptions.output?OpenLayers.Util.extend(e,s):e.features=s,e.code=OpenLayers.Protocol.Response.SUCCESS):(e.code=OpenLayers.Protocol.Response.FAILURE,e.error=s)}else e.code=OpenLayers.Protocol.Response.FAILURE;t.callback.call(t.scope,e)}},parseResponse:function(e,t){var i=e.responseXML;if(i&&i.documentElement||(i=e.responseText),!i||i.length<=0)return null;var s=null!==this.readFormat?this.readFormat.read(i):this.format.read(i,t);if(!this.featureNS){var n=this.readFormat||this.format;this.featureNS=n.featureNS,n.autoConfig=!1,this.geometryName||this.setGeometryName(n.geometryName)}return s},commit:function(e,t){t=OpenLayers.Util.extend({},t),OpenLayers.Util.applyDefaults(t,this.options);var i=new OpenLayers.Protocol.Response({requestType:"commit",reqFeatures:e});return i.priv=OpenLayers.Request.POST({url:t.url,headers:t.headers,data:this.format.write(e,t),callback:this.createCallback(this.handleCommit,i,t)}),i},handleCommit:function(e,t){if(t.callback){var i=e.priv,s=i.responseXML;s&&s.documentElement||(s=i.responseText);var n=this.format.read(s)||{};e.insertIds=n.insertIds||[],n.success?e.code=OpenLayers.Protocol.Response.SUCCESS:(e.code=OpenLayers.Protocol.Response.FAILURE,e.error=n),t.callback.call(t.scope,e)}},filterDelete:function(e,t){t=OpenLayers.Util.extend({},t),OpenLayers.Util.applyDefaults(t,this.options),new OpenLayers.Protocol.Response({requestType:"commit"});var i=this.format.createElementNSPlus("wfs:Transaction",{attributes:{service:"WFS",version:this.version}}),s=this.format.createElementNSPlus("wfs:Delete",{attributes:{typeName:(t.featureNS?this.featurePrefix+":":"")+t.featureType}});t.featureNS&&s.setAttribute("xmlns:"+this.featurePrefix,t.featureNS);var n=this.format.writeNode("ogc:Filter",e);s.appendChild(n),i.appendChild(s);var r=OpenLayers.Format.XML.prototype.write.apply(this.format,[i]);return OpenLayers.Request.POST({url:this.url,callback:t.callback||function(){},data:r})},abort:function(e){e&&e.priv.abort()},CLASS_NAME:"OpenLayers.Protocol.WFS.v1"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.WorldWind=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{},isBaseLayer:!0,lzd:null,zoomLevels:null,initialize:function(e,t,i,s,n,r){this.lzd=i,this.zoomLevels=s;var a=[];a.push(e,t,n,r),OpenLayers.Layer.Grid.prototype.initialize.apply(this,a),this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS)},getZoom:function(){var e=this.map.getZoom();return this.map.getMaxExtent(),e-=Math.log(this.maxResolution/(this.lzd/512))/Math.log(2)},getURL:function(e){e=this.adjustBounds(e);var t=this.getZoom(),i=this.map.getMaxExtent(),s=this.lzd/Math.pow(2,this.getZoom()),n=Math.floor((e.left-i.left)/s),r=Math.floor((e.bottom-i.bottom)/s);return this.map.getResolution()<=this.lzd/512&&this.getZoom()<=this.zoomLevels?this.getFullRequestString({L:t,X:n,Y:r}):OpenLayers.Util.getImageLocation("blank.gif")},CLASS_NAME:"OpenLayers.Layer.WorldWind"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Protocol.CSW=function(e){e=OpenLayers.Util.applyDefaults(e,OpenLayers.Protocol.CSW.DEFAULTS);var t=OpenLayers.Protocol.CSW["v"+e.version.replace(/\./g,"_")];if(!t)throw"Unsupported CSW version: "+e.version;return new t(e)},OpenLayers.Protocol.CSW.DEFAULTS={version:"2.0.2"},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WMTSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",yx:{"urn:ogc:def:crs:EPSG::4326":!0},createLayer:function(e,t){var i,s={layer:!0,matrixSet:!0};for(var n in s)if(!(n in t))throw new Error("Missing property '"+n+"' in layer configuration.");var r=e.contents,a=r.tileMatrixSets[t.matrixSet];r.layers;for(var o,l=0,h=r.layers.length;h>l;++l)if(r.layers[l].identifier===t.layer){o=r.layers[l];break}if(o&&a){for(var u,l=0,h=o.styles.length;h>l&&(u=o.styles[l],!u.isDefault);++l);i=new OpenLayers.Layer.WMTS(OpenLayers.Util.applyDefaults(t,{url:"REST"===t.requestEncoding&&o.resourceUrl?o.resourceUrl.tile.template:e.operationsMetadata.GetTile.dcp.http.get[0].url,name:o.title,style:u.identifier,matrixIds:a.matrixIds,tileFullExtent:a.bounds}))}return i},CLASS_NAME:"OpenLayers.Format.WMTSCapabilities"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.Google.v3={DEFAULTS:{sphericalMercator:!0,projection:"EPSG:900913"},animationEnabled:!0,loadMapObject:function(){this.type||(this.type=google.maps.MapTypeId.ROADMAP);var e,t=OpenLayers.Layer.Google.cache[this.map.id];if(t)e=t.mapObject,++t.count;else{var i=this.map.viewPortDiv,s=document.createElement("div");s.id=this.map.id+"_GMapContainer",s.style.position="absolute",s.style.width="100%",s.style.height="100%",i.appendChild(s);var n=this.map.getCenter();e=new google.maps.Map(s,{center:n?new google.maps.LatLng(n.lat,n.lon):new google.maps.LatLng(0,0),zoom:this.map.getZoom()||0,mapTypeId:this.type,disableDefaultUI:!0,keyboardShortcuts:!1,draggable:!1,disableDoubleClickZoom:!0,scrollwheel:!1,streetViewControl:!1}),t={mapObject:e,count:1},OpenLayers.Layer.Google.cache[this.map.id]=t,this.repositionListener=google.maps.event.addListenerOnce(e,"center_changed",OpenLayers.Function.bind(this.repositionMapElements,this))}this.mapObject=e,this.setGMapVisibility(this.visibility)},repositionMapElements:function(){google.maps.event.trigger(this.mapObject,"resize");var e=this.mapObject.getDiv().firstChild;if(!e||e.childNodes.length<3)return this.repositionTimer=window.setTimeout(OpenLayers.Function.bind(this.repositionMapElements,this),250),!1;for(var t=OpenLayers.Layer.Google.cache[this.map.id],i=this.map.viewPortDiv,s=e.children.length-1;s>=0;--s){if(1000001==e.children[s].style.zIndex){var n=e.children[s];i.appendChild(n),n.style.zIndex="1100",n.style.bottom="",n.className="olLayerGoogleCopyright olLayerGoogleV3",n.style.display="",t.termsOfUse=n}if(1e6==e.children[s].style.zIndex){var r=e.children[s];i.appendChild(r),r.style.zIndex="1100",r.style.bottom="",r.className="olLayerGooglePoweredBy olLayerGoogleV3 gmnoprint",r.style.display="",t.poweredBy=r}10000002==e.children[s].style.zIndex&&i.appendChild(e.children[s])}this.setGMapVisibility(this.visibility)},onMapResize:function(){if(this.visibility)google.maps.event.trigger(this.mapObject,"resize");else{var e=OpenLayers.Layer.Google.cache[this.map.id];if(!e.resized){var t=this;google.maps.event.addListenerOnce(this.mapObject,"tilesloaded",function(){google.maps.event.trigger(t.mapObject,"resize"),t.moveTo(t.map.getCenter(),t.map.getZoom()),delete e.resized})}e.resized=!0}},setGMapVisibility:function(e){var t=OpenLayers.Layer.Google.cache[this.map.id];if(t){for(var i,s=this.type,n=this.map.layers,r=n.length-1;r>=0;--r)if(i=n[r],i instanceof OpenLayers.Layer.Google&&i.visibility===!0&&i.inRange===!0){s=i.type,e=!0;break}var a=this.mapObject.getDiv();e===!0?(this.mapObject.setMapTypeId(s),a.style.left="",t.termsOfUse&&t.termsOfUse.style&&(t.termsOfUse.style.left="",t.termsOfUse.style.display="",t.poweredBy.style.display=""),t.displayed=this.id):(delete t.displayed,a.style.left="-9999px",t.termsOfUse&&t.termsOfUse.style&&(t.termsOfUse.style.display="none",t.termsOfUse.style.left="-9999px",t.poweredBy.style.display="none"))}},getMapContainer:function(){return this.mapObject.getDiv()},getMapObjectBoundsFromOLBounds:function(e){var t=null;if(null!=e){var i=this.sphericalMercator?this.inverseMercator(e.bottom,e.left):new OpenLayers.LonLat(e.bottom,e.left),s=this.sphericalMercator?this.inverseMercator(e.top,e.right):new OpenLayers.LonLat(e.top,e.right);t=new google.maps.LatLngBounds(new google.maps.LatLng(i.lat,i.lon),new google.maps.LatLng(s.lat,s.lon))}return t},getMapObjectLonLatFromMapObjectPixel:function(e){var t=this.map.getSize(),i=this.getLongitudeFromMapObjectLonLat(this.mapObject.center),s=this.getLatitudeFromMapObjectLonLat(this.mapObject.center),n=this.map.getResolution(),r=e.x-t.w/2,a=e.y-t.h/2,o=new OpenLayers.LonLat(i+r*n,s-a*n);return this.wrapDateLine&&(o=o.wrapDateLine(this.maxExtent)),this.getMapObjectLonLatFromLonLat(o.lon,o.lat)},getMapObjectPixelFromMapObjectLonLat:function(e){var t=this.getLongitudeFromMapObjectLonLat(e),i=this.getLatitudeFromMapObjectLonLat(e),s=this.map.getResolution(),n=this.map.getExtent();return this.getMapObjectPixelFromXY(1/s*(t-n.left),1/s*(n.top-i))},setMapObjectCenter:function(e,t){if(this.animationEnabled===!1&&t!=this.mapObject.zoom){var i=this.getMapContainer();google.maps.event.addListenerOnce(this.mapObject,"idle",function(){i.style.visibility=""}),i.style.visibility="hidden"}this.mapObject.setOptions({center:e,zoom:t})},getMapObjectZoomFromMapObjectBounds:function(e){return this.mapObject.getBoundsZoomLevel(e)},getMapObjectLonLatFromLonLat:function(e,t){var i;if(this.sphericalMercator){var s=this.inverseMercator(e,t);i=new google.maps.LatLng(s.lat,s.lon)}else i=new google.maps.LatLng(t,e);return i},getMapObjectPixelFromXY:function(e,t){return new google.maps.Point(e,t)},destroy:function(){this.repositionListener&&google.maps.event.removeListener(this.repositionListener),this.repositionTimer&&window.clearTimeout(this.repositionTimer),OpenLayers.Layer.Google.prototype.destroy.apply(this,arguments)}},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WPSDescribeProcess=OpenLayers.Class(OpenLayers.Format.XML,{VERSION:"1.0.0",namespaces:{wps:"http://www.opengis.net/wps/1.0.0",ows:"http://www.opengis.net/ows/1.1",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd",defaultPrefix:"wps",regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},read:function(e){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e])),e&&9==e.nodeType&&(e=e.documentElement);var t={};return this.readNode(e,t),t},readers:{wps:{ProcessDescriptions:function(e,t){t.processDescriptions={},this.readChildNodes(e,t.processDescriptions)},ProcessDescription:function(e,t){var i=this.getAttributeNS(e,this.namespaces.wps,"processVersion"),s={processVersion:i,statusSupported:"true"===e.getAttribute("statusSupported"),storeSupported:"true"===e.getAttribute("storeSupported")};this.readChildNodes(e,s),t[s.identifier]=s},DataInputs:function(e,t){t.dataInputs=[],this.readChildNodes(e,t.dataInputs)},ProcessOutputs:function(e,t){t.processOutputs=[],this.readChildNodes(e,t.processOutputs)},Output:function(e,t){var i={};this.readChildNodes(e,i),t.push(i)},ComplexOutput:function(e,t){t.complexOutput={},this.readChildNodes(e,t.complexOutput)},Input:function(e,t){var i={maxOccurs:parseInt(e.getAttribute("maxOccurs")),minOccurs:parseInt(e.getAttribute("minOccurs"))};this.readChildNodes(e,i),t.push(i)},BoundingBoxData:function(e,t){t.boundingBoxData={},this.readChildNodes(e,t.boundingBoxData)},CRS:function(e,t){t.CRSs||(t.CRSs={}),t.CRSs[this.getChildValue(e)]=!0},LiteralData:function(e,t){t.literalData={},this.readChildNodes(e,t.literalData)},ComplexData:function(e,t){t.complexData={},this.readChildNodes(e,t.complexData)},Default:function(e,t){t["default"]={},this.readChildNodes(e,t["default"])},Supported:function(e,t){t.supported={},this.readChildNodes(e,t.supported)},Format:function(e,t){var i={};this.readChildNodes(e,i),t.formats||(t.formats={}),t.formats[i.mimeType]=!0},MimeType:function(e,t){t.mimeType=this.getChildValue(e)}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WPSDescribeProcess"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.PanZoomBar=OpenLayers.Class(OpenLayers.Control.PanZoom,{zoomStopWidth:18,zoomStopHeight:11,slider:null,sliderEvents:null,zoombarDiv:null,zoomWorldIcon:!1,panIcons:!0,forceFixedZoomLevel:!1,mouseDragStart:null,deltaY:null,zoomStart:null,destroy:function(){this._removeZoomBar(),this.map.events.un({changebaselayer:this.redraw,scope:this}),OpenLayers.Control.PanZoom.prototype.destroy.apply(this,arguments),delete this.mouseDragStart,delete this.zoomStart},setMap:function(){OpenLayers.Control.PanZoom.prototype.setMap.apply(this,arguments),this.map.events.register("changebaselayer",this,this.redraw)},redraw:function(){null!=this.div&&(this.removeButtons(),this._removeZoomBar()),this.draw()},draw:function(e){OpenLayers.Control.prototype.draw.apply(this,arguments),e=this.position.clone(),this.buttons=[];var t={w:18,h:18};if(this.panIcons){var i=new OpenLayers.Pixel(e.x+t.w/2,e.y),s=t.w;this.zoomWorldIcon&&(i=new OpenLayers.Pixel(e.x+t.w,e.y)),this._addButton("panup","north-mini.png",i,t),e.y=i.y+t.h,this._addButton("panleft","west-mini.png",e,t),this.zoomWorldIcon&&(this._addButton("zoomworld","zoom-world-mini.png",e.add(t.w,0),t),s*=2),this._addButton("panright","east-mini.png",e.add(s,0),t),this._addButton("pandown","south-mini.png",i.add(0,2*t.h),t),this._addButton("zoomin","zoom-plus-mini.png",i.add(0,3*t.h+5),t),i=this._addZoomBar(i.add(0,4*t.h+5)),this._addButton("zoomout","zoom-minus-mini.png",i,t)}else this._addButton("zoomin","zoom-plus-mini.png",e,t),i=this._addZoomBar(e.add(0,t.h)),this._addButton("zoomout","zoom-minus-mini.png",i,t),this.zoomWorldIcon&&(i=i.add(0,t.h+3),this._addButton("zoomworld","zoom-world-mini.png",i,t));return this.div},_addZoomBar:function(e){var t=OpenLayers.Util.getImageLocation("slider.png"),i=this.id+"_"+this.map.id,s=this.map.getNumZoomLevels()-1-this.map.getZoom(),n=OpenLayers.Util.createAlphaImageDiv(i,e.add(-1,s*this.zoomStopHeight),{w:20,h:9},t,"absolute");n.style.cursor="move",this.slider=n,this.sliderEvents=new OpenLayers.Events(this,n,null,!0,{includeXY:!0}),this.sliderEvents.on({touchstart:this.zoomBarDown,touchmove:this.zoomBarDrag,touchend:this.zoomBarUp,mousedown:this.zoomBarDown,mousemove:this.zoomBarDrag,mouseup:this.zoomBarUp});var r={w:this.zoomStopWidth,h:this.zoomStopHeight*this.map.getNumZoomLevels()},t=OpenLayers.Util.getImageLocation("zoombar.png"),a=null;if(OpenLayers.Util.alphaHack()){var i=this.id+"_"+this.map.id;a=OpenLayers.Util.createAlphaImageDiv(i,e,{w:r.w,h:this.zoomStopHeight},t,"absolute",null,"crop"),a.style.height=r.h+"px"}else a=OpenLayers.Util.createDiv("OpenLayers_Control_PanZoomBar_Zoombar"+this.map.id,e,r,t);return a.style.cursor="pointer",a.className="olButton",this.zoombarDiv=a,this.div.appendChild(a),this.startTop=parseInt(a.style.top),this.div.appendChild(n),this.map.events.register("zoomend",this,this.moveZoomBar),e=e.add(0,this.zoomStopHeight*this.map.getNumZoomLevels())},_removeZoomBar:function(){this.sliderEvents.un({touchstart:this.zoomBarDown,touchmove:this.zoomBarDrag,touchend:this.zoomBarUp,mousedown:this.zoomBarDown,mousemove:this.zoomBarDrag,mouseup:this.zoomBarUp}),this.sliderEvents.destroy(),this.div.removeChild(this.zoombarDiv),this.zoombarDiv=null,this.div.removeChild(this.slider),this.slider=null,this.map.events.unregister("zoomend",this,this.moveZoomBar)},onButtonClick:function(e){if(OpenLayers.Control.PanZoom.prototype.onButtonClick.apply(this,arguments),e.buttonElement===this.zoombarDiv){var t=e.buttonXY.y/this.zoomStopHeight;(this.forceFixedZoomLevel||!this.map.fractionalZoom)&&(t=Math.floor(t));var i=this.map.getNumZoomLevels()-1-t;i=Math.min(Math.max(i,0),this.map.getNumZoomLevels()-1),this.map.zoomTo(i)}},passEventToSlider:function(e){this.sliderEvents.handleBrowserEvent(e)},zoomBarDown:function(e){(OpenLayers.Event.isLeftClick(e)||OpenLayers.Event.isSingleTouch(e))&&(this.map.events.on({touchmove:this.passEventToSlider,mousemove:this.passEventToSlider,mouseup:this.passEventToSlider,scope:this}),this.mouseDragStart=e.xy.clone(),this.zoomStart=e.xy.clone(),this.div.style.cursor="move",this.zoombarDiv.offsets=null,OpenLayers.Event.stop(e))},zoomBarDrag:function(e){if(null!=this.mouseDragStart){var t=this.mouseDragStart.y-e.xy.y,i=OpenLayers.Util.pagePosition(this.zoombarDiv);if(e.clientY-i[1]>0&&e.clientY-i[1]<parseInt(this.zoombarDiv.style.height)-2){var s=parseInt(this.slider.style.top)-t;this.slider.style.top=s+"px",this.mouseDragStart=e.xy.clone()}this.deltaY=this.zoomStart.y-e.xy.y,OpenLayers.Event.stop(e)}},zoomBarUp:function(e){if((OpenLayers.Event.isLeftClick(e)||"touchend"===e.type)&&this.mouseDragStart){this.div.style.cursor="",this.map.events.un({touchmove:this.passEventToSlider,mouseup:this.passEventToSlider,mousemove:this.passEventToSlider,scope:this});var t=this.map.zoom;!this.forceFixedZoomLevel&&this.map.fractionalZoom?(t+=this.deltaY/this.zoomStopHeight,t=Math.min(Math.max(t,0),this.map.getNumZoomLevels()-1)):(t+=this.deltaY/this.zoomStopHeight,t=Math.max(Math.round(t),0)),this.map.zoomTo(t),this.mouseDragStart=null,this.zoomStart=null,this.deltaY=0,OpenLayers.Event.stop(e)}},moveZoomBar:function(){var e=(this.map.getNumZoomLevels()-1-this.map.getZoom())*this.zoomStopHeight+this.startTop+1;this.slider.style.top=e+"px"},CLASS_NAME:"OpenLayers.Control.PanZoomBar"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.CSWGetRecords.v2_0_2=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{csw:"http://www.opengis.net/cat/csw/2.0.2",dc:"http://purl.org/dc/elements/1.1/",dct:"http://purl.org/dc/terms/",gmd:"http://www.isotc211.org/2005/gmd",geonet:"http://www.fao.org/geonetwork",ogc:"http://www.opengis.net/ogc",ows:"http://www.opengis.net/ows",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"csw",version:"2.0.2",schemaLocation:"http://www.opengis.net/cat/csw/2.0.2 http://schemas.opengis.net/csw/2.0.2/CSW-discovery.xsd",requestId:null,resultType:null,outputFormat:null,outputSchema:null,startPosition:null,maxRecords:null,DistributedSearch:null,ResponseHandler:null,Query:null,regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},initialize:function(e){OpenLayers.Format.XML.prototype.initialize.apply(this,[e])},read:function(e){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e])),e&&9==e.nodeType&&(e=e.documentElement);var t={};return this.readNode(e,t),t},readers:{csw:{GetRecordsResponse:function(e,t){t.records=[],this.readChildNodes(e,t);var i=this.getAttributeNS(e,"","version");""!=i&&(t.version=i)},RequestId:function(e,t){t.RequestId=this.getChildValue(e)},SearchStatus:function(e,t){t.SearchStatus={};var i=this.getAttributeNS(e,"","timestamp");""!=i&&(t.SearchStatus.timestamp=i)},SearchResults:function(e,t){this.readChildNodes(e,t);for(var i=e.attributes,s={},n=0,r=i.length;r>n;++n)s[i[n].name]="numberOfRecordsMatched"==i[n].name||"numberOfRecordsReturned"==i[n].name||"nextRecord"==i[n].name?parseInt(i[n].nodeValue):i[n].nodeValue;t.SearchResults=s},SummaryRecord:function(e,t){var i={type:"SummaryRecord"};this.readChildNodes(e,i),t.records.push(i)},BriefRecord:function(e,t){var i={type:"BriefRecord"};this.readChildNodes(e,i),t.records.push(i)},DCMIRecord:function(e,t){var i={type:"DCMIRecord"};this.readChildNodes(e,i),t.records.push(i)},Record:function(e,t){var i={type:"Record"};this.readChildNodes(e,i),t.records.push(i)},"*":function(e,t){var i=e.localName||e.nodeName.split(":").pop();t[i]=this.getChildValue(e)}},geonet:{info:function(e,t){var i={};this.readChildNodes(e,i),t.gninfo=i}},dc:{"*":function(e,t){var i=e.localName||e.nodeName.split(":").pop();OpenLayers.Util.isArray(t[i])||(t[i]=[]);for(var s={},n=e.attributes,r=0,a=n.length;a>r;++r)s[n[r].name]=n[r].nodeValue;s.value=this.getChildValue(e),""!=s.value&&t[i].push(s)}},dct:{"*":function(e,t){var i=e.localName||e.nodeName.split(":").pop();OpenLayers.Util.isArray(t[i])||(t[i]=[]),t[i].push(this.getChildValue(e))}},ows:OpenLayers.Util.applyDefaults({BoundingBox:function(e,t){t.bounds&&(t.BoundingBox=[{crs:t.projection,value:[t.bounds.left,t.bounds.bottom,t.bounds.right,t.bounds.top]}],delete t.projection,delete t.bounds),OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows.BoundingBox.apply(this,arguments)}},OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows)},write:function(e){var t=this.writeNode("csw:GetRecords",e);return t.setAttribute("xmlns:gmd",this.namespaces.gmd),OpenLayers.Format.XML.prototype.write.apply(this,[t])},writers:{csw:{GetRecords:function(e){e||(e={});var t=this.createElementNSPlus("csw:GetRecords",{attributes:{service:"CSW",version:this.version,requestId:e.requestId||this.requestId,resultType:e.resultType||this.resultType,outputFormat:e.outputFormat||this.outputFormat,outputSchema:e.outputSchema||this.outputSchema,startPosition:e.startPosition||this.startPosition,maxRecords:e.maxRecords||this.maxRecords}});(e.DistributedSearch||this.DistributedSearch)&&this.writeNode("csw:DistributedSearch",e.DistributedSearch||this.DistributedSearch,t);var i=e.ResponseHandler||this.ResponseHandler;if(OpenLayers.Util.isArray(i)&&i.length>0)for(var s=0,n=i.length;n>s;s++)this.writeNode("csw:ResponseHandler",i[s],t);return this.writeNode("Query",e.Query||this.Query,t),t},DistributedSearch:function(e){var t=this.createElementNSPlus("csw:DistributedSearch",{attributes:{hopCount:e.hopCount}});return t},ResponseHandler:function(e){var t=this.createElementNSPlus("csw:ResponseHandler",{value:e.value});return t},Query:function(e){e||(e={});var t=this.createElementNSPlus("csw:Query",{attributes:{typeNames:e.typeNames||"csw:Record"}}),i=e.ElementName;if(OpenLayers.Util.isArray(i)&&i.length>0)for(var s=0,n=i.length;n>s;s++)this.writeNode("csw:ElementName",i[s],t);else this.writeNode("csw:ElementSetName",e.ElementSetName||{value:"summary"},t);return e.Constraint&&this.writeNode("csw:Constraint",e.Constraint,t),e.SortBy&&this.writeNode("ogc:SortBy",e.SortBy,t),t},ElementName:function(e){var t=this.createElementNSPlus("csw:ElementName",{value:e.value});return t},ElementSetName:function(e){var t=this.createElementNSPlus("csw:ElementSetName",{attributes:{typeNames:e.typeNames},value:e.value});return t},Constraint:function(e){var t=this.createElementNSPlus("csw:Constraint",{attributes:{version:e.version}});if(e.Filter){var i=new OpenLayers.Format.Filter({version:e.version});t.appendChild(i.write(e.Filter))}else if(e.CqlText){var s=this.createElementNSPlus("CqlText",{value:e.CqlText.value});t.appendChild(s)}return t}},ogc:OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc},CLASS_NAME:"OpenLayers.Format.CSWGetRecords.v2_0_2"}),/**
 * @license Apache 2 
 *  
 * Contains portions of Rico <http://openrico.org/>
 * 
 * Copyright 2005 Sabre Airline Solutions  
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you
 * may not use this file except in compliance with the License. You
 * may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0  
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
 * implied. See the License for the specific language governing
 * permissions and limitations under the License. 
 */
/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Marker.Box=OpenLayers.Class(OpenLayers.Marker,{bounds:null,div:null,initialize:function(e,t,i){this.bounds=e,this.div=OpenLayers.Util.createDiv(),this.div.style.overflow="hidden",this.events=new OpenLayers.Events(this,this.div),this.setBorder(t,i)},destroy:function(){this.bounds=null,this.div=null,OpenLayers.Marker.prototype.destroy.apply(this,arguments)},setBorder:function(e,t){e||(e="red"),t||(t=2),this.div.style.border=t+"px solid "+e},draw:function(e,t){return OpenLayers.Util.modifyDOMElement(this.div,null,e,t),this.div},onScreen:function(){var e=!1;if(this.map){var t=this.map.getExtent();e=t.containsBounds(this.bounds,!0,!0)}return e},display:function(e){this.div.style.display=e?"":"none"},CLASS_NAME:"OpenLayers.Marker.Box"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Handler.Hover=OpenLayers.Class(OpenLayers.Handler,{delay:500,pixelTolerance:null,stopMove:!1,px:null,timerId:null,mousemove:function(e){return this.passesTolerance(e.xy)&&(this.clearTimer(),this.callback("move",[e]),this.px=e.xy,e=OpenLayers.Util.extend({},e),this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,e),this.delay)),!this.stopMove},mouseout:function(e){return OpenLayers.Util.mouseLeft(e,this.map.viewPortDiv)&&(this.clearTimer(),this.callback("move",[e])),!0},passesTolerance:function(e){var t=!0;if(this.pixelTolerance&&this.px){var i=Math.sqrt(Math.pow(this.px.x-e.x,2)+Math.pow(this.px.y-e.y,2));i<this.pixelTolerance&&(t=!1)}return t},clearTimer:function(){null!=this.timerId&&(window.clearTimeout(this.timerId),this.timerId=null)},delayedCall:function(e){this.callback("pause",[e])},deactivate:function(){var e=!1;return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.clearTimer(),e=!0),e},CLASS_NAME:"OpenLayers.Handler.Hover"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.WMTSGetFeatureInfo=OpenLayers.Class(OpenLayers.Control,{hover:!1,requestEncoding:"KVP",drillDown:!1,maxFeatures:10,clickCallback:"click",layers:null,queryVisible:!0,infoFormat:"text/html",vendorParams:{},format:null,formatOptions:null,handlerOptions:null,handler:null,hoverRequest:null,pending:0,initialize:function(e){if(e=e||{},e.handlerOptions=e.handlerOptions||{},OpenLayers.Control.prototype.initialize.apply(this,[e]),this.format||(this.format=new OpenLayers.Format.WMSGetFeatureInfo(e.formatOptions)),this.drillDown===!0&&(this.hover=!1),this.hover)this.handler=new OpenLayers.Handler.Hover(this,{move:this.cancelHover,pause:this.getInfoForHover},OpenLayers.Util.extend(this.handlerOptions.hover||{},{delay:250}));else{var t={};t[this.clickCallback]=this.getInfoForClick,this.handler=new OpenLayers.Handler.Click(this,t,this.handlerOptions.click||{})}},getInfoForClick:function(e){this.request(e.xy,{})},getInfoForHover:function(e){this.request(e.xy,{hover:!0})},cancelHover:function(){this.hoverRequest&&(--this.pending,this.pending<=0&&(OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait"),this.pending=0),this.hoverRequest.abort(),this.hoverRequest=null)},findLayers:function(){for(var e,t=this.layers||this.map.layers,i=[],s=t.length-1;s>=0&&(e=t[s],!(e instanceof OpenLayers.Layer.WMTS&&e.requestEncoding===this.requestEncoding)||this.queryVisible&&!e.getVisibility()||(i.push(e),this.drillDown&&!this.hover));--s);return i},buildRequestOptions:function(e,t){var i=this.map.getLonLatFromPixel(t),s=e.getURL(new OpenLayers.Bounds(i.lon,i.lat,i.lon,i.lat)),n=OpenLayers.Util.getParameters(s),r=e.getTileInfo(i);return OpenLayers.Util.extend(n,{service:"WMTS",version:e.version,request:"GetFeatureInfo",infoFormat:this.infoFormat,i:r.i,j:r.j}),OpenLayers.Util.applyDefaults(n,this.vendorParams),{url:OpenLayers.Util.isArray(e.url)?e.url[0]:e.url,params:OpenLayers.Util.upperCaseObject(n),callback:function(i){this.handleResponse(t,i,e)},scope:this}},request:function(e,t){t=t||{};var i=this.findLayers();if(i.length>0){for(var s,n,r=0,a=i.length;a>r;r++)if(n=i[r],s=this.events.triggerEvent("beforegetfeatureinfo",{xy:e,layer:n}),s!==!1){++this.pending;var o=this.buildRequestOptions(n,e),l=OpenLayers.Request.GET(o);t.hover===!0&&(this.hoverRequest=l)}this.pending>0&&OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait")}},handleResponse:function(e,t,i){if(--this.pending,this.pending<=0&&(OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait"),this.pending=0),t.status&&(t.status<200||t.status>=300))this.events.triggerEvent("exception",{xy:e,request:t,layer:i});else{var s=t.responseXML;s&&s.documentElement||(s=t.responseText);var n,r;try{n=this.format.read(s)}catch(a){r=!0,this.events.triggerEvent("exception",{xy:e,request:t,error:a,layer:i})}r||this.events.triggerEvent("getfeatureinfo",{text:t.responseText,features:n,request:t,xy:e,layer:i})}},CLASS_NAME:"OpenLayers.Control.WMTSGetFeatureInfo"}),/* Copyright (c) 2006-2013 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WCSDescribeCoverage.v1=OpenLayers.Class(OpenLayers.Format.XML,{regExes:{trimSpace:/^\s*|\s*$/g,splitSpace:/\s+/},defaultPrefix:"wcs",read:function(e){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e])),e&&9==e.nodeType&&(e=e.documentElement);var t={};if("ExceptionReport"===e.nodeName.split(":").pop()){var i=new OpenLayers.Format.OGCExceptionReport;t.error=i.read(e)}else this.readNode(e,t);return t},CLASS_NAME:"OpenLayers.Format.WCSDescribeCoverage.v1"}),/* Copyright (c) 2006-2013 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WCSDescribeCoverage.v1_1_0=OpenLayers.Class(OpenLayers.Format.WCSDescribeCoverage.v1,{namespaces:{wcs:"http://www.opengis.net/wcs/1.1",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",ows:"http://www.opengis.net/ows/1.1"},readers:{wcs:OpenLayers.Util.applyDefaults({CoverageDescriptions:function(e,t){t.coverageDescriptions={},this.readChildNodes(e,t.coverageDescriptions),t.coverageDescriptionKeys=[];for(var i in t.coverageDescriptions)t.coverageDescriptions.hasOwnProperty(i)&&t.coverageDescriptionKeys.push(i)},CoverageDescription:function(e,t){var i={};this.readChildNodes(e,i),t[i.identifier]=i,i.nativeCRS=i.domain.spatialDomain.gridCRS.gridBaseCRS},Identifier:function(e,t){t.identifier=this.getChildValue(e)},Title:function(e,t){t.title=this.getChildValue(e)},Domain:function(e,t){t.domain={},this.readChildNodes(e,t.domain)},SpatialDomain:function(e,t){t.spatialDomain={boundingBoxes:{}};var i={BoundingBox:[]};this.readChildNodes(e,i);for(var s=0,n=i.BoundingBox.length;n>s;s++)i.BoundingBox[s].crs&&(t.spatialDomain.boundingBoxes[i.BoundingBox[s].crs]=i.BoundingBox[s].bounds);t.spatialDomain.gridCRS=i.gridCRS},GridCRS:function(e,t){t.gridCRS={},this.readChildNodes(e,t.gridCRS)},GridBaseCRS:function(e,t){t.gridBaseCRS=this.getChildValue(e)},GridType:function(e,t){t.gridType=this.getChildValue(e)},GridOrigin:function(e,t){var i=this.getChildValue(e).split(" ");2==i.length&&(t.gridOrigin={},t.gridOrigin.x=Number(i[0]),t.gridOrigin.y=Number(i[1]))},GridOffsets:function(e,t){var i=this.getChildValue(e).split(" ");2==i.length&&(t.gridOffsets={},t.gridOffsets.x=Number(i[0]),t.gridOffsets.y=Number(i[1]))},GridCS:function(e,t){t.gridCS=this.getChildValue(e)},SupportedCRS:function(e,t){t.supportedCRSs||(t.supportedCRSs=[]);var i=this.getChildValue(e);t.supportedCRSs.push(i)},SupportedFormat:function(e,t){t.supportedFormats||(t.supportedFormats=[]);var i=this.getChildValue(e);t.supportedFormats.push(i)}},OpenLayers.Format.WCSDescribeCoverage.v1.prototype.readers.wcs),ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WCSDescribeCoverage.v1_1_0"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.Scale=OpenLayers.Class(OpenLayers.Control,{element:null,geodesic:!1,initialize:function(e,t){OpenLayers.Control.prototype.initialize.apply(this,[t]),this.element=OpenLayers.Util.getElement(e)},draw:function(){return OpenLayers.Control.prototype.draw.apply(this,arguments),this.element||(this.element=document.createElement("div"),this.div.appendChild(this.element)),this.map.events.register("moveend",this,this.updateScale),this.updateScale(),this.div},updateScale:function(){var e;if(this.geodesic===!0){var t=this.map.getUnits();if(!t)return;var i=OpenLayers.INCHES_PER_UNIT;e=(this.map.getGeodesicPixelSize().w||1e-6)*i.km*OpenLayers.DOTS_PER_INCH}else e=this.map.getScale();e&&(e=e>=9500&&95e4>=e?Math.round(e/1e3)+"K":e>=95e4?Math.round(e/1e6)+"M":Math.round(e),this.element.innerHTML=OpenLayers.i18n("Scale = 1 : ${scaleDenom}",{scaleDenom:e}))},CLASS_NAME:"OpenLayers.Control.Scale"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.Button=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){},CLASS_NAME:"OpenLayers.Control.Button"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.MapGuide=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,useHttpTile:!1,singleTile:!1,useOverlay:!1,useAsyncOverlay:!0,TILE_PARAMS:{operation:"GETTILEIMAGE",version:"1.2.0"},SINGLE_TILE_PARAMS:{operation:"GETMAPIMAGE",format:"PNG",locale:"en",clip:"1",version:"1.0.0"},OVERLAY_PARAMS:{operation:"GETDYNAMICMAPOVERLAYIMAGE",format:"PNG",locale:"en",clip:"1",version:"2.0.0"},FOLDER_PARAMS:{tileColumnsPerFolder:30,tileRowsPerFolder:30,format:"png",querystring:null},defaultSize:new OpenLayers.Size(300,300),tileOriginCorner:"tl",initialize:function(e,t,i,s){OpenLayers.Layer.Grid.prototype.initialize.apply(this,arguments),(null==s||null==s.isBaseLayer)&&(this.isBaseLayer="true"!=this.transparent&&1!=this.transparent),s&&null!=s.useOverlay&&(this.useOverlay=s.useOverlay),this.singleTile?this.useOverlay?(OpenLayers.Util.applyDefaults(this.params,this.OVERLAY_PARAMS),this.useAsyncOverlay||(this.params.version="1.0.0")):OpenLayers.Util.applyDefaults(this.params,this.SINGLE_TILE_PARAMS):(this.useHttpTile?OpenLayers.Util.applyDefaults(this.params,this.FOLDER_PARAMS):OpenLayers.Util.applyDefaults(this.params,this.TILE_PARAMS),this.setTileSize(this.defaultSize))},clone:function(e){return null==e&&(e=new OpenLayers.Layer.MapGuide(this.name,this.url,this.params,this.getOptions())),e=OpenLayers.Layer.Grid.prototype.clone.apply(this,[e])},getURL:function(e){var t,i=e.getCenterLonLat(),s=this.map.getSize();if(this.singleTile){var n={setdisplaydpi:OpenLayers.DOTS_PER_INCH,setdisplayheight:s.h*this.ratio,setdisplaywidth:s.w*this.ratio,setviewcenterx:i.lon,setviewcentery:i.lat,setviewscale:this.map.getScale()};if(this.useOverlay&&!this.useAsyncOverlay){var r={};r=OpenLayers.Util.extend(r,n),r.operation="GETVISIBLEMAPEXTENT",r.version="1.0.0",r.session=this.params.session,r.mapName=this.params.mapName,r.format="text/xml",t=this.getFullRequestString(r),OpenLayers.Request.GET({url:t,async:!1})}t=this.getFullRequestString(n)}else{var a=this.map.getResolution(),o=Math.floor((e.left-this.maxExtent.left)/a);o=Math.round(o/this.tileSize.w);var l=Math.floor((this.maxExtent.top-e.top)/a);l=Math.round(l/this.tileSize.h),t=this.useHttpTile?this.getImageFilePath({tilecol:o,tilerow:l,scaleindex:this.resolutions.length-this.map.zoom-1}):this.getFullRequestString({tilecol:o,tilerow:l,scaleindex:this.resolutions.length-this.map.zoom-1})}return t},getFullRequestString:function(e,t){var i=null==t?this.url:t;"object"==typeof i&&(i=i[Math.floor(Math.random()*i.length)]);var s=i,n=OpenLayers.Util.extend({},this.params);n=OpenLayers.Util.extend(n,e);var r=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(i));for(var a in n)a.toUpperCase()in r&&delete n[a];var o=OpenLayers.Util.getParameterString(n);if(o=o.replace(/,/g,"+"),""!=o){var l=i.charAt(i.length-1);s+="&"==l||"?"==l?o:-1==i.indexOf("?")?"?"+o:"&"+o}return s},getImageFilePath:function(e,t){var i=null==t?this.url:t;"object"==typeof i&&(i=i[Math.floor(Math.random()*i.length)]);var s=i,n="",r="";e.tilerow<0&&(n="-"),n+=0==e.tilerow?"0":Math.floor(Math.abs(e.tilerow/this.params.tileRowsPerFolder))*this.params.tileRowsPerFolder,e.tilecol<0&&(r="-"),r+=0==e.tilecol?"0":Math.floor(Math.abs(e.tilecol/this.params.tileColumnsPerFolder))*this.params.tileColumnsPerFolder;var a="/S"+Math.floor(e.scaleindex)+"/"+this.params.basemaplayergroupname+"/R"+n+"/C"+r+"/"+e.tilerow%this.params.tileRowsPerFolder+"_"+e.tilecol%this.params.tileColumnsPerFolder+"."+this.params.format;return this.params.querystring&&(a+="?"+this.params.querystring),s+=a},calculateGridLayout:function(e,t,i){var s=i*this.tileSize.w,n=i*this.tileSize.h,r=e.left-t.lon,a=Math.floor(r/s)-this.buffer,o=r/s-a,l=-o*this.tileSize.w,h=t.lon+a*s,u=t.lat-e.top+n,c=Math.floor(u/n)-this.buffer,d=c-u/n,p=d*this.tileSize.h,f=t.lat-n*c;return{tilelon:s,tilelat:n,tileoffsetlon:h,tileoffsetlat:f,tileoffsetx:l,tileoffsety:p}},CLASS_NAME:"OpenLayers.Layer.MapGuide"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.Measure=OpenLayers.Class(OpenLayers.Control,{handlerOptions:null,callbacks:null,displaySystem:"metric",geodesic:!1,displaySystemUnits:{geographic:["dd"],english:["mi","ft","in"],metric:["km","m"]},partialDelay:300,delayedTrigger:null,persist:!1,immediate:!1,initialize:function(e,t){OpenLayers.Control.prototype.initialize.apply(this,[t]);var i={done:this.measureComplete,point:this.measurePartial};this.immediate&&(i.modify=this.measureImmediate),this.callbacks=OpenLayers.Util.extend(i,this.callbacks),this.handlerOptions=OpenLayers.Util.extend({persist:this.persist},this.handlerOptions),this.handler=new e(this,this.callbacks,this.handlerOptions)},deactivate:function(){return this.cancelDelay(),OpenLayers.Control.prototype.deactivate.apply(this,arguments)},cancel:function(){this.cancelDelay(),this.handler.cancel()},setImmediate:function(e){this.immediate=e,this.immediate?this.callbacks.modify=this.measureImmediate:delete this.callbacks.modify},updateHandler:function(e,t){var i=this.active;i&&this.deactivate(),this.handler=new e(this,this.callbacks,t),i&&this.activate()},measureComplete:function(e){this.cancelDelay(),this.measure(e,"measure")},measurePartial:function(e,t){this.cancelDelay(),t=t.clone(),this.handler.freehandMode(this.handler.evt)?this.measure(t,"measurepartial"):this.delayedTrigger=window.setTimeout(OpenLayers.Function.bind(function(){this.delayedTrigger=null,this.measure(t,"measurepartial")},this),this.partialDelay)},measureImmediate:function(e,t,i){i&&!this.handler.freehandMode(this.handler.evt)&&(this.cancelDelay(),this.measure(t.geometry,"measurepartial"))},cancelDelay:function(){null!==this.delayedTrigger&&(window.clearTimeout(this.delayedTrigger),this.delayedTrigger=null)},measure:function(e,t){var i,s;e.CLASS_NAME.indexOf("LineString")>-1?(i=this.getBestLength(e),s=1):(i=this.getBestArea(e),s=2),this.events.triggerEvent(t,{measure:i[0],units:i[1],order:s,geometry:e})},getBestArea:function(e){for(var t,i,s=this.displaySystemUnits[this.displaySystem],n=0,r=s.length;r>n&&(t=s[n],i=this.getArea(e,t),!(i>1));++n);return[i,t]},getArea:function(e,t){var i,s;this.geodesic?(i=e.getGeodesicArea(this.map.getProjectionObject()),s="m"):(i=e.getArea(),s=this.map.getUnits());var n=OpenLayers.INCHES_PER_UNIT[t];if(n){var r=OpenLayers.INCHES_PER_UNIT[s];i*=Math.pow(r/n,2)}return i},getBestLength:function(e){for(var t,i,s=this.displaySystemUnits[this.displaySystem],n=0,r=s.length;r>n&&(t=s[n],i=this.getLength(e,t),!(i>1));++n);return[i,t]},getLength:function(e,t){var i,s;this.geodesic?(i=e.getGeodesicLength(this.map.getProjectionObject()),s="m"):(i=e.getLength(),s=this.map.getUnits());var n=OpenLayers.INCHES_PER_UNIT[t];if(n){var r=OpenLayers.INCHES_PER_UNIT[s];i*=r/n}return i},CLASS_NAME:"OpenLayers.Control.Measure"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WMC.v1_0_0=OpenLayers.Class(OpenLayers.Format.WMC.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/context http://schemas.opengis.net/context/1.0.0/context.xsd",initialize:function(e){OpenLayers.Format.WMC.v1.prototype.initialize.apply(this,[e])},read_wmc_SRS:function(e,t){var i=this.getChildValue(t);"object"!=typeof e.projections&&(e.projections={});for(var s=i.split(/ +/),n=0,r=s.length;r>n;n++)e.projections[s[n]]=!0},write_wmc_Layer:function(e){var t=OpenLayers.Format.WMC.v1.prototype.write_wmc_Layer.apply(this,[e]);if(e.srs){var i=[];for(var s in e.srs)i.push(s);t.appendChild(this.createElementDefaultNS("SRS",i.join(" ")))}t.appendChild(this.write_wmc_FormatList(e)),t.appendChild(this.write_wmc_StyleList(e)),e.dimensions&&t.appendChild(this.write_wmc_DimensionList(e)),t.appendChild(this.write_wmc_LayerExtension(e))},CLASS_NAME:"OpenLayers.Format.WMC.v1_0_0"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Handler.Feature=OpenLayers.Class(OpenLayers.Handler,{EVENTMAP:{click:{"in":"click",out:"clickout"},mousemove:{"in":"over",out:"out"},dblclick:{"in":"dblclick",out:null},mousedown:{"in":null,out:null},mouseup:{"in":null,out:null},touchstart:{"in":"click",out:"clickout"}},feature:null,lastFeature:null,down:null,up:null,touch:!1,clickTolerance:4,geometryTypes:null,stopClick:!0,stopDown:!0,stopUp:!1,initialize:function(e,t,i,s){OpenLayers.Handler.prototype.initialize.apply(this,[e,i,s]),this.layer=t},touchstart:function(e){return this.touch||(this.touch=!0,this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,mousemove:this.mousemove,click:this.click,dblclick:this.dblclick,scope:this})),OpenLayers.Event.isMultiTouch(e)?!0:this.mousedown(e)},touchmove:function(e){OpenLayers.Event.stop(e)},mousedown:function(e){return(OpenLayers.Event.isLeftClick(e)||OpenLayers.Event.isSingleTouch(e))&&(this.down=e.xy),this.handle(e)?!this.stopDown:!0},mouseup:function(e){return this.up=e.xy,this.handle(e)?!this.stopUp:!0},click:function(e){return this.handle(e)?!this.stopClick:!0},mousemove:function(e){return this.callbacks.over||this.callbacks.out?(this.handle(e),!0):!0},dblclick:function(e){return!this.handle(e)},geometryTypeMatches:function(e){return null==this.geometryTypes||OpenLayers.Util.indexOf(this.geometryTypes,e.geometry.CLASS_NAME)>-1},handle:function(e){this.feature&&!this.feature.layer&&(this.feature=null);var t=e.type,i=!1,s=!!this.feature,n="click"==t||"dblclick"==t||"touchstart"==t;if(this.feature=this.layer.getFeatureFromEvent(e),this.feature&&!this.feature.layer&&(this.feature=null),this.lastFeature&&!this.lastFeature.layer&&(this.lastFeature=null),this.feature){"touchstart"===t&&OpenLayers.Event.stop(e);var r=this.feature!=this.lastFeature;this.geometryTypeMatches(this.feature)?(s&&r?(this.lastFeature&&this.triggerCallback(t,"out",[this.lastFeature]),this.triggerCallback(t,"in",[this.feature])):(!s||n)&&this.triggerCallback(t,"in",[this.feature]),this.lastFeature=this.feature,i=!0):(this.lastFeature&&(s&&r||n)&&this.triggerCallback(t,"out",[this.lastFeature]),this.feature=null)}else this.lastFeature&&(s||n)&&this.triggerCallback(t,"out",[this.lastFeature]);return i},triggerCallback:function(e,t,i){var s=this.EVENTMAP[e][t];if(s)if("click"==e&&this.up&&this.down){var n=Math.sqrt(Math.pow(this.up.x-this.down.x,2)+Math.pow(this.up.y-this.down.y,2));n<=this.clickTolerance&&this.callback(s,i)}else this.callback(s,i)},activate:function(){var e=!1;return OpenLayers.Handler.prototype.activate.apply(this,arguments)&&(this.moveLayerToTop(),this.map.events.on({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),e=!0),e},deactivate:function(){var e=!1;return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.moveLayerBack(),this.feature=null,this.lastFeature=null,this.down=null,this.up=null,this.touch=!1,this.map.events.un({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),e=!0),e},handleMapEvents:function(e){("removelayer"==e.type||"order"==e.property)&&this.moveLayerToTop()},moveLayerToTop:function(){var e=Math.max(this.map.Z_INDEX_BASE.Feature-1,this.layer.getZIndex())+1;this.layer.setZIndex(e)},moveLayerBack:function(){var e=this.layer.getZIndex()-1;e>=this.map.Z_INDEX_BASE.Feature?this.layer.setZIndex(e):this.map.setLayerZIndex(this.layer,this.map.getLayerIndex(this.layer))},CLASS_NAME:"OpenLayers.Handler.Feature"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.Vector.RootContainer=OpenLayers.Class(OpenLayers.Layer.Vector,{displayInLayerSwitcher:!1,layers:null,display:function(){},getFeatureFromEvent:function(e){for(var t,i=this.layers,s=0;s<i.length;s++)if(t=i[s].getFeatureFromEvent(e))return t},setMap:function(e){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments),this.collectRoots(),e.events.register("changelayer",this,this.handleChangeLayer)},removeMap:function(e){e.events.unregister("changelayer",this,this.handleChangeLayer),this.resetRoots(),OpenLayers.Layer.Vector.prototype.removeMap.apply(this,arguments)},collectRoots:function(){for(var e,t=0;t<this.map.layers.length;++t)e=this.map.layers[t],-1!=OpenLayers.Util.indexOf(this.layers,e)&&e.renderer.moveRoot(this.renderer)},resetRoots:function(){for(var e,t=0;t<this.layers.length;++t)e=this.layers[t],this.renderer&&e.renderer.getRenderLayerId()==this.id&&this.renderer.moveRoot(e.renderer)},handleChangeLayer:function(e){var t=e.layer;"order"==e.property&&-1!=OpenLayers.Util.indexOf(this.layers,t)&&(this.resetRoots(),this.collectRoots())},CLASS_NAME:"OpenLayers.Layer.Vector.RootContainer"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.SelectFeature=OpenLayers.Class(OpenLayers.Control,{multipleKey:null,toggleKey:null,multiple:!1,clickout:!0,toggle:!1,hover:!1,highlightOnly:!1,box:!1,onBeforeSelect:function(){},onSelect:function(){},onUnselect:function(){},scope:null,geometryTypes:null,layer:null,layers:null,callbacks:null,selectStyle:null,renderIntent:"select",handlers:null,initialize:function(e,t){OpenLayers.Control.prototype.initialize.apply(this,[t]),null===this.scope&&(this.scope=this),this.initLayer(e);var i={click:this.clickFeature,clickout:this.clickoutFeature};this.hover&&(i.over=this.overFeature,i.out=this.outFeature),this.callbacks=OpenLayers.Util.extend(i,this.callbacks),this.handlers={feature:new OpenLayers.Handler.Feature(this,this.layer,this.callbacks,{geometryTypes:this.geometryTypes})},this.box&&(this.handlers.box=new OpenLayers.Handler.Box(this,{done:this.selectBox},{boxDivClassName:"olHandlerBoxSelectFeature"}))},initLayer:function(e){OpenLayers.Util.isArray(e)?(this.layers=e,this.layer=new OpenLayers.Layer.Vector.RootContainer(this.id+"_container",{layers:e})):this.layer=e},destroy:function(){this.active&&this.layers&&this.map.removeLayer(this.layer),OpenLayers.Control.prototype.destroy.apply(this,arguments),this.layers&&this.layer.destroy()},activate:function(){return this.active||(this.layers&&this.map.addLayer(this.layer),this.handlers.feature.activate(),this.box&&this.handlers.box&&this.handlers.box.activate()),OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){return this.active&&(this.handlers.feature.deactivate(),this.handlers.box&&this.handlers.box.deactivate(),this.layers&&this.map.removeLayer(this.layer)),OpenLayers.Control.prototype.deactivate.apply(this,arguments)},unselectAll:function(e){for(var t,i,s=this.layers||[this.layer],n=0;n<s.length;++n){t=s[n];for(var r=t.selectedFeatures.length-1;r>=0;--r)i=t.selectedFeatures[r],e&&e.except==i||this.unselect(i)}},clickFeature:function(e){if(!this.hover){var t=OpenLayers.Util.indexOf(e.layer.selectedFeatures,e)>-1;t?this.toggleSelect()?this.unselect(e):this.multipleSelect()||this.unselectAll({except:e}):(this.multipleSelect()||this.unselectAll({except:e}),this.select(e))}},multipleSelect:function(){return this.multiple||this.handlers.feature.evt&&this.handlers.feature.evt[this.multipleKey]},toggleSelect:function(){return this.toggle||this.handlers.feature.evt&&this.handlers.feature.evt[this.toggleKey]},clickoutFeature:function(){!this.hover&&this.clickout&&this.unselectAll()},overFeature:function(e){var t=e.layer;this.hover&&(this.highlightOnly?this.highlight(e):-1==OpenLayers.Util.indexOf(t.selectedFeatures,e)&&this.select(e))},outFeature:function(e){if(this.hover)if(this.highlightOnly){if(e._lastHighlighter==this.id)if(e._prevHighlighter&&e._prevHighlighter!=this.id){delete e._lastHighlighter;var t=this.map.getControl(e._prevHighlighter);t&&t.highlight(e)}else this.unhighlight(e)}else this.unselect(e)},highlight:function(e){var t=e.layer,i=this.events.triggerEvent("beforefeaturehighlighted",{feature:e});if(i!==!1){e._prevHighlighter=e._lastHighlighter,e._lastHighlighter=this.id;var s=this.selectStyle||this.renderIntent;t.drawFeature(e,s),this.events.triggerEvent("featurehighlighted",{feature:e})}},unhighlight:function(e){var t=e.layer;void 0==e._prevHighlighter?delete e._lastHighlighter:e._prevHighlighter==this.id?delete e._prevHighlighter:(e._lastHighlighter=e._prevHighlighter,delete e._prevHighlighter),t.drawFeature(e,e.style||e.layer.style||"default"),this.events.triggerEvent("featureunhighlighted",{feature:e})},select:function(e){var t=this.onBeforeSelect.call(this.scope,e),i=e.layer;t!==!1&&(t=i.events.triggerEvent("beforefeatureselected",{feature:e}),t!==!1&&(i.selectedFeatures.push(e),this.highlight(e),this.handlers.feature.lastFeature||(this.handlers.feature.lastFeature=i.selectedFeatures[0]),i.events.triggerEvent("featureselected",{feature:e}),this.onSelect.call(this.scope,e)))},unselect:function(e){var t=e.layer;this.unhighlight(e),OpenLayers.Util.removeItem(t.selectedFeatures,e),t.events.triggerEvent("featureunselected",{feature:e}),this.onUnselect.call(this.scope,e)},selectBox:function(e){if(e instanceof OpenLayers.Bounds){var t=this.map.getLonLatFromPixel({x:e.left,y:e.bottom}),i=this.map.getLonLatFromPixel({x:e.right,y:e.top}),s=new OpenLayers.Bounds(t.lon,t.lat,i.lon,i.lat);this.multipleSelect()||this.unselectAll();var n=this.multiple;this.multiple=!0;var r=this.layers||[this.layer];this.events.triggerEvent("boxselectionstart",{layers:r});for(var a,o=0;o<r.length;++o){a=r[o];for(var l=0,h=a.features.length;h>l;++l){var u=a.features[l];u.getVisibility()&&(null==this.geometryTypes||OpenLayers.Util.indexOf(this.geometryTypes,u.geometry.CLASS_NAME)>-1)&&s.toGeometry().intersects(u.geometry)&&-1==OpenLayers.Util.indexOf(a.selectedFeatures,u)&&this.select(u)}}this.multiple=n,this.events.triggerEvent("boxselectionend",{layers:r})}},setMap:function(e){this.handlers.feature.setMap(e),this.box&&this.handlers.box.setMap(e),OpenLayers.Control.prototype.setMap.apply(this,arguments)},setLayer:function(e){var t=this.active;this.unselectAll(),this.deactivate(),this.layers&&(this.layer.destroy(),this.layers=null),this.initLayer(e),this.handlers.feature.layer=this.layer,t&&this.activate()},CLASS_NAME:"OpenLayers.Control.SelectFeature"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Popup.Anchored=OpenLayers.Class(OpenLayers.Popup,{relativePosition:null,keepInMap:!0,anchor:null,initialize:function(e,t,i,s,n,r,a){var o=[e,t,i,s,r,a];OpenLayers.Popup.prototype.initialize.apply(this,o),this.anchor=null!=n?n:{size:new OpenLayers.Size(0,0),offset:new OpenLayers.Pixel(0,0)}},destroy:function(){this.anchor=null,this.relativePosition=null,OpenLayers.Popup.prototype.destroy.apply(this,arguments)},show:function(){this.updatePosition(),OpenLayers.Popup.prototype.show.apply(this,arguments)},moveTo:function(e){var t=this.relativePosition;this.relativePosition=this.calculateRelativePosition(e);var i=this.calculateNewPx(e),s=new Array(i);OpenLayers.Popup.prototype.moveTo.apply(this,s),this.relativePosition!=t&&this.updateRelativePosition()},setSize:function(){if(OpenLayers.Popup.prototype.setSize.apply(this,arguments),this.lonlat&&this.map){var e=this.map.getLayerPxFromLonLat(this.lonlat);this.moveTo(e)}},calculateRelativePosition:function(e){var t=this.map.getLonLatFromLayerPx(e),i=this.map.getExtent(),s=i.determineQuadrant(t);return OpenLayers.Bounds.oppositeQuadrant(s)},updateRelativePosition:function(){},calculateNewPx:function(e){var t=e.offset(this.anchor.offset),i=this.size||this.contentSize,s="t"==this.relativePosition.charAt(0);t.y+=s?-i.h:this.anchor.size.h;var n="l"==this.relativePosition.charAt(1);return t.x+=n?-i.w:this.anchor.size.w,t},CLASS_NAME:"OpenLayers.Popup.Anchored"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Popup.Framed=OpenLayers.Class(OpenLayers.Popup.Anchored,{imageSrc:null,imageSize:null,isAlphaImage:!1,positionBlocks:null,blocks:null,fixedRelativePosition:!1,initialize:function(e,t,i,s,n,r){OpenLayers.Popup.Anchored.prototype.initialize.apply(this,arguments),this.fixedRelativePosition&&(this.updateRelativePosition(),this.calculateRelativePosition=function(){return this.relativePosition}),this.contentDiv.style.position="absolute",this.contentDiv.style.zIndex=1,r&&(this.closeDiv.style.zIndex=1),this.groupDiv.style.position="absolute",this.groupDiv.style.top="0px",this.groupDiv.style.left="0px",this.groupDiv.style.height="100%",this.groupDiv.style.width="100%"},destroy:function(){this.imageSrc=null,this.imageSize=null,this.isAlphaImage=null,this.fixedRelativePosition=!1,this.positionBlocks=null;for(var e=0;e<this.blocks.length;e++){var t=this.blocks[e];t.image&&t.div.removeChild(t.image),t.image=null,t.div&&this.groupDiv.removeChild(t.div),t.div=null}this.blocks=null,OpenLayers.Popup.Anchored.prototype.destroy.apply(this,arguments)},setBackgroundColor:function(){},setBorder:function(){},setOpacity:function(){},setSize:function(){OpenLayers.Popup.Anchored.prototype.setSize.apply(this,arguments),this.updateBlocks()},updateRelativePosition:function(){if(this.padding=this.positionBlocks[this.relativePosition].padding,this.closeDiv){var e=this.getContentDivPadding();this.closeDiv.style.right=e.right+this.padding.right+"px",this.closeDiv.style.top=e.top+this.padding.top+"px"}this.updateBlocks()},calculateNewPx:function(){var e=OpenLayers.Popup.Anchored.prototype.calculateNewPx.apply(this,arguments);return e=e.offset(this.positionBlocks[this.relativePosition].offset)},createBlocks:function(){this.blocks=[];var e=null;for(var t in this.positionBlocks){e=t;break}for(var i=this.positionBlocks[e],s=0;s<i.blocks.length;s++){var n={};this.blocks.push(n);var r=this.id+"_FrameDecorationDiv_"+s;n.div=OpenLayers.Util.createDiv(r,null,null,null,"absolute",null,"hidden",null);var a=this.id+"_FrameDecorationImg_"+s,o=this.isAlphaImage?OpenLayers.Util.createAlphaImageDiv:OpenLayers.Util.createImage;n.image=o(a,null,this.imageSize,this.imageSrc,"absolute",null,null,null),n.div.appendChild(n.image),this.groupDiv.appendChild(n.div)}},updateBlocks:function(){if(this.blocks||this.createBlocks(),this.size&&this.relativePosition){for(var e=this.positionBlocks[this.relativePosition],t=0;t<e.blocks.length;t++){var i=e.blocks[t],s=this.blocks[t],n=i.anchor.left,r=i.anchor.bottom,a=i.anchor.right,o=i.anchor.top,l=isNaN(i.size.w)?this.size.w-(a+n):i.size.w,h=isNaN(i.size.h)?this.size.h-(r+o):i.size.h;s.div.style.width=(0>l?0:l)+"px",s.div.style.height=(0>h?0:h)+"px",s.div.style.left=null!=n?n+"px":"",s.div.style.bottom=null!=r?r+"px":"",s.div.style.right=null!=a?a+"px":"",s.div.style.top=null!=o?o+"px":"",s.image.style.left=i.position.x+"px",s.image.style.top=i.position.y+"px"}this.contentDiv.style.left=this.padding.left+"px",this.contentDiv.style.top=this.padding.top+"px"}},CLASS_NAME:"OpenLayers.Popup.Framed"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Popup.FramedCloud=OpenLayers.Class(OpenLayers.Popup.Framed,{contentDisplayClass:"olFramedCloudPopupContent",autoSize:!0,panMapIfOutOfView:!0,imageSize:new OpenLayers.Size(1276,736),isAlphaImage:!1,fixedRelativePosition:!1,positionBlocks:{tl:{offset:new OpenLayers.Pixel(44,0),padding:new OpenLayers.Bounds(8,40,8,9),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,51,22,0),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,50,0,0),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",19),anchor:new OpenLayers.Bounds(0,32,22,null),position:new OpenLayers.Pixel(0,-631)},{size:new OpenLayers.Size(22,18),anchor:new OpenLayers.Bounds(null,32,0,null),position:new OpenLayers.Pixel(-1238,-632)},{size:new OpenLayers.Size(81,35),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(0,-688)}]},tr:{offset:new OpenLayers.Pixel(-45,0),padding:new OpenLayers.Bounds(8,40,8,9),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,51,22,0),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,50,0,0),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",19),anchor:new OpenLayers.Bounds(0,32,22,null),position:new OpenLayers.Pixel(0,-631)},{size:new OpenLayers.Size(22,19),anchor:new OpenLayers.Bounds(null,32,0,null),position:new OpenLayers.Pixel(-1238,-631)},{size:new OpenLayers.Size(81,35),anchor:new OpenLayers.Bounds(0,0,null,null),position:new OpenLayers.Pixel(-215,-687)}]},bl:{offset:new OpenLayers.Pixel(45,0),padding:new OpenLayers.Bounds(8,9,8,40),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,21,22,32),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,21,0,32),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",21),anchor:new OpenLayers.Bounds(0,0,22,null),position:new OpenLayers.Pixel(0,-629)},{size:new OpenLayers.Size(22,21),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(-1238,-629)},{size:new OpenLayers.Size(81,33),anchor:new OpenLayers.Bounds(null,null,0,0),position:new OpenLayers.Pixel(-101,-674)}]},br:{offset:new OpenLayers.Pixel(-44,0),padding:new OpenLayers.Bounds(8,9,8,40),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,21,22,32),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,21,0,32),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",21),anchor:new OpenLayers.Bounds(0,0,22,null),position:new OpenLayers.Pixel(0,-629)},{size:new OpenLayers.Size(22,21),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(-1238,-629)},{size:new OpenLayers.Size(81,33),anchor:new OpenLayers.Bounds(0,null,null,0),position:new OpenLayers.Pixel(-311,-674)}]}},minSize:new OpenLayers.Size(105,10),maxSize:new OpenLayers.Size(1200,660),initialize:function(){this.imageSrc=OpenLayers.Util.getImageLocation("cloud-popup-relative.png"),OpenLayers.Popup.Framed.prototype.initialize.apply(this,arguments),this.contentDiv.className=this.contentDisplayClass},CLASS_NAME:"OpenLayers.Popup.FramedCloud"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.SOSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.SOSCapabilities,{namespaces:{ows:"http://www.opengis.net/ows/1.1",sos:"http://www.opengis.net/sos/1.0",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},initialize:function(e){OpenLayers.Format.XML.prototype.initialize.apply(this,[e]),this.options=e},read:function(e){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e])),e&&9==e.nodeType&&(e=e.documentElement);var t={};return this.readNode(e,t),t},readers:{gml:OpenLayers.Util.applyDefaults({name:function(e,t){t.name=this.getChildValue(e)},TimePeriod:function(e,t){t.timePeriod={},this.readChildNodes(e,t.timePeriod)},beginPosition:function(e,t){t.beginPosition=this.getChildValue(e)},endPosition:function(e,t){t.endPosition=this.getChildValue(e)}},OpenLayers.Format.GML.v3.prototype.readers.gml),sos:{Capabilities:function(e,t){this.readChildNodes(e,t)},Contents:function(e,t){t.contents={},this.readChildNodes(e,t.contents)},ObservationOfferingList:function(e,t){t.offeringList={},this.readChildNodes(e,t.offeringList)},ObservationOffering:function(e,t){var i=this.getAttributeNS(e,this.namespaces.gml,"id");t[i]={procedures:[],observedProperties:[],featureOfInterestIds:[],responseFormats:[],resultModels:[],responseModes:[]},this.readChildNodes(e,t[i])},time:function(e,t){t.time={},this.readChildNodes(e,t.time)},procedure:function(e,t){t.procedures.push(this.getAttributeNS(e,this.namespaces.xlink,"href"))},observedProperty:function(e,t){t.observedProperties.push(this.getAttributeNS(e,this.namespaces.xlink,"href"))},featureOfInterest:function(e,t){t.featureOfInterestIds.push(this.getAttributeNS(e,this.namespaces.xlink,"href"))},responseFormat:function(e,t){t.responseFormats.push(this.getChildValue(e))},resultModel:function(e,t){t.resultModels.push(this.getChildValue(e))},responseMode:function(e,t){t.responseModes.push(this.getChildValue(e))}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.SOSCapabilities.v1_0_0"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Handler.Pinch=OpenLayers.Class(OpenLayers.Handler,{started:!1,stopDown:!1,pinching:!1,last:null,start:null,touchstart:function(e){var t=!0;return this.pinching=!1,OpenLayers.Event.isMultiTouch(e)?(this.started=!0,this.last=this.start={distance:this.getDistance(e.touches),delta:0,scale:1},this.callback("start",[e,this.start]),t=!this.stopDown):(this.started=!1,this.start=null,this.last=null),OpenLayers.Event.stop(e),t},touchmove:function(e){if(this.started&&OpenLayers.Event.isMultiTouch(e)){this.pinching=!0;var t=this.getPinchData(e);this.callback("move",[e,t]),this.last=t,OpenLayers.Event.stop(e)}return!0},touchend:function(e){return this.started&&(this.started=!1,this.pinching=!1,this.callback("done",[e,this.start,this.last]),this.start=null,this.last=null),!0},activate:function(){var e=!1;return OpenLayers.Handler.prototype.activate.apply(this,arguments)&&(this.pinching=!1,e=!0),e},deactivate:function(){var e=!1;return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.started=!1,this.pinching=!1,this.start=null,this.last=null,e=!0),e},getDistance:function(e){var t=e[0],i=e[1];return Math.sqrt(Math.pow(t.clientX-i.clientX,2)+Math.pow(t.clientY-i.clientY,2))},getPinchData:function(e){var t=this.getDistance(e.touches),i=t/this.start.distance;return{distance:t,delta:this.last.distance-t,scale:i}},CLASS_NAME:"OpenLayers.Handler.Pinch"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.Text=OpenLayers.Class(OpenLayers.Format,{defaultStyle:null,extractStyles:!0,initialize:function(e){e=e||{},e.extractStyles!==!1&&(e.defaultStyle={externalGraphic:OpenLayers.Util.getImageLocation("marker.png"),graphicWidth:21,graphicHeight:25,graphicXOffset:-10.5,graphicYOffset:-12.5}),OpenLayers.Format.prototype.initialize.apply(this,[e])},read:function(e){for(var t,i=e.split("\n"),s=[],n=0;n<i.length-1;n++){var r=i[n].replace(/^\s*/,"").replace(/\s*$/,"");if("#"!=r.charAt(0))if(t){for(var a=r.split("	"),o=new OpenLayers.Geometry.Point(0,0),l={},h=this.defaultStyle?OpenLayers.Util.applyDefaults({},this.defaultStyle):null,u=!1,c=0;c<a.length;c++)if(a[c])if("point"==t[c]){var d=a[c].split(",");o.y=parseFloat(d[0]),o.x=parseFloat(d[1]),u=!0}else if("lat"==t[c])o.y=parseFloat(a[c]),u=!0;else if("lon"==t[c])o.x=parseFloat(a[c]),u=!0;else if("title"==t[c])l.title=a[c];else if("image"==t[c]||"icon"==t[c]&&h)h.externalGraphic=a[c];else if("iconSize"==t[c]&&h){var p=a[c].split(",");h.graphicWidth=parseFloat(p[0]),h.graphicHeight=parseFloat(p[1])}else if("iconOffset"==t[c]&&h){var f=a[c].split(",");h.graphicXOffset=parseFloat(f[0]),h.graphicYOffset=parseFloat(f[1])}else"description"==t[c]?l.description=a[c]:"overflow"==t[c]?l.overflow=a[c]:l[t[c]]=a[c];if(u){this.internalProjection&&this.externalProjection&&o.transform(this.externalProjection,this.internalProjection);var m=new OpenLayers.Feature.Vector(o,l,h);s.push(m)}}else t=r.split("	")}return s},CLASS_NAME:"OpenLayers.Format.Text"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.NavToolbar=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(e){OpenLayers.Control.Panel.prototype.initialize.apply(this,[e]),this.addControls([new OpenLayers.Control.Navigation,new OpenLayers.Control.ZoomBox])},draw:function(){var e=OpenLayers.Control.Panel.prototype.draw.apply(this,arguments);return null===this.defaultControl&&(this.defaultControl=this.controls[0]),e},CLASS_NAME:"OpenLayers.Control.NavToolbar"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Strategy.Refresh=OpenLayers.Class(OpenLayers.Strategy,{force:!1,interval:0,timer:null,activate:function(){var e=OpenLayers.Strategy.prototype.activate.call(this);return e&&(this.layer.visibility===!0&&this.start(),this.layer.events.on({visibilitychanged:this.reset,scope:this})),e},deactivate:function(){var e=OpenLayers.Strategy.prototype.deactivate.call(this);return e&&this.stop(),e},reset:function(){this.layer.visibility===!0?this.start():this.stop()},start:function(){this.interval&&"number"==typeof this.interval&&this.interval>0&&(this.timer=window.setInterval(OpenLayers.Function.bind(this.refresh,this),this.interval))},refresh:function(){this.layer&&this.layer.refresh&&"function"==typeof this.layer.refresh&&this.layer.refresh({force:this.force})},stop:function(){null!==this.timer&&(window.clearInterval(this.timer),this.timer=null)},CLASS_NAME:"OpenLayers.Strategy.Refresh"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.ArcGIS93Rest=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{format:"png"},isBaseLayer:!0,initialize:function(e,t,i,s){var n=[];i=OpenLayers.Util.upperCaseObject(i),n.push(e,t,i,s),OpenLayers.Layer.Grid.prototype.initialize.apply(this,n),OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS)),this.params.TRANSPARENT&&"true"==this.params.TRANSPARENT.toString().toLowerCase()&&(null!=s&&s.isBaseLayer||(this.isBaseLayer=!1),"jpg"==this.params.FORMAT&&(this.params.FORMAT=OpenLayers.Util.alphaHack()?"gif":"png"))},clone:function(e){return null==e&&(e=new OpenLayers.Layer.ArcGIS93Rest(this.name,this.url,this.params,this.getOptions())),e=OpenLayers.Layer.Grid.prototype.clone.apply(this,[e])},getURL:function(e){e=this.adjustBounds(e);var t=this.projection.getCode().split(":"),i=t[t.length-1],s=this.getImageSize(),n={BBOX:e.toBBOX(),SIZE:s.w+","+s.h,F:"image",BBOXSR:i,IMAGESR:i};if(this.layerDefs){var r,a=[];for(r in this.layerDefs)this.layerDefs.hasOwnProperty(r)&&this.layerDefs[r]&&(a.push(r),a.push(":"),a.push(this.layerDefs[r]),a.push(";"));a.length>0&&(n.LAYERDEFS=a.join(""))}var o=this.getFullRequestString(n);return o},setLayerFilter:function(e,t){this.layerDefs||(this.layerDefs={}),t?this.layerDefs[e]=t:delete this.layerDefs[e]},clearLayerFilter:function(e){e?delete this.layerDefs[e]:delete this.layerDefs},mergeNewParams:function(e){var t=OpenLayers.Util.upperCaseObject(e),i=[t];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,i)},CLASS_NAME:"OpenLayers.Layer.ArcGIS93Rest"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WKT=OpenLayers.Class(OpenLayers.Format,{initialize:function(e){this.regExes={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},OpenLayers.Format.prototype.initialize.apply(this,[e])},read:function(e){var t,i,s;e=e.replace(/[\n\r]/g," ");var n=this.regExes.typeStr.exec(e);if(n&&(i=n[1].toLowerCase(),s=n[2],this.parse[i]&&(t=this.parse[i].apply(this,[s])),this.internalProjection&&this.externalProjection))if(t&&"OpenLayers.Feature.Vector"==t.CLASS_NAME)t.geometry.transform(this.externalProjection,this.internalProjection);else if(t&&"geometrycollection"!=i&&"object"==typeof t)for(var r=0,a=t.length;a>r;r++){var o=t[r];o.geometry.transform(this.externalProjection,this.internalProjection)}return t},write:function(e){var t,i,s;e.constructor==Array?(t=e,s=!0):(t=[e],s=!1);var n=[];s&&n.push("GEOMETRYCOLLECTION(");for(var r=0,a=t.length;a>r;++r)s&&r>0&&n.push(","),i=t[r].geometry,n.push(this.extractGeometry(i));return s&&n.push(")"),n.join("")},extractGeometry:function(e){var t=e.CLASS_NAME.split(".")[2].toLowerCase();if(!this.extract[t])return null;this.internalProjection&&this.externalProjection&&(e=e.clone(),e.transform(this.internalProjection,this.externalProjection));var i="collection"==t?"GEOMETRYCOLLECTION":t.toUpperCase(),s=i+"("+this.extract[t].apply(this,[e])+")";return s},extract:{point:function(e){return e.x+" "+e.y},multipoint:function(e){for(var t=[],i=0,s=e.components.length;s>i;++i)t.push("("+this.extract.point.apply(this,[e.components[i]])+")");return t.join(",")},linestring:function(e){for(var t=[],i=0,s=e.components.length;s>i;++i)t.push(this.extract.point.apply(this,[e.components[i]]));return t.join(",")},multilinestring:function(e){for(var t=[],i=0,s=e.components.length;s>i;++i)t.push("("+this.extract.linestring.apply(this,[e.components[i]])+")");return t.join(",")},polygon:function(e){for(var t=[],i=0,s=e.components.length;s>i;++i)t.push("("+this.extract.linestring.apply(this,[e.components[i]])+")");return t.join(",")},multipolygon:function(e){for(var t=[],i=0,s=e.components.length;s>i;++i)t.push("("+this.extract.polygon.apply(this,[e.components[i]])+")");return t.join(",")},collection:function(e){for(var t=[],i=0,s=e.components.length;s>i;++i)t.push(this.extractGeometry.apply(this,[e.components[i]]));return t.join(",")}},parse:{point:function(e){var t=OpenLayers.String.trim(e).split(this.regExes.spaces);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(t[0],t[1]))},multipoint:function(e){for(var t,i=OpenLayers.String.trim(e).split(","),s=[],n=0,r=i.length;r>n;++n)t=i[n].replace(this.regExes.trimParens,"$1"),s.push(this.parse.point.apply(this,[t]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPoint(s))},linestring:function(e){for(var t=OpenLayers.String.trim(e).split(","),i=[],s=0,n=t.length;n>s;++s)i.push(this.parse.point.apply(this,[t[s]]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(i))},multilinestring:function(e){for(var t,i=OpenLayers.String.trim(e).split(this.regExes.parenComma),s=[],n=0,r=i.length;r>n;++n)t=i[n].replace(this.regExes.trimParens,"$1"),s.push(this.parse.linestring.apply(this,[t]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiLineString(s))},polygon:function(e){for(var t,i,s,n=OpenLayers.String.trim(e).split(this.regExes.parenComma),r=[],a=0,o=n.length;o>a;++a)t=n[a].replace(this.regExes.trimParens,"$1"),i=this.parse.linestring.apply(this,[t]).geometry,s=new OpenLayers.Geometry.LinearRing(i.components),r.push(s);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon(r))},multipolygon:function(e){for(var t,i=OpenLayers.String.trim(e).split(this.regExes.doubleParenComma),s=[],n=0,r=i.length;r>n;++n)t=i[n].replace(this.regExes.trimParens,"$1"),s.push(this.parse.polygon.apply(this,[t]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPolygon(s))},geometrycollection:function(e){e=e.replace(/,\s*([A-Za-z])/g,"|$1");for(var t=OpenLayers.String.trim(e).split("|"),i=[],s=0,n=t.length;n>s;++s)i.push(OpenLayers.Format.WKT.prototype.read.apply(this,[t[s]]));return i}},CLASS_NAME:"OpenLayers.Format.WKT"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.GetFeature=OpenLayers.Class(OpenLayers.Control,{protocol:null,multipleKey:null,toggleKey:null,modifiers:null,multiple:!1,click:!0,single:!0,clickout:!0,toggle:!1,clickTolerance:5,hover:!1,box:!1,maxFeatures:10,features:null,hoverFeature:null,handlerOptions:null,handlers:null,hoverResponse:null,filterType:OpenLayers.Filter.Spatial.BBOX,initialize:function(e){e.handlerOptions=e.handlerOptions||{},OpenLayers.Control.prototype.initialize.apply(this,[e]),this.features={},this.handlers={},this.click&&(this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.selectClick},this.handlerOptions.click||{})),this.box&&(this.handlers.box=new OpenLayers.Handler.Box(this,{done:this.selectBox},OpenLayers.Util.extend(this.handlerOptions.box,{boxDivClassName:"olHandlerBoxSelectFeature"}))),this.hover&&(this.handlers.hover=new OpenLayers.Handler.Hover(this,{move:this.cancelHover,pause:this.selectHover},OpenLayers.Util.extend(this.handlerOptions.hover,{delay:250,pixelTolerance:2})))},activate:function(){if(!this.active)for(var e in this.handlers)this.handlers[e].activate();return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){if(this.active)for(var e in this.handlers)this.handlers[e].deactivate();return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},selectClick:function(e){var t=this.pixelToBounds(e.xy);this.setModifiers(e),this.request(t,{single:this.single})},selectBox:function(e){var t;if(e instanceof OpenLayers.Bounds){var i=this.map.getLonLatFromPixel({x:e.left,y:e.bottom}),s=this.map.getLonLatFromPixel({x:e.right,y:e.top});t=new OpenLayers.Bounds(i.lon,i.lat,s.lon,s.lat)}else{if(this.click)return;t=this.pixelToBounds(e)}this.setModifiers(this.handlers.box.dragHandler.evt),this.request(t)},selectHover:function(e){var t=this.pixelToBounds(e.xy);this.request(t,{single:!0,hover:!0})},cancelHover:function(){this.hoverResponse&&(this.protocol.abort(this.hoverResponse),this.hoverResponse=null,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait"))},request:function(e,t){t=t||{};var i=new OpenLayers.Filter.Spatial({type:this.filterType,value:e});OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait");var s=this.protocol.read({maxFeatures:1==t.single?this.maxFeatures:void 0,filter:i,callback:function(i){i.success()&&(i.features.length?1==t.single?this.selectBestFeature(i.features,e.getCenterLonLat(),t):this.select(i.features):t.hover?this.hoverSelect():(this.events.triggerEvent("clickout"),this.clickout&&this.unselectAll())),OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait")},scope:this});1==t.hover&&(this.hoverResponse=s)},selectBestFeature:function(e,t,i){if(i=i||{},e.length){for(var s,n,r,a=new OpenLayers.Geometry.Point(t.lon,t.lat),o=Number.MAX_VALUE,l=0;l<e.length&&(s=e[l],!(s.geometry&&(r=a.distanceTo(s.geometry,{edge:!1}),o>r&&(o=r,n=s,0==o))));++l);1==i.hover?this.hoverSelect(n):this.select(n||e)}},setModifiers:function(e){this.modifiers={multiple:this.multiple||this.multipleKey&&e[this.multipleKey],toggle:this.toggle||this.toggleKey&&e[this.toggleKey]}},select:function(e){this.modifiers.multiple||this.modifiers.toggle||this.unselectAll(),OpenLayers.Util.isArray(e)||(e=[e]);var t=this.events.triggerEvent("beforefeaturesselected",{features:e});if(t!==!1){for(var i,s=[],n=0,r=e.length;r>n;++n)i=e[n],this.features[i.fid||i.id]?this.modifiers.toggle&&this.unselect(this.features[i.fid||i.id]):(t=this.events.triggerEvent("beforefeatureselected",{feature:i}),t!==!1&&(this.features[i.fid||i.id]=i,s.push(i),this.events.triggerEvent("featureselected",{feature:i})));this.events.triggerEvent("featuresselected",{features:s})}},hoverSelect:function(e){var t=e?e.fid||e.id:null,i=this.hoverFeature?this.hoverFeature.fid||this.hoverFeature.id:null;i&&i!=t&&(this.events.triggerEvent("outfeature",{feature:this.hoverFeature}),this.hoverFeature=null),t&&t!=i&&(this.events.triggerEvent("hoverfeature",{feature:e}),this.hoverFeature=e)},unselect:function(e){delete this.features[e.fid||e.id],this.events.triggerEvent("featureunselected",{feature:e})},unselectAll:function(){for(var e in this.features)this.unselect(this.features[e])},setMap:function(e){for(var t in this.handlers)this.handlers[t].setMap(e);OpenLayers.Control.prototype.setMap.apply(this,arguments)},pixelToBounds:function(e){var t=e.add(-this.clickTolerance/2,this.clickTolerance/2),i=e.add(this.clickTolerance/2,-this.clickTolerance/2),s=this.map.getLonLatFromPixel(t),n=this.map.getLonLatFromPixel(i);return new OpenLayers.Bounds(s.lon,s.lat,n.lon,n.lat)},CLASS_NAME:"OpenLayers.Control.GetFeature"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.QueryStringFilter=function(){function e(e){return e=e.replace(/%/g,"\\%"),e=e.replace(/\\\\\.(\*)?/g,function(e,t){return t?e:"\\\\_"}),e=e.replace(/\\\\\.\*/g,"\\\\%"),e=e.replace(/(\\)?\.(\*)?/g,function(e,t,i){return t||i?e:"_"}),e=e.replace(/(\\)?\.\*/g,function(e,t){return t?e:"%"}),e=e.replace(/\\\./g,"."),e=e.replace(/(\\)?\\\*/g,function(e,t){return t?e:"*"})}var t={};return t[OpenLayers.Filter.Comparison.EQUAL_TO]="eq",t[OpenLayers.Filter.Comparison.NOT_EQUAL_TO]="ne",t[OpenLayers.Filter.Comparison.LESS_THAN]="lt",t[OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO]="lte",t[OpenLayers.Filter.Comparison.GREATER_THAN]="gt",t[OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO]="gte",t[OpenLayers.Filter.Comparison.LIKE]="ilike",OpenLayers.Class(OpenLayers.Format,{wildcarded:!1,srsInBBOX:!1,write:function(i,s){s=s||{};var n=i.CLASS_NAME,r=n.substring(n.lastIndexOf(".")+1);switch(r){case"Spatial":switch(i.type){case OpenLayers.Filter.Spatial.BBOX:s.bbox=i.value.toArray(),this.srsInBBOX&&i.projection&&s.bbox.push(i.projection.getCode());break;case OpenLayers.Filter.Spatial.DWITHIN:s.tolerance=i.distance;case OpenLayers.Filter.Spatial.WITHIN:s.lon=i.value.x,s.lat=i.value.y;break;default:OpenLayers.Console.warn("Unknown spatial filter type "+i.type)}break;case"Comparison":var a=t[i.type];if(void 0!==a){var o=i.value;i.type==OpenLayers.Filter.Comparison.LIKE&&(o=e(o),this.wildcarded&&(o="%"+o+"%")),s[i.property+"__"+a]=o,s.queryable=s.queryable||[],s.queryable.push(i.property)}else OpenLayers.Console.warn("Unknown comparison filter type "+i.type);break;case"Logical":if(i.type===OpenLayers.Filter.Logical.AND)for(var l=0,h=i.filters.length;h>l;l++)s=this.write(i.filters[l],s);else OpenLayers.Console.warn("Unsupported logical filter type "+i.type);break;default:OpenLayers.Console.warn("Unknown filter type "+r)}return s},CLASS_NAME:"OpenLayers.Format.QueryStringFilter"})}(),/* Copyright (c) 2006-2013 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WCSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WCSCapabilities.v1,{namespaces:{wcs:"http://www.opengis.net/wcs/1.1",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",ows:"http://www.opengis.net/ows/1.1"},errorProperty:"operationsMetadata",readers:{wcs:OpenLayers.Util.applyDefaults({Capabilities:function(e,t){this.readChildNodes(e,t)},Contents:function(e,t){t.contentMetadata=[],this.readChildNodes(e,t.contentMetadata)},CoverageSummary:function(e,t){var i={};this.readChildNodes(e,i),t.push(i)},Identifier:function(e,t){t.identifier=this.getChildValue(e)},Title:function(e,t){t.title=this.getChildValue(e)},Abstract:function(e,t){t["abstract"]=this.getChildValue(e)},SupportedCRS:function(e,t){var i=this.getChildValue(e);i&&(t.supportedCRS||(t.supportedCRS=[]),t.supportedCRS.push(i))},SupportedFormat:function(e,t){var i=this.getChildValue(e);i&&(t.supportedFormat||(t.supportedFormat=[]),t.supportedFormat.push(i))}},OpenLayers.Format.WCSCapabilities.v1.prototype.readers.wcs),ows:OpenLayers.Util.applyDefaults({Keywords:function(e,t){t.keywords=[],this.readChildNodes(e,t.keywords)},Keyword:function(e,t){t.push(this.getChildValue(e))}},OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows)},CLASS_NAME:"OpenLayers.Format.WCSCapabilities.v1_1_0"}),OpenLayers.Console.warn("OpenLayers.Rico is deprecated"),OpenLayers.Rico=OpenLayers.Rico||{},OpenLayers.Rico.Color=OpenLayers.Class({initialize:function(e,t,i){this.rgb={r:e,g:t,b:i}},setRed:function(e){this.rgb.r=e},setGreen:function(e){this.rgb.g=e},setBlue:function(e){this.rgb.b=e},setHue:function(e){var t=this.asHSB();t.h=e,this.rgb=OpenLayers.Rico.Color.HSBtoRGB(t.h,t.s,t.b)},setSaturation:function(e){var t=this.asHSB();t.s=e,this.rgb=OpenLayers.Rico.Color.HSBtoRGB(t.h,t.s,t.b)},setBrightness:function(e){var t=this.asHSB();t.b=e,this.rgb=OpenLayers.Rico.Color.HSBtoRGB(t.h,t.s,t.b)},darken:function(e){var t=this.asHSB();this.rgb=OpenLayers.Rico.Color.HSBtoRGB(t.h,t.s,Math.max(t.b-e,0))},brighten:function(e){var t=this.asHSB();this.rgb=OpenLayers.Rico.Color.HSBtoRGB(t.h,t.s,Math.min(t.b+e,1))},blend:function(e){this.rgb.r=Math.floor((this.rgb.r+e.rgb.r)/2),this.rgb.g=Math.floor((this.rgb.g+e.rgb.g)/2),this.rgb.b=Math.floor((this.rgb.b+e.rgb.b)/2)},isBright:function(){return this.asHSB(),this.asHSB().b>.5},isDark:function(){return!this.isBright()},asRGB:function(){return"rgb("+this.rgb.r+","+this.rgb.g+","+this.rgb.b+")"},asHex:function(){return"#"+this.rgb.r.toColorPart()+this.rgb.g.toColorPart()+this.rgb.b.toColorPart()},asHSB:function(){return OpenLayers.Rico.Color.RGBtoHSB(this.rgb.r,this.rgb.g,this.rgb.b)},toString:function(){return this.asHex()}}),OpenLayers.Rico.Color.createFromHex=function(e){if(4==e.length)for(var t=e,e="#",i=1;4>i;i++)e+=t.charAt(i)+t.charAt(i);0==e.indexOf("#")&&(e=e.substring(1));var s=e.substring(0,2),n=e.substring(2,4),r=e.substring(4,6);return new OpenLayers.Rico.Color(parseInt(s,16),parseInt(n,16),parseInt(r,16))},OpenLayers.Rico.Color.createColorFromBackground=function(e){var t=OpenLayers.Element.getStyle(OpenLayers.Util.getElement(e),"backgroundColor");if("transparent"==t&&e.parentNode)return OpenLayers.Rico.Color.createColorFromBackground(e.parentNode);if(null==t)return new OpenLayers.Rico.Color(255,255,255);if(0==t.indexOf("rgb(")){var i=t.substring(4,t.length-1),s=i.split(",");return new OpenLayers.Rico.Color(parseInt(s[0]),parseInt(s[1]),parseInt(s[2]))}return 0==t.indexOf("#")?OpenLayers.Rico.Color.createFromHex(t):new OpenLayers.Rico.Color(255,255,255)},OpenLayers.Rico.Color.HSBtoRGB=function(e,t,i){var s=0,n=0,r=0;if(0==t)s=parseInt(255*i+.5),n=s,r=s;else{var a=6*(e-Math.floor(e)),o=a-Math.floor(a),l=i*(1-t),h=i*(1-t*o),u=i*(1-t*(1-o));switch(parseInt(a)){case 0:s=255*i+.5,n=255*u+.5,r=255*l+.5;break;case 1:s=255*h+.5,n=255*i+.5,r=255*l+.5;break;case 2:s=255*l+.5,n=255*i+.5,r=255*u+.5;break;case 3:s=255*l+.5,n=255*h+.5,r=255*i+.5;break;case 4:s=255*u+.5,n=255*l+.5,r=255*i+.5;break;case 5:s=255*i+.5,n=255*l+.5,r=255*h+.5}}return{r:parseInt(s),g:parseInt(n),b:parseInt(r)}},OpenLayers.Rico.Color.RGBtoHSB=function(e,t,i){var s,n,r,a=e>t?e:t;i>a&&(a=i);var o=t>e?e:t;if(o>i&&(o=i),r=a/255,n=0!=a?(a-o)/a:0,0==n)s=0;else{var l=(a-e)/(a-o),h=(a-t)/(a-o),u=(a-i)/(a-o);s=e==a?u-h:t==a?2+l-u:4+h-l,s/=6,0>s&&(s+=1)}return{h:s,s:n,b:r}},/*
 * This file has been edited substantially from the Rico-released
 * version by the OpenLayers development team.
 *  
 *  Copyright 2005 Sabre Airline Solutions  
 *  
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the
 *  License. You may obtain a copy of the License at
 *  
 *         http://www.apache.org/licenses/LICENSE-2.0  
 *  
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the * License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, * either express or
 * implied. See the License for the specific language governing
 * permissions * and limitations under the License.
 *
 */
OpenLayers.Console.warn("OpenLayers.Rico is deprecated"),OpenLayers.Rico=OpenLayers.Rico||{},OpenLayers.Rico.Corner={round:function(e,t){e=OpenLayers.Util.getElement(e),this._setOptions(t);var i=this.options.color;"fromElement"==this.options.color&&(i=this._background(e));var s=this.options.bgColor;"fromParent"==this.options.bgColor&&(s=this._background(e.offsetParent)),this._roundCornersImpl(e,i,s)},changeColor:function(e,t){e.style.backgroundColor=t;for(var i=e.parentNode.getElementsByTagName("span"),s=0;s<i.length;s++)i[s].style.backgroundColor=t},changeOpacity:function(e,t){var i=t,s="alpha(opacity="+100*t+")";e.style.opacity=i,e.style.filter=s;for(var n=e.parentNode.getElementsByTagName("span"),r=0;r<n.length;r++)n[r].style.opacity=i,n[r].style.filter=s},reRound:function(e,t){var i=e.parentNode.childNodes[0],s=e.parentNode.childNodes[2];e.parentNode.removeChild(i),e.parentNode.removeChild(s),this.round(e.parentNode,t)},_roundCornersImpl:function(e,t,i){this.options.border&&this._renderBorder(e,i),this._isTopRounded()&&this._roundTopCorners(e,t,i),this._isBottomRounded()&&this._roundBottomCorners(e,t,i)},_renderBorder:function(e,t){var i="1px solid "+this._borderColor(t),s="border-left: "+i,n="border-right: "+i,r="style='"+s+";"+n+"'";e.innerHTML="<div "+r+">"+e.innerHTML+"</div>"},_roundTopCorners:function(e,t,i){for(var s=this._createCorner(i),n=0;n<this.options.numSlices;n++)s.appendChild(this._createCornerSlice(t,i,n,"top"));e.style.paddingTop=0,e.insertBefore(s,e.firstChild)},_roundBottomCorners:function(e,t,i){for(var s=this._createCorner(i),n=this.options.numSlices-1;n>=0;n--)s.appendChild(this._createCornerSlice(t,i,n,"bottom"));e.style.paddingBottom=0,e.appendChild(s)},_createCorner:function(e){var t=document.createElement("div");return t.style.backgroundColor=this._isTransparent()?"transparent":e,t},_createCornerSlice:function(e,t,i,s){var n=document.createElement("span"),r=n.style;r.backgroundColor=e,r.display="block",r.height="1px",r.overflow="hidden",r.fontSize="1px";var a=this._borderColor(e,t);return this.options.border&&0==i?(r.borderTopStyle="solid",r.borderTopWidth="1px",r.borderLeftWidth="0px",r.borderRightWidth="0px",r.borderBottomWidth="0px",r.height="0px",r.borderColor=a):a&&(r.borderColor=a,r.borderStyle="solid",r.borderWidth="0px 1px"),this.options.compact||i!=this.options.numSlices-1||(r.height="2px"),this._setMargin(n,i,s),this._setBorder(n,i,s),n},_setOptions:function(e){this.options={corners:"all",color:"fromElement",bgColor:"fromParent",blend:!0,border:!1,compact:!1},OpenLayers.Util.extend(this.options,e||{}),this.options.numSlices=this.options.compact?2:4,this._isTransparent()&&(this.options.blend=!1)},_whichSideTop:function(){return this._hasString(this.options.corners,"all","top")?"":this.options.corners.indexOf("tl")>=0&&this.options.corners.indexOf("tr")>=0?"":this.options.corners.indexOf("tl")>=0?"left":this.options.corners.indexOf("tr")>=0?"right":""},_whichSideBottom:function(){return this._hasString(this.options.corners,"all","bottom")?"":this.options.corners.indexOf("bl")>=0&&this.options.corners.indexOf("br")>=0?"":this.options.corners.indexOf("bl")>=0?"left":this.options.corners.indexOf("br")>=0?"right":""},_borderColor:function(e,t){return"transparent"==e?t:this.options.border?this.options.border:this.options.blend?this._blend(t,e):""},_setMargin:function(e,t,i){var s=this._marginSize(t),n="top"==i?this._whichSideTop():this._whichSideBottom();"left"==n?(e.style.marginLeft=s+"px",e.style.marginRight="0px"):"right"==n?(e.style.marginRight=s+"px",e.style.marginLeft="0px"):(e.style.marginLeft=s+"px",e.style.marginRight=s+"px")},_setBorder:function(e,t,i){var s=this._borderSize(t),n="top"==i?this._whichSideTop():this._whichSideBottom();"left"==n?(e.style.borderLeftWidth=s+"px",e.style.borderRightWidth="0px"):"right"==n?(e.style.borderRightWidth=s+"px",e.style.borderLeftWidth="0px"):(e.style.borderLeftWidth=s+"px",e.style.borderRightWidth=s+"px"),0!=this.options.border&&(e.style.borderLeftWidth=s+"px",e.style.borderRightWidth=s+"px")},_marginSize:function(e){if(this._isTransparent())return 0;var t=[5,3,2,1],i=[3,2,1,0],s=[2,1],n=[1,0];return this.options.compact&&this.options.blend?n[e]:this.options.compact?s[e]:this.options.blend?i[e]:t[e]},_borderSize:function(e){var t=[5,3,2,1],i=[2,1,1,1],s=[1,0],n=[0,2,0,0];return this.options.compact&&(this.options.blend||this._isTransparent())?1:this.options.compact?s[e]:this.options.blend?i[e]:this.options.border?n[e]:this._isTransparent()?t[e]:0},_hasString:function(e){for(var t=1;t<arguments.length;t++)if(e.indexOf(arguments[t])>=0)return!0;return!1},_blend:function(e,t){var i=OpenLayers.Rico.Color.createFromHex(e);return i.blend(OpenLayers.Rico.Color.createFromHex(t)),i},_background:function(e){try{return OpenLayers.Rico.Color.createColorFromBackground(e).asHex()}catch(t){return"#ffffff"}},_isTransparent:function(){return"transparent"==this.options.color},_isTopRounded:function(){return this._hasString(this.options.corners,"all","top","tl","tr")},_isBottomRounded:function(){return this._hasString(this.options.corners,"all","bottom","bl","br")},_hasSingleTextChild:function(e){return 1==e.childNodes.length&&3==e.childNodes[0].nodeType}},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Popup.AnchoredBubble=OpenLayers.Class(OpenLayers.Popup.Anchored,{rounded:!1,initialize:function(){OpenLayers.Console.warn("AnchoredBubble is deprecated"),this.padding=new OpenLayers.Bounds(0,OpenLayers.Popup.AnchoredBubble.CORNER_SIZE,0,OpenLayers.Popup.AnchoredBubble.CORNER_SIZE),OpenLayers.Popup.Anchored.prototype.initialize.apply(this,arguments)},draw:function(){return OpenLayers.Popup.Anchored.prototype.draw.apply(this,arguments),this.setContentHTML(),this.setBackgroundColor(),this.setOpacity(),this.div},updateRelativePosition:function(){this.setRicoCorners()},setSize:function(){OpenLayers.Popup.Anchored.prototype.setSize.apply(this,arguments),this.setRicoCorners()},setBackgroundColor:function(e){void 0!=e&&(this.backgroundColor=e),null!=this.div&&null!=this.contentDiv&&(this.div.style.background="transparent",OpenLayers.Rico.Corner.changeColor(this.groupDiv,this.backgroundColor))},setOpacity:function(e){OpenLayers.Popup.Anchored.prototype.setOpacity.call(this,e),null!=this.div&&null!=this.groupDiv&&OpenLayers.Rico.Corner.changeOpacity(this.groupDiv,this.opacity)},setBorder:function(){this.border=0},setRicoCorners:function(){var e=this.getCornersToRound(this.relativePosition),t={corners:e,color:this.backgroundColor,bgColor:"transparent",blend:!1};this.rounded?(OpenLayers.Rico.Corner.reRound(this.groupDiv,t),this.setBackgroundColor(),this.setOpacity()):(OpenLayers.Rico.Corner.round(this.div,t),this.rounded=!0)},getCornersToRound:function(){var e=["tl","tr","bl","br"],t=OpenLayers.Bounds.oppositeQuadrant(this.relativePosition);return OpenLayers.Util.removeItem(e,t),e.join(" ")},CLASS_NAME:"OpenLayers.Popup.AnchoredBubble"}),OpenLayers.Popup.AnchoredBubble.CORNER_SIZE=5,/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Tile.UTFGrid=OpenLayers.Class(OpenLayers.Tile,{url:null,utfgridResolution:2,json:null,format:null,destroy:function(){this.clear(),OpenLayers.Tile.prototype.destroy.apply(this,arguments)},draw:function(){var e=OpenLayers.Tile.prototype.draw.apply(this,arguments);if(e)if(this.isLoading?(this.abortLoading(),this.events.triggerEvent("reload")):(this.isLoading=!0,this.events.triggerEvent("loadstart")),this.url=this.layer.getURL(this.bounds),this.layer.useJSONP){var t=new OpenLayers.Protocol.Script({url:this.url,callback:function(e){this.isLoading=!1,this.events.triggerEvent("loadend"),this.json=e.data},scope:this});t.read(),this.request=t}else this.request=OpenLayers.Request.GET({url:this.url,callback:function(e){this.isLoading=!1,this.events.triggerEvent("loadend"),200===e.status&&this.parseData(e.responseText)},scope:this});else this.unload();return e},abortLoading:function(){this.request&&(this.request.abort(),delete this.request),this.isLoading=!1},getFeatureInfo:function(e,t){var i=null;if(this.json){var s=this.getFeatureId(e,t);null!==s&&(i={id:s,data:this.json.data[s]})}return i},getFeatureId:function(e,t){var i=null;if(this.json){var s=this.utfgridResolution,n=Math.floor(t/s),r=Math.floor(e/s),a=this.json.grid[n].charCodeAt(r),o=this.indexFromCharCode(a),l=this.json.keys;!isNaN(o)&&o in l&&(i=l[o])}return i},indexFromCharCode:function(e){return e>=93&&e--,e>=35&&e--,e-32},parseData:function(e){this.format||(this.format=new OpenLayers.Format.JSON),this.json=this.format.read(e)},clear:function(){this.json=null},CLASS_NAME:"OpenLayers.Tile.UTFGrid"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Protocol.HTTP=OpenLayers.Class(OpenLayers.Protocol,{url:null,headers:null,params:null,callback:null,scope:null,readWithPOST:!1,updateWithPOST:!1,deleteWithPOST:!1,wildcarded:!1,srsInBBOX:!1,initialize:function(e){if(e=e||{},this.params={},this.headers={},OpenLayers.Protocol.prototype.initialize.apply(this,arguments),!this.filterToParams&&OpenLayers.Format.QueryStringFilter){var t=new OpenLayers.Format.QueryStringFilter({wildcarded:this.wildcarded,srsInBBOX:this.srsInBBOX});this.filterToParams=function(e,i){return t.write(e,i)}}},destroy:function(){this.params=null,this.headers=null,OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(e){OpenLayers.Protocol.prototype.read.apply(this,arguments),e=e||{},e.params=OpenLayers.Util.applyDefaults(e.params,this.options.params),e=OpenLayers.Util.applyDefaults(e,this.options),e.filter&&this.filterToParams&&(e.params=this.filterToParams(e.filter,e.params));var t=void 0!==e.readWithPOST?e.readWithPOST:this.readWithPOST,i=new OpenLayers.Protocol.Response({requestType:"read"});if(t){var s=e.headers||{};s["Content-Type"]="application/x-www-form-urlencoded",i.priv=OpenLayers.Request.POST({url:e.url,callback:this.createCallback(this.handleRead,i,e),data:OpenLayers.Util.getParameterString(e.params),headers:s})}else i.priv=OpenLayers.Request.GET({url:e.url,callback:this.createCallback(this.handleRead,i,e),params:e.params,headers:e.headers});return i},handleRead:function(e,t){this.handleResponse(e,t)},create:function(e,t){t=OpenLayers.Util.applyDefaults(t,this.options);var i=new OpenLayers.Protocol.Response({reqFeatures:e,requestType:"create"});return i.priv=OpenLayers.Request.POST({url:t.url,callback:this.createCallback(this.handleCreate,i,t),headers:t.headers,data:this.format.write(e)}),i},handleCreate:function(e,t){this.handleResponse(e,t)},update:function(e,t){t=t||{};var i=t.url||e.url||this.options.url+"/"+e.fid;t=OpenLayers.Util.applyDefaults(t,this.options);var s=new OpenLayers.Protocol.Response({reqFeatures:e,requestType:"update"}),n=this.updateWithPOST?"POST":"PUT";return s.priv=OpenLayers.Request[n]({url:i,callback:this.createCallback(this.handleUpdate,s,t),headers:t.headers,data:this.format.write(e)}),s},handleUpdate:function(e,t){this.handleResponse(e,t)},"delete":function(e,t){t=t||{};var i=t.url||e.url||this.options.url+"/"+e.fid;t=OpenLayers.Util.applyDefaults(t,this.options);var s=new OpenLayers.Protocol.Response({reqFeatures:e,requestType:"delete"}),n=this.deleteWithPOST?"POST":"DELETE",r={url:i,callback:this.createCallback(this.handleDelete,s,t),headers:t.headers};return this.deleteWithPOST&&(r.data=this.format.write(e)),s.priv=OpenLayers.Request[n](r),s},handleDelete:function(e,t){this.handleResponse(e,t)},handleResponse:function(e,t){var i=e.priv;t.callback&&(i.status>=200&&i.status<300?("delete"!=e.requestType&&(e.features=this.parseFeatures(i)),e.code=OpenLayers.Protocol.Response.SUCCESS):e.code=OpenLayers.Protocol.Response.FAILURE,t.callback.call(t.scope,e))},parseFeatures:function(e){var t=e.responseXML;return t&&t.documentElement||(t=e.responseText),!t||t.length<=0?null:this.format.read(t)},commit:function(e,t){function i(e){for(var t=e.features?e.features.length:0,i=new Array(t),n=0;t>n;++n)i[n]=e.features[n].fid;f.insertIds=i,s.apply(this,[e])}function s(e){this.callUserCallback(e,t),p=p&&e.success(),r++,r>=d&&t.callback&&(f.code=p?OpenLayers.Protocol.Response.SUCCESS:OpenLayers.Protocol.Response.FAILURE,t.callback.apply(t.scope,[f]))}t=OpenLayers.Util.applyDefaults(t,this.options);var n=[],r=0,a={};a[OpenLayers.State.INSERT]=[],a[OpenLayers.State.UPDATE]=[],a[OpenLayers.State.DELETE]=[];for(var o,l,h=[],u=0,c=e.length;c>u;++u)o=e[u],l=a[o.state],l&&(l.push(o),h.push(o));var d=(a[OpenLayers.State.INSERT].length>0?1:0)+a[OpenLayers.State.UPDATE].length+a[OpenLayers.State.DELETE].length,p=!0,f=new OpenLayers.Protocol.Response({reqFeatures:h}),m=a[OpenLayers.State.INSERT];m.length>0&&n.push(this.create(m,OpenLayers.Util.applyDefaults({callback:i,scope:this},t.create))),m=a[OpenLayers.State.UPDATE];for(var u=m.length-1;u>=0;--u)n.push(this.update(m[u],OpenLayers.Util.applyDefaults({callback:s,scope:this},t.update)));m=a[OpenLayers.State.DELETE];for(var u=m.length-1;u>=0;--u)n.push(this["delete"](m[u],OpenLayers.Util.applyDefaults({callback:s,scope:this},t["delete"])));return n},abort:function(e){e&&e.priv.abort()},callUserCallback:function(e,t){var i=t[e.requestType];i&&i.callback&&i.callback.call(i.scope,e)},CLASS_NAME:"OpenLayers.Protocol.HTTP"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Strategy.Cluster=OpenLayers.Class(OpenLayers.Strategy,{distance:20,threshold:null,features:null,clusters:null,clustering:!1,resolution:null,activate:function(){var e=OpenLayers.Strategy.prototype.activate.call(this);return e&&this.layer.events.on({beforefeaturesadded:this.cacheFeatures,moveend:this.cluster,scope:this}),e},deactivate:function(){var e=OpenLayers.Strategy.prototype.deactivate.call(this);return e&&(this.clearCache(),this.layer.events.un({beforefeaturesadded:this.cacheFeatures,moveend:this.cluster,scope:this})),e},cacheFeatures:function(e){var t=!0;return this.clustering||(this.clearCache(),this.features=e.features,this.cluster(),t=!1),t},clearCache:function(){this.features=null},cluster:function(e){if((!e||e.zoomChanged)&&this.features){var t=this.layer.map.getResolution();if(t!=this.resolution||!this.clustersExist()){this.resolution=t;for(var i,s,n,r=[],a=0;a<this.features.length;++a)if(i=this.features[a],i.geometry){s=!1;for(var o=r.length-1;o>=0;--o)if(n=r[o],this.shouldCluster(n,i)){this.addToCluster(n,i),s=!0;break}s||r.push(this.createCluster(this.features[a]))}if(this.layer.removeAllFeatures(),r.length>0){if(this.threshold>1){var l=r.slice();r=[];for(var h,a=0,u=l.length;u>a;++a)h=l[a],h.attributes.count<this.threshold?Array.prototype.push.apply(r,h.cluster):r.push(h)}this.clustering=!0,this.layer.addFeatures(r),this.clustering=!1}this.clusters=r}}},clustersExist:function(){var e=!1;if(this.clusters&&this.clusters.length>0&&this.clusters.length==this.layer.features.length){e=!0;for(var t=0;t<this.clusters.length;++t)if(this.clusters[t]!=this.layer.features[t]){e=!1;break}}return e},shouldCluster:function(e,t){var i=e.geometry.getBounds().getCenterLonLat(),s=t.geometry.getBounds().getCenterLonLat(),n=Math.sqrt(Math.pow(i.lon-s.lon,2)+Math.pow(i.lat-s.lat,2))/this.resolution;return n<=this.distance},addToCluster:function(e,t){e.cluster.push(t),e.attributes.count+=1},createCluster:function(e){var t=e.geometry.getBounds().getCenterLonLat(),i=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(t.lon,t.lat),{count:1});return i.cluster=[e],i},CLASS_NAME:"OpenLayers.Strategy.Cluster"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Protocol.SOS=function(e){e=OpenLayers.Util.applyDefaults(e,OpenLayers.Protocol.SOS.DEFAULTS);var t=OpenLayers.Protocol.SOS["v"+e.version.replace(/\./g,"_")];if(!t)throw"Unsupported SOS version: "+e.version;return new t(e)},OpenLayers.Protocol.SOS.DEFAULTS={version:"1.0.0"},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WFSDescribeFeatureType=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xsd:"http://www.w3.org/2001/XMLSchema"},readers:{xsd:{schema:function(e,t){var i=[],s={},n={complexTypes:i,customTypes:s};this.readChildNodes(e,n);for(var r,a,o=e.attributes,l=0,h=o.length;h>l;++l)r=o[l],a=r.name,0==a.indexOf("xmlns")?this.setNamespace(a.split(":")[1]||"",r.value):t[a]=r.value;t.featureTypes=i,t.targetPrefix=this.namespaceAlias[t.targetNamespace];for(var u,c,l=0,h=i.length;h>l;++l)u=i[l],c=s[u.typeName],s[u.typeName]&&(u.typeName=c.name)},complexType:function(e,t){var i={typeName:e.getAttribute("name")};this.readChildNodes(e,i),t.complexTypes.push(i)},complexContent:function(e,t){this.readChildNodes(e,t)},extension:function(e,t){this.readChildNodes(e,t)},sequence:function(e,t){var i={elements:[]};this.readChildNodes(e,i),t.properties=i.elements},element:function(e,t){if(t.elements){for(var i,s={},n=e.attributes,r=0,a=n.length;a>r;++r)i=n[r],s[i.name]=i.value;var o=s.type;o||(o={},this.readChildNodes(e,o),s.restriction=o,s.type=o.base);var l=o.base||o;s.localType=l.split(":").pop(),t.elements.push(s)}if(t.complexTypes){var o=e.getAttribute("type"),h=o.split(":").pop();t.customTypes[h]={name:e.getAttribute("name"),type:o}}},simpleType:function(e,t){this.readChildNodes(e,t)},restriction:function(e,t){t.base=e.getAttribute("base"),this.readRestriction(e,t)}}},readRestriction:function(e,t){for(var i,s,n,r=e.childNodes,a=0,o=r.length;o>a;++a)i=r[a],1==i.nodeType&&(s=i.nodeName.split(":").pop(),n=i.getAttribute("value"),t[s]?("string"==typeof t[s]&&(t[s]=[t[s]]),t[s].push(n)):t[s]=n)},read:function(e){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e])),e&&9==e.nodeType&&(e=e.documentElement);var t={};return this.readNode(e,t),t},CLASS_NAME:"OpenLayers.Format.WFSDescribeFeatureType"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.OverviewMap=OpenLayers.Class(OpenLayers.Control,{element:null,ovmap:null,size:{w:180,h:90},layers:null,minRectSize:15,minRectDisplayClass:"RectReplacement",minRatio:8,maxRatio:32,mapOptions:null,autoPan:!1,handlers:null,resolutionFactor:1,maximized:!1,initialize:function(e){this.layers=[],this.handlers={},OpenLayers.Control.prototype.initialize.apply(this,[e])},destroy:function(){this.mapDiv&&(this.handlers.click&&this.handlers.click.destroy(),this.handlers.drag&&this.handlers.drag.destroy(),this.ovmap&&this.ovmap.viewPortDiv.removeChild(this.extentRectangle),this.extentRectangle=null,this.rectEvents&&(this.rectEvents.destroy(),this.rectEvents=null),this.ovmap&&(this.ovmap.destroy(),this.ovmap=null),this.element.removeChild(this.mapDiv),this.mapDiv=null,this.div.removeChild(this.element),this.element=null,this.maximizeDiv&&(this.div.removeChild(this.maximizeDiv),this.maximizeDiv=null),this.minimizeDiv&&(this.div.removeChild(this.minimizeDiv),this.minimizeDiv=null),this.map.events.un({buttonclick:this.onButtonClick,moveend:this.update,changebaselayer:this.baseLayerDraw,scope:this}),OpenLayers.Control.prototype.destroy.apply(this,arguments))},draw:function(){if(OpenLayers.Control.prototype.draw.apply(this,arguments),0===this.layers.length){if(!this.map.baseLayer)return this.map.events.register("changebaselayer",this,this.baseLayerDraw),this.div;var e=this.map.baseLayer.clone();this.layers=[e]}if(this.element=document.createElement("div"),this.element.className=this.displayClass+"Element",this.element.style.display="none",this.mapDiv=document.createElement("div"),this.mapDiv.style.width=this.size.w+"px",this.mapDiv.style.height=this.size.h+"px",this.mapDiv.style.position="relative",this.mapDiv.style.overflow="hidden",this.mapDiv.id=OpenLayers.Util.createUniqueID("overviewMap"),this.extentRectangle=document.createElement("div"),this.extentRectangle.style.position="absolute",this.extentRectangle.style.zIndex=1e3,this.extentRectangle.className=this.displayClass+"ExtentRectangle",this.element.appendChild(this.mapDiv),this.div.appendChild(this.element),this.outsideViewport)this.element.style.display="";else{this.div.className+=" "+this.displayClass+"Container";var t=OpenLayers.Util.getImageLocation("layer-switcher-maximize.png");this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv(this.displayClass+"MaximizeButton",null,null,t,"absolute"),this.maximizeDiv.style.display="none",this.maximizeDiv.className=this.displayClass+"MaximizeButton olButton",this.div.appendChild(this.maximizeDiv);var t=OpenLayers.Util.getImageLocation("layer-switcher-minimize.png");this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_minimizeDiv",null,null,t,"absolute"),this.minimizeDiv.style.display="none",this.minimizeDiv.className=this.displayClass+"MinimizeButton olButton",this.div.appendChild(this.minimizeDiv),this.minimizeControl()}return this.map.getExtent()&&this.update(),this.map.events.on({buttonclick:this.onButtonClick,moveend:this.update,scope:this}),this.maximized&&this.maximizeControl(),this.div},baseLayerDraw:function(){this.draw(),this.map.events.unregister("changebaselayer",this,this.baseLayerDraw)},rectDrag:function(e){var t=this.handlers.drag.last.x-e.x,i=this.handlers.drag.last.y-e.y;if(0!=t||0!=i){var s=this.rectPxBounds.top,n=this.rectPxBounds.left,r=Math.abs(this.rectPxBounds.getHeight()),a=this.rectPxBounds.getWidth(),o=Math.max(0,s-i);o=Math.min(o,this.ovmap.size.h-this.hComp-r);var l=Math.max(0,n-t);l=Math.min(l,this.ovmap.size.w-this.wComp-a),this.setRectPxBounds(new OpenLayers.Bounds(l,o+r,l+a,o))}},mapDivClick:function(e){var t=this.rectPxBounds.getCenterPixel(),i=e.xy.x-t.x,s=e.xy.y-t.y,n=this.rectPxBounds.top,r=this.rectPxBounds.left,a=Math.abs(this.rectPxBounds.getHeight()),o=this.rectPxBounds.getWidth(),l=Math.max(0,n+s);l=Math.min(l,this.ovmap.size.h-a);var h=Math.max(0,r+i);h=Math.min(h,this.ovmap.size.w-o),this.setRectPxBounds(new OpenLayers.Bounds(h,l+a,h+o,l)),this.updateMapToRect()},onButtonClick:function(e){e.buttonElement===this.minimizeDiv?this.minimizeControl():e.buttonElement===this.maximizeDiv&&this.maximizeControl()},maximizeControl:function(e){this.element.style.display="",this.showToggle(!1),null!=e&&OpenLayers.Event.stop(e)},minimizeControl:function(e){this.element.style.display="none",this.showToggle(!0),null!=e&&OpenLayers.Event.stop(e)},showToggle:function(e){this.maximizeDiv.style.display=e?"":"none",this.minimizeDiv.style.display=e?"none":""},update:function(){null==this.ovmap&&this.createMap(),(this.autoPan||!this.isSuitableOverview())&&this.updateOverview(),this.updateRectToMap()},isSuitableOverview:function(){var e=this.map.getExtent(),t=this.map.maxExtent,i=new OpenLayers.Bounds(Math.max(e.left,t.left),Math.max(e.bottom,t.bottom),Math.min(e.right,t.right),Math.min(e.top,t.top));this.ovmap.getProjection()!=this.map.getProjection()&&(i=i.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject()));var s=this.ovmap.getResolution()/this.map.getResolution();return s>this.minRatio&&s<=this.maxRatio&&this.ovmap.getExtent().containsBounds(i)},updateOverview:function(){var e=this.map.getResolution(),t=this.ovmap.getResolution(),i=t/e;i>this.maxRatio?t=this.minRatio*e:i<=this.minRatio&&(t=this.maxRatio*e);var s;this.ovmap.getProjection()!=this.map.getProjection()?(s=this.map.center.clone(),s.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject())):s=this.map.center,this.ovmap.setCenter(s,this.ovmap.getZoomForResolution(t*this.resolutionFactor)),this.updateRectToMap()},createMap:function(){var e=OpenLayers.Util.extend({controls:[],maxResolution:"auto",fallThrough:!1},this.mapOptions);if(this.ovmap=new OpenLayers.Map(this.mapDiv,e),this.ovmap.viewPortDiv.appendChild(this.extentRectangle),OpenLayers.Event.stopObserving(window,"unload",this.ovmap.unloadDestroy),this.ovmap.addLayers(this.layers),this.ovmap.zoomToMaxExtent(),this.wComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-left-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-right-width")),this.wComp=this.wComp?this.wComp:2,this.hComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-top-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-bottom-width")),this.hComp=this.hComp?this.hComp:2,this.handlers.drag=new OpenLayers.Handler.Drag(this,{move:this.rectDrag,done:this.updateMapToRect},{map:this.ovmap}),this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.mapDivClick},{single:!0,"double":!1,stopSingle:!0,stopDouble:!0,pixelTolerance:1,map:this.ovmap}),this.handlers.click.activate(),this.rectEvents=new OpenLayers.Events(this,this.extentRectangle,null,!0),this.rectEvents.register("mouseover",this,function(){this.handlers.drag.active||this.map.dragging||this.handlers.drag.activate()}),this.rectEvents.register("mouseout",this,function(){this.handlers.drag.dragging||this.handlers.drag.deactivate()}),this.ovmap.getProjection()!=this.map.getProjection()){var t=this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units,i=this.ovmap.getProjectionObject().getUnits()||this.ovmap.units||this.ovmap.baseLayer.units;this.resolutionFactor=t&&i?OpenLayers.INCHES_PER_UNIT[t]/OpenLayers.INCHES_PER_UNIT[i]:1}},updateRectToMap:function(){var e;e=this.ovmap.getProjection()!=this.map.getProjection()?this.map.getExtent().transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject()):this.map.getExtent();var t=this.getRectBoundsFromMapBounds(e);t&&this.setRectPxBounds(t)},updateMapToRect:function(){var e=this.getMapBoundsFromRectBounds(this.rectPxBounds);this.ovmap.getProjection()!=this.map.getProjection()&&(e=e.transform(this.ovmap.getProjectionObject(),this.map.getProjectionObject())),this.map.panTo(e.getCenterLonLat())},setRectPxBounds:function(e){var t=Math.max(e.top,0),i=Math.max(e.left,0),s=Math.min(e.top+Math.abs(e.getHeight()),this.ovmap.size.h-this.hComp),n=Math.min(e.left+e.getWidth(),this.ovmap.size.w-this.wComp),r=Math.max(n-i,0),a=Math.max(s-t,0);if(r<this.minRectSize||a<this.minRectSize){this.extentRectangle.className=this.displayClass+this.minRectDisplayClass;var o=i+r/2-this.minRectSize/2,l=t+a/2-this.minRectSize/2;this.extentRectangle.style.top=Math.round(l)+"px",this.extentRectangle.style.left=Math.round(o)+"px",this.extentRectangle.style.height=this.minRectSize+"px",this.extentRectangle.style.width=this.minRectSize+"px"}else this.extentRectangle.className=this.displayClass+"ExtentRectangle",this.extentRectangle.style.top=Math.round(t)+"px",this.extentRectangle.style.left=Math.round(i)+"px",this.extentRectangle.style.height=Math.round(a)+"px",this.extentRectangle.style.width=Math.round(r)+"px";this.rectPxBounds=new OpenLayers.Bounds(Math.round(i),Math.round(s),Math.round(n),Math.round(t))},getRectBoundsFromMapBounds:function(e){var t=this.getOverviewPxFromLonLat({lon:e.left,lat:e.bottom}),i=this.getOverviewPxFromLonLat({lon:e.right,lat:e.top}),s=null;return t&&i&&(s=new OpenLayers.Bounds(t.x,t.y,i.x,i.y)),s},getMapBoundsFromRectBounds:function(e){var t=this.getLonLatFromOverviewPx({x:e.left,y:e.bottom}),i=this.getLonLatFromOverviewPx({x:e.right,y:e.top});return new OpenLayers.Bounds(t.lon,t.lat,i.lon,i.lat)},getLonLatFromOverviewPx:function(e){var t=this.ovmap.size,i=this.ovmap.getResolution(),s=this.ovmap.getExtent().getCenterLonLat(),n=e.x-t.w/2,r=e.y-t.h/2;return{lon:s.lon+n*i,lat:s.lat-r*i}},getOverviewPxFromLonLat:function(e){var t=this.ovmap.getResolution(),i=this.ovmap.getExtent();return i?{x:Math.round(1/t*(e.lon-i.left)),y:Math.round(1/t*(i.top-e.lat))}:void 0},CLASS_NAME:"OpenLayers.Control.OverviewMap"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WPSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",CLASS_NAME:"OpenLayers.Format.WPSCapabilities"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WPSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows/1.1",wps:"http://www.opengis.net/wps/1.0.0",xlink:"http://www.w3.org/1999/xlink"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},initialize:function(e){OpenLayers.Format.XML.prototype.initialize.apply(this,[e])},read:function(e){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e])),e&&9==e.nodeType&&(e=e.documentElement);var t={};return this.readNode(e,t),t},readers:{wps:{Capabilities:function(e,t){this.readChildNodes(e,t)},ProcessOfferings:function(e,t){t.processOfferings={},this.readChildNodes(e,t.processOfferings)},Process:function(e,t){var i=this.getAttributeNS(e,this.namespaces.wps,"processVersion"),s={processVersion:i};this.readChildNodes(e,s),t[s.identifier]=s},Languages:function(e,t){t.languages=[],this.readChildNodes(e,t.languages)},Default:function(e,t){var i={isDefault:!0};this.readChildNodes(e,i),t.push(i)},Supported:function(e,t){var i={};this.readChildNodes(e,i),t.push(i)}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WPSCapabilities.v1_0_0"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.PinchZoom=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,containerCenter:null,pinchOrigin:null,currentCenter:null,autoActivate:!0,initialize:function(){OpenLayers.Control.prototype.initialize.apply(this,arguments),this.handler=new OpenLayers.Handler.Pinch(this,{start:this.pinchStart,move:this.pinchMove,done:this.pinchDone},this.handlerOptions)},activate:function(){var e=OpenLayers.Control.prototype.activate.apply(this,arguments);return e&&(this.map.events.on({moveend:this.updateContainerCenter,scope:this}),this.updateContainerCenter()),e},deactivate:function(){var e=OpenLayers.Control.prototype.deactivate.apply(this,arguments);return this.map&&this.map.events&&this.map.events.un({moveend:this.updateContainerCenter,scope:this}),e},updateContainerCenter:function(){var e=this.map.layerContainerDiv;this.containerCenter={x:parseInt(e.style.left,10)+50,y:parseInt(e.style.top,10)+50}},pinchStart:function(e){this.pinchOrigin=e.xy,this.currentCenter=e.xy},pinchMove:function(e,t){var i=t.scale,s=this.containerCenter,n=this.pinchOrigin,r=e.xy,a=Math.round(r.x-n.x+(i-1)*(s.x-n.x)),o=Math.round(r.y-n.y+(i-1)*(s.y-n.y));this.applyTransform("translate("+a+"px, "+o+"px) scale("+i+")"),this.currentCenter=r},applyTransform:function(e){var t=this.map.layerContainerDiv.style;t["-webkit-transform"]=e,t["-moz-transform"]=e},pinchDone:function(e,t,i){this.applyTransform("");var s=this.map.getZoomForResolution(this.map.getResolution()/i.scale,!0);if(s!==this.map.getZoom()||!this.currentCenter.equals(this.pinchOrigin)){var n=this.map.getResolutionForZoom(s),r=this.map.getLonLatFromPixel(this.pinchOrigin),a=this.currentCenter,o=this.map.getSize();r.lon+=n*(o.w/2-a.x),r.lat-=n*(o.h/2-a.y),this.map.div.clientWidth=this.map.div.clientWidth,this.map.setCenter(r,s)}},CLASS_NAME:"OpenLayers.Control.PinchZoom"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.TouchNavigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,pinchZoom:null,pinchZoomOptions:null,clickHandlerOptions:null,documentDrag:!1,autoActivate:!0,initialize:function(){this.handlers={},OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate(),this.dragPan&&this.dragPan.destroy(),this.dragPan=null,this.pinchZoom&&(this.pinchZoom.destroy(),delete this.pinchZoom),OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){return OpenLayers.Control.prototype.activate.apply(this,arguments)?(this.dragPan.activate(),this.handlers.click.activate(),this.pinchZoom.activate(),!0):!1},deactivate:function(){return OpenLayers.Control.prototype.deactivate.apply(this,arguments)?(this.dragPan.deactivate(),this.handlers.click.deactivate(),this.pinchZoom.deactivate(),!0):!1},draw:function(){var e={click:this.defaultClick,dblclick:this.defaultDblClick},t=OpenLayers.Util.extend({"double":!0,stopDouble:!0,pixelTolerance:2},this.clickHandlerOptions);this.handlers.click=new OpenLayers.Handler.Click(this,e,t),this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map,documentDrag:this.documentDrag},this.dragPanOptions)),this.dragPan.draw(),this.pinchZoom=new OpenLayers.Control.PinchZoom(OpenLayers.Util.extend({map:this.map},this.pinchZoomOptions))},defaultClick:function(e){e.lastTouches&&2==e.lastTouches.length&&this.map.zoomOut()},defaultDblClick:function(e){var t=this.map.getLonLatFromViewPortPx(e.xy);this.map.setCenter(t,this.map.zoom+1)},CLASS_NAME:"OpenLayers.Control.TouchNavigation"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Style2=OpenLayers.Class({id:null,name:null,title:null,description:null,layerName:null,isDefault:!1,rules:null,initialize:function(e){OpenLayers.Util.extend(this,e),this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var e=0,t=this.rules.length;t>e;e++)this.rules[e].destroy();delete this.rules},clone:function(){var e=OpenLayers.Util.extend({},this);if(this.rules){e.rules=[];for(var t=0,i=this.rules.length;i>t;++t)e.rules.push(this.rules[t].clone())}return new OpenLayers.Style2(e)},CLASS_NAME:"OpenLayers.Style2"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.MousePosition=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,element:null,prefix:"",separator:", ",suffix:"",numDigits:5,granularity:10,emptyString:null,lastXy:null,displayProjection:null,destroy:function(){this.deactivate(),OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){return OpenLayers.Control.prototype.activate.apply(this,arguments)?(this.map.events.register("mousemove",this,this.redraw),this.map.events.register("mouseout",this,this.reset),this.redraw(),!0):!1},deactivate:function(){return OpenLayers.Control.prototype.deactivate.apply(this,arguments)?(this.map.events.unregister("mousemove",this,this.redraw),this.map.events.unregister("mouseout",this,this.reset),this.element.innerHTML="",!0):!1},draw:function(){return OpenLayers.Control.prototype.draw.apply(this,arguments),this.element||(this.div.left="",this.div.top="",this.element=this.div),this.div},redraw:function(e){var t;if(null==e)return this.reset(),void 0;if(null==this.lastXy||Math.abs(e.xy.x-this.lastXy.x)>this.granularity||Math.abs(e.xy.y-this.lastXy.y)>this.granularity)return this.lastXy=e.xy,void 0;if(t=this.map.getLonLatFromPixel(e.xy)){this.displayProjection&&t.transform(this.map.getProjectionObject(),this.displayProjection),this.lastXy=e.xy;var i=this.formatOutput(t);i!=this.element.innerHTML&&(this.element.innerHTML=i)}},reset:function(){null!=this.emptyString&&(this.element.innerHTML=this.emptyString)},formatOutput:function(e){var t=parseInt(this.numDigits),i=this.prefix+e.lon.toFixed(t)+this.separator+e.lat.toFixed(t)+this.suffix;return i},CLASS_NAME:"OpenLayers.Control.MousePosition"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WFS=OpenLayers.Class(OpenLayers.Format.GML,{layer:null,wfsns:"http://www.opengis.net/wfs",ogcns:"http://www.opengis.net/ogc",initialize:function(e,t){OpenLayers.Format.GML.prototype.initialize.apply(this,[e]),this.layer=t,this.layer.featureNS&&(this.featureNS=this.layer.featureNS),this.layer.options.geometry_column&&(this.geometryName=this.layer.options.geometry_column),this.layer.options.typename&&(this.featureName=this.layer.options.typename)},write:function(e){var t=this.createElementNS(this.wfsns,"wfs:Transaction");t.setAttribute("version","1.0.0"),t.setAttribute("service","WFS");for(var i=0;i<e.length;i++)switch(e[i].state){case OpenLayers.State.INSERT:t.appendChild(this.insert(e[i]));break;case OpenLayers.State.UPDATE:t.appendChild(this.update(e[i]));break;case OpenLayers.State.DELETE:t.appendChild(this.remove(e[i]))}return OpenLayers.Format.XML.prototype.write.apply(this,[t])},createFeatureXML:function(e){var t=this.buildGeometryNode(e.geometry),i=this.createElementNS(this.featureNS,"feature:"+this.geometryName);i.appendChild(t);var s=this.createElementNS(this.featureNS,"feature:"+this.featureName);s.appendChild(i);for(var n in e.attributes){var r=this.createTextNode(e.attributes[n]),a=n;-1!=n.search(":")&&(a=n.split(":")[1]);var o=this.createElementNS(this.featureNS,"feature:"+a);o.appendChild(r),s.appendChild(o)}return s},insert:function(e){var t=this.createElementNS(this.wfsns,"wfs:Insert");return t.appendChild(this.createFeatureXML(e)),t},update:function(e){e.fid||OpenLayers.Console.userError(OpenLayers.i18n("noFID"));var t=this.createElementNS(this.wfsns,"wfs:Update");t.setAttribute("typeName",this.featurePrefix+":"+this.featureName),t.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);var i=this.createElementNS(this.wfsns,"wfs:Property"),s=this.createElementNS(this.wfsns,"wfs:Name"),n=this.createTextNode(this.geometryName);s.appendChild(n),i.appendChild(s);var r=this.createElementNS(this.wfsns,"wfs:Value"),a=this.buildGeometryNode(e.geometry);e.layer&&a.setAttribute("srsName",e.layer.projection.getCode()),r.appendChild(a),i.appendChild(r),t.appendChild(i);for(var o in e.attributes)i=this.createElementNS(this.wfsns,"wfs:Property"),s=this.createElementNS(this.wfsns,"wfs:Name"),s.appendChild(this.createTextNode(o)),i.appendChild(s),r=this.createElementNS(this.wfsns,"wfs:Value"),r.appendChild(this.createTextNode(e.attributes[o])),i.appendChild(r),t.appendChild(i);var l=this.createElementNS(this.ogcns,"ogc:Filter"),h=this.createElementNS(this.ogcns,"ogc:FeatureId");return h.setAttribute("fid",e.fid),l.appendChild(h),t.appendChild(l),t},remove:function(e){if(!e.fid)return OpenLayers.Console.userError(OpenLayers.i18n("noFID")),!1;var t=this.createElementNS(this.wfsns,"wfs:Delete");t.setAttribute("typeName",this.featurePrefix+":"+this.featureName),t.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);var i=this.createElementNS(this.ogcns,"ogc:Filter"),s=this.createElementNS(this.ogcns,"ogc:FeatureId");return s.setAttribute("fid",e.fid),i.appendChild(s),t.appendChild(i),t},destroy:function(){this.layer=null},CLASS_NAME:"OpenLayers.Format.WFS"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WFSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1,{readers:{wfs:OpenLayers.Util.applyDefaults({Service:function(e,t){t.service={},this.readChildNodes(e,t.service)},Fees:function(e,t){var i=this.getChildValue(e);i&&"none"!=i.toLowerCase()&&(t.fees=i)},AccessConstraints:function(e,t){var i=this.getChildValue(e);i&&"none"!=i.toLowerCase()&&(t.accessConstraints=i)},OnlineResource:function(e,t){var i=this.getChildValue(e);i&&"none"!=i.toLowerCase()&&(t.onlineResource=i)},Keywords:function(e,t){var i=this.getChildValue(e);i&&"none"!=i.toLowerCase()&&(t.keywords=i.split(", "))},Capability:function(e,t){t.capability={},this.readChildNodes(e,t.capability)},Request:function(e,t){t.request={},this.readChildNodes(e,t.request)},GetFeature:function(e,t){t.getfeature={href:{},formats:[]},this.readChildNodes(e,t.getfeature)},ResultFormat:function(e,t){for(var i,s=e.childNodes,n=0;n<s.length;n++)i=s[n],1==i.nodeType&&t.formats.push(i.nodeName)},DCPType:function(e,t){this.readChildNodes(e,t)},HTTP:function(e,t){this.readChildNodes(e,t.href)},Get:function(e,t){t.get=e.getAttribute("onlineResource")},Post:function(e,t){t.post=e.getAttribute("onlineResource")},SRS:function(e,t){var i=this.getChildValue(e);i&&(t.srs=i)}},OpenLayers.Format.WFSCapabilities.v1.prototype.readers.wfs)},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1_0_0"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.SOSGetFeatureOfInterest=OpenLayers.Class(OpenLayers.Format.XML,{VERSION:"1.0.0",namespaces:{sos:"http://www.opengis.net/sos/1.0",gml:"http://www.opengis.net/gml",sa:"http://www.opengis.net/sampling/1.0",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"http://www.opengis.net/sos/1.0 http://schemas.opengis.net/sos/1.0.0/sosAll.xsd",defaultPrefix:"sos",regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},read:function(e){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e])),e&&9==e.nodeType&&(e=e.documentElement);var t={features:[]};this.readNode(e,t);for(var i=[],s=0,n=t.features.length;n>s;s++){var r=t.features[s];this.internalProjection&&this.externalProjection&&r.components[0]&&r.components[0].transform(this.externalProjection,this.internalProjection);var a=new OpenLayers.Feature.Vector(r.components[0],r.attributes);i.push(a)}return i},readers:{sa:{SamplingPoint:function(e,t){if(!t.attributes){var i={attributes:{}};t.features.push(i),t=i}t.attributes.id=this.getAttributeNS(e,this.namespaces.gml,"id"),this.readChildNodes(e,t)},position:function(e,t){this.readChildNodes(e,t)}},gml:OpenLayers.Util.applyDefaults({FeatureCollection:function(e,t){this.readChildNodes(e,t)},featureMember:function(e,t){var i={attributes:{}};t.features.push(i),this.readChildNodes(e,i)},name:function(e,t){t.attributes.name=this.getChildValue(e)},pos:function(e,t){this.externalProjection||(this.externalProjection=new OpenLayers.Projection(e.getAttribute("srsName"))),OpenLayers.Format.GML.v3.prototype.readers.gml.pos.apply(this,[e,t])}},OpenLayers.Format.GML.v3.prototype.readers.gml)},writers:{sos:{GetFeatureOfInterest:function(e){for(var t=this.createElementNSPlus("GetFeatureOfInterest",{attributes:{version:this.VERSION,service:"SOS","xsi:schemaLocation":this.schemaLocation}}),i=0,s=e.fois.length;s>i;i++)this.writeNode("FeatureOfInterestId",{foi:e.fois[i]},t);return t},FeatureOfInterestId:function(e){var t=this.createElementNSPlus("FeatureOfInterestId",{value:e.foi});return t}}},CLASS_NAME:"OpenLayers.Format.SOSGetFeatureOfInterest"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.SOSGetObservation=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows",gml:"http://www.opengis.net/gml",sos:"http://www.opengis.net/sos/1.0",ogc:"http://www.opengis.net/ogc",om:"http://www.opengis.net/om/1.0",sa:"http://www.opengis.net/sampling/1.0",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/sos/1.0 http://schemas.opengis.net/sos/1.0.0/sosGetObservation.xsd",defaultPrefix:"sos",read:function(e){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e])),e&&9==e.nodeType&&(e=e.documentElement);var t={measurements:[],observations:[]};return this.readNode(e,t),t},write:function(e){var t=this.writeNode("sos:GetObservation",e);return t.setAttribute("xmlns:om",this.namespaces.om),t.setAttribute("xmlns:ogc",this.namespaces.ogc),this.setAttributeNS(t,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation),OpenLayers.Format.XML.prototype.write.apply(this,[t])},readers:{om:{ObservationCollection:function(e,t){t.id=this.getAttributeNS(e,this.namespaces.gml,"id"),this.readChildNodes(e,t)},member:function(e,t){this.readChildNodes(e,t)},Measurement:function(e,t){var i={};t.measurements.push(i),this.readChildNodes(e,i)},Observation:function(e,t){var i={};t.observations.push(i),this.readChildNodes(e,i)},samplingTime:function(e,t){var i={};t.samplingTime=i,this.readChildNodes(e,i)},observedProperty:function(e,t){t.observedProperty=this.getAttributeNS(e,this.namespaces.xlink,"href"),this.readChildNodes(e,t)},procedure:function(e,t){t.procedure=this.getAttributeNS(e,this.namespaces.xlink,"href"),this.readChildNodes(e,t)},featureOfInterest:function(e,t){var i={features:[]};t.fois=[],t.fois.push(i),this.readChildNodes(e,i);for(var s=[],n=0,r=i.features.length;r>n;n++){var a=i.features[n];s.push(new OpenLayers.Feature.Vector(a.components[0],a.attributes))}i.features=s},result:function(e,t){var i={};t.result=i,""!==this.getChildValue(e)?(i.value=this.getChildValue(e),i.uom=e.getAttribute("uom")):this.readChildNodes(e,i)}},sa:OpenLayers.Format.SOSGetFeatureOfInterest.prototype.readers.sa,gml:OpenLayers.Util.applyDefaults({TimeInstant:function(e,t){var i={};t.timeInstant=i,this.readChildNodes(e,i)},timePosition:function(e,t){t.timePosition=this.getChildValue(e)}},OpenLayers.Format.SOSGetFeatureOfInterest.prototype.readers.gml)},writers:{sos:{GetObservation:function(e){var t=this.createElementNSPlus("GetObservation",{attributes:{version:this.VERSION,service:"SOS"}});this.writeNode("offering",e,t),e.eventTime&&this.writeNode("eventTime",e,t);for(var i in e.procedures)this.writeNode("procedure",e.procedures[i],t);for(var s in e.observedProperties)this.writeNode("observedProperty",e.observedProperties[s],t);return e.foi&&this.writeNode("featureOfInterest",e.foi,t),this.writeNode("responseFormat",e,t),e.resultModel&&this.writeNode("resultModel",e,t),e.responseMode&&this.writeNode("responseMode",e,t),t},featureOfInterest:function(e){var t=this.createElementNSPlus("featureOfInterest");return this.writeNode("ObjectID",e.objectId,t),t},ObjectID:function(e){return this.createElementNSPlus("ObjectID",{value:e})},responseFormat:function(e){return this.createElementNSPlus("responseFormat",{value:e.responseFormat})},procedure:function(e){return this.createElementNSPlus("procedure",{value:e})},offering:function(e){return this.createElementNSPlus("offering",{value:e.offering})},observedProperty:function(e){return this.createElementNSPlus("observedProperty",{value:e})},eventTime:function(e){var t=this.createElementNSPlus("eventTime");return"latest"===e.eventTime&&this.writeNode("ogc:TM_Equals",e,t),t},resultModel:function(e){return this.createElementNSPlus("resultModel",{value:e.resultModel})},responseMode:function(e){return this.createElementNSPlus("responseMode",{value:e.responseMode})}},ogc:{TM_Equals:function(e){var t=this.createElementNSPlus("ogc:TM_Equals");return this.writeNode("ogc:PropertyName",{property:"urn:ogc:data:time:iso8601"},t),"latest"===e.eventTime&&this.writeNode("gml:TimeInstant",{value:"latest"},t),t},PropertyName:function(e){return this.createElementNSPlus("ogc:PropertyName",{value:e.property})}},gml:{TimeInstant:function(e){var t=this.createElementNSPlus("gml:TimeInstant");return this.writeNode("gml:timePosition",e,t),t},timePosition:function(e){var t=this.createElementNSPlus("gml:timePosition",{value:e.value});return t}}},CLASS_NAME:"OpenLayers.Format.SOSGetObservation"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.Zoomify=OpenLayers.Class(OpenLayers.Layer.Grid,{size:null,isBaseLayer:!0,standardTileSize:256,tileOriginCorner:"tl",numberOfTiers:0,tileCountUpToTier:null,tierSizeInTiles:null,tierImageSize:null,initialize:function(e,t,i,s){this.initializeZoomify(i),OpenLayers.Layer.Grid.prototype.initialize.apply(this,[e,t,i,{},s])},initializeZoomify:function(e){var t=e.clone(),i=new OpenLayers.Size(Math.ceil(t.w/this.standardTileSize),Math.ceil(t.h/this.standardTileSize));for(this.tierSizeInTiles=[i],this.tierImageSize=[t];t.w>this.standardTileSize||t.h>this.standardTileSize;)t=new OpenLayers.Size(Math.floor(t.w/2),Math.floor(t.h/2)),i=new OpenLayers.Size(Math.ceil(t.w/this.standardTileSize),Math.ceil(t.h/this.standardTileSize)),this.tierSizeInTiles.push(i),this.tierImageSize.push(t);this.tierSizeInTiles.reverse(),this.tierImageSize.reverse(),this.numberOfTiers=this.tierSizeInTiles.length,this.tileCountUpToTier=[0];for(var s=1;s<this.numberOfTiers;s++)this.tileCountUpToTier.push(this.tierSizeInTiles[s-1].w*this.tierSizeInTiles[s-1].h+this.tileCountUpToTier[s-1])},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments),this.tileCountUpToTier.length=0,this.tierSizeInTiles.length=0,this.tierImageSize.length=0},clone:function(e){return null==e&&(e=new OpenLayers.Layer.Zoomify(this.name,this.url,this.size,this.options)),e=OpenLayers.Layer.Grid.prototype.clone.apply(this,[e])},getURL:function(e){e=this.adjustBounds(e);var t=this.map.getResolution(),i=Math.round((e.left-this.tileOrigin.lon)/(t*this.tileSize.w)),s=Math.round((this.tileOrigin.lat-e.top)/(t*this.tileSize.h)),n=this.map.getZoom(),r=i+s*this.tierSizeInTiles[n].w+this.tileCountUpToTier[n],a="TileGroup"+Math.floor(r/256)+"/"+n+"-"+i+"-"+s+".jpg",o=this.url;return OpenLayers.Util.isArray(o)&&(o=this.selectUrl(a,o)),o+a},getImageSize:function(){if(arguments.length>0){var e=this.adjustBounds(arguments[0]),t=this.map.getResolution(),i=Math.round((e.left-this.tileOrigin.lon)/(t*this.tileSize.w)),s=Math.round((this.tileOrigin.lat-e.top)/(t*this.tileSize.h)),n=this.map.getZoom(),r=this.standardTileSize,a=this.standardTileSize;if(i==this.tierSizeInTiles[n].w-1)var r=this.tierImageSize[n].w%this.standardTileSize;if(s==this.tierSizeInTiles[n].h-1)var a=this.tierImageSize[n].h%this.standardTileSize;return new OpenLayers.Size(r,a)}return this.tileSize},setMap:function(){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments),this.tileOrigin=new OpenLayers.LonLat(this.map.maxExtent.left,this.map.maxExtent.top)},calculateGridLayout:function(e,t,i){var s=i*this.tileSize.w,n=i*this.tileSize.h,r=e.left-t.lon,a=Math.floor(r/s)-this.buffer,o=r/s-a,l=-o*this.tileSize.w,h=t.lon+a*s,u=t.lat-e.top+n,c=Math.floor(u/n)-this.buffer,d=c-u/n,p=d*this.tileSize.h,f=t.lat-n*c;return{tilelon:s,tilelat:n,tileoffsetlon:h,tileoffsetlat:f,tileoffsetx:l,tileoffsety:p}},CLASS_NAME:"OpenLayers.Layer.Zoomify"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Handler.Keyboard=OpenLayers.Class(OpenLayers.Handler,{KEY_EVENTS:["keydown","keyup"],eventListener:null,observeElement:null,initialize:function(){OpenLayers.Handler.prototype.initialize.apply(this,arguments),this.eventListener=OpenLayers.Function.bindAsEventListener(this.handleKeyEvent,this)},destroy:function(){this.deactivate(),this.eventListener=null,OpenLayers.Handler.prototype.destroy.apply(this,arguments)},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.observeElement=this.observeElement||document;for(var e=0,t=this.KEY_EVENTS.length;t>e;e++)OpenLayers.Event.observe(this.observeElement,this.KEY_EVENTS[e],this.eventListener);return!0}return!1},deactivate:function(){var e=!1;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){for(var t=0,i=this.KEY_EVENTS.length;i>t;t++)OpenLayers.Event.stopObserving(this.observeElement,this.KEY_EVENTS[t],this.eventListener);e=!0}return e},handleKeyEvent:function(e){this.checkModifiers(e)&&this.callback(e.type,[e])},CLASS_NAME:"OpenLayers.Handler.Keyboard"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.MapServer=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{mode:"map",map_imagetype:"png"},initialize:function(e,t,i,s){OpenLayers.Layer.Grid.prototype.initialize.apply(this,arguments),this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS),(null==s||null==s.isBaseLayer)&&(this.isBaseLayer="true"!=this.params.transparent&&1!=this.params.transparent)},clone:function(e){return null==e&&(e=new OpenLayers.Layer.MapServer(this.name,this.url,this.params,this.getOptions())),e=OpenLayers.Layer.Grid.prototype.clone.apply(this,[e])},getURL:function(e){e=this.adjustBounds(e);var t=[e.left,e.bottom,e.right,e.top],i=this.getImageSize(),s=this.getFullRequestString({mapext:t,imgext:t,map_size:[i.w,i.h],imgx:i.w/2,imgy:i.h/2,imgxy:[i.w,i.h]});return s},getFullRequestString:function(e,t){var i=null==t?this.url:t,s=OpenLayers.Util.extend({},this.params);s=OpenLayers.Util.extend(s,e);var n=OpenLayers.Util.getParameterString(s);OpenLayers.Util.isArray(i)&&(i=this.selectUrl(n,i));var r=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(i));for(var a in s)a.toUpperCase()in r&&delete s[a];n=OpenLayers.Util.getParameterString(s);var o=i;if(n=n.replace(/,/g,"+"),""!=n){var l=i.charAt(i.length-1);o+="&"==l||"?"==l?n:-1==i.indexOf("?")?"?"+n:"&"+n}return o},CLASS_NAME:"OpenLayers.Layer.MapServer"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Renderer.VML=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"urn:schemas-microsoft-com:vml",symbolCache:{},offset:null,initialize:function(){if(this.supported()){if(!document.namespaces.olv){document.namespaces.add("olv",this.xmlns);for(var e=document.createStyleSheet(),t=["shape","rect","oval","fill","stroke","imagedata","group","textbox"],i=0,s=t.length;s>i;i++)e.addRule("olv\\:"+t[i],"behavior: url(#default#VML); position: absolute; display: inline-block;")}OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments)}},supported:function(){return!!document.namespaces},setExtent:function(e,t){var i=OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments),s=this.getResolution(),n=0|e.left/s,r=0|e.top/s-this.size.h;t||!this.offset?(this.offset={x:n,y:r},n=0,r=0):(n-=this.offset.x,r-=this.offset.y);var a=n-this.xOffset+" "+r;this.root.coordorigin=a;for(var o,l=[this.root,this.vectorRoot,this.textRoot],h=0,u=l.length;u>h;++h){o=l[h];var c=this.size.w+" "+this.size.h;o.coordsize=c}return this.root.style.flip="y",i},setSize:function(){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);for(var e,t=[this.rendererRoot,this.root,this.vectorRoot,this.textRoot],i=this.size.w+"px",s=this.size.h+"px",n=0,r=t.length;r>n;++n)e=t[n],e.style.width=i,e.style.height=s},getNodeType:function(e,t){var i=null;switch(e.CLASS_NAME){case"OpenLayers.Geometry.Point":i=t.externalGraphic?"olv:rect":this.isComplexSymbol(t.graphicName)?"olv:shape":"olv:oval";break;case"OpenLayers.Geometry.Rectangle":i="olv:rect";break;case"OpenLayers.Geometry.LineString":case"OpenLayers.Geometry.LinearRing":case"OpenLayers.Geometry.Polygon":case"OpenLayers.Geometry.Curve":i="olv:shape"}return i},setStyle:function(e,t,i,s){t=t||e._style,i=i||e._options;var n=t.fillColor;if("OpenLayers.Geometry.Point"===e._geometryClass)if(t.externalGraphic){i.isFilled=!0,t.graphicTitle&&(e.title=t.graphicTitle);var r=t.graphicWidth||t.graphicHeight,a=t.graphicHeight||t.graphicWidth;r=r?r:2*t.pointRadius,a=a?a:2*t.pointRadius;var o=this.getResolution(),l=void 0!=t.graphicXOffset?t.graphicXOffset:-(.5*r),h=void 0!=t.graphicYOffset?t.graphicYOffset:-(.5*a);e.style.left=(0|(s.x-this.featureDx)/o-this.offset.x+l)+"px",e.style.top=(0|s.y/o-this.offset.y-(h+a))+"px",e.style.width=r+"px",e.style.height=a+"px",e.style.flip="y",n="none",i.isStroked=!1}else if(this.isComplexSymbol(t.graphicName)){var u=this.importSymbol(t.graphicName);e.path=u.path,e.coordorigin=u.left+","+u.bottom;var c=u.size;e.coordsize=c+","+c,this.drawCircle(e,s,t.pointRadius),e.style.flip="y"}else this.drawCircle(e,s,t.pointRadius);i.isFilled?e.fillcolor=n:e.filled="false";var d=e.getElementsByTagName("fill"),p=0==d.length?null:d[0];i.isFilled?(p||(p=this.createNode("olv:fill",e.id+"_fill")),p.opacity=t.fillOpacity,"OpenLayers.Geometry.Point"===e._geometryClass&&t.externalGraphic&&(t.graphicOpacity&&(p.opacity=t.graphicOpacity),p.src=t.externalGraphic,p.type="frame",t.graphicWidth&&t.graphicHeight||(p.aspect="atmost")),p.parentNode!=e&&e.appendChild(p)):p&&e.removeChild(p);var f=t.rotation;(void 0!==f||void 0!==e._rotation)&&(e._rotation=f,t.externalGraphic?(this.graphicRotate(e,l,h,t),p.opacity=0):"OpenLayers.Geometry.Point"===e._geometryClass&&(e.style.rotation=f||0));var m=e.getElementsByTagName("stroke"),y=0==m.length?null:m[0];return i.isStroked?(y||(y=this.createNode("olv:stroke",e.id+"_stroke"),e.appendChild(y)),y.on=!0,y.color=t.strokeColor,y.weight=t.strokeWidth+"px",y.opacity=t.strokeOpacity,y.endcap="butt"==t.strokeLinecap?"flat":t.strokeLinecap||"round",t.strokeDashstyle&&(y.dashstyle=this.dashStyle(t))):(e.stroked=!1,y&&(y.on=!1)),"inherit"!=t.cursor&&null!=t.cursor&&(e.style.cursor=t.cursor),e},graphicRotate:function(e,t,i,s){var n,r,s=s||e._style,a=s.rotation||0;if(!s.graphicWidth||!s.graphicHeight){var o=new Image;return o.onreadystatechange=OpenLayers.Function.bind(function(){("complete"==o.readyState||"interactive"==o.readyState)&&(n=o.width/o.height,r=Math.max(2*s.pointRadius,s.graphicWidth||0,s.graphicHeight||0),t*=n,s.graphicWidth=r*n,s.graphicHeight=r,this.graphicRotate(e,t,i,s))},this),o.src=s.externalGraphic,void 0}r=Math.max(s.graphicWidth,s.graphicHeight),n=s.graphicWidth/s.graphicHeight;var l=Math.round(s.graphicWidth||r*n),h=Math.round(s.graphicHeight||r);e.style.width=l+"px",e.style.height=h+"px";var u=document.getElementById(e.id+"_image");u||(u=this.createNode("olv:imagedata",e.id+"_image"),e.appendChild(u)),u.style.width=l+"px",u.style.height=h+"px",u.src=s.externalGraphic,u.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='', sizingMethod='scale')";var c=a*Math.PI/180,d=Math.sin(c),p=Math.cos(c),f="progid:DXImageTransform.Microsoft.Matrix(M11="+p+",M12="+-d+",M21="+d+",M22="+p+",SizingMethod='auto expand')\n",m=s.graphicOpacity||s.fillOpacity;m&&1!=m&&(f+="progid:DXImageTransform.Microsoft.BasicImage(opacity="+m+")\n"),e.style.filter=f;var y=new OpenLayers.Geometry.Point(-t,-i),g=new OpenLayers.Bounds(0,0,l,h).toGeometry();g.rotate(s.rotation,y);var v=g.getBounds();e.style.left=Math.round(parseInt(e.style.left)+v.left)+"px",e.style.top=Math.round(parseInt(e.style.top)-v.bottom)+"px"},postDraw:function(e){e.style.visibility="visible";var t=e._style.fillColor,i=e._style.strokeColor;"none"==t&&e.fillcolor!=t&&(e.fillcolor=t),"none"==i&&e.strokecolor!=i&&(e.strokecolor=i)},setNodeDimension:function(e,t){var i=t.getBounds();if(i){var s=this.getResolution(),n=new OpenLayers.Bounds(0|(i.left-this.featureDx)/s-this.offset.x,0|i.bottom/s-this.offset.y,0|(i.right-this.featureDx)/s-this.offset.x,0|i.top/s-this.offset.y);e.style.left=n.left+"px",e.style.top=n.top+"px",e.style.width=n.getWidth()+"px",e.style.height=n.getHeight()+"px",e.coordorigin=n.left+" "+n.top,e.coordsize=n.getWidth()+" "+n.getHeight()}},dashStyle:function(e){var t=e.strokeDashstyle;switch(t){case"solid":case"dot":case"dash":case"dashdot":case"longdash":case"longdashdot":return t;default:var i=t.split(/[ ,]/);return 2==i.length?1*i[0]>=2*i[1]?"longdash":1==i[0]||1==i[1]?"dot":"dash":4==i.length?1*i[0]>=2*i[1]?"longdashdot":"dashdot":"solid"}},createNode:function(e,t){var i=document.createElement(e);return t&&(i.id=t),i.unselectable="on",i.onselectstart=OpenLayers.Function.False,i},nodeTypeCompare:function(e,t){var i=t,s=i.indexOf(":");-1!=s&&(i=i.substr(s+1));var n=e.nodeName;return s=n.indexOf(":"),-1!=s&&(n=n.substr(s+1)),i==n},createRenderRoot:function(){return this.nodeFactory(this.container.id+"_vmlRoot","div")},createRoot:function(e){return this.nodeFactory(this.container.id+e,"olv:group")},drawPoint:function(e,t){return this.drawCircle(e,t,1)},drawCircle:function(e,t,i){if(!isNaN(t.x)&&!isNaN(t.y)){var s=this.getResolution();e.style.left=(0|(t.x-this.featureDx)/s-this.offset.x)-i+"px",e.style.top=(0|t.y/s-this.offset.y)-i+"px";var n=2*i;return e.style.width=n+"px",e.style.height=n+"px",e}return!1},drawLineString:function(e,t){return this.drawLine(e,t,!1)},drawLinearRing:function(e,t){return this.drawLine(e,t,!0)},drawLine:function(e,t,i){this.setNodeDimension(e,t);for(var s,n,r,a=this.getResolution(),o=t.components.length,l=new Array(o),h=0;o>h;h++)s=t.components[h],n=0|(s.x-this.featureDx)/a-this.offset.x,r=0|s.y/a-this.offset.y,l[h]=" "+n+","+r+" l ";var u=i?" x e":" e";return e.path="m"+l.join("")+u,e},drawPolygon:function(e,t){this.setNodeDimension(e,t);var i,s,n,r,a,o,l,h,u,c,d,p,f=this.getResolution(),m=[];for(i=0,s=t.components.length;s>i;i++){for(m.push("m"),n=t.components[i].components,r=0===i,a=null,o=null,l=0,h=n.length;h>l;l++)u=n[l],d=0|(u.x-this.featureDx)/f-this.offset.x,p=0|u.y/f-this.offset.y,c=" "+d+","+p,m.push(c),0==l&&m.push(" l"),r||(a?a!=c&&(o?o!=c&&(r=!0):o=c):a=c);m.push(r?" x ":" ")}return m.push("e"),e.path=m.join(""),e},drawRectangle:function(e,t){var i=this.getResolution();return e.style.left=(0|(t.x-this.featureDx)/i-this.offset.x)+"px",e.style.top=(0|t.y/i-this.offset.y)+"px",e.style.width=(0|t.width/i)+"px",e.style.height=(0|t.height/i)+"px",e},drawText:function(e,t,i){var s=this.nodeFactory(e+this.LABEL_ID_SUFFIX,"olv:rect"),n=this.nodeFactory(e+this.LABEL_ID_SUFFIX+"_textbox","olv:textbox"),r=this.getResolution();s.style.left=(0|(i.x-this.featureDx)/r-this.offset.x)+"px",s.style.top=(0|i.y/r-this.offset.y)+"px",s.style.flip="y",n.innerText=t.label,"inherit"!=t.cursor&&null!=t.cursor&&(n.style.cursor=t.cursor),t.fontColor&&(n.style.color=t.fontColor),t.fontOpacity&&(n.style.filter="alpha(opacity="+100*t.fontOpacity+")"),t.fontFamily&&(n.style.fontFamily=t.fontFamily),t.fontSize&&(n.style.fontSize=t.fontSize),t.fontWeight&&(n.style.fontWeight=t.fontWeight),t.fontStyle&&(n.style.fontStyle=t.fontStyle),t.labelSelect===!0&&(s._featureId=e,n._featureId=e,n._geometry=i,n._geometryClass=i.CLASS_NAME),n.style.whiteSpace="nowrap",n.inset="1px,0px,0px,0px",s.parentNode||(s.appendChild(n),this.textRoot.appendChild(s));var a=t.labelAlign||"cm";1==a.length&&(a+="m");var o=n.clientWidth*OpenLayers.Renderer.VML.LABEL_SHIFT[a.substr(0,1)],l=n.clientHeight*OpenLayers.Renderer.VML.LABEL_SHIFT[a.substr(1,1)];s.style.left=parseInt(s.style.left)-o-1+"px",s.style.top=parseInt(s.style.top)+l+"px"},moveRoot:function(e){var t=this.map.getLayer(e.container.id);t instanceof OpenLayers.Layer.Vector.RootContainer&&(t=this.map.getLayer(this.container.id)),t&&t.renderer.clear(),OpenLayers.Renderer.Elements.prototype.moveRoot.apply(this,arguments),t&&t.redraw()},importSymbol:function(e){var t=this.container.id+"-"+e,i=this.symbolCache[t];if(i)return i;var s=OpenLayers.Renderer.symbol[e];if(!s)throw new Error(e+" is not a valid symbol name");for(var n=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0),r=["m"],a=0;a<s.length;a+=2){var o=s[a],l=s[a+1];n.left=Math.min(n.left,o),n.bottom=Math.min(n.bottom,l),n.right=Math.max(n.right,o),n.top=Math.max(n.top,l),r.push(o),r.push(l),0==a&&r.push("l")}r.push("x e");var h=r.join(" "),u=(n.getWidth()-n.getHeight())/2;return u>0?(n.bottom=n.bottom-u,n.top=n.top+u):(n.left=n.left+u,n.right=n.right-u),i={path:h,size:n.getWidth(),left:n.left,bottom:n.bottom},this.symbolCache[t]=i,i},CLASS_NAME:"OpenLayers.Renderer.VML"}),OpenLayers.Renderer.VML.LABEL_SHIFT={l:0,c:.5,r:1,t:0,m:.5,b:1},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.CacheRead=OpenLayers.Class(OpenLayers.Control,{fetchEvent:"tileloadstart",layers:null,autoActivate:!0,setMap:function(e){OpenLayers.Control.prototype.setMap.apply(this,arguments);var t,i=this.layers||e.layers;for(t=i.length-1;t>=0;--t)this.addLayer({layer:i[t]});this.layers||e.events.on({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this})},addLayer:function(e){e.layer.events.register(this.fetchEvent,this,this.fetch)},removeLayer:function(e){e.layer.events.unregister(this.fetchEvent,this,this.fetch)},fetch:function(e){if(this.active&&window.localStorage&&e.tile instanceof OpenLayers.Tile.Image){var t=e.tile,i=t.url;!t.layer.crossOriginKeyword&&OpenLayers.ProxyHost&&0===i.indexOf(OpenLayers.ProxyHost)&&(i=OpenLayers.Control.CacheWrite.urlMap[i]);var s=window.localStorage.getItem("olCache_"+i);s&&(t.url=s,"tileerror"===e.type&&t.setImgSrc(s))}},destroy:function(){if(this.layers||this.map){var e,t=this.layers||this.map.layers;for(e=t.length-1;e>=0;--e)this.removeLayer({layer:t[e]})}this.map&&this.map.events.un({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this}),OpenLayers.Control.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.CacheRead"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Protocol.WFS.v1_0_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,{version:"1.0.0",CLASS_NAME:"OpenLayers.Protocol.WFS.v1_0_0"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.Text=OpenLayers.Class(OpenLayers.Layer.Markers,{location:null,features:null,formatOptions:null,selectedFeature:null,initialize:function(){OpenLayers.Layer.Markers.prototype.initialize.apply(this,arguments),this.features=[]},destroy:function(){OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments),this.clearFeatures(),this.features=null},loadText:function(){if(!this.loaded&&null!=this.location){var e=function(){this.events.triggerEvent("loadend")};this.events.triggerEvent("loadstart"),OpenLayers.Request.GET({url:this.location,success:this.parseData,failure:e,scope:this}),this.loaded=!0}},moveTo:function(){OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments),this.visibility&&!this.loaded&&this.loadText()},parseData:function(e){var t=e.responseText,i={};OpenLayers.Util.extend(i,this.formatOptions),this.map&&!this.projection.equals(this.map.getProjectionObject())&&(i.externalProjection=this.projection,i.internalProjection=this.map.getProjectionObject());for(var s=new OpenLayers.Format.Text(i),n=s.read(t),r=0,a=n.length;a>r;r++){var o,l,h,u={},c=n[r];o=new OpenLayers.LonLat(c.geometry.x,c.geometry.y),c.style.graphicWidth&&c.style.graphicHeight&&(l=new OpenLayers.Size(c.style.graphicWidth,c.style.graphicHeight)),void 0!==c.style.graphicXOffset&&void 0!==c.style.graphicYOffset&&(h=new OpenLayers.Pixel(c.style.graphicXOffset,c.style.graphicYOffset)),null!=c.style.externalGraphic?u.icon=new OpenLayers.Icon(c.style.externalGraphic,l,h):(u.icon=OpenLayers.Marker.defaultIcon(),null!=l&&u.icon.setSize(l)),null!=c.attributes.title&&null!=c.attributes.description&&(u.popupContentHTML="<h2>"+c.attributes.title+"</h2>"+"<p>"+c.attributes.description+"</p>"),u.overflow=c.attributes.overflow||"auto";var d=new OpenLayers.Feature(this,o,u);this.features.push(d);var p=d.createMarker();null!=c.attributes.title&&null!=c.attributes.description&&p.events.register("click",d,this.markerClick),this.addMarker(p)}this.events.triggerEvent("loadend")},markerClick:function(e){var t=this==this.layer.selectedFeature;this.layer.selectedFeature=t?null:this;for(var i=0,s=this.layer.map.popups.length;s>i;i++)this.layer.map.removePopup(this.layer.map.popups[i]);t||this.layer.map.addPopup(this.createPopup()),OpenLayers.Event.stop(e)},clearFeatures:function(){if(null!=this.features)for(;this.features.length>0;){var e=this.features[0];OpenLayers.Util.removeItem(this.features,e),e.destroy()}},CLASS_NAME:"OpenLayers.Layer.Text"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Protocol.CSW.v2_0_2=OpenLayers.Class(OpenLayers.Protocol,{formatOptions:null,initialize:function(e){OpenLayers.Protocol.prototype.initialize.apply(this,[e]),e.format||(this.format=new OpenLayers.Format.CSWGetRecords.v2_0_2(OpenLayers.Util.extend({},this.formatOptions)))},destroy:function(){this.options&&!this.options.format&&this.format.destroy(),this.format=null,OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(e){e=OpenLayers.Util.extend({},e),OpenLayers.Util.applyDefaults(e,this.options||{});var t=new OpenLayers.Protocol.Response({requestType:"read"}),i=this.format.write(e.params);return t.priv=OpenLayers.Request.POST({url:e.url,callback:this.createCallback(this.handleRead,t,e),params:e.params,headers:e.headers,data:i}),t},handleRead:function(e,t){if(t.callback){var i=e.priv;i.status>=200&&i.status<300?(e.data=this.parseData(i),e.code=OpenLayers.Protocol.Response.SUCCESS):e.code=OpenLayers.Protocol.Response.FAILURE,t.callback.call(t.scope,e)}},parseData:function(e){var t=e.responseXML;return t&&t.documentElement||(t=e.responseText),!t||t.length<=0?null:this.format.read(t)},CLASS_NAME:"OpenLayers.Protocol.CSW.v2_0_2"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.SLDSelect=OpenLayers.Class(OpenLayers.Control,{clearOnDeactivate:!1,layers:null,callbacks:null,selectionSymbolizer:{Polygon:{fillColor:"#FF0000",stroke:!1},Line:{strokeColor:"#FF0000",strokeWidth:2},Point:{graphicName:"square",fillColor:"#FF0000",pointRadius:5}},layerOptions:null,handlerOptions:null,sketchStyle:null,wfsCache:{},layerCache:{},initialize:function(e,t){OpenLayers.Control.prototype.initialize.apply(this,[t]),this.callbacks=OpenLayers.Util.extend({done:this.select,click:this.select},this.callbacks),this.handlerOptions=this.handlerOptions||{},this.layerOptions=OpenLayers.Util.applyDefaults(this.layerOptions,{displayInLayerSwitcher:!1,tileOptions:{maxGetUrlLength:2048}}),this.sketchStyle&&(this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{styleMap:new OpenLayers.StyleMap({"default":this.sketchStyle})})),this.handler=new e(this,this.callbacks,this.handlerOptions)},destroy:function(){for(var e in this.layerCache)delete this.layerCache[e];for(var e in this.wfsCache)delete this.wfsCache[e];OpenLayers.Control.prototype.destroy.apply(this,arguments)},coupleLayerVisiblity:function(e){this.setVisibility(e.object.getVisibility())},createSelectionLayer:function(e){var t;return this.layerCache[e.id]?t=this.layerCache[e.id]:(t=new OpenLayers.Layer.WMS(e.name,e.url,e.params,OpenLayers.Util.applyDefaults(this.layerOptions,e.getOptions())),this.layerCache[e.id]=t,this.layerOptions.displayInLayerSwitcher===!1&&e.events.on({visibilitychanged:this.coupleLayerVisiblity,scope:t}),this.map.addLayer(t)),t},createSLD:function(e,t,i){for(var s={version:"1.0.0",namedLayers:{}},n=[e.params.LAYERS].join(",").split(","),r=0,a=n.length;a>r;r++){var o=n[r];s.namedLayers[o]={name:o,userStyles:[]};var l=this.selectionSymbolizer,h=i[r];h.type.indexOf("Polygon")>=0?l={Polygon:this.selectionSymbolizer.Polygon}:h.type.indexOf("LineString")>=0?l={Line:this.selectionSymbolizer.Line}:h.type.indexOf("Point")>=0&&(l={Point:this.selectionSymbolizer.Point});var u=t[r];s.namedLayers[o].userStyles.push({name:"default",rules:[new OpenLayers.Rule({symbolizer:l,filter:u,maxScaleDenominator:e.options.minScale})]})}return new OpenLayers.Format.SLD({srsName:this.map.getProjection()}).write(s)},parseDescribeLayer:function(e){var t=new OpenLayers.Format.WMSDescribeLayer,i=e.responseXML;i&&i.documentElement||(i=e.responseText);for(var s=t.read(i),n=[],r=null,a=0,o=s.length;o>a;a++)"WFS"==s[a].owsType&&(n.push(s[a].typeName),r=s[a].owsURL);var l={url:r,params:{SERVICE:"WFS",TYPENAME:n.toString(),REQUEST:"DescribeFeatureType",VERSION:"1.0.0"},callback:function(e){var t=new OpenLayers.Format.WFSDescribeFeatureType,i=e.responseXML;i&&i.documentElement||(i=e.responseText);var s=t.read(i);this.control.wfsCache[this.layer.id]=s,this.control._queue&&this.control.applySelection()},scope:this};OpenLayers.Request.GET(l)},getGeometryAttributes:function(e){for(var t=[],i=this.wfsCache[e.id],s=0,n=i.featureTypes.length;n>s;s++)for(var r=i.featureTypes[s],a=r.properties,o=0,l=a.length;l>o;o++){var h=a[o],u=h.type;(u.indexOf("LineString")>=0||u.indexOf("GeometryAssociationType")>=0||u.indexOf("GeometryPropertyType")>=0||u.indexOf("Point")>=0||u.indexOf("Polygon")>=0)&&t.push(h)}return t},activate:function(){var e=OpenLayers.Control.prototype.activate.call(this);if(e)for(var t=0,i=this.layers.length;i>t;t++){var s=this.layers[t];if(s&&!this.wfsCache[s.id]){var n={url:s.url,params:{SERVICE:"WMS",VERSION:s.params.VERSION,LAYERS:s.params.LAYERS,REQUEST:"DescribeLayer"},callback:this.parseDescribeLayer,scope:{layer:s,control:this}};OpenLayers.Request.GET(n)}}return e},deactivate:function(){var e=OpenLayers.Control.prototype.deactivate.call(this);if(e)for(var t=0,i=this.layers.length;i>t;t++){var s=this.layers[t];if(s&&this.clearOnDeactivate===!0){var n=this.layerCache,r=n[s.id];r&&(s.events.un({visibilitychanged:this.coupleLayerVisiblity,scope:r}),r.destroy(),delete n[s.id])}}return e},setLayers:function(e){this.active?(this.deactivate(),this.layers=e,this.activate()):this.layers=e},createFilter:function(e,t){var i=null;return this.handler instanceof OpenLayers.Handler.RegularPolygon?i=this.handler.irregular===!0?new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,property:e.name,value:t.getBounds()}):new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:e.name,value:t}):this.handler instanceof OpenLayers.Handler.Polygon?i=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:e.name,value:t}):this.handler instanceof OpenLayers.Handler.Path?i=e.type.indexOf("Point")>=0?new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.DWITHIN,property:e.name,distance:.01*this.map.getExtent().getWidth(),distanceUnits:this.map.getUnits(),value:t}):new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:e.name,value:t}):this.handler instanceof OpenLayers.Handler.Click&&(i=e.type.indexOf("Polygon")>=0?new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:e.name,value:t}):new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.DWITHIN,property:e.name,distance:.01*this.map.getExtent().getWidth(),distanceUnits:this.map.getUnits(),value:t})),i},select:function(e){this._queue=function(){for(var t=0,i=this.layers.length;i>t;t++){for(var s=this.layers[t],n=this.getGeometryAttributes(s),r=[],a=0,o=n.length;o>a;a++){var l=n[a];if(null!==l){if(!(e instanceof OpenLayers.Geometry)){var h=this.map.getLonLatFromPixel(e.xy);e=new OpenLayers.Geometry.Point(h.lon,h.lat)}var u=this.createFilter(l,e);null!==u&&r.push(u)}}var c=this.createSelectionLayer(s),d=this.createSLD(s,r,n);this.events.triggerEvent("selected",{layer:s,filters:r}),c.mergeNewParams({SLD_BODY:d}),delete this._queue}},this.applySelection()},applySelection:function(){for(var e=!0,t=0,i=this.layers.length;i>t;t++)if(!this.wfsCache[this.layers[t].id]){e=!1;break}e&&this._queue.call(this)},CLASS_NAME:"OpenLayers.Control.SLDSelect"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.Graticule=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,intervals:[45,30,20,10,5,2,1,.5,.2,.1,.05,.01,.005,.002,.001],displayInLayerSwitcher:!0,visible:!0,numPoints:50,targetSize:200,layerName:null,labelled:!0,labelFormat:"dm",lineSymbolizer:{strokeColor:"#333",strokeWidth:1,strokeOpacity:.5},labelSymbolizer:{},gratLayer:null,initialize:function(e){e=e||{},e.layerName=e.layerName||OpenLayers.i18n("Graticule"),OpenLayers.Control.prototype.initialize.apply(this,[e]),this.labelSymbolizer.stroke=!1,this.labelSymbolizer.fill=!1,this.labelSymbolizer.label="${label}",this.labelSymbolizer.labelAlign="${labelAlign}",this.labelSymbolizer.labelXOffset="${xOffset}",this.labelSymbolizer.labelYOffset="${yOffset}"},destroy:function(){this.deactivate(),OpenLayers.Control.prototype.destroy.apply(this,arguments),this.gratLayer&&(this.gratLayer.destroy(),this.gratLayer=null)},draw:function(){if(OpenLayers.Control.prototype.draw.apply(this,arguments),!this.gratLayer){var e=new OpenLayers.Style({},{rules:[new OpenLayers.Rule({symbolizer:{Point:this.labelSymbolizer,Line:this.lineSymbolizer}})]});this.gratLayer=new OpenLayers.Layer.Vector(this.layerName,{styleMap:new OpenLayers.StyleMap({"default":e}),visibility:this.visible,displayInLayerSwitcher:this.displayInLayerSwitcher})}return this.div},activate:function(){return OpenLayers.Control.prototype.activate.apply(this,arguments)?(this.map.addLayer(this.gratLayer),this.map.events.register("moveend",this,this.update),this.update(),!0):!1},deactivate:function(){return OpenLayers.Control.prototype.deactivate.apply(this,arguments)?(this.map.events.unregister("moveend",this,this.update),this.map.removeLayer(this.gratLayer),!0):!1},update:function(){var e=this.map.getExtent();if(e){this.gratLayer.destroyFeatures();var t=new OpenLayers.Projection("EPSG:4326"),i=this.map.getProjectionObject(),s=this.map.getResolution();i.proj&&"longlat"==i.proj.projName&&(this.numPoints=1);var n=this.map.getCenter(),r=new OpenLayers.Pixel(n.lon,n.lat);OpenLayers.Projection.transform(r,i,t);var a=this.targetSize*s;a*=a;for(var o,l=0;l<this.intervals.length;++l){o=this.intervals[l];var h=o/2,u=r.offset({x:-h,y:-h}),c=r.offset({x:h,y:h});OpenLayers.Projection.transform(u,t,i),OpenLayers.Projection.transform(c,t,i);var d=(u.x-c.x)*(u.x-c.x)+(u.y-c.y)*(u.y-c.y);if(a>=d)break}r.x=Math.floor(r.x/o)*o,r.y=Math.floor(r.y/o)*o;var p,f=0,m=[r.clone()],y=r.clone();do y=y.offset({x:0,y:o}),p=OpenLayers.Projection.transform(y.clone(),t,i),m.unshift(y);while(e.containsPixel(p)&&++f<1e3);y=r.clone();do y=y.offset({x:0,y:-o}),p=OpenLayers.Projection.transform(y.clone(),t,i),m.push(y);while(e.containsPixel(p)&&++f<1e3);f=0;var g=[r.clone()];y=r.clone();do y=y.offset({x:-o,y:0}),p=OpenLayers.Projection.transform(y.clone(),t,i),g.unshift(y);while(e.containsPixel(p)&&++f<1e3);y=r.clone();do y=y.offset({x:o,y:0}),p=OpenLayers.Projection.transform(y.clone(),t,i),g.push(y);while(e.containsPixel(p)&&++f<1e3);for(var v=[],l=0;l<g.length;++l){for(var x=g[l].x,E=[],b=null,L=Math.min(m[0].y,90),S=Math.max(m[m.length-1].y,-90),C=(L-S)/this.numPoints,w=S,O=0;O<=this.numPoints;++O){var T=new OpenLayers.Geometry.Point(x,w);T.transform(t,i),E.push(T),w+=C,T.y>=e.bottom&&!b&&(b=T)}if(this.labelled){var M=new OpenLayers.Geometry.Point(b.x,e.bottom),P={value:x,label:this.labelled?OpenLayers.Util.getFormattedLonLat(x,"lon",this.labelFormat):"",labelAlign:"cb",xOffset:0,yOffset:2};this.gratLayer.addFeatures(new OpenLayers.Feature.Vector(M,P))}var N=new OpenLayers.Geometry.LineString(E);v.push(new OpenLayers.Feature.Vector(N))}for(var O=0;O<m.length;++O)if(w=m[O].y,!(-90>w||w>90)){for(var E=[],D=g[0].x,A=g[g.length-1].x,I=(A-D)/this.numPoints,x=D,b=null,l=0;l<=this.numPoints;++l){var T=new OpenLayers.Geometry.Point(x,w);T.transform(t,i),E.push(T),x+=I,T.x<e.right&&(b=T)}if(this.labelled){var M=new OpenLayers.Geometry.Point(e.right,b.y),P={value:w,label:this.labelled?OpenLayers.Util.getFormattedLonLat(w,"lat",this.labelFormat):"",labelAlign:"rb",xOffset:-2,yOffset:2};this.gratLayer.addFeatures(new OpenLayers.Feature.Vector(M,P))}var N=new OpenLayers.Geometry.LineString(E);v.push(new OpenLayers.Feature.Vector(N))}this.gratLayer.addFeatures(v)}},CLASS_NAME:"OpenLayers.Control.Graticule"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.DragFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,onStart:function(){},onDrag:function(){},onComplete:function(){},onEnter:function(){},onLeave:function(){},documentDrag:!1,layer:null,feature:null,dragCallbacks:{},featureCallbacks:{},lastPixel:null,initialize:function(e,t){OpenLayers.Control.prototype.initialize.apply(this,[t]),this.layer=e,this.handlers={drag:new OpenLayers.Handler.Drag(this,OpenLayers.Util.extend({down:this.downFeature,move:this.moveFeature,up:this.upFeature,out:this.cancel,done:this.doneDragging},this.dragCallbacks),{documentDrag:this.documentDrag}),feature:new OpenLayers.Handler.Feature(this,this.layer,OpenLayers.Util.extend({click:this.clickFeature,clickout:this.clickoutFeature,over:this.overFeature,out:this.outFeature},this.featureCallbacks),{geometryTypes:this.geometryTypes})}},clickFeature:function(e){this.handlers.feature.touch&&!this.over&&this.overFeature(e)&&(this.handlers.drag.dragstart(this.handlers.feature.evt),this.handlers.drag.stopDown=!1)},clickoutFeature:function(e){this.handlers.feature.touch&&this.over&&(this.outFeature(e),this.handlers.drag.stopDown=!0)},destroy:function(){this.layer=null,OpenLayers.Control.prototype.destroy.apply(this,[])},activate:function(){return this.handlers.feature.activate()&&OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){return this.handlers.drag.deactivate(),this.handlers.feature.deactivate(),this.feature=null,this.dragging=!1,this.lastPixel=null,OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass+"Over"),OpenLayers.Control.prototype.deactivate.apply(this,arguments)},overFeature:function(e){var t=!1;return this.handlers.drag.dragging?this.over=this.feature.id==e.id?!0:!1:(this.feature=e,this.handlers.drag.activate(),t=!0,this.over=!0,OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass+"Over"),this.onEnter(e)),t},downFeature:function(e){this.lastPixel=e,this.onStart(this.feature,e)},moveFeature:function(e){var t=this.map.getResolution();this.feature.geometry.move(t*(e.x-this.lastPixel.x),t*(this.lastPixel.y-e.y)),this.layer.drawFeature(this.feature),this.lastPixel=e,this.onDrag(this.feature,e)},upFeature:function(){this.over||this.handlers.drag.deactivate()},doneDragging:function(e){this.onComplete(this.feature,e)},outFeature:function(e){this.handlers.drag.dragging?this.feature.id==e.id&&(this.over=!1):(this.over=!1,this.handlers.drag.deactivate(),OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass+"Over"),this.onLeave(e),this.feature=null)},cancel:function(){this.handlers.drag.deactivate(),this.over=!1},setMap:function(e){this.handlers.drag.setMap(e),this.handlers.feature.setMap(e),OpenLayers.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.DragFeature"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.NavigationHistory=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOGGLE,previous:null,previousOptions:null,next:null,nextOptions:null,limit:50,autoActivate:!0,clearOnDeactivate:!1,registry:null,nextStack:null,previousStack:null,listeners:null,restoring:!1,initialize:function(e){OpenLayers.Control.prototype.initialize.apply(this,[e]),this.registry=OpenLayers.Util.extend({moveend:this.getState},this.registry);var t={trigger:OpenLayers.Function.bind(this.previousTrigger,this),displayClass:this.displayClass+" "+this.displayClass+"Previous"};OpenLayers.Util.extend(t,this.previousOptions),this.previous=new OpenLayers.Control.Button(t);var i={trigger:OpenLayers.Function.bind(this.nextTrigger,this),displayClass:this.displayClass+" "+this.displayClass+"Next"};OpenLayers.Util.extend(i,this.nextOptions),this.next=new OpenLayers.Control.Button(i),this.clear()},onPreviousChange:function(e){e&&!this.previous.active?this.previous.activate():!e&&this.previous.active&&this.previous.deactivate()},onNextChange:function(e){e&&!this.next.active?this.next.activate():!e&&this.next.active&&this.next.deactivate()},destroy:function(){OpenLayers.Control.prototype.destroy.apply(this),this.previous.destroy(),this.next.destroy(),this.deactivate();for(var e in this)this[e]=null},setMap:function(e){this.map=e,this.next.setMap(e),this.previous.setMap(e)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments),this.next.draw(),this.previous.draw()},previousTrigger:function(){var e=this.previousStack.shift(),t=this.previousStack.shift();return void 0!=t?(this.nextStack.unshift(e),this.previousStack.unshift(t),this.restoring=!0,this.restore(t),this.restoring=!1,this.onNextChange(this.nextStack[0],this.nextStack.length),this.onPreviousChange(this.previousStack[1],this.previousStack.length-1)):this.previousStack.unshift(e),t},nextTrigger:function(){var e=this.nextStack.shift();return void 0!=e&&(this.previousStack.unshift(e),this.restoring=!0,this.restore(e),this.restoring=!1,this.onNextChange(this.nextStack[0],this.nextStack.length),this.onPreviousChange(this.previousStack[1],this.previousStack.length-1)),e},clear:function(){this.previousStack=[],this.previous.deactivate(),this.nextStack=[],this.next.deactivate()},getState:function(){return{center:this.map.getCenter(),resolution:this.map.getResolution(),projection:this.map.getProjectionObject(),units:this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units}},restore:function(e){var t,i;if(this.map.getProjectionObject()==e.projection)i=this.map.getZoomForResolution(e.resolution),t=e.center;else{t=e.center.clone(),t.transform(e.projection,this.map.getProjectionObject());var s=e.units,n=this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units,r=s&&n?OpenLayers.INCHES_PER_UNIT[s]/OpenLayers.INCHES_PER_UNIT[n]:1;i=this.map.getZoomForResolution(r*e.resolution)}this.map.setCenter(t,i)},setListeners:function(){this.listeners={};for(var e in this.registry)this.listeners[e]=OpenLayers.Function.bind(function(){if(!this.restoring){var t=this.registry[e].apply(this,arguments);this.previousStack.unshift(t),this.previousStack.length>1&&this.onPreviousChange(this.previousStack[1],this.previousStack.length-1),this.previousStack.length>this.limit+1&&this.previousStack.pop(),this.nextStack.length>0&&(this.nextStack=[],this.onNextChange(null,0))}return!0},this)},activate:function(){var e=!1;if(this.map&&OpenLayers.Control.prototype.activate.apply(this)){null==this.listeners&&this.setListeners();for(var t in this.listeners)this.map.events.register(t,this,this.listeners[t]);e=!0,0==this.previousStack.length&&this.initStack()}return e},initStack:function(){this.map.getCenter()&&this.listeners.moveend()},deactivate:function(){var e=!1;if(this.map&&OpenLayers.Control.prototype.deactivate.apply(this)){for(var t in this.listeners)this.map.events.unregister(t,this,this.listeners[t]);this.clearOnDeactivate&&this.clear(),e=!0}return e},CLASS_NAME:"OpenLayers.Control.NavigationHistory"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.UTFGrid=OpenLayers.Class(OpenLayers.Layer.XYZ,{isBaseLayer:!1,projection:new OpenLayers.Projection("EPSG:900913"),useJSONP:!1,tileClass:OpenLayers.Tile.UTFGrid,initialize:function(e){OpenLayers.Layer.Grid.prototype.initialize.apply(this,[e.name,e.url,{},e]),this.tileOptions=OpenLayers.Util.extend({utfgridResolution:this.utfgridResolution},this.tileOptions)},clone:function(e){return null==e&&(e=new OpenLayers.Layer.UTFGrid(this.getOptions())),e=OpenLayers.Layer.Grid.prototype.clone.apply(this,[e])},getFeatureInfo:function(e){var t=null,i=this.getTileData(e);return i.tile&&(t=i.tile.getFeatureInfo(i.i,i.j)),t},getFeatureId:function(e){var t=null,i=this.getTileData(e);return i.tile&&(t=i.tile.getFeatureId(i.i,i.j)),t},CLASS_NAME:"OpenLayers.Layer.UTFGrid"}),/* Copyright (c) 2006-2013 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WCSDescribeCoverage.v1_0_0=OpenLayers.Class(OpenLayers.Format.WCSDescribeCoverage.v1,{namespaces:{wcs:"http://www.opengis.net/wcs",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",ows:"http://www.opengis.net/ows",gml:"http://www.opengis.net/gml"},readers:{wcs:OpenLayers.Util.applyDefaults({CoverageDescription:function(e,t){t.coverageDescriptions={},this.readChildNodes(e,t.coverageDescriptions),t.coverageDescriptionKeys=[];for(var i in t.coverageDescriptions)t.coverageDescriptions.hasOwnProperty(i)&&t.coverageDescriptionKeys.push(i)},CoverageOffering:function(e,t){var i={};this.readChildNodes(e,i),t[i.identifier]=i,i.nativeCRS=i.supportedCRSs.nativeCRSs[0]},name:function(e,t){t.identifier=this.getChildValue(e)},label:function(e,t){t.title=this.getChildValue(e)},lonLatEnvelope:function(e,t){OpenLayers.Format.WCSCapabilities.v1_0_0.prototype.readers.wcs.lonLatEnvelope.call(this,e,t),this.getElementsByTagNameNS(e,"http://www.opengis.net/gml","pos")},domainSet:function(e,t){t.domain={},this.readChildNodes(e,t.domain)},spatialDomain:function(e,t){t.spatialDomain={},t.spatialDomain.boundingBoxes={},this.readChildNodes(e,t.spatialDomain)},nativeCRSs:function(e,t){t.nativeCRSs||(t.nativeCRSs=[]);var i;i=this.getChildValue(e),t.nativeCRSs.push(i)},supportedCRSs:function(e,t){t.supportedCRSs||(t.supportedCRSs=[]),this.readChildNodes(e,t.supportedCRSs)},requestResponseCRSs:function(e,t){t.push(this.getChildValue(e))},supportedFormats:function(e,t){t.supportedFormats||(t.supportedFormats=[]),this.readChildNodes(e,t.supportedFormats)},formats:function(e,t){t.push(this.getChildValue(e))}},OpenLayers.Format.WCSDescribeCoverage.v1.prototype.readers.wcs),ows:OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows,gml:OpenLayers.Util.applyDefaults({Envelope:function(e,t){var i=e.getAttribute("srsName");if(i){var s={points:[]};this.readChildNodes(e,s);var n=s.points[0],r=s.points[1],a=new OpenLayers.Bounds(n.x,n.y,r.x,r.y);t.boundingBoxes[i]=a}}},OpenLayers.Format.GML.v3.prototype.readers.gml)},CLASS_NAME:"OpenLayers.Format.WCSDescribeCoverage.v1_0_0"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.TransformFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,layer:null,preserveAspectRatio:!1,rotate:!0,feature:null,renderIntent:"temporary",rotationHandleSymbolizer:null,box:null,center:null,scale:1,ratio:1,rotation:0,handles:null,rotationHandles:null,dragControl:null,irregular:!1,initialize:function(e,t){OpenLayers.Control.prototype.initialize.apply(this,[t]),this.layer=e,this.rotationHandleSymbolizer||(this.rotationHandleSymbolizer={stroke:!1,pointRadius:10,fillOpacity:0,cursor:"pointer"}),this.createBox(),this.createControl()},activate:function(){var e=!1;return OpenLayers.Control.prototype.activate.apply(this,arguments)&&(this.dragControl.activate(),this.layer.addFeatures([this.box]),this.rotate&&this.layer.addFeatures(this.rotationHandles),this.layer.addFeatures(this.handles),e=!0),e},deactivate:function(){var e=!1;return OpenLayers.Control.prototype.deactivate.apply(this,arguments)&&(this.layer.removeFeatures(this.handles),this.rotate&&this.layer.removeFeatures(this.rotationHandles),this.layer.removeFeatures([this.box]),this.dragControl.deactivate(),e=!0),e},setMap:function(e){this.dragControl.setMap(e),OpenLayers.Control.prototype.setMap.apply(this,arguments)},setFeature:function(e,t){t=OpenLayers.Util.applyDefaults(t,{rotation:0,scale:1,ratio:1});var i=this.rotation,s=this.center;OpenLayers.Util.extend(this,t);var n=this.events.triggerEvent("beforesetfeature",{feature:e});if(n!==!1){this.feature=e,this.activate(),this._setfeature=!0;var r=this.feature.geometry.getBounds();this.box.move(r.getCenterLonLat()),this.box.geometry.rotate(-i,s),this._angle=0;var a;if(this.rotation){var o=e.geometry.clone();o.rotate(-this.rotation,this.center);var l=new OpenLayers.Feature.Vector(o.getBounds().toGeometry());l.geometry.rotate(this.rotation,this.center),this.box.geometry.rotate(this.rotation,this.center),this.box.move(l.geometry.getBounds().getCenterLonLat());var h=l.geometry.components[0].components[0];a=h.getBounds().getCenterLonLat()}else a=new OpenLayers.LonLat(r.left,r.bottom);this.handles[0].move(a),delete this._setfeature,this.events.triggerEvent("setfeature",{feature:e})}},unsetFeature:function(){this.active?this.deactivate():(this.feature=null,this.rotation=0,this.scale=1,this.ratio=1)},createBox:function(){var e=this;this.center=new OpenLayers.Geometry.Point(0,0),this.box=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([new OpenLayers.Geometry.Point(-1,-1),new OpenLayers.Geometry.Point(0,-1),new OpenLayers.Geometry.Point(1,-1),new OpenLayers.Geometry.Point(1,0),new OpenLayers.Geometry.Point(1,1),new OpenLayers.Geometry.Point(0,1),new OpenLayers.Geometry.Point(-1,1),new OpenLayers.Geometry.Point(-1,0),new OpenLayers.Geometry.Point(-1,-1)]),null,"string"==typeof this.renderIntent?null:this.renderIntent),this.box.geometry.move=function(t,i){e._moving=!0,OpenLayers.Geometry.LineString.prototype.move.apply(this,arguments),e.center.move(t,i),delete e._moving};for(var t,i,s,n=function(e,t){OpenLayers.Geometry.Point.prototype.move.apply(this,arguments),this._rotationHandle&&this._rotationHandle.geometry.move(e,t),this._handle.geometry.move(e,t)},r=function(e,t,i){OpenLayers.Geometry.Point.prototype.resize.apply(this,arguments),this._rotationHandle&&this._rotationHandle.geometry.resize(e,t,i),this._handle.geometry.resize(e,t,i)},a=function(e,t){OpenLayers.Geometry.Point.prototype.rotate.apply(this,arguments),this._rotationHandle&&this._rotationHandle.geometry.rotate(e,t),this._handle.geometry.rotate(e,t)},o=function(t,i){var s=this.x,n=this.y;if(OpenLayers.Geometry.Point.prototype.move.call(this,t,i),!e._moving){var r=e.dragControl.handlers.drag.evt,a=!e._setfeature&&e.preserveAspectRatio,o=!(a||r&&r.shiftKey),l=new OpenLayers.Geometry.Point(s,n),h=e.center;this.rotate(-e.rotation,h),l.rotate(-e.rotation,h);var u=this.x-h.x,c=this.y-h.y,d=u-(this.x-l.x),p=c-(this.y-l.y);e.irregular&&!e._setfeature&&(u-=(this.x-l.x)/2,c-=(this.y-l.y)/2),this.x=s,this.y=n;var f,m=1;if(o)f=Math.abs(p)<1e-5?1:c/p,m=(Math.abs(d)<1e-5?1:u/d)/f;else{var y=Math.sqrt(d*d+p*p),g=Math.sqrt(u*u+c*c);f=g/y}if(e._moving=!0,e.box.geometry.rotate(-e.rotation,h),delete e._moving,e.box.geometry.resize(f,h,m),e.box.geometry.rotate(e.rotation,h),e.transformFeature({scale:f,ratio:m}),e.irregular&&!e._setfeature){var v=h.clone();v.x+=Math.abs(s-h.x)<1e-5?0:this.x-s,v.y+=Math.abs(n-h.y)<1e-5?0:this.y-n,e.box.geometry.move(this.x-s,this.y-n),e.transformFeature({center:v})}}},l=function(t,i){var s=this.x,n=this.y;if(OpenLayers.Geometry.Point.prototype.move.call(this,t,i),!e._moving){var r=e.dragControl.handlers.drag.evt,a=r&&r.shiftKey?45:1,o=e.center,l=this.x-o.x,h=this.y-o.y,u=l-t,c=h-i;this.x=s,this.y=n;var d=Math.atan2(c,u),p=Math.atan2(h,l),f=p-d;f*=180/Math.PI,e._angle=(e._angle+f)%360;var m=e.rotation%a;(Math.abs(e._angle)>=a||0!==m)&&(f=Math.round(e._angle/a)*a-m,e._angle=0,e.box.geometry.rotate(f,o),e.transformFeature({rotation:f}))}},h=new Array(8),u=new Array(4),c=["sw","s","se","e","ne","n","nw","w"],d=0;8>d;++d)t=this.box.geometry.components[d],i=new OpenLayers.Feature.Vector(t.clone(),{role:c[d]+"-resize"},"string"==typeof this.renderIntent?null:this.renderIntent),0==d%2&&(s=new OpenLayers.Feature.Vector(t.clone(),{role:c[d]+"-rotate"},"string"==typeof this.rotationHandleSymbolizer?null:this.rotationHandleSymbolizer),s.geometry.move=l,t._rotationHandle=s,u[d/2]=s),t.move=n,t.resize=r,t.rotate=a,i.geometry.move=o,t._handle=i,h[d]=i;this.rotationHandles=u,this.handles=h},createControl:function(){var e=this;this.dragControl=new OpenLayers.Control.DragFeature(this.layer,{documentDrag:!0,moveFeature:function(){this.feature===e.feature&&(this.feature=e.box),OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},onDrag:function(t){t===e.box&&e.transformFeature({center:e.center})},onStart:function(t){var i=!e.geometryTypes||-1!==OpenLayers.Util.indexOf(e.geometryTypes,t.geometry.CLASS_NAME),s=OpenLayers.Util.indexOf(e.handles,t);s+=OpenLayers.Util.indexOf(e.rotationHandles,t),t!==e.feature&&t!==e.box&&-2==s&&i&&e.setFeature(t)},onComplete:function(){e.events.triggerEvent("transformcomplete",{feature:e.feature})}})},drawHandles:function(){for(var e=this.layer,t=0;8>t;++t)this.rotate&&0===t%2&&e.drawFeature(this.rotationHandles[t/2],this.rotationHandleSymbolizer),e.drawFeature(this.handles[t],this.renderIntent)},transformFeature:function(e){if(!this._setfeature){this.scale*=e.scale||1,this.ratio*=e.ratio||1;var t=this.rotation;if(this.rotation=(this.rotation+(e.rotation||0))%360,this.events.triggerEvent("beforetransform",e)!==!1){var i=this.feature,s=i.geometry,n=this.center;s.rotate(-t,n),e.scale||e.ratio?s.resize(e.scale,n,e.ratio):e.center&&i.move(e.center.getBounds().getCenterLonLat()),s.rotate(this.rotation,n),this.layer.drawFeature(i),i.toState(OpenLayers.State.UPDATE),this.events.triggerEvent("transform",e)}}this.layer.drawFeature(this.box,this.renderIntent),this.drawHandles()},destroy:function(){for(var e,t=0;8>t;++t)e=this.box.geometry.components[t],e._handle.destroy(),e._handle=null,e._rotationHandle&&e._rotationHandle.destroy(),e._rotationHandle=null;this.center=null,this.feature=null,this.handles=null,this.rotationHandleSymbolizer=null,this.rotationHandles=null,this.box.destroy(),this.box=null,this.layer=null,this.dragControl.destroy(),this.dragControl=null,OpenLayers.Control.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.TransformFeature"}),OpenLayers.Layer.ArcGISCache=OpenLayers.Class(OpenLayers.Layer.XYZ,{url:null,tileOrigin:null,tileSize:new OpenLayers.Size(256,256),useArcGISServer:!0,type:"png",useScales:!1,overrideDPI:!1,initialize:function(){if(OpenLayers.Layer.XYZ.prototype.initialize.apply(this,arguments),this.resolutions&&(this.serverResolutions=this.resolutions,this.maxExtent=this.getMaxExtentForResolution(this.resolutions[0])),this.layerInfo){var e=this.layerInfo,t=new OpenLayers.Bounds(e.fullExtent.xmin,e.fullExtent.ymin,e.fullExtent.xmax,e.fullExtent.ymax);if(this.projection="EPSG:"+e.spatialReference.wkid,this.sphericalMercator=102100==e.spatialReference.wkid,this.units="esriFeet"==e.units?"ft":"m",e.tileInfo){this.tileSize=new OpenLayers.Size(e.tileInfo.width||e.tileInfo.cols,e.tileInfo.height||e.tileInfo.rows),this.tileOrigin=new OpenLayers.LonLat(e.tileInfo.origin.x,e.tileInfo.origin.y);var i=new OpenLayers.Geometry.Point(t.left,t.top),s=new OpenLayers.Geometry.Point(t.right,t.bottom);this.useScales?this.scales=[]:this.resolutions=[],this.lods=[];for(var n in e.tileInfo.lods)if(e.tileInfo.lods.hasOwnProperty(n)){var r=e.tileInfo.lods[n];this.useScales?this.scales.push(r.scale):this.resolutions.push(r.resolution);var a=this.getContainingTileCoords(i,r.resolution);r.startTileCol=a.x,r.startTileRow=a.y;var o=this.getContainingTileCoords(s,r.resolution);r.endTileCol=o.x,r.endTileRow=o.y,this.lods.push(r)}this.maxExtent=this.calculateMaxExtentWithLOD(this.lods[0]),this.serverResolutions=this.resolutions,this.overrideDPI&&e.tileInfo.dpi&&(OpenLayers.DOTS_PER_INCH=e.tileInfo.dpi)}}},getContainingTileCoords:function(e,t){return new OpenLayers.Pixel(Math.max(Math.floor((e.x-this.tileOrigin.lon)/(this.tileSize.w*t)),0),Math.max(Math.floor((this.tileOrigin.lat-e.y)/(this.tileSize.h*t)),0))},calculateMaxExtentWithLOD:function(e){var t=e.endTileCol-e.startTileCol+1,i=e.endTileRow-e.startTileRow+1,s=this.tileOrigin.lon+e.startTileCol*this.tileSize.w*e.resolution,n=s+t*this.tileSize.w*e.resolution,r=this.tileOrigin.lat-e.startTileRow*this.tileSize.h*e.resolution,a=r-i*this.tileSize.h*e.resolution;return new OpenLayers.Bounds(s,a,n,r)},calculateMaxExtentWithExtent:function(e,t){var i=new OpenLayers.Geometry.Point(e.left,e.top),s=new OpenLayers.Geometry.Point(e.right,e.bottom),n=this.getContainingTileCoords(i,t),r=this.getContainingTileCoords(s,t),a={resolution:t,startTileCol:n.x,startTileRow:n.y,endTileCol:r.x,endTileRow:r.y};return this.calculateMaxExtentWithLOD(a)},getUpperLeftTileCoord:function(e){var t=new OpenLayers.Geometry.Point(this.maxExtent.left,this.maxExtent.top);return this.getContainingTileCoords(t,e)},getLowerRightTileCoord:function(e){var t=new OpenLayers.Geometry.Point(this.maxExtent.right,this.maxExtent.bottom);return this.getContainingTileCoords(t,e)},getMaxExtentForResolution:function(e){var t=this.getUpperLeftTileCoord(e),i=this.getLowerRightTileCoord(e),s=i.x-t.x+1,n=i.y-t.y+1,r=this.tileOrigin.lon+t.x*this.tileSize.w*e,a=r+s*this.tileSize.w*e,o=this.tileOrigin.lat-t.y*this.tileSize.h*e,l=o-n*this.tileSize.h*e;return new OpenLayers.Bounds(r,l,a,o)},clone:function(e){return null==e&&(e=new OpenLayers.Layer.ArcGISCache(this.name,this.url,this.options)),OpenLayers.Layer.XYZ.prototype.clone.apply(this,[e])},getMaxExtent:function(){var e=this.map.getResolution();return this.maxExtent=this.getMaxExtentForResolution(e)},getTileOrigin:function(){var e=this.getMaxExtent();return new OpenLayers.LonLat(e.left,e.bottom)},getURL:function(e){var t=this.getResolution(),i=this.tileOrigin.lon+t*this.tileSize.w/2,s=this.tileOrigin.lat-t*this.tileSize.h/2,n=e.getCenterLonLat();({x:n.lon,y:n.lat});var r=Math.round(Math.abs((n.lon-i)/(t*this.tileSize.w))),a=Math.round(Math.abs((s-n.lat)/(t*this.tileSize.h))),o=this.map.getZoom();if(this.lods){var l=this.lods[this.map.getZoom()];if(r<l.startTileCol||r>l.endTileCol||a<l.startTileRow||a>l.endTileRow)return null}else{var h=this.getUpperLeftTileCoord(t),u=this.getLowerRightTileCoord(t);if(r<h.x||r>=u.x||a<h.y||a>=u.y)return null}var c=this.url,d=""+r+a+o;return OpenLayers.Util.isArray(c)&&(c=this.selectUrl(d,c)),this.useArcGISServer?c+="/tile/${z}/${y}/${x}":(r="C"+this.zeroPad(r,8,16),a="R"+this.zeroPad(a,8,16),o="L"+this.zeroPad(o,2,16),c=c+"/${z}/${y}/${x}."+this.type),c=OpenLayers.String.format(c,{x:r,y:a,z:o}),OpenLayers.Util.urlAppend(c,OpenLayers.Util.getParameterString(this.params))},zeroPad:function(e,t,i){for(var s=e.toString(i||10);s.length<t;)s="0"+s;return s},CLASS_NAME:"OpenLayers.Layer.ArcGISCache"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Control,{hover:!1,drillDown:!1,maxFeatures:10,clickCallback:"click",output:"features",layers:null,queryVisible:!1,url:null,layerUrls:null,infoFormat:"text/html",vendorParams:{},format:null,formatOptions:null,handlerOptions:null,handler:null,hoverRequest:null,initialize:function(e){if(e=e||{},e.handlerOptions=e.handlerOptions||{},OpenLayers.Control.prototype.initialize.apply(this,[e]),this.format||(this.format=new OpenLayers.Format.WMSGetFeatureInfo(e.formatOptions)),this.drillDown===!0&&(this.hover=!1),this.hover)this.handler=new OpenLayers.Handler.Hover(this,{move:this.cancelHover,pause:this.getInfoForHover},OpenLayers.Util.extend(this.handlerOptions.hover||{},{delay:250}));else{var t={};t[this.clickCallback]=this.getInfoForClick,this.handler=new OpenLayers.Handler.Click(this,t,this.handlerOptions.click||{})}},getInfoForClick:function(e){this.events.triggerEvent("beforegetfeatureinfo",{xy:e.xy}),OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait"),this.request(e.xy,{})},getInfoForHover:function(e){this.events.triggerEvent("beforegetfeatureinfo",{xy:e.xy}),this.request(e.xy,{hover:!0})},cancelHover:function(){this.hoverRequest&&(this.hoverRequest.abort(),this.hoverRequest=null)},findLayers:function(){for(var e,t,i=this.layers||this.map.layers,s=[],n=i.length-1;n>=0;--n)e=i[n],e instanceof OpenLayers.Layer.WMS&&(!this.queryVisible||e.getVisibility())&&(t=OpenLayers.Util.isArray(e.url)?e.url[0]:e.url,this.drillDown!==!1||this.url||(this.url=t),(this.drillDown===!0||this.urlMatches(t))&&s.push(e));return s},urlMatches:function(e){var t=OpenLayers.Util.isEquivalentUrl(this.url,e);if(!t&&this.layerUrls)for(var i=0,s=this.layerUrls.length;s>i;++i)if(OpenLayers.Util.isEquivalentUrl(this.layerUrls[i],e)){t=!0;break}return t},buildWMSOptions:function(e,t,i,s){for(var n=[],r=[],a=0,o=t.length;o>a;a++)null!=t[a].params.LAYERS&&(n=n.concat(t[a].params.LAYERS),r=r.concat(this.getStyleNames(t[a])));var l=t[0],h=this.map.getProjection(),u=l.projection;u&&u.equals(this.map.getProjectionObject())&&(h=u.getCode());var c=OpenLayers.Util.extend({service:"WMS",version:l.params.VERSION,request:"GetFeatureInfo",exceptions:l.params.EXCEPTIONS,bbox:this.map.getExtent().toBBOX(null,l.reverseAxisOrder()),feature_count:this.maxFeatures,height:this.map.getSize().h,width:this.map.getSize().w,format:s,info_format:l.params.INFO_FORMAT||this.infoFormat},parseFloat(l.params.VERSION)>=1.3?{crs:h,i:parseInt(i.x),j:parseInt(i.y)}:{srs:h,x:parseInt(i.x),y:parseInt(i.y)});return 0!=n.length&&(c=OpenLayers.Util.extend({layers:n,query_layers:n,styles:r},c)),OpenLayers.Util.applyDefaults(c,this.vendorParams),{url:e,params:OpenLayers.Util.upperCaseObject(c),callback:function(t){this.handleResponse(i,t,e)},scope:this}},getStyleNames:function(e){var t;return t=e.params.STYLES?e.params.STYLES:OpenLayers.Util.isArray(e.params.LAYERS)?new Array(e.params.LAYERS.length):e.params.LAYERS.replace(/[^,]/g,"")},request:function(e,t){var i=this.findLayers();if(0==i.length)return this.events.triggerEvent("nogetfeatureinfo"),OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait"),void 0;if(t=t||{},this.drillDown===!1){var s=this.buildWMSOptions(this.url,i,e,i[0].params.FORMAT),n=OpenLayers.Request.GET(s);t.hover===!0&&(this.hoverRequest=n)}else{this._requestCount=0,this._numRequests=0,this.features=[];for(var r,a={},o=0,l=i.length;l>o;o++){var h=i[o];r=OpenLayers.Util.isArray(h.url)?h.url[0]:h.url,r in a?a[r].push(h):(this._numRequests++,a[r]=[h])}var i;for(var r in a){i=a[r];var s=this.buildWMSOptions(r,i,e,i[0].params.FORMAT);OpenLayers.Request.GET(s)}}},triggerGetFeatureInfo:function(e,t,i){this.events.triggerEvent("getfeatureinfo",{text:e.responseText,features:i,request:e,xy:t}),OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait")},handleResponse:function(e,t,i){var s=t.responseXML;s&&s.documentElement||(s=t.responseText);var n=this.format.read(s);this.drillDown===!1?this.triggerGetFeatureInfo(t,e,n):(this._requestCount++,this._features="object"===this.output?(this._features||[]).concat({url:i,features:n}):(this._features||[]).concat(n),this._requestCount===this._numRequests&&(this.triggerGetFeatureInfo(t,e,this._features.concat()),delete this._features,delete this._requestCount,delete this._numRequests))},CLASS_NAME:"OpenLayers.Control.WMSGetFeatureInfo"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WMSCapabilities.v1_3_0=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_3,{version:"1.3.0",CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_3_0"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.UTFGrid=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,layers:null,defaultHandlerOptions:{delay:300,pixelTolerance:4,stopMove:!1,single:!0,"double":!1,stopSingle:!1,stopDouble:!1},handlerMode:"click",setHandler:function(e){this.handlerMode=e,this.resetHandler()},resetHandler:function(){return this.handler&&(this.handler.deactivate(),this.handler.destroy(),this.handler=null),"hover"==this.handlerMode?this.handler=new OpenLayers.Handler.Hover(this,{pause:this.handleEvent,move:this.reset},this.handlerOptions):"click"==this.handlerMode?this.handler=new OpenLayers.Handler.Click(this,{click:this.handleEvent},this.handlerOptions):"move"==this.handlerMode&&(this.handler=new OpenLayers.Handler.Hover(this,{pause:this.handleEvent,move:this.handleEvent},this.handlerOptions)),this.handler?!0:!1},initialize:function(e){e=e||{},e.handlerOptions=e.handlerOptions||this.defaultHandlerOptions,OpenLayers.Control.prototype.initialize.apply(this,[e]),this.resetHandler()},handleEvent:function(e){if(null==e)return this.reset(),void 0;var t=this.map.getLonLatFromPixel(e.xy);if(t){var i=this.findLayers();if(i.length>0){for(var s,n,r={},a=0,o=i.length;o>a;a++)s=i[a],n=OpenLayers.Util.indexOf(this.map.layers,s),r[n]=s.getFeatureInfo(t);this.callback(r,t,e.xy)}}},callback:function(){},reset:function(){this.callback(null)},findLayers:function(){for(var e,t=this.layers||this.map.layers,i=[],s=t.length-1;s>=0;--s)e=t[s],e instanceof OpenLayers.Layer.UTFGrid&&i.push(e);return i},CLASS_NAME:"OpenLayers.Control.UTFGrid"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.CQL=function(){function e(e,t){return t instanceof RegExp?t.exec(e):t(e)}function t(t,i){var s,n,a=i.length;for(s=0;a>s;s++){n=i[s];var o=r[n],l=e(t,o);if(l){var h=l[0],u=t.substr(h.length).replace(/^\s*/,"");return{type:n,text:h,remainder:u}}}var c="ERROR: In parsing: ["+t+"], expected one of: ";for(s=0;a>s;s++)n=i[s],c+="\n    "+n+": "+r[n];throw new Error(c)}function i(e){var i,s=[],n=["NOT","GEOMETRY","SPATIAL","PROPERTY","LPAREN"];do{if(i=t(e,n),e=i.remainder,n=a[i.type],"END"!=i.type&&!n)throw new Error("No follows list for "+i.type);s.push(i)}while("END"!=i.type);return s}function s(e){function t(){var e=s.pop();switch(e.type){case"LOGICAL":var i=t(),n=t();return new OpenLayers.Filter.Logical({filters:[n,i],type:h[e.text.toUpperCase()]});case"NOT":var r=t();return new OpenLayers.Filter.Logical({filters:[r],type:OpenLayers.Filter.Logical.NOT});case"BETWEEN":var a,l,u;return s.pop(),l=t(),a=t(),u=t(),new OpenLayers.Filter.Comparison({property:u,lowerBoundary:a,upperBoundary:l,type:OpenLayers.Filter.Comparison.BETWEEN});case"COMPARISON":var c=t(),u=t();return new OpenLayers.Filter.Comparison({property:u,value:c,type:o[e.text.toUpperCase()]});case"VALUE":return/^'.*'$/.test(e.text)?e.text.substr(1,e.text.length-2):Number(e.text);case"SPATIAL":switch(e.text.toUpperCase()){case"BBOX":var d=t(),p=t(),f=t(),m=t(),y=t();return new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,property:y,value:OpenLayers.Bounds.fromArray([m,f,p,d])});case"INTERSECTS":var c=t(),u=t();return new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:u,value:c});case"WITHIN":var c=t(),u=t();return new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.WITHIN,property:u,value:c});case"CONTAINS":var c=t(),u=t();return new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.CONTAINS,property:u,value:c});case"DWITHIN":var g=t(),c=t(),u=t();return new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.DWITHIN,value:c,property:u,distance:Number(g)})}case"GEOMETRY":return OpenLayers.Geometry.fromWKT(e.text);default:return e.text}}for(var i=[],s=[];e.length;){var n=e.shift();switch(n.type){case"PROPERTY":case"GEOMETRY":case"VALUE":s.push(n);break;case"COMPARISON":case"BETWEEN":case"LOGICAL":for(var r=c[n.type];i.length>0&&c[i[i.length-1].type]<=r;)s.push(i.pop());i.push(n);break;case"SPATIAL":case"NOT":case"LPAREN":i.push(n);break;case"RPAREN":for(;i.length>0&&"LPAREN"!=i[i.length-1].type;)s.push(i.pop());i.pop(),i.length>0&&"SPATIAL"==i[i.length-1].type&&s.push(i.pop());case"COMMA":case"END":break;default:throw new Error("Unknown token type "+n.type)}}for(;i.length>0;)s.push(i.pop());var a=t();if(s.length>0){for(var l="Remaining tokens after building AST: \n",u=s.length-1;u>=0;u--)l+=s[u].type+": "+s[u].text+"\n";throw new Error(l)}return a}var n,r={PROPERTY:/^[_a-zA-Z]\w*/,COMPARISON:/^(=|<>|<=|<|>=|>|LIKE)/i,COMMA:/^,/,LOGICAL:/^(AND|OR)/i,VALUE:/^('\w+'|\d+(\.\d*)?|\.\d+)/,LPAREN:/^\(/,RPAREN:/^\)/,SPATIAL:/^(BBOX|INTERSECTS|DWITHIN|WITHIN|CONTAINS)/i,NOT:/^NOT/i,BETWEEN:/^BETWEEN/i,GEOMETRY:function(e){var t=/^(POINT|LINESTRING|POLYGON|MULTIPOINT|MULTILINESTRING|MULTIPOLYGON|GEOMETRYCOLLECTION)/.exec(e);if(t){var i=e.length,s=e.indexOf("(",t[0].length);if(s>-1)for(var n=1;i>s&&n>0;)switch(s++,e.charAt(s)){case"(":n++;break;case")":n--}return[e.substr(0,s+1)]}},END:/^$/},a={LPAREN:["GEOMETRY","SPATIAL","PROPERTY","VALUE","LPAREN"],RPAREN:["NOT","LOGICAL","END","RPAREN"],PROPERTY:["COMPARISON","BETWEEN","COMMA"],BETWEEN:["VALUE"],COMPARISON:["VALUE"],COMMA:["GEOMETRY","VALUE","PROPERTY"],VALUE:["LOGICAL","COMMA","RPAREN","END"],SPATIAL:["LPAREN"],LOGICAL:["NOT","VALUE","SPATIAL","PROPERTY","LPAREN"],NOT:["PROPERTY","LPAREN"],GEOMETRY:["COMMA","RPAREN"]},o={"=":OpenLayers.Filter.Comparison.EQUAL_TO,"<>":OpenLayers.Filter.Comparison.NOT_EQUAL_TO,"<":OpenLayers.Filter.Comparison.LESS_THAN,"<=":OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO,">":OpenLayers.Filter.Comparison.GREATER_THAN,">=":OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO,LIKE:OpenLayers.Filter.Comparison.LIKE,BETWEEN:OpenLayers.Filter.Comparison.BETWEEN},l={},h={AND:OpenLayers.Filter.Logical.AND,OR:OpenLayers.Filter.Logical.OR},u={},c={RPAREN:3,LOGICAL:2,COMPARISON:1};for(n in o)o.hasOwnProperty(n)&&(l[o[n]]=n);for(n in h)h.hasOwnProperty(n)&&(u[h[n]]=n);return OpenLayers.Class(OpenLayers.Format,{read:function(e){var t=s(i(e));return this.keepData&&(this.data=t),t},write:function(e){if(e instanceof OpenLayers.Geometry)return e.toString();switch(e.CLASS_NAME){case"OpenLayers.Filter.Spatial":switch(e.type){case OpenLayers.Filter.Spatial.BBOX:return"BBOX("+e.property+","+e.value.toBBOX()+")";case OpenLayers.Filter.Spatial.DWITHIN:return"DWITHIN("+e.property+", "+this.write(e.value)+", "+e.distance+")";case OpenLayers.Filter.Spatial.WITHIN:return"WITHIN("+e.property+", "+this.write(e.value)+")";case OpenLayers.Filter.Spatial.INTERSECTS:return"INTERSECTS("+e.property+", "+this.write(e.value)+")";case OpenLayers.Filter.Spatial.CONTAINS:return"CONTAINS("+e.property+", "+this.write(e.value)+")";default:throw new Error("Unknown spatial filter type: "+e.type)}case"OpenLayers.Filter.Logical":if(e.type==OpenLayers.Filter.Logical.NOT)return"NOT ("+this.write(e.filters[0])+")";for(var t="(",i=!0,s=0;s<e.filters.length;s++)i?i=!1:t+=") "+u[e.type]+" (",t+=this.write(e.filters[s]);return t+")";case"OpenLayers.Filter.Comparison":return e.type==OpenLayers.Filter.Comparison.BETWEEN?e.property+" BETWEEN "+this.write(e.lowerBoundary)+" AND "+this.write(e.upperBoundary):e.property+" "+l[e.type]+" "+this.write(e.value);case void 0:if("string"==typeof e)return"'"+e+"'";if("number"==typeof e)return String(e);default:throw new Error("Can't encode: "+e.CLASS_NAME+" "+e)}},CLASS_NAME:"OpenLayers.Format.CQL"})}(),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.Split=OpenLayers.Class(OpenLayers.Control,{layer:null,source:null,sourceOptions:null,tolerance:null,edge:!0,deferDelete:!1,mutual:!0,targetFilter:null,sourceFilter:null,handler:null,initialize:function(e){OpenLayers.Control.prototype.initialize.apply(this,[e]),this.options=e||{},this.options.source&&this.setSource(this.options.source)},setSource:function(e){this.active?(this.deactivate(),this.handler&&(this.handler.destroy(),delete this.handler),this.source=e,this.activate()):this.source=e},activate:function(){var e=OpenLayers.Control.prototype.activate.call(this);return e&&(this.source?this.source.events&&this.source.events.on({sketchcomplete:this.onSketchComplete,afterfeaturemodified:this.afterFeatureModified,scope:this}):(this.handler||(this.handler=new OpenLayers.Handler.Path(this,{done:function(e){this.onSketchComplete({feature:new OpenLayers.Feature.Vector(e)})}},{layerOptions:this.sourceOptions})),this.handler.activate())),e},deactivate:function(){var e=OpenLayers.Control.prototype.deactivate.call(this);return e&&this.source&&this.source.events&&this.layer.events.un({sketchcomplete:this.onSketchComplete,afterfeaturemodified:this.afterFeatureModified,scope:this}),e},onSketchComplete:function(e){return this.feature=null,!this.considerSplit(e.feature)},afterFeatureModified:function(e){if(e.modified){var t=e.feature;"function"==typeof t.geometry.split&&(this.feature=e.feature,this.considerSplit(e.feature))}},removeByGeometry:function(e,t){for(var i=0,s=e.length;s>i;++i)if(e[i].geometry===t){e.splice(i,1);break}},isEligible:function(e){return e.geometry?e.state!==OpenLayers.State.DELETE&&"function"==typeof e.geometry.split&&this.feature!==e&&(!this.targetFilter||this.targetFilter.evaluate(e.attributes)):!1},considerSplit:function(e){var t=!1,i=!1;if(!this.sourceFilter||this.sourceFilter.evaluate(e.attributes)){for(var s,n,r,a,o,l,h,u=this.layer&&this.layer.features||[],c=[],d=[],p=this.layer===this.source&&this.mutual,f={edge:this.edge,tolerance:this.tolerance,mutual:p},m=[e.geometry],y=0,g=u.length;g>y;++y)if(a=u[y],this.isEligible(a)){o=[a.geometry];for(var v=0;v<m.length;++v){l=m[v];for(var x=0;x<o.length;++x)s=o[x],l.getBounds().intersectsBounds(s.getBounds())&&(n=l.split(s,f),n&&(r=this.events.triggerEvent("beforesplit",{source:e,target:a}),r!==!1&&(p&&(h=n[0],h.length>1&&(h.unshift(v,1),Array.prototype.splice.apply(m,h),v+=h.length-3),n=n[1]),n.length>1&&(n.unshift(x,1),Array.prototype.splice.apply(o,n),x+=n.length-3))))}o&&o.length>1&&(this.geomsToFeatures(a,o),this.events.triggerEvent("split",{original:a,features:o}),Array.prototype.push.apply(c,o),d.push(a),i=!0)}if(m&&m.length>1&&(this.geomsToFeatures(e,m),this.events.triggerEvent("split",{original:e,features:m}),Array.prototype.push.apply(c,m),d.push(e),t=!0),t||i){if(this.deferDelete){for(var E,b=[],y=0,g=d.length;g>y;++y)E=d[y],E.state===OpenLayers.State.INSERT?b.push(E):(E.state=OpenLayers.State.DELETE,this.layer.drawFeature(E));this.layer.destroyFeatures(b,{silent:!0});for(var y=0,g=c.length;g>y;++y)c[y].state=OpenLayers.State.INSERT}else this.layer.destroyFeatures(d,{silent:!0});this.layer.addFeatures(c,{silent:!0}),this.events.triggerEvent("aftersplit",{source:e,features:c})}}return t},geomsToFeatures:function(e,t){var i=e.clone();delete i.geometry;for(var s,n=0,r=t.length;r>n;++n)s=i.clone(),s.geometry=t[n],s.state=OpenLayers.State.INSERT,t[n]=s},destroy:function(){this.active&&this.deactivate(),OpenLayers.Control.prototype.destroy.call(this)},CLASS_NAME:"OpenLayers.Control.Split"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.WMTS=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,version:"1.0.0",requestEncoding:"KVP",url:null,layer:null,matrixSet:null,style:null,format:"image/jpeg",tileOrigin:null,tileFullExtent:null,formatSuffix:null,matrixIds:null,dimensions:null,params:null,zoomOffset:0,serverResolutions:null,formatSuffixMap:{"image/png":"png","image/png8":"png","image/png24":"png","image/png32":"png",png:"png","image/jpeg":"jpg","image/jpg":"jpg",jpeg:"jpg",jpg:"jpg"},matrix:null,initialize:function(e){var t={url:!0,layer:!0,style:!0,matrixSet:!0};for(var i in t)if(!(i in e))throw new Error("Missing property '"+i+"' in layer configuration.");e.params=OpenLayers.Util.upperCaseObject(e.params);var s=[e.name,e.url,e.params,e];if(OpenLayers.Layer.Grid.prototype.initialize.apply(this,s),this.formatSuffix||(this.formatSuffix=this.formatSuffixMap[this.format]||this.format.split("/").pop()),this.matrixIds){var n=this.matrixIds.length;if(n&&"string"==typeof this.matrixIds[0]){var r=this.matrixIds;this.matrixIds=new Array(n);for(var a=0;n>a;++a)this.matrixIds[a]={identifier:r[a]}}}},setMap:function(){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments),this.updateMatrixProperties()},updateMatrixProperties:function(){this.matrix=this.getMatrix(),this.matrix&&(this.matrix.topLeftCorner&&(this.tileOrigin=this.matrix.topLeftCorner),this.matrix.tileWidth&&this.matrix.tileHeight&&(this.tileSize=new OpenLayers.Size(this.matrix.tileWidth,this.matrix.tileHeight)),this.tileOrigin||(this.tileOrigin=new OpenLayers.LonLat(this.maxExtent.left,this.maxExtent.top)),this.tileFullExtent||(this.tileFullExtent=this.maxExtent))},moveTo:function(e,t){return(t||!this.matrix)&&this.updateMatrixProperties(),OpenLayers.Layer.Grid.prototype.moveTo.apply(this,arguments)},clone:function(e){return null==e&&(e=new OpenLayers.Layer.WMTS(this.options)),e=OpenLayers.Layer.Grid.prototype.clone.apply(this,[e])},getIdentifier:function(){return this.getServerZoom()},getMatrix:function(){var e;if(this.matrixIds&&0!==this.matrixIds.length)if("scaleDenominator"in this.matrixIds[0])for(var t,i=OpenLayers.METERS_PER_INCH*OpenLayers.INCHES_PER_UNIT[this.units]*this.getServerResolution()/28e-5,s=Number.POSITIVE_INFINITY,n=0,r=this.matrixIds.length;r>n;++n)t=Math.abs(1-this.matrixIds[n].scaleDenominator/i),s>t&&(s=t,e=this.matrixIds[n]);else e=this.matrixIds[this.getIdentifier()];else e={identifier:this.getIdentifier()};return e},getTileInfo:function(e){var t=this.getServerResolution(),i=(e.lon-this.tileOrigin.lon)/(t*this.tileSize.w),s=(this.tileOrigin.lat-e.lat)/(t*this.tileSize.h),n=Math.floor(i),r=Math.floor(s);return{col:n,row:r,i:Math.floor((i-n)*this.tileSize.w),j:Math.floor((s-r)*this.tileSize.h)}},getURL:function(e){e=this.adjustBounds(e);var t="";if(!this.tileFullExtent||this.tileFullExtent.intersectsBounds(e)){var i=e.getCenterLonLat(),s=this.getTileInfo(i);this.matrix.identifier;var n,r=this.dimensions;if("REST"===this.requestEncoding.toUpperCase())if(n=this.params,"string"==typeof this.url&&-1!==this.url.indexOf("{")){var a=this.url.replace(/\{/g,"${"),o={style:this.style,Style:this.style,TileMatrixSet:this.matrixSet,TileMatrix:this.matrix.identifier,TileRow:s.row,TileCol:s.col};if(r){var l,h;for(h=r.length-1;h>=0;--h)l=r[h],o[l]=n[l.toUpperCase()]}t=OpenLayers.String.format(a,o)}else{var u=this.version+"/"+this.layer+"/"+this.style+"/";if(r)for(var h=0;h<r.length;h++)n[r[h]]&&(u=u+n[r[h]]+"/");u=u+this.matrixSet+"/"+this.matrix.identifier+"/"+s.row+"/"+s.col+"."+this.formatSuffix,t=OpenLayers.Util.isArray(this.url)?this.selectUrl(u,this.url):this.url,t.match(/\/$/)||(t+="/"),t+=u}else"KVP"===this.requestEncoding.toUpperCase()&&(n={SERVICE:"WMTS",REQUEST:"GetTile",VERSION:this.version,LAYER:this.layer,STYLE:this.style,TILEMATRIXSET:this.matrixSet,TILEMATRIX:this.matrix.identifier,TILEROW:s.row,TILECOL:s.col,FORMAT:this.format},t=OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,[n]))}return t},mergeNewParams:function(e){return"KVP"===this.requestEncoding.toUpperCase()?OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,[OpenLayers.Util.upperCaseObject(e)]):void 0},CLASS_NAME:"OpenLayers.Layer.WMTS"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Protocol.SOS.v1_0_0=OpenLayers.Class(OpenLayers.Protocol,{fois:null,formatOptions:null,initialize:function(e){OpenLayers.Protocol.prototype.initialize.apply(this,[e]),e.format||(this.format=new OpenLayers.Format.SOSGetFeatureOfInterest(this.formatOptions))},destroy:function(){this.options&&!this.options.format&&this.format.destroy(),this.format=null,OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(e){e=OpenLayers.Util.extend({},e),OpenLayers.Util.applyDefaults(e,this.options||{});var t=new OpenLayers.Protocol.Response({requestType:"read"}),i=this.format,s=OpenLayers.Format.XML.prototype.write.apply(i,[i.writeNode("sos:GetFeatureOfInterest",{fois:this.fois})]);return t.priv=OpenLayers.Request.POST({url:e.url,callback:this.createCallback(this.handleRead,t,e),data:s}),t},handleRead:function(e,t){if(t.callback){var i=e.priv;i.status>=200&&i.status<300?(e.features=this.parseFeatures(i),e.code=OpenLayers.Protocol.Response.SUCCESS):e.code=OpenLayers.Protocol.Response.FAILURE,t.callback.call(t.scope,e)}},parseFeatures:function(e){var t=e.responseXML;return t&&t.documentElement||(t=e.responseText),!t||t.length<=0?null:this.format.read(t)},CLASS_NAME:"OpenLayers.Protocol.SOS.v1_0_0"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.KaMapCache=OpenLayers.Class(OpenLayers.Layer.KaMap,{IMAGE_EXTENSIONS:{jpeg:"jpg",gif:"gif",png:"png",png8:"png",png24:"png",dithered:"png"},DEFAULT_FORMAT:"jpeg",initialize:function(){OpenLayers.Layer.KaMap.prototype.initialize.apply(this,arguments),this.extension=this.IMAGE_EXTENSIONS[this.params.i.toLowerCase()||this.DEFAULT_FORMAT]},getURL:function(e){e=this.adjustBounds(e);var t=this.map.getResolution(),i=Math.round(1e4*this.map.getScale())/1e4,s=Math.round(e.left/t),n=-Math.round(e.top/t),r=Math.floor(s/this.tileSize.w/this.params.metaTileSize.w)*this.tileSize.w*this.params.metaTileSize.w,a=Math.floor(n/this.tileSize.h/this.params.metaTileSize.h)*this.tileSize.h*this.params.metaTileSize.h,o=["/",this.params.map,"/",i,"/",this.params.g.replace(/\s/g,"_"),"/def/t",a,"/l",r,"/t",n,"l",s,".",this.extension],l=this.url;return OpenLayers.Util.isArray(l)&&(l=this.selectUrl(o.join(""),l)),l+o.join("")},CLASS_NAME:"OpenLayers.Layer.KaMapCache"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Protocol.WFS.v1_1_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,{version:"1.1.0",initialize:function(){OpenLayers.Protocol.WFS.v1.prototype.initialize.apply(this,arguments),this.outputFormat&&!this.readFormat&&("gml2"==this.outputFormat.toLowerCase()?this.readFormat=new OpenLayers.Format.GML.v2({featureType:this.featureType,featureNS:this.featureNS,geometryName:this.geometryName}):"json"==this.outputFormat.toLowerCase()&&(this.readFormat=new OpenLayers.Format.GeoJSON))},CLASS_NAME:"OpenLayers.Protocol.WFS.v1_1_0"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Layer.TileCache=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,format:"image/png",serverResolutions:null,initialize:function(e,t,i,s){this.layername=i,OpenLayers.Layer.Grid.prototype.initialize.apply(this,[e,t,{},s]),this.extension=this.format.split("/")[1].toLowerCase(),this.extension="jpg"==this.extension?"jpeg":this.extension},clone:function(e){return null==e&&(e=new OpenLayers.Layer.TileCache(this.name,this.url,this.layername,this.getOptions())),e=OpenLayers.Layer.Grid.prototype.clone.apply(this,[e])},getURL:function(e){function t(e,t){e=String(e);for(var i=[],s=0;t>s;++s)i.push("0");return i.join("").substring(0,t-e.length)+e}var i=this.getServerResolution(),s=this.maxExtent,n=this.tileSize,r=Math.round((e.left-s.left)/(i*n.w)),a=Math.round((e.bottom-s.bottom)/(i*n.h)),o=null!=this.serverResolutions?OpenLayers.Util.indexOf(this.serverResolutions,i):this.map.getZoom(),l=[this.layername,t(o,2),t(parseInt(r/1e6),3),t(parseInt(r/1e3)%1e3,3),t(parseInt(r)%1e3,3),t(parseInt(a/1e6),3),t(parseInt(a/1e3)%1e3,3),t(parseInt(a)%1e3,3)+"."+this.extension],h=l.join("/"),u=this.url;return OpenLayers.Util.isArray(u)&&(u=this.selectUrl(h,u)),u="/"==u.charAt(u.length-1)?u:u+"/",u+h},CLASS_NAME:"OpenLayers.Layer.TileCache"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WMSCapabilities.v1_1_1=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,{version:"1.1.1",readers:{wms:OpenLayers.Util.applyDefaults({SRS:function(e,t){t.srs[this.getChildValue(e)]=!0}},OpenLayers.Format.WMSCapabilities.v1_1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_1"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WMSCapabilities.v1_1_1_WMSC=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1_1,{version:"1.1.1",profile:"WMSC",readers:{wms:OpenLayers.Util.applyDefaults({VendorSpecificCapabilities:function(e,t){t.vendorSpecific={tileSets:[]},this.readChildNodes(e,t.vendorSpecific)},TileSet:function(e,t){var i={srs:{},bbox:{},resolutions:[]};this.readChildNodes(e,i),t.tileSets.push(i)},Resolutions:function(e,t){for(var i=this.getChildValue(e).split(" "),s=0,n=i.length;n>s;s++)""!=i[s]&&t.resolutions.push(parseFloat(i[s]))},Width:function(e,t){t.width=parseInt(this.getChildValue(e))},Height:function(e,t){t.height=parseInt(this.getChildValue(e))},Layers:function(e,t){t.layers=this.getChildValue(e)},Styles:function(e,t){t.styles=this.getChildValue(e)}},OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_1_WMSC"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.LayerSwitcher=OpenLayers.Class(OpenLayers.Control,{roundedCorner:!1,roundedCornerColor:"darkblue",layerStates:null,layersDiv:null,baseLayersDiv:null,baseLayers:null,dataLbl:null,dataLayersDiv:null,dataLayers:null,minimizeDiv:null,maximizeDiv:null,ascending:!0,initialize:function(){OpenLayers.Control.prototype.initialize.apply(this,arguments),this.layerStates=[],this.roundedCorner&&OpenLayers.Console.warn("roundedCorner option is deprecated")},destroy:function(){this.clearLayersArray("base"),this.clearLayersArray("data"),this.map.events.un({buttonclick:this.onButtonClick,addlayer:this.redraw,changelayer:this.redraw,removelayer:this.redraw,changebaselayer:this.redraw,scope:this}),this.events.unregister("buttonclick",this,this.onButtonClick),OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(){OpenLayers.Control.prototype.setMap.apply(this,arguments),this.map.events.on({addlayer:this.redraw,changelayer:this.redraw,removelayer:this.redraw,changebaselayer:this.redraw,scope:this}),this.outsideViewport?(this.events.attachToElement(this.div),this.events.register("buttonclick",this,this.onButtonClick)):this.map.events.register("buttonclick",this,this.onButtonClick)},draw:function(){return OpenLayers.Control.prototype.draw.apply(this),this.loadContents(),this.outsideViewport||this.minimizeControl(),this.redraw(),this.div},onButtonClick:function(e){var t=e.buttonElement;t===this.minimizeDiv?this.minimizeControl():t===this.maximizeDiv?this.maximizeControl():t._layerSwitcher===this.id&&(t["for"]&&(t=document.getElementById(t["for"])),t.disabled||("radio"==t.type?(t.checked=!0,this.map.setBaseLayer(this.map.getLayer(t._layer))):(t.checked=!t.checked,this.updateMap())))},clearLayersArray:function(e){this[e+"LayersDiv"].innerHTML="",this[e+"Layers"]=[]},checkRedraw:function(){var e=!1;if(this.layerStates.length&&this.map.layers.length==this.layerStates.length)for(var t=0,i=this.layerStates.length;i>t;t++){var s=this.layerStates[t],n=this.map.layers[t];if(s.name!=n.name||s.inRange!=n.inRange||s.id!=n.id||s.visibility!=n.visibility){e=!0;break}}else e=!0;return e},redraw:function(){if(!this.checkRedraw())return this.div;this.clearLayersArray("base"),this.clearLayersArray("data");var e=!1,t=!1,i=this.map.layers.length;this.layerStates=new Array(i);for(var s=0;i>s;s++){var n=this.map.layers[s];this.layerStates[s]={name:n.name,visibility:n.visibility,inRange:n.inRange,id:n.id}}var r=this.map.layers.slice();this.ascending||r.reverse();for(var s=0,i=r.length;i>s;s++){var n=r[s],a=n.isBaseLayer;if(n.displayInLayerSwitcher){a?t=!0:e=!0;var o=a?n==this.map.baseLayer:n.getVisibility(),l=document.createElement("input");l.id=this.id+"_input_"+n.name,l.name=a?this.id+"_baseLayers":n.name,l.type=a?"radio":"checkbox",l.value=n.name,l.checked=o,l.defaultChecked=o,l.className="olButton",l._layer=n.id,l._layerSwitcher=this.id,a||n.inRange||(l.disabled=!0);var h=document.createElement("label");h["for"]=l.id,OpenLayers.Element.addClass(h,"labelSpan olButton"),h._layer=n.id,h._layerSwitcher=this.id,a||n.inRange||(h.style.color="gray"),h.innerHTML=n.name,h.style.verticalAlign=a?"bottom":"baseline";var u=document.createElement("br"),c=a?this.baseLayers:this.dataLayers;c.push({layer:n,inputElem:l,labelSpan:h});var d=a?this.baseLayersDiv:this.dataLayersDiv;d.appendChild(l),d.appendChild(h),d.appendChild(u)}}return this.dataLbl.style.display=e?"":"none",this.baseLbl.style.display=t?"":"none",this.div},updateMap:function(){for(var e=0,t=this.baseLayers.length;t>e;e++){var i=this.baseLayers[e];i.inputElem.checked&&this.map.setBaseLayer(i.layer,!1)}for(var e=0,t=this.dataLayers.length;t>e;e++){var i=this.dataLayers[e];i.layer.setVisibility(i.inputElem.checked)}},maximizeControl:function(e){this.div.style.width="",this.div.style.height="",this.showControls(!1),null!=e&&OpenLayers.Event.stop(e)},minimizeControl:function(e){this.div.style.width="0px",this.div.style.height="0px",this.showControls(!0),null!=e&&OpenLayers.Event.stop(e)},showControls:function(e){this.maximizeDiv.style.display=e?"":"none",this.minimizeDiv.style.display=e?"none":"",this.layersDiv.style.display=e?"none":""},loadContents:function(){this.layersDiv=document.createElement("div"),this.layersDiv.id=this.id+"_layersDiv",OpenLayers.Element.addClass(this.layersDiv,"layersDiv"),this.baseLbl=document.createElement("div"),this.baseLbl.innerHTML=OpenLayers.i18n("Base Layer"),OpenLayers.Element.addClass(this.baseLbl,"baseLbl"),this.baseLayersDiv=document.createElement("div"),OpenLayers.Element.addClass(this.baseLayersDiv,"baseLayersDiv"),this.dataLbl=document.createElement("div"),this.dataLbl.innerHTML=OpenLayers.i18n("Overlays"),OpenLayers.Element.addClass(this.dataLbl,"dataLbl"),this.dataLayersDiv=document.createElement("div"),OpenLayers.Element.addClass(this.dataLayersDiv,"dataLayersDiv"),this.ascending?(this.layersDiv.appendChild(this.baseLbl),this.layersDiv.appendChild(this.baseLayersDiv),this.layersDiv.appendChild(this.dataLbl),this.layersDiv.appendChild(this.dataLayersDiv)):(this.layersDiv.appendChild(this.dataLbl),this.layersDiv.appendChild(this.dataLayersDiv),this.layersDiv.appendChild(this.baseLbl),this.layersDiv.appendChild(this.baseLayersDiv)),this.div.appendChild(this.layersDiv),this.roundedCorner&&(OpenLayers.Rico.Corner.round(this.div,{corners:"tl bl",bgColor:"transparent",color:this.roundedCornerColor,blend:!1}),OpenLayers.Rico.Corner.changeOpacity(this.layersDiv,.75));var e=OpenLayers.Util.getImageLocation("layer-switcher-maximize.png");this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MaximizeDiv",null,null,e,"absolute"),OpenLayers.Element.addClass(this.maximizeDiv,"maximizeDiv olButton"),this.maximizeDiv.style.display="none",this.div.appendChild(this.maximizeDiv);var e=OpenLayers.Util.getImageLocation("layer-switcher-minimize.png");this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MinimizeDiv",null,null,e,"absolute"),OpenLayers.Element.addClass(this.minimizeDiv,"minimizeDiv olButton"),this.minimizeDiv.style.display="none",this.div.appendChild(this.minimizeDiv)},CLASS_NAME:"OpenLayers.Control.LayerSwitcher"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Tile.Image.IFrame={useIFrame:null,draw:function(){var e=OpenLayers.Tile.Image.prototype.shouldDraw.call(this);if(e){var t=this.layer.getURL(this.bounds),i=this.useIFrame;this.useIFrame=null!==this.maxGetUrlLength&&!this.layer.async&&t.length>this.maxGetUrlLength;var s=i&&!this.useIFrame,n=!i&&this.useIFrame;(s||n)&&(this.imgDiv&&this.imgDiv.parentNode===this.frame&&this.frame.removeChild(this.imgDiv),this.imgDiv=null,s?(this.blankImageUrl=this._blankImageUrl,this.frame.removeChild(this.frame.firstChild)):(this._blankImageUrl=this.blankImageUrl,this.blankImageUrl="about:blank"))}return OpenLayers.Tile.Image.prototype.draw.apply(this,arguments)},getImage:function(){if(this.useIFrame===!0){if(!this.frame.childNodes.length){var e=document.createElement("div"),t=e.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex=1,t.backgroundImage="url("+this._blankImageUrl+")",this.frame.appendChild(e)}var i,s=this.id+"_iFrame";return parseFloat(navigator.appVersion.split("MSIE")[1])<9?(i=document.createElement('<iframe name="'+s+'">'),i.style.backgroundColor="#FFFFFF",i.style.filter="chroma(color=#FFFFFF)"):(i=document.createElement("iframe"),i.style.backgroundColor="transparent",i.name=s),i.scrolling="no",i.marginWidth="0px",i.marginHeight="0px",i.frameBorder="0",i.style.position="absolute",i.style.width="100%",i.style.height="100%",this.layer.opacity<1&&OpenLayers.Util.modifyDOMElement(i,null,null,null,null,null,null,this.layer.opacity),this.frame.appendChild(i),this.imgDiv=i,i}return OpenLayers.Tile.Image.prototype.getImage.apply(this,arguments)},createRequestForm:function(){var e=document.createElement("form");e.method="POST";var t=this.layer.params._OLSALT;t=(t?t+"_":"")+this.bounds.toBBOX(),e.action=OpenLayers.Util.urlAppend(this.layer.url,t),e.target=this.id+"_iFrame";var i,s=(this.layer.getImageSize(),OpenLayers.Util.getParameters(this.url));for(var n in s)i=document.createElement("input"),i.type="hidden",i.name=n,i.value=s[n],e.appendChild(i);return e},setImgSrc:function(e){if(this.useIFrame===!0)if(e){var t=this.createRequestForm();this.frame.appendChild(t),t.submit(),this.frame.removeChild(t)}else this.imgDiv.parentNode===this.frame&&(this.frame.removeChild(this.imgDiv),this.imgDiv=null);else OpenLayers.Tile.Image.prototype.setImgSrc.apply(this,arguments)},onImageLoad:function(){OpenLayers.Tile.Image.prototype.onImageLoad.apply(this,arguments),this.useIFrame===!0&&(this.imgDiv.style.opacity=1,this.frame.style.opacity=this.layer.opacity)},createBackBuffer:function(){var e;return this.useIFrame===!1&&(e=OpenLayers.Tile.Image.prototype.createBackBuffer.call(this)),e}},/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.ModifyFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,clickout:!0,toggle:!0,standalone:!1,layer:null,feature:null,vertices:null,virtualVertices:null,selectControl:null,dragControl:null,handlers:null,deleteCodes:null,virtualStyle:null,vertexRenderIntent:null,mode:null,createVertices:!0,modified:!1,radiusHandle:null,dragHandle:null,onModificationStart:function(){},onModification:function(){},onModificationEnd:function(){},initialize:function(e,t){t=t||{},this.layer=e,this.vertices=[],this.virtualVertices=[],this.virtualStyle=OpenLayers.Util.extend({},this.layer.style||this.layer.styleMap.createSymbolizer(null,t.vertexRenderIntent)),this.virtualStyle.fillOpacity=.3,this.virtualStyle.strokeOpacity=.3,this.deleteCodes=[46,68],this.mode=OpenLayers.Control.ModifyFeature.RESHAPE,OpenLayers.Control.prototype.initialize.apply(this,[t]),OpenLayers.Util.isArray(this.deleteCodes)||(this.deleteCodes=[this.deleteCodes]);var i=this,s={geometryTypes:this.geometryTypes,clickout:this.clickout,toggle:this.toggle,onBeforeSelect:this.beforeSelectFeature,onSelect:this.selectFeature,onUnselect:this.unselectFeature,scope:this};this.standalone===!1&&(this.selectControl=new OpenLayers.Control.SelectFeature(e,s));var n={geometryTypes:["OpenLayers.Geometry.Point"],onStart:function(e,t){i.dragStart.apply(i,[e,t])},onDrag:function(e,t){i.dragVertex.apply(i,[e,t])},onComplete:function(e){i.dragComplete.apply(i,[e])},featureCallbacks:{over:function(e){(i.standalone!==!0||e._sketch||i.feature===e)&&i.dragControl.overFeature.apply(i.dragControl,[e])}}};this.dragControl=new OpenLayers.Control.DragFeature(e,n);var r={keydown:this.handleKeypress};this.handlers={keyboard:new OpenLayers.Handler.Keyboard(this,r)}},destroy:function(){this.layer=null,this.standalone||this.selectControl.destroy(),this.dragControl.destroy(),OpenLayers.Control.prototype.destroy.apply(this,[])},activate:function(){return(this.standalone||this.selectControl.activate())&&this.handlers.keyboard.activate()&&OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){var e=!1;if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){this.layer.removeFeatures(this.vertices,{silent:!0}),this.layer.removeFeatures(this.virtualVertices,{silent:!0}),this.vertices=[],this.dragControl.deactivate();var t=this.feature,i=t&&t.geometry&&t.layer;this.standalone===!1?(i&&this.selectControl.unselect.apply(this.selectControl,[t]),this.selectControl.deactivate()):i&&this.unselectFeature(t),this.handlers.keyboard.deactivate(),e=!0}return e},beforeSelectFeature:function(e){return this.layer.events.triggerEvent("beforefeaturemodified",{feature:e})},selectFeature:function(e){this.standalone&&this.beforeSelectFeature(e)===!1||(this.feature=e,this.modified=!1,this.resetVertices(),this.dragControl.activate(),this.onModificationStart(this.feature));var t=e.modified;!e.geometry||t&&t.geometry||(this._originalGeometry=e.geometry.clone())},unselectFeature:function(e){this.layer.removeFeatures(this.vertices,{silent:!0}),this.vertices=[],this.layer.destroyFeatures(this.virtualVertices,{silent:!0}),this.virtualVertices=[],this.dragHandle&&(this.layer.destroyFeatures([this.dragHandle],{silent:!0}),delete this.dragHandle),this.radiusHandle&&(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),delete this.radiusHandle),this.feature=null,this.dragControl.deactivate(),this.onModificationEnd(e),this.layer.events.triggerEvent("afterfeaturemodified",{feature:e,modified:this.modified}),this.modified=!1},dragStart:function(e,t){e==this.feature||e.geometry.parent||e==this.dragHandle||e==this.radiusHandle||(this.standalone===!1&&this.feature&&this.selectControl.clickFeature.apply(this.selectControl,[this.feature]),(null==this.geometryTypes||-1!=OpenLayers.Util.indexOf(this.geometryTypes,e.geometry.CLASS_NAME))&&(this.standalone||this.selectControl.clickFeature.apply(this.selectControl,[e]),this.dragControl.overFeature.apply(this.dragControl,[e]),this.dragControl.lastPixel=t,this.dragControl.handlers.drag.started=!0,this.dragControl.handlers.drag.start=t,this.dragControl.handlers.drag.last=t))},dragVertex:function(e,t){this.modified=!0,"OpenLayers.Geometry.Point"==this.feature.geometry.CLASS_NAME?(this.feature!=e&&(this.feature=e),this.layer.events.triggerEvent("vertexmodified",{vertex:e.geometry,feature:this.feature,pixel:t})):(e._index?(e.geometry.parent.addComponent(e.geometry,e._index),delete e._index,OpenLayers.Util.removeItem(this.virtualVertices,e),this.vertices.push(e)):e==this.dragHandle?(this.layer.removeFeatures(this.vertices,{silent:!0}),this.vertices=[],this.radiusHandle&&(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),this.radiusHandle=null)):e!==this.radiusHandle&&this.layer.events.triggerEvent("vertexmodified",{vertex:e.geometry,feature:this.feature,pixel:t}),this.virtualVertices.length>0&&(this.layer.destroyFeatures(this.virtualVertices,{silent:!0}),this.virtualVertices=[]),this.layer.drawFeature(this.feature,this.standalone?void 0:this.selectControl.renderIntent)),this.layer.drawFeature(e)},dragComplete:function(){this.resetVertices(),this.setFeatureState(),this.onModification(this.feature),this.layer.events.triggerEvent("featuremodified",{feature:this.feature})},setFeatureState:function(){if(this.feature.state!=OpenLayers.State.INSERT&&this.feature.state!=OpenLayers.State.DELETE&&(this.feature.state=OpenLayers.State.UPDATE,this.modified&&this._originalGeometry)){var e=this.feature;e.modified=OpenLayers.Util.extend(e.modified,{geometry:this._originalGeometry}),delete this._originalGeometry}},resetVertices:function(){this.dragControl.feature&&this.dragControl.outFeature(this.dragControl.feature),this.vertices.length>0&&(this.layer.removeFeatures(this.vertices,{silent:!0}),this.vertices=[]),this.virtualVertices.length>0&&(this.layer.removeFeatures(this.virtualVertices,{silent:!0}),this.virtualVertices=[]),this.dragHandle&&(this.layer.destroyFeatures([this.dragHandle],{silent:!0}),this.dragHandle=null),this.radiusHandle&&(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),this.radiusHandle=null),this.feature&&"OpenLayers.Geometry.Point"!=this.feature.geometry.CLASS_NAME&&(this.mode&OpenLayers.Control.ModifyFeature.DRAG&&this.collectDragHandle(),this.mode&(OpenLayers.Control.ModifyFeature.ROTATE|OpenLayers.Control.ModifyFeature.RESIZE)&&this.collectRadiusHandle(),this.mode&OpenLayers.Control.ModifyFeature.RESHAPE&&(this.mode&OpenLayers.Control.ModifyFeature.RESIZE||this.collectVertices()))},handleKeypress:function(e){var t=e.keyCode;if(this.feature&&-1!=OpenLayers.Util.indexOf(this.deleteCodes,t)){var i=this.dragControl.feature;i&&-1!=OpenLayers.Util.indexOf(this.vertices,i)&&!this.dragControl.handlers.drag.dragging&&i.geometry.parent&&(i.geometry.parent.removeComponent(i.geometry),this.layer.events.triggerEvent("vertexremoved",{vertex:i.geometry,feature:this.feature,pixel:e.xy}),this.layer.drawFeature(this.feature,this.standalone?void 0:this.selectControl.renderIntent),this.modified=!0,this.resetVertices(),this.setFeatureState(),this.onModification(this.feature),this.layer.events.triggerEvent("featuremodified",{feature:this.feature}))}},collectVertices:function(){function e(i){var s,n,r,a;if("OpenLayers.Geometry.Point"==i.CLASS_NAME)n=new OpenLayers.Feature.Vector(i),n._sketch=!0,n.renderIntent=t.vertexRenderIntent,t.vertices.push(n);else{var o=i.components.length;for("OpenLayers.Geometry.LinearRing"==i.CLASS_NAME&&(o-=1),s=0;o>s;++s)r=i.components[s],"OpenLayers.Geometry.Point"==r.CLASS_NAME?(n=new OpenLayers.Feature.Vector(r),n._sketch=!0,n.renderIntent=t.vertexRenderIntent,t.vertices.push(n)):e(r);if(t.createVertices&&"OpenLayers.Geometry.MultiPoint"!=i.CLASS_NAME)for(s=0,a=i.components.length;a-1>s;++s){var l=i.components[s],h=i.components[s+1];if("OpenLayers.Geometry.Point"==l.CLASS_NAME&&"OpenLayers.Geometry.Point"==h.CLASS_NAME){var u=(l.x+h.x)/2,c=(l.y+h.y)/2,d=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(u,c),null,t.virtualStyle);d.geometry.parent=i,d._index=s+1,d._sketch=!0,t.virtualVertices.push(d)}}}}this.vertices=[],this.virtualVertices=[];var t=this;e.call(this,this.feature.geometry),this.layer.addFeatures(this.virtualVertices,{silent:!0}),this.layer.addFeatures(this.vertices,{silent:!0})},collectDragHandle:function(){var e=this.feature.geometry,t=e.getBounds().getCenterLonLat(),i=new OpenLayers.Geometry.Point(t.lon,t.lat),s=new OpenLayers.Feature.Vector(i);i.move=function(t,i){OpenLayers.Geometry.Point.prototype.move.call(this,t,i),e.move(t,i)},s._sketch=!0,this.dragHandle=s,this.dragHandle.renderIntent=this.vertexRenderIntent,this.layer.addFeatures([this.dragHandle],{silent:!0})},collectRadiusHandle:function(){var e=this.feature.geometry,t=e.getBounds(),i=t.getCenterLonLat(),s=new OpenLayers.Geometry.Point(i.lon,i.lat),n=new OpenLayers.Geometry.Point(t.right,t.bottom),r=new OpenLayers.Feature.Vector(n),a=this.mode&OpenLayers.Control.ModifyFeature.RESIZE,o=this.mode&OpenLayers.Control.ModifyFeature.RESHAPE,l=this.mode&OpenLayers.Control.ModifyFeature.ROTATE;n.move=function(t,i){OpenLayers.Geometry.Point.prototype.move.call(this,t,i);var n=this.x-s.x,r=this.y-s.y,h=n-t,u=r-i;if(l){var c=Math.atan2(u,h),d=Math.atan2(r,n),p=d-c;p*=180/Math.PI,e.rotate(p,s)}if(a){var f,m;if(o)f=r/u,m=n/h/f;else{var y=Math.sqrt(h*h+u*u),g=Math.sqrt(n*n+r*r);f=g/y}e.resize(f,s,m)}},r._sketch=!0,this.radiusHandle=r,this.radiusHandle.renderIntent=this.vertexRenderIntent,this.layer.addFeatures([this.radiusHandle],{silent:!0})},setMap:function(e){this.standalone||this.selectControl.setMap(e),this.dragControl.setMap(e),OpenLayers.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.ModifyFeature"}),OpenLayers.Control.ModifyFeature.RESHAPE=1,OpenLayers.Control.ModifyFeature.RESIZE=2,OpenLayers.Control.ModifyFeature.ROTATE=4,OpenLayers.Control.ModifyFeature.DRAG=8,/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.Atom=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{atom:"http://www.w3.org/2005/Atom",georss:"http://www.georss.org/georss"},feedTitle:"untitled",defaultEntryTitle:"untitled",gmlParser:null,xy:!1,read:function(e){return"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e])),this.parseFeatures(e)},write:function(e){var t;if(OpenLayers.Util.isArray(e)){t=this.createElementNSPlus("atom:feed"),t.appendChild(this.createElementNSPlus("atom:title",{value:this.feedTitle}));for(var i=0,s=e.length;s>i;i++)t.appendChild(this.buildEntryNode(e[i]))}else t=this.buildEntryNode(e);return OpenLayers.Format.XML.prototype.write.apply(this,[t])},buildContentNode:function(e){var t=this.createElementNSPlus("atom:content",{attributes:{type:e.type||null}});if(e.src)t.setAttribute("src",e.src);else if("text"==e.type||null==e.type)t.appendChild(this.createTextNode(e.value));else if("html"==e.type){if("string"!=typeof e.value)throw"HTML content must be in form of an escaped string";t.appendChild(this.createTextNode(e.value))}else"xhtml"==e.type?t.appendChild(e.value):"xhtml"==e.type||e.type.match(/(\+|\/)xml$/)?t.appendChild(e.value):t.appendChild(this.createTextNode(e.value));return t},buildEntryNode:function(e){var t=e.attributes,i=t.atom||{},s=this.createElementNSPlus("atom:entry");if(i.authors)for(var n=OpenLayers.Util.isArray(i.authors)?i.authors:[i.authors],r=0,a=n.length;a>r;r++)s.appendChild(this.buildPersonConstructNode("author",n[r]));if(i.categories)for(var o,l=OpenLayers.Util.isArray(i.categories)?i.categories:[i.categories],r=0,a=l.length;a>r;r++)o=l[r],s.appendChild(this.createElementNSPlus("atom:category",{attributes:{term:o.term,scheme:o.scheme||null,label:o.label||null}}));if(i.content&&s.appendChild(this.buildContentNode(i.content)),i.contributors)for(var h=OpenLayers.Util.isArray(i.contributors)?i.contributors:[i.contributors],r=0,a=h.length;a>r;r++)s.appendChild(this.buildPersonConstructNode("contributor",h[r]));if(e.fid&&s.appendChild(this.createElementNSPlus("atom:id",{value:e.fid})),i.links)for(var u,c=OpenLayers.Util.isArray(i.links)?i.links:[i.links],r=0,a=c.length;a>r;r++)u=c[r],s.appendChild(this.createElementNSPlus("atom:link",{attributes:{href:u.href,rel:u.rel||null,type:u.type||null,hreflang:u.hreflang||null,title:u.title||null,length:u.length||null}}));if(i.published&&s.appendChild(this.createElementNSPlus("atom:published",{value:i.published})),i.rights&&s.appendChild(this.createElementNSPlus("atom:rights",{value:i.rights})),(i.summary||t.description)&&s.appendChild(this.createElementNSPlus("atom:summary",{value:i.summary||t.description})),s.appendChild(this.createElementNSPlus("atom:title",{value:i.title||t.title||this.defaultEntryTitle})),i.updated&&s.appendChild(this.createElementNSPlus("atom:updated",{value:i.updated})),e.geometry){var d=this.createElementNSPlus("georss:where");d.appendChild(this.buildGeometryNode(e.geometry)),s.appendChild(d)}return s},initGmlParser:function(){this.gmlParser=new OpenLayers.Format.GML.v3({xy:this.xy,featureNS:"http://example.com#feature",internalProjection:this.internalProjection,externalProjection:this.externalProjection})},buildGeometryNode:function(e){this.gmlParser||this.initGmlParser();var t=this.gmlParser.writeNode("feature:_geometry",e);return t.firstChild},buildPersonConstructNode:function(e,t){var i=["uri","email"],s=this.createElementNSPlus("atom:"+e);s.appendChild(this.createElementNSPlus("atom:name",{value:t.name}));for(var n=0,r=i.length;r>n;n++)t[i[n]]&&s.appendChild(this.createElementNSPlus("atom:"+i[n],{value:t[i[n]]}));return s},getFirstChildValue:function(e,t,i,s){var n,r=this.getElementsByTagNameNS(e,t,i);return n=r&&r.length>0?this.getChildValue(r[0],s):s},parseFeature:function(e){var t={},i=null,s=null,n=null,r=this.namespaces.atom;this.parsePersonConstructs(e,"author",t),s=this.getElementsByTagNameNS(e,r,"category"),s.length>0&&(t.categories=[]);for(var a=0,o=s.length;o>a;a++)i={},i.term=s[a].getAttribute("term"),n=s[a].getAttribute("scheme"),n&&(i.scheme=n),n=s[a].getAttribute("label"),n&&(i.label=n),t.categories.push(i);s=this.getElementsByTagNameNS(e,r,"content"),s.length>0&&(i={},n=s[0].getAttribute("type"),n&&(i.type=n),n=s[0].getAttribute("src"),n?i.src=n:(i.value="text"==i.type||"html"==i.type||null==i.type?this.getFirstChildValue(e,r,"content",null):"xhtml"==i.type||i.type.match(/(\+|\/)xml$/)?this.getChildEl(s[0]):this.getFirstChildValue(e,r,"content",null),t.content=i)),this.parsePersonConstructs(e,"contributor",t),t.id=this.getFirstChildValue(e,r,"id",null),s=this.getElementsByTagNameNS(e,r,"link"),s.length>0&&(t.links=new Array(s.length));for(var l=["rel","type","hreflang","title","length"],a=0,o=s.length;o>a;a++){i={},i.href=s[a].getAttribute("href");for(var h=0,u=l.length;u>h;h++)n=s[a].getAttribute(l[h]),n&&(i[l[h]]=n);t.links[a]=i}i=this.getFirstChildValue(e,r,"published",null),i&&(t.published=i),i=this.getFirstChildValue(e,r,"rights",null),i&&(t.rights=i),i=this.getFirstChildValue(e,r,"summary",null),i&&(t.summary=i),t.title=this.getFirstChildValue(e,r,"title",null),t.updated=this.getFirstChildValue(e,r,"updated",null);var c={title:t.title,description:t.summary,atom:t},d=this.parseLocations(e)[0],p=new OpenLayers.Feature.Vector(d,c);return p.fid=t.id,p},parseFeatures:function(e){var t=[],i=this.getElementsByTagNameNS(e,this.namespaces.atom,"entry");0==i.length&&(i=[e]);for(var s=0,n=i.length;n>s;s++)t.push(this.parseFeature(i[s]));return t},parseLocations:function(e){var t=this.namespaces.georss,i={components:[]},s=this.getElementsByTagNameNS(e,t,"where");if(s&&s.length>0){this.gmlParser||this.initGmlParser();for(var n=0,r=s.length;r>n;n++)this.gmlParser.readChildNodes(s[n],i)}var a=i.components,o=this.getElementsByTagNameNS(e,t,"point");if(o&&o.length>0)for(var n=0,r=o.length;r>n;n++){var l=OpenLayers.String.trim(o[n].firstChild.nodeValue).split(/\s+/);2!=l.length&&(l=OpenLayers.String.trim(o[n].firstChild.nodeValue).split(/\s*,\s*/)),a.push(new OpenLayers.Geometry.Point(l[1],l[0]))}var h=this.getElementsByTagNameNS(e,t,"line");if(h&&h.length>0)for(var u,c,d,n=0,r=h.length;r>n;n++){u=OpenLayers.String.trim(h[n].firstChild.nodeValue).split(/\s+/),d=[];for(var p=0,f=u.length;f>p;p+=2)c=new OpenLayers.Geometry.Point(u[p+1],u[p]),d.push(c);a.push(new OpenLayers.Geometry.LineString(d))}var m=this.getElementsByTagNameNS(e,t,"polygon");if(m&&m.length>0)for(var u,c,d,n=0,r=m.length;r>n;n++){u=OpenLayers.String.trim(m[n].firstChild.nodeValue).split(/\s+/),d=[];for(var p=0,f=u.length;f>p;p+=2)c=new OpenLayers.Geometry.Point(u[p+1],u[p]),d.push(c);a.push(new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(a)]))}if(this.internalProjection&&this.externalProjection)for(var n=0,r=a.length;r>n;n++)a[n]&&a[n].transform(this.externalProjection,this.internalProjection);return a},parsePersonConstructs:function(e,t,i){for(var s=[],n=this.namespaces.atom,r=this.getElementsByTagNameNS(e,n,t),a=["uri","email"],o=0,l=r.length;l>o;o++){var h={};h.name=this.getFirstChildValue(r[o],n,"name",null);for(var u=0,c=a.length;c>u;u++){var d=this.getFirstChildValue(r[o],n,a[u],null);d&&(h[a[u]]=d)}s.push(h)}s.length>0&&(i[t+"s"]=s)},CLASS_NAME:"OpenLayers.Format.Atom"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Control.KeyboardDefaults=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,slideFactor:75,observeElement:null,draw:function(){var e=this.observeElement||document;this.handler=new OpenLayers.Handler.Keyboard(this,{keydown:this.defaultKeyPress},{observeElement:e})},defaultKeyPress:function(e){var t,i=!0;switch(e.keyCode){case OpenLayers.Event.KEY_LEFT:this.map.pan(-this.slideFactor,0);break;case OpenLayers.Event.KEY_RIGHT:this.map.pan(this.slideFactor,0);break;case OpenLayers.Event.KEY_UP:this.map.pan(0,-this.slideFactor);break;case OpenLayers.Event.KEY_DOWN:this.map.pan(0,this.slideFactor);break;case 33:t=this.map.getSize(),this.map.pan(0,-.75*t.h);break;case 34:t=this.map.getSize(),this.map.pan(0,.75*t.h);break;case 35:t=this.map.getSize(),this.map.pan(.75*t.w,0);break;case 36:t=this.map.getSize(),this.map.pan(-.75*t.w,0);break;case 43:case 61:case 187:case 107:this.map.zoomIn();break;case 45:case 109:case 189:case 95:this.map.zoomOut();break;default:i=!1}i&&OpenLayers.Event.stop(e)},CLASS_NAME:"OpenLayers.Control.KeyboardDefaults"}),/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
OpenLayers.Format.WMTSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1_1_0,{version:"1.0.0",namespaces:{ows:"http://www.opengis.net/ows/1.1",wmts:"http://www.opengis.net/wmts/1.0",xlink:"http://www.w3.org/1999/xlink"},yx:null,defaultPrefix:"wmts",initialize:function(e){OpenLayers.Format.XML.prototype.initialize.apply(this,[e]),this.options=e;var t=OpenLayers.Util.extend({},OpenLayers.Format.WMTSCapabilities.prototype.yx);this.yx=OpenLayers.Util.extend(t,this.yx)},read:function(e){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e])),e&&9==e.nodeType&&(e=e.documentElement);var t={};return this.readNode(e,t),t.version=this.version,t},readers:{wmts:{Capabilities:function(e,t){this.readChildNodes(e,t)},Contents:function(e,t){t.contents={},t.contents.layers=[],t.contents.tileMatrixSets={},this.readChildNodes(e,t.contents)},Layer:function(e,t){var i={styles:[],formats:[],dimensions:[],tileMatrixSetLinks:[]};i.layers=[],this.readChildNodes(e,i),t.layers.push(i)},Style:function(e,t){var i={};i.isDefault="true"===e.getAttribute("isDefault"),this.readChildNodes(e,i),t.styles.push(i)},Format:function(e,t){t.formats.push(this.getChildValue(e))},TileMatrixSetLink:function(e,t){var i={};this.readChildNodes(e,i),t.tileMatrixSetLinks.push(i)},TileMatrixSet:function(e,t){if(t.layers){var i={matrixIds:[]};this.readChildNodes(e,i),t.tileMatrixSets[i.identifier]=i}else t.tileMatrixSet=this.getChildValue(e)},TileMatrix:function(e,t){var i={supportedCRS:t.supportedCRS};this.readChildNodes(e,i),t.matrixIds.push(i)},ScaleDenominator:function(e,t){t.scaleDenominator=parseFloat(this.getChildValue(e))},TopLeftCorner:function(e,t){var i,s=this.getChildValue(e),n=s.split(" ");if(t.supportedCRS){var r=t.supportedCRS.replace(/urn:ogc:def:crs:(\w+):.+:(\w+)$/,"urn:ogc:def:crs:$1::$2");i=!!this.yx[r]}t.topLeftCorner=i?new OpenLayers.LonLat(n[1],n[0]):new OpenLayers.LonLat(n[0],n[1])},TileWidth:function(e,t){t.tileWidth=parseInt(this.getChildValue(e))},TileHeight:function(e,t){t.tileHeight=parseInt(this.getChildValue(e))},MatrixWidth:function(e,t){t.matrixWidth=parseInt(this.getChildValue(e))},MatrixHeight:function(e,t){t.matrixHeight=parseInt(this.getChildValue(e))},ResourceURL:function(e,t){t.resourceUrl=t.resourceUrl||{},t.resourceUrl[e.getAttribute("resourceType")]={format:e.getAttribute("format"),template:e.getAttribute("template")}},WSDL:function(e,t){t.wsdl={},t.wsdl.href=e.getAttribute("xlink:href")},ServiceMetadataURL:function(e,t){t.serviceMetadataUrl={},t.serviceMetadataUrl.href=e.getAttribute("xlink:href")},LegendURL:function(e,t){t.legend={},t.legend.href=e.getAttribute("xlink:href"),t.legend.format=e.getAttribute("format")},Dimension:function(e,t){var i={values:[]};this.readChildNodes(e,i),t.dimensions.push(i)},Default:function(e,t){t["default"]=this.getChildValue(e)},Value:function(e,t){t.values.push(this.getChildValue(e))}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WMTSCapabilities.v1_0_0"}),OpenLayers.Class.isPrototype=function(){},OpenLayers.Class.create=function(){return function(){arguments&&arguments[0]!=OpenLayers.Class.isPrototype&&this.initialize.apply(this,arguments)}},OpenLayers.Class.inherit=function(e){var t=function(){e.call(this)},i=[t].concat(Array.prototype.slice.call(arguments));return OpenLayers.inherit.apply(null,i),t.prototype},OpenLayers.Util.clearArray=function(e){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"array = []"})),e.length=0},OpenLayers.Util.setOpacity=function(e,t){OpenLayers.Util.modifyDOMElement(e,null,null,null,null,null,null,t)},OpenLayers.Util.safeStopPropagation=function(e){OpenLayers.Event.stop(e,!0)},OpenLayers.Util.getArgs=function(e){return OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.Util.getParameters"})),OpenLayers.Util.getParameters(e)},OpenLayers.nullHandler=function(e){OpenLayers.Console.userError(OpenLayers.i18n("unhandledRequest",{statusText:e.statusText}))},OpenLayers.loadURL=function(e,t,i,s,n){"string"==typeof t&&(t=OpenLayers.Util.getParameters(t));var r=s?s:OpenLayers.nullHandler,a=n?n:OpenLayers.nullHandler;return OpenLayers.Request.GET({url:e,params:t,success:r,failure:a,scope:i})},OpenLayers.parseXMLString=function(e){var t=e.indexOf("<");t>0&&(e=e.substring(t));var i=OpenLayers.Util.Try(function(){var t=new ActiveXObject("Microsoft.XMLDOM");return t.loadXML(e),t},function(){return(new DOMParser).parseFromString(e,"text/xml")},function(){var t=new XMLHttpRequest;return t.open("GET","data:text/xml;charset=utf-8,"+encodeURIComponent(e),!1),t.overrideMimeType&&t.overrideMimeType("text/xml"),t.send(null),t.responseXML});return i},OpenLayers.Ajax={emptyFunction:function(){},getTransport:function(){return OpenLayers.Util.Try(function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})||!1},activeRequestCount:0},OpenLayers.Ajax.Responders={responders:[],register:function(e){for(var t=0;t<this.responders.length;t++)if(e==this.responders[t])return;this.responders.push(e)},unregister:function(e){OpenLayers.Util.removeItem(this.reponders,e)},dispatch:function(e,t,i){for(var s,n=0;n<this.responders.length;n++)if(s=this.responders[n],s[e]&&"function"==typeof s[e])try{s[e].apply(s,[t,i])}catch(r){}}},OpenLayers.Ajax.Responders.register({onCreate:function(){OpenLayers.Ajax.activeRequestCount++},onComplete:function(){OpenLayers.Ajax.activeRequestCount--}}),OpenLayers.Ajax.Base=OpenLayers.Class({initialize:function(e){this.options={method:"post",asynchronous:!0,contentType:"application/xml",parameters:""},OpenLayers.Util.extend(this.options,e||{}),this.options.method=this.options.method.toLowerCase(),"string"==typeof this.options.parameters&&(this.options.parameters=OpenLayers.Util.getParameters(this.options.parameters))}}),OpenLayers.Ajax.Request=OpenLayers.Class(OpenLayers.Ajax.Base,{_complete:!1,initialize:function(e,t){OpenLayers.Ajax.Base.prototype.initialize.apply(this,[t]),OpenLayers.ProxyHost&&OpenLayers.String.startsWith(e,"http")&&(e=OpenLayers.ProxyHost+encodeURIComponent(e)),this.transport=OpenLayers.Ajax.getTransport(),this.request(e)},request:function(e){this.url=e,this.method=this.options.method;var t=OpenLayers.Util.extend({},this.options.parameters);"get"!=this.method&&"post"!=this.method&&(t._method=this.method,this.method="post"),this.parameters=t,(t=OpenLayers.Util.getParameterString(t))&&("get"==this.method?this.url+=(this.url.indexOf("?")>-1?"&":"?")+t:/Konqueror|Safari|KHTML/.test(navigator.userAgent)&&(t+="&_="));try{var i=new OpenLayers.Ajax.Response(this);this.options.onCreate&&this.options.onCreate(i),OpenLayers.Ajax.Responders.dispatch("onCreate",this,i),this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous),this.options.asynchronous&&window.setTimeout(OpenLayers.Function.bind(this.respondToReadyState,this,1),10),this.transport.onreadystatechange=OpenLayers.Function.bind(this.onStateChange,this),this.setRequestHeaders(),this.body="post"==this.method?this.options.postBody||t:null,this.transport.send(this.body),!this.options.asynchronous&&this.transport.overrideMimeType&&this.onStateChange()}catch(s){this.dispatchException(s)}},onStateChange:function(){var e=this.transport.readyState;e>1&&(4!=e||!this._complete)&&this.respondToReadyState(this.transport.readyState)},setRequestHeaders:function(){var e={"X-Requested-With":"XMLHttpRequest",Accept:"text/javascript, text/html, application/xml, text/xml, */*",OpenLayers:!0};if("post"==this.method&&(e["Content-type"]=this.options.contentType+(this.options.encoding?"; charset="+this.options.encoding:""),this.transport.overrideMimeType&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005&&(e.Connection="close")),"object"==typeof this.options.requestHeaders){var t=this.options.requestHeaders;if("function"==typeof t.push)for(var i=0,s=t.length;s>i;i+=2)e[t[i]]=t[i+1];else for(var i in t)e[i]=t[i]}for(var n in e)this.transport.setRequestHeader(n,e[n])},success:function(){var e=this.getStatus();return!e||e>=200&&300>e},getStatus:function(){try{return this.transport.status||0}catch(e){return 0}},respondToReadyState:function(e){var t=OpenLayers.Ajax.Request.Events[e],i=new OpenLayers.Ajax.Response(this);if("Complete"==t){try{this._complete=!0,(this.options["on"+i.status]||this.options["on"+(this.success()?"Success":"Failure")]||OpenLayers.Ajax.emptyFunction)(i)}catch(s){this.dispatchException(s)}i.getHeader("Content-type")}try{(this.options["on"+t]||OpenLayers.Ajax.emptyFunction)(i),OpenLayers.Ajax.Responders.dispatch("on"+t,this,i)}catch(s){this.dispatchException(s)}"Complete"==t&&(this.transport.onreadystatechange=OpenLayers.Ajax.emptyFunction)},getHeader:function(e){try{return this.transport.getResponseHeader(e)}catch(t){return null}},dispatchException:function(e){var t=this.options.onException;if(t)t(this,e),OpenLayers.Ajax.Responders.dispatch("onException",this,e);else{for(var i=!1,s=OpenLayers.Ajax.Responders.responders,n=0;n<s.length;n++)if(s[n].onException){i=!0;break}if(!i)throw e;OpenLayers.Ajax.Responders.dispatch("onException",this,e)}}}),OpenLayers.Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"],OpenLayers.Ajax.Response=OpenLayers.Class({status:0,statusText:"",initialize:function(e){this.request=e;var t=this.transport=e.transport,i=this.readyState=t.readyState;if((i>2&&(!window.attachEvent||window.opera)||4==i)&&(this.status=this.getStatus(),this.statusText=this.getStatusText(),this.responseText=null==t.responseText?"":String(t.responseText)),4==i){var s=t.responseXML;this.responseXML=void 0===s?null:s}},getStatus:OpenLayers.Ajax.Request.prototype.getStatus,getStatusText:function(){try{return this.transport.statusText||""}catch(e){return""}},getHeader:OpenLayers.Ajax.Request.prototype.getHeader,getResponseHeader:function(e){return this.transport.getResponseHeader(e)}}),OpenLayers.Ajax.getElementsByTagNameNS=function(e,t,i,s){var n=null;return n=e.getElementsByTagNameNS?e.getElementsByTagNameNS(t,s):e.getElementsByTagName(i+":"+s)},OpenLayers.Ajax.serializeXMLToString=function(e){var t=new XMLSerializer,i=t.serializeToString(e);return i},OpenLayers.Util.extend(OpenLayers.Element,{hide:function(){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"element.style.display = 'none';"}));for(var e=0,t=arguments.length;t>e;e++){var i=OpenLayers.Util.getElement(arguments[e]);i&&(i.style.display="none")}},show:function(){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"element.style.display = '';"}));for(var e=0,t=arguments.length;t>e;e++){var i=OpenLayers.Util.getElement(arguments[e]);i&&(i.style.display="")}},getDimensions:function(e){if(e=OpenLayers.Util.getElement(e),"none"!=OpenLayers.Element.getStyle(e,"display"))return{width:e.offsetWidth,height:e.offsetHeight};var t=e.style,i=t.visibility,s=t.position,n=t.display;t.visibility="hidden",t.position="absolute",t.display="";var r=e.clientWidth,a=e.clientHeight;return t.display=n,t.position=s,t.visibility=i,{width:r,height:a}}}),String.prototype.startsWith||(String.prototype.startsWith=function(e){return OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.String.startsWith"})),OpenLayers.String.startsWith(this,e)}),String.prototype.contains||(String.prototype.contains=function(e){return OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.String.contains"})),OpenLayers.String.contains(this,e)}),String.prototype.trim||(String.prototype.trim=function(){return OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.String.trim"})),OpenLayers.String.trim(this)}),String.prototype.camelize||(String.prototype.camelize=function(){return OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.String.camelize"})),OpenLayers.String.camelize(this)}),Function.prototype.bind||(Function.prototype.bind=function(){return OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.Function.bind"})),Array.prototype.unshift.apply(arguments,[this]),OpenLayers.Function.bind.apply(null,arguments)}),Function.prototype.bindAsEventListener||(Function.prototype.bindAsEventListener=function(e){return OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.Function.bindAsEventListener"})),OpenLayers.Function.bindAsEventListener(this,e)}),window.Event)OpenLayers.Util.applyDefaults(window.Event,OpenLayers.Event);else var Event=OpenLayers.Event;OpenLayers.Util.extend(OpenLayers.Tile.prototype,{getBoundsFromBaseLayer:function(e){var t=OpenLayers.i18n("reprojectDeprecated",{layerName:this.layer.name});OpenLayers.Console.warn(t);var i=this.layer.map.getLonLatFromLayerPx(e),s=e.clone();s.x+=this.size.w,s.y+=this.size.h;var n=this.layer.map.getLonLatFromLayerPx(s);i.lon>n.lon&&(i.lon<0?i.lon=-180-(i.lon+180):n.lon=180+n.lon+180);var r=new OpenLayers.Bounds(i.lon,n.lat,n.lon,i.lat);return r}}),OpenLayers.Control.MouseDefaults=OpenLayers.Class(OpenLayers.Control,{performedDrag:!1,wheelObserver:null,initialize:function(){OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.handler&&this.handler.destroy(),this.handler=null,this.map.events.un({click:this.defaultClick,dblclick:this.defaultDblClick,mousedown:this.defaultMouseDown,mouseup:this.defaultMouseUp,mousemove:this.defaultMouseMove,mouseout:this.defaultMouseOut,scope:this}),OpenLayers.Event.stopObserving(window,"DOMMouseScroll",this.wheelObserver),OpenLayers.Event.stopObserving(window,"mousewheel",this.wheelObserver),OpenLayers.Event.stopObserving(document,"mousewheel",this.wheelObserver),this.wheelObserver=null,OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){this.map.events.on({click:this.defaultClick,dblclick:this.defaultDblClick,mousedown:this.defaultMouseDown,mouseup:this.defaultMouseUp,mousemove:this.defaultMouseMove,mouseout:this.defaultMouseOut,scope:this}),this.registerWheelEvents()},registerWheelEvents:function(){this.wheelObserver=OpenLayers.Function.bindAsEventListener(this.onWheelEvent,this),OpenLayers.Event.observe(window,"DOMMouseScroll",this.wheelObserver),OpenLayers.Event.observe(window,"mousewheel",this.wheelObserver),OpenLayers.Event.observe(document,"mousewheel",this.wheelObserver)},defaultClick:function(e){if(OpenLayers.Event.isLeftClick(e)){var t=!this.performedDrag;return this.performedDrag=!1,t}},defaultDblClick:function(e){var t=this.map.getLonLatFromViewPortPx(e.xy);return this.map.setCenter(t,this.map.zoom+1),OpenLayers.Event.stop(e),!1},defaultMouseDown:function(e){OpenLayers.Event.isLeftClick(e)&&(this.mouseDragStart=e.xy.clone(),this.performedDrag=!1,e.shiftKey&&(this.map.div.style.cursor="crosshair",this.zoomBox=OpenLayers.Util.createDiv("zoomBox",this.mouseDragStart,null,null,"absolute","2px solid red"),this.zoomBox.style.backgroundColor="white",this.zoomBox.style.filter="alpha(opacity=50)",this.zoomBox.style.opacity="0.50",this.zoomBox.style.fontSize="1px",this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1,this.map.viewPortDiv.appendChild(this.zoomBox)),document.onselectstart=OpenLayers.Function.False,OpenLayers.Event.stop(e))},defaultMouseMove:function(e){if(this.mousePosition=e.xy.clone(),null!=this.mouseDragStart){if(this.zoomBox){var t=Math.abs(this.mouseDragStart.x-e.xy.x),i=Math.abs(this.mouseDragStart.y-e.xy.y);this.zoomBox.style.width=Math.max(1,t)+"px",this.zoomBox.style.height=Math.max(1,i)+"px",e.xy.x<this.mouseDragStart.x&&(this.zoomBox.style.left=e.xy.x+"px"),e.xy.y<this.mouseDragStart.y&&(this.zoomBox.style.top=e.xy.y+"px")}else{var t=this.mouseDragStart.x-e.xy.x,i=this.mouseDragStart.y-e.xy.y,s=this.map.getSize(),n=new OpenLayers.Pixel(s.w/2+t,s.h/2+i),r=this.map.getLonLatFromViewPortPx(n);this.map.setCenter(r,null,!0),this.mouseDragStart=e.xy.clone(),this.map.div.style.cursor="move"}this.performedDrag=!0}},defaultMouseUp:function(e){OpenLayers.Event.isLeftClick(e)&&(this.zoomBox?this.zoomBoxEnd(e):this.performedDrag&&this.map.setCenter(this.map.center),document.onselectstart=null,this.mouseDragStart=null,this.map.div.style.cursor="")},defaultMouseOut:function(e){null!=this.mouseDragStart&&OpenLayers.Util.mouseLeft(e,this.map.viewPortDiv)&&(this.zoomBox&&this.removeZoomBox(),this.mouseDragStart=null)},defaultWheelUp:function(e){this.map.getZoom()<=this.map.getNumZoomLevels()&&this.map.setCenter(this.map.getLonLatFromPixel(e.xy),this.map.getZoom()+1)},defaultWheelDown:function(e){this.map.getZoom()>0&&this.map.setCenter(this.map.getLonLatFromPixel(e.xy),this.map.getZoom()-1)},zoomBoxEnd:function(e){if(null!=this.mouseDragStart){if(Math.abs(this.mouseDragStart.x-e.xy.x)>5||Math.abs(this.mouseDragStart.y-e.xy.y)>5){var t=this.map.getLonLatFromViewPortPx(this.mouseDragStart),i=this.map.getLonLatFromViewPortPx(e.xy),s=Math.max(t.lat,i.lat),n=Math.min(t.lat,i.lat),r=Math.min(t.lon,i.lon),a=Math.max(t.lon,i.lon),o=new OpenLayers.Bounds(r,n,a,s);this.map.zoomToExtent(o)}else{var i=this.map.getLonLatFromViewPortPx(e.xy);this.map.setCenter(new OpenLayers.LonLat(i.lon,i.lat),this.map.getZoom()+1)}this.removeZoomBox()}},removeZoomBox:function(){this.map.viewPortDiv.removeChild(this.zoomBox),this.zoomBox=null},onWheelEvent:function(e){for(var t=!1,i=OpenLayers.Event.element(e);null!=i;){if(this.map&&i==this.map.div){t=!0;break}i=i.parentNode}if(t){var s=0;e||(e=window.event),e.wheelDelta?(s=e.wheelDelta/120,window.opera&&window.opera.version()<9.2&&(s=-s)):e.detail&&(s=-e.detail/3),s&&(e.xy=this.mousePosition,0>s?this.defaultWheelDown(e):this.defaultWheelUp(e)),OpenLayers.Event.stop(e)}},CLASS_NAME:"OpenLayers.Control.MouseDefaults"}),OpenLayers.Control.MouseToolbar=OpenLayers.Class(OpenLayers.Control.MouseDefaults,{mode:null,buttons:null,direction:"vertical",buttonClicked:null,initialize:function(e,t){OpenLayers.Control.prototype.initialize.apply(this,arguments),this.position=new OpenLayers.Pixel(OpenLayers.Control.MouseToolbar.X,OpenLayers.Control.MouseToolbar.Y),e&&(this.position=e),t&&(this.direction=t),this.measureDivs=[]},destroy:function(){for(var e in this.buttons){var t=this.buttons[e];t.map=null,t.events.destroy()}OpenLayers.Control.MouseDefaults.prototype.destroy.apply(this,arguments)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments),OpenLayers.Control.MouseDefaults.prototype.draw.apply(this,arguments),this.buttons={};var e=new OpenLayers.Size(28,28),t=new OpenLayers.Pixel(OpenLayers.Control.MouseToolbar.X,0);return this._addButton("zoombox","drag-rectangle-off.png","drag-rectangle-on.png",t,e,"Shift->Drag to zoom to area"),t=t.add("vertical"==this.direction?0:e.w,"vertical"==this.direction?e.h:0),this._addButton("pan","panning-hand-off.png","panning-hand-on.png",t,e,"Drag the map to pan."),t=t.add("vertical"==this.direction?0:e.w,"vertical"==this.direction?e.h:0),this.switchModeTo("pan"),this.div},_addButton:function(e,t,i,s,n,r){var a=OpenLayers.Util.getImageLocation(t),o=OpenLayers.Util.getImageLocation(i),l=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MouseToolbar_"+e,s,n,a,"absolute");return this.div.appendChild(l),l.imgLocation=a,l.activeImgLocation=o,l.events=new OpenLayers.Events(this,l,null,!0),l.events.on({mousedown:this.buttonDown,mouseup:this.buttonUp,dblclick:OpenLayers.Event.stop,scope:this}),l.action=e,l.title=r,l.alt=r,l.map=this.map,this.buttons[e]=l,l},buttonDown:function(e){OpenLayers.Event.isLeftClick(e)&&(this.buttonClicked=e.element.action,OpenLayers.Event.stop(e))},buttonUp:function(e){OpenLayers.Event.isLeftClick(e)&&null!=this.buttonClicked&&(this.buttonClicked==e.element.action&&this.switchModeTo(e.element.action),OpenLayers.Event.stop(e),this.buttonClicked=null)},defaultDblClick:function(e){this.switchModeTo("pan"),this.performedDrag=!1;var t=this.map.getLonLatFromViewPortPx(e.xy);return this.map.setCenter(t,this.map.zoom+1),OpenLayers.Event.stop(e),!1},defaultMouseDown:function(e){if(OpenLayers.Event.isLeftClick(e)){switch(this.mouseDragStart=e.xy.clone(),this.performedDrag=!1,this.startViaKeyboard=!1,e.shiftKey&&"zoombox"!=this.mode?(this.switchModeTo("zoombox"),this.startViaKeyboard=!0):e.altKey&&"measure"!=this.mode?this.switchModeTo("measure"):this.mode||this.switchModeTo("pan"),this.mode){case"zoombox":this.map.div.style.cursor="crosshair",this.zoomBox=OpenLayers.Util.createDiv("zoomBox",this.mouseDragStart,null,null,"absolute","2px solid red"),this.zoomBox.style.backgroundColor="white",this.zoomBox.style.filter="alpha(opacity=50)",this.zoomBox.style.opacity="0.50",this.zoomBox.style.fontSize="1px",this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1,this.map.viewPortDiv.appendChild(this.zoomBox),this.performedDrag=!0;break;case"measure":var t="";if(this.measureStart){var i=this.map.getLonLatFromViewPortPx(this.mouseDragStart);t=OpenLayers.Util.distVincenty(this.measureStart,i),t=Math.round(100*t)/100,t+="km",this.measureStartBox=this.measureBox}this.measureStart=this.map.getLonLatFromViewPortPx(this.mouseDragStart),this.measureBox=OpenLayers.Util.createDiv(null,this.mouseDragStart.add(-2-parseInt(this.map.layerContainerDiv.style.left),-2-parseInt(this.map.layerContainerDiv.style.top)),null,null,"absolute"),this.measureBox.style.width="4px",this.measureBox.style.height="4px",this.measureBox.style.fontSize="1px",this.measureBox.style.backgroundColor="red",this.measureBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1,this.map.layerContainerDiv.appendChild(this.measureBox),t&&(this.measureBoxDistance=OpenLayers.Util.createDiv(null,this.mouseDragStart.add(-2-parseInt(this.map.layerContainerDiv.style.left),2-parseInt(this.map.layerContainerDiv.style.top)),null,null,"absolute"),this.measureBoxDistance.innerHTML=t,this.measureBoxDistance.style.zIndex=this.map.Z_INDEX_BASE.Popup-1,this.map.layerContainerDiv.appendChild(this.measureBoxDistance),this.measureDivs.push(this.measureBoxDistance)),this.measureBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1,this.map.layerContainerDiv.appendChild(this.measureBox),this.measureDivs.push(this.measureBox);break;default:this.map.div.style.cursor="move"}document.onselectstart=OpenLayers.Function.False,OpenLayers.Event.stop(e)}},switchModeTo:function(e){if(e!=this.mode){if(this.mode&&this.buttons[this.mode]&&OpenLayers.Util.modifyAlphaImageDiv(this.buttons[this.mode],null,null,null,this.buttons[this.mode].imgLocation),"measure"==this.mode&&"measure"!=e){for(var t=0,i=this.measureDivs.length;i>t;t++)this.measureDivs[t]&&this.map.layerContainerDiv.removeChild(this.measureDivs[t]);this.measureDivs=[],this.measureStart=null}switch(this.mode=e,this.buttons[e]&&OpenLayers.Util.modifyAlphaImageDiv(this.buttons[e],null,null,null,this.buttons[e].activeImgLocation),this.mode){case"zoombox":this.map.div.style.cursor="crosshair";break;default:this.map.div.style.cursor=""}}},leaveMode:function(){this.switchModeTo("pan")},defaultMouseMove:function(e){if(null!=this.mouseDragStart){switch(this.mode){case"zoombox":var t=Math.abs(this.mouseDragStart.x-e.xy.x),i=Math.abs(this.mouseDragStart.y-e.xy.y);this.zoomBox.style.width=Math.max(1,t)+"px",this.zoomBox.style.height=Math.max(1,i)+"px",e.xy.x<this.mouseDragStart.x&&(this.zoomBox.style.left=e.xy.x+"px"),e.xy.y<this.mouseDragStart.y&&(this.zoomBox.style.top=e.xy.y+"px");break;default:var t=this.mouseDragStart.x-e.xy.x,i=this.mouseDragStart.y-e.xy.y,s=this.map.getSize(),n=new OpenLayers.Pixel(s.w/2+t,s.h/2+i),r=this.map.getLonLatFromViewPortPx(n);this.map.setCenter(r,null,!0),this.mouseDragStart=e.xy.clone()}this.performedDrag=!0}},defaultMouseUp:function(e){if(OpenLayers.Event.isLeftClick(e)){switch(this.mode){case"zoombox":this.zoomBoxEnd(e),this.startViaKeyboard&&this.leaveMode();break;case"pan":this.performedDrag&&this.map.setCenter(this.map.center)}document.onselectstart=null,this.mouseDragStart=null,this.map.div.style.cursor="default"}},defaultMouseOut:function(e){null!=this.mouseDragStart&&OpenLayers.Util.mouseLeft(e,this.map.viewPortDiv)&&(this.zoomBox&&(this.removeZoomBox(),this.startViaKeyboard&&this.leaveMode()),this.mouseDragStart=null,this.map.div.style.cursor="default")},defaultClick:function(){return this.performedDrag?(this.performedDrag=!1,!1):void 0},CLASS_NAME:"OpenLayers.Control.MouseToolbar"}),OpenLayers.Control.MouseToolbar.X=6,OpenLayers.Control.MouseToolbar.Y=300,OpenLayers.Util.extend(OpenLayers.Layer.Grid.prototype,{getGridBounds:function(){var e="The getGridBounds() function is deprecated. It will be removed in 3.0. Please use getTilesBounds() instead.";return OpenLayers.Console.warn(e),this.getTilesBounds()}}),OpenLayers.Util.extend(OpenLayers.Format.XML.prototype,{concatChildValues:function(e,t){for(var i,s="",n=e.firstChild;n;)i=n.nodeValue,i&&(s+=i),n=n.nextSibling;return""==s&&void 0!=t&&(s=t),s}}),OpenLayers.Layer.WMS.Post=OpenLayers.Class(OpenLayers.Layer.WMS,{unsupportedBrowsers:["mozilla","firefox","opera"],SUPPORTED_TRANSITIONS:[],usePost:null,initialize:function(e,t,i,s){var n=[];n.push(e,t,i,s),OpenLayers.Layer.WMS.prototype.initialize.apply(this,n),this.usePost=-1==OpenLayers.Util.indexOf(this.unsupportedBrowsers,OpenLayers.BROWSER_NAME)},addTile:function(e,t){return new OpenLayers.Tile.Image(this,t,e,null,this.tileSize,{maxGetUrlLength:this.usePost?0:null})},CLASS_NAME:"OpenLayers.Layer.WMS.Post"}),OpenLayers.Layer.WMS.Untiled=OpenLayers.Class(OpenLayers.Layer.WMS,{singleTile:!0,initialize:function(){OpenLayers.Layer.WMS.prototype.initialize.apply(this,arguments);var e="The OpenLayers.Layer.WMS.Untiled class is deprecated and will be removed in 3.0. Instead, you should use the normal OpenLayers.Layer.WMS class, passing it the option 'singleTile' as true.";OpenLayers.Console.warn(e)},clone:function(e){return null==e&&(e=new OpenLayers.Layer.WMS.Untiled(this.name,this.url,this.params,this.getOptions())),e=OpenLayers.Layer.WMS.prototype.clone.apply(this,[e])},CLASS_NAME:"OpenLayers.Layer.WMS.Untiled"}),OpenLayers.Layer.MapServer.Untiled=OpenLayers.Class(OpenLayers.Layer.MapServer,{singleTile:!0,initialize:function(){OpenLayers.Layer.MapServer.prototype.initialize.apply(this,arguments);var e="The OpenLayers.Layer.MapServer.Untiled class is deprecated and will be removed in 3.0. Instead, you should use the normal OpenLayers.Layer.MapServer class, passing it the option 'singleTile' as true.";OpenLayers.Console.warn(e)},clone:function(e){return null==e&&(e=new OpenLayers.Layer.MapServer.Untiled(this.name,this.url,this.params,this.getOptions())),e=OpenLayers.Layer.MapServer.prototype.clone.apply(this,[e])},CLASS_NAME:"OpenLayers.Layer.MapServer.Untiled"}),OpenLayers.Tile.WFS=OpenLayers.Class(OpenLayers.Tile,{features:null,url:null,request:null,initialize:function(e,t,i,s){OpenLayers.Tile.prototype.initialize.apply(this,arguments),this.url=s,this.features=[]},destroy:function(){OpenLayers.Tile.prototype.destroy.apply(this,arguments),this.destroyAllFeatures(),this.features=null,this.url=null,this.request&&(this.request.abort(),this.request=null)},clear:function(){this.destroyAllFeatures()},draw:function(){OpenLayers.Tile.prototype.draw.apply(this,arguments)&&(this.isLoading?this.events.triggerEvent("reload"):(this.isLoading=!0,this.events.triggerEvent("loadstart")),this.loadFeaturesForRegion(this.requestSuccess))},loadFeaturesForRegion:function(e,t){this.request&&this.request.abort(),this.request=OpenLayers.Request.GET({url:this.url,success:e,failure:t,scope:this})},requestSuccess:function(e){if(this.features){var t=e.responseXML;if(t&&t.documentElement||(t=e.responseText),this.layer.vectorMode)this.layer.addFeatures(this.layer.formatObject.read(t));else{var i=new OpenLayers.Format.XML;"string"==typeof t&&(t=i.read(t));var s=i.getElementsByTagNameNS(t,"http://www.opengis.net/gml","featureMember");this.addResults(s)}}this.events&&this.events.triggerEvent("loadend"),this.request=null},addResults:function(e){for(var t=0;t<e.length;t++){var i=new this.layer.featureClass(this.layer,e[t]);this.features.push(i)}},destroyAllFeatures:function(){for(;this.features.length>0;){var e=this.features.shift();e.destroy()}},CLASS_NAME:"OpenLayers.Tile.WFS"}),OpenLayers.Feature.WFS=OpenLayers.Class(OpenLayers.Feature,{initialize:function(e,t){var i=arguments,s=this.processXMLNode(t);i=new Array(e,s.lonlat,s),OpenLayers.Feature.prototype.initialize.apply(this,i),this.createMarker(),this.layer.addMarker(this.marker)},destroy:function(){null!=this.marker&&this.layer.removeMarker(this.marker),OpenLayers.Feature.prototype.destroy.apply(this,arguments)},processXMLNode:function(e){var t=OpenLayers.Ajax.getElementsByTagNameNS(e,"http://www.opengis.net/gml","gml","Point"),i=OpenLayers.Util.getXmlNodeValue(OpenLayers.Ajax.getElementsByTagNameNS(t[0],"http://www.opengis.net/gml","gml","coordinates")[0]),s=i.split(",");return{lonlat:new OpenLayers.LonLat(parseFloat(s[0]),parseFloat(s[1])),id:null}},CLASS_NAME:"OpenLayers.Feature.WFS"}),OpenLayers.Layer.WFS=OpenLayers.Class(OpenLayers.Layer.Vector,OpenLayers.Layer.Markers,{isBaseLayer:!1,tile:null,ratio:2,DEFAULT_PARAMS:{service:"WFS",version:"1.0.0",request:"GetFeature"},featureClass:null,format:null,formatObject:null,formatOptions:null,vectorMode:!0,encodeBBOX:!1,extractAttributes:!1,initialize:function(e,t,i,s){void 0==s&&(s={}),!s.featureClass&&OpenLayers.Layer.Vector&&OpenLayers.Feature.Vector||(this.vectorMode=!1),i=OpenLayers.Util.upperCaseObject(i),OpenLayers.Util.extend(s,{reportError:!1});var n=[];n.push(e,s),OpenLayers.Layer.Vector.prototype.initialize.apply(this,n),this.renderer&&this.vectorMode||(this.vectorMode=!1,s.featureClass||(s.featureClass=OpenLayers.Feature.WFS),OpenLayers.Layer.Markers.prototype.initialize.apply(this,n)),this.params&&this.params.typename&&!this.options.typename&&(this.options.typename=this.params.typename),this.options.geometry_column||(this.options.geometry_column="the_geom"),this.params=OpenLayers.Util.applyDefaults(i,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS)),this.url=t},destroy:function(){this.vectorMode?OpenLayers.Layer.Vector.prototype.destroy.apply(this,arguments):OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments),this.tile&&this.tile.destroy(),this.tile=null,this.ratio=null,this.featureClass=null,this.format=null,this.formatObject&&this.formatObject.destroy&&this.formatObject.destroy(),this.formatObject=null,this.formatOptions=null,this.vectorMode=null,this.encodeBBOX=null,this.extractAttributes=null},setMap:function(){if(this.vectorMode){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments);var e={extractAttributes:this.extractAttributes};OpenLayers.Util.extend(e,this.formatOptions),this.map&&!this.projection.equals(this.map.getProjectionObject())&&(e.externalProjection=this.projection,e.internalProjection=this.map.getProjectionObject()),this.formatObject=this.format?new this.format(e):new OpenLayers.Format.GML(e)}else OpenLayers.Layer.Markers.prototype.setMap.apply(this,arguments)},moveTo:function(e,t,i){if(this.vectorMode?OpenLayers.Layer.Vector.prototype.moveTo.apply(this,arguments):OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments),i)return!1;if(t&&this.vectorMode&&this.renderer.clear(),this.options.minZoomLevel&&(OpenLayers.Console.warn(OpenLayers.i18n("minZoomLevelError")),this.map.getZoom()<this.options.minZoomLevel))return null;null==e&&(e=this.map.getExtent());var s=null==this.tile,n=!s&&!this.tile.bounds.containsBounds(e);if(t||s||!i&&n){var r=e.getCenterLonLat(),a=e.getWidth()*this.ratio,o=e.getHeight()*this.ratio,l=new OpenLayers.Bounds(r.lon-a/2,r.lat-o/2,r.lon+a/2,r.lat+o/2),h=this.map.getSize();h.w=h.w*this.ratio,h.h=h.h*this.ratio;var u=new OpenLayers.LonLat(l.left,l.top),c=this.map.getLayerPxFromLonLat(u),d=this.getFullRequestString(),p=null,f=this.params.filter||this.params.FILTER;if(p=f?{FILTER:f}:{BBOX:this.encodeBBOX?l.toBBOX():l.toArray()},this.map&&!this.projection.equals(this.map.getProjectionObject())){var m=l.clone();m.transform(this.map.getProjectionObject(),this.projection),f||(p.BBOX=this.encodeBBOX?m.toBBOX():m.toArray())}d+="&"+OpenLayers.Util.getParameterString(p),this.tile?(this.vectorMode?(this.destroyFeatures(),this.renderer.clear()):this.clearMarkers(),this.removeTileMonitoringHooks(this.tile),this.tile.destroy(),this.tile=null,this.tile=new OpenLayers.Tile.WFS(this,c,l,d,h),this.addTileMonitoringHooks(this.tile),this.tile.draw()):(this.tile=new OpenLayers.Tile.WFS(this,c,l,d,h),this.addTileMonitoringHooks(this.tile),this.tile.draw())}},addTileMonitoringHooks:function(e){e.onLoadStart=function(){this==this.layer.tile&&this.layer.events.triggerEvent("loadstart")},e.events.register("loadstart",e,e.onLoadStart),e.onLoadEnd=function(){this==this.layer.tile&&(this.layer.events.triggerEvent("tileloaded"),this.layer.events.triggerEvent("loadend"))},e.events.register("loadend",e,e.onLoadEnd),e.events.register("unload",e,e.onLoadEnd)
},removeTileMonitoringHooks:function(e){e.unload(),e.events.un({loadstart:e.onLoadStart,loadend:e.onLoadEnd,unload:e.onLoadEnd,scope:e})},onMapResize:function(){this.vectorMode?OpenLayers.Layer.Vector.prototype.onMapResize.apply(this,arguments):OpenLayers.Layer.Markers.prototype.onMapResize.apply(this,arguments)},display:function(){this.vectorMode?OpenLayers.Layer.Vector.prototype.display.apply(this,arguments):OpenLayers.Layer.Markers.prototype.display.apply(this,arguments)},mergeNewParams:function(e){var t=OpenLayers.Util.upperCaseObject(e),i=[t];return OpenLayers.Layer.HTTPRequest.prototype.mergeNewParams.apply(this,i)},clone:function(e){return null==e&&(e=new OpenLayers.Layer.WFS(this.name,this.url,this.params,this.getOptions())),e=this.vectorMode?OpenLayers.Layer.Vector.prototype.clone.apply(this,[e]):OpenLayers.Layer.Markers.prototype.clone.apply(this,[e])},getFullRequestString:function(){var e=this.projection.getCode()||this.map.getProjection();return this.params.SRS="none"==e?null:e,OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},commit:function(){if(!this.writer){var e={};this.map&&!this.projection.equals(this.map.getProjectionObject())&&(e.externalProjection=this.projection,e.internalProjection=this.map.getProjectionObject()),this.writer=new OpenLayers.Format.WFS(e,this)}var t=this.writer.write(this.features);OpenLayers.Request.POST({url:this.url,data:t,success:this.commitSuccess,failure:this.commitFailure,scope:this})},commitSuccess:function(e){var t=e.responseText;if(-1!=t.indexOf("SUCCESS")){this.commitReport(OpenLayers.i18n("commitSuccess",{response:t}));for(var i=0;i<this.features.length;i++)this.features[i].state=null}else(-1!=t.indexOf("FAILED")||-1!=t.indexOf("Exception"))&&this.commitReport(OpenLayers.i18n("commitFailed",{response:t}))},commitFailure:function(){},commitReport:function(e){OpenLayers.Console.userError(e)},refresh:function(){this.tile&&(this.vectorMode?(this.renderer.clear(),this.features.length=0):(this.clearMarkers(),this.markers.length=0),this.tile.draw())},getDataExtent:function(){var e;return e=this.vectorMode?OpenLayers.Layer.Vector.prototype.getDataExtent.apply(this):OpenLayers.Layer.Markers.prototype.getDataExtent.apply(this)},setOpacity:function(e){this.vectorMode?OpenLayers.Layer.Vector.prototype.setOpacity.apply(this,[e]):OpenLayers.Layer.Markers.prototype.setOpacity.apply(this,[e])},CLASS_NAME:"OpenLayers.Layer.WFS"}),OpenLayers.Layer.VirtualEarth=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:1,MAX_ZOOM_LEVEL:19,RESOLUTIONS:[1.40625,.703125,.3515625,.17578125,.087890625,.0439453125,.02197265625,.010986328125,.0054931640625,.00274658203125,.001373291015625,.0006866455078125,.00034332275390625,.000171661376953125,858306884765625e-19,4291534423828125e-20,2145767211914062e-20,1072883605957031e-20,536441802978515e-20],type:null,wrapDateLine:!0,sphericalMercator:!1,animationEnabled:!0,initialize:function(){OpenLayers.Layer.EventPane.prototype.initialize.apply(this,arguments),OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,arguments),this.sphericalMercator&&(OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator),this.initMercatorParameters())},loadMapObject:function(){var e=OpenLayers.Util.createDiv(this.name),t=this.map.getSize();e.style.width=t.w+"px",e.style.height=t.h+"px",this.div.appendChild(e);try{this.mapObject=new VEMap(this.name)}catch(i){}if(null!=this.mapObject){try{this.mapObject.LoadMap(null,null,this.type,!0),this.mapObject.AttachEvent("onmousedown",OpenLayers.Function.True)}catch(i){}this.mapObject.HideDashboard(),"function"==typeof this.mapObject.SetAnimationEnabled&&this.mapObject.SetAnimationEnabled(this.animationEnabled)}this.mapObject&&this.mapObject.vemapcontrol&&this.mapObject.vemapcontrol.PanMap&&"function"==typeof this.mapObject.vemapcontrol.PanMap||(this.dragPanMapObject=null)},onMapResize:function(){this.mapObject.Resize(this.map.size.w,this.map.size.h)},getWarningHTML:function(){return OpenLayers.i18n("getLayerWarning",{layerType:"VE",layerLib:"VirtualEarth"})},setMapObjectCenter:function(e,t){this.mapObject.SetCenterAndZoom(e,t)},getMapObjectCenter:function(){return this.mapObject.GetCenter()},dragPanMapObject:function(e,t){this.mapObject.vemapcontrol.PanMap(e,-t)},getMapObjectZoom:function(){return this.mapObject.GetZoomLevel()},getMapObjectLonLatFromMapObjectPixel:function(e){return"undefined"!=typeof VEPixel?this.mapObject.PixelToLatLong(e):this.mapObject.PixelToLatLong(e.x,e.y)},getMapObjectPixelFromMapObjectLonLat:function(e){return this.mapObject.LatLongToPixel(e)},getLongitudeFromMapObjectLonLat:function(e){return this.sphericalMercator?this.forwardMercator(e.Longitude,e.Latitude).lon:e.Longitude},getLatitudeFromMapObjectLonLat:function(e){return this.sphericalMercator?this.forwardMercator(e.Longitude,e.Latitude).lat:e.Latitude},getMapObjectLonLatFromLonLat:function(e,t){var i;if(this.sphericalMercator){var s=this.inverseMercator(e,t);i=new VELatLong(s.lat,s.lon)}else i=new VELatLong(t,e);return i},getXFromMapObjectPixel:function(e){return e.x},getYFromMapObjectPixel:function(e){return e.y},getMapObjectPixelFromXY:function(e,t){return"undefined"!=typeof VEPixel?new VEPixel(e,t):new Msn.VE.Pixel(e,t)},CLASS_NAME:"OpenLayers.Layer.VirtualEarth"}),/*
 * Copyright 2007, Google Inc.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 *  1. Redistributions of source code must retain the above copyright notice,
 *     this list of conditions and the following disclaimer.
 *  2. Redistributions in binary form must reproduce the above copyright notice,
 *     this list of conditions and the following disclaimer in the documentation
 *     and/or other materials provided with the distribution.
 *  3. Neither the name of Google Inc. nor the names of its contributors may be
 *     used to endorse or promote products derived from this software without
 *     specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED
 * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO
 * EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;
 * OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
 * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
 * OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
 * ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * Sets up google.gears.*, which is *the only* supported way to access Gears.
 *
 * Circumvent this file at your own risk!
 *
 * In the future, Gears may automatically define google.gears.* without this
 * file. Gears may use these objects to transparently fix bugs and compatibility
 * issues. Applications that use the code below will continue to work seamlessly
 * when that happens.
 */
function(){if(!window.google||!google.gears){var e=null;if("undefined"!=typeof GearsFactory)e=new GearsFactory;else try{e=new ActiveXObject("Gears.Factory"),-1!=e.getBuildInfo().indexOf("ie_mobile")&&e.privateSetGlobalObject(this)}catch(t){"undefined"!=typeof navigator.mimeTypes&&navigator.mimeTypes["application/x-googlegears"]&&(e=document.createElement("object"),e.style.display="none",e.width=0,e.height=0,e.type="application/x-googlegears",document.documentElement.appendChild(e))}e&&(window.google||(google={}),google.gears||(google.gears={factory:e}))}}(),OpenLayers.Protocol.SQL=OpenLayers.Class(OpenLayers.Protocol,{databaseName:"ol",tableName:"ol_vector_features",postReadFiltering:!0,initialize:function(e){OpenLayers.Protocol.prototype.initialize.apply(this,[e])},destroy:function(){OpenLayers.Protocol.prototype.destroy.apply(this)},supported:function(){return!1},evaluateFilter:function(e,t){return t&&this.postReadFiltering?t.evaluate(e):!0},CLASS_NAME:"OpenLayers.Protocol.SQL"}),OpenLayers.Protocol.SQL.Gears=OpenLayers.Class(OpenLayers.Protocol.SQL,{FID_PREFIX:"__gears_fid__",NULL_GEOMETRY:"__gears_null_geometry__",NULL_FEATURE_STATE:"__gears_null_feature_state__",jsonParser:null,wktParser:null,fidRegExp:null,saveFeatureState:!0,typeOfFid:"string",db:null,initialize:function(e){this.supported()&&(OpenLayers.Protocol.SQL.prototype.initialize.apply(this,[e]),this.jsonParser=new OpenLayers.Format.JSON,this.wktParser=new OpenLayers.Format.WKT,this.fidRegExp=new RegExp("^"+this.FID_PREFIX),this.initializeDatabase())},initializeDatabase:function(){this.db=google.gears.factory.create("beta.database"),this.db.open(this.databaseName),this.db.execute("CREATE TABLE IF NOT EXISTS "+this.tableName+" (fid TEXT UNIQUE, geometry TEXT, properties TEXT,"+"  state TEXT)")},destroy:function(){this.db.close(),this.db=null,this.jsonParser=null,this.wktParser=null,OpenLayers.Protocol.SQL.prototype.destroy.apply(this)},supported:function(){return!(!window.google||!google.gears)},read:function(e){OpenLayers.Protocol.prototype.read.apply(this,arguments),e=OpenLayers.Util.applyDefaults(e,this.options);for(var t,i=[],s=this.db.execute("SELECT * FROM "+this.tableName);s.isValidRow();)t=this.unfreezeFeature(s),this.evaluateFilter(t,e.filter)&&(e.noFeatureStateReset||(t.state=null),i.push(t)),s.next();s.close();var n=new OpenLayers.Protocol.Response({code:OpenLayers.Protocol.Response.SUCCESS,requestType:"read",features:i});return e&&e.callback&&e.callback.call(e.scope,n),n},unfreezeFeature:function(e){var t,i=e.fieldByName("geometry");t=i==this.NULL_GEOMETRY?new OpenLayers.Feature.Vector:this.wktParser.read(i),t.attributes=this.jsonParser.read(e.fieldByName("properties")),t.fid=this.extractFidFromField(e.fieldByName("fid"));var s=e.fieldByName("state");return s==this.NULL_FEATURE_STATE&&(s=null),t.state=s,t},extractFidFromField:function(e){return e.match(this.fidRegExp)||"number"!=this.typeOfFid||(e=parseFloat(e)),e},create:function(e,t){t=OpenLayers.Util.applyDefaults(t,this.options);var i=this.createOrUpdate(e);return i.requestType="create",t&&t.callback&&t.callback.call(t.scope,i),i},update:function(e,t){t=OpenLayers.Util.applyDefaults(t,this.options);var i=this.createOrUpdate(e);return i.requestType="update",t&&t.callback&&t.callback.call(t.scope,i),i},createOrUpdate:function(e){OpenLayers.Util.isArray(e)||(e=[e]);var t,i,s=e.length,n=new Array(s);for(t=0;s>t;t++){i=e[t];var r=this.freezeFeature(i);this.db.execute("REPLACE INTO "+this.tableName+" (fid, geometry, properties, state)"+" VALUES (?, ?, ?, ?)",r);var a=i.clone();a.fid=this.extractFidFromField(r[0]),n[t]=a}return new OpenLayers.Protocol.Response({code:OpenLayers.Protocol.Response.SUCCESS,features:n,reqFeatures:e})},freezeFeature:function(e){e.fid=null!=e.fid?""+e.fid:OpenLayers.Util.createUniqueID(this.FID_PREFIX);var t=null!=e.geometry?e.geometry.toString():this.NULL_GEOMETRY,i=this.jsonParser.write(e.attributes),s=this.getFeatureStateForFreeze(e);return[e.fid,t,i,s]},getFeatureStateForFreeze:function(e){var t;return t=this.saveFeatureState?this.createdOffline(e)?OpenLayers.State.INSERT:e.state:this.NULL_FEATURE_STATE},"delete":function(e,t){OpenLayers.Util.isArray(e)||(e=[e]),t=OpenLayers.Util.applyDefaults(t,this.options);var i,s,n;for(i=0,s=e.length;s>i;i++)if(n=e[i],this.saveFeatureState&&!this.createdOffline(n)){var r=n.clone();r.fid=n.fid,r.geometry&&(r.geometry.destroy(),r.geometry=null),r.state=n.state,this.createOrUpdate(r)}else this.db.execute("DELETE FROM "+this.tableName+" WHERE fid = ?",[n.fid]);var a=new OpenLayers.Protocol.Response({code:OpenLayers.Protocol.Response.SUCCESS,requestType:"delete",reqFeatures:e});return t&&t.callback&&t.callback.call(t.scope,a),a},createdOffline:function(e){return"string"==typeof e.fid&&!!e.fid.match(this.fidRegExp)},commit:function(e,t){function i(e){++o<a&&(e.last=!1),this.callUserCallback(t,e)}for(var s,n,r=[],a=0,o=0,l=[],h=[],u=[],c=e.length-1;c>=0;c--)switch(n=e[c],n.state){case OpenLayers.State.INSERT:l.push(n);break;case OpenLayers.State.UPDATE:h.push(n);break;case OpenLayers.State.DELETE:u.push(n)}return l.length>0&&(a++,s=OpenLayers.Util.applyDefaults({callback:i,scope:this},t.create),r.push(this.create(l,s))),h.length>0&&(a++,s=OpenLayers.Util.applyDefaults({callback:i,scope:this},t.update),r.push(this.update(h,s))),u.length>0&&(a++,s=OpenLayers.Util.applyDefaults({callback:i,scope:this},t["delete"]),r.push(this["delete"](u,s))),r},clear:function(){this.db.execute("DELETE FROM "+this.tableName)},callUserCallback:function(e,t){var i=e[t.requestType];i&&i.callback&&i.callback.call(i.scope,t),t.last&&e.callback&&e.callback.call(e.scope)},CLASS_NAME:"OpenLayers.Protocol.SQL.Gears"}),OpenLayers.Layer.Yahoo=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:0,MAX_ZOOM_LEVEL:17,RESOLUTIONS:[1.40625,.703125,.3515625,.17578125,.087890625,.0439453125,.02197265625,.010986328125,.0054931640625,.00274658203125,.001373291015625,.0006866455078125,.00034332275390625,.000171661376953125,858306884765625e-19,4291534423828125e-20,2145767211914062e-20,1072883605957031e-20],type:null,wrapDateLine:!0,sphericalMercator:!1,initialize:function(){OpenLayers.Layer.EventPane.prototype.initialize.apply(this,arguments),OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,arguments),this.sphericalMercator&&(OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator),this.initMercatorParameters())},loadMapObject:function(){try{var e=this.getMapObjectSizeFromOLSize(this.map.getSize());this.mapObject=new YMap(this.div,this.type,e),this.mapObject.disableKeyControls(),this.mapObject.disableDragMap(),this.mapObject.moveByXY&&"function"==typeof this.mapObject.moveByXY||(this.dragPanMapObject=null)}catch(t){}},onMapResize:function(){try{var e=this.getMapObjectSizeFromOLSize(this.map.getSize());this.mapObject.resizeTo(e)}catch(t){}},setMap:function(){OpenLayers.Layer.EventPane.prototype.setMap.apply(this,arguments),this.map.events.register("moveend",this,this.fixYahooEventPane)},fixYahooEventPane:function(){var e=OpenLayers.Util.getElement("ygddfdiv");null!=e&&(null!=e.parentNode&&e.parentNode.removeChild(e),this.map.events.unregister("moveend",this,this.fixYahooEventPane))},getWarningHTML:function(){return OpenLayers.i18n("getLayerWarning",{layerType:"Yahoo",layerLib:"Yahoo"})},getOLZoomFromMapObjectZoom:function(e){var t=null;return null!=e&&(t=OpenLayers.Layer.FixedZoomLevels.prototype.getOLZoomFromMapObjectZoom.apply(this,[e]),t=18-t),t},getMapObjectZoomFromOLZoom:function(e){var t=null;return null!=e&&(t=OpenLayers.Layer.FixedZoomLevels.prototype.getMapObjectZoomFromOLZoom.apply(this,[e]),t=18-t),t},setMapObjectCenter:function(e,t){this.mapObject.drawZoomAndCenter(e,t)},getMapObjectCenter:function(){return this.mapObject.getCenterLatLon()},dragPanMapObject:function(e,t){this.mapObject.moveByXY({x:-e,y:t})},getMapObjectZoom:function(){return this.mapObject.getZoomLevel()},getMapObjectLonLatFromMapObjectPixel:function(e){return this.mapObject.convertXYLatLon(e)},getMapObjectPixelFromMapObjectLonLat:function(e){return this.mapObject.convertLatLonXY(e)},getLongitudeFromMapObjectLonLat:function(e){return this.sphericalMercator?this.forwardMercator(e.Lon,e.Lat).lon:e.Lon},getLatitudeFromMapObjectLonLat:function(e){return this.sphericalMercator?this.forwardMercator(e.Lon,e.Lat).lat:e.Lat},getMapObjectLonLatFromLonLat:function(e,t){var i;if(this.sphericalMercator){var s=this.inverseMercator(e,t);i=new YGeoPoint(s.lat,s.lon)}else i=new YGeoPoint(t,e);return i},getXFromMapObjectPixel:function(e){return e.x},getYFromMapObjectPixel:function(e){return e.y},getMapObjectPixelFromXY:function(e,t){return new YCoordPoint(e,t)},getMapObjectSizeFromOLSize:function(e){return new YSize(e.w,e.h)},CLASS_NAME:"OpenLayers.Layer.Yahoo"}),OpenLayers.Layer.GML=OpenLayers.Class(OpenLayers.Layer.Vector,{loaded:!1,format:null,formatOptions:null,initialize:function(e,t,i){var s=[];s.push(e,i),OpenLayers.Layer.Vector.prototype.initialize.apply(this,s),this.url=t},setVisibility:function(){OpenLayers.Layer.Vector.prototype.setVisibility.apply(this,arguments),this.visibility&&!this.loaded&&this.loadGML()},moveTo:function(){OpenLayers.Layer.Vector.prototype.moveTo.apply(this,arguments),this.visibility&&!this.loaded&&this.loadGML()},loadGML:function(){this.loaded||(this.events.triggerEvent("loadstart"),OpenLayers.Request.GET({url:this.url,success:this.requestSuccess,failure:this.requestFailure,scope:this}),this.loaded=!0)},setUrl:function(e){this.url=e,this.destroyFeatures(),this.loaded=!1,this.loadGML()},requestSuccess:function(e){var t=e.responseXML;t&&t.documentElement||(t=e.responseText);var i={};OpenLayers.Util.extend(i,this.formatOptions),this.map&&!this.projection.equals(this.map.getProjectionObject())&&(i.externalProjection=this.projection,i.internalProjection=this.map.getProjectionObject());var s=this.format?new this.format(i):new OpenLayers.Format.GML(i);this.addFeatures(s.read(t)),this.events.triggerEvent("loadend")},requestFailure:function(){OpenLayers.Console.userError("Error in loading GML file "+this.url),this.events.triggerEvent("loadend")},CLASS_NAME:"OpenLayers.Layer.GML"}),OpenLayers.Geometry.Rectangle=OpenLayers.Class(OpenLayers.Geometry,{x:null,y:null,width:null,height:null,initialize:function(e,t,i,s){OpenLayers.Geometry.prototype.initialize.apply(this,arguments),this.x=e,this.y=t,this.width=i,this.height=s},calculateBounds:function(){this.bounds=new OpenLayers.Bounds(this.x,this.y,this.x+this.width,this.y+this.height)},getLength:function(){var e=2*this.width+2*this.height;return e},getArea:function(){var e=this.width*this.height;return e},CLASS_NAME:"OpenLayers.Geometry.Rectangle"}),OpenLayers.Renderer.NG=OpenLayers.Class(OpenLayers.Renderer.Elements,{labelNodeType:null,updateDimensions:function(){var e=this.map.getExtent(),t=e.scale(3);this.setExtent(t,!0);var i=this.getResolution(),s=this.rendererRoot.parentNode,n=parseFloat(s.parentNode.style.left),r=parseFloat(s.parentNode.style.top);s.style.left=(t.left-e.left)/i-n+"px",s.style.top=(e.top-t.top)/i-r+"px"},setSize:function(){this.map.getExtent()&&this.updateDimensions()},drawFeature:function(e,t){if(null==t&&(t=e.style),e.geometry){var i=this.drawGeometry(e.geometry,t,e.id);if(i!==!1&&t.label){var s=e.geometry.getCentroid();this.drawText(e.id,t,s)}else this.removeText(e.id);return i}},drawText:function(e,t,i){var s;if("string"!=typeof e?s=e:(s=this.nodeFactory(e+this.LABEL_ID_SUFFIX,this.labelNodeType),s._featureId=e),s._style=t,s._x=i.x,s._y=i.y,t.labelXOffset||t.labelYOffset){var n=isNaN(t.labelXOffset)?0:t.labelXOffset,r=isNaN(t.labelYOffset)?0:t.labelYOffset,a=this.getResolution();i.move(n*a,r*a)}return s.parentNode!==this.textRoot&&this.textRoot.appendChild(s),s},CLASS_NAME:"OpenLayers.Renderer.NG"}),function(){var e=OpenLayers.Layer.Vector.prototype.moveTo;OpenLayers.Layer.Vector.prototype.moveTo=function(t,i,s){if(OpenLayers.Renderer.NG&&this.renderer instanceof OpenLayers.Renderer.NG){if(OpenLayers.Layer.prototype.moveTo.apply(this,arguments),s||this.renderer.updateDimensions(i),!this.drawn){this.drawn=!0;for(var n,r=0,a=this.features.length;a>r;r++)this.renderer.locked=r!==a-1,n=this.features[r],this.drawFeature(n)}}else e.apply(this,arguments)};var t=OpenLayers.Layer.Vector.prototype.redraw;OpenLayers.Layer.Vector.prototype.redraw=function(){OpenLayers.Renderer.NG&&this.renderer instanceof OpenLayers.Renderer.NG&&(this.drawn=!1),t.apply(this,arguments)}}(),OpenLayers.Renderer.SVG2=OpenLayers.Class(OpenLayers.Renderer.NG,{xmlns:"http://www.w3.org/2000/svg",xlinkns:"http://www.w3.org/1999/xlink",symbolMetrics:null,labelNodeType:"g",initialize:function(){this.supported()&&(OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments),this.symbolMetrics={})},supported:function(){var e="http://www.w3.org/TR/SVG11/feature#";return document.implementation&&(document.implementation.hasFeature("org.w3c.svg","1.0")||document.implementation.hasFeature(e+"SVG","1.1")||document.implementation.hasFeature(e+"BasicStructure","1.1"))},updateDimensions:function(e){OpenLayers.Renderer.NG.prototype.updateDimensions.apply(this,arguments);var t=this.getResolution(),i=this.extent.getWidth(),s=this.extent.getHeight(),n=[this.extent.left,-this.extent.top,i,s].join(" ");if(this.rendererRoot.setAttributeNS(null,"viewBox",n),this.rendererRoot.setAttributeNS(null,"width",i/t),this.rendererRoot.setAttributeNS(null,"height",s/t),e===!0){var r,a,o=this.vectorRoot.childNodes;for(r=0,a=o.length;a>r;++r)this.setStyle(o[r]);var l,h=this.textRoot.childNodes;for(r=0,a=h.length;a>r;++r)l=h[r],this.drawText(l,l._style,new OpenLayers.Geometry.Point(l._x,l._y))}},getNodeType:function(e,t){var i=null;switch(e.CLASS_NAME){case"OpenLayers.Geometry.Point":i=t.externalGraphic?"image":this.isComplexSymbol(t.graphicName)?"svg":"circle";break;case"OpenLayers.Geometry.Rectangle":i="rect";break;case"OpenLayers.Geometry.LineString":i="polyline";break;case"OpenLayers.Geometry.LinearRing":i="polygon";break;case"OpenLayers.Geometry.Polygon":case"OpenLayers.Geometry.Curve":i="path"}return i},setStyle:function(e,t,i){t=t||e._style,i=i||e._options;var s=this.getResolution(),n=e._radius,r=s;if("OpenLayers.Geometry.Point"==e._geometryClass&&n){if(e.style.visibility="",t.graphic===!1)e.style.visibility="hidden";else if(t.externalGraphic){if(t.graphicTitle){e.setAttributeNS(null,"title",t.graphicTitle);var a=e.getElementsByTagName("title");if(a.length>0)a[0].firstChild.textContent=t.graphicTitle;else{var o=this.nodeFactory(null,"title");o.textContent=t.graphicTitle,e.appendChild(o)}}t.graphicWidth&&t.graphicHeight&&e.setAttributeNS(null,"preserveAspectRatio","none");var l=t.graphicWidth||t.graphicHeight,h=t.graphicHeight||t.graphicWidth;l=l?l:2*t.pointRadius,h=h?h:2*t.pointRadius,l*=s,h*=s;var u=void 0!=t.graphicXOffset?t.graphicXOffset*s:-(.5*l),c=void 0!=t.graphicYOffset?t.graphicYOffset*s:-(.5*h),d=t.graphicOpacity||t.fillOpacity;e.setAttributeNS(null,"x",e._x+u),e.setAttributeNS(null,"y",e._y+c),e.setAttributeNS(null,"width",l),e.setAttributeNS(null,"height",h),e.setAttributeNS(this.xlinkns,"href",t.externalGraphic),e.setAttributeNS(null,"style","opacity: "+d),e.onclick=OpenLayers.Renderer.SVG2.preventDefault}else if(this.isComplexSymbol(t.graphicName)){var p=3*t.pointRadius*s,f=2*p,m=this.importSymbol(t.graphicName);r=3*this.symbolMetrics[m.id].size/f*s;var y=e.parentNode,g=e.nextSibling;y&&y.removeChild(e),e.firstChild&&e.removeChild(e.firstChild),e.appendChild(m.firstChild.cloneNode(!0)),e.setAttributeNS(null,"viewBox",m.getAttributeNS(null,"viewBox")),e.setAttributeNS(null,"width",f),e.setAttributeNS(null,"height",f),e.setAttributeNS(null,"x",e._x-p),e.setAttributeNS(null,"y",e._y-p),g?y.insertBefore(e,g):y&&y.appendChild(e)}else e.setAttributeNS(null,"r",t.pointRadius*s);var v=t.rotation;if(void 0!==v||void 0!==e._rotation)if(e._rotation=v,v|=0,"svg"!==e.nodeName)e.setAttributeNS(null,"transform",["rotate(",v,e._x,e._y,")"].join(" "));else{var x=this.symbolMetrics[m.id];e.firstChild.setAttributeNS(null,"transform",["rotate(",v,x.x,x.y,")"].join(" "))}}return i.isFilled?(e.setAttributeNS(null,"fill",t.fillColor),e.setAttributeNS(null,"fill-opacity",t.fillOpacity)):e.setAttributeNS(null,"fill","none"),i.isStroked?(e.setAttributeNS(null,"stroke",t.strokeColor),e.setAttributeNS(null,"stroke-opacity",t.strokeOpacity),e.setAttributeNS(null,"stroke-width",t.strokeWidth*r),e.setAttributeNS(null,"stroke-linecap",t.strokeLinecap||"round"),e.setAttributeNS(null,"stroke-linejoin","round"),t.strokeDashstyle&&e.setAttributeNS(null,"stroke-dasharray",this.dashStyle(t,r))):e.setAttributeNS(null,"stroke","none"),t.pointerEvents&&e.setAttributeNS(null,"pointer-events",t.pointerEvents),null!=t.cursor&&e.setAttributeNS(null,"cursor",t.cursor),e},dashStyle:function(e,t){var i=e.strokeWidth*t,s=e.strokeDashstyle;switch(s){case"solid":return"none";case"dot":return[t,4*i].join();case"dash":return[4*i,4*i].join();case"dashdot":return[4*i,4*i,t,4*i].join();case"longdash":return[8*i,4*i].join();case"longdashdot":return[8*i,4*i,t,4*i].join();default:for(var n=OpenLayers.String.trim(s).split(/\s+/g),r=0,a=n.length;a>r;r++)n[r]=n[r]*t;return n.join()}},createNode:function(e,t){var i=document.createElementNS(this.xmlns,e);return t&&i.setAttributeNS(null,"id",t),i},nodeTypeCompare:function(e,t){return t==e.nodeName},createRenderRoot:function(){return this.nodeFactory(this.container.id+"_svgRoot","svg")},createRoot:function(e){return this.nodeFactory(this.container.id+e,"g")},createDefs:function(){var e=this.nodeFactory(this.container.id+"_defs","defs");return this.rendererRoot.appendChild(e),e},drawPoint:function(e,t){return this.drawCircle(e,t,1)},drawCircle:function(e,t,i){var s=t.x,n=-t.y;return e.setAttributeNS(null,"cx",s),e.setAttributeNS(null,"cy",n),e._x=s,e._y=n,e._radius=i,e},drawLineString:function(e,t){var i=this.getComponentsString(t.components);return e.setAttributeNS(null,"points",i),e},drawLinearRing:function(e,t){var i=this.getComponentsString(t.components);return e.setAttributeNS(null,"points",i),e},drawPolygon:function(e,t){for(var i,s=[],n=0,r=t.components.length;r>n;n++)s.push("M"),i=this.getComponentsString(t.components[n].components," "),s.push(i);return s.push("z"),e.setAttributeNS(null,"d",s.join(" ")),e.setAttributeNS(null,"fill-rule","evenodd"),e},drawRectangle:function(e,t){return e.setAttributeNS(null,"x",t.x),e.setAttributeNS(null,"y",-t.y),e.setAttributeNS(null,"width",t.width),e.setAttributeNS(null,"height",t.height),e},drawText:function(e,t,i){var s=OpenLayers.Renderer.NG.prototype.drawText.apply(this,arguments),n=s.firstChild||this.nodeFactory(e+this.LABEL_ID_SUFFIX+"_text","text"),r=this.getResolution();n.setAttributeNS(null,"x",i.x/r),n.setAttributeNS(null,"y",-i.y/r),s.setAttributeNS(null,"transform","scale("+r+")"),t.fontColor&&n.setAttributeNS(null,"fill",t.fontColor),t.fontOpacity&&n.setAttributeNS(null,"opacity",t.fontOpacity),t.fontFamily&&n.setAttributeNS(null,"font-family",t.fontFamily),t.fontSize&&n.setAttributeNS(null,"font-size",t.fontSize),t.fontWeight&&n.setAttributeNS(null,"font-weight",t.fontWeight),t.fontStyle&&n.setAttributeNS(null,"font-style",t.fontStyle),t.labelSelect===!0?(n.setAttributeNS(null,"pointer-events","visible"),n._featureId=e):n.setAttributeNS(null,"pointer-events","none");var a=t.labelAlign||OpenLayers.Renderer.defaultSymbolizer.labelAlign;n.setAttributeNS(null,"text-anchor",OpenLayers.Renderer.SVG2.LABEL_ALIGN[a[0]]||"middle"),OpenLayers.IS_GECKO===!0&&n.setAttributeNS(null,"dominant-baseline",OpenLayers.Renderer.SVG2.LABEL_ALIGN[a[1]]||"central");for(var o=t.label.split("\n"),l=o.length;n.childNodes.length>l;)n.removeChild(n.lastChild);for(var h=0;l>h;h++){var u=n.childNodes[h]||this.nodeFactory(e+this.LABEL_ID_SUFFIX+"_tspan_"+h,"tspan");if(t.labelSelect===!0&&(u._featureId=e),OpenLayers.IS_GECKO===!1&&u.setAttributeNS(null,"baseline-shift",OpenLayers.Renderer.SVG2.LABEL_VSHIFT[a[1]]||"-35%"),u.setAttribute("x",i.x/r),0==h){var c=OpenLayers.Renderer.SVG2.LABEL_VFACTOR[a[1]];null==c&&(c=-.5),u.setAttribute("dy",c*(l-1)+"em")}else u.setAttribute("dy","1em");u.textContent=""===o[h]?" ":o[h],u.parentNode||n.appendChild(u)}return n.parentNode||s.appendChild(n),s},getComponentsString:function(e,t){for(var i=e.length,s=new Array(i),n=0;i>n;n++)s[n]=this.getShortString(e[n]);return s.join(t||",")},getShortString:function(e){return e.x+","+-e.y},importSymbol:function(e){this.defs||(this.defs=this.createDefs());var t=this.container.id+"-"+e,i=document.getElementById(t);if(null!=i)return i;var s=OpenLayers.Renderer.symbol[e];if(!s)throw new Error(e+" is not a valid symbol name");var n=this.nodeFactory(t,"symbol"),r=this.nodeFactory(null,"polygon");n.appendChild(r);for(var a,o,l=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0),h=[],u=0,c=s.length;c>u;u+=2)a=s[u],o=s[u+1],l.left=Math.min(l.left,a),l.bottom=Math.min(l.bottom,o),l.right=Math.max(l.right,a),l.top=Math.max(l.top,o),h.push(a,",",o);r.setAttributeNS(null,"points",h.join(" "));var d=l.getWidth(),p=l.getHeight(),f=[l.left-d,l.bottom-p,3*d,3*p];return n.setAttributeNS(null,"viewBox",f.join(" ")),this.symbolMetrics[t]={size:Math.max(d,p),x:l.getCenterLonLat().lon,y:l.getCenterLonLat().lat},this.defs.appendChild(n),n},getFeatureIdFromEvent:function(e){var t=OpenLayers.Renderer.Elements.prototype.getFeatureIdFromEvent.apply(this,arguments);if(!t){var i=e.target;t=i.parentNode&&i!=this.rendererRoot?i.parentNode._featureId:void 0}return t},CLASS_NAME:"OpenLayers.Renderer.SVG2"}),OpenLayers.Renderer.SVG2.LABEL_ALIGN={l:"start",r:"end",b:"bottom",t:"hanging"},OpenLayers.Renderer.SVG2.LABEL_VSHIFT={t:"-70%",b:"0"},OpenLayers.Renderer.SVG2.LABEL_VFACTOR={t:0,b:-1},OpenLayers.Renderer.SVG2.preventDefault=function(e){e.preventDefault&&e.preventDefault()},/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
/*
 * The code in this file is based on code taken from OpenLayers.
 *
 * Copyright (c) 2006-2007 MetaCarta, Inc., published under the Clear BSD
 * license.  See http://svn.openlayers.org/trunk/openlayers/license.txt for the
 * full text of the license.
 */
function(){var e="object"==typeof GeoExt&&GeoExt.singleFile,t=e?"GeoExt.js":"lib/GeoExt.js",i=function(){for(var e="",i=document.documentElement.getElementsByTagName("script"),s=0,n=i.length;n>s;s++){var r=i[s].getAttribute("src");if(r){var a=r.lastIndexOf(t),o=r.lastIndexOf("?");if(0>o&&(o=r.length),a>-1&&a+t.length==o){e=r.slice(0,o-t.length);break}}}return e};if(!e){for(var s=new Array("GeoExt/data/AttributeReader.js","GeoExt/data/AttributeStore.js","GeoExt/data/FeatureRecord.js","GeoExt/data/FeatureReader.js","GeoExt/data/FeatureStore.js","GeoExt/data/LayerRecord.js","GeoExt/data/LayerReader.js","GeoExt/data/LayerStore.js","GeoExt/data/ScaleStore.js","GeoExt/data/StyleReader.js","GeoExt/data/WMSCapabilitiesReader.js","GeoExt/data/WMSCapabilitiesStore.js","GeoExt/data/WFSCapabilitiesReader.js","GeoExt/data/WFSCapabilitiesStore.js","GeoExt/data/WMSDescribeLayerReader.js","GeoExt/data/WCSCapabilitiesReader.js","GeoExt/data/WCSCapabilitiesStore.js","GeoExt/data/WMSDescribeLayerStore.js","GeoExt/data/WMCReader.js","GeoExt/data/CSWRecordsReader.js","GeoExt/widgets/Action.js","GeoExt/data/ProtocolProxy.js","GeoExt/widgets/FeatureRenderer.js","GeoExt/widgets/MapPanel.js","GeoExt/widgets/Popup.js","GeoExt/widgets/form.js","GeoExt/widgets/form/SearchAction.js","GeoExt/widgets/form/BasicForm.js","GeoExt/widgets/form/GeocoderComboBox.js","GeoExt/widgets/form/FormPanel.js","GeoExt/widgets/grid/SymbolizerColumn.js","GeoExt/widgets/tips/SliderTip.js","GeoExt/widgets/tips/LayerOpacitySliderTip.js","GeoExt/widgets/tips/ZoomSliderTip.js","GeoExt/widgets/tree/LayerNode.js","GeoExt/widgets/tree/TreeNodeUIEventMixin.js","GeoExt/plugins/TreeNodeComponent.js","GeoExt/plugins/TreeNodeRadioButton.js","GeoExt/plugins/TreeNodeActions.js","GeoExt/widgets/tree/LayerLoader.js","GeoExt/widgets/tree/LayerContainer.js","GeoExt/widgets/tree/BaseLayerContainer.js","GeoExt/widgets/tree/OverlayLayerContainer.js","GeoExt/widgets/tree/LayerParamNode.js","GeoExt/widgets/tree/LayerParamLoader.js","GeoExt/widgets/tree/WMSCapabilitiesLoader.js","GeoExt/widgets/LayerOpacitySlider.js","GeoExt/widgets/LayerLegend.js","GeoExt/widgets/LegendImage.js","GeoExt/widgets/UrlLegend.js","GeoExt/widgets/WMSLegend.js","GeoExt/widgets/VectorLegend.js","GeoExt/widgets/LegendPanel.js","GeoExt/widgets/ZoomSlider.js","GeoExt/widgets/grid/FeatureSelectionModel.js","GeoExt/data/PrintPage.js","GeoExt/data/PrintProvider.js","GeoExt/plugins/PrintPageField.js","GeoExt/plugins/PrintProviderField.js","GeoExt/plugins/PrintExtent.js","GeoExt/plugins/AttributeForm.js","GeoExt/widgets/PrintMapPanel.js","GeoExt/state/PermalinkProvider.js","GeoExt/Lang.js"),n=s.length,r=new Array(n),a=i()+"lib/",o=0;n>o;o++)r[o]="<script src='"+a+s[o]+"'></script>";document.write(r.join(""))}}(),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 *
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt"),GeoExt.Lang=new(Ext.extend(Ext.util.Observable,{locale:navigator.language||navigator.userLanguage,dict:null,constructor:function(){this.addEvents("localize"),this.dict={},Ext.util.Observable.constructor.apply(this,arguments)},add:function(e,t){var i=this.dict[e];if(i)for(var s in t)i[s]=Ext.apply(i[s]||{},t[s]);else this.dict[e]=Ext.apply({},t);e&&e!==this.locale?0===this.locale.indexOf(e+"-")&&this.set(this.locale):this.set(e)},set:function(e){for(var t,i=e?e.split("-"):[],s="",n={},r=0,a=i.length;a>r;++r)if(s+=(s&&"-"||"")+i[r],s in this.dict){t=this.dict[s];for(var o in t)o in n?Ext.apply(n[o],t[o]):n[o]=Ext.apply({},t[o])}for(var o in n){for(var l=window,h=o.split("."),u=!1,r=0,a=h.length;a>r;++r){var c=h[r];if(!(c in l)){u=!0;break}l=l[c]}u||Ext.apply(l,n[o])}this.locale=e,this.fireEvent("localize",e)}})),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt"),GeoExt.singleFile=!0,/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.data"),GeoExt.data.AttributeReader=function(e,t){e=e||{},e.format||(e.format=new OpenLayers.Format.WFSDescribeFeatureType),GeoExt.data.AttributeReader.superclass.constructor.call(this,e,t||e.fields),e.feature&&this.recordType.prototype.fields.add(new Ext.data.Field("value"))},Ext.extend(GeoExt.data.AttributeReader,Ext.data.DataReader,{read:function(e){var t=e.responseXML;return t&&t.documentElement||(t=e.responseText),this.readRecords(t)},readRecords:function(e){var t;t=e instanceof Array?e:this.meta.format.read(e).featureTypes[0].properties;for(var i,s,n,r,a,o,l=this.meta.feature,h=this.recordType,u=h.prototype.fields,c=u.length,d=[],p=0,f=t.length;f>p;++p){r=!1,i=t[p],s={};for(var m=0;c>m;++m){if(o=u.items[m],n=o.name,a=o.convert(i[n]),this.ignoreAttribute(n,a)){r=!0;break}s[n]=a}l&&(a=l.attributes[s.name],void 0!==a&&(this.ignoreAttribute("value",a)?r=!0:s.value=a)),r||(d[d.length]=new h(s))}return{success:!0,records:d,totalRecords:d.length}},ignoreAttribute:function(e,t){var i=!1;if(this.meta.ignore&&this.meta.ignore[e]){var s=this.meta.ignore[e];"string"==typeof s?i=s===t:s instanceof Array?i=s.indexOf(t)>-1:s instanceof RegExp&&(i=s.test(t))}return i}}),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 *
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.data"),GeoExt.data.AttributeStoreMixin=function(){return{constructor:function(e){e=e||{},arguments.callee.superclass.constructor.call(this,Ext.apply(e,{proxy:e.proxy||(e.data?void 0:new Ext.data.HttpProxy({url:e.url,disableCaching:!1,method:"GET"})),reader:new GeoExt.data.AttributeReader(e,e.fields||["name","type","restriction",{name:"nillable",type:"boolean"},"annotation"])})),this.feature&&this.bind()},bind:function(){this.on({update:this.onUpdate,load:this.onLoad,add:this.onAdd,scope:this});var e=[];this.each(function(t){e.push(t)}),this.updateFeature(e)},onUpdate:function(e,t){this.updateFeature([t])},onLoad:function(e,t,i){i&&i.add===!0||this.updateFeature(t)},onAdd:function(e,t){this.updateFeature(t)},updateFeature:function(e){var t,i,s,n,r,a,o,l=this.feature,h=l.layer;for(t=0,i=e.length;i>t;t++)s=e[t],n=s.get("name"),r=s.get("value"),a=l.attributes[n],a!==r&&(o=!0);if(o&&h&&h.events&&h.events.triggerEvent("beforefeaturemodified",{feature:l})!==!1){for(t=0,i=e.length;i>t;t++)s=e[t],n=s.get("name"),r=s.get("value"),l.attributes[n]=r;h.events.triggerEvent("featuremodified",{feature:l}),h.drawFeature(l)}}}},GeoExt.data.AttributeStore=Ext.extend(Ext.data.Store,GeoExt.data.AttributeStoreMixin()),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.data"),GeoExt.data.CSWRecordsReader=function(e,t){e=e||{},e.format||(e.format=new OpenLayers.Format.CSWGetRecords),e.root||(e.root="records"),GeoExt.data.CSWRecordsReader.superclass.constructor.call(this,e,t)},Ext.extend(GeoExt.data.CSWRecordsReader,Ext.data.JsonReader,{read:function(e){var t=e.data;return t||(t=e.responseXML,t&&t.documentElement||(t=e.responseText)),this.readRecords(t)},readRecords:function(e){("string"==typeof e||e.nodeType)&&(e=this.meta.format.read(e));var t=GeoExt.data.CSWRecordsReader.superclass.readRecords.call(this,e);return Ext.each(t.records,function(e){for(var t in e.data){var i=e.data[t];if(i instanceof Array)for(var s=0,n=i.length;n>s;++s)if(i[s]instanceof Object){var r=0;for(var a in i[s])i[s].hasOwnProperty(a)&&r++;1===r&&i[s].value&&(i[s]=i[s].value)}}}),e.SearchResults&&(t.totalRecords=e.SearchResults.numberOfRecordsMatched),t}}),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt","GeoExt.data"),GeoExt.data.FeatureReader=function(e,t){e=e||{},t instanceof Function||(t=GeoExt.data.FeatureRecord.create(t||e.fields||{})),GeoExt.data.FeatureReader.superclass.constructor.call(this,e,t)},Ext.extend(GeoExt.data.FeatureReader,Ext.data.DataReader,{totalRecords:null,read:function(e){return this.readRecords(e.features)},readRecords:function(e){var t=[];if(e){var i,s,n,r,a,o,l,h,u=this.recordType,c=u.prototype.fields;for(i=0,s=e.length;s>i;i++){if(a=e[i],o={},a.attributes)for(n=0,r=c.length;r>n;n++){if(l=c.items[n],/[\[\.]/.test(l.mapping))try{h=new Function("obj","return obj."+l.mapping)(a.attributes)}catch(d){h=l.defaultValue}else h=a.attributes[l.mapping||l.name]||l.defaultValue;l.convert&&(h=l.convert(h,a)),o[l.name]=h}o.feature=a,o.state=a.state,o.fid=a.fid;var p=a.state===OpenLayers.State.INSERT?void 0:a.id;t[t.length]=new u(o,p)}}return{records:t,totalRecords:null!=this.totalRecords?this.totalRecords:t.length}}}),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.data"),GeoExt.data.FeatureRecord=Ext.data.Record.create([{name:"feature"},{name:"state"},{name:"fid"}]),GeoExt.data.FeatureRecord.prototype.getFeature=function(){return this.get("feature")},GeoExt.data.FeatureRecord.prototype.setFeature=function(e){e!==this.data.feature&&(this.dirty=!0,this.modified||(this.modified={}),void 0===this.modified.feature&&(this.modified.feature=this.data.feature),this.data.feature=e,this.editing||this.afterEdit())},GeoExt.data.FeatureRecord.create=function(e){var t=Ext.extend(GeoExt.data.FeatureRecord,{}),i=t.prototype;if(i.fields=new Ext.util.MixedCollection(!1,function(e){return e.name}),GeoExt.data.FeatureRecord.prototype.fields.each(function(e){i.fields.add(e)}),e)for(var s=0,n=e.length;n>s;s++)i.fields.add(new Ext.data.Field(e[s]));return t.getField=function(e){return i.fields.get(e)},t},/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.data"),GeoExt.data.FeatureStoreMixin=function(){return{layer:null,reader:null,featureFilter:null,constructor:function(e){e=e||{},e.reader=e.reader||new GeoExt.data.FeatureReader({},e.fields);var t=e.layer;delete e.layer,e.features&&(e.data=e.features),delete e.features;var i={initDir:e.initDir};delete e.initDir,arguments.callee.superclass.constructor.call(this,e),t&&this.bind(t,i)},bind:function(e,t){if(!this.layer){this.layer=e,t=t||{};var i=t.initDir;void 0==t.initDir&&(i=GeoExt.data.FeatureStore.LAYER_TO_STORE|GeoExt.data.FeatureStore.STORE_TO_LAYER);var s=e.features.slice(0);if(i&GeoExt.data.FeatureStore.STORE_TO_LAYER)for(var n=this.getRange(),r=n.length-1;r>=0;r--)this.layer.addFeatures([n[r].getFeature()]);i&GeoExt.data.FeatureStore.LAYER_TO_STORE&&this.loadData(s,!0),e.events.on({featuresadded:this.onFeaturesAdded,featuresremoved:this.onFeaturesRemoved,featuremodified:this.onFeatureModified,scope:this}),this.on({load:this.onLoad,clear:this.onClear,add:this.onAdd,remove:this.onRemove,update:this.onUpdate,scope:this})}},unbind:function(){this.layer&&(this.layer.events.un({featuresadded:this.onFeaturesAdded,featuresremoved:this.onFeaturesRemoved,featuremodified:this.onFeatureModified,scope:this}),this.un("load",this.onLoad,this),this.un("clear",this.onClear,this),this.un("add",this.onAdd,this),this.un("remove",this.onRemove,this),this.un("update",this.onUpdate,this),this.layer=null)},getRecordFromFeature:function(e){return this.getByFeature(e)||null},getByFeature:function(e){var t;if(e.state!==OpenLayers.State.INSERT)t=this.getById(e.id);else{var i=this.findBy(function(t){return t.getFeature()===e});i>-1&&(t=this.getAt(i))}return t},onFeaturesAdded:function(e){if(!this._adding){var t=e.features,i=t;if(this.featureFilter){i=[];for(var s,n,r,s=0,n=t.length;n>s;s++)r=t[s],this.featureFilter.evaluate(r)!==!1&&i.push(r)}this._adding=!0,this.loadData(i,!0),delete this._adding}},onFeaturesRemoved:function(e){if(!this._removing){var t,i,s,n=e.features;for(s=n.length-1;s>=0;s--)t=n[s],i=this.getByFeature(t),void 0!==i&&(this._removing=!0,this.remove(i),delete this._removing)}},onFeatureModified:function(e){if(!this._updating){var t=e.feature,i=this.getByFeature(t);if(void 0!==i){i.beginEdit();var s=t.attributes;if(s)for(var n=this.recordType.prototype.fields,r=0,a=n.length;a>r;r++){var o=n.items[r],l=o.mapping||o.name;l in s&&i.set(o.name,o.convert(s[l]))}i.set("state",t.state),i.set("fid",t.fid),i.setFeature(t),this._updating=!0,i.endEdit(),delete this._updating}}},addFeaturesToLayer:function(e){var t,i,s;for(s=new Array(i=e.length),t=0;i>t;t++)s[t]=e[t].getFeature();s.length>0&&(this._adding=!0,this.layer.addFeatures(s),delete this._adding)},onLoad:function(e,t,i){i&&i.add===!0||(this._removing=!0,this.layer.removeFeatures(this.layer.features),delete this._removing,this.addFeaturesToLayer(t))},onClear:function(){this._removing=!0,this.layer.removeFeatures(this.layer.features),delete this._removing},onAdd:function(e,t){this._adding||this.addFeaturesToLayer(t)},onRemove:function(e,t){if(!this._removing){var i=t.getFeature();null!=this.layer.getFeatureById(i.id)&&(this._removing=!0,this.layer.removeFeatures([t.getFeature()]),delete this._removing)}},onUpdate:function(e,t){if(!this._updating){var i=(new GeoExt.data.FeatureRecord).fields,s=t.getFeature();if(s.state!==OpenLayers.State.INSERT&&(s.state=OpenLayers.State.UPDATE),t.fields){var n=this.layer.events.triggerEvent("beforefeaturemodified",{feature:s});if(n!==!1){var r=s.attributes;t.fields.each(function(e){var s=e.mapping||e.name;i.containsKey(s)||(r[s]=t.get(e.name))}),this._updating=!0,this.layer.events.triggerEvent("featuremodified",{feature:s}),delete this._updating,null!=this.layer.getFeatureById(s.id)&&this.layer.drawFeature(s)}}}},destroy:function(){this.unbind(),GeoExt.data.FeatureStore.superclass.destroy.call(this)}}},GeoExt.data.FeatureStore=Ext.extend(Ext.data.Store,new GeoExt.data.FeatureStoreMixin),GeoExt.data.FeatureStore.LAYER_TO_STORE=1,GeoExt.data.FeatureStore.STORE_TO_LAYER=2,/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt","GeoExt.data"),GeoExt.data.LayerReader=function(e,t){e=e||{},t instanceof Function||(t=GeoExt.data.LayerRecord.create(t||e.fields||{})),GeoExt.data.LayerReader.superclass.constructor.call(this,e,t)},Ext.extend(GeoExt.data.LayerReader,Ext.data.DataReader,{totalRecords:null,readRecords:function(e){var t=[];if(e){var i,s,n,r,a,o,l,h,u=this.recordType,c=u.prototype.fields;for(i=0,s=e.length;s>i;i++){for(a=e[i],o={},n=0,r=c.length;r>n;n++)l=c.items[n],h=a[l.mapping||l.name]||l.defaultValue,h=l.convert(h),o[l.name]=h;o.layer=a,t[t.length]=new u(o,a.id)}}return{records:t,totalRecords:null!=this.totalRecords?this.totalRecords:t.length}}}),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.data"),GeoExt.data.LayerRecord=Ext.data.Record.create([{name:"layer"},{name:"title",type:"string",mapping:"name"}]),GeoExt.data.LayerRecord.prototype.getLayer=function(){return this.get("layer")},GeoExt.data.LayerRecord.prototype.setLayer=function(e){e!==this.data.layer&&(this.dirty=!0,this.modified||(this.modified={}),void 0===this.modified.layer&&(this.modified.layer=this.data.layer),this.data.layer=e,this.editing||this.afterEdit())},GeoExt.data.LayerRecord.prototype.clone=function(e){var t=this.getLayer()&&this.getLayer().clone();return new this.constructor(Ext.applyIf({layer:t},this.data),e||t.id)},GeoExt.data.LayerRecord.create=function(e){var t=Ext.extend(GeoExt.data.LayerRecord,{}),i=t.prototype;if(i.fields=new Ext.util.MixedCollection(!1,function(e){return e.name}),GeoExt.data.LayerRecord.prototype.fields.each(function(e){i.fields.add(e)}),e)for(var s=0,n=e.length;n>s;s++)i.fields.add(new Ext.data.Field(e[s]));return t.getField=function(e){return i.fields.get(e)},t},/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.data"),GeoExt.data.LayerStoreMixin=function(){return{map:null,reader:null,constructor:function(e){e=e||{},e.reader=e.reader||new GeoExt.data.LayerReader({},e.fields),delete e.fields;var t=e.map instanceof GeoExt.MapPanel?e.map.map:e.map;delete e.map,e.layers&&(e.data=e.layers),delete e.layers;var i={initDir:e.initDir};delete e.initDir,arguments.callee.superclass.constructor.call(this,e),this.addEvents("bind"),t&&this.bind(t,i)},bind:function(e,t){if(!this.map){this.map=e,t=t||{};var i=t.initDir;void 0==t.initDir&&(i=GeoExt.data.LayerStore.MAP_TO_STORE|GeoExt.data.LayerStore.STORE_TO_MAP);var s=e.layers.slice(0);i&GeoExt.data.LayerStore.STORE_TO_MAP&&this.each(function(e){this.map.addLayer(e.getLayer())},this),i&GeoExt.data.LayerStore.MAP_TO_STORE&&this.loadData(s,!0),e.events.on({changelayer:this.onChangeLayer,addlayer:this.onAddLayer,removelayer:this.onRemoveLayer,scope:this}),this.on({load:this.onLoad,clear:this.onClear,add:this.onAdd,remove:this.onRemove,update:this.onUpdate,scope:this}),this.data.on({replace:this.onReplace,scope:this}),this.fireEvent("bind",this,e)}},unbind:function(){this.map&&(this.map.events.un({changelayer:this.onChangeLayer,addlayer:this.onAddLayer,removelayer:this.onRemoveLayer,scope:this}),this.un("load",this.onLoad,this),this.un("clear",this.onClear,this),this.un("add",this.onAdd,this),this.un("remove",this.onRemove,this),this.data.un("replace",this.onReplace,this),this.map=null)},onChangeLayer:function(e){var t=e.layer,i=this.findBy(function(e){return e.getLayer()===t});if(i>-1){var s=this.getAt(i);if("order"===e.property){if(!this._adding&&!this._removing){var n=this.map.getLayerIndex(t);n!==i&&(this._removing=!0,this.remove(s),delete this._removing,this._adding=!0,this.insert(n,[s]),delete this._adding)}}else"name"===e.property?s.set("title",t.name):this.fireEvent("update",this,s,Ext.data.Record.EDIT)}},onAddLayer:function(e){if(!this._adding){var t=e.layer;this._adding=!0,this.loadData([t],!0),delete this._adding}},onRemoveLayer:function(e){if(this.map.unloadDestroy){if(!this._removing){var t=e.layer;this._removing=!0,this.remove(this.getById(t.id)),delete this._removing}}else this.unbind()},onLoad:function(e,t,i){if(Ext.isArray(t)||(t=[t]),i&&!i.add){this._removing=!0;for(var s=this.map.layers.length-1;s>=0;s--)this.map.removeLayer(this.map.layers[s]);delete this._removing;var n=t.length;if(n>0){for(var r=new Array(n),a=0;n>a;a++)r[a]=t[a].getLayer();this._adding=!0,this.map.addLayers(r),delete this._adding}}},onClear:function(){this._removing=!0;for(var e=this.map.layers.length-1;e>=0;e--)this.map.removeLayer(this.map.layers[e]);delete this._removing},onAdd:function(e,t,i){if(!this._adding){this._adding=!0;for(var s,n=t.length-1;n>=0;--n)s=t[n].getLayer(),this.map.addLayer(s),i!==this.map.layers.length-1&&this.map.setLayerIndex(s,i);delete this._adding}},onRemove:function(e,t){if(!this._removing){var i=t.getLayer();null!=this.map.getLayer(i.id)&&(this._removing=!0,this.removeMapLayer(t),delete this._removing)}},onUpdate:function(e,t,i){if(i===Ext.data.Record.EDIT&&t.modified&&t.modified.title){var s=t.getLayer(),n=t.get("title");n!==s.name&&s.setName(n)}},removeMapLayer:function(e){this.map.removeLayer(e.getLayer())},onReplace:function(e,t){this.removeMapLayer(t)},getByLayer:function(e){var t=this.findBy(function(t){return t.getLayer()===e});return t>-1?this.getAt(t):void 0},destroy:function(){this.unbind(),GeoExt.data.LayerStore.superclass.destroy.call(this)}}},GeoExt.data.LayerStore=Ext.extend(Ext.data.Store,new GeoExt.data.LayerStoreMixin),GeoExt.data.LayerStore.MAP_TO_STORE=1,GeoExt.data.LayerStore.STORE_TO_MAP=2,/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.data"),GeoExt.data.PrintPage=Ext.extend(Ext.util.Observable,{printProvider:null,feature:null,center:null,scale:null,rotation:0,customParams:null,constructor:function(e){this.initialConfig=e,Ext.apply(this,e),this.customParams||(this.customParams={}),this.addEvents("change"),GeoExt.data.PrintPage.superclass.constructor.apply(this,arguments),this.feature=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(-1,-1),new OpenLayers.Geometry.Point(1,-1),new OpenLayers.Geometry.Point(1,1),new OpenLayers.Geometry.Point(-1,1)])])),this.printProvider.capabilities?this.setScale(this.printProvider.scales.getAt(0)):this.printProvider.on({loadcapabilities:function(){this.setScale(this.printProvider.scales.getAt(0))},scope:this,single:!0}),this.printProvider.on({layoutchange:this.onLayoutChange,scope:this})},getPrintExtent:function(e){return e=e instanceof GeoExt.MapPanel?e.map:e,this.calculatePageBounds(this.scale,e.getUnits())},setScale:function(e,t){var i=this.calculatePageBounds(e,t),s=i.toGeometry(),n=this.rotation;0!=n&&s.rotate(-n,s.getCentroid()),this.updateFeature(s,{scale:e})},setCenter:function(e){var t=this.feature.geometry,i=t.getBounds().getCenterLonLat(),s=e.lon-i.lon,n=e.lat-i.lat;t.move(s,n),this.updateFeature(t,{center:e})},setRotation:function(e,t){if(t||this.printProvider.layout.get("rotation")===!0){var i=this.feature.geometry;i.rotate(this.rotation-e,i.getCentroid()),this.updateFeature(i,{rotation:e})}},fit:function(e,t){t=t||{};var i,s=e;if(e instanceof GeoExt.MapPanel?s=e.map:e instanceof OpenLayers.Feature.Vector&&(s=e.layer.map,i=e.geometry.getBounds()),i||(i=s.getExtent())){this._updating=!0;var n=i.getCenterLonLat();this.setCenter(n);var r=s.getUnits(),a=this.printProvider.scales.getAt(0),o=Number.POSITIVE_INFINITY,l=i.getWidth(),h=i.getHeight();this.printProvider.scales.each(function(e){var s=this.calculatePageBounds(e,r);if("closest"!=t.mode){var n="screen"==t.mode?!i.containsBounds(s):s.containsBounds(i);return(n||"screen"==t.mode&&!n)&&(a=e),n}var u=Math.abs(s.getWidth()-l)+Math.abs(s.getHeight()-h);o>u&&(o=u,a=e)},this),this.setScale(a,r),delete this._updating,this.updateFeature(this.feature.geometry,{center:n,scale:a})}},updateFeature:function(e,t){var i=this.feature,s=i.geometry!==e;if(e.id=i.geometry.id,i.geometry=e,!this._updating){for(var n in t)t[n]===this[n]?delete t[n]:(this[n]=t[n],s=!0);Ext.apply(this,t),i.layer&&i.layer.drawFeature(i),s&&this.fireEvent("change",this,t)}},calculatePageBounds:function(e,t){var i=e.get("value"),s=this.feature,n=this.feature.geometry,r=n.getBounds().getCenterLonLat(),a=this.printProvider.layout.get("size"),t=t||s.layer&&s.layer.map&&s.layer.map.getUnits()||"dd",o=OpenLayers.INCHES_PER_UNIT[t],l=a.width/72/o*i/2,h=a.height/72/o*i/2;return new OpenLayers.Bounds(r.lon-l,r.lat-h,r.lon+l,r.lat+h)},onLayoutChange:function(){this.printProvider.layout.get("rotation")===!1&&this.setRotation(0,!0),this.scale&&this.setScale(this.scale)},destroy:function(){this.printProvider.un("layoutchange",this.onLayoutChange,this)}}),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.data"),GeoExt.data.PrintProvider=Ext.extend(Ext.util.Observable,{url:null,capabilities:null,method:"POST",encoding:document.charset||document.characterSet||"UTF-8",timeout:3e4,customParams:null,scales:null,dpis:null,layouts:null,dpi:null,layout:null,constructor:function(e){this.initialConfig=e,Ext.apply(this,e),this.customParams||(this.customParams={}),this.addEvents("loadcapabilities","layoutchange","dpichange","beforeprint","print","printexception","beforeencodelayer","encodelayer","beforedownload","beforeencodelegend"),GeoExt.data.PrintProvider.superclass.constructor.apply(this,arguments),this.scales=new Ext.data.JsonStore({root:"scales",sortInfo:{field:"value",direction:"DESC"},fields:["name",{name:"value",type:"float"}]}),this.dpis=new Ext.data.JsonStore({root:"dpis",fields:["name",{name:"value",type:"float"}]}),this.layouts=new Ext.data.JsonStore({root:"layouts",fields:["name",{name:"size",mapping:"map"},{name:"rotation",type:"boolean"}]}),e.capabilities?this.loadStores():(this.url.split("/").pop()&&(this.url+="/"),this.initialConfig.autoLoad&&this.loadCapabilities())},setLayout:function(e){this.layout=e,this.fireEvent("layoutchange",this,e)},setDpi:function(e){this.dpi=e,this.fireEvent("dpichange",this,e)},print:function(e,t,i){if(e instanceof GeoExt.MapPanel&&(e=e.map),t=t instanceof Array?t:[t],i=i||{},this.fireEvent("beforeprint",this,e,t,i)!==!1){var s=Ext.apply({units:e.getUnits(),srs:e.baseLayer.projection.getCode(),layout:this.layout.get("name"),dpi:this.dpi.get("value")},this.customParams),n=t[0].feature.layer,r=[],a=e.layers.concat();a.remove(e.baseLayer),a.unshift(e.baseLayer),Ext.each(a,function(e){if(e!==n&&e.getVisibility()===!0){var t=this.encodeLayer(e);t&&r.push(t)}},this),s.layers=r;var o=[];if(Ext.each(t,function(e){o.push(Ext.apply({center:[e.center.lon,e.center.lat],scale:e.scale.get("value"),rotation:e.rotation},e.customParams))},this),s.pages=o,i.overview){var l=[];Ext.each(i.overview.layers,function(e){var t=this.encodeLayer(e);t&&l.push(t)},this),s.overviewLayers=l}if(i.legend&&this.fireEvent("beforeencodelegend",this,s,i.legend)!==!1){var h=i.legend,u=h.rendered;u||(h=h.cloneConfig({renderTo:document.body,hidden:!0}));var c=[];h.items&&h.items.each(function(e){if(!e.hidden){var t=this.encoders.legends[e.getXType()];c=c.concat(t.call(this,e,s.pages[0].scale))}},this),u||h.destroy(),s.legends=c}if("GET"===this.method){var d=Ext.urlAppend(this.capabilities.printURL,"spec="+encodeURIComponent(Ext.encode(s)));this.download(d)}else Ext.Ajax.request({url:this.capabilities.createURL,timeout:this.timeout,jsonData:s,headers:{"Content-Type":"application/json; charset="+this.encoding},success:function(e){var t=Ext.decode(e.responseText).getURL;this.download(t)},failure:function(e){this.fireEvent("printexception",this,e)},params:this.initialConfig.baseParams,scope:this})}},download:function(e){this.fireEvent("beforedownload",this,e)!==!1&&(Ext.isOpera?window.open(e):window.location.href=e),this.fireEvent("print",this,e)},loadCapabilities:function(){if(this.url){var e=this.url+"info.json";Ext.Ajax.request({url:e,method:"GET",disableCaching:!1,success:function(e){this.capabilities=Ext.decode(e.responseText),this.loadStores()},params:this.initialConfig.baseParams,scope:this})}},loadStores:function(){this.scales.loadData(this.capabilities),this.dpis.loadData(this.capabilities),this.layouts.loadData(this.capabilities),this.setLayout(this.layouts.getAt(0)),this.setDpi(this.dpis.getAt(0)),this.fireEvent("loadcapabilities",this,this.capabilities)},encodeLayer:function(e){var t;for(var i in this.encoders.layers)if(OpenLayers.Layer[i]&&e instanceof OpenLayers.Layer[i]){if(this.fireEvent("beforeencodelayer",this,e)===!1)return;t=this.encoders.layers[i].call(this,e),this.fireEvent("encodelayer",this,e,t);break}return t&&t.type?t:null},getAbsoluteUrl:function(e){Ext.isSafari&&(e=e.replace(/{/g,"%7B"),e=e.replace(/}/g,"%7D"));var t;return Ext.isIE6||Ext.isIE7||Ext.isIE8?(t=document.createElement("<a href='"+e+"'/>"),t.style.display="none",document.body.appendChild(t),t.href=t.href,document.body.removeChild(t)):(t=document.createElement("a"),t.href=e),t.href},encoders:{layers:{Layer:function(e){var t={};return e.options&&e.options.maxScale&&(t.minScaleDenominator=e.options.maxScale),e.options&&e.options.minScale&&(t.maxScaleDenominator=e.options.minScale),t},WMS:function(e){var t=this.encoders.layers.HTTPRequest.call(this,e);t.singleTile=e.singleTile,Ext.apply(t,{type:"WMS",layers:[e.params.LAYERS].join(",").split(","),format:e.params.FORMAT,styles:[e.params.STYLES].join(",").split(","),singleTile:e.singleTile});var i;for(var s in e.params)i=s.toLowerCase(),null==e.params[s]||e.DEFAULT_PARAMS[i]||-1!="layers,styles,width,height,srs".indexOf(i)||(t.customParams||(t.customParams={}),t.customParams[s]=e.params[s]);return t},OSM:function(e){var t=this.encoders.layers.TileCache.call(this,e);return Ext.apply(t,{type:"OSM",baseURL:t.baseURL.substr(0,t.baseURL.indexOf("$")),extension:"png"})},TMS:function(e){var t=this.encoders.layers.TileCache.call(this,e);return Ext.apply(t,{type:"TMS",format:e.type})},TileCache:function(e){var t=this.encoders.layers.HTTPRequest.call(this,e);return Ext.apply(t,{type:"TileCache",layer:e.layername,maxExtent:e.maxExtent.toArray(),tileSize:[e.tileSize.w,e.tileSize.h],extension:e.extension,resolutions:e.serverResolutions||e.resolutions})},WMTS:function(e){var t=this.encoders.layers.HTTPRequest.call(this,e);return t=Ext.apply(t,{type:"WMTS",layer:e.layer,version:e.version,requestEncoding:e.requestEncoding,style:e.style,dimensions:e.dimensions,params:e.params,matrixSet:e.matrixSet}),e.matrixIds?("KVP"==e.requestEncoding&&(t.format=e.format),t.matrixIds=[],Ext.each(e.matrixIds,function(i){t.matrixIds.push({identifier:i.identifier,matrixSize:[i.matrixWidth,i.matrixHeight],resolution:28e-5*i.scaleDenominator/OpenLayers.METERS_PER_INCH/OpenLayers.INCHES_PER_UNIT[e.units],tileSize:[i.tileWidth,i.tileHeight],topLeftCorner:[i.topLeftCorner.lon,i.topLeftCorner.lat]})}),t):Ext.apply(t,{formatSuffix:e.formatSuffix,tileOrigin:[e.tileOrigin.lon,e.tileOrigin.lat],tileSize:[e.tileSize.w,e.tileSize.h],maxExtent:null!=e.tileFullExtent?e.tileFullExtent.toArray():e.maxExtent.toArray(),zoomOffset:e.zoomOffset,resolutions:e.serverResolutions||e.resolutions})},KaMapCache:function(e){var t=this.encoders.layers.KaMap.call(this,e);return Ext.apply(t,{type:"KaMapCache",group:e.params.g,metaTileWidth:e.params.metaTileSize.w,metaTileHeight:e.params.metaTileSize.h})},KaMap:function(e){var t=this.encoders.layers.HTTPRequest.call(this,e);return Ext.apply(t,{type:"KaMap",map:e.params.map,extension:e.params.i,group:e.params.g||"",maxExtent:e.maxExtent.toArray(),tileSize:[e.tileSize.w,e.tileSize.h],resolutions:e.serverResolutions||e.resolutions})},HTTPRequest:function(e){var t=this.encoders.layers.Layer.call(this,e);return Ext.apply(t,{baseURL:this.getAbsoluteUrl(e.url instanceof Array?e.url[0]:e.url),opacity:null!=e.opacity?e.opacity:1})},Image:function(e){var t=this.encoders.layers.Layer.call(this,e);return Ext.apply(t,{type:"Image",baseURL:this.getAbsoluteUrl(e.getURL(e.extent)),opacity:null!=e.opacity?e.opacity:1,extent:e.extent.toArray(),pixelSize:[e.size.w,e.size.h],name:e.name})},Vector:function(e){if(e.features.length){for(var t,i,s,n,r,a=[],o={},l=e.features,h=new OpenLayers.Format.GeoJSON,u=new OpenLayers.Format.JSON,c=1,d={},p=0,f=l.length;f>p;++p)if(t=l[p],i=t.style||e.style||e.styleMap.createSymbolizer(t,t.renderIntent),"none"!=i.display){s=u.write(i),n=d[s],n?r=n:(d[s]=r=c++,o[r]=i.externalGraphic?Ext.applyIf({externalGraphic:this.getAbsoluteUrl(i.externalGraphic)},i):i);var m=h.extract.feature.call(h,t);m.properties=OpenLayers.Util.extend({_gx_style:r},m.properties),a.push(m)}var y=this.encoders.layers.Layer.call(this,e);return Ext.apply(y,{type:"Vector",styles:o,styleProperty:"_gx_style",geoJson:{type:"FeatureCollection",features:a},name:e.name,opacity:null!=e.opacity?e.opacity:1})}},Markers:function(e){for(var t=[],i=0,s=e.markers.length;s>i;i++){var n=e.markers[i],r=new OpenLayers.Geometry.Point(n.lonlat.lon,n.lonlat.lat),a={externalGraphic:n.icon.url,graphicWidth:n.icon.size.w,graphicHeight:n.icon.size.h,graphicXOffset:n.icon.offset.x,graphicYOffset:n.icon.offset.y},o=new OpenLayers.Feature.Vector(r,{},a);t.push(o)}var l=new OpenLayers.Layer.Vector(e.name);l.addFeatures(t);var h=this.encoders.layers.Vector.call(this,l);return l.destroy(),h}},legends:{gx_wmslegend:function(e,t){for(var i=this.encoders.legends.base.call(this,e),s=[],n=1,r=e.items.getCount();r>n;++n){var a=e.items.get(n).url;if(e.useScaleParameter===!0&&-1!=a.toLowerCase().indexOf("request=getlegendgraphic")){var o=a.split("?"),l=Ext.urlDecode(o[1]);l.SCALE=t,a=o[0]+"?"+Ext.urlEncode(l)}s.push(this.getAbsoluteUrl(a))}return i[0].classes[0]={name:"",icons:s},i},gx_urllegend:function(e){var t=this.encoders.legends.base.call(this,e);return t[0].classes.push({name:"",icon:this.getAbsoluteUrl(e.items.get(1).url)}),t},base:function(e){return[{name:e.getLabel(),classes:[]}]}}}}),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt","GeoExt.data"),GeoExt.data.ProtocolProxy=function(e){Ext.apply(this,e),GeoExt.data.ProtocolProxy.superclass.constructor.apply(this,arguments)},Ext.extend(GeoExt.data.ProtocolProxy,Ext.data.DataProxy,{protocol:null,abortPrevious:!0,setParamsAsOptions:!1,response:null,load:function(e,t,i,s,n){if(this.fireEvent("beforeload",this,e)!==!1){var r={params:e||{},request:{callback:i,scope:s,arg:n},reader:t},a=OpenLayers.Function.bind(this.loadResponse,this,r);this.abortPrevious&&this.abortRequest();var o={params:e,callback:a,scope:this};Ext.applyIf(o,n),this.setParamsAsOptions===!0&&(Ext.applyIf(o,o.params),delete o.params),this.response=this.protocol.read(o)}else i.call(s||this,null,n,!1)},abortRequest:function(){this.response&&(this.protocol.abort(this.response),this.response=null)},loadResponse:function(e,t){if(t.success()){var i=e.reader.read(t);this.fireEvent("load",this,e,e.request.arg),e.request.callback.call(e.request.scope,i,e.request.arg,!0)}else this.fireEvent("loadexception",this,e,t),e.request.callback.call(e.request.scope,null,e.request.arg,!1)}}),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.data"),GeoExt.data.ScaleStore=Ext.extend(Ext.data.Store,{map:null,constructor:function(e){var t=e.map instanceof GeoExt.MapPanel?e.map.map:e.map;delete e.map,e=Ext.applyIf(e,{reader:new Ext.data.JsonReader({},["level","resolution","scale"])}),GeoExt.data.ScaleStore.superclass.constructor.call(this,e),t&&this.bind(t)},bind:function(e){this.map=e instanceof GeoExt.MapPanel?e.map:e,this.map.events.register("changebaselayer",this,this.populateFromMap),this.map.baseLayer?this.populateFromMap():this.map.events.register("addlayer",this,this.populateOnAdd)},unbind:function(){this.map&&(this.map.events.unregister("addlayer",this,this.populateOnAdd),this.map.events.unregister("changebaselayer",this,this.populateFromMap),delete this.map)},populateOnAdd:function(e){e.layer.isBaseLayer&&(this.populateFromMap(),this.map.events.unregister("addlayer",this,this.populateOnAdd))},populateFromMap:function(){for(var e=[],t=this.map.baseLayer.resolutions,i=this.map.baseLayer.units,s=t.length-1;s>=0;s--){var n=t[s];e.push({level:s,resolution:n,scale:OpenLayers.Util.getScaleFromResolution(n,i)})}this.loadData(e)},destroy:function(){this.unbind(),GeoExt.data.ScaleStore.superclass.destroy.apply(this,arguments)}}),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.data"),GeoExt.data.StyleReader=Ext.extend(Ext.data.JsonReader,{onMetaChange:function(){GeoExt.data.StyleReader.superclass.onMetaChange.apply(this,arguments),this.recordType.prototype.commit=Ext.createInterceptor(this.recordType.prototype.commit,function(){var e=this.store.reader;e.raw[e.meta.root]=e.meta.storeToData(this.store)})},readRecords:function(e){var t;t=e instanceof OpenLayers.Symbolizer.Raster?"colorMap":"rules",this.raw=e,Ext.applyIf(this.meta,GeoExt.data.StyleReader.metaData[t]);var i={metaData:this.meta};return i[t]=e[t],GeoExt.data.StyleReader.superclass.readRecords.call(this,i)}}),GeoExt.data.StyleReader.metaData={colorMap:{root:"colorMap",idProperty:"filter",fields:[{name:"symbolizers",mapping:function(e){return{fillColor:e.color,fillOpacity:e.opacity,stroke:!1}}},{name:"filter",mapping:"quantity",type:"float"},{name:"label",mapping:function(e){return e.label||e.quantity}}],storeToData:function(e){e.sort("filter","ASC");var t=[];return e.each(function(e){var i=e.get("symbolizers"),s=e.get("label"),n=e.isModified("label"),r=Number(e.get("filter"));e.data.filter=r,(!e.json.label&&!n&&e.isModified("filter")||n&&!s)&&(e.data.label=r),t.push(Ext.apply(e.json,{color:i.fillColor,label:"string"==typeof s?s:void 0,opacity:i.opacity,quantity:r}))}),t}},rules:{root:"rules",fields:["symbolizers","filter",{name:"label",mapping:"title"},"name","description","elseFilter","minScaleDenominator","maxScaleDenominator"],storeToData:function(e){var t=[];return e.each(function(e){var i=e.get("filter");"string"==typeof i&&(i=i?OpenLayers.Format.CQL.prototype.read(i):null),t.push(Ext.apply(e.json,{symbolizers:e.get("symbolizers"),filter:i,title:e.get("label"),name:e.get("name"),description:e.get("description"),elseFilter:e.get("elseFilter"),minScaleDenominator:e.get("minScaleDenominator"),maxScaleDenominator:e.get("maxScaleDenominator")}))}),t}}},/**
 * Copyright (c) 2008-2011 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.data"),GeoExt.data.WCSCapabilitiesReader=function(e,t){e=e||{},e.format||(e.format=new OpenLayers.Format.WCSCapabilities),"function"!=typeof t&&(fields=t||e.fields||[{name:"title",type:"string"},{name:"abstract",type:"string"}],fields.push({name:"name",type:"string",mapping:"identifier"}),t=Ext.data.Record.create(fields)),GeoExt.data.WCSCapabilitiesReader.superclass.constructor.call(this,e,t)},Ext.extend(GeoExt.data.WCSCapabilitiesReader,Ext.data.DataReader,{read:function(e){var t=e.responseXML;return t&&t.documentElement||(t=e.responseText),this.readRecords(t)},readRecords:function(e){("string"==typeof e||e.nodeType)&&(e=this.meta.format.read(e));for(var t,i,s,n,r=e.contentMetadata,a=this.recordType.prototype.fields,o=[],l=0,h=r.length;h>l;l++){t=r[l];var u=t.identifier;if(u){i={};for(var c=0,d=a.length;d>c;c++)s=a.items[c],n=t[s.mapping||s.name]||s.defaultValue,n=s.convert(n),i[s.name]=n;o.push(new this.recordType(i,u))}}return{totalRecords:o.length,success:!0,records:o}}}),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.data"),GeoExt.data.WCSCapabilitiesStore=function(e){e=e||{},GeoExt.data.WCSCapabilitiesStore.superclass.constructor.call(this,Ext.apply(e,{proxy:e.proxy||(e.data?void 0:new Ext.data.HttpProxy({url:e.url,disableCaching:!1,method:"GET"})),reader:new GeoExt.data.WCSCapabilitiesReader(e,e.fields)}))},Ext.extend(GeoExt.data.WCSCapabilitiesStore,Ext.data.Store),/**
 * Copyright (c) 2008-2011 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.data"),GeoExt.data.WCSDescribeCoverageReader=function(e,t){e=e||{},e.format||(e.format=new OpenLayers.Format.WCSDescribeCoverage),"function"!=typeof t&&(fields=t||e.fields||[{name:"title",type:"string"},{name:"nativeCRS",type:"string"},{name:"nativeBoundingBox",mapping:function(e){return e.domain.spatialDomain.boundingBoxes[e.nativeCRS]}},{name:"supportedCRSs"},{name:"supportedFormats"},{name:"gridOffsets",mapping:function(e){return e.domain.spatialDomain.gridCRS&&e.domain.spatialDomain.gridCRS.gridOffsets||void 0}}],fields.push({name:"name",type:"string",mapping:"identifier"}),t=Ext.data.Record.create(fields)),GeoExt.data.WCSDescribeCoverageReader.superclass.constructor.call(this,e,t)},Ext.extend(GeoExt.data.WCSDescribeCoverageReader,Ext.data.DataReader,{read:function(e){var t=e.responseXML;return t&&t.documentElement||(t=e.responseText),this.readRecords(t)},readRecords:function(e){("string"==typeof e||e.nodeType)&&(e=this.meta.format.read(e));for(var t,i,s,n=e.coverageDescriptions,r=e.coverageDescriptionKeys,a=this.recordType.prototype.fields,o=[],l=0,h=r.length;h>l;l++){var u=n[r[l]],c=u.identifier;if(c){t={};for(var d=0,p=a.length;p>d;d++)i=a.items[d],s="function"==typeof i.mapping?i.mapping(u):u[i.mapping||i.name]||i.defaultValue,s=i.convert(s),t[i.name]=s;o.push(new this.recordType(t,c))}}return{totalRecords:o.length,success:!0,records:o}}}),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.data"),GeoExt.data.WCSDescribeCoverageStore=function(e){e=e||{},GeoExt.data.WCSDescribeCoverageStore.superclass.constructor.call(this,Ext.apply(e,{proxy:e.proxy||(e.data?void 0:new Ext.data.HttpProxy({url:e.url,disableCaching:!1,method:"GET"})),reader:new GeoExt.data.WCSDescribeCoverageReader(e,e.fields)}))},Ext.extend(GeoExt.data.WCSDescribeCoverageStore,Ext.data.Store),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.data"),GeoExt.data.WFSCapabilitiesReader=function(e,t){e=e||{},e.format||(e.format=new OpenLayers.Format.WFSCapabilities),"function"!=typeof t&&(t=GeoExt.data.LayerRecord.create(t||e.fields||[{name:"name",type:"string"},{name:"title",type:"string"},{name:"namespace",type:"string",mapping:"featureNS"},{name:"abstract",type:"string"}])),GeoExt.data.WFSCapabilitiesReader.superclass.constructor.call(this,e,t)},Ext.extend(GeoExt.data.WFSCapabilitiesReader,Ext.data.DataReader,{read:function(e){var t=e.responseXML;return t&&t.documentElement||(t=e.responseText),this.readRecords(t)},readRecords:function(e){("string"==typeof e||e.nodeType)&&(e=this.meta.format.read(e));for(var t,i,s,n,r,a,o=e.featureTypeList.featureTypes,l=this.recordType.prototype.fields,h={url:e.capability.request.getfeature.href.post},u=[],c=0,d=o.length;d>c;c++)if(t=o[c],t.name){i={};for(var p=0,f=l.length;f>p;p++)s=l.items[p],n=t[s.mapping||s.name]||s.defaultValue,n=s.convert(n),i[s.name]=n;a={featureType:t.name,featureNS:t.featureNS},this.meta.protocolOptions?Ext.apply(a,this.meta.protocolOptions,h):Ext.apply(a,{},h),r={protocol:new OpenLayers.Protocol.WFS(a),strategies:[new OpenLayers.Strategy.Fixed]};var m=this.meta.layerOptions;m&&Ext.apply(r,Ext.isFunction(m)?m():m),i.layer=new OpenLayers.Layer.Vector(t.title||t.name,r),u.push(new this.recordType(i,i.layer.id))}return{totalRecords:u.length,success:!0,records:u}}}),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.data"),GeoExt.data.WFSCapabilitiesStore=function(e){e=e||{},GeoExt.data.WFSCapabilitiesStore.superclass.constructor.call(this,Ext.apply(e,{proxy:e.proxy||(e.data?void 0:new Ext.data.HttpProxy({url:e.url,disableCaching:!1,method:"GET"})),reader:new GeoExt.data.WFSCapabilitiesReader(e,e.fields)}))},Ext.extend(GeoExt.data.WFSCapabilitiesStore,Ext.data.Store),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.data"),GeoExt.data.WMCReader=function(e,t){e=e||{},e.format||(e.format=new OpenLayers.Format.WMC),"function"!=typeof t&&(t=GeoExt.data.LayerRecord.create(t||e.fields||[{name:"abstract",type:"string"},{name:"metadataURL",type:"string"},{name:"queryable",type:"boolean"},{name:"formats"},{name:"styles"}])),GeoExt.data.WMCReader.superclass.constructor.call(this,e,t)},Ext.extend(GeoExt.data.WMCReader,Ext.data.DataReader,{read:function(e){var t=e.responseXML;return t&&t.documentElement||(t=e.responseText),this.readRecords(t)},readRecords:function(e){var t=this.meta.format;("string"==typeof e||e.nodeType)&&(e=t.read(e));var i=e?e.layersContext:void 0,s=[];if(i){var n,r,a,o,l,h,u,c,d=this.recordType,p=d.prototype.fields;for(n=0,r=i.length;r>n;n++){for(l=i[n],h={},a=0,o=p.length;o>a;a++)u=p.items[a],c=l[u.mapping||u.name]||u.defaultValue,c=u.convert(c),h[u.name]=c;h.layer=t.getLayerFromContext(l),s.push(new this.recordType(h,h.layer.id))}}return{totalRecords:s.length,success:!0,records:s}}}),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.data"),GeoExt.data.WMSCapabilitiesReader=function(e,t){e=e||{},e.format||(e.format=new OpenLayers.Format.WMSCapabilities),"function"!=typeof t&&(t=GeoExt.data.LayerRecord.create(t||e.fields||[{name:"name",type:"string"},{name:"title",type:"string"},{name:"abstract",type:"string"},{name:"queryable",type:"boolean"},{name:"opaque",type:"boolean"},{name:"noSubsets",type:"boolean"},{name:"cascaded",type:"int"},{name:"fixedWidth",type:"int"},{name:"fixedHeight",type:"int"},{name:"minScale",type:"float"},{name:"maxScale",type:"float"},{name:"prefix",type:"string"},{name:"formats"},{name:"styles"},{name:"srs"},{name:"dimensions"},{name:"bbox"},{name:"llbbox"},{name:"attribution"},{name:"keywords"},{name:"identifiers"},{name:"authorityURLs"},{name:"metadataURLs"},{name:"infoFormats"}])),GeoExt.data.WMSCapabilitiesReader.superclass.constructor.call(this,e,t)},Ext.extend(GeoExt.data.WMSCapabilitiesReader,Ext.data.DataReader,{attributionCls:"gx-attribution",read:function(e){var t=e.responseXML;return t&&t.documentElement||(t=e.responseText),this.readRecords(t)},serviceExceptionFormat:function(e){return OpenLayers.Util.indexOf(e,"application/vnd.ogc.se_inimage")>-1?"application/vnd.ogc.se_inimage":OpenLayers.Util.indexOf(e,"application/vnd.ogc.se_xml")>-1?"application/vnd.ogc.se_xml":e[0]},imageFormat:function(e){var t=e.formats;return e.opaque&&OpenLayers.Util.indexOf(t,"image/jpeg")>-1?"image/jpeg":OpenLayers.Util.indexOf(t,"image/png")>-1?"image/png":OpenLayers.Util.indexOf(t,"image/png; mode=24bit")>-1?"image/png; mode=24bit":OpenLayers.Util.indexOf(t,"image/gif")>-1?"image/gif":t[0]},imageTransparent:function(e){return void 0==e.opaque||!e.opaque},readRecords:function(e){if(("string"==typeof e||e.nodeType)&&(e=this.meta.format.read(e)),e.error)throw new Ext.data.DataReader.Error("invalid-response",e.error);var t=e.version,i=e.capability||{},s=i.request&&i.request.getmap&&i.request.getmap.href,n=i.layers,r=i.exception?i.exception.formats:[],a=this.serviceExceptionFormat(r),o=[];if(s&&n)for(var l,h,u,c,d,p,f=this.recordType.prototype.fields,m=0,y=n.length;y>m;m++)if(l=n[m],l.name){h={};for(var g=0,v=f.length;v>g;g++)d=f.items[g],p=l[d.mapping||d.name]||d.defaultValue,p=d.convert(p),h[d.name]=p;u={attribution:l.attribution?this.attributionMarkup(l.attribution):void 0,minScale:l.minScale,maxScale:l.maxScale},this.meta.layerOptions&&Ext.apply(u,this.meta.layerOptions),c={layers:l.name,exceptions:a,format:this.imageFormat(l),transparent:this.imageTransparent(l),version:t},this.meta.layerParams&&Ext.apply(c,this.meta.layerParams),h.layer=new OpenLayers.Layer.WMS(l.title||l.name,s,c,u),o.push(new this.recordType(h,h.layer.id))}return{totalRecords:o.length,success:!0,records:o}},attributionMarkup:function(e){var t=[];if(e.logo&&t.push("<img class='"+this.attributionCls+"-image' "+"src='"+e.logo.href+"' />"),e.title&&t.push("<span class='"+this.attributionCls+"-title'>"+e.title+"</span>"),e.href)for(var i=0;i<t.length;i++)t[i]="<a class='"+this.attributionCls+"-link' "+"href="+e.href+">"+t[i]+"</a>";return t.join(" ")}}),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.data"),GeoExt.data.WMSCapabilitiesStore=function(e){e=e||{},GeoExt.data.WMSCapabilitiesStore.superclass.constructor.call(this,Ext.apply(e,{proxy:e.proxy||(e.data?void 0:new Ext.data.HttpProxy({url:e.url,disableCaching:!1,method:"GET"})),reader:new GeoExt.data.WMSCapabilitiesReader(e,e.fields)}))},Ext.extend(GeoExt.data.WMSCapabilitiesStore,Ext.data.Store),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.data"),GeoExt.data.WMSDescribeLayerReader=function(e,t){e=e||{},e.format||(e.format=new OpenLayers.Format.WMSDescribeLayer),"function"!=typeof t&&(t=Ext.data.Record.create(t||e.fields||[{name:"owsType",type:"string"},{name:"owsURL",type:"string"},{name:"typeName",type:"string"}])),GeoExt.data.WMSDescribeLayerReader.superclass.constructor.call(this,e,t)},Ext.extend(GeoExt.data.WMSDescribeLayerReader,Ext.data.DataReader,{read:function(e){var t=e.responseXML;return t&&t.documentElement||(t=e.responseText),this.readRecords(t)},readRecords:function(e){if(("string"==typeof e||e.nodeType)&&(e=this.meta.format.read(e)),e.error)throw new Ext.data.DataReader.Error("invalid-response",e.error);for(var t,i=[],s=0,n=e.length;n>s;s++)t=e[s],t&&i.push(new this.recordType(t));return{totalRecords:i.length,success:!0,records:i}}}),/**x
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.data"),GeoExt.data.WMSDescribeLayerStore=function(e){e=e||{},GeoExt.data.WMSDescribeLayerStore.superclass.constructor.call(this,Ext.apply(e,{proxy:e.proxy||(e.data?void 0:new Ext.data.HttpProxy({url:e.url,disableCaching:!1,method:"GET"})),reader:new GeoExt.data.WMSDescribeLayerReader(e,e.fields)}))},Ext.extend(GeoExt.data.WMSDescribeLayerStore,Ext.data.Store),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 *
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
GeoExt.Lang.add("fr",{"GeoExt.tree.LayerContainer.prototype":{text:"Couches"},"GeoExt.tree.BaseLayerContainer.prototype":{text:"Couches de base"},"GeoExt.tree.OverlayLayerContainer.prototype":{text:"Couches additionnelles"}}),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 *
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
GeoExt.Lang.add("nl",{"GeoExt.tree.LayerContainer.prototype":{text:"Kaartlagen"},"GeoExt.tree.BaseLayerContainer.prototype":{text:"Basis kaarten"},"GeoExt.tree.OverlayLayerContainer.prototype":{text:"Kaart overlays"}}),/**
 * Copyright (c) 2008-2009 The Open Source Geospatial Foundation
 *
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.plugins"),GeoExt.plugins.AttributeForm=function(e){Ext.apply(this,e)},GeoExt.plugins.AttributeForm.prototype={attributeStore:null,formPanel:null,init:function(e){this.formPanel=e,this.attributeStore instanceof Ext.data.Store&&(this.fillForm(),this.bind(this.attributeStore)),e.on("destroy",this.onFormDestroy,this)},bind:function(e){this.unbind(),e.on({load:this.onLoad,scope:this}),this.attributeStore=e},unbind:function(){this.attributeStore&&this.attributeStore.un("load",this.onLoad,this)},onLoad:function(){this.formPanel.items&&this.formPanel.removeAll(),this.fillForm()},fillForm:function(){this.attributeStore.each(function(e){var t=GeoExt.form.recordToField(e,Ext.apply({checkboxLabelProperty:"fieldLabel"},this.recordToFieldOptions||{}));t&&this.formPanel.add(t)},this),this.formPanel.doLayout()},onFormDestroy:function(){this.unbind()}},Ext.preg("gx_attributeform",GeoExt.plugins.AttributeForm),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.plugins"),GeoExt.plugins.PrintExtent=Ext.extend(Ext.util.Observable,{initialConfig:null,printProvider:null,map:null,layer:null,transformFeatureOptions:null,control:null,pages:null,page:null,constructor:function(e){e=e||{},Ext.apply(this,e),this.initialConfig=e,this.printProvider||(this.printProvider=this.pages[0].printProvider),this.pages||(this.pages=[]),this.addEvents("selectpage"),GeoExt.plugins.PrintExtent.superclass.constructor.apply(this,arguments)},print:function(e){this.printProvider.print(this.map,this.pages,e)},init:function(e){this.map=e.map,e.on("destroy",this.onMapPanelDestroy,this),this.layer||(this.layer=new OpenLayers.Layer.Vector(null,{displayInLayerSwitcher:!1})),this.createControl();for(var t=0,i=this.pages.length;i>t;++t)this.addPage(this.pages[t]);this.show()},addPage:function(e){e=e||new GeoExt.data.PrintPage({printProvider:this.printProvider}),-1===this.pages.indexOf(e)&&this.pages.push(e),this.layer.addFeatures([e.feature]),e.on("change",this.onPageChange,this),this.page=e;var t=this.map;return t.getCenter()?this.fitPage():t.events.register("moveend",this,function(){t.events.unregister("moveend",this,arguments.callee),this.fitPage()}),e},removePage:function(e){this.pages.remove(e),e.feature.layer&&this.layer.removeFeatures([e.feature]),e.un("change",this.onPageChange,this)},selectPage:function(e){this.control.active&&this.control.setFeature(e.feature)},show:function(){this.map.addLayer(this.layer),this.map.addControl(this.control),this.control.activate(),this.page&&this.map.getCenter()&&this.updateBox()},hide:function(){var e=this.map,t=this.layer,i=this.control;i&&i.events&&(i.deactivate(),e&&e.events&&i.map&&e.removeControl(i)),e&&e.events&&t&&t.map&&e.removeLayer(t)},onMapPanelDestroy:function(){for(var e=this.map,t=this.pages.length-1,i=t;i>=0;i--)this.removePage(this.pages[i]);this.hide();var s=this.control;e&&e.events&&s&&s.events&&s.destroy();var n=this.layer;!this.initialConfig.layer&&e&&e.events&&n&&n.events&&n.destroy(),delete this.layer,delete this.control,delete this.page,this.map=null},createControl:function(){this.control=new OpenLayers.Control.TransformFeature(this.layer,Ext.applyIf({preserveAspectRatio:!0,eventListeners:{beforesetfeature:function(e){for(var t=0,i=this.pages.length;i>t;++t)if(this.pages[t].feature===e.feature){this.page=this.pages[t],e.object.rotation=-this.pages[t].rotation;break}},setfeature:function(e){for(var t=0,i=this.pages.length;i>t;++t)if(this.pages[t].feature===e.feature){this.fireEvent("selectpage",this.pages[t]);break}},beforetransform:function(e){this._updating=!0;var t=this.page;if(e.rotation)this.printProvider.layout.get("rotation")?t.setRotation(-e.object.rotation):e.object.setFeature(t.feature);else if(e.center)t.setCenter(OpenLayers.LonLat.fromString(e.center.toShortString()));else{t.fit(e.object.box,{mode:"closest"});var i=this.printProvider.scales.getAt(0),s=this.printProvider.scales.getAt(this.printProvider.scales.getCount()-1),n=e.object.box.geometry.getBounds(),r=t.feature.geometry.getBounds(),a=t.scale===i&&n.containsBounds(r),o=t.scale===s&&r.containsBounds(n);(a===!0||o===!0)&&this.updateBox()}return delete this._updating,!1},transformcomplete:this.updateBox,scope:this}},this.transformFeatureOptions))},fitPage:function(){this.page&&this.page.fit(this.map,{mode:"screen"})},updateBox:function(){var e=this.page;this.control.active&&this.control.setFeature(e.feature,{rotation:-e.rotation})},onPageChange:function(e){this._updating||this.control.active&&this.control.setFeature(e.feature,{rotation:-e.rotation})}}),Ext.preg("gx_printextent",GeoExt.plugins.PrintExtent),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.plugins"),GeoExt.plugins.PrintPageField=Ext.extend(Ext.util.Observable,{printPage:null,target:null,constructor:function(e){this.initialConfig=e,Ext.apply(this,e),GeoExt.plugins.PrintPageField.superclass.constructor.apply(this,arguments)},init:function(e){this.target=e;var t={beforedestroy:this.onBeforeDestroy,scope:this},i=e instanceof Ext.form.ComboBox?"select":e instanceof Ext.form.Checkbox?"check":"valid";t[i]=this.onFieldChange,e.on(t),this.printPage.on({change:this.onPageChange,scope:this}),this.printPage.printProvider.on({layoutchange:this.onLayoutChange,scope:this}),this.setValue(this.printPage)},onFieldChange:function(e,t){var i=this.printPage.printProvider,s=e.getValue();this._updating=!0,e.store===i.scales||"scale"===e.name?this.printPage.setScale(t):"rotation"==e.name?!isNaN(s)&&this.printPage.setRotation(s):this.printPage.customParams[e.name]=s,delete this._updating},onPageChange:function(e){this._updating||this.setValue(e)},onLayoutChange:function(e,t){var i=this.target;"rotation"==i.name&&i.setDisabled(!t.get("rotation"))},setValue:function(e){var t=this.target;t.suspendEvents(),t.store===e.printProvider.scales||"scale"===t.name?e.scale&&t.setValue(e.scale.get(t.displayField)):"rotation"==t.name&&t.setValue(e.rotation),t.resumeEvents()},onBeforeDestroy:function(){this.target.un("beforedestroy",this.onBeforeDestroy,this),this.target.un("select",this.onFieldChange,this),this.target.un("valid",this.onFieldChange,this),this.printPage.un("change",this.onPageChange,this),this.printPage.printProvider.un("layoutchange",this.onLayoutChange,this)}}),Ext.preg("gx_printpagefield",GeoExt.plugins.PrintPageField),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.plugins"),GeoExt.plugins.PrintProviderField=Ext.extend(Ext.util.Observable,{target:null,constructor:function(e){this.initialConfig=e,Ext.apply(this,e),GeoExt.plugins.PrintProviderField.superclass.constructor.apply(this,arguments)},init:function(e){this.target=e;var t={scope:this,render:this.onRender,beforedestroy:this.onBeforeDestroy};t[e instanceof Ext.form.ComboBox?"select":"valid"]=this.onFieldChange,e.on(t)},onRender:function(e){var t=this.printProvider||e.ownerCt.printProvider;e.store===t.layouts?(e.setValue(t.layout.get(e.displayField)),t.on({layoutchange:this.onProviderChange,scope:this})):e.store===t.dpis?(e.setValue(t.dpi.get(e.displayField)),t.on({dpichange:this.onProviderChange,scope:this})):void 0===e.initialConfig.value&&e.setValue(t.customParams[e.name])},onFieldChange:function(e,t){var i=this.printProvider||e.ownerCt.printProvider,s=e.getValue();if(this._updating=!0,t)switch(e.store){case i.layouts:i.setLayout(t);break;case i.dpis:i.setDpi(t)}else i.customParams[e.name]=s;delete this._updating},onProviderChange:function(e,t){this._updating||this.target.setValue(t.get(this.target.displayField))},onBeforeDestroy:function(){var e=this.target;e.un("beforedestroy",this.onBeforeDestroy,this),e.un("render",this.onRender,this),e.un("select",this.onFieldChange,this),e.un("valid",this.onFieldChange,this);var t=this.printProvider||e.ownerCt.printProvider;t.un("layoutchange",this.onProviderChange,this),t.un("dpichange",this.onProviderChange,this)}}),Ext.preg("gx_printproviderfield",GeoExt.plugins.PrintProviderField),/**
 * Copyright (c) 2008-2009 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.plugins"),GeoExt.plugins.TreeNodeActions=Ext.extend(Ext.util.Observable,{actionsCls:"gx-tree-layer-actions",actionCls:"gx-tree-layer-action",constructor:function(e){Ext.apply(this.initialConfig,Ext.apply({},e)),Ext.apply(this,e),this.addEvents("action"),GeoExt.plugins.TreeNodeActions.superclass.constructor.apply(this,arguments)},init:function(e){e.on({rendernode:this.onRenderNode,beforedestroy:this.onBeforeDestroy,scope:this})},onRenderNode:function(e){var t=e.rendered;if(!t){var i=e.attributes,s=i.actions||this.actions;if(s&&s.length>0)for(var n='<div class="'+this.actionsCls+'"></div>',r=Ext.DomHelper.insertFirst(e.ui.elNode,n),a=0,o=s.length;o>a;a++){var l=s[a],h=l.action,u=Ext.get(Ext.DomHelper.append(r,this.createActionMarkup(e,l)));u.on({click:function(e,t,i,s,n){this.fireEvent("action",s,n,e)}.createDelegate(this,[e,h],!0)})}e.layer&&e.layer.map?this.updateActions(e):e.layerStore&&e.layerStore.on({bind:function(){this.updateActions(e)},scope:this})}},createActionMarkup:function(e,t){return'<img id="'+e.id+"_"+t.action+'" ext:qtip="'+t.qtip+'" src="'+Ext.BLANK_IMAGE_URL+'" class="'+this.actionCls+" "+t.action+'" />'},updateActions:function(e){var t=e.attributes.actions||this.actions||[];Ext.each(t,function(t){var i=Ext.get(e.id+"_"+t.action);i&&"function"==typeof t.update&&t.update.call(e,i)})},onBeforeDestroy:function(e){e.un("rendernode",this.onRenderNode,this),e.un("beforedestroy",this.onBeforeDestroy,this)}}),Ext.preg("gx_treenodeactions",GeoExt.plugins.TreeNodeActions),/**
 * Copyright (c) 2008-2009 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.plugins"),GeoExt.plugins.TreeNodeComponent=Ext.extend(Ext.util.Observable,{constructor:function(e){Ext.apply(this.initialConfig,Ext.apply({},e)),Ext.apply(this,e),GeoExt.plugins.TreeNodeComponent.superclass.constructor.apply(this,arguments)},init:function(e){e.on({rendernode:this.onRenderNode,beforedestroy:this.onBeforeDestroy,scope:this})},onRenderNode:function(e){var t=e.rendered,i=e.attributes,s=i.component||this.component;if(!t&&s){var n=Ext.DomHelper.append(e.ui.elNode,[{tag:"div"}]);"function"==typeof s?s=s(e,n):"object"==typeof s&&"function"==typeof s.fn&&(s=s.fn.apply(s.scope,[e,n])),"object"==typeof s&&"string"==typeof s.xtype&&(s=Ext.ComponentMgr.create(s)),s instanceof Ext.Component&&(s.render(n),e.component=s)}},onBeforeDestroy:function(e){e.un("rendernode",this.onRenderNode,this),e.un("beforedestroy",this.onBeforeDestroy,this)}}),Ext.preg("gx_treenodecomponent",GeoExt.plugins.TreeNodeComponent),/**
 * Copyright (c) 2008-2009 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.plugins"),GeoExt.plugins.TreeNodeRadioButton=Ext.extend(Ext.util.Observable,{constructor:function(e){Ext.apply(this.initialConfig,Ext.apply({},e)),Ext.apply(this,e),this.addEvents("radiochange"),GeoExt.plugins.TreeNodeRadioButton.superclass.constructor.apply(this,arguments)},init:function(e){e.on({rendernode:this.onRenderNode,rawclicknode:this.onRawClickNode,disabledchange:this.onDisabledChange,beforedestroy:this.onBeforeDestroy,scope:this})},onRenderNode:function(e){var t=e.attributes;t.radioGroup&&!t.radio&&(t.radio=Ext.DomHelper.insertBefore(e.ui.anchor,['<input type="radio" class="gx-tree-radio" name="',t.radioGroup,'_radio"></input>'].join("")))},onRawClickNode:function(e,t){var i=t.getTarget(".gx-tree-radio",1);return i?(i.defaultChecked=i.checked,this.fireEvent("radiochange",e),!1):void 0},onDisabledChange:function(e,t){var i=e.attributes.radio;i&&(i.disabled=t)},onBeforeDestroy:function(e){e.un("rendernode",this.onRenderNode,this),e.un("rawclicknode",this.onRawClickNode,this),e.un("beforedestroy",this.onBeforeDestroy,this)}}),Ext.preg("gx_treenoderadiobutton",GeoExt.plugins.TreeNodeRadioButton),/**
 * Copyright (c) 2008-2009 The Open Source Geospatial Foundation
 *
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.state"),GeoExt.state.PermalinkProvider=function(e){GeoExt.state.PermalinkProvider.superclass.constructor.apply(this,arguments),e=e||{};var t=e.url;delete e.url,Ext.apply(this,e),this.state=this.readURL(t)},Ext.extend(GeoExt.state.PermalinkProvider,Ext.state.Provider,{encodeType:!0,readURL:function(e){var t,i,s,n={},r=OpenLayers.Util.getParameters(e);for(t in r)r.hasOwnProperty(t)&&(i=t.split("_"),i.length>1&&(s=i[0],n[s]=n[s]||{},n[s][i.slice(1).join("_")]=this.encodeType?this.decodeValue(r[t]):r[t]));return n},getLink:function(e){e=e||document.location.href;var t,i,s={},n=this.state;for(t in n)if(n.hasOwnProperty(t))for(i in n[t])s[t+"_"+i]=this.encodeType?unescape(this.encodeValue(n[t][i])):n[t][i];OpenLayers.Util.applyDefaults(s,OpenLayers.Util.getParameters(e));var r=OpenLayers.Util.getParameterString(s),a=e.indexOf("?");return a>0&&(e=e.substring(0,a)),Ext.urlAppend(e,r)}}),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt"),GeoExt.Action=Ext.extend(Ext.Action,{control:null,activateOnEnable:!1,deactivateOnDisable:!1,map:null,uScope:null,uHandler:null,uToggleHandler:null,uCheckHandler:null,constructor:function(e){this.uScope=e.scope,this.uHandler=e.handler,this.uToggleHandler=e.toggleHandler,this.uCheckHandler=e.checkHandler,e.scope=this,e.handler=this.pHandler,e.toggleHandler=this.pToggleHandler,e.checkHandler=this.pCheckHandler;var t=this.control=e.control;delete e.control,this.activateOnEnable=!!e.activateOnEnable,delete e.activateOnEnable,this.deactivateOnDisable=!!e.deactivateOnDisable,delete e.deactivateOnDisable,t&&(e.map&&(e.map.addControl(t),delete e.map),(e.pressed||e.checked)&&t.map&&t.activate(),t.active&&(e.pressed=!0,e.checked=!0),t.events.on({activate:this.onCtrlActivate,deactivate:this.onCtrlDeactivate,scope:this})),arguments.callee.superclass.constructor.call(this,e)},pHandler:function(){var e=this.control;e&&e.type==OpenLayers.Control.TYPE_BUTTON&&e.trigger(),this.uHandler&&this.uHandler.apply(this.uScope,arguments)},pToggleHandler:function(e,t){this.changeControlState(t),this.uToggleHandler&&this.uToggleHandler.apply(this.uScope,arguments)},pCheckHandler:function(e,t){this.changeControlState(t),this.uCheckHandler&&this.uCheckHandler.apply(this.uScope,arguments)},changeControlState:function(e){e?this._activating||(this._activating=!0,this.control.activate(),this.initialConfig.pressed=!0,this.initialConfig.checked=!0,this._activating=!1):this._deactivating||(this._deactivating=!0,this.control.deactivate(),this.initialConfig.pressed=!1,this.initialConfig.checked=!1,this._deactivating=!1)},onCtrlActivate:function(){var e=this.control;e.type==OpenLayers.Control.TYPE_BUTTON?this.enable():(this.safeCallEach("toggle",[!0]),this.safeCallEach("setChecked",[!0]))},onCtrlDeactivate:function(){var e=this.control;e.type==OpenLayers.Control.TYPE_BUTTON?this.disable():(this.safeCallEach("toggle",[!1]),this.safeCallEach("setChecked",[!1]))},safeCallEach:function(e,t){for(var i=this.items,s=0,n=i.length;n>s;s++)i[s][e]&&(i[s].rendered?i[s][e].apply(i[s],t):i[s].on({render:i[s][e].createDelegate(i[s],t),single:!0}))},setDisabled:function(e){return!e&&this.activateOnEnable&&this.control&&!this.control.active&&this.control.activate(),e&&this.deactivateOnDisable&&this.control&&this.control.active&&this.control.deactivate(),GeoExt.Action.superclass.setDisabled.apply(this,arguments)}}),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt"),GeoExt.FeatureRenderer=Ext.extend(Ext.BoxComponent,{feature:void 0,symbolizers:[OpenLayers.Feature.Vector.style["default"]],symbolType:"Polygon",labelText:null,resolution:1,minWidth:20,minHeight:20,renderers:["SVG","VML","Canvas"],rendererOptions:null,pointFeature:void 0,lineFeature:void 0,polygonFeature:void 0,textFeature:void 0,renderer:null,initComponent:function(){GeoExt.FeatureRenderer.superclass.initComponent.apply(this,arguments),Ext.applyIf(this,{pointFeature:new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(0,0)),lineFeature:new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([new OpenLayers.Geometry.Point(-8,-3),new OpenLayers.Geometry.Point(-3,3),new OpenLayers.Geometry.Point(3,-3),new OpenLayers.Geometry.Point(8,3)])),polygonFeature:new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(-8,-4),new OpenLayers.Geometry.Point(-6,-6),new OpenLayers.Geometry.Point(6,-6),new OpenLayers.Geometry.Point(8,-4),new OpenLayers.Geometry.Point(8,4),new OpenLayers.Geometry.Point(6,6),new OpenLayers.Geometry.Point(-6,6),new OpenLayers.Geometry.Point(-8,4)])])),textFeature:new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(0,0))}),this.feature||this.setFeature(null,{draw:!1}),this.addEvents("click")},initCustomEvents:function(){this.clearCustomEvents(),this.el.on("click",this.onClick,this)},clearCustomEvents:function(){this.el&&this.el.removeAllListeners&&this.el.removeAllListeners()},onClick:function(){this.fireEvent("click",this)},onRender:function(){this.el||(this.el=document.createElement("div"),this.el.id=this.getId()),this.renderer&&this.renderer.supported()||this.assignRenderer(),this.renderer.map={getResolution:function(){return this.resolution}.createDelegate(this)},GeoExt.FeatureRenderer.superclass.onRender.apply(this,arguments),this.drawFeature()},afterRender:function(){GeoExt.FeatureRenderer.superclass.afterRender.apply(this,arguments),this.initCustomEvents()},onResize:function(){this.setRendererDimensions(),GeoExt.FeatureRenderer.superclass.onResize.apply(this,arguments)},setRendererDimensions:function(){var e=this.feature.geometry.getBounds(),t=e.getWidth(),i=e.getHeight(),s=this.initialConfig.resolution;s||(s=Math.max(t/this.width||0,i/this.height||0)||1),this.resolution=s;var n=Math.max(this.width||this.minWidth,t/s),r=Math.max(this.height||this.minHeight,i/s),a=e.getCenterPixel(),o=n*s/2,l=r*s/2,h=new OpenLayers.Bounds(a.x-o,a.y-l,a.x+o,a.y+l);this.renderer.setSize(new OpenLayers.Size(Math.round(n),Math.round(r))),this.renderer.setExtent(h,!0)},assignRenderer:function(){for(var e=0,t=this.renderers.length;t>e;++e){var i=OpenLayers.Renderer[this.renderers[e]];if(i&&i.prototype.supported()){this.renderer=new i(this.el,this.rendererOptions);break}}},setSymbolizers:function(e,t){this.symbolizers=e,(!t||t.draw)&&this.drawFeature()},setSymbolType:function(e,t){this.symbolType=e,this.setFeature(null,t)},setFeature:function(e,t){this.feature=e||this[this.symbolType.toLowerCase()+"Feature"],(!t||t.draw)&&this.drawFeature()},drawFeature:function(){this.renderer.clear(),this.setRendererDimensions();for(var e,t,i,s=0,n=this.symbolizers.length;n>s;++s)e=this.symbolizers[s],t=this.feature,e instanceof OpenLayers.Symbolizer?(e=e.clone(),OpenLayers.Symbolizer.Text&&e instanceof OpenLayers.Symbolizer.Text&&e.graphic===!1&&(e.fill=e.stroke=!1),this.initialConfig.feature||(i=e.CLASS_NAME.split(".").pop().toLowerCase(),t=this[i+"Feature"])):e=Ext.apply({},e),void 0!==e.label&&null!==this.labelText&&(e.label=this.labelText),this.renderer.drawFeature(t.clone(),e)},update:function(e){e=e||{},e.feature?this.setFeature(e.feature,{draw:!1}):e.symbolType&&this.setSymbolType(e.symbolType,{draw:!1}),e.symbolizers&&this.setSymbolizers(e.symbolizers,{draw:!1}),this.drawFeature()},beforeDestroy:function(){this.clearCustomEvents(),this.renderer&&this.renderer.destroy()}}),Ext.reg("gx_renderer",GeoExt.FeatureRenderer),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 *
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt"),GeoExt.LayerLegend=Ext.extend(Ext.Container,{layerRecord:null,showTitle:!0,legendTitle:null,labelCls:null,layerStore:null,initComponent:function(){GeoExt.LayerLegend.superclass.initComponent.call(this),this.autoEl={},this.add({xtype:"label",html:this.getLayerTitle(this.layerRecord),cls:"x-form-item x-form-item-label"+(this.labelCls?" "+this.labelCls:"")}),this.layerRecord&&this.layerRecord.store&&(this.layerStore=this.layerRecord.store,this.layerStore.on("update",this.onStoreUpdate,this),this.layerStore.on("add",this.onStoreAdd,this),this.layerStore.on("remove",this.onStoreRemove,this))},getLabel:function(){var e=this.items.get(0);return e.rendered?e.el.dom.innerHTML:e.html},onStoreRemove:function(){},onStoreAdd:function(){},onStoreUpdate:function(e,t){if(t===this.layerRecord&&this.items.getCount()>0){var i=t.getLayer();this.setVisible(i.getVisibility()&&i.calculateInRange()&&i.displayInLayerSwitcher&&!t.get("hideInLegend")),this.update()}},update:function(){var e=this.getLayerTitle(this.layerRecord),t=this.items.itemAt(0);t instanceof Ext.form.Label&&this.getLabel()!==e&&t.setText(e,!1)},getLayerTitle:function(e){var t=this.legendTitle||"";return this.showTitle&&!t&&e&&!e.get("hideTitle")&&(t=e.get("title")||e.get("name")||e.getLayer().name||""),t},beforeDestroy:function(){this.layerStore&&(this.layerStore.un("update",this.onStoreUpdate,this),this.layerStore.un("remove",this.onStoreRemove,this),this.layerStore.un("add",this.onStoreAdd,this)),GeoExt.LayerLegend.superclass.beforeDestroy.apply(this,arguments)},onDestroy:function(){this.layerRecord=null,this.layerStore=null,GeoExt.LayerLegend.superclass.onDestroy.apply(this,arguments)}}),GeoExt.LayerLegend.getTypes=function(e,t){var i,s,n=(t||[]).concat(),r=[];for(s in GeoExt.LayerLegend.types)i=GeoExt.LayerLegend.types[s].supports(e),i>0?-1==n.indexOf(s)&&r.push({type:s,score:i}):n.remove(s);r.sort(function(e,t){return e.score<t.score?1:e.score==t.score?0:-1});for(var a=r.length,o=new Array(a),l=0;a>l;++l)o[l]=r[l].type;return n.concat(o)},GeoExt.LayerLegend.supports=function(){},GeoExt.LayerLegend.types={},/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * Published under the BSD license.
 * See http://geoext.org/svn/geoext/core/trunk/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt"),GeoExt.LayerOpacitySlider=Ext.extend(Ext.slider.SingleSlider,{layer:null,complementaryLayer:null,delay:5,changeVisibilityDelay:5,aggressive:!1,changeVisibility:!1,value:null,inverse:!1,constructor:function(e){e.layer&&(this.layer=this.getLayer(e.layer),this.bind(),this.complementaryLayer=this.getLayer(e.complementaryLayer),void 0!==e.inverse&&(this.inverse=e.inverse),e.value=void 0!==e.value?e.value:this.getOpacityValue(this.layer),delete e.layer,delete e.complementaryLayer),GeoExt.LayerOpacitySlider.superclass.constructor.call(this,e)},bind:function(){this.layer&&this.layer.map&&this.layer.map.events.on({changelayer:this.update,scope:this})},unbind:function(){this.layer&&this.layer.map&&this.layer.map.events&&this.layer.map.events.un({changelayer:this.update,scope:this})},update:function(e){"opacity"!==e.property||e.layer!=this.layer||this._settingOpacity||this.setValue(this.getOpacityValue(this.layer))},setLayer:function(e){this.unbind(),this.layer=this.getLayer(e),this.setValue(this.getOpacityValue(e)),this.bind()},getOpacityValue:function(e){var t;return t=e&&null!==e.opacity?parseInt(e.opacity*(this.maxValue-this.minValue)):this.maxValue,this.inverse===!0&&(t=this.maxValue-this.minValue-t),t},getLayer:function(e){return e instanceof OpenLayers.Layer?e:e instanceof GeoExt.data.LayerRecord?e.getLayer():void 0},initComponent:function(){GeoExt.LayerOpacitySlider.superclass.initComponent.call(this),this.changeVisibility&&this.layer&&(0==this.layer.opacity||this.inverse===!1&&this.value==this.minValue||this.inverse===!0&&this.value==this.maxValue)&&this.layer.setVisibility(!1),this.complementaryLayer&&(this.layer&&1==this.layer.opacity||this.inverse===!1&&this.value==this.maxValue||this.inverse===!0&&this.value==this.minValue)&&this.complementaryLayer.setVisibility(!1),this.aggressive===!0?this.on("change",this.changeLayerOpacity,this,{buffer:this.delay}):this.on("changecomplete",this.changeLayerOpacity,this),this.changeVisibility===!0&&this.on("change",this.changeLayerVisibility,this,{buffer:this.changeVisibilityDelay}),this.complementaryLayer&&this.on("change",this.changeComplementaryLayerVisibility,this,{buffer:this.changeVisibilityDelay}),this.on("beforedestroy",this.unbind,this)},changeLayerOpacity:function(e,t){this.layer&&(t/=this.maxValue-this.minValue,this.inverse===!0&&(t=1-t),this._settingOpacity=!0,this.layer.setOpacity(t),delete this._settingOpacity)},changeLayerVisibility:function(e,t){var i=this.layer.getVisibility();this.inverse===!1&&t==this.minValue||this.inverse===!0&&t==this.maxValue&&i===!0?this.layer.setVisibility(!1):(this.inverse===!1&&t>this.minValue||this.inverse===!0&&t<this.maxValue&&0==i)&&this.layer.setVisibility(!0)},changeComplementaryLayerVisibility:function(e,t){var i=this.complementaryLayer.getVisibility();this.inverse===!1&&t==this.maxValue||this.inverse===!0&&t==this.minValue&&i===!0?this.complementaryLayer.setVisibility(!1):(this.inverse===!1&&t<this.maxValue||this.inverse===!0&&t>this.minValue&&0==i)&&this.complementaryLayer.setVisibility(!0)},addToMapPanel:function(e){this.on({render:function(){var t=this.getEl();t.setStyle({position:"absolute",zIndex:e.map.Z_INDEX_BASE.Control}),t.on({mousedown:this.stopMouseEvents,click:this.stopMouseEvents})},scope:this})},removeFromMapPanel:function(){var e=this.getEl();e.un({mousedown:this.stopMouseEvents,click:this.stopMouseEvents,scope:this}),this.unbind()},stopMouseEvents:function(e){e.stopEvent()}}),Ext.reg("gx_opacityslider",GeoExt.LayerOpacitySlider),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt"),GeoExt.LegendImage=Ext.extend(Ext.BoxComponent,{url:null,defaultImgSrc:null,imgCls:null,noImgCls:"gx-legend-noimage",initComponent:function(){GeoExt.LegendImage.superclass.initComponent.call(this),null===this.defaultImgSrc&&(this.defaultImgSrc=Ext.BLANK_IMAGE_URL),this.autoEl={tag:"img","class":this.imgCls?this.imgCls+" "+this.noImgCls:this.noImgCls,src:this.defaultImgSrc}},getImgEl:function(){return this.getEl()},setUrl:function(e){this.url=e;var t=this.getImgEl();t&&(t.un("load",this.onImageLoad,this),t.on("load",this.onImageLoad,this,{single:!0}),t.un("error",this.onImageLoadError,this),t.on("error",this.onImageLoadError,this,{single:!0}),t.dom.src=e)},onRender:function(e,t){GeoExt.LegendImage.superclass.onRender.call(this,e,t),this.url&&this.setUrl(this.url)},onDestroy:function(){var e=this.getImgEl();e&&(e.un("load",this.onImageLoad,this),e.un("error",this.onImageLoadError,this)),GeoExt.LegendImage.superclass.onDestroy.apply(this,arguments)},onImageLoadError:function(){var e=this.getImgEl();e.addClass(this.noImgCls),e.dom.src=this.defaultImgSrc},onImageLoad:function(){var e=this.getImgEl();OpenLayers.Util.isEquivalentUrl(e.dom.src,this.defaultImgSrc)||e.removeClass(this.noImgCls)}}),Ext.reg("gx_legendimage",GeoExt.LegendImage),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt"),GeoExt.LegendPanel=Ext.extend(Ext.Panel,{dynamic:!0,layerStore:null,preferredTypes:null,filter:function(){return!0},onRender:function(){GeoExt.LegendPanel.superclass.onRender.apply(this,arguments),this.layerStore||(this.layerStore=GeoExt.MapPanel.guess().layers),this.layerStore.each(function(e){this.addLegend(e)},this),this.dynamic&&this.layerStore.on({add:this.onStoreAdd,remove:this.onStoreRemove,clear:this.onStoreClear,scope:this})},recordIndexToPanelIndex:function(e){for(var t,i,s=this.layerStore,n=s.getCount(),r=-1,a=this.items?this.items.length:0,o=n-1;o>=0;--o){t=s.getAt(o),i=t.getLayer();var l=GeoExt.LayerLegend.getTypes(t);if(i.displayInLayerSwitcher&&l.length>0&&s.getAt(o).get("hideInLegend")!==!0&&(++r,e===o||r>a-1))break}return r},getIdForLayer:function(e){return this.id+"-"+e.id},onStoreAdd:function(e,t,i){for(var s=this.recordIndexToPanelIndex(i+t.length-1),n=0,r=t.length;r>n;n++)this.addLegend(t[n],s);this.doLayout()},onStoreRemove:function(e,t){this.removeLegend(t)},removeLegend:function(e){if(this.items){var t=this.getComponent(this.getIdForLayer(e.getLayer()));t&&(this.remove(t,!0),this.doLayout())}},onStoreClear:function(){this.removeAllLegends()},removeAllLegends:function(){this.removeAll(!0),this.doLayout()},addLegend:function(e,t){if(this.filter(e)===!0){var i=e.getLayer();t=t||0;var s=GeoExt.LayerLegend.getTypes(e,this.preferredTypes);i.displayInLayerSwitcher&&!e.get("hideInLegend")&&s.length>0&&this.insert(t,{xtype:s[0],id:this.getIdForLayer(i),layerRecord:e,hidden:!(!i.map&&i.visibility||i.getVisibility()&&i.calculateInRange())})}},onDestroy:function(){this.layerStore&&(this.layerStore.un("add",this.onStoreAdd,this),this.layerStore.un("remove",this.onStoreRemove,this),this.layerStore.un("clear",this.onStoreClear,this)),GeoExt.LegendPanel.superclass.onDestroy.apply(this,arguments)}}),Ext.reg("gx_legendpanel",GeoExt.LegendPanel),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt"),GeoExt.MapPanel=Ext.extend(Ext.Panel,{map:null,layers:null,center:null,zoom:null,extent:null,prettyStateKeys:!1,stateEvents:["aftermapmove","afterlayervisibilitychange","afterlayeropacitychange","afterlayerorderchange","afterlayernamechange","afterlayeradd","afterlayerremove"],initComponent:function(){this.map instanceof OpenLayers.Map||(this.map=new OpenLayers.Map(Ext.applyIf(this.map||{},{allOverlays:!0})));var e=this.layers;(!e||e instanceof Array)&&(this.layers=new GeoExt.data.LayerStore({layers:e,map:this.map.layers.length>0?this.map:null})),"string"==typeof this.center?this.center=OpenLayers.LonLat.fromString(this.center):this.center instanceof Array&&(this.center=new OpenLayers.LonLat(this.center[0],this.center[1])),"string"==typeof this.extent?this.extent=OpenLayers.Bounds.fromString(this.extent):this.extent instanceof Array&&(this.extent=OpenLayers.Bounds.fromArray(this.extent)),GeoExt.MapPanel.superclass.initComponent.call(this),this.addEvents("aftermapmove","afterlayervisibilitychange","afterlayeropacitychange","afterlayerorderchange","afterlayernamechange","afterlayeradd","afterlayerremove"),this.map.events.on({moveend:this.onMoveend,changelayer:this.onChangelayer,addlayer:this.onAddlayer,removelayer:this.onRemovelayer,scope:this}),this.on("afterlayout",function(){"function"==typeof this.map.getViewport&&this.items.each(function(e){"function"==typeof e.addToMapPanel&&e.getEl().appendTo(this.map.getViewport())},this)},this)},onMoveend:function(){this.fireEvent("aftermapmove")},onChangelayer:function(e){e.property&&("visibility"===e.property?this.fireEvent("afterlayervisibilitychange"):"order"===e.property?this.fireEvent("afterlayerorderchange"):"name"===e.property?this.fireEvent("afterlayernamechange"):"opacity"===e.property&&this.fireEvent("afterlayeropacitychange"))},onAddlayer:function(){this.fireEvent("afterlayeradd")},onRemovelayer:function(){this.fireEvent("afterlayerremove")},applyState:function(e){this.center=new OpenLayers.LonLat(e.x,e.y),this.zoom=e.zoom;var t,i,s,n,r,a,o=this.map.layers;for(t=0,i=o.length;i>t;t++)s=o[t],n=this.prettyStateKeys?s.name:s.id,r=e["visibility_"+n],void 0!==r&&(r=/^true$/i.test(r),s.isBaseLayer?r&&this.map.setBaseLayer(s):s.setVisibility(r)),a=e["opacity_"+n],void 0!==a&&s.setOpacity(a)},getState:function(){var e;if(this.map){var t=this.map.getCenter();e=t?{x:t.lon,y:t.lat,zoom:this.map.getZoom()}:{};var i,s,n,r,a=this.map.layers;for(i=0,s=a.length;s>i;i++)n=a[i],r=this.prettyStateKeys?n.name:n.id,e["visibility_"+r]=n.getVisibility(),e["opacity_"+r]=null==n.opacity?1:n.opacity;return e}},updateMapSize:function(){this.map&&this.map.updateSize()},renderMap:function(){var e=this.map;e.render(this.body.dom),this.layers.bind(e),e.layers.length>0?this.setInitialExtent():this.layers.on("add",this.setInitialExtent,this,{single:!0})},setInitialExtent:function(){var e=this.map;this.center||null!=this.zoom?e.setCenter(this.center,this.zoom):this.extent?e.zoomToExtent(this.extent):e.zoomToMaxExtent()},afterRender:function(){GeoExt.MapPanel.superclass.afterRender.apply(this,arguments),this.ownerCt?(this.ownerCt.on("move",this.updateMapSize,this),this.ownerCt.on({afterlayout:this.afterLayout,scope:this})):this.renderMap()},afterLayout:function(){var e=this.getInnerWidth()-this.body.getBorderWidth("lr"),t=this.getInnerHeight()-this.body.getBorderWidth("tb");e>0&&t>0&&(this.ownerCt.un("afterlayout",this.afterLayout,this),this.renderMap())},onResize:function(){GeoExt.MapPanel.superclass.onResize.apply(this,arguments),this.updateMapSize()},onBeforeAdd:function(e){"function"==typeof e.addToMapPanel&&e.addToMapPanel(this),GeoExt.MapPanel.superclass.onBeforeAdd.apply(this,arguments)},remove:function(e){"function"==typeof e.removeFromMapPanel&&e.removeFromMapPanel(this),GeoExt.MapPanel.superclass.remove.apply(this,arguments)},beforeDestroy:function(){this.ownerCt&&this.ownerCt.un("move",this.updateMapSize,this),this.map&&this.map.events&&this.map.events.un({moveend:this.onMoveend,changelayer:this.onChangelayer,addlayer:this.onAddlayer,removelayer:this.onRemovelayer,scope:this}),this.initialConfig.map&&this.initialConfig.map instanceof OpenLayers.Map||this.map&&this.map.destroy&&this.map.destroy(),delete this.map,GeoExt.MapPanel.superclass.beforeDestroy.apply(this,arguments)}}),GeoExt.MapPanel.guess=function(){return Ext.ComponentMgr.all.find(function(e){return e instanceof GeoExt.MapPanel})},Ext.reg("gx_mappanel",GeoExt.MapPanel),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 *
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt"),GeoExt.Popup=Ext.extend(Ext.Window,{anchored:!0,map:null,panIn:!0,unpinnable:!0,location:null,insideViewport:null,animCollapse:!1,draggable:!1,shadow:!1,popupCls:"gx-popup",ancCls:null,anchorPosition:"auto",initComponent:function(){this.map instanceof GeoExt.MapPanel&&(this.map=this.map.map),!this.map&&this.location instanceof OpenLayers.Feature.Vector&&this.location.layer&&(this.map=this.location.layer.map),this.location instanceof OpenLayers.Feature.Vector&&(this.location=this.location.geometry),this.location instanceof OpenLayers.Geometry?("function"==typeof this.location.getCentroid&&(this.location=this.location.getCentroid()),this.location=this.location.getBounds().getCenterLonLat()):this.location instanceof OpenLayers.Pixel&&(this.location=this.map.getLonLatFromViewPortPx(this.location)),this.location instanceof OpenLayers.LonLat||(this.anchored=!1);var e=this.map.getExtent();e&&this.location&&(this.insideViewport=e.containsLonLat(this.location)),this.anchored?(this.addAnchorEvents(),this.elements+=",anc"):this.unpinnable=!1,this.baseCls=this.popupCls+" "+this.baseCls,GeoExt.Popup.superclass.initComponent.call(this)},onRender:function(e,t){GeoExt.Popup.superclass.onRender.call(this,e,t),this.anchored?(this.ancCls=this.popupCls+"-anc",this.createElement("anc",this.el.dom)):this.makeDraggable()},initTools:function(){this.unpinnable&&this.addTool({id:"unpin",handler:this.unanchorPopup.createDelegate(this,[])}),GeoExt.Popup.superclass.initTools.call(this)},show:function(){GeoExt.Popup.superclass.show.apply(this,arguments),this.anchored&&(this.position(),this.panIn&&!this._mapMove&&this.panIntoView())},maximize:function(){!this.maximized&&this.anc&&this.unanchorPopup(),GeoExt.Popup.superclass.maximize.apply(this,arguments)},setSize:function(e,t){if(this.anc){var i=this.anc.getSize();"object"==typeof e?(t=e.height-i.height,e=e.width):isNaN(t)||(t-=i.height)}GeoExt.Popup.superclass.setSize.call(this,e,t)},position:function(){var e=this;if(e._mapMove===!0&&(e.insideViewport=e.map.getExtent().containsLonLat(e.location),e.insideViewport!==e.isVisible()&&e.setVisible(e.insideViewport)),e.isVisible()){var t=e.map.getPixelFromLonLat(e.location),i=Ext.fly(e.map.div).getBox(!0),s=t.y+i.y,n=t.x+i.x,r=e.el.getSize(),a=e.anc.getSize(),o=e.anchorPosition;if(o.indexOf("right")>-1||t.x>i.width/2){e.anc.addClass("right");var l=e.el.getX(!0)+r.width-e.anc.getX(!0)-a.width;n-=r.width-l-a.width/2}else{e.anc.removeClass("right");var h=e.anc.getLeft(!0);n-=h+a.width/2}o.indexOf("bottom")>-1||t.y>i.height/2?(e.anc.removeClass("top"),s-=r.height+a.height):(e.anc.addClass("top"),s+=a.height),e.setPagePosition(n,s),window.setTimeout(function(){e.dom&&e.setPagePosition(n,s)},0)}},makeDraggable:function(){this.draggable=!0,this.header.addClass("x-window-draggable"),this.dd=new Ext.Window.DD(this)},unanchorPopup:function(){this.removeAnchorEvents(),this.makeDraggable(),this.anc.remove(),this.anc=null,this.tools.unpin.hide()},panIntoView:function(){var e=Ext.fly(this.map.div).getBox(!0),t=this.getPosition(!0);t[0]-=e.x,t[1]-=e.y;var i=[e.width,e.height],s=this.getSize(),n=[t[0],t[1]],r=this.map.paddingForPopups;t[0]<r.left?n[0]=r.left:t[0]+s.width>i[0]-r.right&&(n[0]=i[0]-r.right-s.width),t[1]<r.top?n[1]=r.top:t[1]+s.height>i[1]-r.bottom&&(n[1]=i[1]-r.bottom-s.height);var a=t[0]-n[0],o=t[1]-n[1];this.map.pan(a,o)},onMapMove:function(){this.hidden&&this.insideViewport||(this._mapMove=!0,this.position(),delete this._mapMove)},addAnchorEvents:function(){this.map.events.on({move:this.onMapMove,scope:this}),this.on({resize:this.position,collapse:this.position,expand:this.position,scope:this})},removeAnchorEvents:function(){this.map.events.un({move:this.onMapMove,scope:this}),this.un("resize",this.position,this),this.un("collapse",this.position,this),this.un("expand",this.position,this)},beforeDestroy:function(){this.anchored&&this.removeAnchorEvents(),GeoExt.Popup.superclass.beforeDestroy.call(this)}}),Ext.reg("gx_popup",GeoExt.Popup),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt"),GeoExt.PrintMapPanel=Ext.extend(GeoExt.MapPanel,{sourceMap:null,printProvider:null,printPage:null,previewScales:null,center:null,zoom:null,extent:null,currentZoom:null,initComponent:function(){this.sourceMap instanceof GeoExt.MapPanel&&(this.sourceMap=this.sourceMap.map),this.map||(this.map={}),Ext.applyIf(this.map,{projection:this.sourceMap.getProjection(),maxExtent:this.sourceMap.getMaxExtent(),maxResolution:this.sourceMap.getMaxResolution(),units:this.sourceMap.getUnits()}),this.printProvider instanceof GeoExt.data.PrintProvider||(this.printProvider=new GeoExt.data.PrintProvider(this.printProvider)),this.printPage=new GeoExt.data.PrintPage({printProvider:this.printProvider}),this.previewScales=new Ext.data.Store,this.previewScales.add(this.printProvider.scales.getRange()),this.layers=[],Ext.each(this.sourceMap.layers,function(e){if(e.getVisibility()===!0)if(e instanceof OpenLayers.Layer.Vector){for(var t=e.features,i=new Array(t.length),s=new OpenLayers.Layer.Vector(e.name),n=0,r=t.length;r>n;++n)i[n]=t[n].clone();s.addFeatures(i,{silent:!0}),this.layers.push(s)}else this.layers.push(e.clone())},this),this.extent=this.sourceMap.getExtent(),GeoExt.PrintMapPanel.superclass.initComponent.call(this)},bind:function(){this.printPage.on("change",this.fitZoom,this),this.printProvider.on("layoutchange",this.syncSize,this),this.map.events.register("moveend",this,this.updatePage),this.printPage.fit(this.sourceMap),this.initialConfig.limitScales===!0&&(this.on("resize",this.calculatePreviewScales,this),this.calculatePreviewScales())},afterRender:function(){GeoExt.PrintMapPanel.superclass.afterRender.apply(this,arguments),this.syncSize(),this.ownerCt?this.ownerCt.on({afterlayout:{fn:this.bind,scope:this,single:!0}}):this.bind()},adjustSize:function(e,t){var i=this.printProvider.layout.get("size"),s=i.width/i.height,n=this.ownerCt,r=n&&n.autoWidth?0:e||this.initialConfig.width,a=n&&n.autoHeight?0:t||this.initialConfig.height;return r?(t=r/s,a&&t>a?(t=a,e=t*s):e=r):a&&(e=a*s,t=a),{width:e,height:t}},fitZoom:function(){if(!this._updating&&this.printPage.scale){this._updating=!0;var e=this.printPage.getPrintExtent(this.map);this.currentZoom=this.map.getZoomForExtent(e),this.map.zoomToExtent(e),delete this._updating}},updatePage:function(){if(!this._updating){var e=this.map.getZoom();this._updating=!0,e===this.currentZoom?this.printPage.setCenter(this.map.getCenter()):this.printPage.fit(this.map),delete this._updating,this.currentZoom=e}},calculatePreviewScales:function(){this.previewScales.removeAll(),this.printPage.suspendEvents();var e=this.printPage.scale,t=this.map.getSize(),i={},s=[];this.printProvider.scales.each(function(e){this.printPage.setScale(e);var n=this.printPage.getPrintExtent(this.map),r=this.map.getZoomForExtent(n),a=Math.max(n.getWidth()/t.w,n.getHeight()/t.h),o=this.map.getResolutionForZoom(r),l=Math.abs(a-o);(!(r in i)||i[r].diff>l)&&(i[r]={rec:e,diff:l},-1==s.indexOf(r)&&s.push(r))},this);for(var n=0,r=s.length;r>n;++n)this.previewScales.add(i[s[n]].rec);if(e&&this.printPage.setScale(e),this.printPage.resumeEvents(),e&&this.previewScales.getCount()>0){var a=this.previewScales.getAt(0),o=this.previewScales.getAt(this.previewScales.getCount()-1);e.get("value")<o.get("value")?this.printPage.setScale(o):e.get("value")>a.get("value")&&this.printPage.setScale(a)}this.fitZoom()},print:function(e){this.printProvider.print(this.map,[this.printPage],e)},beforeDestroy:function(){this.map.events.unregister("moveend",this,this.updatePage),this.printPage.un("change",this.fitZoom,this),this.printProvider.un("layoutchange",this.syncSize,this),GeoExt.PrintMapPanel.superclass.beforeDestroy.apply(this,arguments)}}),Ext.reg("gx_printmappanel",GeoExt.PrintMapPanel),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt"),GeoExt.UrlLegend=Ext.extend(GeoExt.LayerLegend,{initComponent:function(){GeoExt.UrlLegend.superclass.initComponent.call(this),this.add(new GeoExt.LegendImage({url:this.layerRecord.get("legendURL")}))},update:function(){GeoExt.UrlLegend.superclass.update.apply(this,arguments),this.items.get(1).setUrl(this.layerRecord.get("legendURL"))}}),GeoExt.UrlLegend.supports=function(e){return null==e.get("legendURL")?0:10},GeoExt.LayerLegend.types.gx_urllegend=GeoExt.UrlLegend,Ext.reg("gx_urllegend",GeoExt.UrlLegend),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt"),GeoExt.VectorLegend=Ext.extend(GeoExt.LayerLegend,{layerRecord:null,layer:null,rules:null,symbolType:null,untitledPrefix:"Untitled ",clickableSymbol:!1,clickableTitle:!1,selectOnClick:!1,enableDD:!1,bodyBorder:!1,feature:null,selectedRule:null,currentScaleDenominator:null,initComponent:function(){if(GeoExt.VectorLegend.superclass.initComponent.call(this),this.layerRecord&&(this.layer=this.layerRecord.getLayer(),this.layer.map&&(this.map=this.layer.map,this.currentScaleDenominator=this.layer.map.getScale(),this.layer.map.events.on({zoomend:this.onMapZoom,scope:this}))),!this.symbolType)if(this.feature)this.symbolType=this.symbolTypeFromFeature(this.feature);else if(this.layer)if(this.layer.features.length>0){var e=this.layer.features[0].clone();e.attributes={},this.feature=e,this.symbolType=this.symbolTypeFromFeature(this.feature)}else this.layer.events.on({featuresadded:this.onFeaturesAdded,scope:this});this.layer&&this.feature&&!this.rules&&this.setRules(),this.rulesContainer=new Ext.Container({autoEl:{}}),this.add(this.rulesContainer),this.addEvents("titleclick","symbolclick","ruleclick","ruleselected","ruleunselected","rulemoved"),this.update()},onMapZoom:function(){this.setCurrentScaleDenominator(this.layer.map.getScale())},symbolTypeFromFeature:function(e){var t=e.geometry.CLASS_NAME.match(/Point|Line|Polygon/);return t&&t[0]||"Point"},onFeaturesAdded:function(){this.layer.events.un({featuresadded:this.onFeaturesAdded,scope:this});var e=this.layer.features[0].clone();e.attributes={},this.feature=e,this.symbolType=this.symbolTypeFromFeature(this.feature),this.rules||this.setRules(),this.update()},setRules:function(){var e=this.layer.styleMap&&this.layer.styleMap.styles["default"];e||(e=new OpenLayers.Style),this.rules=0===e.rules.length?[new OpenLayers.Rule({title:e.title,symbolizer:e.createSymbolizer(this.feature)})]:e.rules},setCurrentScaleDenominator:function(e){e!==this.currentScaleDenominator&&(this.currentScaleDenominator=e,this.update())},getRuleEntry:function(e){return this.rulesContainer.items.get(this.rules.indexOf(e))},addRuleEntry:function(e,t){this.rulesContainer.add(this.createRuleEntry(e)),t||this.doLayout()},removeRuleEntry:function(e,t){var i=this.getRuleEntry(e);i&&(this.rulesContainer.remove(i),t||this.doLayout())},selectRuleEntry:function(e){var t=e!=this.selectedRule;if(this.selectedRule&&this.unselect(),t){var i=this.getRuleEntry(e);i.body.addClass("x-grid3-row-selected"),this.selectedRule=e,this.fireEvent("ruleselected",this,e)}},unselect:function(){this.rulesContainer.items.each(function(e,t){this.rules[t]==this.selectedRule&&(e.body.removeClass("x-grid3-row-selected"),this.selectedRule=null,this.fireEvent("ruleunselected",this,this.rules[t]))},this)},createRuleEntry:function(e){var t=!0;return null!=this.currentScaleDenominator&&(e.minScaleDenominator&&(t=t&&this.currentScaleDenominator>=e.minScaleDenominator),e.maxScaleDenominator&&(t=t&&this.currentScaleDenominator<e.maxScaleDenominator)),{xtype:"panel",layout:"column",border:!1,hidden:!t,bodyStyle:this.selectOnClick?{cursor:"pointer"}:void 0,defaults:{border:!1},items:[this.createRuleRenderer(e),this.createRuleTitle(e)],listeners:{render:function(t){this.selectOnClick&&t.getEl().on({click:function(){this.selectRuleEntry(e)},scope:this}),1==this.enableDD&&this.addDD(t)},scope:this}}},createRuleRenderer:function(e){var t,i,s=[this.symbolType,"Point","Line","Polygon"],n=e.symbolizers;if(n){var r;e:for(var a=0,o=s.length;o>a;++a)if(t=s[a],r=OpenLayers.Symbolizer[t])for(var l=0,h=n.length;h>l;++l)if(n[l]instanceof r){i=!0;break e}}else{for(var u=e.symbolizer,a=0,c=s.length;c>a;++a)if(t=s[a],u[t]){u=u[t],i=!0;break}n=[u]}return{xtype:"gx_renderer",labelText:"Ab",symbolType:i?t:this.symbolType,symbolizers:n,style:this.clickableSymbol?{cursor:"pointer"}:void 0,listeners:{click:function(){this.clickableSymbol&&(this.fireEvent("symbolclick",this,e),this.fireEvent("ruleclick",this,e))},scope:this}}},createRuleTitle:function(e){return{cls:"x-form-item",style:"padding: 0.2em 0.5em 0;",bodyStyle:Ext.applyIf({background:"transparent"},this.clickableTitle?{cursor:"pointer"}:void 0),html:this.getRuleTitle(e),listeners:{render:function(t){this.clickableTitle&&t.getEl().on({click:function(){this.fireEvent("titleclick",this,e),this.fireEvent("ruleclick",this,e)},scope:this})},scope:this}}},addDD:function(e){var t=e.ownerCt,i=this;new Ext.dd.DragSource(e.getEl(),{ddGroup:t.id,onDragOut:function(e,t){var i=Ext.getCmp(t);return i.removeClass("gx-ruledrag-insert-above"),i.removeClass("gx-ruledrag-insert-below"),Ext.dd.DragZone.prototype.onDragOut.apply(this,arguments)},onDragEnter:function(i,s){var n,r=Ext.getCmp(s),a=t.items.indexOf(e),o=t.items.indexOf(r);return a>o?n="gx-ruledrag-insert-above":o>a&&(n="gx-ruledrag-insert-below"),n&&r.addClass(n),Ext.dd.DragZone.prototype.onDragEnter.apply(this,arguments)},onDragDrop:function(s,n){return i.moveRule(t.items.indexOf(e),t.items.indexOf(Ext.getCmp(n))),Ext.dd.DragZone.prototype.onDragDrop.apply(this,arguments)},getDragData:function(e){var t=e.getTarget(".x-column-inner");if(t){var i=t.cloneNode(!0);return i.id=Ext.id(),{sourceEl:t,repairXY:Ext.fly(t).getXY(),ddel:i}}}}),new Ext.dd.DropTarget(e.getEl(),{ddGroup:t.id,notifyDrop:function(){return!0}})},update:function(){if(GeoExt.VectorLegend.superclass.update.apply(this,arguments),this.symbolType&&this.rules){if(this.rulesContainer.items)for(var e,t=this.rulesContainer.items.length-1;t>=0;--t)e=this.rulesContainer.getComponent(t),this.rulesContainer.remove(e,!0);for(var t=0,i=this.rules.length;i>t;++t)this.addRuleEntry(this.rules[t],!0);this.doLayout(),this.selectedRule&&this.getRuleEntry(this.selectedRule).body.addClass("x-grid3-row-selected")}},updateRuleEntry:function(e){var t=this.getRuleEntry(e);t&&(t.removeAll(),t.add(this.createRuleRenderer(e)),t.add(this.createRuleTitle(e)),t.doLayout())},moveRule:function(e,t){var i=this.rules[e];this.rules.splice(e,1),this.rules.splice(t,0,i),this.update(),this.fireEvent("rulemoved",this,i)},getRuleTitle:function(e){var t=e.title||e.name||"";return!t&&this.untitledPrefix&&(t=this.untitledPrefix+(this.rules.indexOf(e)+1)),t},beforeDestroy:function(){this.layer&&(this.layer.events&&this.layer.events.un({featuresadded:this.onFeaturesAdded,scope:this}),this.layer.map&&this.layer.map.events&&this.layer.map.events.un({zoomend:this.onMapZoom,scope:this})),delete this.layer,delete this.map,delete this.rules,GeoExt.VectorLegend.superclass.beforeDestroy.apply(this,arguments)},onStoreRemove:function(e,t){t.getLayer()===this.layer&&this.map&&this.map.events&&this.map.events.un({zoomend:this.onMapZoom,scope:this})},onStoreAdd:function(e,t){for(var i=0,s=t.length;s>i;i++){var n=t[i];n.getLayer()===this.layer&&this.layer.map&&this.layer.map.events&&this.layer.map.events.on({zoomend:this.onMapZoom,scope:this})}}}),GeoExt.VectorLegend.supports=function(e){return e.getLayer()instanceof OpenLayers.Layer.Vector?1:0},GeoExt.LayerLegend.types.gx_vectorlegend=GeoExt.VectorLegend,Ext.reg("gx_vectorlegend",GeoExt.VectorLegend),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 *
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt"),GeoExt.WMSLegend=Ext.extend(GeoExt.LayerLegend,{defaultStyleIsFirst:!0,useScaleParameter:!0,baseParams:null,itemXType:"gx_legendimage",initComponent:function(){GeoExt.WMSLegend.superclass.initComponent.call(this);var e=this.layerRecord.getLayer();this._noMap=!e.map,e.events.register("moveend",this,this.onLayerMoveend),this.update()},onLayerMoveend:function(e){(e.zoomChanged===!0&&this.useScaleParameter===!0||this._noMap)&&(delete this._noMap,this.update())},getLegendUrl:function(e,t){var i,s=this.layerRecord,n=s&&s.get("styles"),r=s.getLayer();t=t||[r.params.LAYERS].join(",").split(",");var a=r.params.STYLES&&[r.params.STYLES].join(",").split(","),o=t.indexOf(e),l=a&&a[o];n&&n.length>0&&(l?Ext.each(n,function(e){return i=e.name==l&&e.legend&&e.legend.href,!i}):this.defaultStyleIsFirst!==!0||a||r.params.SLD||r.params.SLD_BODY||(i=n[0].legend&&n[0].legend.href)),i||(i=r.getFullRequestString({REQUEST:"GetLegendGraphic",WIDTH:null,HEIGHT:null,EXCEPTIONS:"application/vnd.ogc.se_xml",LAYER:e,LAYERS:null,STYLE:""!==l?l:null,STYLES:null,SRS:null,FORMAT:null,TIME:null}));var h=Ext.apply({},this.baseParams);if(r.params._OLSALT&&(h._OLSALT=r.params._OLSALT),i=Ext.urlAppend(i,Ext.urlEncode(h)),-1!=i.toLowerCase().indexOf("request=getlegendgraphic")&&(-1==i.toLowerCase().indexOf("format=")&&(i=Ext.urlAppend(i,"FORMAT=image%2Fgif")),this.useScaleParameter===!0)){var u=r.map.getScale();i=Ext.urlAppend(i,"SCALE="+u)}return i},update:function(){var e=this.layerRecord.getLayer();if(e&&e.map){GeoExt.WMSLegend.superclass.update.apply(this,arguments);var t,i,s,n;t=[e.params.LAYERS].join(",").split(",");var r=[],a=this.items.find(function(e){return e.isXType("label")});for(this.items.each(function(e){if(s=t.indexOf(e.itemId),0>s&&e!=a)r.push(e);else if(e!==a){i=t[s];var n=this.getLegendUrl(i,t);OpenLayers.Util.isEquivalentUrl(n,e.url)||e.setUrl(n)}},this),s=0,n=r.length;n>s;s++){var o=r[s];this.remove(o),o.destroy()}for(s=0,n=t.length;n>s;s++)i=t[s],this.items&&this.getComponent(i)||this.add({xtype:this.itemXType,url:this.getLegendUrl(i,t),itemId:i});this.doLayout()}},beforeDestroy:function(){if(this.useScaleParameter===!0){var e=this.layerRecord.getLayer();e&&e.events&&e.events.unregister("moveend",this,this.onLayerMoveend)}GeoExt.WMSLegend.superclass.beforeDestroy.apply(this,arguments)}}),GeoExt.WMSLegend.supports=function(e){return e.getLayer()instanceof OpenLayers.Layer.WMS?1:0},GeoExt.LayerLegend.types.gx_wmslegend=GeoExt.WMSLegend,Ext.reg("gx_wmslegend",GeoExt.WMSLegend),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt"),GeoExt.ZoomSlider=Ext.extend(Ext.slider.SingleSlider,{map:null,baseCls:"gx-zoomslider",aggressive:!1,updating:!1,initComponent:function(){GeoExt.ZoomSlider.superclass.initComponent.call(this),this.map&&(this.map instanceof GeoExt.MapPanel&&(this.map=this.map.map),this.bind(this.map)),this.aggressive===!0?this.on("change",this.changeHandler,this):this.on("changecomplete",this.changeHandler,this),this.on("beforedestroy",this.unbind,this)},onRender:function(){GeoExt.ZoomSlider.superclass.onRender.apply(this,arguments),this.el.addClass(this.baseCls)},afterRender:function(){Ext.slider.SingleSlider.superclass.afterRender.apply(this,arguments),this.update()},addToMapPanel:function(e){this.on({render:function(){var t=this.getEl();t.setStyle({position:"absolute",zIndex:e.map.Z_INDEX_BASE.Control}),t.on({mousedown:this.stopMouseEvents,click:this.stopMouseEvents})},afterrender:function(){this.bind(e.map)},scope:this})},stopMouseEvents:function(e){e.stopEvent()},removeFromMapPanel:function(){var e=this.getEl();e.un("mousedown",this.stopMouseEvents,this),e.un("click",this.stopMouseEvents,this),this.unbind()},bind:function(e){this.map=e,this.map.events.on({zoomend:this.onZoomEnd,updatesize:this.initZoomValues,changebaselayer:this.initZoomValues,scope:this}),this.initZoomValues()},onZoomEnd:function(){this.update()},unbind:function(){this.map&&this.map.events&&this.map.events.un({zoomend:this.onZoomEnd,updatesize:this.initZoomValues,changebaselayer:this.initZoomValues,scope:this})},initZoomValues:function(){var e=this.map.baseLayer;if(e){if(void 0===this.initialConfig.minValue){var t=this.map.getMinZoom?this.map.getMinZoom():0;this.minValue=Math.max(t,e.minZoomLevel||0)}void 0===this.initialConfig.maxValue&&(this.maxValue=null==e.minZoomLevel?e.numZoomLevels-1:e.maxZoomLevel),this.update(!0)}},getZoom:function(){return this.getValue()},getScale:function(){return OpenLayers.Util.getScaleFromResolution(this.map.getResolutionForZoom(this.getValue()),this.map.getUnits())},getResolution:function(){return this.map.getResolutionForZoom(this.getValue())},changeHandler:function(){this.map&&!this.updating&&this.map.zoomTo(this.getValue())},update:function(e){this.rendered&&this.map&&(this.updating=!0,e&&(this.thumbs[0].value=null),this.setValue(this.map.getZoom()),this.updating=!1)}}),Ext.reg("gx_zoomslider",GeoExt.ZoomSlider),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.form"),GeoExt.form.toFilter=function(e,t,i){e instanceof Ext.form.FormPanel&&(e=e.getForm());var s=[],n=e.getValues(!1);for(var r in n){var a,o=r.split("__"),l=n[r];if(o.length>1&&void 0!==(a=GeoExt.form.toFilter.FILTER_MAP[o[1]])?r=o[0]:a=OpenLayers.Filter.Comparison.EQUAL_TO,a===OpenLayers.Filter.Comparison.LIKE)switch(i){case GeoExt.form.ENDS_WITH:l=".*"+l;break;case GeoExt.form.STARTS_WITH:l+=".*";break;case GeoExt.form.CONTAINS:l=".*"+l+".*"}s.push(new OpenLayers.Filter.Comparison({type:a,value:l,property:r}))}return 1==s.length&&t!=OpenLayers.Filter.Logical.NOT?s[0]:new OpenLayers.Filter.Logical({type:t||OpenLayers.Filter.Logical.AND,filters:s})},GeoExt.form.toFilter.FILTER_MAP={eq:OpenLayers.Filter.Comparison.EQUAL_TO,ne:OpenLayers.Filter.Comparison.NOT_EQUAL_TO,lt:OpenLayers.Filter.Comparison.LESS_THAN,le:OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO,gt:OpenLayers.Filter.Comparison.GREATER_THAN,ge:OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO,like:OpenLayers.Filter.Comparison.LIKE},GeoExt.form.ENDS_WITH=1,GeoExt.form.STARTS_WITH=2,GeoExt.form.CONTAINS=3,GeoExt.form.recordToField=function(e,t){t=t||{};var i=e.get("type");if("object"==typeof i&&i.xtype)return i;i=i.split(":").pop();var s,n=e.get("name"),r=e.get("restriction")||{},a=e.get("nillable")||!1,o=e.get("label"),l=t.labelTpl;if(l){var h=l instanceof Ext.Template?l:new Ext.XTemplate(l);o=h.apply(e.data)}else null==o&&(o=n);var u={name:n,labelStyle:a?"":null!=t.mandatoryFieldLabelStyle?t.mandatoryFieldLabelStyle:"font-weight:bold;"},c=GeoExt.form.recordToField.REGEXES;if(r.enumeration)s=Ext.apply({xtype:"combo",fieldLabel:o,mode:"local",forceSelection:!0,triggerAction:"all",editable:!1,store:r.enumeration},u);else if(i.match(c.text)){var d=void 0!==r.maxLength?parseFloat(r.maxLength):void 0,p=void 0!==r.minLength?parseFloat(r.minLength):void 0;s=Ext.apply({xtype:"textfield",fieldLabel:o,maxLength:d,minLength:p},u)}else if(i.match(c.number)){var f=void 0!==r.maxInclusive?parseFloat(r.maxInclusive):void 0,m=void 0!==r.minInclusive?parseFloat(r.minInclusive):void 0;s=Ext.apply({xtype:"numberfield",fieldLabel:o,maxValue:f,minValue:m},u)}else if(i.match(c["boolean"])){s=Ext.apply({xtype:"checkbox"},u);var y=t.checkboxLabelProperty||"boxLabel";s[y]=o}else i.match(c.date)&&(s=Ext.apply({xtype:"datefield",fieldLabel:o,format:"c"},u));return s},GeoExt.form.recordToField.REGEXES={text:new RegExp("^(text|string)$","i"),number:new RegExp("^(number|float|decimal|double|int|long|integer|short)$","i"),"boolean":new RegExp("^(boolean)$","i"),date:new RegExp("^(date|dateTime)$","i")},/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.form"),GeoExt.form.BasicForm=Ext.extend(Ext.form.BasicForm,{protocol:null,prevResponse:null,autoAbort:!0,doAction:function(e,t){return"search"==e&&(t=Ext.applyIf(t||{},{protocol:this.protocol,abortPrevious:this.autoAbort}),e=new GeoExt.form.SearchAction(this,t)),GeoExt.form.BasicForm.superclass.doAction.call(this,e,t)},search:function(e){return this.doAction("search",e)}}),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.form"),GeoExt.form.FormPanel=Ext.extend(Ext.form.FormPanel,{protocol:null,createForm:function(){return delete this.initialConfig.listeners,new GeoExt.form.BasicForm(null,this.initialConfig)},search:function(e){this.getForm().search(e)}}),Ext.reg("gx_formpanel",GeoExt.form.FormPanel),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * Published under the BSD license.
 * See http://geoext.org/svn/geoext/core/trunk/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.form"),GeoExt.form.GeocoderComboBox=Ext.extend(Ext.form.ComboBox,{emptyText:"Search",srs:"EPSG:4326",zoom:10,queryDelay:100,valueField:"bounds",displayField:"name",locationField:"lonlat",url:"http://nominatim.openstreetmap.org/search?format=json",queryParam:"q",minChars:3,initComponent:function(){return this.map&&this.setMap(this.map),Ext.isString(this.srs)&&(this.srs=new OpenLayers.Projection(this.srs)),this.store||(this.store=new Ext.data.JsonStore({root:null,fields:[{name:"name",mapping:"display_name"},{name:"bounds",convert:function(e,t){var i=t.boundingbox;return[i[2],i[0],i[3],i[1]]}},{name:"lonlat",convert:function(e,t){return[t.lon,t.lat]}}],proxy:new Ext.data.ScriptTagProxy({url:this.url,callbackParam:"json_callback"})})),this.on({added:this.handleAdded,select:this.handleSelect,focus:function(){this.clearValue(),this.removeLocationFeature()},scope:this}),GeoExt.form.GeocoderComboBox.superclass.initComponent.apply(this,arguments)},handleAdded:function(){var e=this.findParentBy(function(e){return e instanceof GeoExt.MapPanel});e&&this.setMap(e)},handleSelect:function(e,t){var i=this.getValue();if(Ext.isArray(i)){var s=this.map.getProjectionObject();delete this.center,delete this.locationFeature,4===i.length?this.map.zoomToExtent(OpenLayers.Bounds.fromArray(i).transform(this.srs,s)):this.map.setCenter(OpenLayers.LonLat.fromArray(i).transform(this.srs,s),Math.max(this.map.getZoom(),this.zoom)),this.center=this.map.getCenter();var n=t.get(this.locationField);if(this.layer&&n){var r=new OpenLayers.Geometry.Point(n[0],n[1]).transform(this.srs,s);this.locationFeature=new OpenLayers.Feature.Vector(r,t.data),this.layer.addFeatures([this.locationFeature])}}!function(){this.triggerBlur(),this.el.blur()}.defer(100,this)},removeLocationFeature:function(){this.locationFeature&&this.layer.destroyFeatures([this.locationFeature])},clearResult:function(){this.center&&!this.map.getCenter().equals(this.center)&&this.clearValue()},setMap:function(e){e instanceof GeoExt.MapPanel&&(e=e.map),this.map=e,e.events.on({moveend:this.clearResult,click:this.removeLocationFeature,scope:this})},addToMapPanel:Ext.emptyFn,beforeDestroy:function(){this.map.events.un({moveend:this.clearResult,click:this.removeLocationFeature,scope:this}),this.removeLocationFeature(),delete this.map,delete this.layer,delete this.center,GeoExt.form.GeocoderComboBox.superclass.beforeDestroy.apply(this,arguments)}}),Ext.reg("gx_geocodercombo",GeoExt.form.GeocoderComboBox),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.form"),GeoExt.form.SearchAction=Ext.extend(Ext.form.Action,{type:"search",response:null,constructor:function(e,t){GeoExt.form.SearchAction.superclass.constructor.call(this,e,t)},run:function(){var e=this.options,t=GeoExt.form.toFilter(this.form,e.logicalOp,e.wildcard);e.clientValidation===!1||this.form.isValid()?(e.abortPrevious&&this.form.prevResponse&&e.protocol.abort(this.form.prevResponse),this.form.prevResponse=e.protocol.read(Ext.applyIf({filter:t,callback:this.handleResponse,scope:this},e))):e.clientValidation!==!1&&(this.failureType=Ext.form.Action.CLIENT_INVALID,this.form.afterAction(this,!1))},handleResponse:function(e){this.form.prevResponse=null,this.response=e,e.success()?this.form.afterAction(this,!0):this.form.afterAction(this,!1);var t=this.options;t.callback&&t.callback.call(t.scope,e)}}),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.grid"),GeoExt.grid.FeatureSelectionModelMixin=function(){return{autoActivateControl:!0,layerFromStore:!0,selectControl:null,bound:!1,superclass:null,selectedFeatures:[],autoPanMapOnSelection:!1,constructor:function(e){if(e=e||{},e.selectControl instanceof OpenLayers.Control.SelectFeature){if(!e.singleSelect){var t=e.selectControl;e.singleSelect=!(t.multiple||t.multipleKey)}}else e.layer instanceof OpenLayers.Layer.Vector&&(this.selectControl=this.createSelectControl(e.layer,e.selectControl),delete e.layer,delete e.selectControl);e.autoPanMapOnSelection&&(this.autoPanMapOnSelection=!0,delete e.autoPanMapOnSelection),this.superclass=arguments.callee.superclass,this.superclass.constructor.call(this,e)},initEvents:function(){if(this.superclass.initEvents.call(this),this.layerFromStore){var e=this.grid.getStore()&&this.grid.getStore().layer;!e||this.selectControl instanceof OpenLayers.Control.SelectFeature||(this.selectControl=this.createSelectControl(e,this.selectControl))}this.selectControl&&this.bind(this.selectControl)},createSelectControl:function(e,t){t=t||{};var i=void 0!==t.singleSelect?t.singleSelect:this.singleSelect;t=OpenLayers.Util.extend({toggle:!0,multipleKey:i?null:Ext.isMac?"metaKey":"ctrlKey"},t);var s=new OpenLayers.Control.SelectFeature(e,t);return e.map.addControl(s),s},bind:function(e,t){if(!this.bound){t=t||{},this.selectControl=e,e instanceof OpenLayers.Layer.Vector&&(this.selectControl=this.createSelectControl(e,t.controlConfig)),this.autoActivateControl&&this.selectControl.activate();for(var i=this.getLayers(),s=0,n=i.length;n>s;s++)i[s].events.on({featureselected:this.featureSelected,featureunselected:this.featureUnselected,scope:this});this.on("rowselect",this.rowSelected,this),this.on("rowdeselect",this.rowDeselected,this),this.bound=!0}return this.selectControl},unbind:function(){var e=this.selectControl;if(this.bound){for(var t=this.getLayers(),i=0,s=t.length;s>i;i++)t[i].events.un({featureselected:this.featureSelected,featureunselected:this.featureUnselected,scope:this});this.un("rowselect",this.rowSelected,this),this.un("rowdeselect",this.rowDeselected,this),this.autoActivateControl&&e.deactivate(),this.selectControl=null,this.bound=!1}return e},featureSelected:function(e){if(!this._selecting){var t=this.grid.store,i=t.findBy(function(t){return t.getFeature()==e.feature});-1==i||this.isSelected(i)||(this._selecting=!0,this.selectRow(i,!this.singleSelect),this._selecting=!1,this.grid.getView().focusRow(i))}},featureUnselected:function(e){if(!this._selecting){var t=this.grid.store,i=t.findBy(function(t){return t.getFeature()==e.feature});-1!=i&&this.isSelected(i)&&(this._selecting=!0,this.deselectRow(i),this._selecting=!1,this.grid.getView().focusRow(i))}},rowSelected:function(e,t,i){var s=i.getFeature();if(!this._selecting&&s){for(var n=this.getLayers(),r=0,a=n.length;a>r;r++)if(-1==n[r].selectedFeatures.indexOf(s)){this._selecting=!0,this.selectControl.select(s),this._selecting=!1,this.selectedFeatures.push(s);break}this.autoPanMapOnSelection&&this.recenterToSelectionExtent()}},rowDeselected:function(e,t,i){var s=i.getFeature();if(!this._selecting&&s){for(var n=this.getLayers(),r=0,a=n.length;a>r;r++)if(-1!=n[r].selectedFeatures.indexOf(s)){this._selecting=!0,this.selectControl.unselect(s),this._selecting=!1,OpenLayers.Util.removeItem(this.selectedFeatures,s);break}this.autoPanMapOnSelection&&this.selectedFeatures.length>0&&this.recenterToSelectionExtent()}},getLayers:function(){return this.selectControl.layers||[this.selectControl.layer]},recenterToSelectionExtent:function(){var e=this.selectControl.map,t=this.getSelectionExtent(),i=e.getZoomForExtent(t,!1);i>e.getZoom()?e.setCenter(t.getCenterLonLat()):e.zoomToExtent(t)},getSelectionExtent:function(){var e=null,t=this.selectedFeatures;if(t&&t.length>0)for(var i=null,s=0,n=t.length;n>s;s++)i=t[s].geometry,i&&(null===e&&(e=new OpenLayers.Bounds),e.extend(i.getBounds()));return e}}},GeoExt.grid.FeatureSelectionModel=Ext.extend(Ext.grid.RowSelectionModel,new GeoExt.grid.FeatureSelectionModelMixin),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.grid"),GeoExt.grid.SymbolizerColumn=Ext.extend(Ext.grid.Column,{renderer:function(e,t){if(null!=e){var i=Ext.id();return window.setTimeout(function(){var t=Ext.get(i);t&&new GeoExt.FeatureRenderer({symbolizers:e instanceof Array?e:[e],renderTo:t})},0),t.css="gx-grid-symbolizercol",'<div id="'+i+'"></div>'}}}),Ext.grid.Column.types.gx_symbolizercolumn=GeoExt.grid.SymbolizerColumn,/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 *
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt"),GeoExt.LayerOpacitySliderTip=Ext.extend(GeoExt.SliderTip,{template:"<div>{opacity}%</div>",compiledTemplate:null,init:function(e){this.compiledTemplate=new Ext.Template(this.template),GeoExt.LayerOpacitySliderTip.superclass.init.call(this,e)},getText:function(e){var t={opacity:e.value};return this.compiledTemplate.apply(t)}}),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt"),GeoExt.SliderTip=Ext.extend(Ext.slider.Tip,{hover:!0,minWidth:10,offsets:[0,-10],dragging:!1,init:function(e){GeoExt.SliderTip.superclass.init.apply(this,arguments),this.hover&&e.on("render",this.registerThumbListeners,this),this.slider=e},registerThumbListeners:function(){for(var e,t,i=0,s=this.slider.thumbs.length;s>i;++i)e=this.slider.thumbs[i],t=e.tracker.el,function(e,t){t.on({mouseover:function(t){this.onSlide(this.slider,t,e),this.dragging=!1},mouseout:function(){this.dragging||this.hide.apply(this,arguments)},scope:this})}.apply(this,[e,t])},onSlide:function(){return this.dragging=!0,GeoExt.SliderTip.superclass.onSlide.apply(this,arguments)}}),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt"),GeoExt.ZoomSliderTip=Ext.extend(GeoExt.SliderTip,{template:"<div>Zoom Level: {zoom}</div><div>Resolution: {resolution}</div><div>Scale: 1 : {scale}</div>",compiledTemplate:null,init:function(e){this.compiledTemplate=new Ext.Template(this.template),GeoExt.ZoomSliderTip.superclass.init.call(this,e)},getText:function(e){var t={zoom:e.value,resolution:this.slider.getResolution(),scale:Math.round(this.slider.getScale())};return this.compiledTemplate.apply(t)}}),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.tree"),GeoExt.tree.BaseLayerContainer=Ext.extend(GeoExt.tree.LayerContainer,{text:"Base Layer",constructor:function(e){e=Ext.applyIf(e||{},{text:this.text,loader:{}}),e.loader=Ext.applyIf(e.loader,{baseAttrs:Ext.applyIf(e.loader.baseAttrs||{},{iconCls:"gx-tree-baselayer-icon",checkedGroup:"baselayer"}),filter:function(e){var t=e.getLayer();return t.displayInLayerSwitcher===!0&&t.isBaseLayer===!0}}),GeoExt.tree.BaseLayerContainer.superclass.constructor.call(this,e)}}),Ext.tree.TreePanel.nodeTypes.gx_baselayercontainer=GeoExt.tree.BaseLayerContainer,/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.tree"),GeoExt.tree.LayerContainer=Ext.extend(Ext.tree.AsyncTreeNode,{text:"Layers",constructor:function(e){e=Ext.applyIf(e||{},{text:this.text}),this.loader=e.loader instanceof GeoExt.tree.LayerLoader?e.loader:new GeoExt.tree.LayerLoader(Ext.applyIf(e.loader||{},{store:e.layerStore})),GeoExt.tree.LayerContainer.superclass.constructor.call(this,e)},recordIndexToNodeIndex:function(e){for(var t=this.loader.store,i=t.getCount(),s=this.childNodes.length,n=-1,r=i-1;r>=0&&!(this.loader.filter(t.getAt(r))===!0&&(++n,e===r||n>s-1));--r);return n},destroy:function(){delete this.layerStore,GeoExt.tree.LayerContainer.superclass.destroy.apply(this,arguments)}}),Ext.tree.TreePanel.nodeTypes.gx_layercontainer=GeoExt.tree.LayerContainer,/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.tree"),GeoExt.tree.LayerLoader=function(e){Ext.apply(this,e),this.addEvents("beforeload","load"),this.iconCls={},GeoExt.tree.LayerLoader.superclass.constructor.call(this)},Ext.extend(GeoExt.tree.LayerLoader,Ext.util.Observable,{store:null,filter:function(e){return 1==e.getLayer().displayInLayerSwitcher},baseAttrs:null,uiProviders:null,load:function(e,t){if(this.fireEvent("beforeload",this,e)){for(this.removeStoreHandlers();e.firstChild;)e.removeChild(e.firstChild);this.uiProviders||(this.uiProviders=e.getOwnerTree().getLoader().uiProviders),this.store||(this.store=GeoExt.MapPanel.guess().layers),this.store.each(function(t){this.addLayerNode(e,t)},this),this.addStoreHandlers(e),"function"==typeof t&&t(),this.fireEvent("load",this,e)}},onStoreAdd:function(e,t,i,s){if(!this._reordering)for(var n=s.recordIndexToNodeIndex(i+t.length-1),r=0;r<t.length;++r)this.addLayerNode(s,t[r],n)},onStoreRemove:function(e,t,i,s){this._reordering||this.removeLayerNode(s,t)},addLayerNode:function(e,t,i){if(i=i||0,this.filter(t)===!0){var s=this.createNode({nodeType:"gx_layer",layer:t.getLayer(),layerStore:this.store,iconCls:this.iconCls[t.id]}),n=e.item(i);n?e.insertBefore(s,n):e.appendChild(s),s.on("move",this.onChildMove,this)}},removeLayerNode:function(e,t){if(this.filter(t)===!0){var i=e.findChildBy(function(e){return e.layer==t.getLayer()});i&&(i.un("move",this.onChildMove,this),i.remove(),e.reload())}},onChildMove:function(e,t,i,s,n){this._reordering=!0;var r=this.store.getByLayer(t.layer);if(delete i.loader.iconCls[r.id],s instanceof GeoExt.tree.LayerContainer&&this.store===s.loader.store){s.loader._reordering=!0,s.loader.iconCls[r.id]=t.attributes.iconCls,this.store.remove(r);var a;if(s.childNodes.length>1){var o=0===n?n+1:n-1;a=this.store.findBy(function(e){return s.childNodes[o].layer===e.getLayer()}),0===n&&a++}else if(i.parentNode===s.parentNode){var l=s;do l=l.previousSibling;while(l&&!(l instanceof GeoExt.tree.LayerContainer&&l.lastChild));if(l)a=this.store.findBy(function(e){return l.lastChild.layer===e.getLayer()});else{var h=s;do h=h.nextSibling;while(h&&!(h instanceof GeoExt.tree.LayerContainer&&h.firstChild));h&&(a=this.store.findBy(function(e){return h.firstChild.layer===e.getLayer()})),a++}}void 0!==a?(this.store.insert(a,[r]),window.setTimeout(function(){s.reload(),i.reload()})):this.store.insert(oldRecordIndex,[r]),delete s.loader._reordering}delete this._reordering},addStoreHandlers:function(e){if(!this._storeHandlers){this._storeHandlers={add:this.onStoreAdd.createDelegate(this,[e],!0),remove:this.onStoreRemove.createDelegate(this,[e],!0)};for(var t in this._storeHandlers)this.store.on(t,this._storeHandlers[t],this)}},removeStoreHandlers:function(){if(this._storeHandlers){for(var e in this._storeHandlers)this.store.un(e,this._storeHandlers[e],this);delete this._storeHandlers}},createNode:function(attr){return this.baseAttrs&&Ext.apply(attr,this.baseAttrs),"string"==typeof attr.uiProvider&&(attr.uiProvider=this.uiProviders[attr.uiProvider]||eval(attr.uiProvider)),attr.nodeType=attr.nodeType||"gx_layer",new Ext.tree.TreePanel.nodeTypes[attr.nodeType](attr)},destroy:function(){this.removeStoreHandlers(),this.iconCls=null}}),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.tree"),GeoExt.tree.LayerNodeUI=Ext.extend(Ext.tree.TreeNodeUI,{constructor:function(){GeoExt.tree.LayerNodeUI.superclass.constructor.apply(this,arguments)},render:function(){var e=this.node.attributes;void 0===e.checked&&(e.checked=this.node.layer.getVisibility()),void 0===e.disabled&&this.node.autoDisable&&(this.node.disabled=this.node.layer.inRange===!1||!this.node.layer.calculateInRange()),GeoExt.tree.LayerNodeUI.superclass.render.apply(this,arguments);var t=this.checkbox;if(e.checkedGroup){var i=Ext.DomHelper.insertAfter(t,['<input type="radio" name="',e.checkedGroup,'_checkbox" class="',t.className,t.checked?'" checked="checked"':"",'"></input>'].join(""));i.defaultChecked=t.defaultChecked,Ext.get(t).remove(),this.checkbox=i}this.enforceOneVisible()},onClick:function(e){e.getTarget(".x-tree-node-cb",1)?this.toggleCheck(this.isChecked()):GeoExt.tree.LayerNodeUI.superclass.onClick.apply(this,arguments)},toggleCheck:function(e){e=void 0===e?!this.isChecked():e,GeoExt.tree.LayerNodeUI.superclass.toggleCheck.call(this,e),this.enforceOneVisible()},enforceOneVisible:function(){var e=this.node.attributes,t=e.checkedGroup;if(t&&"gx_baselayer"!==t){var i=this.node.layer,s=this.node.getOwnerTree().getChecked(),n=0;Ext.each(s,function(s){var r=s.layer;s.hidden||s.attributes.checkedGroup!==t||(n++,r!=i&&e.checked&&r.setVisibility(!1))}),0===n&&0==e.checked&&i.setVisibility(!0)}},appendDDGhost:function(e){var t=this.elNode.cloneNode(!0),i=Ext.DomQuery.select("input[type='radio']",t);Ext.each(i,function(e){e.name=e.name+"_clone"}),e.appendChild(t)}}),GeoExt.tree.LayerNode=Ext.extend(Ext.tree.AsyncTreeNode,{layer:null,autoDisable:null,layerStore:null,constructor:function(e){e.leaf=e.leaf||!(e.children||e.loader),e.iconCls||e.children||(e.iconCls="gx-tree-layer-icon"),!e.loader||e.loader instanceof Ext.tree.TreeLoader||(e.loader=new GeoExt.tree.LayerParamLoader(e.loader)),this.defaultUI=this.defaultUI||GeoExt.tree.LayerNodeUI,Ext.apply(this,{layer:e.layer,layerStore:e.layerStore,autoDisable:e.autoDisable}),e.text&&(this.fixedText=!0),GeoExt.tree.LayerNode.superclass.constructor.apply(this,arguments)},render:function(){var e=this.layer instanceof OpenLayers.Layer&&this.layer;if(!e){this.layerStore&&"auto"!=this.layerStore||(this.layerStore=GeoExt.MapPanel.guess().layers);var t=this.layerStore.findBy(function(e){return e.get("title")==this.layer},this);-1!=t&&(e=this.layerStore.getAt(t).getLayer())}if(!this.rendered||!e){var i=this.getUI();e?(this.layer=e,e.isBaseLayer&&(this.draggable=!1,Ext.applyIf(this.attributes,{checkedGroup:"gx_baselayer"})),this.autoDisable=!(this.autoDisable===!1||this.layer.isBaseLayer||this.layer.alwaysInRange),this.text||(this.text=e.name),i.show(),this.addVisibilityEventHandlers()):i.hide(),this.layerStore instanceof GeoExt.data.LayerStore&&this.addStoreEventHandlers(e)}GeoExt.tree.LayerNode.superclass.render.apply(this,arguments)},addVisibilityEventHandlers:function(){this.layer.events.on({visibilitychanged:this.onLayerVisibilityChanged,scope:this}),this.on({checkchange:this.onCheckChange,scope:this}),this.autoDisable&&(this.layer.map?this.layer.map.events.register("moveend",this,this.onMapMoveend):this.layer.events.register("added",this,function e(){this.layer.events.unregister("added",this,e),this.layer.map.events.register("moveend",this,this.onMapMoveend)}))},onLayerVisibilityChanged:function(){this._visibilityChanging||this.getUI().toggleCheck(this.layer.getVisibility())},onCheckChange:function(e,t){if(t!=this.layer.getVisibility()){this._visibilityChanging=!0;var i=this.layer;t&&i.isBaseLayer&&i.map?i.map.setBaseLayer(i):i.setVisibility(t),delete this._visibilityChanging}},onMapMoveend:function(){this.autoDisable&&(this.layer.inRange===!1?this.disable():this.enable())},addStoreEventHandlers:function(){this.layerStore.on({add:this.onStoreAdd,remove:this.onStoreRemove,update:this.onStoreUpdate,scope:this})},onStoreAdd:function(e,t){for(var i,s=0;s<t.length;++s){if(i=t[s].getLayer(),this.layer==i){this.getUI().show();break}if(this.layer==i.name){this.render();break}}},onStoreRemove:function(e,t){this.layer==t.getLayer()&&this.getUI().hide()},onStoreUpdate:function(e,t){var i=t.getLayer();this.fixedText||this.layer!=i||this.text===i.name||this.setText(i.name)},destroy:function(){var e=this.layer;e instanceof OpenLayers.Layer&&(e.map&&e.map.events.unregister("moveend",this,this.onMapMoveend),e.events.un({visibilitychanged:this.onLayerVisibilityChanged,scope:this})),delete this.layer;var t=this.layerStore;t&&(t.un("add",this.onStoreAdd,this),t.un("remove",this.onStoreRemove,this),t.un("update",this.onStoreUpdate,this)),delete this.layerStore,this.un("checkchange",this.onCheckChange,this),GeoExt.tree.LayerNode.superclass.destroy.apply(this,arguments)}}),Ext.tree.TreePanel.nodeTypes.gx_layer=GeoExt.tree.LayerNode,/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.tree"),GeoExt.tree.LayerParamLoader=function(e){Ext.apply(this,e),this.addEvents("beforeload","load"),GeoExt.tree.LayerParamLoader.superclass.constructor.call(this)},Ext.extend(GeoExt.tree.LayerParamLoader,Ext.util.Observable,{param:null,delimiter:",",load:function(e,t){if(this.fireEvent("beforeload",this,e)){for(;e.firstChild;)e.removeChild(e.firstChild);var i=e.layer instanceof OpenLayers.Layer.HTTPRequest&&e.layer.params[this.param];if(i){var s=i instanceof Array?i.slice():i.split(this.delimiter);Ext.each(s,function(t,i,s){this.addParamNode(t,s,e)},this)}"function"==typeof t&&t(),this.fireEvent("load",this,e)}},addParamNode:function(e,t,i){var s=this.createNode({layer:i.layer,param:this.param,item:e,allItems:t,delimiter:this.delimiter}),n=i.item(0);n?i.insertBefore(s,n):i.appendChild(s)},createNode:function(attr){return this.baseAttrs&&Ext.apply(attr,this.baseAttrs),"string"==typeof attr.uiProvider&&(attr.uiProvider=this.uiProviders[attr.uiProvider]||eval(attr.uiProvider)),attr.nodeType=attr.nodeType||"gx_layerparam",new Ext.tree.TreePanel.nodeTypes[attr.nodeType](attr)}}),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.tree"),GeoExt.tree.LayerParamNode=Ext.extend(Ext.tree.TreeNode,{layer:null,param:null,item:null,delimiter:null,allItems:null,constructor:function(e){var t=e||{};t.iconCls=t.iconCls||"gx-tree-layerparam-icon",t.text=t.text||t.item,this.param=t.param,this.item=t.item,this.delimiter=t.delimiter||",",this.allItems=t.allItems,GeoExt.tree.LayerParamNode.superclass.constructor.apply(this,arguments),this.getLayer(),this.layer&&(this.allItems||(this.allItems=this.getItemsFromLayer()),null==this.attributes.checked?this.attributes.checked=this.layer.getVisibility()&&this.getItemsFromLayer().indexOf(this.item)>=0:this.onCheckChange(this,this.attributes.checked),this.layer.events.on({visibilitychanged:this.onLayerVisibilityChanged,scope:this}),this.on({checkchange:this.onCheckChange,scope:this}))},getLayer:function(){if(!this.layer){var e=this.attributes.layer;if("string"==typeof e){var t=this.attributes.layerStore||GeoExt.MapPanel.guess().layers,i=t.findBy(function(t){return t.get("title")==e});e=-1!=i?t.getAt(i).getLayer():null}this.layer=e}return this.layer},getItemsFromLayer:function(){var e=this.layer.params[this.param];return e instanceof Array?e:e?e.split(this.delimiter):[]},createParams:function(e){var t={};return t[this.param]=this.layer.params[this.param]instanceof Array?e:e.join(this.delimiter),t},onLayerVisibilityChanged:function(){0===this.getItemsFromLayer().length&&this.layer.mergeNewParams(this.createParams(this.allItems));var e=this.layer.getVisibility();e&&-1!==this.getItemsFromLayer().indexOf(this.item)&&this.getUI().toggleCheck(!0),e||(this.layer.mergeNewParams(this.createParams([])),this.getUI().toggleCheck(!1))},onCheckChange:function(e,t){var i=this.layer,s=[],n=this.getItemsFromLayer();t===!0&&i.getVisibility()===!1&&n.length===this.allItems.length&&(n=[]),Ext.each(this.allItems,function(e){(e!==this.item&&-1!==n.indexOf(e)||t===!0&&e===this.item)&&s.push(e)},this);var r=s.length>0;r&&i.mergeNewParams(this.createParams(s)),r!==i.getVisibility()&&i.setVisibility(r),!r&&i.mergeNewParams(this.createParams([]))},destroy:function(){var e=this.layer;e instanceof OpenLayers.Layer&&e.events.un({visibilitychanged:this.onLayerVisibilityChanged,scope:this}),delete this.layer,this.un("checkchange",this.onCheckChange,this),GeoExt.tree.LayerParamNode.superclass.destroy.apply(this,arguments)}}),Ext.tree.TreePanel.nodeTypes.gx_layerparam=GeoExt.tree.LayerParamNode,/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.tree"),GeoExt.tree.OverlayLayerContainer=Ext.extend(GeoExt.tree.LayerContainer,{text:"Overlays",constructor:function(e){e=Ext.applyIf(e||{},{text:this.text}),e.loader=Ext.applyIf(e.loader||{},{filter:function(e){var t=e.getLayer();return t.displayInLayerSwitcher===!0&&t.isBaseLayer===!1}}),GeoExt.tree.OverlayLayerContainer.superclass.constructor.call(this,e)}}),Ext.tree.TreePanel.nodeTypes.gx_overlaylayercontainer=GeoExt.tree.OverlayLayerContainer,/**
 * Copyright (c) 2008-2009 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.tree"),GeoExt.tree.TreeNodeUIEventMixin=function(){return{constructor:function(e){e.addEvents("rendernode","rawclicknode"),this.superclass=arguments.callee.superclass,this.superclass.constructor.apply(this,arguments)},render:function(){this.rendered||(this.superclass.render.apply(this,arguments),this.fireEvent("rendernode",this.node))},onClick:function(e){this.fireEvent("rawclicknode",this.node,e)!==!1&&this.superclass.onClick.apply(this,arguments)}}},/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 *
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
Ext.namespace("GeoExt.tree"),GeoExt.tree.WMSCapabilitiesLoader=function(e){Ext.apply(this,e),GeoExt.tree.WMSCapabilitiesLoader.superclass.constructor.call(this)},Ext.extend(GeoExt.tree.WMSCapabilitiesLoader,Ext.tree.TreeLoader,{url:null,layerOptions:null,layerParams:null,requestMethod:"GET",getParams:function(){return{service:"WMS",request:"GetCapabilities"}},processResponse:function(e,t,i,s){var n=(new OpenLayers.Format.WMSCapabilities).read(e.responseXML&&e.responseXML.documentElement?e.responseXML:e.responseText);n.capability&&this.processLayer(n.capability,n.capability.request.getmap.href,t),"function"==typeof i&&i.apply(s||t,[t])},createWMSLayer:function(e,t){return e.name?new OpenLayers.Layer.WMS(e.title,t,OpenLayers.Util.extend({format:e.formats[0],layers:e.name},this.layerParams),OpenLayers.Util.extend({minScale:e.minScale,queryable:e.queryable,maxScale:e.maxScale,metadata:e},this.layerOptions)):null},processLayer:function(e,t,i){Ext.each(e.nestedLayers,function(e){var s=this.createNode({text:e.title||e.name,nodeType:"node",layer:this.createWMSLayer(e,t),leaf:0===e.nestedLayers.length});s&&i.appendChild(s),e.nestedLayers&&this.processLayer(e,t,s)},this)}}),/**
 * Copyright (c) 2008-2012 The Open Source Geospatial Foundation
 * 
 * Published under the BSD license.
 * See http://svn.geoext.org/core/trunk/geoext/license.txt for the full text
 * of the license.
 */
function(){var e=function(e,t){return function(i){t&&t[e]&&t[e].call(t.scope||window,Ext.applyIf({argument:t.argument},i))}};Ext.apply(Ext.lib.Ajax,{request:function(t,i,s,n,r){r=r||{},t=t||r.method;var a=r.headers;return r.xmlData?(a&&a["Content-Type"]||(a=a||{},a["Content-Type"]="text/xml"),t=t||"POST",n=r.xmlData):r.jsonData&&(a&&a["Content-Type"]||(a=a||{},a["Content-Type"]="application/json"),t=t||"POST",n="object"==typeof r.jsonData?Ext.encode(r.jsonData):r.jsonData),!t||"post"!=t.toLowerCase()||!r.form&&!r.params||a&&a["Content-Type"]||(a=a||{},a["Content-Type"]="application/x-www-form-urlencoded"),OpenLayers.Request.issue({success:e("success",s),failure:e("failure",s),method:t,headers:a,data:n,url:i})},isCallInProgress:function(){return!0},abort:function(e){e.abort()}})}();/*
 proj4js.js -- Javascript reprojection library.

 Authors:      Mike Adair madairATdmsolutions.ca
 Richard Greenwood richATgreenwoodmap.com
 Didier Richard didier.richardATign.fr
 Stephen Irons stephen.ironsATclear.net.nz
 Olivier Terral oterralATgmail.com

 License:
 Copyright (c) 2012, Mike Adair, Richard Greenwood, Didier Richard,
 Stephen Irons and Olivier Terral

 Permission is hereby granted, free of charge, to any person obtaining a
 copy of this software and associated documentation files (the "Software"),
 to deal in the Software without restriction, including without limitation
 the rights to use, copy, modify, merge, publish, distribute, sublicense,
 and/or sell copies of the Software, and to permit persons to whom the
 Software is furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included
 in all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
 OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
 DEALINGS IN THE SOFTWARE.

 Note: This program is an almost direct port of the C library PROJ.4.
 */
var Proj4js={defaultDatum:"WGS84",transform:function(e,t,i){if(!e.readyToUse)return this.reportError("Proj4js initialization for:"+e.srsCode+" not yet complete"),i;if(!t.readyToUse)return this.reportError("Proj4js initialization for:"+t.srsCode+" not yet complete"),i;if(e.datum&&t.datum&&((e.datum.datum_type==Proj4js.common.PJD_3PARAM||e.datum.datum_type==Proj4js.common.PJD_7PARAM)&&"WGS84"!=t.datumCode||(t.datum.datum_type==Proj4js.common.PJD_3PARAM||t.datum.datum_type==Proj4js.common.PJD_7PARAM)&&"WGS84"!=e.datumCode)){var s=Proj4js.WGS84;this.transform(e,s,i),e=s}return"enu"!=e.axis&&this.adjust_axis(e,!1,i),"longlat"==e.projName?(i.x*=Proj4js.common.D2R,i.y*=Proj4js.common.D2R):(e.to_meter&&(i.x*=e.to_meter,i.y*=e.to_meter),e.inverse(i)),e.from_greenwich&&(i.x+=e.from_greenwich),i=this.datum_transform(e.datum,t.datum,i),t.from_greenwich&&(i.x-=t.from_greenwich),"longlat"==t.projName?(i.x*=Proj4js.common.R2D,i.y*=Proj4js.common.R2D):(t.forward(i),t.to_meter&&(i.x/=t.to_meter,i.y/=t.to_meter)),"enu"!=t.axis&&this.adjust_axis(t,!0,i),i},datum_transform:function(e,t,i){return e.compare_datums(t)||e.datum_type==Proj4js.common.PJD_NODATUM||t.datum_type==Proj4js.common.PJD_NODATUM?i:((e.es!=t.es||e.a!=t.a||e.datum_type==Proj4js.common.PJD_3PARAM||e.datum_type==Proj4js.common.PJD_7PARAM||t.datum_type==Proj4js.common.PJD_3PARAM||t.datum_type==Proj4js.common.PJD_7PARAM)&&(e.geodetic_to_geocentric(i),(e.datum_type==Proj4js.common.PJD_3PARAM||e.datum_type==Proj4js.common.PJD_7PARAM)&&e.geocentric_to_wgs84(i),(t.datum_type==Proj4js.common.PJD_3PARAM||t.datum_type==Proj4js.common.PJD_7PARAM)&&t.geocentric_from_wgs84(i),t.geocentric_to_geodetic(i)),i)},adjust_axis:function(e,t,i){for(var s,n,r=i.x,a=i.y,o=i.z||0,l=0;3>l;l++)if(!t||2!=l||void 0!==i.z)switch(0==l?(s=r,n="x"):1==l?(s=a,n="y"):(s=o,n="z"),e.axis[l]){case"e":i[n]=s;break;case"w":i[n]=-s;break;case"n":i[n]=s;break;case"s":i[n]=-s;break;case"u":void 0!==i[n]&&(i.z=s);break;case"d":void 0!==i[n]&&(i.z=-s);break;default:return alert("ERROR: unknow axis ("+e.axis[l]+") - check definition of "+e.projName),null}return i},reportError:function(){},extend:function(e,t){if(e=e||{},t)for(var i in t){var s=t[i];void 0!==s&&(e[i]=s)}return e},Class:function(){for(var e,t=function(){this.initialize.apply(this,arguments)},i={},s=0;s<arguments.length;++s)e="function"==typeof arguments[s]?arguments[s].prototype:arguments[s],Proj4js.extend(i,e);return t.prototype=i,t},bind:function(e,t){var i=Array.prototype.slice.apply(arguments,[2]);return function(){var s=i.concat(Array.prototype.slice.apply(arguments,[0]));return e.apply(t,s)}},scriptName:"proj4js-compressed.js",defsLookupService:"http://spatialreference.org/ref",libPath:null,getScriptLocation:function(){if(this.libPath)return this.libPath;for(var e=this.scriptName,t=e.length,i=document.getElementsByTagName("script"),s=0;s<i.length;s++){var n=i[s].getAttribute("src");if(n){var r=n.lastIndexOf(e);if(r>-1&&r+t==n.length){this.libPath=n.slice(0,-t);break}}}return this.libPath||""},loadScript:function(e,t,i,s){var n=document.createElement("script");n.defer=!1,n.type="text/javascript",n.id=e,n.src=e,n.onload=t,n.onerror=i,n.loadCheck=s,/MSIE/.test(navigator.userAgent)&&(n.onreadystatechange=this.checkReadyState),document.getElementsByTagName("head")[0].appendChild(n)},checkReadyState:function(){"loaded"==this.readyState&&(this.loadCheck()?this.onload():this.onerror())}};Proj4js.Proj=Proj4js.Class({readyToUse:!1,title:null,projName:null,units:null,datum:null,x0:0,y0:0,localCS:!1,queue:null,initialize:function(e,t){if(this.srsCodeInput=e,this.queue=[],t&&this.queue.push(t),0<=e.indexOf("GEOGCS")||0<=e.indexOf("GEOCCS")||0<=e.indexOf("PROJCS")||0<=e.indexOf("LOCAL_CS"))this.parseWKT(e),this.deriveConstants(),this.loadProjCode(this.projName);else{if(0==e.indexOf("urn:")){var i=e.split(":");"ogc"!=i[1]&&"x-ogc"!=i[1]||"def"!=i[2]||"crs"!=i[3]||(e=i[4]+":"+i[i.length-1])}else 0==e.indexOf("http://")&&(i=e.split("#"),i[0].match(/epsg.org/)?e="EPSG:"+i[1]:i[0].match(/RIG.xml/)&&(e="IGNF:"+i[1]));this.srsCode=e.toUpperCase(),0==this.srsCode.indexOf("EPSG")?(this.srsCode=this.srsCode,this.srsAuth="epsg",this.srsProjNumber=this.srsCode.substring(5)):0==this.srsCode.indexOf("IGNF")?(this.srsCode=this.srsCode,this.srsAuth="IGNF",this.srsProjNumber=this.srsCode.substring(5)):0==this.srsCode.indexOf("CRS")?(this.srsCode=this.srsCode,this.srsAuth="CRS",this.srsProjNumber=this.srsCode.substring(4)):(this.srsAuth="",this.srsProjNumber=this.srsCode),this.loadProjDefinition()}},loadProjDefinition:function(){if(Proj4js.defs[this.srsCode])this.defsLoaded();else{var e=Proj4js.getScriptLocation()+"defs/"+this.srsAuth.toUpperCase()+this.srsProjNumber+".js";Proj4js.loadScript(e,Proj4js.bind(this.defsLoaded,this),Proj4js.bind(this.loadFromService,this),Proj4js.bind(this.checkDefsLoaded,this))}},loadFromService:function(){Proj4js.loadScript(Proj4js.defsLookupService+"/"+this.srsAuth+"/"+this.srsProjNumber+"/proj4js/",Proj4js.bind(this.defsLoaded,this),Proj4js.bind(this.defsFailed,this),Proj4js.bind(this.checkDefsLoaded,this))},defsLoaded:function(){this.parseDefs(),this.loadProjCode(this.projName)},checkDefsLoaded:function(){return Proj4js.defs[this.srsCode]?!0:!1},defsFailed:function(){Proj4js.reportError("failed to load projection definition for: "+this.srsCode),Proj4js.defs[this.srsCode]=Proj4js.defs.WGS84,this.defsLoaded()},loadProjCode:function(e){if(Proj4js.Proj[e])this.initTransforms();else{var t=Proj4js.getScriptLocation()+"projCode/"+e+".js";Proj4js.loadScript(t,Proj4js.bind(this.loadProjCodeSuccess,this,e),Proj4js.bind(this.loadProjCodeFailure,this,e),Proj4js.bind(this.checkCodeLoaded,this,e))}},loadProjCodeSuccess:function(e){Proj4js.Proj[e].dependsOn?this.loadProjCode(Proj4js.Proj[e].dependsOn):this.initTransforms()},loadProjCodeFailure:function(e){Proj4js.reportError("failed to find projection file for: "+e)},checkCodeLoaded:function(e){return Proj4js.Proj[e]?!0:!1},initTransforms:function(){if(Proj4js.extend(this,Proj4js.Proj[this.projName]),this.init(),this.readyToUse=!0,this.queue)for(var e;e=this.queue.shift();)e.call(this,this)},wktRE:/^(\w+)\[(.*)\]$/,parseWKT:function(e){if(e=e.match(this.wktRE)){var t,i=e[1],s=e[2].split(",");t="TOWGS84"==i.toUpperCase()?i:s.shift(),t=t.replace(/^\"/,""),t=t.replace(/\"$/,"");for(var e=[],n=0,r="",a=0;a<s.length;++a){for(var o=s[a],l=0;l<o.length;++l)"["==o.charAt(l)&&++n,"]"==o.charAt(l)&&--n;r+=o,0===n?(e.push(r),r=""):r+=","}switch(i){case"LOCAL_CS":this.projName="identity",this.localCS=!0,this.srsCode=t;break;case"GEOGCS":this.projName="longlat",this.geocsCode=t,this.srsCode||(this.srsCode=t);break;case"PROJCS":this.srsCode=t;break;case"PROJECTION":this.projName=Proj4js.wktProjections[t];break;case"DATUM":this.datumName=t;break;case"LOCAL_DATUM":this.datumCode="none";break;case"SPHEROID":this.ellps=t,this.a=parseFloat(e.shift()),this.rf=parseFloat(e.shift());break;case"PRIMEM":this.from_greenwich=parseFloat(e.shift());break;case"UNIT":this.units=t,this.unitsPerMeter=parseFloat(e.shift());break;case"PARAMETER":switch(i=t.toLowerCase(),s=parseFloat(e.shift()),i){case"false_easting":this.x0=s;break;case"false_northing":this.y0=s;break;case"scale_factor":this.k0=s;break;case"central_meridian":this.long0=s*Proj4js.common.D2R;break;case"latitude_of_origin":this.lat0=s*Proj4js.common.D2R}break;case"TOWGS84":this.datum_params=e;break;case"AXIS":switch(i=t.toLowerCase(),s=e.shift()){case"EAST":s="e";break;case"WEST":s="w";break;case"NORTH":s="n";break;case"SOUTH":s="s";break;case"UP":s="u";break;case"DOWN":s="d";break;default:s=" "}switch(this.axis||(this.axis="enu"),i){case"x":this.axis=s+this.axis.substr(1,2);break;case"y":this.axis=this.axis.substr(0,1)+s+this.axis.substr(2,1);break;case"z":this.axis=this.axis.substr(0,2)+s}}for(a=0;a<e.length;++a)this.parseWKT(e[a])}},parseDefs:function(){this.defData=Proj4js.defs[this.srsCode];var e,t;if(this.defData){for(var i=this.defData.split("+"),s=0;s<i.length;s++)switch(t=i[s].split("="),e=t[0].toLowerCase(),t=t[1],e.replace(/\s/gi,"")){case"title":this.title=t;break;case"proj":this.projName=t.replace(/\s/gi,"");break;case"units":this.units=t.replace(/\s/gi,"");break;case"datum":this.datumCode=t.replace(/\s/gi,"");break;case"nadgrids":this.nagrids=t.replace(/\s/gi,"");break;case"ellps":this.ellps=t.replace(/\s/gi,"");break;case"a":this.a=parseFloat(t);break;case"b":this.b=parseFloat(t);break;case"rf":this.rf=parseFloat(t);break;case"lat_0":this.lat0=t*Proj4js.common.D2R;break;case"lat_1":this.lat1=t*Proj4js.common.D2R;break;case"lat_2":this.lat2=t*Proj4js.common.D2R;break;case"lat_ts":this.lat_ts=t*Proj4js.common.D2R;break;case"lon_0":this.long0=t*Proj4js.common.D2R;break;case"alpha":this.alpha=parseFloat(t)*Proj4js.common.D2R;break;case"lonc":this.longc=t*Proj4js.common.D2R;break;case"x_0":this.x0=parseFloat(t);break;case"y_0":this.y0=parseFloat(t);break;case"k_0":this.k0=parseFloat(t);break;case"k":this.k0=parseFloat(t);break;case"r_a":this.R_A=!0;break;case"zone":this.zone=parseInt(t,10);break;case"south":this.utmSouth=!0;break;case"towgs84":this.datum_params=t.split(",");break;case"to_meter":this.to_meter=parseFloat(t);break;case"from_greenwich":this.from_greenwich=t*Proj4js.common.D2R;break;case"pm":t=t.replace(/\s/gi,""),this.from_greenwich=Proj4js.PrimeMeridian[t]?Proj4js.PrimeMeridian[t]:parseFloat(t),this.from_greenwich*=Proj4js.common.D2R;break;case"axis":t=t.replace(/\s/gi,""),3==t.length&&-1!="ewnsud".indexOf(t.substr(0,1))&&-1!="ewnsud".indexOf(t.substr(1,1))&&-1!="ewnsud".indexOf(t.substr(2,1))&&(this.axis=t)}this.deriveConstants()}},deriveConstants:function(){if("@null"==this.nagrids&&(this.datumCode="none"),this.datumCode&&"none"!=this.datumCode){var e=Proj4js.Datum[this.datumCode];e&&(this.datum_params=e.towgs84?e.towgs84.split(","):null,this.ellps=e.ellipse,this.datumName=e.datumName?e.datumName:this.datumCode)}this.a||Proj4js.extend(this,Proj4js.Ellipsoid[this.ellps]?Proj4js.Ellipsoid[this.ellps]:Proj4js.Ellipsoid.WGS84),this.rf&&!this.b&&(this.b=(1-1/this.rf)*this.a),(0===this.rf||Math.abs(this.a-this.b)<Proj4js.common.EPSLN)&&(this.sphere=!0,this.b=this.a),this.a2=this.a*this.a,this.b2=this.b*this.b,this.es=(this.a2-this.b2)/this.a2,this.e=Math.sqrt(this.es),this.R_A&&(this.a*=1-this.es*(Proj4js.common.SIXTH+this.es*(Proj4js.common.RA4+this.es*Proj4js.common.RA6)),this.a2=this.a*this.a,this.b2=this.b*this.b,this.es=0),this.ep2=(this.a2-this.b2)/this.b2,this.k0||(this.k0=1),this.axis||(this.axis="enu"),this.datum=new Proj4js.datum(this)}}),Proj4js.Proj.longlat={init:function(){},forward:function(e){return e},inverse:function(e){return e}},Proj4js.Proj.identity=Proj4js.Proj.longlat,Proj4js.defs={WGS84:"+title=long/lat:WGS84 +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees","EPSG:4326":"+title=long/lat:WGS84 +proj=longlat +a=6378137.0 +b=6356752.31424518 +ellps=WGS84 +datum=WGS84 +units=degrees","EPSG:4269":"+title=long/lat:NAD83 +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees","EPSG:3875":"+title= Google Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"},Proj4js.defs["EPSG:3785"]=Proj4js.defs["EPSG:3875"],Proj4js.defs.GOOGLE=Proj4js.defs["EPSG:3875"],Proj4js.defs["EPSG:900913"]=Proj4js.defs["EPSG:3875"],Proj4js.defs["EPSG:102113"]=Proj4js.defs["EPSG:3875"],Proj4js.common={PI:3.141592653589793,HALF_PI:1.5707963267948966,TWO_PI:6.283185307179586,FORTPI:.7853981633974483,R2D:57.29577951308232,D2R:.017453292519943295,SEC_TO_RAD:484813681109536e-20,EPSLN:1e-10,MAX_ITER:20,COS_67P5:.3826834323650898,AD_C:1.0026,PJD_UNKNOWN:0,PJD_3PARAM:1,PJD_7PARAM:2,PJD_GRIDSHIFT:3,PJD_WGS84:4,PJD_NODATUM:5,SRS_WGS84_SEMIMAJOR:6378137,SIXTH:.16666666666666666,RA4:.04722222222222222,RA6:.022156084656084655,RV4:.06944444444444445,RV6:.04243827160493827,msfnz:function(e,t,i){return e*=t,i/Math.sqrt(1-e*e)},tsfnz:function(e,t,i){return i*=e,i=Math.pow((1-i)/(1+i),.5*e),Math.tan(.5*(this.HALF_PI-t))/i},phi2z:function(e,t){for(var i,s=.5*e,n=this.HALF_PI-2*Math.atan(t),r=0;15>=r;r++)if(i=e*Math.sin(n),i=this.HALF_PI-2*Math.atan(t*Math.pow((1-i)/(1+i),s))-n,n+=i,1e-10>=Math.abs(i))return n;return alert("phi2z has NoConvergence"),-9999},qsfnz:function(e,t){var i;return e>1e-7?(i=e*t,(1-e*e)*(t/(1-i*i)-.5/e*Math.log((1-i)/(1+i)))):2*t},asinz:function(e){return 1<Math.abs(e)&&(e=e>1?1:-1),Math.asin(e)},e0fn:function(e){return 1-.25*e*(1+e/16*(3+1.25*e))},e1fn:function(e){return.375*e*(1+.25*e*(1+.46875*e))},e2fn:function(e){return.05859375*e*e*(1+.75*e)},e3fn:function(e){return e*e*e*(35/3072)},mlfn:function(e,t,i,s,n){return e*n-t*Math.sin(2*n)+i*Math.sin(4*n)-s*Math.sin(6*n)},srat:function(e,t){return Math.pow((1-e)/(1+e),t)},sign:function(e){return 0>e?-1:1},adjust_lon:function(e){return e=Math.abs(e)<this.PI?e:e-this.sign(e)*this.TWO_PI},adjust_lat:function(e){return e=Math.abs(e)<this.HALF_PI?e:e-this.sign(e)*this.PI},latiso:function(e,t,i){return Math.abs(t)>this.HALF_PI?+Number.NaN:t==this.HALF_PI?Number.POSITIVE_INFINITY:t==-1*this.HALF_PI?-1*Number.POSITIVE_INFINITY:(i*=e,Math.log(Math.tan((this.HALF_PI+t)/2))+e*Math.log((1-i)/(1+i))/2)},fL:function(e,t){return 2*Math.atan(e*Math.exp(t))-this.HALF_PI},invlatiso:function(e,t){var i=this.fL(1,t),s=0,n=0;do s=i,n=e*Math.sin(s),i=this.fL(Math.exp(e*Math.log((1+n)/(1-n))/2),t);while(1e-12<Math.abs(i-s));return i},sinh:function(e){return e=Math.exp(e),(e-1/e)/2},cosh:function(e){return e=Math.exp(e),(e+1/e)/2},tanh:function(e){return e=Math.exp(e),(e-1/e)/(e+1/e)},asinh:function(e){return(e>=0?1:-1)*Math.log(Math.abs(e)+Math.sqrt(e*e+1))},acosh:function(e){return 2*Math.log(Math.sqrt((e+1)/2)+Math.sqrt((e-1)/2))},atanh:function(e){return Math.log((e-1)/(e+1))/2},gN:function(e,t,i){return t*=i,e/Math.sqrt(1-t*t)},pj_enfn:function(e){var t=[];t[0]=this.C00-e*(this.C02+e*(this.C04+e*(this.C06+e*this.C08))),t[1]=e*(this.C22-e*(this.C04+e*(this.C06+e*this.C08)));var i=e*e;return t[2]=i*(this.C44-e*(this.C46+e*this.C48)),i*=e,t[3]=i*(this.C66-e*this.C68),t[4]=i*e*this.C88,t},pj_mlfn:function(e,t,i,s){return i*=t,t*=t,s[0]*e-i*(s[1]+t*(s[2]+t*(s[3]+t*s[4])))},pj_inv_mlfn:function(e,t,i){for(var s=1/(1-t),n=e,r=Proj4js.common.MAX_ITER;r;--r){var a=Math.sin(n),o=1-t*a*a,o=(this.pj_mlfn(n,a,Math.cos(n),i)-e)*o*Math.sqrt(o)*s,n=n-o;if(Math.abs(o)<Proj4js.common.EPSLN)return n}return Proj4js.reportError("cass:pj_inv_mlfn: Convergence error"),n},C00:1,C02:.25,C04:.046875,C06:.01953125,C08:.01068115234375,C22:.75,C44:.46875,C46:.013020833333333334,C48:.007120768229166667,C66:.3645833333333333,C68:.005696614583333333,C88:.3076171875},Proj4js.datum=Proj4js.Class({initialize:function(e){if(this.datum_type=Proj4js.common.PJD_WGS84,e.datumCode&&"none"==e.datumCode&&(this.datum_type=Proj4js.common.PJD_NODATUM),e&&e.datum_params){for(var t=0;t<e.datum_params.length;t++)e.datum_params[t]=parseFloat(e.datum_params[t]);(0!=e.datum_params[0]||0!=e.datum_params[1]||0!=e.datum_params[2])&&(this.datum_type=Proj4js.common.PJD_3PARAM),3<e.datum_params.length&&(0!=e.datum_params[3]||0!=e.datum_params[4]||0!=e.datum_params[5]||0!=e.datum_params[6])&&(this.datum_type=Proj4js.common.PJD_7PARAM,e.datum_params[3]*=Proj4js.common.SEC_TO_RAD,e.datum_params[4]*=Proj4js.common.SEC_TO_RAD,e.datum_params[5]*=Proj4js.common.SEC_TO_RAD,e.datum_params[6]=e.datum_params[6]/1e6+1)}e&&(this.a=e.a,this.b=e.b,this.es=e.es,this.ep2=e.ep2,this.datum_params=e.datum_params)},compare_datums:function(e){return this.datum_type!=e.datum_type||this.a!=e.a||5e-11<Math.abs(this.es-e.es)?!1:this.datum_type==Proj4js.common.PJD_3PARAM?this.datum_params[0]==e.datum_params[0]&&this.datum_params[1]==e.datum_params[1]&&this.datum_params[2]==e.datum_params[2]:this.datum_type==Proj4js.common.PJD_7PARAM?this.datum_params[0]==e.datum_params[0]&&this.datum_params[1]==e.datum_params[1]&&this.datum_params[2]==e.datum_params[2]&&this.datum_params[3]==e.datum_params[3]&&this.datum_params[4]==e.datum_params[4]&&this.datum_params[5]==e.datum_params[5]&&this.datum_params[6]==e.datum_params[6]:this.datum_type==Proj4js.common.PJD_GRIDSHIFT||e.datum_type==Proj4js.common.PJD_GRIDSHIFT?(alert("ERROR: Grid shift transformations are not implemented."),!1):!0},geodetic_to_geocentric:function(e){var t,i,s,n=e.x,r=e.y,a=e.z?e.z:0;if(r<-Proj4js.common.HALF_PI&&r>-1.001*Proj4js.common.HALF_PI)r=-Proj4js.common.HALF_PI;else if(r>Proj4js.common.HALF_PI&&r<1.001*Proj4js.common.HALF_PI)r=Proj4js.common.HALF_PI;else if(r<-Proj4js.common.HALF_PI||r>Proj4js.common.HALF_PI)return Proj4js.reportError("geocent:lat out of range:"+r),null;return n>Proj4js.common.PI&&(n-=2*Proj4js.common.PI),i=Math.sin(r),s=Math.cos(r),t=this.a/Math.sqrt(1-this.es*i*i),r=(t+a)*s*Math.cos(n),n=(t+a)*s*Math.sin(n),a=(t*(1-this.es)+a)*i,e.x=r,e.y=n,e.z=a,0},geocentric_to_geodetic:function(e){var t,i,s,n,r,a,o,l,h,u,c=e.x;s=e.y;var d=e.z?e.z:0;if(t=Math.sqrt(c*c+s*s),i=Math.sqrt(c*c+s*s+d*d),1e-12>t/this.a){if(c=0,1e-12>i/this.a)return}else c=Math.atan2(s,c);s=d/i,n=t/i,r=1/Math.sqrt(1-this.es*(2-this.es)*n*n),o=n*(1-this.es)*r,l=s*r,u=0;do u++,a=this.a/Math.sqrt(1-this.es*l*l),i=t*o+d*l-a*(1-this.es*l*l),a=this.es*a/(a+i),r=1/Math.sqrt(1-a*(2-a)*n*n),a=n*(1-a)*r,r*=s,h=r*o-a*l,o=a,l=r;while(h*h>1e-24&&30>u);return t=Math.atan(r/Math.abs(a)),e.x=c,e.y=t,e.z=i,e},geocentric_to_geodetic_noniter:function(e){var t,i,s,n,r,a=e.x,o=e.y,l=e.z?e.z:0,a=parseFloat(a),o=parseFloat(o),l=parseFloat(l);if(r=!1,0!=a)t=Math.atan2(o,a);else if(o>0)t=Proj4js.common.HALF_PI;else if(0>o)t=-Proj4js.common.HALF_PI;else if(r=!0,t=0,l>0)i=Proj4js.common.HALF_PI;else{if(!(0>l))return;i=-Proj4js.common.HALF_PI}return s=a*a+o*o,a=Math.sqrt(s),o=l*Proj4js.common.AD_C,s=Math.sqrt(o*o+s),o/=s,s=a/s,o=l+this.b*this.ep2*o*o*o,n=a-this.a*this.es*s*s*s,s=Math.sqrt(o*o+n*n),o/=s,s=n/s,n=this.a/Math.sqrt(1-this.es*o*o),l=s>=Proj4js.common.COS_67P5?a/s-n:s<=-Proj4js.common.COS_67P5?a/-s-n:l/o+n*(this.es-1),0==r&&(i=Math.atan(o/s)),e.x=t,e.y=i,e.z=l,e},geocentric_to_wgs84:function(e){if(this.datum_type==Proj4js.common.PJD_3PARAM)e.x+=this.datum_params[0],e.y+=this.datum_params[1],e.z+=this.datum_params[2];else if(this.datum_type==Proj4js.common.PJD_7PARAM){var t=this.datum_params[3],i=this.datum_params[4],s=this.datum_params[5],n=this.datum_params[6],r=n*(s*e.x+e.y-t*e.z)+this.datum_params[1],t=n*(-i*e.x+t*e.y+e.z)+this.datum_params[2];e.x=n*(e.x-s*e.y+i*e.z)+this.datum_params[0],e.y=r,e.z=t}},geocentric_from_wgs84:function(e){if(this.datum_type==Proj4js.common.PJD_3PARAM)e.x-=this.datum_params[0],e.y-=this.datum_params[1],e.z-=this.datum_params[2];else if(this.datum_type==Proj4js.common.PJD_7PARAM){var t=this.datum_params[3],i=this.datum_params[4],s=this.datum_params[5],n=this.datum_params[6],r=(e.x-this.datum_params[0])/n,a=(e.y-this.datum_params[1])/n,n=(e.z-this.datum_params[2])/n;e.x=r+s*a-i*n,e.y=-s*r+a+t*n,e.z=i*r-t*a+n}}}),Proj4js.Point=Proj4js.Class({initialize:function(e,t,i){"object"==typeof e?(this.x=e[0],this.y=e[1],this.z=e[2]||0):"string"==typeof e&&"undefined"==typeof t?(e=e.split(","),this.x=parseFloat(e[0]),this.y=parseFloat(e[1]),this.z=parseFloat(e[2])||0):(this.x=e,this.y=t,this.z=i||0)},clone:function(){return new Proj4js.Point(this.x,this.y,this.z)},toString:function(){return"x="+this.x+",y="+this.y},toShortString:function(){return this.x+", "+this.y}}),Proj4js.PrimeMeridian={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},Proj4js.Ellipsoid={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},"APL4.":{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS72:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}},Proj4js.Datum={WGS84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},GGRS87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},NAD83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},NAD27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},OSGB36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"}},Proj4js.WGS84=new Proj4js.Proj("WGS84"),Proj4js.Datum.OSB36=Proj4js.Datum.OSGB36,Proj4js.wktProjections={"Lambert Tangential Conformal Conic Projection":"lcc",Mercator:"merc","Popular Visualisation Pseudo Mercator":"merc",Mercator_1SP:"merc",Transverse_Mercator:"tmerc","Transverse Mercator":"tmerc","Lambert Azimuthal Equal Area":"laea","Universal Transverse Mercator System":"utm"},Proj4js.Proj.aea={init:function(){Math.abs(this.lat1+this.lat2)<Proj4js.common.EPSLN?Proj4js.reportError("aeaInitEqualLatitudes"):(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.con=this.t1=this.sin_po,this.ms1=Proj4js.common.msfnz(this.e3,this.sin_po,this.cos_po),this.qs1=Proj4js.common.qsfnz(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Proj4js.common.msfnz(this.e3,this.sin_po,this.cos_po),this.qs2=Proj4js.common.qsfnz(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Proj4js.common.qsfnz(this.e3,this.sin_po,this.cos_po),this.ns0=Math.abs(this.lat1-this.lat2)>Proj4js.common.EPSLN?(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(e){var t=e.x,i=e.y;this.sin_phi=Math.sin(i),this.cos_phi=Math.cos(i);var i=Proj4js.common.qsfnz(this.e3,this.sin_phi,this.cos_phi),i=this.a*Math.sqrt(this.c-this.ns0*i)/this.ns0,s=this.ns0*Proj4js.common.adjust_lon(t-this.long0),t=i*Math.sin(s)+this.x0,i=this.rh-i*Math.cos(s)+this.y0;return e.x=t,e.y=i,e},inverse:function(e){var t,i,s;return e.x-=this.x0,e.y=this.rh-e.y+this.y0,0<=this.ns0?(t=Math.sqrt(e.x*e.x+e.y*e.y),i=1):(t=-Math.sqrt(e.x*e.x+e.y*e.y),i=-1),s=0,0!=t&&(s=Math.atan2(i*e.x,i*e.y)),i=t*this.ns0/this.a,t=(this.c-i*i)/this.ns0,1e-10<=this.e3?(i=1-.5*(1-this.es)*Math.log((1-this.e3)/(1+this.e3))/this.e3,i=1e-10<Math.abs(Math.abs(i)-Math.abs(t))?this.phi1z(this.e3,t):t>=0?.5*Proj4js.common.PI:-.5*Proj4js.common.PI):i=this.phi1z(this.e3,t),s=Proj4js.common.adjust_lon(s/this.ns0+this.long0),e.x=s,e.y=i,e},phi1z:function(e,t){var i,s,n,r,a=Proj4js.common.asinz(.5*t);if(e<Proj4js.common.EPSLN)return a;for(var o=e*e,l=1;25>=l;l++)if(i=Math.sin(a),s=Math.cos(a),n=e*i,r=1-n*n,i=.5*r*r/s*(t/(1-o)-i/r+.5/e*Math.log((1-n)/(1+n))),a+=i,1e-7>=Math.abs(i))return a;return Proj4js.reportError("aea:phi1z:Convergence error"),null}},Proj4js.Proj.sterea={dependsOn:"gauss",init:function(){Proj4js.Proj.gauss.init.apply(this),this.rc?(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative")):Proj4js.reportError("sterea:init:E_ERROR_0")},forward:function(e){var t,i,s,n;return e.x=Proj4js.common.adjust_lon(e.x-this.long0),Proj4js.Proj.gauss.forward.apply(this,[e]),t=Math.sin(e.y),i=Math.cos(e.y),s=Math.cos(e.x),n=this.k0*this.R2/(1+this.sinc0*t+this.cosc0*i*s),e.x=n*i*Math.sin(e.x),e.y=n*(this.cosc0*t-this.sinc0*i*s),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e},inverse:function(e){var t,i,s,n;return e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,(n=Math.sqrt(e.x*e.x+e.y*e.y))?(s=2*Math.atan2(n,this.R2),t=Math.sin(s),i=Math.cos(s),s=Math.asin(i*this.sinc0+e.y*t*this.cosc0/n),t=Math.atan2(e.x*t,n*this.cosc0*i-e.y*this.sinc0*t)):(s=this.phic0,t=0),e.x=t,e.y=s,Proj4js.Proj.gauss.inverse.apply(this,[e]),e.x=Proj4js.common.adjust_lon(e.x+this.long0),e}},Proj4js.Proj.poly={init:function(){0==this.lat0&&(this.lat0=90),this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Proj4js.common.e0fn(this.es),this.e1=Proj4js.common.e1fn(this.es),this.e2=Proj4js.common.e2fn(this.es),this.e3=Proj4js.common.e3fn(this.es),this.ml0=Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(e){var t,i,s,n,r;return s=e.y,i=Proj4js.common.adjust_lon(e.x-this.long0),1e-7>=Math.abs(s)?(r=this.x0+this.a*i,t=this.y0-this.a*this.ml0):(t=Math.sin(s),i=Math.cos(s),s=Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,s),n=Proj4js.common.msfnz(this.e,t,i),i=t,r=this.x0+this.a*n*Math.sin(i)/t,t=this.y0+this.a*(s-this.ml0+n*(1-Math.cos(i))/t)),e.x=r,e.y=t,e},inverse:function(e){var t,i;if(e.x-=this.x0,e.y-=this.y0,t=this.ml0+e.y/this.a,1e-7>=Math.abs(t))t=e.x/this.a+this.long0,i=0;else{if(t=t*t+e.x/this.a*(e.x/this.a),t=phi4z(this.es,this.e0,this.e1,this.e2,this.e3,this.al,t,void 0,i),1!=t)return t;t=Proj4js.common.adjust_lon(Proj4js.common.asinz(0/0*e.x/this.a)/Math.sin(i)+this.long0)}return e.x=t,e.y=i,e}},Proj4js.Proj.equi={init:function(){this.x0||(this.x0=0),this.y0||(this.y0=0),this.lat0||(this.lat0=0),this.long0||(this.long0=0)},forward:function(e){var t=e.y,i=this.x0+this.a*Proj4js.common.adjust_lon(e.x-this.long0)*Math.cos(this.lat0),t=this.y0+this.a*t;return this.t1=i,this.t2=Math.cos(this.lat0),e.x=i,e.y=t,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t=e.y/this.a;Math.abs(t)>Proj4js.common.HALF_PI&&Proj4js.reportError("equi:Inv:DataError");var i=Proj4js.common.adjust_lon(this.long0+e.x/(this.a*Math.cos(this.lat0)));e.x=i,e.y=t}},Proj4js.Proj.merc={init:function(){this.lat_ts&&(this.k0=this.sphere?Math.cos(this.lat_ts):Proj4js.common.msfnz(this.es,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(e){var t=e.x,i=e.y;if(90<i*Proj4js.common.R2D&&-90>i*Proj4js.common.R2D&&180<t*Proj4js.common.R2D&&-180>t*Proj4js.common.R2D)return Proj4js.reportError("merc:forward: llInputOutOfRange: "+t+" : "+i),null;if(Math.abs(Math.abs(i)-Proj4js.common.HALF_PI)<=Proj4js.common.EPSLN)return Proj4js.reportError("merc:forward: ll2mAtPoles"),null;if(this.sphere)t=this.x0+this.a*this.k0*Proj4js.common.adjust_lon(t-this.long0),i=this.y0+this.a*this.k0*Math.log(Math.tan(Proj4js.common.FORTPI+.5*i));else var s=Math.sin(i),i=Proj4js.common.tsfnz(this.e,i,s),t=this.x0+this.a*this.k0*Proj4js.common.adjust_lon(t-this.long0),i=this.y0-this.a*this.k0*Math.log(i);return e.x=t,e.y=i,e},inverse:function(e){var t=e.x-this.x0,i=e.y-this.y0;if(this.sphere)i=Proj4js.common.HALF_PI-2*Math.atan(Math.exp(-i/this.a*this.k0));else if(i=Math.exp(-i/(this.a*this.k0)),i=Proj4js.common.phi2z(this.e,i),-9999==i)return Proj4js.reportError("merc:inverse: lat = -9999"),null;return t=Proj4js.common.adjust_lon(this.long0+t/(this.a*this.k0)),e.x=t,e.y=i,e}},Proj4js.Proj.utm={dependsOn:"tmerc",init:function(){this.zone?(this.lat0=0,this.long0=(6*Math.abs(this.zone)-183)*Proj4js.common.D2R,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,Proj4js.Proj.tmerc.init.apply(this),this.forward=Proj4js.Proj.tmerc.forward,this.inverse=Proj4js.Proj.tmerc.inverse):Proj4js.reportError("utm:init: zone must be specified for UTM")}},Proj4js.Proj.eqdc={init:function(){this.mode||(this.mode=0),this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Proj4js.common.e0fn(this.es),this.e1=Proj4js.common.e1fn(this.es),this.e2=Proj4js.common.e2fn(this.es),this.e3=Proj4js.common.e3fn(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=Proj4js.common.msfnz(this.e,this.sinphi,this.cosphi),this.ml1=Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat1),0!=this.mode?(Math.abs(this.lat1+this.lat2)<Proj4js.common.EPSLN&&Proj4js.reportError("eqdc:Init:EqualLatitudes"),this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=Proj4js.common.msfnz(this.e,this.sinphi,this.cosphi),this.ml2=Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=Math.abs(this.lat1-this.lat2)>=Proj4js.common.EPSLN?(this.ms1-this.ms2)/(this.ml2-this.ml1):this.sinphi):this.ns=this.sinphi,this.g=this.ml1+this.ms1/this.ns,this.ml0=Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0)},forward:function(e){var t=e.x,i=this.a*(this.g-Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,e.y)),s=this.ns*Proj4js.common.adjust_lon(t-this.long0),t=this.x0+i*Math.sin(s),i=this.y0+this.rh-i*Math.cos(s);return e.x=t,e.y=i,e},inverse:function(e){e.x-=this.x0,e.y=this.rh-e.y+this.y0;var t,i;0<=this.ns?(i=Math.sqrt(e.x*e.x+e.y*e.y),t=1):(i=-Math.sqrt(e.x*e.x+e.y*e.y),t=-1);var s=0;return 0!=i&&(s=Math.atan2(t*e.x,t*e.y)),t=this.phi3z(this.g-i/this.a,this.e0,this.e1,this.e2,this.e3),s=Proj4js.common.adjust_lon(this.long0+s/this.ns),e.x=s,e.y=t,e},phi3z:function(e,t,i,s,n){var r,a;r=e;for(var o=0;15>o;o++)if(a=(e+i*Math.sin(2*r)-s*Math.sin(4*r)+n*Math.sin(6*r))/t-r,r+=a,1e-10>=Math.abs(a))return r;return Proj4js.reportError("PHI3Z-CONV:Latitude failed to converge after 15 iterations"),null}},Proj4js.Proj.tmerc={init:function(){this.e0=Proj4js.common.e0fn(this.es),this.e1=Proj4js.common.e1fn(this.es),this.e2=Proj4js.common.e2fn(this.es),this.e3=Proj4js.common.e3fn(this.es),this.ml0=this.a*Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(e){var t,i,s=e.y,n=Proj4js.common.adjust_lon(e.x-this.long0);t=Math.sin(s);var r=Math.cos(s);if(this.sphere){var a=r*Math.sin(n);if(1e-10>Math.abs(Math.abs(a)-1))return Proj4js.reportError("tmerc:forward: Point projects into infinity"),93;i=.5*this.a*this.k0*Math.log((1+a)/(1-a)),t=Math.acos(r*Math.cos(n)/Math.sqrt(1-a*a)),0>s&&(t=-t),s=this.a*this.k0*(t-this.lat0)}else{i=r*n;var n=Math.pow(i,2),r=this.ep2*Math.pow(r,2),a=Math.tan(s),o=Math.pow(a,2);t=1-this.es*Math.pow(t,2),t=this.a/Math.sqrt(t),s=this.a*Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,s),i=this.k0*t*i*(1+n/6*(1-o+r+n/20*(5-18*o+Math.pow(o,2)+72*r-58*this.ep2)))+this.x0,s=this.k0*(s-this.ml0+t*a*n*(.5+n/24*(5-o+9*r+4*Math.pow(r,2)+n/30*(61-58*o+Math.pow(o,2)+600*r-330*this.ep2))))+this.y0
}return e.x=i,e.y=s,e},inverse:function(e){var t,i,s,n;if(this.sphere){i=Math.exp(e.x/(this.a*this.k0));var r=.5*(i-1/i);s=this.lat0+e.y/(this.a*this.k0),n=Math.cos(s),t=Math.sqrt((1-n*n)/(1+r*r)),i=Proj4js.common.asinz(t),0>s&&(i=-i),t=0==r&&0==n?this.long0:Proj4js.common.adjust_lon(Math.atan2(r,n)+this.long0)}else{var r=e.x-this.x0,a=e.y-this.y0;for(i=t=(this.ml0+a/this.k0)/this.a,n=0;s=(t+this.e1*Math.sin(2*i)-this.e2*Math.sin(4*i)+this.e3*Math.sin(6*i))/this.e0-i,i+=s,!(Math.abs(s)<=Proj4js.common.EPSLN);n++)if(n>=6)return Proj4js.reportError("tmerc:inverse: Latitude failed to converge"),95;if(Math.abs(i)<Proj4js.common.HALF_PI){t=Math.sin(i),s=Math.cos(i);var o=Math.tan(i);n=this.ep2*Math.pow(s,2);var a=Math.pow(n,2),l=Math.pow(o,2),h=Math.pow(l,2);t=1-this.es*Math.pow(t,2);var u=this.a/Math.sqrt(t);t=u*(1-this.es)/t;var r=r/(u*this.k0),c=Math.pow(r,2);i-=u*o*c/t*(.5-c/24*(5+3*l+10*n-4*a-9*this.ep2-c/30*(61+90*l+298*n+45*h-252*this.ep2-3*a))),t=Proj4js.common.adjust_lon(this.long0+r*(1-c/6*(1+2*l+n-c/20*(5-2*n+28*l-3*a+8*this.ep2+24*h)))/s)}else i=Proj4js.common.HALF_PI*Proj4js.common.sign(a),t=this.long0}return e.x=t,e.y=i,e}},Proj4js.defs.GOOGLE="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs",Proj4js.defs["EPSG:900913"]=Proj4js.defs.GOOGLE,Proj4js.Proj.gstmerc={init:function(){var e=this.b/this.a;this.e=Math.sqrt(1-e*e),this.lc=this.long0,this.rs=Math.sqrt(1+this.e*this.e*Math.pow(Math.cos(this.lat0),4)/(1-this.e*this.e));var e=Math.sin(this.lat0),t=Math.asin(e/this.rs),i=Math.sin(t);this.cp=Proj4js.common.latiso(0,t,i)-this.rs*Proj4js.common.latiso(this.e,this.lat0,e),this.n2=this.k0*this.a*Math.sqrt(1-this.e*this.e)/(1-this.e*this.e*e*e),this.xs=this.x0,this.ys=this.y0-this.n2*t,this.title||(this.title="Gauss Schreiber transverse mercator")},forward:function(e){var t=e.y,i=this.rs*(e.x-this.lc),t=this.cp+this.rs*Proj4js.common.latiso(this.e,t,Math.sin(t)),s=Math.asin(Math.sin(i)/Proj4js.common.cosh(t)),s=Proj4js.common.latiso(0,s,Math.sin(s));return e.x=this.xs+this.n2*s,e.y=this.ys+this.n2*Math.atan(Proj4js.common.sinh(t)/Math.cos(i)),e},inverse:function(e){var t=e.x,i=e.y,s=Math.atan(Proj4js.common.sinh((t-this.xs)/this.n2)/Math.cos((i-this.ys)/this.n2)),t=Math.asin(Math.sin((i-this.ys)/this.n2)/Proj4js.common.cosh((t-this.xs)/this.n2)),t=Proj4js.common.latiso(0,t,Math.sin(t));return e.x=this.lc+s/this.rs,e.y=Proj4js.common.invlatiso(this.e,(t-this.cp)/this.rs),e}},Proj4js.Proj.ortho={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(e){var t,i,s,n,r;if(i=e.y,s=Proj4js.common.adjust_lon(e.x-this.long0),t=Math.sin(i),i=Math.cos(i),n=Math.cos(s),r=this.sin_p14*t+this.cos_p14*i*n,r>0||Math.abs(r)<=Proj4js.common.EPSLN)var a=1*this.a*i*Math.sin(s),o=this.y0+1*this.a*(this.cos_p14*t-this.sin_p14*i*n);else Proj4js.reportError("orthoFwdPointError");return e.x=a,e.y=o,e},inverse:function(e){var t,i,s,n;return e.x-=this.x0,e.y-=this.y0,t=Math.sqrt(e.x*e.x+e.y*e.y),t>this.a+1e-7&&Proj4js.reportError("orthoInvDataError"),i=Proj4js.common.asinz(t/this.a),s=Math.sin(i),n=Math.cos(i),i=this.long0,Math.abs(t),s=Proj4js.common.asinz(n*this.sin_p14+e.y*s*this.cos_p14/t),t=Math.abs(this.lat0)-Proj4js.common.HALF_PI,Math.abs(t)<=Proj4js.common.EPSLN&&(i=0<=this.lat0?Proj4js.common.adjust_lon(this.long0+Math.atan2(e.x,-e.y)):Proj4js.common.adjust_lon(this.long0-Math.atan2(-e.x,e.y))),Math.sin(s),e.x=i,e.y=s,e}},Proj4js.Proj.krovak={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(e){var t,i,s;return i=e.y,s=Proj4js.common.adjust_lon(e.x-this.long0),t=Math.pow((1+this.e*Math.sin(i))/(1-this.e*Math.sin(i)),this.alfa*this.e/2),t=2*(Math.atan(this.k*Math.pow(Math.tan(i/2+this.s45),this.alfa)/t)-this.s45),i=-s*this.alfa,s=Math.asin(Math.cos(this.ad)*Math.sin(t)+Math.sin(this.ad)*Math.cos(t)*Math.cos(i)),t=this.n*Math.asin(Math.cos(t)*Math.sin(i)/Math.cos(s)),s=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(s/2+this.s45),this.n),e.y=s*Math.cos(t)/1,e.x=s*Math.sin(t)/1,this.czech&&(e.y*=-1,e.x*=-1),e},inverse:function(e){var t,i,s;t=e.x,e.x=e.y,e.y=t,this.czech&&(e.y*=-1,e.x*=-1),t=Math.sqrt(e.x*e.x+e.y*e.y),i=Math.atan2(e.y,e.x)/Math.sin(this.s0),s=2*(Math.atan(Math.pow(this.ro0/t,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),t=Math.asin(Math.cos(this.ad)*Math.sin(s)-Math.sin(this.ad)*Math.cos(s)*Math.cos(i)),i=Math.asin(Math.cos(s)*Math.sin(i)/Math.cos(t)),e.x=this.long0-i/this.alfa,i=t;var n=s=0;do e.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(t/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(i))/(1-this.e*Math.sin(i)),this.e/2))-this.s45),1e-10>Math.abs(i-e.y)&&(s=1),i=e.y,n+=1;while(0==s&&15>n);return n>=15?(Proj4js.reportError("PHI3Z-CONV:Latitude failed to converge after 15 iterations"),null):e}},Proj4js.Proj.somerc={init:function(){var e=this.lat0;this.lambda0=this.long0;var t=Math.sin(e),i=this.a,s=1/this.rf,s=2*s-Math.pow(s,2),n=this.e=Math.sqrt(s);this.R=this.k0*i*Math.sqrt(1-s)/(1-s*Math.pow(t,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(e),4)),this.b0=Math.asin(t/this.alpha),this.K=Math.log(Math.tan(Math.PI/4+this.b0/2))-this.alpha*Math.log(Math.tan(Math.PI/4+e/2))+this.alpha*n/2*Math.log((1+n*t)/(1-n*t))},forward:function(e){var t=Math.log(Math.tan(Math.PI/4-e.y/2)),i=this.e/2*Math.log((1+this.e*Math.sin(e.y))/(1-this.e*Math.sin(e.y))),i=2*(Math.atan(Math.exp(-this.alpha*(t+i)+this.K))-Math.PI/4),s=this.alpha*(e.x-this.lambda0),t=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(s))),i=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(s));return e.y=this.R/2*Math.log((1+Math.sin(i))/(1-Math.sin(i)))+this.y0,e.x=this.R*t+this.x0,e},inverse:function(e){for(var t=(e.x-this.x0)/this.R,i=2*(Math.atan(Math.exp((e.y-this.y0)/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(t)),t=this.lambda0+Math.atan(Math.sin(t)/(Math.cos(this.b0)*Math.cos(t)-Math.sin(this.b0)*Math.tan(i)))/this.alpha,i=0,n=s,r=-1e3,a=0;1e-7<Math.abs(n-r);){if(20<++a)return Proj4js.reportError("omercFwdInfinity"),void 0;i=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(n))/2)),r=n,n=2*Math.atan(Math.exp(i))-Math.PI/2}return e.x=t,e.y=n,e}},Proj4js.Proj.stere={ssfn_:function(e,t,i){return t*=i,Math.tan(.5*(Proj4js.common.HALF_PI+e))*Math.pow((1-t)/(1+t),.5*i)},TOL:1e-8,NITER:8,CONV:1e-10,S_POLE:0,N_POLE:1,OBLIQ:2,EQUIT:3,init:function(){this.phits=this.lat_ts?this.lat_ts:Proj4js.common.HALF_PI;var e=Math.abs(this.lat0);if(this.mode=Math.abs(e)-Proj4js.common.HALF_PI<Proj4js.common.EPSLN?0>this.lat0?this.S_POLE:this.N_POLE:e>Proj4js.common.EPSLN?this.OBLIQ:this.EQUIT,this.phits=Math.abs(this.phits),this.es){var t;switch(this.mode){case this.N_POLE:case this.S_POLE:Math.abs(this.phits-Proj4js.common.HALF_PI)<Proj4js.common.EPSLN?this.akm1=2*this.k0/Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)):(e=Math.sin(this.phits),this.akm1=Math.cos(this.phits)/Proj4js.common.tsfnz(this.e,this.phits,e),e*=this.e,this.akm1/=Math.sqrt(1-e*e));break;case this.EQUIT:this.akm1=2*this.k0;break;case this.OBLIQ:e=Math.sin(this.lat0),t=2*Math.atan(this.ssfn_(this.lat0,e,this.e))-Proj4js.common.HALF_PI,e*=this.e,this.akm1=2*this.k0*Math.cos(this.lat0)/Math.sqrt(1-e*e),this.sinX1=Math.sin(t),this.cosX1=Math.cos(t)}}else switch(this.mode){case this.OBLIQ:this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0);case this.EQUIT:this.akm1=2*this.k0;break;case this.S_POLE:case this.N_POLE:this.akm1=Math.abs(this.phits-Proj4js.common.HALF_PI)>=Proj4js.common.EPSLN?Math.cos(this.phits)/Math.tan(Proj4js.common.FORTPI-.5*this.phits):2*this.k0}},forward:function(e){var t,i,s=e.x,s=Proj4js.common.adjust_lon(s-this.long0),n=e.y;if(this.sphere){var r,a,o;switch(r=Math.sin(n),a=Math.cos(n),o=Math.cos(s),s=Math.sin(s),this.mode){case this.EQUIT:i=1+a*o,i<=Proj4js.common.EPSLN&&Proj4js.reportError("stere:forward:Equit"),i=this.akm1/i,t=i*a*s,i*=r;break;case this.OBLIQ:i=1+this.sinph0*r+this.cosph0*a*o,i<=Proj4js.common.EPSLN&&Proj4js.reportError("stere:forward:Obliq"),i=this.akm1/i,t=i*a*s,i*=this.cosph0*r-this.sinph0*a*o;break;case this.N_POLE:o=-o,n=-n;case this.S_POLE:Math.abs(n-Proj4js.common.HALF_PI)<this.TOL&&Proj4js.reportError("stere:forward:S_POLE"),i=this.akm1*Math.tan(Proj4js.common.FORTPI+.5*n),t=s*i,i*=o}}else{o=Math.cos(s),s=Math.sin(s),r=Math.sin(n);var l;switch((this.mode==this.OBLIQ||this.mode==this.EQUIT)&&(l=2*Math.atan(this.ssfn_(n,r,this.e)),a=Math.sin(l-Proj4js.common.HALF_PI),l=Math.cos(l)),this.mode){case this.OBLIQ:n=this.akm1/(this.cosX1*(1+this.sinX1*a+this.cosX1*l*o)),i=n*(this.cosX1*a-this.sinX1*l*o),t=n*l;break;case this.EQUIT:n=2*this.akm1/(1+l*o),i=n*a,t=n*l;break;case this.S_POLE:n=-n,o=-o,r=-r;case this.N_POLE:t=this.akm1*Proj4js.common.tsfnz(this.e,n,r),i=-t*o}t*=s}return e.x=t*this.a+this.x0,e.y=i*this.a+this.y0,e},inverse:function(e){var t,i,s,n,r=(e.x-this.x0)/this.a,a=(e.y-this.y0)/this.a,o=t=0,l=s=0;if(this.sphere){switch(o=Math.sqrt(r*r+a*a),l=2*Math.atan(o/this.akm1),s=Math.sin(l),l=Math.cos(l),t=0,this.mode){case this.EQUIT:i=Math.abs(o)<=Proj4js.common.EPSLN?0:Math.asin(a*s/o),(0!=l||0!=r)&&(t=Math.atan2(r*s,l*o));break;case this.OBLIQ:i=Math.abs(o)<=Proj4js.common.EPSLN?this.phi0:Math.asin(l*this.sinph0+a*s*this.cosph0/o),l-=this.sinph0*Math.sin(i),(0!=l||0!=r)&&(t=Math.atan2(r*s*this.cosph0,l*o));break;case this.N_POLE:a=-a;case this.S_POLE:i=Math.abs(o)<=Proj4js.common.EPSLN?this.phi0:Math.asin(this.mode==this.S_POLE?-l:l),t=0==r&&0==a?0:Math.atan2(r,a)}e.x=Proj4js.common.adjust_lon(t+this.long0),e.y=i}else{switch(n=Math.sqrt(r*r+a*a),this.mode){case this.OBLIQ:case this.EQUIT:t=2*Math.atan2(n*this.cosX1,this.akm1),s=Math.cos(t),i=Math.sin(t),o=0==n?Math.asin(s*this.sinX1):Math.asin(s*this.sinX1+a*i*this.cosX1/n),t=Math.tan(.5*(Proj4js.common.HALF_PI+o)),r*=i,a=n*this.cosX1*s-a*this.sinX1*i,l=Proj4js.common.HALF_PI,s=.5*this.e;break;case this.N_POLE:a=-a;case this.S_POLE:t=-n/this.akm1,o=Proj4js.common.HALF_PI-2*Math.atan(t),l=-Proj4js.common.HALF_PI,s=-.5*this.e}for(n=this.NITER;n--;o=i)if(i=this.e*Math.sin(o),i=2*Math.atan(t*Math.pow((1+i)/(1-i),s))-l,Math.abs(o-i)<this.CONV)return this.mode==this.S_POLE&&(i=-i),t=0==r&&0==a?0:Math.atan2(r,a),e.x=Proj4js.common.adjust_lon(t+this.long0),e.y=i,e}}},Proj4js.Proj.nzmg={iterations:1,init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(e){for(var t=1e-5*((e.y-this.lat0)/Proj4js.common.SEC_TO_RAD),i=e.x-this.long0,s=1,n=0,r=1;10>=r;r++)s*=t,n+=this.A[r]*s;for(var t=n,s=1,a=0,o=0,l=0,r=1;6>=r;r++)n=s*t-a*i,a=a*t+s*i,s=n,o=o+this.B_re[r]*s-this.B_im[r]*a,l=l+this.B_im[r]*s+this.B_re[r]*a;return e.x=l*this.a+this.x0,e.y=o*this.a+this.y0,e},inverse:function(e){for(var t,i=(e.y-this.y0)/this.a,s=(e.x-this.x0)/this.a,n=1,r=0,a=0,o=0,l=1;6>=l;l++)t=n*i-r*s,r=r*i+n*s,n=t,a=a+this.C_re[l]*n-this.C_im[l]*r,o=o+this.C_im[l]*n+this.C_re[l]*r;for(n=0;n<this.iterations;n++){var h,u=a,c=o;for(t=i,r=s,l=2;6>=l;l++)h=u*a-c*o,c=c*a+u*o,u=h,t+=(l-1)*(this.B_re[l]*u-this.B_im[l]*c),r+=(l-1)*(this.B_im[l]*u+this.B_re[l]*c);for(var u=1,c=0,d=this.B_re[1],p=this.B_im[1],l=2;6>=l;l++)h=u*a-c*o,c=c*a+u*o,u=h,d+=l*(this.B_re[l]*u-this.B_im[l]*c),p+=l*(this.B_im[l]*u+this.B_re[l]*c);o=d*d+p*p,a=(t*d+r*p)/o,o=(r*d-t*p)/o}for(i=a,s=1,a=0,l=1;9>=l;l++)s*=i,a+=this.D[l]*s;return l=this.lat0+1e5*a*Proj4js.common.SEC_TO_RAD,e.x=this.long0+o,e.y=l,e}},Proj4js.Proj.mill={init:function(){},forward:function(e){var t=e.y,i=this.x0+this.a*Proj4js.common.adjust_lon(e.x-this.long0),t=this.y0+1.25*this.a*Math.log(Math.tan(Proj4js.common.PI/4+t/2.5));return e.x=i,e.y=t,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t=Proj4js.common.adjust_lon(this.long0+e.x/this.a),i=2.5*(Math.atan(Math.exp(.8*e.y/this.a))-Proj4js.common.PI/4);return e.x=t,e.y=i,e}},Proj4js.Proj.gnom={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(e){var t,i,s,n,r;return i=e.y,s=Proj4js.common.adjust_lon(e.x-this.long0),t=Math.sin(i),i=Math.cos(i),n=Math.cos(s),r=this.sin_p14*t+this.cos_p14*i*n,r>0||Math.abs(r)<=Proj4js.common.EPSLN?(s=this.x0+1*this.a*i*Math.sin(s)/r,t=this.y0+1*this.a*(this.cos_p14*t-this.sin_p14*i*n)/r):(Proj4js.reportError("orthoFwdPointError"),s=this.x0+this.infinity_dist*i*Math.sin(s),t=this.y0+this.infinity_dist*(this.cos_p14*t-this.sin_p14*i*n)),e.x=s,e.y=t,e},inverse:function(e){var t,i,s,n;return e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,(t=Math.sqrt(e.x*e.x+e.y*e.y))?(n=Math.atan2(t,this.rc),i=Math.sin(n),s=Math.cos(n),n=Proj4js.common.asinz(s*this.sin_p14+e.y*i*this.cos_p14/t),t=Math.atan2(e.x*i,t*this.cos_p14*s-e.y*this.sin_p14*i),t=Proj4js.common.adjust_lon(this.long0+t)):(n=this.phic0,t=0),e.x=t,e.y=n,e}},Proj4js.Proj.sinu={init:function(){this.sphere?(this.n=1,this.es=this.m=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=Proj4js.common.pj_enfn(this.es)},forward:function(e){var t,i;if(t=e.x,i=e.y,t=Proj4js.common.adjust_lon(t-this.long0),this.sphere){if(this.m)for(var s=this.n*Math.sin(i),n=Proj4js.common.MAX_ITER;n;--n){var r=(this.m*i+Math.sin(i)-s)/(this.m+Math.cos(i));if(i-=r,Math.abs(r)<Proj4js.common.EPSLN)break}else i=1!=this.n?Math.asin(this.n*Math.sin(i)):i;t=this.a*this.C_x*t*(this.m+Math.cos(i)),i*=this.a*this.C_y}else s=Math.sin(i),n=Math.cos(i),i=this.a*Proj4js.common.pj_mlfn(i,s,n,this.en),t=this.a*t*n/Math.sqrt(1-this.es*s*s);return e.x=t,e.y=i,e},inverse:function(e){var t,i;if(e.x-=this.x0,e.y-=this.y0,this.sphere)e.y/=this.C_y,t=this.m?Math.asin((this.m*e.y+Math.sin(e.y))/this.n):1!=this.n?Math.asin(Math.sin(e.y)/this.n):e.y,i=e.x/(this.C_x*(this.m+Math.cos(e.y)));else{t=Proj4js.common.pj_inv_mlfn(e.y/this.a,this.es,this.en);var s=Math.abs(t);s<Proj4js.common.HALF_PI?(s=Math.sin(t),i=this.long0+e.x*Math.sqrt(1-this.es*s*s)/(this.a*Math.cos(t)),i=Proj4js.common.adjust_lon(i)):s-Proj4js.common.EPSLN<Proj4js.common.HALF_PI&&(i=this.long0)}return e.x=i,e.y=t,e}},Proj4js.Proj.vandg={init:function(){this.R=6370997},forward:function(e){var t=e.y,i=Proj4js.common.adjust_lon(e.x-this.long0);Math.abs(t);var s=Proj4js.common.asinz(2*Math.abs(t/Proj4js.common.PI));(Math.abs(i)<=Proj4js.common.EPSLN||Math.abs(Math.abs(t)-Proj4js.common.HALF_PI)<=Proj4js.common.EPSLN)&&Math.tan(.5*s);var n=.5*Math.abs(Proj4js.common.PI/i-i/Proj4js.common.PI),r=n*n,a=Math.sin(s),s=Math.cos(s),s=s/(a+s-1),a=s*(2/a-1),a=a*a,r=Proj4js.common.PI*this.R*(n*(s-a)+Math.sqrt(r*(s-a)*(s-a)-(a+r)*(s*s-a)))/(a+r);return 0>i&&(r=-r),i=this.x0+r,r=Math.abs(r/(Proj4js.common.PI*this.R)),t=t>=0?this.y0+Proj4js.common.PI*this.R*Math.sqrt(1-r*r-2*n*r):this.y0-Proj4js.common.PI*this.R*Math.sqrt(1-r*r-2*n*r),e.x=i,e.y=t,e},inverse:function(e){var t,i,s,n,r,a,o,l;return e.x-=this.x0,e.y-=this.y0,l=Proj4js.common.PI*this.R,t=e.x/l,s=e.y/l,n=t*t+s*s,r=-Math.abs(s)*(1+n),i=r-2*s*s+t*t,a=-2*r+1+2*s*s+n*n,l=s*s/a+(2*i*i*i/a/a/a-9*r*i/a/a)/27,o=(r-i*i/3/a)/a,r=2*Math.sqrt(-o/3),l=3*l/o/r,1<Math.abs(l)&&(l=l>=0?1:-1),l=Math.acos(l)/3,i=0<=e.y?(-r*Math.cos(l+Proj4js.common.PI/3)-i/3/a)*Proj4js.common.PI:-(-r*Math.cos(l+Proj4js.common.PI/3)-i/3/a)*Proj4js.common.PI,Math.abs(t),t=Proj4js.common.adjust_lon(this.long0+Proj4js.common.PI*(n-1+Math.sqrt(1+2*(t*t-s*s)+n*n))/2/t),e.x=t,e.y=i,e}},Proj4js.Proj.cea={init:function(){},forward:function(e){var t=e.y,i=this.x0+this.a*Proj4js.common.adjust_lon(e.x-this.long0)*Math.cos(this.lat_ts),t=this.y0+this.a*Math.sin(t)/Math.cos(this.lat_ts);return e.x=i,e.y=t,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t=Proj4js.common.adjust_lon(this.long0+e.x/this.a/Math.cos(this.lat_ts)),i=Math.asin(e.y/this.a*Math.cos(this.lat_ts));return e.x=t,e.y=i,e}},Proj4js.Proj.eqc={init:function(){this.x0||(this.x0=0),this.y0||(this.y0=0),this.lat0||(this.lat0=0),this.long0||(this.long0=0),this.lat_ts||(this.lat_ts=0),this.title||(this.title="Equidistant Cylindrical (Plate Carre)"),this.rc=Math.cos(this.lat_ts)},forward:function(e){var t=e.y,i=Proj4js.common.adjust_lon(e.x-this.long0),t=Proj4js.common.adjust_lat(t-this.lat0);return e.x=this.x0+this.a*i*this.rc,e.y=this.y0+this.a*t,e},inverse:function(e){var t=e.y;return e.x=Proj4js.common.adjust_lon(this.long0+(e.x-this.x0)/(this.a*this.rc)),e.y=Proj4js.common.adjust_lat(this.lat0+(t-this.y0)/this.a),e}},Proj4js.Proj.cass={init:function(){this.sphere||(this.en=Proj4js.common.pj_enfn(this.es),this.m0=Proj4js.common.pj_mlfn(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},C1:.16666666666666666,C2:.008333333333333333,C3:.041666666666666664,C4:.3333333333333333,C5:.06666666666666667,forward:function(e){var t,i,s=e.x,n=e.y,s=Proj4js.common.adjust_lon(s-this.long0);return this.sphere?(t=Math.asin(Math.cos(n)*Math.sin(s)),i=Math.atan2(Math.tan(n),Math.cos(s))-this.phi0):(this.n=Math.sin(n),this.c=Math.cos(n),i=Proj4js.common.pj_mlfn(n,this.n,this.c,this.en),this.n=1/Math.sqrt(1-this.es*this.n*this.n),this.tn=Math.tan(n),this.t=this.tn*this.tn,this.a1=s*this.c,this.c*=this.es*this.c/(1-this.es),this.a2=this.a1*this.a1,t=this.n*this.a1*(1-this.a2*this.t*(this.C1-(8-this.t+8*this.c)*this.a2*this.C2)),i-=this.m0-this.n*this.tn*this.a2*(.5+(5-this.t+6*this.c)*this.a2*this.C3)),e.x=this.a*t+this.x0,e.y=this.a*i+this.y0,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t=e.x/this.a,i=e.y/this.a;if(this.sphere)this.dd=i+this.lat0,i=Math.asin(Math.sin(this.dd)*Math.cos(t)),t=Math.atan2(Math.tan(t),Math.cos(this.dd));else{var s=Proj4js.common.pj_inv_mlfn(this.m0+i,this.es,this.en);this.tn=Math.tan(s),this.t=this.tn*this.tn,this.n=Math.sin(s),this.r=1/(1-this.es*this.n*this.n),this.n=Math.sqrt(this.r),this.r*=(1-this.es)*this.n,this.dd=t/this.n,this.d2=this.dd*this.dd,i=s-this.n*this.tn/this.r*this.d2*(.5-(1+3*this.t)*this.d2*this.C3),t=this.dd*(1+this.t*this.d2*(-this.C4+(1+3*this.t)*this.d2*this.C5))/Math.cos(s)}return e.x=Proj4js.common.adjust_lon(this.long0+t),e.y=i,e}},Proj4js.Proj.gauss={init:function(){var e=Math.sin(this.lat0),t=Math.cos(this.lat0),t=t*t;this.rc=Math.sqrt(1-this.es)/(1-this.es*e*e),this.C=Math.sqrt(1+this.es*t*t/(1-this.es)),this.phic0=Math.asin(e/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Proj4js.common.FORTPI)/(Math.pow(Math.tan(.5*this.lat0+Proj4js.common.FORTPI),this.C)*Proj4js.common.srat(this.e*e,this.ratexp))},forward:function(e){var t=e.x,i=e.y;return e.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*i+Proj4js.common.FORTPI),this.C)*Proj4js.common.srat(this.e*Math.sin(i),this.ratexp))-Proj4js.common.HALF_PI,e.x=this.C*t,e},inverse:function(e){for(var t=e.x/this.C,i=e.y,s=Math.pow(Math.tan(.5*i+Proj4js.common.FORTPI)/this.K,1/this.C),n=Proj4js.common.MAX_ITER;n>0&&(i=2*Math.atan(s*Proj4js.common.srat(this.e*Math.sin(e.y),-.5*this.e))-Proj4js.common.HALF_PI,!(1e-14>Math.abs(i-e.y)));--n)e.y=i;return n?(e.x=t,e.y=i,e):(Proj4js.reportError("gauss:inverse:convergence failed"),null)}},Proj4js.Proj.omerc={init:function(){this.mode||(this.mode=0),this.lon1||(this.lon1=0,this.mode=1),this.lon2||(this.lon2=0),this.lat2||(this.lat2=0);var e=1-Math.pow(this.b/this.a,2);Math.sqrt(e),this.sin_p20=Math.sin(this.lat0),this.cos_p20=Math.cos(this.lat0),this.con=1-this.es*this.sin_p20*this.sin_p20,this.com=Math.sqrt(1-e),this.bl=Math.sqrt(1+this.es*Math.pow(this.cos_p20,4)/(1-e)),this.al=this.a*this.bl*this.k0*this.com/this.con,Math.abs(this.lat0)<Proj4js.common.EPSLN?this.el=this.d=this.ts=1:(this.ts=Proj4js.common.tsfnz(this.e,this.lat0,this.sin_p20),this.con=Math.sqrt(this.con),this.d=this.bl*this.com/(this.cos_p20*this.con),this.f=0<this.d*this.d-1?0<=this.lat0?this.d+Math.sqrt(this.d*this.d-1):this.d-Math.sqrt(this.d*this.d-1):this.d,this.el=this.f*Math.pow(this.ts,this.bl)),0!=this.mode?(this.g=.5*(this.f-1/this.f),this.gama=Proj4js.common.asinz(Math.sin(this.alpha)/this.d),this.longc-=Proj4js.common.asinz(this.g*Math.tan(this.gama))/this.bl,this.con=Math.abs(this.lat0),this.con>Proj4js.common.EPSLN&&Math.abs(this.con-Proj4js.common.HALF_PI)>Proj4js.common.EPSLN?(this.singam=Math.sin(this.gama),this.cosgam=Math.cos(this.gama),this.sinaz=Math.sin(this.alpha),this.cosaz=Math.cos(this.alpha),this.u=0<=this.lat0?this.al/this.bl*Math.atan(Math.sqrt(this.d*this.d-1)/this.cosaz):-(this.al/this.bl)*Math.atan(Math.sqrt(this.d*this.d-1)/this.cosaz)):Proj4js.reportError("omerc:Init:DataError")):(this.sinphi=Math.sin(this.at1),this.ts1=Proj4js.common.tsfnz(this.e,this.lat1,this.sinphi),this.sinphi=Math.sin(this.lat2),this.ts2=Proj4js.common.tsfnz(this.e,this.lat2,this.sinphi),this.h=Math.pow(this.ts1,this.bl),this.l=Math.pow(this.ts2,this.bl),this.f=this.el/this.h,this.g=.5*(this.f-1/this.f),this.j=(this.el*this.el-this.l*this.h)/(this.el*this.el+this.l*this.h),this.p=(this.l-this.h)/(this.l+this.h),this.dlon=this.lon1-this.lon2,this.dlon<-Proj4js.common.PI&&(this.lon2-=2*Proj4js.common.PI),this.dlon>Proj4js.common.PI&&(this.lon2+=2*Proj4js.common.PI),this.dlon=this.lon1-this.lon2,this.longc=.5*(this.lon1+this.lon2)-Math.atan(this.j*Math.tan(.5*this.bl*this.dlon)/this.p)/this.bl,this.dlon=Proj4js.common.adjust_lon(this.lon1-this.longc),this.gama=Math.atan(Math.sin(this.bl*this.dlon)/this.g),this.alpha=Proj4js.common.asinz(this.d*Math.sin(this.gama)),Math.abs(this.lat1-this.lat2)<=Proj4js.common.EPSLN?Proj4js.reportError("omercInitDataError"):this.con=Math.abs(this.lat1),this.con<=Proj4js.common.EPSLN||Math.abs(this.con-Proj4js.common.HALF_PI)<=Proj4js.common.EPSLN?Proj4js.reportError("omercInitDataError"):Math.abs(Math.abs(this.lat0)-Proj4js.common.HALF_PI)<=Proj4js.common.EPSLN&&Proj4js.reportError("omercInitDataError"),this.singam=Math.sin(this.gam),this.cosgam=Math.cos(this.gam),this.sinaz=Math.sin(this.alpha),this.cosaz=Math.cos(this.alpha),this.u=0<=this.lat0?this.al/this.bl*Math.atan(Math.sqrt(this.d*this.d-1)/this.cosaz):-(this.al/this.bl)*Math.atan(Math.sqrt(this.d*this.d-1)/this.cosaz))},forward:function(e){var t,i,s,n,r;return s=e.x,i=e.y,t=Math.sin(i),n=Proj4js.common.adjust_lon(s-this.longc),s=Math.sin(this.bl*n),Math.abs(Math.abs(i)-Proj4js.common.HALF_PI)>Proj4js.common.EPSLN?(t=Proj4js.common.tsfnz(this.e,i,t),t=this.el/Math.pow(t,this.bl),r=.5*(t-1/t),t=(r*this.singam-s*this.cosgam)/(.5*(t+1/t)),i=Math.cos(this.bl*n),1e-7>Math.abs(i)?s=this.al*this.bl*n:(s=this.al*Math.atan((r*this.cosgam+s*this.singam)/i)/this.bl,0>i&&(s+=Proj4js.common.PI*this.al/this.bl))):(t=i>=0?this.singam:-this.singam,s=this.al*i/this.bl),Math.abs(Math.abs(t)-1)<=Proj4js.common.EPSLN&&Proj4js.reportError("omercFwdInfinity"),n=.5*this.al*Math.log((1-t)/(1+t))/this.bl,s-=this.u,t=this.y0+s*this.cosaz-n*this.sinaz,e.x=this.x0+n*this.cosaz+s*this.sinaz,e.y=t,e},inverse:function(e){var t,i,s,n;return e.x-=this.x0,e.y-=this.y0,t=e.x*this.cosaz-e.y*this.sinaz,s=e.y*this.cosaz+e.x*this.sinaz,s+=this.u,i=Math.exp(-this.bl*t/this.al),t=.5*(i-1/i),i=.5*(i+1/i),s=Math.sin(this.bl*s/this.al),n=(s*this.cosgam+t*this.singam)/i,Math.abs(Math.abs(n)-1)<=Proj4js.common.EPSLN?(t=this.longc,n=n>=0?Proj4js.common.HALF_PI:-Proj4js.common.HALF_PI):(i=1/this.bl,n=Math.pow(this.el/Math.sqrt((1+n)/(1-n)),i),n=Proj4js.common.phi2z(this.e,n),t=this.longc-Math.atan2(t*this.cosgam-s*this.singam,i)/this.bl,t=Proj4js.common.adjust_lon(t)),e.x=t,e.y=n,e}},Proj4js.Proj.lcc={init:function(){if(this.lat2||(this.lat2=this.lat0),this.k0||(this.k0=1),Math.abs(this.lat1+this.lat2)<Proj4js.common.EPSLN)Proj4js.reportError("lcc:init: Equal Latitudes");else{var e=this.b/this.a;this.e=Math.sqrt(1-e*e);var e=Math.sin(this.lat1),t=Math.cos(this.lat1),t=Proj4js.common.msfnz(this.e,e,t),i=Proj4js.common.tsfnz(this.e,this.lat1,e),s=Math.sin(this.lat2),n=Math.cos(this.lat2),n=Proj4js.common.msfnz(this.e,s,n),s=Proj4js.common.tsfnz(this.e,this.lat2,s),r=Proj4js.common.tsfnz(this.e,this.lat0,Math.sin(this.lat0));this.ns=Math.abs(this.lat1-this.lat2)>Proj4js.common.EPSLN?Math.log(t/n)/Math.log(i/s):e,this.f0=t/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(r,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(e){var t=e.x,i=e.y;if(!(90>=i&&i>=-90&&180>=t&&t>=-180))return Proj4js.reportError("lcc:forward: llInputOutOfRange: "+t+" : "+i),null;var s=Math.abs(Math.abs(i)-Proj4js.common.HALF_PI);if(s>Proj4js.common.EPSLN)i=Proj4js.common.tsfnz(this.e,i,Math.sin(i)),i=this.a*this.f0*Math.pow(i,this.ns);else{if(s=i*this.ns,0>=s)return Proj4js.reportError("lcc:forward: No Projection"),null;i=0}return t=this.ns*Proj4js.common.adjust_lon(t-this.long0),e.x=this.k0*i*Math.sin(t)+this.x0,e.y=this.k0*(this.rh-i*Math.cos(t))+this.y0,e},inverse:function(e){var t,i,s,n=(e.x-this.x0)/this.k0,r=this.rh-(e.y-this.y0)/this.k0;if(0<this.ns?(t=Math.sqrt(n*n+r*r),i=1):(t=-Math.sqrt(n*n+r*r),i=-1),s=0,0!=t&&(s=Math.atan2(i*n,i*r)),0!=t||0<this.ns){if(i=1/this.ns,t=Math.pow(t/(this.a*this.f0),i),t=Proj4js.common.phi2z(this.e,t),-9999==t)return null}else t=-Proj4js.common.HALF_PI;return s=Proj4js.common.adjust_lon(s/this.ns+this.long0),e.x=s,e.y=t,e}},Proj4js.Proj.laea={S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4,init:function(){var e=Math.abs(this.lat0);if(this.mode=Math.abs(e-Proj4js.common.HALF_PI)<Proj4js.common.EPSLN?0>this.lat0?this.S_POLE:this.N_POLE:Math.abs(e)<Proj4js.common.EPSLN?this.EQUIT:this.OBLIQ,0<this.es)switch(this.qp=Proj4js.common.qsfnz(this.e,1),this.mmf=.5/(1-this.es),this.apa=this.authset(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=Proj4js.common.qsfnz(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode==this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(e){var t,i,s=e.x,n=e.y,s=Proj4js.common.adjust_lon(s-this.long0);if(this.sphere){var r,a,o;switch(o=Math.sin(n),a=Math.cos(n),r=Math.cos(s),this.mode){case this.OBLIQ:case this.EQUIT:if(i=this.mode==this.EQUIT?1+a*r:1+this.sinph0*o+this.cosph0*a*r,i<=Proj4js.common.EPSLN)return Proj4js.reportError("laea:fwd:y less than eps"),null;i=Math.sqrt(2/i),t=i*a*Math.sin(s),i*=this.mode==this.EQUIT?o:this.cosph0*o-this.sinph0*a*r;break;case this.N_POLE:r=-r;case this.S_POLE:if(Math.abs(n+this.phi0)<Proj4js.common.EPSLN)return Proj4js.reportError("laea:fwd:phi < eps"),null;i=Proj4js.common.FORTPI-.5*n,i=2*(this.mode==this.S_POLE?Math.cos(i):Math.sin(i)),t=i*Math.sin(s),i*=r}}else{var l=a=0,h=0;switch(r=Math.cos(s),s=Math.sin(s),o=Math.sin(n),o=Proj4js.common.qsfnz(this.e,o),(this.mode==this.OBLIQ||this.mode==this.EQUIT)&&(a=o/this.qp,l=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:h=1+this.sinb1*a+this.cosb1*l*r;break;case this.EQUIT:h=1+l*r;break;case this.N_POLE:h=Proj4js.common.HALF_PI+n,o=this.qp-o;break;case this.S_POLE:h=n-Proj4js.common.HALF_PI,o=this.qp+o}if(Math.abs(h)<Proj4js.common.EPSLN)return Proj4js.reportError("laea:fwd:b < eps"),null;switch(this.mode){case this.OBLIQ:case this.EQUIT:h=Math.sqrt(2/h),i=this.mode==this.OBLIQ?this.ymf*h*(this.cosb1*a-this.sinb1*l*r):(h=Math.sqrt(2/(1+l*r)))*a*this.ymf,t=this.xmf*h*l*s;break;case this.N_POLE:case this.S_POLE:o>=0?(t=(h=Math.sqrt(o))*s,i=r*(this.mode==this.S_POLE?h:-h)):t=i=0}}return e.x=this.a*t+this.x0,e.y=this.a*i+this.y0,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t,i=e.x/this.a,s=e.y/this.a;if(this.sphere){var n,r=0,a=0;if(n=Math.sqrt(i*i+s*s),t=.5*n,t>1)return Proj4js.reportError("laea:Inv:DataError"),null;switch(t=2*Math.asin(t),(this.mode==this.OBLIQ||this.mode==this.EQUIT)&&(a=Math.sin(t),r=Math.cos(t)),this.mode){case this.EQUIT:t=Math.abs(n)<=Proj4js.common.EPSLN?0:Math.asin(s*a/n),i*=a,s=r*n;break;case this.OBLIQ:t=Math.abs(n)<=Proj4js.common.EPSLN?this.phi0:Math.asin(r*this.sinph0+s*a*this.cosph0/n),i*=a*this.cosph0,s=(r-Math.sin(t)*this.sinph0)*n;break;case this.N_POLE:s=-s,t=Proj4js.common.HALF_PI-t;break;case this.S_POLE:t-=Proj4js.common.HALF_PI}i=0!=s||this.mode!=this.EQUIT&&this.mode!=this.OBLIQ?Math.atan2(i,s):0}else{switch(t=0,this.mode){case this.EQUIT:case this.OBLIQ:if(i/=this.dd,s*=this.dd,a=Math.sqrt(i*i+s*s),a<Proj4js.common.EPSLN)return e.x=0,e.y=this.phi0,e;n=2*Math.asin(.5*a/this.rq),r=Math.cos(n),i*=n=Math.sin(n),this.mode==this.OBLIQ?(t=r*this.sinb1+s*n*this.cosb1/a,s=a*this.cosb1*r-s*this.sinb1*n):(t=s*n/a,s=a*r);break;case this.N_POLE:s=-s;case this.S_POLE:if(t=i*i+s*s,!t)return e.x=0,e.y=this.phi0,e;t=1-t/this.qp,this.mode==this.S_POLE&&(t=-t)}i=Math.atan2(i,s),t=this.authlat(Math.asin(t),this.apa)}return e.x=Proj4js.common.adjust_lon(this.long0+i),e.y=t,e},P00:.3333333333333333,P01:.17222222222222222,P02:.10257936507936508,P10:.06388888888888888,P11:.0664021164021164,P20:.016415012942191543,authset:function(e){var t,i=[];return i[0]=e*this.P00,t=e*e,i[0]+=t*this.P01,i[1]=t*this.P10,t*=e,i[0]+=t*this.P02,i[1]+=t*this.P11,i[2]=t*this.P20,i},authlat:function(e,t){var i=e+e;return e+t[0]*Math.sin(i)+t[1]*Math.sin(i+i)+t[2]*Math.sin(i+i+i)}},Proj4js.Proj.aeqd={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(e){var t,i=e.x,s=Math.sin(e.y),n=Math.cos(e.y),i=Proj4js.common.adjust_lon(i-this.long0),r=Math.cos(i),a=this.sin_p12*s+this.cos_p12*n*r;if(Math.abs(Math.abs(a)-1)<Proj4js.common.EPSLN){if(t=1,0>a)return Proj4js.reportError("aeqd:Fwd:PointError"),void 0}else t=Math.acos(a),t/=Math.sin(t);return e.x=this.x0+this.a*t*n*Math.sin(i),e.y=this.y0+this.a*t*(this.cos_p12*s-this.sin_p12*n*r),e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t=Math.sqrt(e.x*e.x+e.y*e.y);if(!(t>2*Proj4js.common.HALF_PI*this.a)){var i,s=t/this.a,n=Math.sin(s),s=Math.cos(s),r=this.long0;if(Math.abs(t)<=Proj4js.common.EPSLN)i=this.lat0;else{i=Proj4js.common.asinz(s*this.sin_p12+e.y*n*this.cos_p12/t);var a=Math.abs(this.lat0)-Proj4js.common.HALF_PI;Math.abs(a)<=Proj4js.common.EPSLN?r=0<=this.lat0?Proj4js.common.adjust_lon(this.long0+Math.atan2(e.x,-e.y)):Proj4js.common.adjust_lon(this.long0-Math.atan2(-e.x,e.y)):(a=s-this.sin_p12*Math.sin(i),Math.abs(a)<Proj4js.common.EPSLN&&Math.abs(e.x)<Proj4js.common.EPSLN||(Math.atan2(e.x*n*this.cos_p12,a*t),r=Proj4js.common.adjust_lon(this.long0+Math.atan2(e.x*n*this.cos_p12,a*t))))}return e.x=r,e.y=i,e}Proj4js.reportError("aeqdInvDataError")}},Proj4js.Proj.moll={init:function(){},forward:function(e){for(var t=e.y,i=Proj4js.common.adjust_lon(e.x-this.long0),s=t,n=Proj4js.common.PI*Math.sin(t),r=0;;r++){var a=-(s+Math.sin(s)-n)/(1+Math.cos(s)),s=s+a;if(Math.abs(a)<Proj4js.common.EPSLN)break;r>=50&&Proj4js.reportError("moll:Fwd:IterationError")}return s/=2,Proj4js.common.PI/2-Math.abs(t)<Proj4js.common.EPSLN&&(i=0),t=.900316316158*this.a*i*Math.cos(s)+this.x0,s=1.4142135623731*this.a*Math.sin(s)+this.y0,e.x=t,e.y=s,e},inverse:function(e){var t;
e.x-=this.x0,t=e.y/(1.4142135623731*this.a),.999999999999<Math.abs(t)&&(t=.999999999999),t=Math.asin(t);var i=Proj4js.common.adjust_lon(this.long0+e.x/(.900316316158*this.a*Math.cos(t)));return i<-Proj4js.common.PI&&(i=-Proj4js.common.PI),i>Proj4js.common.PI&&(i=Proj4js.common.PI),t=(2*t+Math.sin(2*t))/Proj4js.common.PI,1<Math.abs(t)&&(t=1),t=Math.asin(t),e.x=i,e.y=t,e}},/**
 * Author:      Jachym Cepicky <jachym les-ejk cz>
 *              http://les-ejk.cz
 * Purpose:     Generic WPS Client for JavaScript programming language
 * Version:     0.0.1
 * Supported WPS Versions: 1.0.0
 *
 * The Library is designed to work with OpenLayers [http://openlayers.org]
 *
 * Licence:
 *  Web Processing Service Client implementation
 *  Copyright (C) 2009 Jachym Cepicky
 *
 *  This program is free software; you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation; either version 2 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License
 *  along with this program; if not, write to the Free Software
 *
 *  TODO:
 *  - a lot
 */
OpenLayers.WPS=OpenLayers.Class({service:"wps",version:"1.0.0",getCapabilitiesUrlGet:null,getcapabilitiesurlpost:null,responseText:null,responseDOM:null,describeProcessUrlGet:null,describeProcessUrlPost:null,executeUrlGet:null,executeUrlPost:null,owsNS:"http://www.opengis.net/ows/1.1",owsPref:"ows",xlinkNS:"http://www.w3.org/1999/xlink",xlinkPref:"xlink",wpsNS:"http://www.opengis.net/wps/",wpsPref:"wps",title:null,scope:this,abstr:null,processes:[],timeOut:1e4,statusLocation:null,status:null,statusMessage:null,statusTime:null,percentCompleted:null,id:null,statusEvents:{},requestText:null,initialize:function(e,t){this.processes=[],OpenLayers.Util.extend(this,t),this.getCapabilitiesUrlGet=e,this.describeProcessUrlGet=e,this.executeUrlGet=e,this.getCapabilitiesUrlPost=e,this.describeProcessUrlPost=e,this.executeUrlPost=e,OpenLayers.Util.extend(this,t),this.wpsNS+=this.version,OpenLayers.WPS.instances.push(this),this.id=OpenLayers.WPS.instances.length-1,this.statusEvents={ProcessAccepted:this.onAccepted,ProcessSucceeded:this.onSucceeded,ProcessFailed:this.onFailed,ProcessStarted:this.onStarted,ProcessPaused:this.onPaused}},getCapabilities:function(e){this.getCapabilitiesGet(e)},getCapabilitiesGet:function(e){e&&(this.getCapabilitiesUrlGet=e);var t=OpenLayers.WPS.Utils.extendUrl(e,{service:this.service,version:this.version,request:"GetCapabilities"});OpenLayers.Request.GET({url:t,params:{},success:this.parseGetCapabilities,failure:this.onException,scope:this})},describeProcess:function(e){this.describeProcessUrlGet&&this.describeProcessGet(e)},describeProcessGet:function(e){var t=OpenLayers.WPS.Utils.extendUrl(this.describeProcessUrlGet,{service:this.service,version:this.version,request:"DescribeProcess",identifier:e});OpenLayers.Request.GET({url:t,params:{},success:this.parseDescribeProcess,failure:this.onException,scope:this})},getIdentifierTitleExtract:function(e){var t=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(e,this.owsNS,"Identifier")[0].firstChild.nodeValue,i=t;try{i=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(e,this.owsNS,"Title")[0].firstChild.nodeValue}catch(s){}var n=null;try{n=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(e,this.owsNS,"Abstract")[0].firstChild.nodeValue}catch(s){}return{identifier:t,title:i,"abstract":n}},parseGetCapabilities:function(e){this.responseText=e.responseText;var t=new OpenLayers.Format.WPSCapabilities,i=t.read(e.responseXML),s=i.serviceIdentification,n=e.responseXML?e.responseXML:OpenLayers.parseXMLString(e.responseText);this.responseDOM=n,this.title=null;try{this.title=s.title}catch(r){}this.abstract=null;try{this.abstract=s.abstract}catch(r){}this.serviceProvider=i.serviceProvider;for(var a=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(n,this.owsNS,"OperationsMetadata")[0],o=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(a,this.owsNS,"Operation"),l=0;l<o.length;l++){var h=o[l].getAttribute("name"),u=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(o[l],this.owsNS,"Get")[0],c=OpenLayers.Format.XML.prototype.getAttributeNS(u,this.xlinkNS,"href"),d=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(o[l],this.owsNS,"Post")[0],p=OpenLayers.Format.XML.prototype.getAttributeNS(d,this.xlinkNS,"href");switch(h.toLowerCase()){case"getcapabilities":this.getCapabilitiesUrlGet=c,this.getCapabilitiesUrlPost=p;break;case"describeprocess":this.describeProcessUrlGet=c,this.describeProcessUrlPost=p;break;case"execute":this.executeUrlGet=c,this.executeUrlPost=p}}for(var f=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(n,this.wpsNS,"ProcessOfferings")[0],m=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(f,this.wpsNS,"Process"),l=0;l<m.length;l++){var y=this.getIdentifierTitleExtract(m[l]),g=y.identifier,v=y.title,x=y.abstract,E=OpenLayers.Format.XML.prototype.getAttributeNS(m[l],this.wpsNS,"version"),b=new OpenLayers.WPS.Process({identifier:g,title:v,"abstract":x,version:E,wps:this});this.addProcess(b)}this.onGotCapabilities()},addProcess:function(e){var t=this.getProcess(e.identifier);if(t){for(var i=[],s=0;s<this.processes.length;s++)this.processes[s]!=t?i.push(this.process[s]):this.processes[s]=null;this.processes=i}this.processes.push(e),e.wps=this},parseDescribeProcess:function(e){this.responseText=e.responseText;var t=e.responseXML?e.responseXML:OpenLayers.parseXMLString(e.responseText);this.responseDOM=t;for(var i=t.getElementsByTagName("ProcessDescription"),s=0;s<i.length;s++){var n=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(i[s],this.owsNS,"Identifier")[0].firstChild.nodeValue,r=this.getProcess(n);r||(r=new OpenLayers.WPS.Process({identifier:n,title:""}),this.addProcess(r)),r.title=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(i[s],this.owsNS,"Title")[0].firstChild.nodeValue,r.abstract=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(i[s],this.owsNS,"Abstract")[0].firstChild.nodeValue,r.version=OpenLayers.Format.XML.prototype.getAttributeNS(i[s],this.wpsNS,"processVersion"),r.inputs=r.inputs.concat(r.inputs,this.parseDescribePuts(i[s].getElementsByTagName("Input"))),r.outputs=r.outputs.concat(r.outputs,this.parseDescribePuts(i[s].getElementsByTagName("Output"))),this.onDescribedProcess(r)}},parseDescribePuts:function(e){for(var t=[],i=0;i<e.length;i++){e[i].getElementsByTagName("LiteralData").length>0?t.push(this.parseDescribeLiteralPuts(e[i])):e[i].getElementsByTagName("ComplexData").length>0?t.push(this.parseDescribeComplexPuts(e[i])):e[i].getElementsByTagName("BoundingBoxData").length>0&&t.push(this.parseDescribeBoundingBoxPuts(e[i])),e[i].getElementsByTagName("LiteralOutput").length>0?t.push(this.parseDescribeLiteralPuts(e[i])):e[i].getElementsByTagName("ComplexOutput").length>0?t.push(this.parseDescribeComplexPuts(e[i])):e[i].getElementsByTagName("BoundingBoxOutput").length>0&&t.push(this.parseDescribeBoundingBoxPuts(e[i]));var s=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(e[i],this.owsNS,"Metadata"),n={};s.length>0&&(s[OpenLayers.Format.XML.prototype.getAttributeNS(s[i],this.xlinkNS,"title")]=s[i].firstChild.nodeValue),t[t.length-1].metadata=n}return t},parseDescribeComplexPuts:function(e){var t=this.getIdentifierTitleExtract(e),i=t.identifier,s=t.title,n=t.abstract,r=[],a=e.getElementsByTagName("ComplexData");if(a=a.length?a:e.getElementsByTagName("ComplexOutput"),a.length>0){var o=a[0].getElementsByTagName("Default")[0].getElementsByTagName("Format")[0],l=o.getElementsByTagName("MimeType")[0].firstChild.nodeValue;r.push(l);for(var h=a[0].getElementsByTagName("Supported")[0].getElementsByTagName("Format"),u=0;u<h.length;u++){var c=h[u].getElementsByTagName("MimeType")[0].firstChild.nodeValue;0==OpenLayers.WPS.Utils.isIn(r,c)&&r.push(c)}}var d=!0;return r[0].search("text")>-1&&(d=!1),new OpenLayers.WPS.ComplexPut({identifier:i,title:s,asReference:d,"abstract":n,formats:r})},parseDescribeBoundingBoxPuts:function(e){var t=this.getIdentifierTitleExtract(e),i=t.identifier,s=t.title,n=t.abstract,r=[],a=e.getElementsByTagName("BoundingBoxData")[0];a||(a=e.getElementsByTagName("BoundingBoxOutput")[0]),r.push(OpenLayers.Format.XML.prototype.getAttributeNS(a.getElementsByTagName("Default")[0].getElementsByTagName("CRS")[0],this.xlinkNS,"href"));for(var o=a.getElementsByTagName("Supported"),l=0;l<o.length;l++){var h=OpenLayers.Format.XML.prototype.getAttributeNS(o[l].getElementsByTagName("CRS")[0],this.xlinkNS,xlink.wpsPref,"href");0==OpenLayers.WPS.Utils.isIn(r,h)&&r.push(h)}return new OpenLayers.WPS.BoundingBoxPut({identifier:i,title:s,"abstract":n,crss:r})},parseDescribeLiteralPuts:function(e){var t=this.getIdentifierTitleExtract(e),i=t.identifier,s=t.title,n=t.abstract,r=[],a="string",o=null,l=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(e,this.owsNS,"DataType")[0];if(l&&(a=l.firstChild.nodeValue.toLowerCase()),OpenLayers.Format.XML.prototype.getElementsByTagNameNS(e,this.owsNS,"AnyValue").length>0)r=["*"];else if(OpenLayers.Format.XML.prototype.getElementsByTagNameNS(e,this.owsNS,"AllowedValues").length>0)for(var h=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(e,this.owsNS,"AllowedValues")[0].childNodes,u=0;u<h.length;u++)if(1==h[u].nodeType)if("Value"==h[u].localName)r.push(h[u].firstChild.nodeValue);else if("Range"==h[u].localName){var c=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(h[u],this.owsNS,"MinimumValue")[0].firstChild.nodeValue,d=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(h[u],this.owsNS,"MaximumValue")[0].firstChild.nodeValue;r.push([c,d])}return new OpenLayers.WPS.LiteralPut({identifier:i,title:s,"abstract":n,allowedValues:r,type:a,defaultValue:o})},execute:function(e){this.executeUrlPost&&this.executePost(e)},executePost:function(e){var t=this.executeUrlPost,i=this.getProcess(e),s=OpenLayers.WPS.executeRequestTemplate.replace("$IDENTIFIER$",e);s=s.replace("$STORE_AND_STATUS$",i.async);for(var n="",r=0;r<i.inputs.length;r++){var a=i.inputs[r],o="";if(a.CLASS_NAME.search("Complex")>-1){var l=a.format?a.format:a.formats[0],h="";o=a.asReference?OpenLayers.WPS.complexInputReferenceTemplate.replace("$REFERENCE$",escape(a.getValue())):OpenLayers.WPS.complexInputDataTemplate.replace("$DATA$",a.getValue()),l&&(l.mimeType&&(h+=' mimeType="'+l.mimeType+'"'),l.schema&&(h+=' schema="'+l.schema+'"'),l.encoding&&(h+=' encoding="'+l.encoding+'"')),o=o.replace("$FORMAT$",h)}else a.CLASS_NAME.search("Literal")>-1?o=OpenLayers.WPS.literalInputTemplate.replace("$DATA$",a.getValue()):a.CLASS_NAME.search("BoundingBox")>-1&&(o=OpenLayers.WPS.boundingBoxInputTemplate.replace("$DIMENSIONS$",a.dimensions),o=o.replace("$CRS$",a.crs),o=o.replace("$MINX$",a.value.minx),o=o.replace("$MINY$",a.value.miny),o=o.replace("$MAXX$",a.value.maxx),o=o.replace("$MAXY$",a.value.maxy));o=o.replace("$IDENTIFIER$",a.identifier),n+=o}for(var u="",r=0;r<i.outputs.length;r++){var c=i.outputs[r],o="";if(c.CLASS_NAME.search("Complex")>-1){o=OpenLayers.WPS.complexOutputTemplate.replace("$AS_REFERENCE$",c.asReference);var l=c.format?c.format:c.formats[0],h="";l&&(l.mimeType&&(h+=' mimeType="'+l.mimeType+'"'),l.schema&&(h+=' schema="'+l.schema+'"'),l.encoding&&(h+=' encoding="'+l.encoding+'"')),o=o.replace("$FORMAT$",h)}else c.CLASS_NAME.search("Literal")>-1?o=OpenLayers.WPS.literalOutputTemplate:c.CLASS_NAME.search("BoundingBox")>-1&&(o=OpenLayers.WPS.boundingBoxOutputTemplate);o=o.replace("$IDENTIFIER$",c.identifier),u+=o}s=s.replace("$DATA_INPUTS$",n),s=s.replace("$OUTPUT_DEFINITIONS$",u),console.log("data: ",s),this.requestText=s,OpenLayers.Request.POST({url:t,data:s,success:this.parseExecute,failure:this.onException,scope:this})},parseExecute:function(e){var t=e.responseText;console.log("text: ",t),this.responseText=t,"msie"==OpenLayers.Util.getBrowserName()&&(e.responseXML=null,t=t.replace(/<\?xml .[^>]*>/,""));var i=e.responseXML?e.responseXML:OpenLayers.parseXMLString(t);this.responseDOM=i;try{this.statusLocation=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(i,this.wpsNS,"ExecuteResponse")[0].getAttribute("statusLocation")}catch(s){this.statusLocation=null}var n=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(i,this.owsNS,"Identifier")[0].firstChild.nodeValue,r=this.getProcess(n),a=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(i,this.wpsNS,"Status");if(a.length>0&&this.parseStatus(a[0]),"ProcessSucceeded"==this.status){var o=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(i,this.wpsNS,"ProcessOutputs"),l=null;o.length&&(l=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(o[0],this.wpsNS,"Output"));for(var h=0;h<l.length;h++)this.parseExecuteOutput(r,l[h])}else"ProcessFailed"==this.status&&this.parseProcessFailed(r,i);if(this.statusEvents[this.status].apply(this.scope,[r]),this.onStatusChanged(this.status,r),"ProcessFailed"!=this.status&&"ProcessSucceeded"!=this.status)this.statusLocation&&window.setTimeout("OpenLayers.Request.GET({url:OpenLayers.WPS.instances["+this.id+"].statusLocation,"+"params:{salt:"+Math.random()+"},success: OpenLayers.WPS.instances["+this.id+"].parseExecute,"+"failure: OpenLayers.WPS.instances["+this.id+"].onException, "+"scope: OpenLayers.WPS.instances["+this.id+"]})",this.timeOut);else{for(var u in OpenLayers.WPS.instances)OpenLayers.WPS.instances[u]=null;OpenLayers.WPS.instances=[]}},parseExecuteOutput:function(e,t){var i=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(t,this.owsNS,"Identifier")[0].firstChild.nodeValue,s=e.getOutput(i),n=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(t,this.wpsNS,"LiteralData"),r=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(t,this.wpsNS,"ComplexData"),a=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(t,this.wpsNS,"BoundingBox"),o=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(t,this.wpsNS,"Reference");if(o.length>0)s.setValue(OpenLayers.Format.XML.prototype.getAttributeNS(o[0],"","href"));else if(n.length>0)s.setValue(n[0].firstChild.nodeValue);else if(r.length>0){nodes=new Array;for(var l=0;l<r[0].childNodes.length;l++){var h=r[0].childNodes[l];1==h.nodeType&&nodes.push(h)}s.setValue(nodes),s.getValue()||s.setValue(r[0].textContent)}else if(a.length>0){var u,c;u=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(a,this.owsNS,"LowerCorner"),c=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(a,this.owsNS,"UpperCorner");var d=a.getAttribute("crs"),p=a.getAttribute("dimensions");s.setValue([u.split(" ")[0],u.split(" ")[1],c.split(" ")[0],c.split(" ")[1]]),s.dimensions=p,s.crs=d}},setStatus:function(e,t,i,s){this.status=e,this.statusMessage=t,this.statusTime=i,this.percentCompleted=s},parseStatus:function(e){for(var t in this.statusEvents){var i=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(e,this.wpsNS,t);i.length>0&&this.setStatus(t,i[0].firstChild.nodeValue,e.getAttribute("creationTime"),i[0].getAttribute("percentCompleted"))}},onAccepted:function(){},onSucceeded:function(){},onFailed:function(){},parseProcessFailed:function(e,t){var i,s=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(t,this.owsNS,"Exception");s.length&&(i=s[0].getAttribute("exceptionCode"));var n,r=OpenLayers.Format.XML.prototype.getElementsByTagNameNS(t,this.owsNS,"ExceptionText");if(r.length)try{n=r[0].firstChild.nodeValue}catch(a){n=""}e.exception={code:i,text:n}},onStarted:function(){},onPaused:function(){},getProcess:function(e){for(var t=0;t<this.processes.length;t++)if(this.processes[t].identifier==e)return this.processes[t];return void 0},onException:function(e){alert("WPS Error.. dropping to debugger"),console.log(e)},onGotCapabilities:function(){},onDescribedProcess:function(){},onStatusChanged:function(){},CLASS_NAME:"OpenLayers.WPS"}),OpenLayers.WPS.Utils={extendUrl:function(e,t){var i=e.split("?")[0];try{var s=e.split("?")[1].split("&")}catch(n){var s=[]}for(var r={},a=0;a<s.length;a++){var o,l;o=s[a].split("=")[0],l=s[a].split("=")[1],o&&l&&(r[o]=l)}t=OpenLayers.Util.extend(t,r);var h="";for(var o in t)h+="&"+o+"="+t[o];return i+"?"+h},isIn:function(e,t){for(var i={},s=0;s<e.length;s++)i[e[s]]=null;return t in i}},OpenLayers.WPS.Process=OpenLayers.Class({identifier:null,title:null,"abstract":null,inputs:[],exception:[],outputs:[],metadata:{},version:null,status:!1,async:!1,wps:null,initialize:function(e){this.identifier=null,this.title=null,this.abstract=null,this.inputs=[],this.exception=[],this.outputs=[],this.metadata={},this.version=null,this.status=!1,this.async=!1,this.wps=null,OpenLayers.Util.extend(this,e)},addInput:function(){},addOutput:function(){},execute:function(){this.wps.execute(this.identifier)},getInput:function(e){for(var t=0;t<this.inputs.length;t++)if(this.inputs[t].identifier==e)return this.inputs[t];return null},getOutput:function(e){for(var t=0;t<this.outputs.length;t++)if(this.outputs[t].identifier==e)return this.outputs[t];return null},CLASS_NAME:"OpenLayers.WPS.Process"}),OpenLayers.WPS.Put=OpenLayers.Class({identifier:null,title:null,"abstract":null,value:null,initialize:function(e){OpenLayers.Util.extend(this,e)},setValue:function(e){this.value=e},getValue:function(){return this.value},CLASS_NAME:"OpenLayers.WPS.Put"}),OpenLayers.WPS.LiteralPut=OpenLayers.Class(OpenLayers.WPS.Put,{allowedValues:[],defaultValue:null,type:null,CLASS_NAME:"OpenLayers.WPS.LiteralPut"}),OpenLayers.WPS.ComplexPut=OpenLayers.Class(OpenLayers.WPS.Put,{asReference:!1,formats:[],format:{},CLASS_NAME:"OpenLayers.WPS.ComplexPut"}),OpenLayers.WPS.BoundingBoxPut=OpenLayers.Class(OpenLayers.WPS.Put,{dimensions:2,crss:null,value:{minx:null,miny:null,maxx:null,maxy:null,bottom:null,top:null},CLASS_NAME:"OpenLayers.WPS.BoundingBoxPut"}),OpenLayers.WPS.executeRequestTemplate='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><wps:Execute service="WPS" version="1.0.0" xmlns:wps="http://www.opengis.net/wps/1.0.0" xmlns:ows="http://www.opengis.net/ows/1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.opengis.net/wps/1.0.0/wpsExecute_request.xsd"><ows:Identifier>$IDENTIFIER$</ows:Identifier><wps:DataInputs>$DATA_INPUTS$</wps:DataInputs><wps:ResponseForm><wps:ResponseDocument lineage="false" storeExecuteResponse="true" status="$STORE_AND_STATUS$">$OUTPUT_DEFINITIONS$</wps:ResponseDocument></wps:ResponseForm></wps:Execute>',OpenLayers.WPS.literalInputTemplate="<wps:Input><ows:Identifier>$IDENTIFIER$</ows:Identifier><wps:Data><wps:LiteralData>$DATA$</wps:LiteralData></wps:Data></wps:Input>",OpenLayers.WPS.complexInputReferenceTemplate='<wps:Input><ows:Identifier>$IDENTIFIER$</ows:Identifier><wps:Reference xlink:href="$REFERENCE$" $FORMAT$ /></wps:Input>',OpenLayers.WPS.complexInputDataTemplate="<wps:Input><ows:Identifier>$IDENTIFIER$</ows:Identifier><wps:Data><wps:ComplexData $FORMAT$>$DATA$</wps:ComplexData></wps:Data></wps:Input>",OpenLayers.WPS.boundingBoxInputTemplate='<wps:Input><ows:Identifier>$IDENTIFIER$</ows:Identifier><wps:Data><wps:BoundingBoxData ows:dimensions="$DIMENSIONS$" ows:crs="$CRS$"><ows:LowerCorner>$MINX$ $MINY$</ows:LowerCorner><ows:UpperCorner>$MAXX$ $MAXY$</ows:UpperCorner></wps:BoundingBoxData></wps:Data></wps:Input>',OpenLayers.WPS.complexOutputTemplate='<wps:Output asReference="$AS_REFERENCE$" $FORMAT$><ows:Identifier>$IDENTIFIER$</ows:Identifier></wps:Output>',OpenLayers.WPS.literalOutputTemplate='<wps:Output asReference="false"><ows:Identifier>$IDENTIFIER$</ows:Identifier></wps:Output>',OpenLayers.WPS.boundingBoxOutputTemplate=OpenLayers.WPS.literalOutputTemplate,OpenLayers.WPS.instances=[],function(){}.call(this),function(){}.call(this);var DSS=DSS||{};DSS.map=null,DSS.mapProjection="EPSG:28992",OpenLayers.IMAGE_RELOAD_ATTEMPTS=3,OpenLayers.Util.onImageLoadErrorColor="transparent",DSS.buildsGML=null,DSS.style=new OpenLayers.Style,DSS.rule_fsa=new OpenLayers.Rule({symbolizer:{fillColor:"#DDDD00",fillOpacity:.6,strokeColor:"#DDDD00",strokeWidth:1}}),DSS.rule_highlight=new OpenLayers.Rule({filter:new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN,property:"cum_multi",value:0}),symbolizer:{fillColor:"#FF7144",fillOpacity:.5,strokeColor:"#FF7144",strokeWidth:2,strokeDashstyle:"solid"}}),DSS.style.addRules([DSS.rule_fsa,DSS.rule_highlight]),DSS.initMap=function(){var e=new OpenLayers.Bounds(91979,436326,92617,437659.5);DSS.map=new OpenLayers.Map("SliderMap",{projection:new OpenLayers.Projection(DSS.mapProjection),units:"m",maxExtent:e,controls:[]}),DSS.map.addControl(new OpenLayers.Control.LayerSwitcher),DSS.map.addControl(new OpenLayers.Control.Navigation),DSS.map.addControl(new OpenLayers.Control.PanZoom);var t=new OpenLayers.Layer.WMS("Streets","http://weastflows.tudor.lu/cgi-bin/mapserv?map=/var/www/MapFiles/Rotterdam02.map",{layers:"Streets",format:"image/png",srsName:DSS.mapProjection,transparent:"true",untiled:"tre",projection:new OpenLayers.Projection(DSS.mapProjection)},{isBaseLayer:!0,visibility:!0}),i=new OpenLayers.Layer.WMS("Buildings","http://services.iguess.tudor.lu/cgi-bin/mapserv?map=/var/www/MapFiles/RO_localOWS_test.map",{layers:"RO_buildings_gml",format:"image/png",srsName:DSS.mapProjection,transparent:"true",projection:new OpenLayers.Projection(DSS.mapProjection)},{isBaseLayer:!1,visibility:!0});DSS.buildsGML=new OpenLayers.Layer.Vector("BuildingsGML",{protocol:new OpenLayers.Protocol.HTTP({url:"assets/pv_potential.gml",format:new OpenLayers.Format.GML}),styleMap:DSS.style,strategies:[new OpenLayers.Strategy.Fixed]}),buildsWFS=new OpenLayers.Layer.Vector("BuildingsWFS",{strategies:[new OpenLayers.Strategy.Fixed],projection:new OpenLayers.Projection(DSS.mapProjection),protocol:new OpenLayers.Protocol.WFS({url:"http://services.iguess.tudor.lu/cgi-bin/mapserv?map=/var/www/MapFiles/RO_localOWS_test.map",featureType:"RO_buildings_gml",featureNS:"http://mapserver.gis.umn.edu/mapserver",srsName:DSS.mapProjection})}),DSS.map.addLayers([t,i,DSS.buildsGML]),DSS.map.zoomIn(),DSS.map.zoomIn()};var DSS=DSS||{};DSS.lock=!1,DSS.potSlider=null,DSS.capSlider=null,DSS.invSlider=null,DSS.winPanel=new Ext.Window({title:"Potential Application",id:"panelWindowId",autoHeight:!0,width:300,resizable:!1,closable:!1,modal:!1,contentEl:"divWindowId"}),DSS.initSliders=function(){DSS.costSlider=new Ext.Slider({renderTo:"slider-cost",width:214,value:0,minValue:90,maxValue:200,plugins:new Ext.ux.SliderTip}),DSS.invSlider=new Ext.Slider({renderTo:"slider-investment",width:214,value:0,minValue:0,maxValue:45600,plugins:new Ext.ux.SliderTip}),DSS.genSlider=new Ext.Slider({renderTo:"slider-generation",width:214,value:0,minValue:0,maxValue:17e3,plugins:new Ext.ux.SliderTip}),DSS.areaSlider=new Ext.Slider({renderTo:"slider-area",width:214,value:0,minValue:0,maxValue:166e3,plugins:new Ext.ux.SliderTip}),DSS.costSlider.on("change",DSS.costDragged,this),DSS.invSlider.on("change",DSS.invDragged,this),DSS.genSlider.on("change",DSS.genDragged,this),DSS.areaSlider.on("change",DSS.areaDragged,this)},DSS.calcCostValue=function(e){return costPercent=e*(DSS.costSlider.maxValue-DSS.costSlider.minValue)/100,DSS.costSlider.minValue+costPercent},DSS.updateLabels=function(e){cost=(DSS.calcCostValue(e)/1e3).toFixed(3),invest=(e*DSS.invSlider.maxValue/100).toFixed(0),gen=(e*DSS.genSlider.maxValue/100).toFixed(0),area=(e*DSS.areaSlider.maxValue/100).toFixed(0),document.getElementById("cost").innerHTML="Cost: "+cost+" &euro;/kWh",document.getElementById("invest").innerHTML="Investment: "+invest+" k&euro;",document.getElementById("gen").innerHTML="Generation: "+gen+" MWh/a",document.getElementById("area").innerHTML="Area: "+area+" m2"},DSS.costDragged=function(e,t){DSS.lock||(DSS.lock=!0,percent=100*((parseFloat(t)-DSS.costSlider.minValue)/(DSS.costSlider.maxValue-DSS.costSlider.minValue)),DSS.updateLabels(percent),DSS.invSlider.setValue(percent*DSS.invSlider.maxValue/100),DSS.genSlider.setValue(percent*DSS.genSlider.maxValue/100),DSS.areaSlider.setValue(percent*DSS.areaSlider.maxValue/100),DSS.rule_highlight.filter.value=t/1e3,DSS.rule_highlight.filter.property="multi_c_e",DSS.buildsGML.redraw(),DSS.lock=!1)},DSS.invDragged=function(e,t){DSS.lock||(DSS.lock=!0,percent=100*(parseFloat(t)/DSS.invSlider.maxValue),DSS.updateLabels(percent),DSS.costSlider.setValue(DSS.calcCostValue(percent)),DSS.genSlider.setValue(percent*DSS.genSlider.maxValue/100),DSS.areaSlider.setValue(percent*DSS.areaSlider.maxValue/100),DSS.rule_highlight.filter.value=1e3*t,DSS.rule_highlight.filter.property="mult_r_i",DSS.buildsGML.redraw(),DSS.lock=!1)},DSS.areaDragged=function(e,t){DSS.lock||(DSS.lock=!0,percent=100*(parseFloat(t)/DSS.areaSlider.maxValue),DSS.updateLabels(percent),DSS.costSlider.setValue(DSS.calcCostValue(percent)),DSS.invSlider.setValue(percent*DSS.invSlider.maxValue/100),DSS.genSlider.setValue(percent*DSS.genSlider.maxValue/100),DSS.rule_highlight.filter.value=t,DSS.rule_highlight.filter.property="area_cum",DSS.buildsGML.redraw(),DSS.lock=!1)},DSS.genDragged=function(e,t){DSS.lock||(DSS.lock=!0,percent=100*(parseFloat(t)/DSS.genSlider.maxValue),DSS.updateLabels(percent),DSS.costSlider.setValue(DSS.calcCostValue(percent)),DSS.invSlider.setValue(percent*DSS.invSlider.maxValue/100),DSS.areaSlider.setValue(percent*DSS.areaSlider.maxValue/100),DSS.rule_highlight.filter.value=1e3*t,DSS.rule_highlight.filter.property="mult_r_e",DSS.buildsGML.redraw(),DSS.lock=!1)},DSS.showWindow=function(){DSS.winPanel.show()};var currentTallest=0,currentRowStart=0,rowDivs=new Array;$(window).resize(function(){columnConform()}),/*-------------------------------------------------------------------- 
 * JQuery Plugin: "EqualHeights" & "EqualWidths"
 * by:   Scott Jehl, Todd Parker, Maggie Costello Wachs (http://www.filamentgroup.com)
 *
 * Copyright (c) 2007 Filament Group
 * Licensed under GPL (http://www.opensource.org/licenses/gpl-license.php)
 *
 * Description: Compares the heights or widths of the top-level children of a provided element 
      and sets their min-height to the tallest height (or width to widest width). Sets in em units 
      by default if pxToEm() method is available.
 * Dependencies: jQuery library, pxToEm method  (article: http://www.filamentgroup.com/lab/retaining_scalable_interfaces_with_pixel_to_em_conversion/)                       
 * Usage Example: $(element).equalHeights();
                           Optional: to set min-height in px, pass a true argument: $(element).equalHeights(true);
 * Version: 2.0, 07.24.2008
 * Changelog:
 *  08.02.2007 initial Version 1.0
 *  07.24.2008 v 2.0 - added support for widths
--------------------------------------------------------------------*/
$.fn.equalHeights=function(e){return $(this).each(function(){var t=0;$(this).children().each(function(){$(this).height()>t&&(t=$(this).height())}),!e&&Number.prototype.pxToEm&&(t=t.pxToEm()),$.browser.msie&&6==$.browser.version&&$(this).children().css({height:t}),$(this).children().css({"min-height":t})}),this},$.fn.equalWidths=function(e){return $(this).each(function(){var t=0;$(this).children().each(function(){$(this).width()>t&&(t=$(this).width())}),!e&&Number.prototype.pxToEm&&(t=t.pxToEm()),$.browser.msie&&6==$.browser.version&&$(this).children().css({width:t}),$(this).children().css({"min-width":t})}),this},/*-------------------------------------------------------------------- 
 * jQuery pixel/em conversion plugins: toEm() and toPx()
 * by Scott Jehl (scott@filamentgroup.com), http://www.filamentgroup.com
 * Copyright (c) Filament Group
 * Dual licensed under the MIT (filamentgroup.com/examples/mit-license.txt) or GPL (filamentgroup.com/examples/gpl-license.txt) licenses.
 * Article: http://www.filamentgroup.com/lab/update_jquery_plugin_for_retaining_scalable_interfaces_with_pixel_to_em_con/
 * Options:                            
      scope: string or jQuery selector for font-size scoping        
 * Usage Example: $(myPixelValue).toEm(); or $(myEmValue).toPx();
--------------------------------------------------------------------*/
$.fn.toEm=function(e){e=jQuery.extend({scope:"body"},e);var t=parseInt(this[0],10),i=jQuery('<div style="display: none; font-size: 1em; margin: 0; padding:0; height: auto; line-height: 1; border:0;">&nbsp;</div>').appendTo(e.scope),s=i.height();return i.remove(),(t/s).toFixed(8)+"em"},$.fn.toPx=function(e){e=jQuery.extend({scope:"body"},e);var t=parseFloat(this[0]),i=jQuery('<div style="display: none; font-size: 1em; margin: 0; padding:0; height: auto; line-height: 1; border:0;">&nbsp;</div>').appendTo(e.scope),s=i.height();return i.remove(),Math.round(t*s)+"px"},function(){var e,t=Array.prototype.slice;e=function(){function e(t,i){var s,n,r;this.elem=$(t),n=$.extend({},e.defaults,i);for(s in n)r=n[s],this[s]=r;this.elem.data(this.dataName,this),this.wrapCheckboxWithDivs(),this.attachEvents(),this.disableTextSelection(),this.resizeHandle&&this.optionallyResize("handle"),this.resizeContainer&&this.optionallyResize("container"),this.initialPosition()}return e.prototype.isDisabled=function(){return this.elem.is(":disabled")},e.prototype.wrapCheckboxWithDivs=function(){return this.elem.wrap("<div class='"+this.containerClass+"' />"),this.container=this.elem.parent(),this.offLabel=$("<label class='"+this.labelOffClass+"'>\n  <span>"+this.uncheckedLabel+"</span>\n</label>").appendTo(this.container),this.offSpan=this.offLabel.children("span"),this.onLabel=$("<label class='"+this.labelOnClass+"'>\n  <span>"+this.checkedLabel+"</span>\n</label>").appendTo(this.container),this.onSpan=this.onLabel.children("span"),this.handle=$("<div class='"+this.handleClass+"'>\n  <div class='"+this.handleRightClass+"'>\n    <div class='"+this.handleCenterClass+"' />\n  </div>\n</div>").appendTo(this.container)},e.prototype.disableTextSelection=function(){return $.browser.msie?$([this.handle,this.offLabel,this.onLabel,this.container]).attr("unselectable","on"):void 0},e.prototype._getDimension=function(e,t){return null!=$.fn.actual?e.actual(t):e[t]()},e.prototype.optionallyResize=function(e){var t,i,s;return s=this._getDimension(this.onLabel,"width"),i=this._getDimension(this.offLabel,"width"),"container"===e?(t=s>i?s:i,t+=this._getDimension(this.handle,"width")+this.handleMargin,this.container.css({width:t})):(t=s>i?s:i,this.handle.css({width:t}))},e.prototype.onMouseDown=function(t){var i;return t.preventDefault(),this.isDisabled()?void 0:(i=t.pageX||t.originalEvent.changedTouches[0].pageX,e.currentlyClicking=this.handle,e.dragStartPosition=i,e.handleLeftOffset=parseInt(this.handle.css("left"),10)||0)},e.prototype.onDragMove=function(t,i){var s,n;if(e.currentlyClicking===this.handle)return n=(i+e.handleLeftOffset-e.dragStartPosition)/this.rightSide,0>n&&(n=0),n>1&&(n=1),s=n*this.rightSide,this.handle.css({left:s}),this.onLabel.css({width:s+this.handleRadius}),this.offSpan.css({marginRight:-s}),this.onSpan.css({marginLeft:-(1-n)*this.rightSide})},e.prototype.onDragEnd=function(t,i){var s;if(e.currentlyClicking===this.handle&&!this.isDisabled())return e.dragging?(s=(i-e.dragStartPosition)/this.rightSide,this.elem.prop("checked",s>=.5)):this.elem.prop("checked",!this.elem.prop("checked")),e.currentlyClicking=null,e.dragging=null,this.didChange()},e.prototype.refresh=function(){return this.didChange()},e.prototype.didChange=function(){var e;return"function"==typeof this.onChange&&this.onChange(this.elem,this.elem.prop("checked")),this.isDisabled()?(this.container.addClass(this.disabledClass),!1):(this.container.removeClass(this.disabledClass),e=this.elem.prop("checked")?this.rightSide:0,this.handle.animate({left:e},this.duration),this.onLabel.animate({width:e+this.handleRadius},this.duration),this.offSpan.animate({marginRight:-e},this.duration),this.onSpan.animate({marginLeft:e-this.rightSide},this.duration))},e.prototype.attachEvents=function(){var e,t,i;return i=this,e=function(){return i.onGlobalMove.apply(i,arguments)},t=function(){return i.onGlobalUp.apply(i,arguments),$(document).unbind("mousemove touchmove",e),$(document).unbind("mouseup touchend",t)},this.elem.change(function(){return i.refresh()}),this.container.bind("mousedown touchstart",function(){return i.onMouseDown.apply(i,arguments),$(document).bind("mousemove touchmove",e),$(document).bind("mouseup touchend",t)})},e.prototype.initialPosition=function(){var e,t;return e=this._getDimension(this.container,"width"),this.offLabel.css({width:e-this.containerRadius}),t=this.containerRadius+1,$.browser.msie&&$.browser.version<7&&(t-=3),this.rightSide=e-this._getDimension(this.handle,"width")-t,this.elem.is(":checked")?(this.handle.css({left:this.rightSide}),this.onLabel.css({width:this.rightSide+this.handleRadius}),this.offSpan.css({marginRight:-this.rightSide})):(this.onLabel.css({width:0}),this.onSpan.css({marginLeft:-this.rightSide})),this.isDisabled()?this.container.addClass(this.disabledClass):void 0},e.prototype.onGlobalMove=function(t){var i;if(!this.isDisabled()&&e.currentlyClicking)return t.preventDefault(),i=t.pageX||t.originalEvent.changedTouches[0].pageX,!e.dragging&&Math.abs(e.dragStartPosition-i)>this.dragThreshold&&(e.dragging=!0),this.onDragMove(t,i)},e.prototype.onGlobalUp=function(t){var i;if(e.currentlyClicking)return t.preventDefault(),i=t.pageX||t.originalEvent.changedTouches[0].pageX,this.onDragEnd(t,i),!1},e.defaults={duration:200,checkedLabel:"ON",uncheckedLabel:"OFF",resizeHandle:!0,resizeContainer:!0,disabledClass:"iPhoneCheckDisabled",containerClass:"iPhoneCheckContainer",labelOnClass:"iPhoneCheckLabelOn",labelOffClass:"iPhoneCheckLabelOff",handleClass:"iPhoneCheckHandle",handleCenterClass:"iPhoneCheckHandleCenter",handleRightClass:"iPhoneCheckHandleRight",dragThreshold:5,handleMargin:15,handleRadius:4,containerRadius:5,dataName:"iphoneStyle",onChange:function(){}},e}(),$.iphoneStyle=this.iOSCheckbox=e,$.fn.iphoneStyle=function(){var i,s,n,r,a,o,l,h,u,c,d,p;for(i=1<=arguments.length?t.call(arguments,0):[],n=null!=(u=null!=(c=i[0])?c.dataName:void 0)?u:e.defaults.dataName,d=this.filter(":checkbox"),l=0,h=d.length;h>l;l++)s=d[l],r=$(s).data(n),null!=r?(a=i[0],o=2<=i.length?t.call(i,1):[],null!=(p=r[a])&&p.apply(r,o)):new e(s,i[0]);return this},$.fn.iOSCheckbox=function(e){var t;return null==e&&(e={}),t=$.extend({},e,{resizeHandle:!1,disabledClass:"iOSCheckDisabled",containerClass:"iOSCheckContainer",labelOnClass:"iOSCheckLabelOn",labelOffClass:"iOSCheckLabelOff",handleClass:"iOSCheckHandle",handleCenterClass:"iOSCheckHandleCenter",handleRightClass:"iOSCheckHandleRight",dataName:"iOSCheckbox"}),this.iphoneStyle(t)}}.call(this),function(e){e.fn.CheckboxSwitch=function(t){var i=e.extend({"border-color":"#111","border-radius":"2px",padding:"8px","off-gradient-start":"#fff","off-gradient-end":"#ddd","on-gradient-off-start":"#555","on-gradient-off-end":"#333","on-gradient-on-start":"#62c462","on-gradient-on-end":"#57a957","on-text":"On","off-text":"Off"},t),s=function(e,t,i){e.css("background-color",i).css("background-repeat","repeat-x").css("background-image","-khtml-gradient(linear, left top, left bottom, from("+t+"), to("+i+"))").css("background-image","-moz-linear-gradient(top, "+t+", "+i+")").css("background-image","-ms-linear-gradient(top, "+t+", "+i+")").css("background-image","-webkit-gradient(linear, left top, left bottom, color-stop(0%, "+t+"), color-stop(100%, "+i+"))").css("background-image","-webkit-linear-gradient(top, "+t+", "+i+")").css("background-image","-o-linear-gradient(top, "+t+", "+i+")").css("background-image","linear-gradient(top, "+t+", "+i+")").css("filter","e(%(\"progid:DXImageTransform.Microsoft.gradient(startColorstr='%d', endColorstr='%d', GradientType=0)\","+t+","+i+"))")},n=function(e){e.css({border:"1px solid "+i["border-color"],"-webkit-border-radius":i["border-radius"],"-moz-border-radius":i["border-radius"],"border-radius":i["border-radius"],margin:"0",padding:i.padding+" 0 "+i.padding+" 0"})},r=function(e){e.css({cursor:"pointer",padding:i.padding})},a=function(e){e.css("color","#888"),s(e,i["off-gradient-start"],i["off-gradient-end"])},o=function(e){e.css("color","#fff"),s(e,i["on-gradient-off-start"],i["on-gradient-off-end"])},l=function(e){e.css("color","#fff"),s(e,i["on-gradient-on-start"],i["on-gradient-on-end"])};return this.each(function(){var t=e(this),s=e("<div />"),h=e("<span />"),u=e("<span>"+i["on-text"]+"</span>"),c=e("<span>"+i["off-text"]+"</span>");s.css("padding",i.padding+" 0 "+i.padding+" 0"),n(h),r(u),r(c),"checked"==t.attr("checked")?(l(u),a(c)):(a(u),o(c)),e(this).css("display","none"),e(this).wrapAll(s).wrapAll(h),e(this).before(u,c),u.bind("click",function(){l(u),a(c),t.attr("checked",!0)}),c.bind("click",function(){o(c),a(u),t.attr("checked",!1)})})}}(jQuery),function($){$.extend({tablesorter:new function(){function benchmark(e,t){log(e+","+((new Date).getTime()-t.getTime())+"ms")}function log(e){"undefined"!=typeof console&&"undefined"!=typeof console.debug?console.log(e):alert(e)}function buildParserCache(e,t){if(e.config.debug)var i="";if(0!=e.tBodies.length){var s=e.tBodies[0].rows;if(s[0])for(var n=[],r=s[0].cells,a=r.length,o=0;a>o;o++){var l=!1;$.metadata&&$(t[o]).metadata()&&$(t[o]).metadata().sorter?l=getParserById($(t[o]).metadata().sorter):e.config.headers[o]&&e.config.headers[o].sorter&&(l=getParserById(e.config.headers[o].sorter)),l||(l=detectParserForColumn(e,s,-1,o)),e.config.debug&&(i+="column:"+o+" parser:"+l.id+"\n"),n.push(l)}return e.config.debug&&log(i),n}}function detectParserForColumn(e,t,i,s){for(var n=parsers.length,r=!1,a=!1,o=!0;""==a&&o;)i++,t[i]?(r=getNodeFromRowAndCellIndex(t,i,s),a=trimAndGetNodeText(e.config,r),e.config.debug&&log("Checking if value was empty on row:"+i)):o=!1;for(var l=1;n>l;l++)if(parsers[l].is(a,e,r))return parsers[l];return parsers[0]}function getNodeFromRowAndCellIndex(e,t,i){return e[t].cells[i]}function trimAndGetNodeText(e,t){return $.trim(getElementText(e,t))}function getParserById(e){for(var t=parsers.length,i=0;t>i;i++)if(parsers[i].id.toLowerCase()==e.toLowerCase())return parsers[i];return!1}function buildCache(e){if(e.config.debug)var t=new Date;for(var i=e.tBodies[0]&&e.tBodies[0].rows.length||0,s=e.tBodies[0].rows[0]&&e.tBodies[0].rows[0].cells.length||0,n=e.config.parsers,r={row:[],normalized:[]},a=0;i>a;++a){var o=$(e.tBodies[0].rows[a]),l=[];if(o.hasClass(e.config.cssChildRow))r.row[r.row.length-1]=r.row[r.row.length-1].add(o);else{r.row.push(o);for(var h=0;s>h;++h)l.push(n[h].format(getElementText(e.config,o[0].cells[h]),e,o[0].cells[h]));l.push(r.normalized.length),r.normalized.push(l),l=null}}return e.config.debug&&benchmark("Building cache for "+i+" rows:",t),r}function getElementText(e,t){var i="";return t?(e.supportsTextContent||(e.supportsTextContent=t.textContent||!1),i="simple"==e.textExtraction?e.supportsTextContent?t.textContent:t.childNodes[0]&&t.childNodes[0].hasChildNodes()?t.childNodes[0].innerHTML:t.innerHTML:"function"==typeof e.textExtraction?e.textExtraction(t):$(t).text()):""}function appendToTable(e,t){if(e.config.debug)var i=new Date;for(var s=t,n=s.row,r=s.normalized,a=r.length,o=r[0].length-1,l=$(e.tBodies[0]),h=[],u=0;a>u;u++){var c=r[u][o];if(h.push(n[c]),!e.config.appender)for(var d=n[c].length,p=0;d>p;p++)l[0].appendChild(n[c][p])}e.config.appender&&e.config.appender(e,h),h=null,e.config.debug&&benchmark("Rebuilt table:",i),applyWidget(e),setTimeout(function(){$(e).trigger("sortEnd")},0)}function buildHeaders(e){if(e.config.debug)var t=new Date;$.metadata?!0:!1;var i=computeTableHeaderCellIndexes(e);return $tableHeaders=$(e.config.selectorHeaders,e).each(function(t){if(this.column=i[this.parentNode.rowIndex+"-"+this.cellIndex],this.order=formatSortingOrder(e.config.sortInitialOrder),this.count=this.order,(checkHeaderMetadata(this)||checkHeaderOptions(e,t))&&(this.sortDisabled=!0),checkHeaderOptionsSortingLocked(e,t)&&(this.order=this.lockedOrder=checkHeaderOptionsSortingLocked(e,t)),!this.sortDisabled){var s=$(this).addClass(e.config.cssHeader);e.config.onRenderHeader&&e.config.onRenderHeader.apply(s)}e.config.headerList[t]=this}),e.config.debug&&(benchmark("Built headers:",t),log($tableHeaders)),$tableHeaders}function computeTableHeaderCellIndexes(e){for(var t=[],i={},s=e.getElementsByTagName("THEAD")[0],n=s.getElementsByTagName("TR"),r=0;r<n.length;r++)for(var a=n[r].cells,o=0;o<a.length;o++){var l,h=a[o],u=h.parentNode.rowIndex,c=u+"-"+h.cellIndex,d=h.rowSpan||1,p=h.colSpan||1;"undefined"==typeof t[u]&&(t[u]=[]);for(var f=0;f<t[u].length+1;f++)if("undefined"==typeof t[u][f]){l=f;break}i[c]=l;for(var f=u;u+d>f;f++){"undefined"==typeof t[f]&&(t[f]=[]);for(var m=t[f],y=l;l+p>y;y++)m[y]="x"}}return i}function checkCellColSpan(e,t,i){for(var s=[],n=e.tHead.rows,r=n[i].cells,a=0;a<r.length;a++){var o=r[a];o.colSpan>1?s=s.concat(checkCellColSpan(e,headerArr,i++)):(1==e.tHead.length||o.rowSpan>1||!n[i+1])&&s.push(o)}return s}function checkHeaderMetadata(e){return $.metadata&&$(e).metadata().sorter===!1?!0:!1}function checkHeaderOptions(e,t){return e.config.headers[t]&&e.config.headers[t].sorter===!1?!0:!1}function checkHeaderOptionsSortingLocked(e,t){return e.config.headers[t]&&e.config.headers[t].lockedOrder?e.config.headers[t].lockedOrder:!1}function applyWidget(e){for(var t=e.config.widgets,i=t.length,s=0;i>s;s++)getWidgetById(t[s]).format(e)}function getWidgetById(e){for(var t=widgets.length,i=0;t>i;i++)if(widgets[i].id.toLowerCase()==e.toLowerCase())return widgets[i]}function formatSortingOrder(e){return"Number"!=typeof e?"desc"==e.toLowerCase()?1:0:1==e?1:0}function isValueInArray(e,t){for(var i=t.length,s=0;i>s;s++)if(t[s][0]==e)return!0;return!1}function setHeadersCss(e,t,i,s){t.removeClass(s[0]).removeClass(s[1]);var n=[];t.each(function(){this.sortDisabled||(n[this.column]=$(this))});for(var r=i.length,a=0;r>a;a++)n[i[a][0]].addClass(s[i[a][1]])}function fixColumnWidth(e){var t=e.config;if(t.widthFixed){var i=$("<colgroup>");$("tr:first td",e.tBodies[0]).each(function(){i.append($("<col>").css("width",$(this).width()))}),$(e).prepend(i)}}function updateHeaderSortCount(e,t){for(var i=e.config,s=t.length,n=0;s>n;n++){var r=t[n],a=i.headerList[r[0]];a.count=r[1],a.count++}}function multisort(table,sortList,cache){if(table.config.debug)var sortTime=new Date;for(var dynamicExp="var sortWrapper = function(a,b) {",l=sortList.length,i=0;l>i;i++){var c=sortList[i][0],order=sortList[i][1],s="text"==table.config.parsers[c].type?0==order?makeSortFunction("text","asc",c):makeSortFunction("text","desc",c):0==order?makeSortFunction("numeric","asc",c):makeSortFunction("numeric","desc",c),e="e"+i;dynamicExp+="var "+e+" = "+s,dynamicExp+="if("+e+") { return "+e+"; } ",dynamicExp+="else { "}var orgOrderCol=cache.normalized[0].length-1;dynamicExp+="return a["+orgOrderCol+"]-b["+orgOrderCol+"];";for(var i=0;l>i;i++)dynamicExp+="}; ";return dynamicExp+="return 0; ",dynamicExp+="}; ",table.config.debug&&benchmark("Evaling expression:"+dynamicExp,new Date),eval(dynamicExp),cache.normalized.sort(sortWrapper),table.config.debug&&benchmark("Sorting on "+sortList.toString()+" and dir "+order+" time:",sortTime),cache}function makeSortFunction(e,t,i){var s="a["+i+"]",n="b["+i+"]";return"text"==e&&"asc"==t?"("+s+" == "+n+" ? 0 : ("+s+" === null ? Number.POSITIVE_INFINITY : ("+n+" === null ? Number.NEGATIVE_INFINITY : ("+s+" < "+n+") ? -1 : 1 )));":"text"==e&&"desc"==t?"("+s+" == "+n+" ? 0 : ("+s+" === null ? Number.POSITIVE_INFINITY : ("+n+" === null ? Number.NEGATIVE_INFINITY : ("+n+" < "+s+") ? -1 : 1 )));":"numeric"==e&&"asc"==t?"("+s+" === null && "+n+" === null) ? 0 :("+s+" === null ? Number.POSITIVE_INFINITY : ("+n+" === null ? Number.NEGATIVE_INFINITY : "+s+" - "+n+"));":"numeric"==e&&"desc"==t?"("+s+" === null && "+n+" === null) ? 0 :("+s+" === null ? Number.POSITIVE_INFINITY : ("+n+" === null ? Number.NEGATIVE_INFINITY : "+n+" - "+s+"));":void 0}function makeSortText(e){return"((a["+e+"] < b["+e+"]) ? -1 : ((a["+e+"] > b["+e+"]) ? 1 : 0));"}function makeSortTextDesc(e){return"((b["+e+"] < a["+e+"]) ? -1 : ((b["+e+"] > a["+e+"]) ? 1 : 0));"}function makeSortNumeric(e){return"a["+e+"]-b["+e+"];"}function makeSortNumericDesc(e){return"b["+e+"]-a["+e+"];"}function sortText(e,t){return table.config.sortLocaleCompare?e.localeCompare(t):t>e?-1:e>t?1:0}function sortTextDesc(e,t){return table.config.sortLocaleCompare?t.localeCompare(e):e>t?-1:t>e?1:0}function sortNumeric(e,t){return e-t}function sortNumericDesc(e,t){return t-e}function getCachedSortType(e,t){return e[t].type}var parsers=[],widgets=[];this.defaults={cssHeader:"header",cssAsc:"headerSortUp",cssDesc:"headerSortDown",cssChildRow:"expand-child",sortInitialOrder:"asc",sortMultiSortKey:"shiftKey",sortForce:null,sortAppend:null,sortLocaleCompare:!0,textExtraction:"simple",parsers:{},widgets:[],widgetZebra:{css:["even","odd"]},headers:{},widthFixed:!1,cancelSelection:!0,sortList:[],headerList:[],dateFormat:"us",decimal:"/.|,/g",onRenderHeader:null,selectorHeaders:"thead th",debug:!1},this.benchmark=benchmark,this.construct=function(e){return this.each(function(){if(this.tHead&&this.tBodies){var t,i,s,n;this.config={},n=$.extend(this.config,$.tablesorter.defaults,e),t=$(this),$.data(this,"tablesorter",n),i=buildHeaders(this),this.config.parsers=buildParserCache(this,i),s=buildCache(this);var r=[n.cssDesc,n.cssAsc];fixColumnWidth(this),i.click(function(e){var a=t[0].tBodies[0]&&t[0].tBodies[0].rows.length||0;if(!this.sortDisabled&&a>0){t.trigger("sortStart"),$(this);var o=this.column;if(this.order=this.count++%2,this.lockedOrder&&(this.order=this.lockedOrder),e[n.sortMultiSortKey])if(isValueInArray(o,n.sortList))for(var l=0;l<n.sortList.length;l++){var h=n.sortList[l],u=n.headerList[h[0]];h[0]==o&&(u.count=h[1],u.count++,h[1]=u.count%2)}else n.sortList.push([o,this.order]);else{if(n.sortList=[],null!=n.sortForce)for(var c=n.sortForce,l=0;l<c.length;l++)c[l][0]!=o&&n.sortList.push(c[l]);n.sortList.push([o,this.order])}return setTimeout(function(){setHeadersCss(t[0],i,n.sortList,r),appendToTable(t[0],multisort(t[0],n.sortList,s))},1),!1}}).mousedown(function(){return n.cancelSelection?(this.onselectstart=function(){return!1},!1):void 0}),t.bind("update",function(){var e=this;setTimeout(function(){e.config.parsers=buildParserCache(e,i),s=buildCache(e)},1)}).bind("updateCell",function(e,t){var i=this.config,n=[t.parentNode.rowIndex-1,t.cellIndex];s.normalized[n[0]][n[1]]=i.parsers[n[1]].format(getElementText(i,t),t)}).bind("sorton",function(e,t){$(this).trigger("sortStart"),n.sortList=t;var a=n.sortList;updateHeaderSortCount(this,a),setHeadersCss(this,i,a,r),appendToTable(this,multisort(this,a,s))}).bind("appendCache",function(){appendToTable(this,s)}).bind("applyWidgetId",function(e,t){getWidgetById(t).format(this)}).bind("applyWidgets",function(){applyWidget(this)}),$.metadata&&$(this).metadata()&&$(this).metadata().sortlist&&(n.sortList=$(this).metadata().sortlist),n.sortList.length>0&&t.trigger("sorton",[n.sortList]),applyWidget(this)}})},this.addParser=function(e){for(var t=parsers.length,i=!0,s=0;t>s;s++)parsers[s].id.toLowerCase()==e.id.toLowerCase()&&(i=!1);i&&parsers.push(e)},this.addWidget=function(e){widgets.push(e)},this.formatFloat=function(e){var t=parseFloat(e);return isNaN(t)?0:t},this.formatInt=function(e){var t=parseInt(e);return isNaN(t)?0:t},this.isDigit=function(e){return/^[-+]?\d*$/.test($.trim(e.replace(/[,.']/g,"")))},this.clearTableBody=function(e){function t(){for(;this.firstChild;)this.removeChild(this.firstChild)}$.browser.msie?t.apply(e.tBodies[0]):e.tBodies[0].innerHTML=""}}}),$.fn.extend({tablesorter:$.tablesorter.construct});var ts=$.tablesorter;ts.addParser({id:"text",is:function(){return!0},format:function(e){return $.trim(e.toLocaleLowerCase())},type:"text"}),ts.addParser({id:"digit",is:function(e,t){var i=t.config;return $.tablesorter.isDigit(e,i)},format:function(e){return $.tablesorter.formatFloat(e)},type:"numeric"}),ts.addParser({id:"currency",is:function(e){return/^[Â£$â‚¬?.]/.test(e)},format:function(e){return $.tablesorter.formatFloat(e.replace(new RegExp(/[Â£$â‚¬]/g),""))},type:"numeric"}),ts.addParser({id:"ipAddress",is:function(e){return/^\d{2,3}[\.]\d{2,3}[\.]\d{2,3}[\.]\d{2,3}$/.test(e)},format:function(e){for(var t=e.split("."),i="",s=t.length,n=0;s>n;n++){var r=t[n];i+=2==r.length?"0"+r:r}return $.tablesorter.formatFloat(i)},type:"numeric"}),ts.addParser({id:"url",is:function(e){return/^(https?|ftp|file):\/\/$/.test(e)},format:function(e){return jQuery.trim(e.replace(new RegExp(/(https?|ftp|file):\/\//),""))},type:"text"}),ts.addParser({id:"isoDate",is:function(e){return/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(e)},format:function(e){return $.tablesorter.formatFloat(""!=e?new Date(e.replace(new RegExp(/-/g),"/")).getTime():"0")},type:"numeric"}),ts.addParser({id:"percent",is:function(e){return/\%$/.test($.trim(e))},format:function(e){return $.tablesorter.formatFloat(e.replace(new RegExp(/%/g),""))},type:"numeric"}),ts.addParser({id:"usLongDate",is:function(e){return e.match(new RegExp(/^[A-Za-z]{3,10}\.? [0-9]{1,2}, ([0-9]{4}|'?[0-9]{2}) (([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(AM|PM)))$/))},format:function(e){return $.tablesorter.formatFloat(new Date(e).getTime())},type:"numeric"}),ts.addParser({id:"shortDate",is:function(e){return/\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}/.test(e)},format:function(e,t){var i=t.config;return e=e.replace(/\-/g,"/"),"us"==i.dateFormat?e=e.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$1/$2"):"uk"==i.dateFormat?e=e.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$2/$1"):("dd/mm/yy"==i.dateFormat||"dd-mm-yy"==i.dateFormat)&&(e=e.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2})/,"$1/$2/$3")),$.tablesorter.formatFloat(new Date(e).getTime())},type:"numeric"}),ts.addParser({id:"time",is:function(e){return/^(([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(am|pm)))$/.test(e)},format:function(e){return $.tablesorter.formatFloat(new Date("2000/01/01 "+e).getTime())},type:"numeric"}),ts.addParser({id:"metadata",is:function(){return!1},format:function(e,t,i){var s=t.config,n=s.parserMetadataName?s.parserMetadataName:"sortValue";return $(i).metadata()[n]},type:"numeric"}),ts.addWidget({id:"zebra",format:function(e){if(e.config.debug)var t=new Date;var i,s,n=-1;$("tr:visible",e.tBodies[0]).each(function(){i=$(this),i.hasClass(e.config.cssChildRow)||n++,s=0==n%2,i.removeClass(e.config.widgetZebra.css[s?0:1]).addClass(e.config.widgetZebra.css[s?1:0])}),e.config.debug&&$.tablesorter.benchmark("Applying Zebra widget",t)}})}(jQuery),/*
 * Copyright (c) 2008 Greg Weber greg at gregweber.info
 * Dual licensed under the MIT and GPLv2 licenses just as jQuery is:
 * http://jquery.org/license
 *
 * documentation at http://gregweber.info/projects/uitablefilter
 *
 * allows table rows to be filtered (made invisible)
 * <code>
 * t = $('table')
 * $.uiTableFilter( t, phrase )
 * </code>
 * arguments:
 *   jQuery object containing table rows
 *   phrase to search for
 *   optional arguments:
 *     column to limit search too (the column title in the table header)
 *     ifHidden - callback to execute if one or more elements was hidden
 */
function(e){e.uiTableFilter=function(t,i,s,n){var r=!1;if(this.last_phrase===i)return!1;var a=i.length,o=i.toLowerCase().split(" "),l=function(e){e.show()},h=function(e){e.hide(),r=!0},u=function(e){return e.text()};if(s){var c=null;if(t.find("thead > tr:last > th").each(function(t){return e.trim(e(this).text())==s?(c=t,!1):void 0}),null==c)throw"given column: "+s+" not found";u=function(t){return e(t.find("td:eq("+c+")")).text()}}if(o.size>1&&i.substr(0,a-1)===this.last_phrase){if(" "===i[-1])return this.last_phrase=i,!1;var o=o[-1];l=function(){};var d=t.find("tbody:first > tr:visible")}else{r=!0;var d=t.find("tbody:first > tr")}return d.each(function(){var t=e(this);e.uiTableFilter.has_words(u(t),o,!1)?l(t):h(t)}),last_phrase=i,n&&r&&n(),t},e.uiTableFilter.last_phrase="",e.uiTableFilter.has_words=function(e,t,i){for(var s=i?e:e.toLowerCase(),n=0;n<t.length;n++)if(-1===s.indexOf(t[n]))return!1;return!0}}(jQuery),function(e){e.poll=function(t,i){e.isFunction(t)&&(i=t,t=1e3),function s(){setTimeout(function(){i(s)},t),t*=1.5}()}}(jQuery),/*
 * JavaScript Linkify - v0.3 - 6/27/2009
 * http://benalman.com/projects/javascript-linkify/
 * 
 * Copyright (c) 2009 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 * 
 * Some regexps adapted from http://userscripts.org/scripts/review/7122
 */
window.linkify=function(){var e="[a-z\\d.-]+://",t="(?:(?:[0-9]|[1-9]\\d|1\\d{2}|2[0-4]\\d|25[0-5])\\.){3}(?:[0-9]|[1-9]\\d|1\\d{2}|2[0-4]\\d|25[0-5])",i="(?:(?:[^\\s!@#$%^&*()_=+[\\]{}\\\\|;:'\",.<>/?]+)\\.)+",s="(?:ac|ad|aero|ae|af|ag|ai|al|am|an|ao|aq|arpa|ar|asia|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|biz|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|cat|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|coop|com|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|edu|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gov|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|info|int|in|io|iq|ir|is|it|je|jm|jobs|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mil|mk|ml|mm|mn|mobi|mo|mp|mq|mr|ms|mt|museum|mu|mv|mw|mx|my|mz|name|na|nc|net|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|org|pa|pe|pf|pg|ph|pk|pl|pm|pn|pro|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sy|sz|tc|td|tel|tf|tg|th|tj|tk|tl|tm|tn|to|tp|travel|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|xn--0zwm56d|xn--11b5bs3a9aj6g|xn--80akhbyknj4f|xn--9t4b11yi5a|xn--deba0ad|xn--g6w251d|xn--hgbk6aj7f53bba|xn--hlcj6aya9esc7a|xn--jxalpdlp|xn--kgbechtv|xn--zckzah|ye|yt|yu|za|zm|zw)",n="(?:"+i+s+"|"+t+")",r="(?:[;/][^#?<>\\s]*)?",a="(?:\\?[^#<>\\s]*)?(?:#[^<>\\s]*)?",o="\\b"+e+"[^<>\\s]+",l="\\b"+n+r+a+"(?!\\w)",h="mailto:",u="(?:"+h+")?[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@"+n+a+"(?!\\w)",c=new RegExp("(?:"+o+"|"+l+"|"+u+")","ig"),d=new RegExp("^"+e,"i"),p={"'":"`",">":"<",")":"(","]":"[","}":"{","B;":"B+","b�:":"b�9"},f={callback:function(e,t){return t?'<a href="'+t+'" title="'+t+'">'+e+"</a>":e},punct_regexp:/(?:[!?.,:;'"]|(?:&|&amp;)(?:lt|gt|quot|apos|raquo|laquo|rsaquo|lsaquo);)$/};return function(e,t){t=t||{};var i,s,n,r,a,o,l,u,m,y,g,v,x="",E=[];for(s in f)void 0===t[s]&&(t[s]=f[s]);for(;i=c.exec(e);)if(n=i[0],o=c.lastIndex,l=o-n.length,!/[\/:]/.test(e.charAt(l-1))){do u=n,v=n.substr(-1),g=p[v],g&&(m=n.match(new RegExp("\\"+g+"(?!$)","g")),y=n.match(new RegExp("\\"+v,"g")),(m?m.length:0)<(y?y.length:0)&&(n=n.substr(0,n.length-1),o--)),t.punct_regexp&&(n=n.replace(t.punct_regexp,function(e){return o-=e.length,""}));while(n.length&&n!==u);r=n,d.test(r)||(r=(-1!==r.indexOf("@")?r.indexOf(h)?h:"":r.indexOf("irc.")?r.indexOf("ftp.")?"http://":"ftp://":"irc://")+r),a!=l&&(E.push([e.slice(a,l)]),a=o),E.push([n,r])}for(E.push([e.substr(a)]),s=0;s<E.length;s++)x+=t.callback.apply(window,E[s]);return x||e}}(),function(){}.call(this),function(){}.call(this),Array.prototype.hasObject||(Array.prototype.hasObject=Array.indexOf?function(e){return-1!==this.indexOf(e)}:function(e){for(var t=this.length+1;t-=1;)if(this[t-1]===e)return!0;return!1}),populateSelectBox=function(e,t){for(var i=t.length,s=0;i>s;s++){var n=document.createElement("OPTION");n.text=t[s],n.value=t[s],e.options.add(n)}},String.prototype.makeHash||(String.prototype.makeHash=function(){var e=0;if(0==this.length)return e;for(i=0;i<this.length;i++)char=this.charCodeAt(i),e=(e<<5)-e+char,e&=e;return e}),String.prototype.capitalize||(String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)}),cssEscape=function(e){return e.replace(/[^a-z,A-Z,_,-,0-9]/g,"X")};var WebGIS=WebGIS||{};WebGIS.osmLeft,WebGIS.gphyLeft,WebGIS.gmapLeft,WebGIS.ghybLeft,WebGIS.gsatLeft,WebGIS.osmRight,WebGIS.gphyRight,WebGIS.gmapRight,WebGIS.ghybRight,WebGIS.gsatRight,WebGIS.baseOSM=function(e){e.parentMenu.ownerCt.setText("Open Street Map"),WebGIS.leftMap.setBaseLayer(WebGIS.osmLeft),WebGIS.rightMap.setBaseLayer(WebGIS.osmRight)},WebGIS.baseGooglePhy=function(e){e.parentMenu.ownerCt.setText("Google Physical"),WebGIS.leftMap.setBaseLayer(WebGIS.gphyLeft),WebGIS.rightMap.setBaseLayer(WebGIS.gphyRight)},WebGIS.baseGoogleSt=function(e){e.parentMenu.ownerCt.setText("Google Streets"),WebGIS.leftMap.setBaseLayer(WebGIS.gmapLeft),WebGIS.rightMap.setBaseLayer(WebGIS.gmapRight)},WebGIS.baseGoogleHy=function(e){e.parentMenu.ownerCt.setText("Google Hybrid"),WebGIS.leftMap.setBaseLayer(WebGIS.ghybLeft),WebGIS.rightMap.setBaseLayer(WebGIS.ghybRight)},WebGIS.baseGoogleSat=function(e){e.parentMenu.ownerCt.setText("Google Satellite"),WebGIS.leftMap.setBaseLayer(WebGIS.gsatLeft),WebGIS.rightMap.setBaseLayer(WebGIS.gsatRight)},WebGIS.getLeftBaseLayers=function(){return WebGIS.osmLeft=new OpenLayers.Layer.OSM,WebGIS.gphyLeft=new OpenLayers.Layer.Google("Google Physical",{type:google.maps.MapTypeId.TERRAIN,numZoomLevels:20,animationEnabled:!0,transitionEffect:"resize"}),WebGIS.gmapLeft=new OpenLayers.Layer.Google("Google Streets",{numZoomLevels:20,animationEnabled:!0}),WebGIS.ghybLeft=new OpenLayers.Layer.Google("Google Hybrid",{type:google.maps.MapTypeId.HYBRID,numZoomLevels:20,animationEnabled:!0}),WebGIS.gsatLeft=new OpenLayers.Layer.Google("Google Satellite",{type:google.maps.MapTypeId.SATELLITE,numZoomLevels:22,animationEnabled:!0}),WebGIS.osmLeft.animationEnabled=!0,WebGIS.osmLeft.projection=WebGIS.mapProjection,WebGIS.gphyLeft.projection=WebGIS.mapProjection,WebGIS.gmapLeft.projection=WebGIS.mapProjection,WebGIS.ghybLeft.projection=WebGIS.mapProjection,WebGIS.gsatLeft.projection=WebGIS.mapProjection,[WebGIS.osmLeft,WebGIS.ghybLeft,WebGIS.gphyLeft,WebGIS.gmapLeft,WebGIS.gsatLeft]},WebGIS.getRightBaseLayers=function(){return WebGIS.osmRight=new OpenLayers.Layer.OSM,WebGIS.gphyRight=new OpenLayers.Layer.Google("Google Physical",{type:google.maps.MapTypeId.TERRAIN,numZoomLevels:20,animationEnabled:!0,transitionEffect:"resize",displayInLayerSwitcher:!1}),WebGIS.gmapRight=new OpenLayers.Layer.Google("Google Streets",{numZoomLevels:20,animationEnabled:!0,displayInLayerSwitcher:!1}),WebGIS.ghybRight=new OpenLayers.Layer.Google("Google Hybrid",{type:google.maps.MapTypeId.HYBRID,numZoomLevels:20,animationEnabled:!0,displayInLayerSwitcher:!1}),WebGIS.gsatRight=new OpenLayers.Layer.Google("Google Satellite",{type:google.maps.MapTypeId.SATELLITE,numZoomLevels:22,animationEnabled:!0,displayInLayerSwitcher:!1}),WebGIS.osmRight.animationEnabled=!0,WebGIS.osmRight.projection=WebGIS.mapProjection,WebGIS.gphyRight.projection=WebGIS.mapProjection,WebGIS.gmapRight.projection=WebGIS.mapProjection,WebGIS.ghybRight.projection=WebGIS.mapProjection,WebGIS.gsatRight.projection=WebGIS.mapProjection,[WebGIS.osmRight,WebGIS.ghybRight,WebGIS.gphyRight,WebGIS.gmapRight,WebGIS.gsatRight]};var WebGIS=WebGIS||{};WebGIS.degreeSymbol="º",WebGIS.updateCoords=function(e){lonLat4326=e.transform(WebGIS.leftMap.getProjectionObject(),new OpenLayers.Projection(WebGIS.displayProjection)),WebGIS.coordsLongLabel.setText(WebGIS.convertDMS(lonLat4326.lon,"LON")),WebGIS.coordsLatLabel.setText(WebGIS.convertDMS(lonLat4326.lat,"LAT"))},WebGIS.convertDMS=function(e,t){return new Array,abscoordinate=Math.abs(e),coordinatedegrees=Math.floor(abscoordinate),coordinateminutes=(abscoordinate-coordinatedegrees)/(1/60),tempcoordinateminutes=coordinateminutes,coordinateminutes=Math.floor(coordinateminutes),coordinateseconds=(tempcoordinateminutes-coordinateminutes)/(1/60),coordinateseconds=Math.round(10*coordinateseconds),coordinateseconds/=10,10>coordinatedegrees&&(coordinatedegrees="0"+coordinatedegrees),10>coordinateminutes&&(coordinateminutes="0"+coordinateminutes),10>coordinateseconds&&(coordinateseconds="0"+coordinateseconds),coordinatedegrees+WebGIS.degreeSymbol+" "+coordinateminutes+"' "+parseFloat(coordinateseconds).toFixed(parseFloat(2))+'" '+this.getHemi(e,t)},WebGIS.getHemi=function(e,t){var i="";return"LAT"==t?i=e>=0?"N":"S":"LON"==t&&(i=e>=0?"E":"W"),i};var WebGIS=WebGIS||{};WebGIS.addDebugLayersML=function(){var e=new OpenLayers.Layer.WMS("Orography","http://montreuil.dynmap.com/carte_pour_iguess/carteWS.php",{layers:"Ligne_orographique_grp",format:"image/png",srsName:WebGIS.requestProjection,transparent:"true",projection:new OpenLayers.Projection(WebGIS.requestProjection)},{isBaseLayer:!1,visibility:!1}),t=new OpenLayers.Layer.WMS("Buildings - relevant","http://montreuil.dynmap.com/carte_pour_iguess/carteWS.php",{layers:"Bati_remarquable",format:"image/png",srsName:WebGIS.requestProjection,transparent:"true",projection:new OpenLayers.Projection(WebGIS.requestProjection)},{isBaseLayer:!1,visibility:!1}),i=new OpenLayers.Layer.WMS("Buildings - industrial","http://montreuil.dynmap.com/carte_pour_iguess/carteWS.php",{layers:"Bati_industriel",format:"image/png",srsName:WebGIS.requestProjection,transparent:"true",projection:new OpenLayers.Projection(WebGIS.requestProjection)},{isBaseLayer:!1,visibility:!1}),s=new OpenLayers.Layer.WMS("Buildings - indifferenced","http://montreuil.dynmap.com/carte_pour_iguess/carteWS.php",{layers:"BATI_INDIFFERENCIE",format:"image/png",srsName:WebGIS.requestProjection,transparent:"true",projection:new OpenLayers.Projection(WebGIS.requestProjection)},{isBaseLayer:!1,visibility:!1});WebGIS.leftMap.addLayer(e),WebGIS.leftMap.addLayer(t),WebGIS.leftMap.addLayer(i),WebGIS.leftMap.addLayer(s)},WebGIS.addDebugLayersLB=function(){var e=new OpenLayers.Layer.WMS("Bus lines","http://logis.ludwigsburg.de/mapguide2011/mapagent/mapagent.fcgi",{layers:"Ludwigsburg/3_Layer/buslinien",format:"image/png",srsName:WebGIS.requestProjection,transparent:"true",projection:new OpenLayers.Projection(WebGIS.requestProjection)},{isBaseLayer:!1,visibility:!1}),t=new OpenLayers.Layer.WMS("Buildings","http://logis.ludwigsburg.de/mapguide2011/mapagent/mapagent.fcgi",{layers:"Ludwigsburg/3_Layer/gebaeude_lb_3857",format:"image/png",srsName:WebGIS.requestProjection,transparent:"true",projection:new OpenLayers.Projection(WebGIS.requestProjection)},{isBaseLayer:!1,visibility:!1}),i=new OpenLayers.Layer.WMS("Streets","http://logis.ludwigsburg.de/mapguide2011/mapagent/mapagent.fcgi",{layers:"Ludwigsburg/3_Layer/Straßennamen",format:"image/png",srsName:WebGIS.requestProjection,transparent:"true",projection:new OpenLayers.Projection(WebGIS.requestProjection)},{isBaseLayer:!1,visibility:!1});WebGIS.leftMap.addLayer(e),WebGIS.leftMap.addLayer(t),WebGIS.leftMap.addLayer(i)},WebGIS.addDebugLayersRO=function(){var e=new OpenLayers.Layer.WMS("Builds iGUESS","http://services.iguess.tudor.lu/cgi-bin/mapserv?map=/var/www/MapFiles/RO_localOWS_test.map",{layers:"RO_building_footprints",format:"image/png",srsName:WebGIS.requestProjection,transparent:"true",projection:new OpenLayers.Projection(WebGIS.requestProjection)},{isBaseLayer:!1,visibility:!1}),t=new OpenLayers.Layer.WMS("DSM iGUESS","http://services.iguess.tudor.lu/cgi-bin/mapserv?map=/var/www/MapFiles/RO_localOWS_test.map",{layers:"ro_dsm",format:"image/png",srsName:WebGIS.requestProjection,transparent:"true",projection:new OpenLayers.Projection(WebGIS.requestProjection),sld_body:WebGIS.getStyle("ro_dsm",WebGIS.SLD_GEOTH)},{isBaseLayer:!1,visibility:!1});WebGIS.leftMap.addLayer(e),WebGIS.leftMap.addLayer(t)},OpenLayers.Layer.Google.v3.repositionMapElements=function(){google.maps.event.trigger(this.mapObject,"resize");var e=this.mapObject.getDiv().firstChild;if(!e||e.childNodes.length<3)return this.repositionTimer=window.setTimeout(OpenLayers.Function.bind(this.repositionMapElements,this),250),!1;for(var t=OpenLayers.Layer.Google.cache[this.map.id],i=this.map.viewPortDiv,s=e.children.length-1;s>=0;--s){if(1000001==e.children[s].style.zIndex){var n=e.children[s];i.appendChild(n),n.style.zIndex="1100",n.style.bottom="",n.className="olLayerGoogleCopyright olLayerGoogleV3",n.style.display="",t.termsOfUse=n}if(1e6==e.children[s].style.zIndex){var r=e.children[s];i.appendChild(r),r.style.zIndex="1100",r.style.bottom="",r.className="olLayerGooglePoweredBy olLayerGoogleV3 gmnoprint",r.style.display="",t.poweredBy=r}10000002==e.children[s].style.zIndex&&i.appendChild(e.children[s])}this.setGMapVisibility(this.visibility)};var WebGIS=WebGIS||{};WebGIS.ctrlIdentify=null,WebGIS.registerIdentify=function(e,t){WebGIS.ctrlIdentify=new OpenLayers.Control.WMSGetFeatureInfo({drillDown:!0,infoFormat:"application/vnd.ogc.gml"}),WebGIS.ctrlIdentify.events.register("getfeatureinfo",t,WebGIS.showInfo),WebGIS.leftMap.addControl(WebGIS.ctrlIdentify)},WebGIS.toggleLayer=function(){WebGIS.ctrlIdentify.layers=[];for(var e=WebGIS.leftMap.layers,t=0;t<e.length;t++)e[t].getVisibility()&&WebGIS.ctrlIdentify.layers.push(e[t])},WebGIS.showInfo=function(e){var t=[];Ext.each(e.features,function(e){t.push({xtype:"propertygrid",title:e.fid,source:e.attributes})}),new GeoExt.Popup({title:"Feature Info",width:300,height:450,layout:"accordion",map:WebGIS.leftPanel,location:e.xy,items:t}).show()};var WebGIS=WebGIS||{};WebGIS.leftMap=null,WebGIS.rightMap=null,WebGIS.proxy="/home/geoproxy?url=",OpenLayers.ProxyHost="/home/geoproxy?url=",WebGIS.mapProjection="EPSG:3857",WebGIS.requestProjection="EPSG:3857",WebGIS.displayProjection="EPSG:4326",Proj4js.defs["EPSG:31467"]="+proj=tmerc +lat_0=0 +lon_0=9 +k=1 +x_0=3500000 +y_0=0 +ellps=bessel +datum=potsdam +units=m +no_defs",Proj4js.defs["EPSG:28992"]="+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +no_defs",Proj4js.defs["EPSG:3857"]="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs",WebGIS.initMap=function(){var e=new OpenLayers.Projection(WebGIS.mapProjection),t=new OpenLayers.Bounds(-1015e3,5845e3,11e5,8e6);WebGIS.leftMap=new OpenLayers.Map("leftMap",{projection:e,displayProjection:new OpenLayers.Projection(WebGIS.displayProjection),units:"m",maxExtent:t,controls:[]}),WebGIS.registerIdentify(WebGIS.leftMap,this),WebGIS.leftMap.addLayers(WebGIS.getLeftBaseLayers()),WebGIS.leftMap.events.register("mousemove",null,WebGIS.mapMouseMove),WebGIS.leftMap.addControl(new OpenLayers.Control.ScaleLine)},WebGIS.mapMouseMove=function(e){var t=WebGIS.leftMap.getLonLatFromPixel(e.xy);WebGIS.updateCoords(t)},WebGIS.zoomToCity=function(){onLocationChanged(document.getElementById("city-dropdown").value)},WebGIS.addNewLayer=function(e,t,i,s){var n={layers:i,format:"image/png",srsName:WebGIS.requestProjection,srs:WebGIS.requestProjection,transparent:"true",sld_body:WebGIS.getStyle(i,s)},r={isBaseLayer:!1,visibility:!1,singleTile:!0,transitionEffect:"resize"},a=new OpenLayers.Layer.WMS(e,t,n,r);WebGIS.leftMap.addLayer(a),a.events.register("visibilitychanged",this,WebGIS.toggleLayer)},WebGIS.clearLayers=function(e){e=e||!1;for(var t=WebGIS.leftMap.layers,i=[],s=0,n=t.length;n>s;s++)(e||!t[s].isBaseLayer)&&i.push(t[s]);for(var s=0,n=i.length;n>s;s++)WebGIS.leftMap.removeLayer(i[s])};var WebGIS=WebGIS||{};WebGIS.initMapParallel=function(){var e=new OpenLayers.Projection(WebGIS.mapProjection),t=new OpenLayers.Bounds(-1015e3,5845e3,11e5,8e6);WebGIS.leftMap=new OpenLayers.Map("leftMap",{projection:e,displayProjection:new OpenLayers.Projection(WebGIS.displayProjection),units:"m",maxExtent:t,controls:[]}),WebGIS.rightMap=new OpenLayers.Map("rightMap",{projection:e,displayProjection:new OpenLayers.Projection(WebGIS.displayProjection),units:"m",maxExtent:t,controls:[new OpenLayers.Control.LayerSwitcher]}),WebGIS.registerIdentify(WebGIS.leftMap,this),WebGIS.registerIdentify(WebGIS.rightMap,this),WebGIS.leftMap.addLayers(WebGIS.getLeftBaseLayers()),WebGIS.rightMap.addLayers(WebGIS.getRightBaseLayers()),WebGIS.leftMap.addControl(new OpenLayers.Control.ScaleLine);var i=new OpenLayers.Layer.WMS("PV potential (amorph) (kWh/a)","http://services.iguess.tudor.lu/cgi-bin/mapserv?map=/var/www/MapFiles/RO_localOWS_test.map",{layers:"pv_potential_amo_elec",format:"image/png",srsName:WebGIS.requestProjection,transparent:"true",projection:new OpenLayers.Projection(WebGIS.requestProjection)},{isBaseLayer:!1,visibility:!0}),s=new OpenLayers.Layer.WMS("PV potential (amorph) (€/a)","http://services.iguess.tudor.lu/cgi-bin/mapserv?map=/var/www/MapFiles/RO_localOWS_test.map",{layers:"pv_potential_amo_c_e",format:"image/png",srsName:WebGIS.requestProjection,transparent:"true",projection:new OpenLayers.Projection(WebGIS.requestProjection)},{isBaseLayer:!1,visibility:!0});WebGIS.rightMap.addLayer(i),WebGIS.rightMap.addLayer(s),WebGIS.initParallelEvents()};var WebGIS=WebGIS||{};WebGIS.leftPanel=null,WebGIS.layerTree,WebGIS.coordsLatLabel=null,WebGIS.coordsLongLabel=null,WebGIS.CreatePanels=function(){if(0!=$("#BroadMap").length){Ext.state.Manager.setProvider(new Ext.state.CookieProvider),WebGIS.initMap(),new Ext.Toolbar({region:"south",height:24,border:0,collapsible:!1,floatable:!1,autoScroll:!1,enableDD:!1,items:WebGIS.createBbar()});var e=new GeoExt.ZoomSlider({xtype:"gx_zoomslider",aggressive:!0,vertical:!0,height:100,x:10,y:20,plugins:new GeoExt.ZoomSliderTip({template:"Scale: 1 : {scale}<br>Resolution: {resolution}"})});WebGIS.leftPanel=new GeoExt.MapPanel({region:"center",collapsible:!1,floatable:!1,xtype:"gx_mappanel",map:WebGIS.leftMap,items:[e],bbar:WebGIS.createBbar(),tbar:{height:100,items:["-",WebGIS.createTbarItems(WebGIS.leftMap),"-","->","-",{xtype:"splitbutton",text:"Open Street Map",menu:[{text:"Open Street Map",checked:!0,handler:WebGIS.baseOSM,group:"baseLayer"},{text:"Google Satellite",checked:!1,handler:WebGIS.baseGoogleSat,group:"baseLayer"},{text:"Google Streets",checked:!1,handler:WebGIS.baseGoogleSt,group:"baseLayer"},{text:"Google Physical",checked:!1,handler:WebGIS.baseGooglePhy,group:"baseLayer"},{text:"Google Hybrid",checked:!1,handler:WebGIS.baseGoogleHy,group:"baseLayer"}]}]}});var t=Ext.extend(GeoExt.tree.LayerNodeUI,new GeoExt.tree.TreeNodeUIEventMixin),i=[{nodeType:"gx_overlaylayercontainer",expanded:!0}];WebGIS.layerTree=new Ext.tree.TreePanel({title:"Map Layers",region:"west",width:200,collapsible:!0,autoScroll:!0,enableDD:!0,plugins:[{ptype:"gx_treenodecomponent"}],loader:{applyLoader:!1,uiProviders:{custom_ui:t}},root:{children:i},rootVisible:!1,lines:!1}),new Ext.Panel({layout:"border",bodyBorder:!1,renderTo:"BroadMap",stateId:"BroadMap",height:690,width:"100%",defaults:{split:!0,autoHide:!1,useSplitTips:!0},items:[WebGIS.leftPanel,WebGIS.layerTree,{region:"east",title:"Legend",xtype:"gx_legendpanel",width:150,collapsible:!0,autoScroll:!0,enableDD:!0,padding:5,rootVisible:!1,lines:!1}]}),WebGIS.zoomToCity()}},WebGIS.createTbarItems=function(e){var t=[];t.push(new GeoExt.Action({iconCls:"pan",map:e,pressed:!0,toggleGroup:"tools",allowDepress:!1,tooltip:"Navigate",control:new OpenLayers.Control.Navigation})),t.push(new GeoExt.Action({iconCls:"maxExtent",map:e,tooltip:"Zoom to max extent",handler:WebGIS.zoomToCity})),t.push(new GeoExt.Action({iconCls:"zoomin",map:e,toggleGroup:"tools",allowDepress:!1,tooltip:"Zoom in",control:new OpenLayers.Control.ZoomBox({out:!1})})),t.push(new GeoExt.Action({iconCls:"zoomout",map:e,toggleGroup:"tools",allowDepress:!1,tooltip:"Zoom out",control:new OpenLayers.Control.ZoomBox({out:!0})}));var i=new OpenLayers.Control.NavigationHistory;return e.addControl(i),t.push(new GeoExt.Action({control:i.previous,iconCls:"back",tooltip:"back",disabled:!0})),t.push(new GeoExt.Action({control:i.next,iconCls:"next",tooltip:"next",disabled:!0})),t.push("-"),t.push(new GeoExt.Action({iconCls:"identify",toggleGroup:"tools",tooltip:"Identify",pressed:!1,control:WebGIS.ctrlIdentify,map:e})),t.push(new GeoExt.Action({iconCls:"print",map:e,toggleGroup:"tools",allowDepress:!1,tooltip:"Print - still in development",disabled:!0})),t},WebGIS.createBbar=function(){WebGIS.coordsLatLabel=new Ext.form.Label({text:" "}),WebGIS.coordsLongLabel=new Ext.form.Label({text:" "});var e=new Ext.form.Label({text:"Scale:    "}),t=new GeoExt.data.ScaleStore({map:WebGIS.leftMap}),i=new Ext.form.ComboBox({store:t,emptyText:"Zoom Level",tpl:'<tpl for="."><div class="x-combo-list-item">1 : {[parseInt(values.scale)]}</div></tpl>',editable:!1,width:120,triggerAction:"all",mode:"local"});return i.on("select",function(e,t){WebGIS.leftMap.zoomTo(t.data.level)},this),WebGIS.leftMap.events.register("zoomend",this,function(){var e=t.queryBy(function(e){return WebGIS.leftMap.getZoom()==e.data.level});if(e.length>0)e=e.items[0],i.setValue("1 : "+parseInt(e.data.scale));else{if(!i.rendered)return;i.clearValue()}}),["-",e,i,"-","->","-",WebGIS.coordsLongLabel,"-",WebGIS.coordsLatLabel,"-"]};var WebGIS=WebGIS||{};WebGIS.CreatePanelsParallel=function(){if(0!=$("#BroadMap").length){Ext.state.Manager.setProvider(new Ext.state.CookieProvider),WebGIS.initMapParallel();var e=new Ext.Toolbar({region:"south",height:24,border:0,collapsible:!1,floatable:!1,autoScroll:!1,enableDD:!1,items:WebGIS.createBbarParallel()}),t=new GeoExt.ZoomSlider({xtype:"gx_zoomslider",aggressive:!0,vertical:!0,height:100,x:10,y:20,plugins:new GeoExt.ZoomSliderTip({template:"Scale: 1 : {scale}<br>Resolution: {resolution}"})}),i=new GeoExt.ZoomSlider({xtype:"gx_zoomslider",aggressive:!0,vertical:!0,height:100,x:10,y:20,plugins:new GeoExt.ZoomSliderTip({template:"Scale: 1 : {scale}<br>Resolution: {resolution}"})}),s=new GeoExt.MapPanel({region:"center",collapsible:!1,floatable:!1,width:"50%",xtype:"gx_mappanel",map:WebGIS.leftMap,items:[t],tbar:{height:100,items:["-",WebGIS.createTbarItems(WebGIS.leftMap),"-","->","-",{xtype:"splitbutton",text:"Open Street Map",menu:[{text:"Open Street Map",checked:!0,handler:WebGIS.baseOSM,group:"baseLayer"},{text:"Google Satellite",checked:!1,handler:WebGIS.baseGoogleSat,group:"baseLayer"},{text:"Google Streets",checked:!1,handler:WebGIS.baseGoogleSt,group:"baseLayer"},{text:"Google Physical",checked:!1,handler:WebGIS.baseGooglePhy,group:"baseLayer"},{text:"Google Hybrid",checked:!1,handler:WebGIS.baseGoogleHy,group:"baseLayer"}]}]}}),n=new GeoExt.MapPanel({region:"east",collapsible:!0,floatable:!1,autoScroll:!0,enableDD:!0,width:"50%",xtype:"gx_mappanel",map:WebGIS.rightMap,items:[i]}),r=Ext.extend(GeoExt.tree.LayerNodeUI,new GeoExt.tree.TreeNodeUIEventMixin),a=[{nodeType:"gx_overlaylayercontainer",expanded:!0}];WebGIS.layerTree=new Ext.tree.TreePanel({title:"Map Layers",collapsible:!0,autoScroll:!0,enableDD:!0,plugins:[{ptype:"gx_treenodecomponent"}],loader:{applyLoader:!1,uiProviders:{custom_ui:r}},root:{children:a},rootVisible:!1,lines:!1}),WebGIS.layerStore=new GeoExt.data.LayerStore({map:WebGIS.leftMap,layers:WebGIS.leftMap.layers}),WebGIS.legend=new GeoExt.LegendPanel({title:"Legend",xtype:"gx_legendpanel",layerStore:WebGIS.layerStore,collapsible:!0,autoScroll:!0,enableDD:!0,padding:5,rootVisible:!1,lines:!1});var o=new Ext.Panel({title:"Data",region:"west",collapsible:!0,width:270,layout:"accordion",items:[WebGIS.layerTree,WebGIS.legend]}),l=new Ext.Panel({layout:"border",bodyBorder:!0,region:"center",collapsible:!1,defaults:{split:!0,autoHide:!1,useSplitTips:!0},items:[s,n,e]});new Ext.Panel({layout:"border",bodyBorder:!1,renderTo:"BroadMap",stateId:"BroadMap",height:690,width:"100%",defaults:{split:!0,autoHide:!1,useSplitTips:!0},items:[l,o]}),WebGIS.zoomToCity()}},WebGIS.createBbarParallel=function(){WebGIS.coordsLatLabel=new Ext.form.Label({text:" "}),WebGIS.coordsLongLabel=new Ext.form.Label({text:" "});var e=new Ext.form.Label({text:"Scale:    "}),t=new GeoExt.data.ScaleStore({map:WebGIS.leftMap}),i=new Ext.form.ComboBox({store:t,emptyText:"Zoom Level",tpl:'<tpl for="."><div class="x-combo-list-item">1 : {[parseInt(values.scale)]}</div></tpl>',editable:!1,width:120,triggerAction:"all",mode:"local"});return i.on("select",function(e,t){WebGIS.leftMap.zoomTo(t.data.level),WebGIS.rightMap.zoomTo(t.data.level)},this),WebGIS.leftMap.events.register("zoomend",this,function(){var e=t.queryBy(function(e){return WebGIS.leftMap.getZoom()==e.data.level});if(e.length>0)e=e.items[0],i.setValue("1 : "+parseInt(e.data.scale));else{if(!i.rendered)return;i.clearValue()}}),["-",e,i,"-","->","-",WebGIS.coordsLongLabel,"-",WebGIS.coordsLatLabel,"-"]};var WebGIS=WebGIS||{};WebGIS.MARKER_Z_INDEX=1e3;var crosshairs="/assets/crosshairYellowTransparent.png";WebGIS.chSize=new OpenLayers.Size(17,17),WebGIS.chOffsetRight=new OpenLayers.Pixel(-(WebGIS.chSize.w/2)-0,-(WebGIS.chSize.h/2)-1),WebGIS.chOffsetLeft=new OpenLayers.Pixel(-(WebGIS.chSize.w/2)-2,-(WebGIS.chSize.h/2)-0),WebGIS.chIconRight=new OpenLayers.Icon(crosshairs,WebGIS.chSize,WebGIS.chOffsetRight),WebGIS.chIconLeft=new OpenLayers.Icon(crosshairs,WebGIS.chSize,WebGIS.chOffsetLeft),WebGIS.rightMarkers=new OpenLayers.Layer.Markers("Markers"),WebGIS.leftMarkers=new OpenLayers.Layer.Markers("Markers"),WebGIS.rightPointer,WebGIS.leftPointer,WebGIS.leftMapMove=function(){WebGIS.rightMap.setCenter(WebGIS.leftMap.getCenter(),WebGIS.leftMap.getZoom())},WebGIS.leftMapMouseOver=function(e){WebGIS.rightPointer=new OpenLayers.Marker(WebGIS.leftMap.getLonLatFromPixel(e.xy),WebGIS.chIconRight),WebGIS.rightMarkers.addMarker(WebGIS.rightPointer)},WebGIS.leftMapMouseOut=function(){WebGIS.rightMarkers.clearMarkers()},WebGIS.leftMapMouseMove=function(e){var t=WebGIS.leftMap.getLonLatFromPixel(e.xy);WebGIS.rightMarkers.clearMarkers(),WebGIS.rightPointer=new OpenLayers.Marker(t,WebGIS.chIconRight),WebGIS.rightMarkers.addMarker(WebGIS.rightPointer),WebGIS.rightMarkers.graphicZIndex=WebGIS.MARKER_Z_INDEX,WebGIS.updateCoords(t)},WebGIS.rightMapMouseOver=function(e){WebGIS.leftMap.addLayer(WebGIS.leftMarkers),WebGIS.leftPointer=new OpenLayers.Marker(WebGIS.rightMap.getLonLatFromPixel(e.xy),WebGIS.chIconLeft),WebGIS.leftMarkers.addMarker(WebGIS.leftPointer)},WebGIS.rightMapMouseOut=function(){WebGIS.leftMarkers.clearMarkers()},WebGIS.rightMapMouseMove=function(e){var t=WebGIS.leftMap.getLonLatFromPixel(e.xy);WebGIS.leftMarkers.clearMarkers(),WebGIS.leftPointer=new OpenLayers.Marker(t,WebGIS.chIconLeft),WebGIS.leftMarkers.addMarker(WebGIS.leftPointer),WebGIS.leftMarkers.graphicZIndex=WebGIS.MARKER_Z_INDEX,WebGIS.updateCoords(t)},WebGIS.rightMapMove=function(){WebGIS.leftMap.setCenter(WebGIS.rightMap.getCenter(),WebGIS.rightMap.getZoom())},WebGIS.initParallelEvents=function(){WebGIS.leftMarkers.displayInLayerSwitcher=!1,WebGIS.leftMap.addLayer(WebGIS.leftMarkers),WebGIS.leftMarkers.graphicZIndex=WebGIS.MARKER_Z_INDEX,WebGIS.leftMap.events.register("moveend",null,WebGIS.leftMapMove),WebGIS.leftMap.events.register("mousemove",null,WebGIS.leftMapMouseMove),WebGIS.leftMap.events.register("mouseout",null,WebGIS.leftMapMouseOut),WebGIS.leftMap.events.register("mouseover",null,WebGIS.leftMapMouseOver),WebGIS.rightMarkers.displayInLayerSwitcher=!1,WebGIS.rightMap.addLayer(WebGIS.rightMarkers),WebGIS.rightMarkers.graphicZIndex=WebGIS.MARKER_Z_INDEX,WebGIS.rightMap.events.register("moveend",null,WebGIS.rightMapMove),WebGIS.rightMap.events.register("mousemove",null,WebGIS.rightMapMouseMove),WebGIS.rightMap.events.register("mouseout",null,WebGIS.rightMapMouseOut),WebGIS.rightMap.events.register("mouseover",null,WebGIS.rightMapMouseOver)};var WebGIS=WebGIS||{};WebGIS.SLD_SOLAR=0,WebGIS.SLD_GEOTH=1,WebGIS.SLD_POVRT=2,WebGIS.SLD_STOCK=3,WebGIS.SLD_GEOTH=4,WebGIS.ramps=new Array,WebGIS.vals=new Array,WebGIS.ramps[WebGIS.SLD_SOLAR]=new Array("#abd9e9","#d5ecd4","#ffffbf","#eb8c6e","#d7191c"),WebGIS.vals[WebGIS.SLD_SOLAR]=new Array(0,300,600,900,1200),WebGIS.ramps[WebGIS.SLD_GEOTH]=new Array("#92c5de","#c5de87","#f7f7f7","#e17c8c","#ca0020"),WebGIS.vals[WebGIS.SLD_GEOTH]=new Array(0,25,50,75,100),WebGIS.ramps[WebGIS.SLD_POVRT]=new Array("#A6D96A","#d3ec95","#FFFFBF","#d7191c","#D7191C"),WebGIS.vals[WebGIS.SLD_POVRT]=new Array(0,25,50,75,100),WebGIS.ramps[WebGIS.SLD_STOCK]=new Array("#b2abd2","#d5d1e5","#f7f7f7","#e66101","#e66101"),WebGIS.vals[WebGIS.SLD_STOCK]=new Array(0,25,50,75,100),WebGIS.ramps[WebGIS.SLD_GEOTH]=new Array("#f7f7f7","#c5deeb","#92c5de","#0571b0","#0571b0"),WebGIS.vals[WebGIS.SLD_GEOTH]=new Array(0,25,50,75,100),WebGIS.getStyle=function(e,t){if(null==t||isNaN(t)||0>t||t>4)return"\n";for(sld='<?xml version="1.0" encoding="UTF-8"?>\n',sld+='<StyledLayerDescriptor version="1.0.0"\n',sld+='  xmlns="http://www.opengis.net/sld"\n',sld+='  xmlns:ogc="http://www.opengis.net/ogc"\n',sld+='  xmlns:xlink="http://www.w3.org/1999/xlink"\n',sld+='  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n',sld+='  xsi:schemaLocation="http://www.opengis.net/sld\n',sld+='  http://schemas.opengis.net/sld/1.0.0/StyledLayerDescriptor.xsd">\n',sld+="  <NamedLayer>\n",sld+="    <Name>"+e+"</Name>\n",sld+="     <UserStyle>\n",sld+="      <Title>GeoServer SLD Cook Book: Simple point</Title>\n",sld+="		<FeatureTypeStyle>\n",sld+="		 <Rule>\n",sld+="		   <RasterSymbolizer>\n",sld+="		     <ColorMap>\n",i=0;i<WebGIS.ramps[t].length;i++)sld+='		       <ColorMapEntry color="'+WebGIS.ramps[t][i]+'" quantity="'+WebGIS.vals[t][i]+'" />\n';return sld+="		     </ColorMap>\n",sld+="		   </RasterSymbolizer>\n",sld+="		 </Rule>\n",sld+="	   </FeatureTypeStyle>\n",sld+="    </UserStyle>\n",sld+="  </NamedLayer>\n",sld+="</StyledLayerDescriptor>\n"},function(){function e(e){var t=this.meta.format;if("string"==typeof e||e.nodeType){e=t.read(e);var i=t.read;t.read=function(){return t.read=i,e}}this.raw=e}Ext.intercept(GeoExt.data.WFSCapabilitiesReader.prototype,"readRecords",e),Ext.intercept(GeoExt.data.WMSCapabilitiesReader.prototype,"readRecords",e),Ext.intercept(GeoExt.data.WCSCapabilitiesReader.prototype,"readRecords",e),GeoExt.data.AttributeReader&&Ext.intercept(GeoExt.data.AttributeReader.prototype,"readRecords",e)}();var WPS=WPS||{},WMS=WMS||{},WFS=WFS||{},WCS=WCS||{},COMMON=COMMON||{};WMS.updateLayerList=function(e,t,i){jQuery(".form_error_message").text(""),jQuery("#layers_loading_indicator").show();var s=WMS.getCapReq(e),n=new GeoExt.data.WMSCapabilitiesStore({url:s});COMMON.updateLayerList(n,t,i)},WFS.updateLayerList=function(e,t,i){var s=WFS.getCapReq(e),n=new GeoExt.data.WFSCapabilitiesStore({url:s,fields:[{name:"name",type:"string"},{name:"title",type:"string"},{name:"namespace",type:"string",mapping:"featureNS"},{name:"abstract",type:"string"},{name:"srs",type:"string"}]});COMMON.updateLayerList(n,t,i)},WCS.updateLayerList=function(e,t,i){var s,n;s=WCS.getCapReq(e),n=new GeoExt.data.WCSCapabilitiesStore({url:s}),COMMON.updateLayerList(n,t,i),s=WCS.descCovReq(e),n=new GeoExt.data.WCSDescribeCoverageStore({url:s}),COMMON.updateLayerList(n,t,i)},COMMON.updateLayerList=function(e,t,i){e.on("load",t),e.on("exception",i),e.load()};var geoProxyPrefix="/home/geoproxy?url=",wrapGeoProxy=function(e){return geoProxyPrefix+encodeURIComponent(e)},unwrapGeoProxy=function(e){return e.replace(geoProxyPrefix,"")},getJoinChar=function(e){return-1==e.indexOf("?")?"?":"&"};WMS.version="1.3.0",WFS.version="1.0.0",WCS.version="1.1.0",WMS.getCapStr="SERVICE=WMS&VERSION="+WMS.version+"&REQUEST=GetCapabilities",WMS.getCapUrl=function(e){var t=getJoinChar(e);return e+t+WMS.getCapStr},WMS.getCapReq=function(e){return wrapGeoProxy(WMS.getCapUrl(e))},WMS.stripReq=function(e){return e.replace(WMS.getCapStr,"").slice(0,-1)},WFS.getCapStr="SERVICE=WFS&VERSION="+WFS.version+"&REQUEST=GetCapabilities",WFS.getCapUrl=function(e){var t=getJoinChar(e);return e+t+WFS.getCapStr},WFS.getCapReq=function(e){return wrapGeoProxy(WFS.getCapUrl(e))},WFS.stripReq=function(e){return e.replace(WFS.getCapStr,"").slice(0,-1)},WCS.getCapStr="SERVICE=WCS&VERSION="+WCS.version+"&REQUEST=GetCapabilities",WCS.getCapUrl=function(e){var t=getJoinChar(e);return e+t+WCS.getCapStr},WCS.descCovStr="SERVICE=WCS&VERSION="+WCS.version+"&REQUEST=DescribeCoverage",WCS.descCovUrl=function(e){var t=getJoinChar(e);return e+t+WCS.descCovStr},WCS.getCapReq=function(e){return wrapGeoProxy(WCS.getCapUrl(e))},WCS.stripReq=function(e){return e.replace(WCS.getCapStr,"").replace(WCS.descCovStr,"").slice(0,-1)},WCS.descCovReq=function(e){return wrapGeoProxy(WCS.descCovUrl(e))},WFS.unwrapServer=function(e){return WFS.stripReq(decodeURIComponent(unwrapGeoProxy(e)))},WCS.unwrapServer=function(e){return WCS.stripReq(decodeURIComponent(unwrapGeoProxy(e)))},WMS.unwrapServer=function(e){return WMS.stripReq(decodeURIComponent(unwrapGeoProxy(e)))},unwrapServer=function(e,t){return"WFSCapabilities"===t?WFS.unwrapServer(e):"WMSCapabilities"===t?WMS.unwrapServer(e):"WCSCapabilities"===t?WCS.unwrapServer(e):"WCSDescribeCoverage"===t?WCS.unwrapServer(e):"Unknown Format!!"},getService=function(e){return"WFSCapabilities"===e?"WFS":"WMSCapabilities"===e?"WMS":"WCSCapabilities"===e?"WCS":"WCSDescribeCoverage"===e?"WCSdc":"Unknown Service!!"},isPrimaryService=function(e){return"WMS"===e||"WFS"===e||"WCS"===e};