<script type="text/javascript">
  registeredDataLayers = { };
    
  <%= @datasets.reject{ |d| d.finalized == false }.
                map{ |d| "registeredDataLayers[makeKey('" + d.server_url + "','" + d.identifier + "')] = '" + d.dataset_type + "';" }.
                join(' ') %>
                
  registeredProcDataServers = [<%= @datasets.uniq{|d| d.server_url}
                                        .reject{|d| d.dataset_type == "Mapping Only"}
                                        .map{|d| "'" + d.server_url + "'"}
                                        .join(',') %>];        
<!--                                         
  registeredMapDataServers = [<%= @datasets.uniq{|d| d.server_url}
                                           .map{|d| "'" + d.server_url + "'"}
                                           .join(',') %>];               
                                                -->
</script>