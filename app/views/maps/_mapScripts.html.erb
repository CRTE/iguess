<%# Include Google Map code %>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?v=3.5&sensor=false"></script>


<%# Custom mapping functions %>
<script type="text/javascript">
  // This gets run when user changes city dropdown
  var onLocationChanged = function(cityName) {
    // Set cookie to help us remember the location
    <% for city in City.all %>
    if(cityName == "<%= city.name %>")
    {
      var proj = new OpenLayers.Projection("<%= city.srs %>");
      var point = new OpenLayers.LonLat(
              (<%= city.minx %> + <%= city.maxx %>) / 2,
              (<%= city.miny %> + <%= city.maxy %>) / 2);
      point.transform(proj, map.getProjectionObject());

      map.setCenter(point, <%= city.zoom %>);

      $('.all-layers').hide();
      $('.layer-for-city-<%= city.id %>').show();

      return;
    }
    <% end %>
  }


</script>
